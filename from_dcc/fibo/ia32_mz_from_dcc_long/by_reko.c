// subject.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

// 0800:010D: void __exit()
void __exit()
{
	struct Eq_32 * ds_3 = seg0800->ptr01C7;
	byte al_4 = __restorezero(ds_3);
	struct Eq_40 Eq_46::* sp_7;
	struct Eq_41 * ds_8;
	struct Eq_42 * cs_9;
	word16 bp_10;
	byte ah_11;
	byte al_12;
	struct Eq_46 * ss_13;
	(cs->*ds_3->ptr0540)();
	msdos_terminate((ss_13->*sp_7).b0004);
}

// 0800:0172: Register byte __restorezero(Register (ptr Eq_32) ds)
byte __restorezero(Eq_32 * ds)
{
	msdos_set_interrupt_vector(0x00, ds->ptr005B);
	msdos_set_interrupt_vector(0x04, ds->ptr005F);
	msdos_set_interrupt_vector(0x05, ds->ptr0063);
	msdos_set_interrupt_vector(0x06, ds->ptr0067);
	return 0x06;
}

// 0800:03B2: void __REALCVT()
void __REALCVT()
{
	word16 sp_4;
	struct Eq_93 * ds_5;
	ds->ptr0544();
}

// 0800:03B6: void __scantod()
void __scantod()
{
	word16 sp_4;
	struct Eq_98 * ds_5;
	ds->ptr0548();
}

// 0800:03BA: void __scanrslt()
void __scanrslt()
{
	word16 sp_4;
	struct Eq_103 * ds_5;
	ds->ptr054C();
}

// 0800:03BE: void __scanpop()
void __scanpop()
{
	word16 sp_4;
	struct Eq_108 * ds_5;
	ds->ptr0550();
}

// 083C:0002: void _main(Register word16 bp, Register Eq_113 ds)
void _main(word16 bp, Eq_113 ds)
{
	word16 si_20;
	word16 di_21;
	uint16 bx_22 = _printf(ds, 0x94, ds, out si_20, out di_21);
	_scanf(bx_22, di_21, ds, 177, ds);
	union Eq_113 Eq_113::* bp_46 = fp - 0x02;
	Eq_113 si_114 = 0x01;
	while (si_114 <= ss->*(bp_46 - 0x04))
	{
		ss->*(fp - 0x0C) = ds;
		(ss->*(fp - 0x0E)).u0 = 0xB4;
		word16 si_71;
		word16 di_72;
		uint16 bx_73 = _printf(ds, wArg00, wArg02, out si_71, out di_72);
		ss->*(fp - 0x0C) = ss;
		ss->*(fp - 0x0E) = bp_46 - 0x02;
		ss->*(fp - 0x10) = ds;
		(ss->*(fp - 0x12)).u0 = 0xC3;
		_scanf(bx_73, di_72, ds, wArg00, wArg02);
		ss->*(fp - 0x0C) = ss->*(bp_46 - 0x02);
		word16 si_94;
		ss->*(fp - 0x0C) = _fib(bp_46, wArg00, out bp_46, out si_94);
		ss->*(fp - 0x0E) = ss->*(bp_46 - 0x02);
		ss->*(fp - 0x10) = ds;
		(ss->*(fp - 0x12)).u0 = 0xC6;
		word16 si_109;
		word16 di_110;
		_printf(ds, wArg00, wArg02, out si_109, out di_110);
		si_114 = si_109 + 0x01;
	}
	(ss->*(fp - 0x0C)).u0 = 0x00;
	_exit(ds, wArg00);
}

// 083C:007C: Register word16 _fib(Register (memptr Eq_113 Eq_113) bp, Stack Eq_120 wArg04, Register out Eq_208 bpOut, Register out ptr16 siOut)
word16 _fib(Eq_113 Eq_113::*bp, Eq_120 wArg04, Eq_208 & bpOut, ptr16 & siOut)
{
	word16 ax_17;
	struct Eq_259 Eq_276::* sp_19 = fp - 0x04;
	if (wArg04 > 0x02)
	{
		union Eq_113 Eq_113::* bp_34;
		word16 si_35;
		ss->*(fp - 0x08) = _fib(fp - 0x02, wArg04 - 0x01, out bp_34, out si_35);
		ss->*(fp - 0x0A) = si_35 + ~0x01;
		sp_19 = fp - 0x08;
		word16 bp_48;
		word16 si_49;
		ax_17 = Mem45[ss:fp - 0x0A + 0x00:word16] + _fib(bp_34, wArg02, out bp_48, out si_49);
	}
	else
		ax_17 = 0x01;
	word16 si_22;
	*siOut = (ss->*sp_19).t0000;
	word16 bp_24;
	*bpOut = (ss->*sp_19).w0002;
	return ax_17;
}

// 084A:000A: void _exit(Register Eq_113 ds, Stack Eq_120 wArg04)
void _exit(Eq_113 ds, Eq_120 wArg04)
{
	while (true)
	{
		ui16 ax_19 = *((word32) ds + 0x0144);
		*((word32) ds + 0x0144) = *((word32) ds + 0x0144) - 0x01;
		if (ax_19 == 0x00)
			break;
		word16 sp_71;
		word16 bp_72;
		struct Eq_326 * ss_73;
		word16 ax_74;
		byte SZO_76;
		byte C_77;
		byte Z_78;
		word16 cx_79;
		word16 bx_80;
		byte SCZO_81;
		SEQ(ds, 0x0554)[Mem21[ds:0x0144:word16] * 0x04]();
	}
	word16 sp_26;
	word16 bp_27;
	struct Eq_343 * ss_28;
	word16 ax_29;
	struct Eq_345 * ds_30;
	byte SZO_31;
	byte C_32;
	byte Z_33;
	word16 cx_34;
	word16 bx_35;
	byte SCZO_36;
	(*((word32) ds + 0x0136))();
	word16 sp_37;
	word16 bp_38;
	struct Eq_356 * ss_39;
	word16 ax_40;
	struct Eq_358 * ds_41;
	byte SZO_42;
	byte C_43;
	byte Z_44;
	word16 cx_45;
	word16 bx_46;
	byte SCZO_47;
	ds_30->ptr013A();
	union Eq_120 Eq_369::* sp_48;
	word16 bp_49;
	struct Eq_369 * ss_50;
	word16 ax_51;
	struct Eq_371 * ds_52;
	byte SZO_53;
	byte C_54;
	byte Z_55;
	word16 cx_56;
	word16 bx_57;
	byte SCZO_58;
	ds_41->ptr013E();
	ss_50->*(sp_48 - 0x02) = wArg04;
	__exit();
}

// 0918:000A: void __LONGTOA(Stack byte bArg04, Stack byte bArg06, Stack Eq_390 wArg08, Stack (ptr byte) ptrArg0A, Stack (memptr Eq_113 byte) wArg0C, Stack Eq_113 wArg0E, Stack Eq_394 wArg10)
void __LONGTOA(byte bArg04, byte bArg06, Eq_390 wArg08, byte * ptrArg0A, byte Eq_113::*wArg0C, Eq_113 wArg0E, Eq_394 wArg10)
{
	byte Eq_397::* di_122 = (word16) ptrArg0A;
	struct Eq_397 * es_19 = SLICE(ptrArg0A, selector, 16);
	cu8 bl_22 = (byte) wArg08;
	if (wArg08 > 0x24 || bl_22 < 0x02)
	{
l0918_007A:
		es_19->*di_122 = 0x00;
		return;
	}
	Eq_113 ax_105 = wArg0E;
	Eq_394 cx_149 = wArg10;
	if (wArg10 < 0x00 && bArg06 != 0x00)
	{
		*ptrArg0A = 0x2D;
		ax_105 = -wArg0E;
		di_122 = di_122 + 0x01;
		cx_149 = -wArg10 - (ax_105 == 0x00);
	}
	byte Eq_438::* si_106 = fp - 0x24;
	if (cx_149 != 0x00)
	{
		do
		{
			uint32 dx_ax_156 = (uint32) (uint16) cx_149;
			uint32 dx_ax_162 = SEQ((uint16) (dx_ax_156 % wArg08), ax_105);
			ss->*si_106 = (byte) (uint16) (dx_ax_162 % wArg08);
			Eq_394 ax_159 = (uint16) (dx_ax_156 /u wArg08);
			cx_149 = ax_159;
			ax_105 = (uint16) (dx_ax_162 /u wArg08);
			si_106 = si_106 + 0x01;
		} while (ax_159 != 0x00);
l0918_005C:
		if (ax_105 == 0x00)
		{
			word16 cx_115 = si_106 + (0x24 - fp);
			do
			{
				byte al_134;
				si_106 = si_106 - 0x01;
				cu8 al_126 = ss->*si_106;
				if (al_126 < 0x0A)
					al_134 = al_126 + 0x30;
				else
					al_134 = al_126 - 0x0A + bArg04;
				es_19->*di_122 = al_134;
				di_122 = di_122 + 0x01;
				cx_115 = cx_115 - 0x01;
			} while (cx_115 != 0x00);
			goto l0918_007A;
		}
	}
	uint32 dx_ax_89 = (uint32) (uint16) ax_105;
	ss->*si_106 = (byte) (uint16) (dx_ax_89 % wArg08);
	ax_105 = (uint16) (dx_ax_89 /u wArg08);
	si_106 = si_106 + 0x01;
	goto l0918_005C;
}

// 093D:000E: Register word16 _printf(Register Eq_113 ds, Stack Eq_120 wArg04, Stack Eq_113 wArg06, Register out ptr16 siOut, Register out ptr16 diOut)
word16 _printf(Eq_113 ds, Eq_120 wArg04, Eq_113 wArg06, ptr16 & siOut, ptr16 & diOut)
{
	word16 si_36;
	word16 di_37;
	word16 bx_38 = __VPRINTER(fp - 0x02, ds, DPB(ptrLoc12, fp + 0x08, 0), DPB(ptrLoc0E, wArg04, 0), wArg06, out si_36, out di_37);
	return bx_38;
}

// 0967:000C: Register Eq_522 fn0967_000C(Register Eq_522 di, Register Eq_113 es, Register Eq_113 ds, Stack word16 wArg02)
Eq_522 fn0967_000C(Eq_522 di, Eq_113 es, Eq_113 ds, word16 wArg02)
{
	bcu8 dh_8 = SLICE(wArg02, byte, 8);
	es->*di = ds->*((word16) ((uint16) (dh_8 >> 0x04)) + 1101);
	es->*((word32) di + 0x01) = ds->*((word16) ((uint16) (dh_8 & 0x0F)) + 1101);
	bcu8 dl_9 = (byte) wArg02;
	es->*((word32) di + 0x02) = ds->*((word16) ((uint16) (dl_9 >> 0x04)) + 1101);
	es->*((word32) di + 0x03) = ds->*((word16) ((uint16) (dl_9 & 0x0F)) + 1101);
	return (word32) di + 0x04;
}

// 0967:0037: Register Eq_113 __VPRINTER(Register mp16 bp, Register Eq_113 ds, Stack (ptr Eq_505) ptrArg04, Stack segptr32 ptrArg08, Stack Eq_113 psegArg0A, Register out ptr16 siOut, Register out ptr16 diOut)
Eq_113 __VPRINTER(mp16 bp, Eq_113 ds, Eq_505 * ptrArg04, segptr32 ptrArg08, Eq_113 psegArg0A, ptr16 & siOut, ptr16 & diOut)
{
}

// 0967:0050: Register word16 fn0967_0050(Register Eq_113 di, Register Eq_113 es)
word16 fn0967_0050(Eq_113 di, Eq_113 es)
{
}

// 0967:005D: Register Eq_113 fn0967_005D(Register byte al, Register (memptr Eq_113 Eq_615) bp, Register (memptr Eq_113 byte) di, Register out Eq_712 dxOut, Register out Eq_713 bxOut, Register out Eq_714 diOut, Register out (ptr Eq_715) esOut)
Eq_113 fn0967_005D(byte al, Eq_615 Eq_113::*bp, byte Eq_113::*di, Eq_712 & dxOut, Eq_713 & bxOut, Eq_714 & diOut, Eq_715 * & esOut)
{
	*dxOut = dx;
	*bxOut = bx;
	*esOut = es;
	ss->*di = al;
	ci8 v8_8 = ss->*(bp - 0x55) - 0x01;
	ss->*(bp - 0x55) = v8_8;
	word16 di_6;
	*diOut = di + 0x01;
	if (v8_8 <= 0x00)
		return cx;
	word16 dx_20;
	word16 bx_21;
	word16 di_22;
	struct Eq_1478 * es_23;
	return fn0967_0066(bp, di + 0x01, out dx_20, out bx_21, out di_22, out es_23);
}

// 0967:0066: Register word16 fn0967_0066(Register (memptr Eq_113 Eq_615) bp, Register (memptr Eq_113 byte) di, Register out ptr16 dxOut, Register out Eq_618 bxOut, Register out Eq_619 diOut, Register out (ptr Eq_620) esOut)
word16 fn0967_0066(Eq_615 Eq_113::*bp, byte Eq_113::*di, ptr16 & dxOut, Eq_618 & bxOut, Eq_619 & diOut, Eq_620 * & esOut)
{
	struct Eq_1487 Eq_1489::* sp_34;
	word16 bx_35;
	struct Eq_1489 * ss_36;
	word16 cx_37;
	word16 dx_38;
	struct Eq_1492 * es_39;
	union Eq_1506 Eq_1489::* bp_40;
	word16 ax_41;
	word16 di_42;
	byte SCZO_43;
	byte SZO_44;
	byte C_45;
	byte Z_46;
	(ss->*bp).ptr0012();
	if (ax_41 == 0x00)
		(ss_36->*(bp_40 - 0x02)).u1 = 0x01;
	(ss_36->*(bp_40 - 0x55)).u0 = 0x50;
	(ss_36->*(bp_40 - 88)).u1 = (word16) (ss_36->*(bp_40 - 88)).u1 + di_42;
	word16 di_55;
	*diOut = bp_40 - 0x54;
	struct Eq_1527 * es_56;
	*esOut = (ss_36->*sp_34).ptr0000;
	word16 dx_58;
	*dxOut = (ss_36->*sp_34).w0002;
	word16 cx_60 = (ss_36->*sp_34).w0004;
	word16 bx_62;
	*bxOut = (ss_36->*sp_34).w0006;
	return cx_60;
}

// 09F1:0007: void _scanf(Register uint16 bx, Register word16 di, Register Eq_113 ds, Stack Eq_120 wArg04, Stack Eq_113 wArg06)
void _scanf(uint16 bx, word16 di, Eq_113 ds, Eq_120 wArg04, Eq_113 wArg06)
{
	__scanner(bx, fp - 0x02, di, ds, DPB(ptrLoc16, 0xF3, 0), 2222, DPB(ptrLoc12, 0x0E, 0), 0x0A63, 0x0256, ds, wArg04, wArg06);
}

// 09F4:0005: Register mp16 __scanner(Register uint16 bx, Register mp16 bp, Register word16 di, Register Eq_113 ds, Stack (ptr code) ptrArg04, Stack Eq_113 wArg06, Stack (ptr code) ptrArg08, Stack Eq_113 wArg0A, Stack Eq_113 wArg0C, Stack Eq_113 wArg0E, Stack Eq_120 wArg10, Stack Eq_113 psegArg12)
mp16 __scanner(uint16 bx, mp16 bp, word16 di, Eq_113 ds, code * ptrArg04, Eq_113 wArg06, code * ptrArg08, Eq_113 wArg0A, Eq_113 wArg0C, Eq_113 wArg0E, Eq_120 wArg10, Eq_113 psegArg12)
{
}

// 09F4:001A: Register word16 fn09F4_001A(Register (memptr Eq_113 Eq_1579) bp, Register Eq_113 ds, Register out (ptr Eq_1951) esOut)
word16 fn09F4_001A(Eq_1579 Eq_113::*bp, Eq_113 ds, Eq_1951 * & esOut)
{
	Eq_2530 es_di_5 = (ss->*bp).t0016;
	union Eq_2560 Eq_113::* di_6 = (word16) es_di_5;
	if (((ss->*(bp - 0x29)).t0000 & 0x20) == 0x00)
	{
		word16 di_26 = *es_di_5;
		(ss->*bp).t0016.u0 = (word16) (ss->*bp).t0016.u0 + 0x02;
		struct Eq_2558 * es_29;
		*esOut = ds;
		return di_26;
	}
	else
	{
		Eq_2560 es_di_19 = ds->*di_6;
		(ss->*bp).t0016.u0 = (word16) (ss->*bp).t0016.u0 + 0x04;
		struct Eq_2572 * es_21;
		*esOut = SLICE(es_di_19, selector, 16);
		return (word16) es_di_19;
	}
}

// 09F4:01D1: Register cu16 fn09F4_01D1(Register cu16 ax, Register (memptr Eq_113 Eq_1579) bp, Register Eq_113 ds, Register out ptr16 bpOut)
cu16 fn09F4_01D1(cu16 ax, Eq_1579 Eq_113::*bp, Eq_113 ds, ptr16 & bpOut)
{
	word16 bp_5;
	return fn09F4_047F(ax, bp, ds, out bp_5);
}

// 09F4:02C8: Register cu16 fn09F4_02C8(Register cu16 ax, Register (memptr Eq_113 Eq_1579) bp, Register Eq_113 ds, Register out ptr16 bpOut)
cu16 fn09F4_02C8(cu16 ax, Eq_1579 Eq_113::*bp, Eq_113 ds, ptr16 & bpOut)
{
	word16 bp_5;
	return fn09F4_047F(ax, bp, ds, out bp_5);
}

// 09F4:0460: Register word16 fn09F4_0460(Register (memptr Eq_113 Eq_1579) bp, Register out ptr16 bpOut)
word16 fn09F4_0460(Eq_1579 Eq_113::*bp, ptr16 & bpOut)
{
	ss->*(v3 - 0x02) = (ss->*bp).w0010;
	ss->*(v3 - 0x04) = (ss->*bp).w000E;
	ss->*(v3 - 0x06) = ~0x00;
	word16 sp_14;
	Eq_113 ss_15;
	struct Eq_1579 Eq_113::* bp_16;
	word16 ax_17;
	byte SCZO_18;
	byte C_19;
	struct Eq_2620 * es_20;
	word16 di_21;
	word16 si_22;
	(ss->*bp).ptr000A();
	ss_15->*(bp_16 - 0x28) = ss_15->*(bp_16 - 0x28) - (ss_15->*(bp_16 - 0x28) < 0x01);
	word16 bp_29;
	return fn09F4_0478(bp_16, out bp_29);
}

// 09F4:0478: Register Eq_2246 fn09F4_0478(Register (memptr Eq_113 Eq_1579) bp, Register out ptr16 bpOut)
Eq_2246 fn09F4_0478(Eq_1579 Eq_113::*bp, ptr16 & bpOut)
{
	Eq_2246 ax_7 = ss->*(bp - 0x28);
	word16 bp_12;
	*bpOut = (ss->*bp).a0000[0x00];
	return ax_7;
}

// 09F4:047F: Register cu16 fn09F4_047F(Register cu16 ax, Register (memptr Eq_113 Eq_1579) bp, Register Eq_113 ds, Register out ptr16 bpOut)
cu16 fn09F4_047F(cu16 ax, Eq_1579 Eq_113::*bp, Eq_113 ds, ptr16 & bpOut)
{
}

// 0A45:0003: FlagGroup bool fn0A45_0003(Register cu8 cl, Register cu8 bl)
bool fn0A45_0003(cu8 cl, cu8 bl)
{
	bool C_13;
	cu8 bl_26 = bl - 0x30;
	if (bl >= 0x30)
	{
		if (bl <= 0x39)
		{
l0A45_0020:
			if (bl_26 < cl)
			{
				C_13 = false;
				return C_13;
			}
			goto l0A45_002C;
		}
		if (bl <= 0x5A && bl >= 0x30)
			bl_26 = bl - 55;
		else
			bl_26 = bl - 0x57;
		if (bl_26 > 0x09)
			goto l0A45_0020;
	}
l0A45_002C:
	C_13 = true;
	return C_13;
}

// 0A45:0031: Register Eq_113 __scantol(Register Eq_113 ax, Register ui16 bx, Register Eq_113 ds, Stack (ptr code) ptrArg04, Stack (ptr code) ptrArg08, Stack Eq_113 wArg0C, Stack Eq_113 wArg0E, Stack Eq_113 wArg10, Stack Eq_113 wArg12, Stack (ptr word16) ptrArg14, Stack (ptr word16) ptrArg18, Register out ptr16 dxOut, Register out Eq_2116 bxOut, Register out ptr16 diOut)
Eq_113 __scantol(Eq_113 ax, ui16 bx, Eq_113 ds, code * ptrArg04, code * ptrArg08, Eq_113 wArg0C, Eq_113 wArg0E, Eq_113 wArg10, Eq_113 wArg12, word16 * ptrArg14, word16 * ptrArg18, ptr16 & dxOut, Eq_2116 & bxOut, ptr16 & diOut)
{
}

