// subject.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

// 0800:0121: void __exit()
void __exit()
{
	struct Eq_3 * ds_3 = 0x0800->ptr01F8;
	__restorezero(ds_3);
	struct Eq_11 Eq_26::* sp_6;
	struct Eq_12 * ds_7;
	struct Eq_13 * cs_8;
	word16 ax_9;
	byte SZO_10;
	byte C_11;
	word16 si_12;
	word16 cx_13;
	byte D_14;
	byte al_15;
	byte SCZO_16;
	byte ah_17;
	byte Z_18;
	word16 dx_19;
	word16 bp_20;
	struct Eq_26 * ss_21;
	(cs->*ds_3->ptr05DE)();
	word16 ax_22 = 0x00;
	cu8 al_23 = 0x00;
	byte ah_24 = 0x00;
	byte Eq_12::* si_28 = Eq_12::a0000;
	word16 cx_29 = 0x2F;
	do
	{
		al_23 = al_23 + ds_7->*si_28;
		ah_24 = ah_24 + (al_23 < 0x00);
		ax_22 = DPB(ax_22, ah_24, 8);
		si_28 = si_28 + 0x01;
		cx_29 = cx_29 - 0x01;
	} while (cx_29 != 0x00);
	byte al_47 = (byte) (ax_22 - 3383);
	if (ax_22 != 3383)
		fn0800_01DA(al_47, 0x19, 0x2F, ds_7);
	msdos_terminate((ss_21->*sp_6).b0002);
}

// 0800:01A5: void __restorezero(Register (ptr Eq_3) ds)
void __restorezero(Eq_3 * ds)
{
	msdos_set_interrupt_vector(0x00, ds->ptr0074);
	msdos_set_interrupt_vector(0x04, ds->ptr0078);
	msdos_set_interrupt_vector(0x05, ds->ptr007C);
	msdos_set_interrupt_vector(0x06, ds->ptr0080);
}

// 0800:01DA: void fn0800_01DA(Register byte al, Register word16 cx, Register word16 dx, Register (ptr Eq_12) ds)
void fn0800_01DA(byte al, word16 cx, word16 dx, Eq_12 * ds)
{
	word16 ax_8;
	msdos_write_file(0x02, cx, ds_dx, out ax_8);
}

// 0800:01FA: void _main(Register word16 bp, Register (ptr Eq_121) ds)
void _main(word16 bp, Eq_121 * ds)
{
	word16 si_18;
	word16 di_19;
	Eq_124 es_20;
	uint16 bx_21 = _printf(ds, 404, out si_18, out di_19, out es_20);
	_scanf(bx_21, di_19, es_20, ds, 0x01B1);
	Eq_147 si_100 = 0x01;
	while (si_100 <= ss->*(fp - 0x06))
	{
		(ss->*(fp - 0x0C)).u0 = 0x01B4;
		word16 si_63;
		word16 di_64;
		Eq_124 es_65;
		uint16 bx_66 = _printf(ds, wArg00, out si_63, out di_64, out es_65);
		ss->*(fp - 0x0C) = fp - 0x04;
		(ss->*(fp - 0x0E)).u0 = 0x01C3;
		_scanf(bx_66, di_64, es_65, ds, wArg00);
		ss->*(fp - 0x0C) = ss->*(fp - 0x04);
		ss->*(fp - 0x0C) = _fib(wArg00);
		ss->*(fp - 0x0E) = ss->*(fp - 0x04);
		(ss->*(fp - 0x10)).u0 = 454;
		word16 si_94;
		word16 di_95;
		struct Eq_222 * es_96;
		_printf(ds, wArg00, out si_94, out di_95, out es_96);
		si_100 = si_94 + 0x01;
	}
	(ss->*(fp - 0x0C)).u0 = 0x00;
	_exit(ds, wArg00);
}

// 0800:025B: Register word16 _fib(Stack Eq_129 wArg02)
word16 _fib(Eq_129 wArg02)
{
	word16 ax_18;
	if (wArg02 > 0x02)
		ax_18 = _fib(wArg02 - 0x01) + _fib((word32) wArg02 + 0x0000FFFE);
	else
		ax_18 = 0x01;
	return ax_18;
}

// 0800:02C7: void _exit(Register (ptr Eq_121) ds, Stack Eq_129 wArg02)
void _exit(Eq_121 * ds, Eq_129 wArg02)
{
	while (true)
	{
		ui16 ax_21 = ds->w0240;
		ds->w0240 = ds->w0240 - 0x01;
		if (ax_21 == 0x00)
			break;
		word16 sp_75;
		word16 bp_76;
		struct Eq_267 * ss_77;
		word16 ax_78;
		byte SZO_80;
		byte C_81;
		byte Z_82;
		word16 cx_84;
		word16 bx_85;
		byte SCZO_86;
		(cs->*(ds->a05EA)[ds->w0240])();
	}
	word16 sp_28;
	word16 bp_29;
	struct Eq_286 * ss_30;
	word16 ax_31;
	struct Eq_288 * ds_32;
	byte SZO_33;
	byte C_34;
	byte Z_35;
	struct Eq_292 * cs_36;
	word16 cx_37;
	word16 bx_38;
	byte SCZO_39;
	(cs->*ds->ptr0236)();
	word16 sp_40;
	word16 bp_41;
	struct Eq_301 * ss_42;
	word16 ax_43;
	struct Eq_303 * ds_44;
	byte SZO_45;
	byte C_46;
	byte Z_47;
	struct Eq_307 * cs_48;
	word16 cx_49;
	word16 bx_50;
	byte SCZO_51;
	(cs_36->*ds_32->ptr0238)();
	union Eq_129 Eq_316::* sp_52;
	word16 bp_53;
	struct Eq_316 * ss_54;
	word16 ax_55;
	struct Eq_318 * ds_56;
	byte SZO_57;
	byte C_58;
	byte Z_59;
	struct Eq_322 * cs_60;
	word16 cx_61;
	word16 bx_62;
	byte SCZO_63;
	(cs_48->*ds_44->ptr023A)();
	ss_54->*(sp_52 - 0x02) = wArg02;
	__exit();
}

// 0800:0C19: void __LONGTOA(Register (ptr Eq_121) ds, Stack byte bArg02, Stack byte bArg04, Stack Eq_129 wArg06, Stack (memptr (ptr Eq_121) byte) wArg08, Stack uint16 wArg0A, Stack Eq_343 wArg0C)
void __LONGTOA(Eq_121 * ds, byte bArg02, byte bArg04, Eq_129 wArg06, byte Eq_121::*wArg08, uint16 wArg0A, Eq_343 wArg0C)
{
	byte Eq_121::* di_119 = wArg08;
	cu8 bl_25 = (byte) wArg06;
	if (wArg06 > 0x24 || bl_25 < 0x02)
	{
l0800_0C87:
		ds->*di_119 = 0x00;
		return;
	}
	uint16 ax_103 = wArg0A;
	Eq_343 cx_145 = wArg0C;
	if (wArg0C < 0x00 && bArg04 != 0x00)
	{
		ds->*wArg08 = 0x2D;
		ax_103 = -wArg0A;
		di_119 = wArg08 + 0x01;
		cx_145 = -wArg0C - (ax_103 == 0x00);
	}
	byte Eq_121::* si_104 = fp - 0x24;
	if (cx_145 != 0x00)
	{
		do
		{
			uint32 dx_ax_152 = (uint32) (uint16) cx_145;
			uint32 dx_ax_158 = SEQ((uint16) (dx_ax_152 % wArg06), ax_103);
			ds->*si_104 = (byte) (uint16) (dx_ax_158 % wArg06);
			Eq_343 ax_155 = (uint16) (dx_ax_152 /u wArg06);
			cx_145 = ax_155;
			ax_103 = (uint16) (dx_ax_158 /u wArg06);
			si_104 = si_104 + 0x01;
		} while (ax_155 != 0x00);
l0800_0C6A:
		if (ax_103 == 0x00)
		{
			word16 cx_113 = si_104 + (0x24 - fp);
			do
			{
				byte al_131;
				si_104 = si_104 - 0x01;
				cu8 al_123 = ds->*si_104;
				if (al_123 < 0x0A)
					al_131 = al_123 + 0x30;
				else
					al_131 = al_123 - 0x0A + bArg02;
				ds->*di_119 = al_131;
				di_119 = di_119 + 0x01;
				cx_113 = cx_113 - 0x01;
			} while (cx_113 != 0x00);
			goto l0800_0C87;
		}
	}
	uint32 dx_ax_88 = (uint32) (uint16) ax_103;
	ds->*si_104 = (byte) (uint16) (dx_ax_88 % wArg06);
	ax_103 = (uint16) (dx_ax_88 /u wArg06);
	si_104 = si_104 + 0x01;
	goto l0800_0C6A;
}

// 0800:0E11: Register word16 _printf(Register (ptr Eq_121) ds, Stack Eq_129 wArg02, Register out ptr16 siOut, Register out ptr16 diOut, Register out (ptr Eq_132) esOut)
word16 _printf(Eq_121 * ds, Eq_129 wArg02, ptr16 & siOut, ptr16 & diOut, Eq_132 * & esOut)
{
	word16 si_20;
	word16 di_21;
	struct Eq_445 * es_22;
	word16 bx_23 = __VPRINTER(fp - 0x02, ds, fp + 0x04, wArg02, out si_20, out di_21, out es_22);
	return bx_23;
}

// 0800:100A: void __REALCVT()
void __REALCVT()
{
	word16 sp_4;
	struct Eq_466 * ds_5;
	ds->t05E2();
}

// 0800:100E: Register Eq_470 fn0800_100E(Register Eq_470 di, Register (ptr Eq_471) es, Register (ptr Eq_121) ds, Stack word16 wArg02)
Eq_470 fn0800_100E(Eq_470 di, Eq_471 * es, Eq_121 * ds, word16 wArg02)
{
	bcu8 dh_8 = SLICE(wArg02, byte, 8);
	es->*di = ds->*((word16) ((uint16) (dh_8 >> 0x04)) + 0x04EB);
	es->*((word32) di + 0x01) = ds->*((word16) ((uint16) (dh_8 & 0x0F)) + 0x04EB);
	bcu8 dl_9 = (byte) wArg02;
	es->*((word32) di + 0x02) = ds->*((word16) ((uint16) (dl_9 >> 0x04)) + 0x04EB);
	es->*((word32) di + 0x03) = ds->*((word16) ((uint16) (dl_9 & 0x0F)) + 0x04EB);
	return (word32) di + 0x04;
}

// 0800:1039: Register Eq_516 __VPRINTER(Register mp16 bp, Register (ptr Eq_121) ds, Stack (memptr (ptr Eq_121) Eq_451) wArg02, Stack Eq_129 wArg04, Register out ptr16 siOut, Register out ptr16 diOut, Register out (ptr Eq_455) esOut)
Eq_516 __VPRINTER(mp16 bp, Eq_121 * ds, Eq_451 Eq_121::*wArg02, Eq_129 wArg04, ptr16 & siOut, ptr16 & diOut, Eq_455 * & esOut)
{
}

// 0800:1052: Register word16 fn0800_1052(Register Eq_645 di, Register (ptr Eq_471) es)
word16 fn0800_1052(Eq_645 di, Eq_471 * es)
{
}

// 0800:105F: Register Eq_516 fn0800_105F(Register byte al, Register (memptr (ptr Eq_1394) Eq_563) bp, Register (memptr (ptr Eq_121) byte) di, Register (ptr Eq_121) ds, Register out Eq_664 dxOut, Register out Eq_665 bxOut, Register out Eq_666 diOut, Register out (ptr Eq_667) esOut)
Eq_516 fn0800_105F(byte al, Eq_563 Eq_1394::*bp, byte Eq_121::*di, Eq_121 * ds, Eq_664 & dxOut, Eq_665 & bxOut, Eq_666 & diOut, Eq_667 * & esOut)
{
	*dxOut = dx;
	*bxOut = bx;
	*esOut = es;
	ds->*di = al;
	ci8 v9_9 = ss->*(bp - 0x55) - 0x01;
	ss->*(bp - 0x55) = v9_9;
	word16 di_6;
	*diOut = di + 0x01;
	if (v9_9 <= 0x00)
		return cx;
	word16 dx_21;
	word16 bx_22;
	word16 di_23;
	struct Eq_1416 * es_24;
	return fn0800_1067(bp, di + 0x01, out dx_21, out bx_22, out di_23, out es_24);
}

// 0800:1067: Register word16 fn0800_1067(Register (memptr (ptr Eq_1394) Eq_563) bp, Register (memptr (ptr Eq_121) byte) di, Register out ptr16 dxOut, Register out Eq_566 bxOut, Register out Eq_567 diOut, Register out (ptr Eq_568) esOut)
word16 fn0800_1067(Eq_563 Eq_1394::*bp, byte Eq_121::*di, ptr16 & dxOut, Eq_566 & bxOut, Eq_567 & diOut, Eq_568 * & esOut)
{
	struct Eq_1425 Eq_1427::* sp_30;
	word16 bx_31;
	struct Eq_1427 * ss_32;
	word16 cx_33;
	word16 dx_34;
	struct Eq_1430 * es_35;
	union Eq_1447 Eq_1427::* bp_36;
	word16 ax_37;
	word16 di_38;
	byte SCZO_39;
	struct Eq_1435 * cs_40;
	byte SZO_41;
	byte C_42;
	byte Z_43;
	(cs->*(ss->*bp).ptr000A)();
	if (ax_37 == 0x00)
		(ss_32->*(bp_36 - 0x02)).u1 = 0x01;
	(ss_32->*(bp_36 - 0x55)).u0 = 0x50;
	(ss_32->*(bp_36 - 88)).u1 = (word16) (ss_32->*(bp_36 - 88)).u1 + di_38;
	word16 di_52;
	*diOut = bp_36 - 0x54;
	struct Eq_1468 * es_53;
	*esOut = (ss_32->*sp_30).ptr0000;
	word16 dx_55;
	*dxOut = (ss_32->*sp_30).w0002;
	word16 cx_57 = (ss_32->*sp_30).w0004;
	word16 bx_59;
	*bxOut = (ss_32->*sp_30).w0006;
	return cx_57;
}

// 0800:169A: void _scanf(Register uint16 bx, Register word16 di, Register Eq_124 es, Register (ptr Eq_121) ds, Stack Eq_129 wArg02)
void _scanf(uint16 bx, word16 di, Eq_124 es, Eq_121 * ds, Eq_129 wArg02)
{
	__scanner(bx, fp - 0x02, di, es, ds, 0x07B8, 7467, 0x0344, wArg02);
}

// 0800:16B9: Register mp16 __scanner(Register uint16 bx, Register mp16 bp, Register word16 di, Register Eq_124 es, Register (ptr Eq_121) ds, Stack Eq_124 wArg02, Stack Eq_124 wArg04, Stack Eq_124 wArg06, Stack Eq_129 wArg08)
mp16 __scanner(uint16 bx, mp16 bp, word16 di, Eq_124 es, Eq_121 * ds, Eq_124 wArg02, Eq_124 wArg04, Eq_124 wArg06, Eq_129 wArg08)
{
}

// 0800:16CE: Register Eq_2385 fn0800_16CE(Register (memptr Eq_124 Eq_1511) bp, Register (ptr Eq_121) ds, Register out (ptr Eq_1848) esOut)
Eq_2385 fn0800_16CE(Eq_1511 Eq_124::*bp, Eq_121 * ds, Eq_1848 * & esOut)
{
	union Eq_2385 Eq_121::* di_5 = bp[0x06];
	if (((ss->*(bp - 0x29)).t0000 & 0x20) == 0x00)
	{
		Eq_2385 di_26 = ds->*di_5;
		bp[0x06] = (union Eq_2385 Eq_121::*) ((char *) bp[0x06] + 0x02);
		struct Eq_2412 * es_29;
		*esOut = ds;
		return di_26;
	}
	else
	{
		Eq_2385 es_di_19 = ds->*di_5;
		bp[0x06] = (union Eq_2385 Eq_121::*) ((char *) bp[0x06] + 0x04);
		struct Eq_2426 * es_21;
		*esOut = SLICE(es_di_19, selector, 16);
		return (word16) es_di_19;
	}
}

// 0800:185E: Register cu16 fn0800_185E(Register cu16 ax, Register (memptr Eq_124 Eq_1511) bp, Register (ptr Eq_121) ds, Register out ptr16 bpOut)
cu16 fn0800_185E(cu16 ax, Eq_1511 Eq_124::*bp, Eq_121 * ds, ptr16 & bpOut)
{
	word16 bp_5;
	return fn0800_1ACC(ax, bp, ds, out bp_5);
}

// 0800:1935: Register cu16 fn0800_1935(Register cu16 ax, Register (memptr Eq_124 Eq_1511) bp, Register (ptr Eq_121) ds, Register out ptr16 bpOut)
cu16 fn0800_1935(cu16 ax, Eq_1511 Eq_124::*bp, Eq_121 * ds, ptr16 & bpOut)
{
	word16 bp_5;
	return fn0800_1ACC(ax, bp, ds, out bp_5);
}

// 0800:1AB1: Register word16 fn0800_1AB1(Register (memptr Eq_124 Eq_1511) bp, Register out ptr16 bpOut)
word16 fn0800_1AB1(Eq_1511 Eq_124::*bp, ptr16 & bpOut)
{
	ss->*(v3 - 0x02) = bp[0x04];
	ss->*(v3 - 0x04) = ~0x00;
	word16 sp_12;
	Eq_124 ss_13;
	struct Eq_1511 Eq_124::* bp_14;
	word16 ax_15;
	struct Eq_2464 * cs_16;
	word16 cx_17;
	byte SCZO_18;
	byte C_19;
	struct Eq_2468 * es_20;
	word16 di_21;
	word16 si_22;
	(cs->*bp[0x03])();
	ss_13->*(bp_14 - 0x28) = ss_13->*(bp_14 - 0x28) - (ss_13->*(bp_14 - 0x28) < 0x01);
	word16 bp_32;
	return fn0800_1AC5(bp_14, out bp_32);
}

// 0800:1AC5: Register Eq_2108 fn0800_1AC5(Register (memptr Eq_124 Eq_1511) bp, Register out ptr16 bpOut)
Eq_2108 fn0800_1AC5(Eq_1511 Eq_124::*bp, ptr16 & bpOut)
{
	Eq_2108 ax_7 = ss->*(bp - 0x28);
	word16 bp_12;
	*bpOut = (ss->*bp).a0000[0x00];
	return ax_7;
}

// 0800:1ACC: Register cu16 fn0800_1ACC(Register cu16 ax, Register (memptr Eq_124 Eq_1511) bp, Register (ptr Eq_121) ds, Register out ptr16 bpOut)
cu16 fn0800_1ACC(cu16 ax, Eq_1511 Eq_124::*bp, Eq_121 * ds, ptr16 & bpOut)
{
}

// 0800:1B58: void __scantod()
void __scantod()
{
	word16 sp_4;
	struct Eq_2589 * ds_5;
	ds->t05E4();
}

// 0800:1B5C: void __scanrslt()
void __scanrslt()
{
	word16 sp_4;
	struct Eq_2594 * ds_5;
	ds->t05E6();
}

// 0800:1B60: void __scanpop()
void __scanpop()
{
	word16 sp_4;
	struct Eq_2599 * ds_5;
	ds->t05E8();
}

// 0800:1B64: FlagGroup bool fn0800_1B64(Register cu8 cl, Register cu8 bl)
bool fn0800_1B64(cu8 cl, cu8 bl)
{
	bool C_13;
	cu8 bl_26 = bl - 0x30;
	if (bl >= 0x30)
	{
		if (bl <= 0x39)
		{
l0800_1B81:
			if (bl_26 < cl)
			{
				C_13 = false;
				return C_13;
			}
			goto l0800_1B8D;
		}
		if (bl <= 0x5A && bl >= 0x30)
			bl_26 = bl - 55;
		else
			bl_26 = bl - 0x57;
		if (bl_26 > 0x09)
			goto l0800_1B81;
	}
l0800_1B8D:
	C_13 = true;
	return C_13;
}

// 0800:1B92: Register Eq_124 __scantol(Register Eq_124 ax, Register ui16 bx, Register (ptr Eq_121) ds, Stack Eq_124 wArg06, Stack Eq_124 wArg08, Stack Eq_129 wArg0A, Stack (memptr (ptr Eq_2655) word16) wArg0C, Stack (memptr (ptr Eq_2655) word16) wArg0E, Register out ptr16 dxOut, Register out Eq_1978 bxOut, Register out ptr16 diOut, Register out (ptr Eq_1980) esOut)
Eq_124 __scantol(Eq_124 ax, ui16 bx, Eq_121 * ds, Eq_124 wArg06, Eq_124 wArg08, Eq_129 wArg0A, word16 Eq_2655::*wArg0C, word16 Eq_2655::*wArg0E, ptr16 & dxOut, Eq_1978 & bxOut, ptr16 & diOut, Eq_1980 * & esOut)
{
}

