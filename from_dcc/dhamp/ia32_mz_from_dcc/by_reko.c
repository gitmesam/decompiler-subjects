// subject_0800.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject_0800.h"

// 0800:010D: void __exit()
// Called from:
//      _exit
void __exit()
{
	struct Eq_46 * ds_5 = seg0800->ptr01C7;
	__restorezero(ds_5);
	struct Eq_53 Eq_60::* sp_9;
	(seg0800->*ds_5->ptr0600)();
	msdos_terminate((ss->*sp_9).b0004);
}

// 0800:0172: void __restorezero(Register (ptr16 Eq_46) ds)
// Called from:
//      __exit
void __restorezero(struct Eq_46 * ds)
{
	msdos_set_interrupt_vector(0x00, ds->ptr005B);
	msdos_set_interrupt_vector(0x04, ds->ptr005F);
	msdos_set_interrupt_vector(0x05, ds->ptr0063);
	msdos_set_interrupt_vector(0x06, ds->ptr0067);
}

// 0800:0711: void fn0800_0711(Register Eq_97 ax, Register Eq_98 cx, Register Eq_99 dx, Register Eq_100 bx)
// Called from:
//      fn0BD0_0081
//      __sbrk
//      fn0D7F_00B5
//      fn0D7F_0212
//      _farfree
void fn0800_0711(Eq_97 ax, Eq_98 cx, Eq_99 dx, Eq_100 bx)
{
	if (cx >= 0x00)
		return;
	cup16 bx_44 = ~bx;
}

// 0800:076C: FlagGroup Eq_97 fn0800_076C(Register Eq_97 ax, Register Eq_99 cx, Register Eq_99 dx, Register Eq_97 bx, Register out ptr16 dxOut)
// Called from:
//      __pull_free_block
//      fn0BD0_0081
//      _farmalloc
//      __brk
//      __sbrk
//      fn0D7F_0016
//      fn0D7F_00B5
//      fn0D7F_012D
//      fn0D7F_0212
//      _farfree
Eq_97 fn0800_076C(Eq_97 ax, Eq_99 cx, Eq_99 dx, Eq_97 bx, ptr16 & dxOut)
{
	ptr16 dx_15 = (word32) dx + (ax >> 0x04);
	dxOut = dx_15;
	return <invalid>;
}

// subject_087B.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject_087B.h"

// 0800:07B0: void __REALCVT(Register Eq_99 ds)
// Called from:
//      __VPRINTER
void __REALCVT(Eq_99 ds)
{
	(*((word32) ds + 0x0604))();
}

// 087B:0004: void _main(Register Eq_99 cx, Register Eq_99 dx, Register Eq_99 bx, Register (ptr16 Eq_134) es, Register Eq_99 ds)
void _main(Eq_99 cx, Eq_99 dx, Eq_99 bx, struct Eq_134 * es, Eq_99 ds)
{
	struct Eq_136 Eq_99::* bp_127 = fp - 2;
	wchar_t si_217 = _printf(cx, dx, bx, ds, SEQ(ds, 0x98));
	struct Eq_151 Eq_99::* sp_104 = fp - 0xD8;
	while (true)
	{
		byte ch_120 = SLICE(cx, byte, 8);
		byte cl_121 = (byte) cx;
		if (si_217 >= 0x06)
			break;
		if (si_217 <= 0x05)
		{
			bx = si_217 << 0x01;
			switch (si_217)
			{
			case L'\x00':
				struct Eq_184 Eq_99::* sp_361 = sp_104 - 2;
				(ss->*sp_361).t0000 = ss;
				(ss->*sp_361).tFFFFFFFE = bp_127 - 0x70;
				(ss->*sp_361).tFFFFFFFC = ss;
				(ss->*sp_361).tFFFFFFFA = bp_127 - 212;
				*((word32) ds + 0x0618) = _stest(ds, (ss->*sp_361).tFFFFFFFA, (ss->*sp_361).tFFFFFFFE, out dx, out bx, out es);
				(ss->*sp_361).t0000 = *((word32) ds + 0x0618);
				(ss->*sp_361).tFFFFFFFE = ds;
				(ss->*sp_361).tFFFFFFFC.u0 = 0xA5;
				si_217 = _printf(cx, dx, bx, ds, (ss->*sp_361).tFFFFFFFC);
				sp_104 = (struct Eq_151 Eq_99::*) ((char *) &sp_361->t0000 + 2);
				break;
			case L'\x01':
				*((word32) ds + 0x061A) = _intest();
				struct Eq_247 Eq_99::* sp_343 = sp_104 - 2;
				(ss->*sp_343).t0000 = *((word32) ds + 0x061A);
				(ss->*sp_343).tFFFFFFFE = ds;
				(ss->*sp_343).tFFFFFFFC.u0 = 0xB4;
				si_217 = _printf(cx, dx, bx, ds, (ss->*sp_343).tFFFFFFFC);
				sp_104 = (struct Eq_151 Eq_99::*) ((char *) &sp_343->t0000 + 2);
				break;
			case L'\x02':
				struct Eq_269 Eq_99::* sp_306 = sp_104 - 2;
				(ss->*sp_306).t0000.u0 = 0x18;
				Eq_99 ax_308 = _fib((ss->*sp_306).t0000, out dx);
				cx = (ss->*sp_306).t0000;
				*((word32) ds + 1566) = ax_308;
				(ss->*sp_306).t0000 = *((word32) ds + 1566);
				(ss->*sp_306).tFFFFFFFE = ds;
				(ss->*sp_306).tFFFFFFFC.u0 = 0xC3;
				si_217 = _printf(cx, dx, bx, ds, (ss->*sp_306).tFFFFFFFC);
				sp_104 = (struct Eq_151 Eq_99::*) ((char *) &sp_306->t0000 + 2);
				break;
			case L'\x03':
				(ss->*bp_127).tFFFFFFF6.u0 = 0x00;
				(ss->*bp_127).tFFFFFFF4.u0 = 0x00;
				struct Eq_318 Eq_99::* sp_228 = sp_104 - 2;
				(ss->*sp_228).t0000 = (ss->*bp_127).tFFFFFFF6;
				(ss->*sp_228).tFFFFFFFE = (ss->*bp_127).tFFFFFFF4;
				Eq_99 dx_234;
				Eq_99 ax_233 = _sq(ds, (ss->*sp_228).tFFFFFFFE, out dx_234);
				*((word32) ds + 0x0622) = dx_234;
				*((word32) ds + 0x0620) = ax_233;
				(ss->*sp_228).t0000 = *((word32) ds + 0x0622);
				(ss->*sp_228).tFFFFFFFE = *((word32) ds + 0x0620);
				Eq_99 ax_251 = _sq(ds, (ss->*sp_228).tFFFFFFFE, out dx);
				cx = (ss->*sp_228).t0000;
				(ss->*bp_127).tFFFFFFF6 = dx;
				(ss->*bp_127).tFFFFFFF4 = ax_251;
				(ss->*sp_228).t0000 = *((word32) ds + 0x0622);
				(ss->*sp_228).tFFFFFFFE = *((word32) ds + 0x0620);
				(ss->*sp_228).tFFFFFFFC = ds;
				(ss->*sp_228).tFFFFFFFA.u0 = 0xD2;
				_printf(cx, dx, bx, ds, (ss->*sp_228).tFFFFFFFA);
				(ss->*sp_228).t0000 = (ss->*bp_127).tFFFFFFF6;
				(ss->*sp_228).tFFFFFFFE = (ss->*bp_127).tFFFFFFF4;
				(ss->*sp_228).tFFFFFFFC = ds;
				(ss->*sp_228).tFFFFFFFA.u0 = 225;
				si_217 = _printf(cx, dx, bx, ds, (ss->*sp_228).tFFFFFFFA);
				sp_104 = (struct Eq_151 Eq_99::*) ((char *) &sp_228->t0000 + 2);
				break;
			case L'\x04':
				Eq_99 ax_108 = *((word32) ds + 0x0620);
				dx = *((word32) ds + 0x0622);
				struct Eq_428 Eq_99::* sp_109 = sp_104 - 2;
				(ss->*sp_109).t0000 = dx;
				(ss->*sp_109).tFFFFFFFE = ax_108;
				__syscall(55);
				*((word32) ds + 0x0000CDFF) = SLICE(ax_108, byte, 8);
				byte al_119 = __inb(dx);
				__syscall(0x3D);
				byte ch_122 = ch_120 | cl_121;
				byte cl_128 = _sroot(al_119, SEQ(ch_122, cl_121), es, ds, out bp_127);
				__syscall(0x39);
				Eq_97 sp_130 = <invalid>;
				ss->*((word32) sp_130 + 6) = ds;
				__syscall(0x3D);
				ss->*((word32) sp_130 + 4) = *((word32) ds + 0x062A);
				ss->*((word32) sp_130 + 2) = *((word32) ds + 0x0628);
				ss->*sp_130 = *((word32) ds + 0x0626);
				ss->*((word32) sp_130 - 2) = *((word32) ds + 0x0624);
				ss->*((word32) sp_130 - 4) = ds;
				(ss->*((word32) sp_130 - 6)).u0 = 0xF1;
				cx = SEQ(ch_122, cl_128);
				_printf(cx, dx, bx, ds, ss->*((word32) sp_130 - 6));
				ss->*((word32) sp_130 + 4) = *((word32) ds + 0x062A);
				ss->*((word32) sp_130 + 2) = *((word32) ds + 0x0628);
				ss->*sp_130 = *((word32) ds + 0x0626);
				ss->*((word32) sp_130 - 2) = *((word32) ds + 0x0624);
				_dply(es);
				__syscall(0x39);
				__syscall(0x3D);
				ss->*((word32) sp_130 + 6) = (ss->*bp_127).tFFFFFFFE;
				ss->*((word32) sp_130 + 4) = (ss->*bp_127).wFFFFFFFC;
				ss->*((word32) sp_130 + 2) = (ss->*bp_127).wFFFFFFFA;
				ss->*sp_130 = (ss->*bp_127).tFFFFFFF8;
				ss->*((word32) sp_130 - 2) = ds;
				(ss->*((word32) sp_130 - 4)).u0 = 0x0100;
				si_217 = _printf(cx, dx, bx, ds, ss->*((word32) sp_130 - 4));
				sp_104 = (struct Eq_151 Eq_99::*) ((word32) sp_130 + 8);
				break;
			case L'\x05':
				*((word32) ds + 0x061C) = _mcopy(ds, out cx, out dx, out bx, out es);
				struct Eq_591 Eq_99::* sp_89 = sp_104 - 2;
				(ss->*sp_89).t0000 = *((word32) ds + 0x061C);
				(ss->*sp_89).tFFFFFFFE = ds;
				(ss->*sp_89).tFFFFFFFC.u0 = 0x010E;
				si_217 = _printf(cx, dx, bx, ds, (ss->*sp_89).tFFFFFFFC);
				sp_104 = (struct Eq_151 Eq_99::*) &sp_89->w0002;
				break;
			}
		}
		++si_217;
	}
	struct Eq_160 Eq_99::* sp_43 = sp_104 - 2;
	(ss->*sp_43).w0000 = 0x07;
	(ss->*sp_43).tFFFFFFFE = ds;
	(ss->*sp_43).tFFFFFFFC.u0 = 0x011C;
	_printf(cx, dx, bx, ds, (ss->*sp_43).tFFFFFFFC);
}

// 087B:01C4: Register word16 _sq(Register Eq_99 ds, Stack Eq_99 dwArg04, Register out ptr16 dxOut)
// Called from:
//      _main
word16 _sq(Eq_99 ds, Eq_99 dwArg04, ptr16 & dxOut)
{
	cui16 wArg04 = (word16) dwArg04;
	cui16 wArg06 = SLICE(dwArg04, word16, 16);
	word16 wArg04_101;
	ptr16 wArg06_100;
	Eq_99 dwArg04_110 = dwArg04;
	if ((wArg04 | wArg06) == 0x00)
	{
		ci16 si_44 = 0x00;
		while (true)
		{
			wArg06_100 = SLICE(dwArg04_110, word16, 16);
			wArg04_101 = (word16) dwArg04_110;
			if (si_44 >= 9000)
				break;
			Eq_99 v15_v14_85 = (word32) dwArg04_110 + SEQ(*((word32) ds + 0x0096), *((word32) ds + 0x0094));
			uint16 v16_62 = *((word32) ds + 0x0094) + 0x02;
			*((word32) ds + 0x0094) = v16_62;
			*((word32) ds + 0x0096) = (ui16) ((bool) (v16_62 < 0x00) + *((word32) ds + 0x0096));
			++si_44;
			dwArg04_110 = v15_v14_85;
		}
	}
	else
	{
		ci16 si_17 = 0x00;
		while (true)
		{
			wArg06_100 = SLICE(dwArg04_110, word16, 16);
			wArg04_101 = (word16) dwArg04_110;
			if (si_17 >= 9000)
				break;
			uint16 v18_25 = *((word32) ds + 0x0094) - 0x02;
			*((word32) ds + 0x0094) = v18_25;
			*((word32) ds + 0x0096) -= v18_25 < 0x00;
			++si_17;
			dwArg04_110 -= SEQ(*((word32) ds + 0x0096), *((word32) ds + 0x0094));
		}
	}
	dxOut = wArg06_100;
	return wArg04_101;
}

// 087B:0221: Register byte _sroot(Register byte al, Register Eq_459 cx, Register (ptr16 Eq_134) es, Register Eq_99 ds, Register out Eq_462 bpOut)
// Called from:
//      _main
byte _sroot(byte al, Eq_459 cx, struct Eq_134 * es, Eq_99 ds, union Eq_462 & bpOut)
{
	__syscall(0x39);
	__syscall(0x38);
	__daa(al, &al);
	__syscall(0x3D);
	struct Eq_695 Eq_700::* bp_114 = (word16) cx + (fp - 2);
	(ss->*bp_114).wFFFFFFF6 = (ss->*bp_114).w000C;
	(ss->*bp_114).wFFFFFFF4 = (ss->*bp_114).w000A;
	(ss->*bp_114).wFFFFFFF2 = (ss->*bp_114).w0008;
	word16 ax_27 = (ss->*bp_114).w0006;
	(ss->*bp_114).wFFFFFFF0 = ax_27;
	struct Eq_726 Eq_700::* sp_100 = fp - 0x14;
	byte al_110 = (byte) ax_27;
	while (true)
	{
		__syscall(0x39);
		struct Eq_134 * Eq_700::* sp_30 = sp_100 - 2;
		ss->*sp_30 = es;
		__das(al_110, &al_110);
		__syscall(0x38);
		struct Eq_134 * si_41 = ss->*sp_30;
		__lock();
		__syscall(0x39);
		__syscall(0x3D);
		byte ah_45 = *((word32) ds + 1581);
		byte cl_39 = (byte) cx;
		word16 bp_38 = bp_114 + cx;
		struct Eq_769 Eq_700::* sp_42 = (char *) sp_30 + 2;
		Eq_772 ax_78 = SEQ(ah_45, al_110 - 0x06);
		Eq_776 CZ_128 = SLICE(ah_45, bool, 2);
		if (Test(UGE,SLICE(ah_45, bool, 1)))
			break;
		do
		{
			__syscall(0x39);
			sp_42 -= 2;
			(ss->*sp_42).w0000 = es;
			__syscall(0x38);
			si_41 = (struct Eq_134 *) ((char *) si_41 + 1);
		} while (SLICE(cond(si_41), bool, 2) | SLICE(CZ_128, bool, 2));
		__syscall(0x38);
		__syscall(0x39);
		word16 si_61 = (ss->*sp_42).w0000;
		__lock();
		__syscall(0x3D);
		(ss->*sp_42).w0000 = (ss->*bp_38).wFFFFFFF6;
		(ss->*sp_42).wFFFFFFFE = (ss->*bp_38).wFFFFFFF4;
		(ss->*sp_42).wFFFFFFFC = (ss->*bp_38).wFFFFFFF2;
		(ss->*sp_42).wFFFFFFFA = (ss->*bp_38).wFFFFFFF0;
		al_110 = (byte) (uint16) (uint8) _abs(ax_78, cx, si_61, es, ds);
		__syscall(0x39);
		word16 si_94 = sp_42[1];
		__lock();
		__syscall(0x3D);
		Eq_865 CZ_130 = SLICE(cond(sp_42 + 1), bool, 2);
		sp_100 = (struct Eq_726 Eq_700::*) (sp_42 + 2);
		do
		{
			__syscall(0x39);
			sp_100 -= 2;
			(ss->*sp_100).w0000 = es;
			__syscall(0x38);
			++si_94;
		} while (SLICE(cond(si_94), bool, 2) | SLICE(CZ_130, bool, 2));
		__syscall(0x38);
		__syscall(0x38);
		__daa(al_110, &al_110);
		__syscall(0x3D);
		bp_114 = bp_38 + cx;
	}
	__syscall(0x39);
	bpOut = (ss->*bp_38).t0000;
	return cl_39;
}

// 087B:02B8: Register Eq_772 _abs(Register Eq_772 al, Register Eq_459 cx, Register word16 si, Register (ptr16 Eq_134) es, Register Eq_99 ds)
// Called from:
//      _sroot
Eq_772 _abs(Eq_772 al, Eq_459 cx, word16 si, struct Eq_134 * es, Eq_99 ds)
{
	byte al_43 = (byte) ax;
	__syscall(0x39);
	__syscall(0x3A);
	struct Eq_910 Eq_922::* sp_30 = fp - 4;
	do
	{
		__syscall(0x3D);
		byte ah_24 = *((word32) ds + 1581);
		word16 ax_47 = SEQ(ah_24, al_43);
		if (Test(UGE,SLICE(ah_24, bool, 1)))
		{
			__syscall(0x39);
			(ss->*sp_30).wFFFFFFFE = es;
			return (byte) ax_47;
		}
		__syscall(0x39);
		sp_30 -= 2;
		(ss->*sp_30).w0000 = es;
		__syscall(0x35);
		++si;
		--cx;
	} while (si != 0x00 && cx != 0x00);
	ax_47 = SEQ(ah_24, al_43 + ~0x32);
	return (byte) ax_47;
}

// 087B:02E6: void _dply(Register (ptr16 Eq_134) es)
// Called from:
//      _main
void _dply(struct Eq_134 * es)
{
	struct Eq_955 Eq_972::* sp_11 = fp - 0x0C;
	struct Eq_134 * si_110 = 100;
	while (si_110 != 0x00)
	{
		__syscall(0x39);
		struct Eq_969 Eq_972::* sp_34 = sp_11 - 2;
		(ss->*sp_34).ptr0000 = es;
		__syscall(0x38);
		(ss->*sp_34).ptrFFFFFFFE = es;
		__syscall(0x38);
		(ss->*sp_34).ptrFFFFFFFC = es;
		__syscall(0x38);
		(ss->*sp_34).ptrFFFFFFFA = es;
		__syscall(0x38);
		(ss->*sp_34).ptrFFFFFFF8 = es;
		__syscall(0x38);
		(ss->*sp_34).ptrFFFFFFF6 = es;
		__syscall(0x38);
		(ss->*sp_34).ptrFFFFFFF4 = es;
		__syscall(0x39);
		struct Eq_134 * si_55 = (ss->*sp_34).ptrFFFFFFF4;
		__syscall(0x3D);
		__syscall(0x39);
		__syscall(0x38);
		struct Eq_1028 Eq_972::* sp_56 = sp_34 - 0x0A;
		if (si_55 > 0x01)
		{
			__syscall(0x38);
			if (si_55 <= 0x01)
				goto l087B_0337;
			__syscall(0x38);
			__syscall(0x38);
			__syscall(0x38);
			__syscall(0x38);
			__syscall(0x39);
		}
		__syscall(0x3D);
		sp_56 = sp_34 - 8;
l087B_0337:
		__syscall(0x39);
		__syscall(0x38);
		struct Eq_1061 Eq_972::* sp_74 = sp_56 - 2;
		(ss->*sp_74).ptr0000 = es;
		__syscall(0x38);
		(ss->*sp_74).ptrFFFFFFFE = es;
		__syscall(0x38);
		(ss->*sp_74).ptrFFFFFFFC = es;
		__syscall(0x38);
		(ss->*sp_74).ptrFFFFFFFA = es;
		__syscall(0x38);
		(ss->*sp_74).ptrFFFFFFF8 = es;
		__syscall(0x38);
		(ss->*sp_74).ptrFFFFFFF6 = es;
		__syscall(0x39);
		__syscall(0x3D);
		__syscall(0x39);
		__syscall(0x38);
		(ss->*sp_74).ptrFFFFFFF6 = es;
		__syscall(0x38);
		(ss->*sp_74).ptrFFFFFFF4 = es;
		__syscall(0x38);
		(ss->*sp_74).ptrFFFFFFF2 = es;
		__syscall(0x38);
		(ss->*sp_74).ptrFFFFFFF0 = es;
		__syscall(0x38);
		(ss->*sp_74).ptrFFFFFFEE = es;
		__syscall(0x38);
		(ss->*sp_74).ptrFFFFFFEC = es;
		__syscall(0x39);
		si_110 = (ss->*sp_74).ptrFFFFFFEC;
		__syscall(0x3D);
		sp_11 = sp_74 - 18;
	}
	__syscall(0x39);
}

// 087B:0390: Register ci16 _fib(Stack Eq_99 wArg04, Register out Eq_99 dxOut)
// Called from:
//      _main
//      _fib
ci16 _fib(Eq_99 wArg04, union Eq_99 & dxOut)
{
	ci16 ax_15;
	if (wArg04 > 0x02)
	{
		word16 dx_91;
		_fib(wArg04 - 0x01, out dx_91);
		word16 dx_92;
		Eq_99 ax_39 = _fib((word32) wArg04 + 0x0000FFFE, out dx_92);
		dx = ax_39;
		ax_15 = (ci16) ((word32) ax_39 + ((word32) wArg04 + 0x0000FFFE));
	}
	else
		ax_15 = 0x01;
	dxOut = dx;
	return ax_15;
}

// 087B:03C2: Register word16 _stest(Register Eq_99 ds, Stack Eq_99 dwArg04, Stack Eq_99 dwArg08, Register out ptr16 dxOut, Register out Eq_209 bxOut, Register out (ptr16 Eq_210) esOut)
// Called from:
//      _main
word16 _stest(Eq_99 ds, Eq_99 dwArg04, Eq_99 dwArg08, ptr16 & dxOut, union Eq_209 & bxOut, struct Eq_210 & esOut)
{
	ci16 si_15;
	word16 di_16 = 0x00;
	for (si_15 = 0x00; si_15 < 9000; ++si_15)
	{
		_mstrcpy(dwArg04, SEQ(ds, 311));
		_mstrcpy(dwArg08, SEQ(ds, 0x0148));
		di_16 += _mstrcmp(dwArg04, dwArg08, out dx, out bx, out es);
	}
	dxOut = dx;
	bxOut = bx;
	esOut = es;
	return di_16;
}

// 087B:0418: Register int16 _mstrcmp(Stack Eq_99 ptrArg04, Stack Eq_99 ptrArg08, Register out Eq_1199 dxOut, Register out ptr16 bxOut, Register out (ptr16 Eq_1201) esOut)
// Called from:
//      _stest
int16 _mstrcmp(Eq_99 ptrArg04, Eq_99 ptrArg08, union Eq_1199 & dxOut, ptr16 & bxOut, struct Eq_1201 & esOut)
{
	while (true)
	{
		struct Eq_1201 * es_22;
		ptr16 bx_23;
		int16 ax_31;
		word16 wArg08_62 = (word16) ptrArg08;
		word16 wArg0A_71 = SLICE(ptrArg08, word16, 16);
		word16 wArg04_60 = (word16) ptrArg04;
		word16 wArg06_68 = SLICE(ptrArg04, word16, 16);
		if (*ptrArg04 != *ptrArg08)
			break;
		es_22 = SLICE(ptrArg04, selector, 16);
		bx_23 = (word16) ptrArg04;
		if (*ptrArg04 == 0x00)
		{
			ax_31 = 0x00;
			goto l087B_0454;
		}
		ptrArg04 = SEQ(wArg06_68, wArg04_60 + 0x01);
		ptrArg08 = SEQ(wArg0A_71, wArg08_62 + 0x01);
	}
	Eq_1199 ax_46 = (int16) *ptrArg08;
	es_22 = SLICE(ptrArg08, selector, 16);
	bx_23 = (word16) ptrArg08;
	dx = ax_46;
	ax_31 = (int16) *ptrArg04 - ax_46;
l087B_0454:
	dxOut = dx;
	bxOut = bx_23;
	esOut = es_22;
	return ax_31;
}

// 087B:0456: void _mstrcpy(Stack Eq_99 ptrArg04, Stack (ptr32 byte) ptrArg08)
// Called from:
//      _stest
//      _mcopy
void _mstrcpy(Eq_99 ptrArg04, byte * ptrArg08)
{
	do
	{
		ptrArg04_44 = SEQ(wArg06_43, wArg04_36 + 0x01);
		ptrArg08_41 = SEQ(wArg0A_40, wArg08_33 + 0x01);
		byte al_17 = *ptrArg08;
		*ptrArg04 = al_17;
		word16 wArg04_36 = (word16) ptrArg04;
		word16 wArg06_43 = SLICE(ptrArg04, word16, 16);
		word16 wArg08_33 = (word16) ptrArg08;
		word16 wArg0A_40 = SLICE(ptrArg08, word16, 16);
		ptrArg08 = ptrArg08_41;
		ptrArg04 = ptrArg04_44;
	} while (al_17 != 0x00);
}

// 087B:0473: Register ci16 _mcopy(Register Eq_99 ds, Register out Eq_580 cxOut, Register out ptr16 dxOut, Register out Eq_582 bxOut, Register out (ptr16 Eq_583) esOut)
// Called from:
//      _main
ci16 _mcopy(Eq_99 ds, union Eq_580 & cxOut, ptr16 & dxOut, union Eq_582 & bxOut, struct Eq_583 & esOut)
{
	_mstrcpy(fp - 0x66, SEQ(ds, 0x0159));
	Eq_97 dx_ax_232 = <invalid>;
	Eq_580 dx_50 = SLICE(dx_ax_232, word16, 16);
	Eq_99 bx_48;
	Eq_99 cx_49 = _fopen(ds, SEQ(ds, 0x0167), SEQ(ds, 0x0170), out bx_48);
	Eq_99 dx_59 = dx_50 | (word16) dx_ax_232;
	if (dx_59 != 0x00)
	{
		ci16 di_83 = 0x00;
		while (true)
		{
			++di_83;
			if (di_83 >= 1000)
				break;
			int16 si_143 = 0x00;
			while (ss->*((char *) (fp - 0x66) + si_143) != 0x00)
			{
				Eq_100 v21_103 = (word32) *dx_ax_232 + 1;
				*dx_ax_232 = v21_103;
				if (v21_103 < 0x00)
				{
					Eq_1372 al_129 = (fp - 0x66)[si_143];
					*((word32) dx_ax_232 + 0x0C) = (word32) *((word32) dx_ax_232 + 0x0C) + 1;
					*((word32) *((word32) dx_ax_232 + 0x0C) - 1) = al_129;
				}
				else
					__fputc(ds, (fp - 0x66)[si_143], dx_ax_232);
				++si_143;
			}
		}
		Eq_582 bx_157;
		struct Eq_583 * es_159;
		ptr16 dx_158 = _fclose(ds, dx_ax_232, out bx_157, out es_159);
		cxOut = dx_50;
		dxOut = dx_158;
		bxOut = bx_157;
		esOut = es_159;
		return di_83;
	}
	else
	{
		_printf(cx_49, dx_59, bx_48, ds, SEQ(ds, 0x0172));
		_exit(ds, ~0x00);
	}
}

// 087B:051E: Register word16 _intest()
// Called from:
//      _main
word16 _intest()
{
	ci16 si_16;
	for (si_16 = 0x00; si_16 < 1000; ++si_16)
	{
		wLoc04 = 0x00;
		ci16 di_25;
		word16 wLoc06_60 = 0x01;
		for (di_25 = 0x00; di_25 < 0xB3; ++di_25)
		{
			wLoc04 += wLoc06_60;
			wLoc06_60 += 0x02;
		}
	}
	return wLoc04;
}

// subject_0BC6.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject_0BC6.h"

// 0BC6:0006: Register word16 __IOERROR(Register Eq_99 ds, Stack Eq_1415 wArg04)
// Called from:
//      _setblock
//      fn0C46_0007
//      _open
//      __open
//      _ioctl
//      _close
//      __close
//      __write
//      _lseek
//      _unlink
//      __chmod
word16 __IOERROR(Eq_99 ds, Eq_1415 wArg04)
{
	Eq_1416 si_17;
	Eq_1415 si_13 = wArg04;
	if (wArg04 >= 0x00)
	{
		if (wArg04 <= 88)
			goto l0BC6_0019;
	}
	else
	{
		si_17 = -wArg04;
		if (si_17 <= 0x23)
		{
			((word32) ds + 782)->u0 = ~0x00;
l0BC6_0032:
			*((word32) ds + 0x007F) = si_17;
			return ~0x00;
		}
	}
	si_13.u0 = 0x57;
l0BC6_0019:
	*((word32) ds + 782) = si_13;
	si_17.u1 = (int16) (ds->*((word16) si_13 + 784));
	goto l0BC6_0032;
}

// subject_0BCA.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject_0BCA.h"

// 0BCA:0002: void _exit(Register Eq_99 ds, Stack word16 wArg04)
// Called from:
//      _mcopy
void _exit(Eq_99 ds, word16 wArg04)
{
	while (true)
	{
		ui16 ax_11 = *((word32) ds + 888);
		--*((word32) ds + 888);
		if (ax_11 == 0x00)
			break;
		ui16 bx_18 = *((word32) ds + 888);
		SEQ(ds, 0x062E)[bx_18 * 0x04]();
	}
	(*((word32) ds + 874))();
	(*((word32) ds + 878))();
	struct Eq_1460 Eq_1463::* sp_44;
	(*((word32) ds + 882))();
	(ss->*sp_44).wFFFFFFFE = wArg04;
	__exit();
}

// subject_0BD0.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject_0BD0.h"

// 0BD0:0004: Register word16 _malloc(Register Eq_99 ds, Stack Eq_99 wArg04, Register out ptr16 dxOut)
// Called from:
//      _setvbuf
word16 _malloc(Eq_99 ds, Eq_99 wArg04, ptr16 & dxOut)
{
	ptr16 dx_21;
	word16 ax_18 = _farmalloc(ds, wArg04, 0x00, out dx_21);
	dxOut = dx_21;
	return ax_18;
}

// 0BD0:0019: Register Eq_99 __pull_free_block(Register Eq_99 ds, Stack Eq_97 ptrArg04)
// Called from:
//      _farmalloc
//      fn0D7F_00B5
//      fn0D7F_012D
Eq_99 __pull_free_block(Eq_99 ds, Eq_97 ptrArg04)
{
	Eq_99 wArg06_61 = SLICE(ptrArg04, word16, 16);
	Eq_97 wArg04_62 = (word16) ptrArg04;
	Eq_99 dx_14 = *((word32) ptrArg04 + 0x0E);
	Eq_97 ax_15 = *((word32) ptrArg04 + 0x0C);
	*((word32) ds + 900) = dx_14;
	*((word32) ds + 898) = ax_15;
	Eq_99 dx_24;
	fn0800_076C(ax_15, wArg06_61, dx_14, wArg04_62, out dx_24);
	Eq_97 Z_27 = <invalid>;
	if (!Z_27)
	{
		((word32) ds + 900)->u0 = 0x00;
		((word32) ds + 898)->u0 = 0x00;
	}
	else
	{
		Eq_97 es_bx_32 = *((word32) ptrArg04 + 8);
		Eq_97 es_bx_39 = *((word32) ds + 898);
		*((word32) es_bx_39 + 0x0A) = SLICE(es_bx_32, selector, 16);
		*((word32) es_bx_39 + 8) = (word16) es_bx_32;
		dx_24 = *((word32) ds + 900);
		Eq_97 ax_45 = *((word32) ds + 898);
		*((word32) es_bx_32 + 0x0E) = dx_24;
		*((word32) es_bx_32 + 0x0C) = ax_45;
	}
	return dx_24;
}

// 0BD0:0081: Register word16 fn0BD0_0081(Register Eq_99 ds, Stack Eq_97 ptrArg04, Stack Eq_1545 dwArg08)
// Called from:
//      _farmalloc
word16 fn0BD0_0081(Eq_99 ds, Eq_97 ptrArg04, Eq_1545 dwArg08)
{
	Eq_98 wArg0A = SLICE(dwArg08, word16, 16);
	Eq_100 wArg08 = (word16) dwArg08;
	Eq_99 wArg06_113 = SLICE(ptrArg04, word16, 16);
	Eq_97 wArg04_114 = (word16) ptrArg04;
	ui32 v13_v11_108 = SEQ(*((word32) ptrArg04 + 2), *ptrArg04) - dwArg08;
	*ptrArg04 = (word16) v13_v11_108;
	*((word32) ptrArg04 + 2) = SLICE(v13_v11_108, word16, 16);
	fn0800_0711(wArg04_114, *((word32) ptrArg04 + 2), wArg06_113, *ptrArg04);
	Eq_97 dx_ax_139 = <invalid>;
	Mem49[dx_ax_139 + 0x02:word16] = wArg0A + (wArg08 <u 0x01);
	*dx_ax_139 = (word16) wArg08 + 1;
	*((word32) dx_ax_139 + 6) = wArg06_113;
	*((word32) dx_ax_139 + 4) = wArg04_114;
	word16 dx_141;
	fn0800_076C(*((word32) ds + 894), wArg06_113, *((word32) ds + 896), wArg04_114, out dx_141);
	Eq_99 dx_31 = SLICE(dx_ax_139, word16, 16);
	Eq_97 ax_29 = (word16) dx_ax_139;
	Eq_97 Z_69 = <invalid>;
	if (!Z_69)
	{
		*((word32) ds + 896) = dx_31;
		*((word32) ds + 894) = ax_29;
	}
	else
	{
		fn0800_0711(ax_29, wArg0A, dx_31, wArg08);
		Eq_97 dx_ax_140 = <invalid>;
		*((word32) dx_ax_140 + 6) = dx_31;
		*((word32) dx_ax_140 + 4) = ax_29;
	}
	return (word32) ax_29 + 8;
}

// 0BD0:0131: Register word16 fn0BD0_0131(Register Eq_99 ds, Stack Eq_100 wArg04, Stack Eq_98 wArg06, Register out Eq_99 dxOut)
// Called from:
//      _farmalloc
word16 fn0BD0_0131(Eq_99 ds, Eq_100 wArg04, Eq_98 wArg06, union Eq_99 & dxOut)
{
	Eq_99 dx_64;
	word16 ax_66;
	__sbrk(ds, wArg04, wArg06);
	Eq_97 dx_ax_110 = <invalid>;
	Eq_99 dx_21 = SLICE(dx_ax_110, word16, 16);
	Eq_97 ax_18 = (word16) dx_ax_110;
	if (dx_21 == ~0x00 && ax_18 == ~0x00)
	{
		dx_64.u0 = 0x00;
		ax_66 = 0x00;
	}
	else
	{
		Eq_97 ax_40 = *((word32) ds + 894);
		*((word32) dx_ax_110 + 6) = *((word32) ds + 896);
		*((word32) dx_ax_110 + 4) = ax_40;
		Mem57[dx_ax_110 + 0x02:word16] = wArg06 + (wArg04 <u 0x01);
		*dx_ax_110 = (word16) wArg04 + 1;
		*((word32) ds + 896) = dx_21;
		*((word32) ds + 894) = ax_18;
		dx_64 = *((word32) ds + 896);
		ax_66 = (word16) ((word32) *((word32) ds + 894) + 8);
	}
	dxOut = dx_64;
	return ax_66;
}

// 0BD0:019F: Register word16 fn0BD0_019F(Register Eq_99 ds, Stack Eq_100 wArg04, Stack Eq_98 wArg06, Register out Eq_99 dxOut)
// Called from:
//      _farmalloc
word16 fn0BD0_019F(Eq_99 ds, Eq_100 wArg04, Eq_98 wArg06, union Eq_99 & dxOut)
{
	Eq_99 dx_62;
	word16 ax_64;
	__sbrk(ds, wArg04, wArg06);
	Eq_97 dx_ax_110 = <invalid>;
	Eq_99 dx_21 = SLICE(dx_ax_110, word16, 16);
	Eq_97 ax_18 = (word16) dx_ax_110;
	if (dx_21 == ~0x00 && ax_18 == ~0x00)
	{
		dx_62.u0 = 0x00;
		ax_64 = 0x00;
	}
	else
	{
		*((word32) ds + 892) = dx_21;
		*((word32) ds + 890) = ax_18;
		*((word32) ds + 896) = dx_21;
		*((word32) ds + 894) = ax_18;
		Mem60[dx_ax_110 + 0x02:word16] = wArg06 + (wArg04 <u 0x01);
		*dx_ax_110 = (word16) wArg04 + 1;
		dx_62 = dx_21;
		ax_64 = (word16) ((word32) ax_18 + 8);
	}
	dxOut = dx_62;
	return ax_64;
}

// 0BD0:0205: Register word16 _farmalloc(Register Eq_99 ds, Stack Eq_99 wArg04, Stack cui16 wArg06, Register out Eq_98 dxOut)
// Called from:
//      _malloc
word16 _farmalloc(Eq_99 ds, Eq_99 wArg04, cui16 wArg06, union Eq_98 & dxOut)
{
	Eq_98 dx_151;
	word16 ax_153;
	if ((wArg04 | wArg06) == 0x00)
	{
		dx_151.u0 = 0x00;
		ax_153 = 0x00;
	}
	else
	{
		word16 dx_327;
		fn0800_076C(*((word32) ds + 890), 0x00, *((word32) ds + 892), 0x00, out dx_327);
		cui16 dx_20 = (bool) (wArg04 < 0x17) + wArg06;
		Eq_100 ax_21 = (word32) wArg04 + 23 & ~0x0F;
		Eq_97 Z_38 = <invalid>;
		if (!Z_38)
			ax_153 = fn0BD0_019F(ds, ax_21, dx_20 & ~0x00, out dx_151);
		else
		{
			Eq_99 dx_40 = *((word32) ds + 900);
			Eq_97 ax_41 = *((word32) ds + 898);
			word16 dx_328;
			fn0800_076C(ax_41, 0x00, dx_40, 0x00, out dx_328);
			Eq_97 Z_54 = <invalid>;
			Eq_97 ptrLoc06_245 = SEQ(dx_40, ax_41);
			if (Z_54)
			{
				do
				{
					Eq_98 wLoc04_255 = SLICE(ptrLoc06_245, word16, 16);
					word16 wLoc06_258 = (word16) ptrLoc06_245;
					dx_151 = *((word32) ptrLoc06_245 + 2);
					Eq_100 ax_63 = *ptrLoc06_245;
					Eq_98 cx_69 = (bool) (ax_21 < 0x30) + (dx_20 & ~0x00);
					if (dx_151 >= cx_69 && (dx_151 != cx_69 || ax_63 >= (word16) ax_21 + 48))
					{
						ax_153 = fn0BD0_0081(ds, ptrLoc06_245, SEQ(dx_20 & ~0x00, ax_21));
						goto l0BD0_0310;
					}
					Eq_98 dx_81 = *((word32) ptrLoc06_245 + 2);
					Eq_100 ax_82 = *ptrLoc06_245;
					if (dx_81 >= (dx_20 & ~0x00) && (dx_81 != (dx_20 & ~0x00) || ax_82 >= ax_21))
					{
						__pull_free_block(ds, ptrLoc06_245);
						Eq_100 v26_145 = (word32) *ptrLoc06_245 + 1;
						*ptrLoc06_245 = v26_145;
						Mem150[ptrLoc06_245 + 0x02:word16] = Mem146[ptrLoc06_245 + 0x02:word16] + (v26_145 <u 0x00);
						dx_151 = wLoc04_255;
						ax_153 = wLoc06_258 + 0x08;
						goto l0BD0_0310;
					}
					Eq_97 es_bx_94 = *((word32) ptrLoc06_245 + 0x0C);
					word16 dx_329;
					fn0800_076C((word16) es_bx_94, *((word32) ds + 900), SLICE(es_bx_94, selector, 16), *((word32) ds + 898), out dx_329);
					Eq_97 Z_112 = <invalid>;
					ptrLoc06_245 = es_bx_94;
				} while (!Z_112);
			}
			ax_153 = fn0BD0_0131(ds, ax_21, dx_20 & ~0x00, out dx_151);
		}
	}
l0BD0_0310:
	dxOut = dx_151;
	return ax_153;
}

// subject_0C01.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject_0C01.h"

// 0C01:0004: Register word16 fn0C01_0004(Register Eq_99 ds, Stack Eq_97 ptrArg02, Register out Eq_99 dxOut)
// Called from:
//      __brk
//      __sbrk
word16 fn0C01_0004(Eq_99 ds, Eq_97 ptrArg02, union Eq_99 & dxOut)
{
	Eq_99 wArg04 = SLICE(ptrArg02, word16, 16);
	Eq_97 wArg02 = (word16) ptrArg02;
	word16 ax_110;
	uint16 ax_22 = (word32) wArg04 + 1 - *((word32) ds + 0x007B) + 0x3F >> 0x06;
	if (ax_22 == *((word32) ds + 902))
	{
		*((word32) ds + 141) = wArg04;
		*((word32) ds + 0x008B) = wArg02;
		ax_110 = 0x01;
	}
	else
	{
		Eq_99 ax_30 = *((word32) ds + 0x007B) + (ax_22 << 0x06);
		uint16 si_27 = ax_22 << 0x06;
		Eq_99 di_28 = *((word32) ds + 0x0091);
		byte al_46 = (byte) ax_30;
		if (ax_30 > di_28)
			si_27 = di_28 - *((word32) ds + 0x007B);
		word16 ax_47 = _setblock(al_46, ds, *((word32) ds + 0x007B), si_27);
		if (ax_47 == ~0x00)
		{
			*((word32) ds + 902) = si_27 >> 0x06;
			*((word32) ds + 141) = wArg04;
			*((word32) ds + 0x008B) = wArg02;
			ax_110 = 0x01;
		}
		else
		{
			Eq_99 ax_59 = *((word32) ds + 0x007B) + ax_47;
			*((word32) ds + 0x0091) = ax_59;
			((word32) ds + 0x008F)->u0 = 0x00;
			dx = ax_59;
			ax_110 = 0x00;
		}
	}
	dxOut = dx;
	return ax_110;
}

// 0C01:0094: Register word16 __brk(Register Eq_99 ds, Stack Eq_97 dwArg04)
// Called from:
//      fn0D7F_012D
word16 __brk(Eq_99 ds, Eq_97 dwArg04)
{
	Eq_99 wArg06 = SLICE(dwArg04, word16, 16);
	Eq_97 wArg04 = (word16) dwArg04;
	word16 dx_17;
	fn0800_076C(wArg04, *((word32) ds + 0x0089), wArg06, *((word32) ds + 0x0087), out dx_17);
	Eq_97 C_19 = <invalid>;
	if (C_19)
		return dx_17;
	fn0800_076C(wArg04, *((word32) ds + 0x0091), wArg06, *((word32) ds + 0x008F), out dx_17);
	Eq_97 Z_32 = <invalid>;
	Eq_97 C_31 = <invalid>;
	if (Z_32 | C_31 || fn0C01_0004(ds, dwArg04, out dx_17) == 0x00)
		return dx_17;
	return dx_17;
}

// 0C01:00DB: void __sbrk(Register Eq_99 ds, Stack Eq_100 wArg04, Stack Eq_98 wArg06)
// Called from:
//      fn0BD0_0131
//      fn0BD0_019F
void __sbrk(Eq_99 ds, Eq_100 wArg04, Eq_98 wArg06)
{
	if (wArg06 >= 0x10 && (wArg06 > 0x10 || wArg04 > 0x00))
		return;
	fn0800_0711(*((word32) ds + 0x008B), wArg06, *((word32) ds + 141), wArg04);
	Eq_97 dx_ax_162 = <invalid>;
	Eq_99 dx_26 = SLICE(dx_ax_162, word16, 16);
	Eq_97 ax_24 = (word16) dx_ax_162;
	word16 dx_163;
	fn0800_076C(ax_24, *((word32) ds + 0x0089), dx_26, *((word32) ds + 0x0087), out dx_163);
	Eq_97 C_43 = <invalid>;
	if (C_43)
		return;
	word16 dx_164;
	fn0800_076C(ax_24, *((word32) ds + 0x0091), dx_26, *((word32) ds + 0x008F), out dx_164);
	Eq_97 Z_56 = <invalid>;
	Eq_97 C_55 = <invalid>;
	if (!(Z_56 | C_55))
		return;
	word16 dx_165;
	fn0C01_0004(ds, dx_ax_162, out dx_165) != 0x00;
}

// subject_0C17.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject_0C17.h"

// 0C17:000C: Register word16 _setblock(Register byte al, Register Eq_99 ds, Stack (ptr16 Eq_1867) psegArg04, Stack uint16 wArg06)
// Called from:
//      fn0C01_0004
word16 _setblock(byte al, Eq_99 ds, struct Eq_1867 * psegArg04, uint16 wArg06)
{
	word16 ax_27;
	Eq_1415 ax_18 = SEQ(0x4A, al);
	word16 bx_12;
	if (!msdos_resize_memory_block(psegArg04, wArg06, out bx_12))
		ax_27 = ~0x00;
	else
	{
		__IOERROR(ds, ax_18);
		ax_27 = bx_12;
	}
	return ax_27;
}

// subject_0C19.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject_0C19.h"

// 0C19:000C: Register cui16 fn0C19_000C(Register Eq_99 ds, Stack (ptr32 word16) ptrArg02, Stack (ptr32 cui16) ptrArg06, Stack (ptr32 byte) ptrArg0A)
// Called from:
//      fn0C19_00FE
cui16 fn0C19_000C(Eq_99 ds, word16 * ptrArg02, cui16 * ptrArg06, byte * ptrArg0A)
{
	word16 wArg0A_156 = (word16) ptrArg0A;
	word16 wArg0C_162 = SLICE(ptrArg0A, word16, 16);
	cui16 ax_135;
	cui16 di_107;
	cui16 si_101;
	word16 wLoc06_154 = 0x00;
	byte al_24 = *ptrArg0A;
	byte * ptrArg0A_163 = SEQ(wArg0C_162, wArg0A_156 + 0x01);
	if (al_24 == 114)
	{
		si_101 = 0x01;
		di_107 = 0x01;
	}
	else if (al_24 == 0x77)
	{
		si_101 = 770;
		wLoc06_154 = 0x80;
		di_107 = 0x02;
	}
	else
	{
		if (al_24 != 0x61)
		{
			ax_135 = 0x00;
			return ax_135;
		}
		si_101 = 0x0902;
		wLoc06_154 = 0x80;
		di_107 = 0x02;
	}
	byte al_49 = *ptrArg0A_163;
	byte bLoc03_164 = al_49;
	byte * ptrArg0A_168 = SEQ(wArg0C_162, wArg0A_156 + 0x02);
	if (al_49 == 0x2B || *ptrArg0A_168 == 0x2B && (al_49 == 116 || al_49 == 0x62))
	{
		if (al_49 == 0x2B)
			bLoc03_164 = *ptrArg0A_168;
		si_101 = si_101 & ~0x03 | 0x04;
		wLoc06_154 = 0x0180;
		di_107 = 0x03;
	}
	cui16 si_102;
	if (bLoc03_164 == 116)
		si_102 = si_101 | 0x4000;
	else if (bLoc03_164 == 0x62)
	{
		si_102 = si_101 | 0x8000;
		di_107 |= 0x40;
	}
	else
	{
		si_102 = si_101 | *((word32) ds + 1344) & 0xC000;
		if ((si_102 & 0x8000) != 0x00)
			di_107 |= 0x40;
	}
	Mem120[ds:880:word16] = 3235;
	((word32) ds + 878)->u0 = 0x0F;
	*ptrArg06 = si_102;
	*ptrArg02 = wLoc06_154;
	ax_135 = di_107;
	return ax_135;
}

// 0C19:00FE: Register word16 fn0C19_00FE(Register Eq_99 ds, Stack (ptr32 byte) dwArg02, Stack segptr32 dwArg06, Stack Eq_97 ptrArg0A, Register out ptr16 cxOut, Register out ptr16 dxOut, Register out ptr16 bxOut)
// Called from:
//      _fopen
word16 fn0C19_00FE(Eq_99 ds, byte * dwArg02, segptr32 dwArg06, Eq_97 ptrArg0A, ptr16 & cxOut, ptr16 & dxOut, ptr16 & bxOut)
{
	ptr16 wArg0C_242 = SLICE(ptrArg0A, word16, 16);
	ptr16 bx_164;
	word16 ax_167;
	ptr16 dx_166;
	Eq_98 ax_28 = fn0C19_000C(ds, fp - 0x04, fp - 0x06, dwArg02);
	*((word32) ptrArg0A + 2) = ax_28;
	if (ax_28 == 0x00)
	{
l0C19_014B:
		((word32) ptrArg0A + 4)->u0 = ~0x00;
		*((word32) ptrArg0A + 2) = 0x00;
		bx_164 = (word16) ptrArg0A;
		dx_166 = 0x00;
		ax_167 = 0x00;
		goto l0C19_01D1;
	}
	else
	{
		if (*((word32) ptrArg0A + 4) < 0x00)
		{
			Eq_97 al_71 = (byte) (uint16) (uint8) _open(ds, dwArg06, wLoc06, wLoc04, out cx);
			*((word32) ptrArg0A + 4) = al_71;
			if (al_71 < 0x00)
				goto l0C19_014B;
		}
		if (_isatty((int16) *((word32) ptrArg0A + 4)) != 0x00)
			*((word32) ptrArg0A + 2) |= 0x0200;
		ci16 ax_122;
		if ((*((word32) ptrArg0A + 2) & 0x0200) != 0x00)
			ax_122 = 0x01;
		else
			ax_122 = 0x00;
		ptr16 wArg0C_250 = SLICE(ptrArg0A, word16, 16);
		word16 wArg0A_251 = (word16) ptrArg0A;
		if (_setvbuf(ds, ptrArg0A, 0x00, 0x00, ax_122, 0x0200, out cx) != 0x00)
		{
			struct Eq_2242 * es_290;
			_fclose(ds, ptrArg0A, out bx_164, out es_290);
			cx = wArg0C_242;
			dx_166 = 0x00;
			ax_167 = 0x00;
		}
		else
		{
			((word32) ptrArg0A + 16)->u0 = 0x00;
			bx_164 = (word16) ptrArg0A;
			dx_166 = wArg0C_250;
			ax_167 = wArg0A_251;
		}
l0C19_01D1:
		cxOut = cx;
		dxOut = dx_166;
		bxOut = bx_164;
		return ax_167;
	}
}

// 0C19:01D7: Register word16 fn0C19_01D7(Register Eq_99 ds)
// Called from:
//      _fopen
word16 fn0C19_01D7(Eq_99 ds)
{
	struct Eq_2251 * ptrLoc06_54 = SEQ(ds, 0x0388);
	do
	{
		word16 wLoc04_55 = SLICE(ptrLoc06_54, word16, 16);
		cup16 wLoc06_56 = (word16) ptrLoc06_54;
		if (ptrLoc06_54->b0004 < 0x00)
			break;
		ptrLoc06_54 = SEQ(wLoc04_55, wLoc06_56 + 0x14);
	} while (wLoc06_56 < 0x0518);
	word16 bx_36 = (word16) ptrLoc06_54;
	ptrLoc06_54->b0004 < 0x00;
	return bx_36;
}

// 0C19:0224: Register word16 _fopen(Register Eq_99 ds, Stack segptr32 dwArg04, Stack (ptr32 byte) dwArg08, Register out ptr16 bxOut)
// Called from:
//      _mcopy
word16 _fopen(Eq_99 ds, segptr32 dwArg04, byte * dwArg08, ptr16 & bxOut)
{
	Eq_97 dx_ax_97 = <invalid>;
	ptr16 bx_13 = fn0C19_01D7(ds);
	if ((SLICE(dx_ax_97, word16, 16) | (word16) dx_ax_97) != 0x00)
	{
		word16 dx_46;
		fn0C19_00FE(ds, dwArg08, dwArg04, dx_ax_97, out cx, out dx_46, out bx_13);
	}
	bxOut = bx_13;
	return cx;
}

// subject_0C46.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject_0C46.h"

// 0C46:0007: Register Eq_1415 fn0C46_0007(Register Eq_99 ds, Stack ptr16 wArg02, Stack segptr32 ptrArg04, Register out ptr16 cxOut)
// Called from:
//      _open
Eq_1415 fn0C46_0007(Eq_99 ds, ptr16 wArg02, segptr32 ptrArg04, ptr16 & cxOut)
{
	Eq_1415 ax_17;
	if (msdos_create_truncate_file(wArg02, SLICE(ptrArg04, selector, 16), (word16) ptrArg04, out ax_17))
		ax_17 = __IOERROR(ds, ax_17);
	cxOut = wArg02;
	return ax_17;
}

// 0C46:0026: Register word16 fn0C46_0026(Register Eq_99 ds, Stack Eq_1415 wArg02)
// Called from:
//      _open
word16 fn0C46_0026(Eq_99 ds, Eq_1415 wArg02)
{
	word16 ax_16;
	msdos_write_file(wArg02, 0x00, SEQ(ds, 0x00), out ax_16);
	return 0x00;
}

// 0C46:003A: Register byte _open(Register Eq_99 ds, Stack segptr32 dwArg04, Stack cui16 wArg08, Stack cui16 wArg0A, Register out ptr16 cxOut)
// Called from:
//      fn0C19_00FE
byte _open(Eq_99 ds, segptr32 dwArg04, cui16 wArg08, cui16 wArg0A, ptr16 & cxOut)
{
	cui16 di_16 = wArg08;
	if ((wArg08 & 0xC000) == 0x00)
		di_16 = wArg08 | *((word32) ds + 1344) & 0xC000;
	Eq_1415 ax_124;
	ptr16 cx_114;
	ptr16 wLoc06_364;
	Eq_1415 si_118;
	if ((di_16 & 0x0100) != 0x00)
	{
		cui16 v13_35 = wArg0A & *((word32) ds + 0x0542);
		if ((v13_35 & 0x0180) == 0x00)
			__IOERROR(ds, 0x01);
		if (__chmod(ds, 0x00, out cx_114) == ~0x00)
		{
			ptr16 ax_90;
			if ((v13_35 & 0x80) != 0x00)
				ax_90 = 0x00;
			else
				ax_90 = 0x01;
			wLoc06_364 = ax_90;
			if ((di_16 & 0xF0) == 0x00)
			{
				Eq_1415 ax_113 = fn0C46_0007(ds, ax_90, dwArg04, out cx_114);
				si_118 = ax_113;
				if (ax_113 < 0x00)
				{
					ax_124 = ax_113;
					goto l0C46_01A1;
				}
				goto l0C46_017C;
			}
			Eq_1415 ax_136 = fn0C46_0007(ds, 0x00, dwArg04, out cx_114);
			byte al_149 = (byte) ax_136;
			if (ax_136 < 0x00)
			{
				ax_124 = ax_136;
				goto l0C46_01A1;
			}
			__close(al_149, ds, ax_136);
l0C46_0100:
			Eq_1415 ax_178 = __open(ds, dwArg04, di_16, out cx_114);
			si_118 = ax_178;
			if (ax_178 >= 0x00)
			{
				cx_114 = 0x00;
				word16 cx_493;
				if ((_ioctl(ds, 0x00, out cx_493) & 0x80) != 0x00)
				{
					di_16 |= 0x2000;
					if ((di_16 & 0x8000) != 0x00)
						_ioctl(ds, 0x01, out cx_114);
				}
				else if ((di_16 & 0x0200) != 0x00)
					cx_114 = fn0C46_0026(ds, ax_178);
				if (wLoc06_364 != 0x00 && (di_16 & 0xF0) != 0x00)
					__chmod(ds, 0x01, out cx_114);
			}
l0C46_017C:
			if (si_118 >= 0x00)
			{
				cui16 ax_304;
				if ((di_16 & 0x0300) != 0x00)
					ax_304 = 0x1000;
				else
					ax_304 = 0x00;
				SEQ(ds, 0x0518)[si_118 * 0x02] = ax_304 | di_16 & ~0x0700;
			}
			ax_124 = si_118;
l0C46_01A1:
			cxOut = cx_114;
			return (byte) ax_124;
		}
		if ((di_16 & 0x0400) != 0x00)
		{
			ax_124 = __IOERROR(ds, 0x50);
			goto l0C46_01A1;
		}
	}
	wLoc06_364 = 0x00;
	goto l0C46_0100;
}

// subject_0C60.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject_0C60.h"

// 0C60:0007: Register Eq_1415 __open(Register Eq_99 ds, Stack segptr32 ptrArg04, Stack cui16 wArg08, Register out ptr16 cxOut)
// Called from:
//      _open
Eq_1415 __open(Eq_99 ds, segptr32 ptrArg04, cui16 wArg08, ptr16 & cxOut)
{
	byte bArg08_73 = (byte) wArg08;
	byte al_12 = 0x01;
	byte ch_89 = SLICE(wArg08, byte, 8);
	ch_89 = SLICE(wArg08, byte, 8);
	if ((wArg08 & 0x02) == 0x00)
	{
		al_12 = 0x02;
		if ((wArg08 & 0x04) == 0x00)
			al_12 = 0x00;
	}
	Eq_1415 ax_44;
	ptr16 cx_92 = SEQ(ch_89, bArg08_73 & 0xF0);
	Eq_1415 ax_38;
	if (!msdos_open_file(ptrArg04, al_12 | bArg08_73 & 0xF0, out ax_38))
	{
		SEQ(ds, 0x0518)[ax_38 * 0x02] = wArg08 & ~0x0700 | 0x8000;
		ax_44 = ax_38;
	}
	else
		ax_44 = __IOERROR(ds, ax_38);
	cxOut = cx_92;
	return ax_44;
}

// subject_0C65.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject_0C65.h"

// 0C65:0004: Register Eq_100 fn0C65_0004(Stack Eq_97 ptrArg02)
// Called from:
//      _fseek
Eq_100 fn0C65_0004(Eq_97 ptrArg02)
{
	Eq_100 ax_55;
	Eq_100 si_19 = *ptrArg02;
	Eq_100 di_20 = si_19;
	if ((*((word32) ptrArg02 + 2) & 0x40) != 0x00)
		ax_55 = si_19;
	else
	{
		Eq_97 ptrLoc06_74 = *((word32) ptrArg02 + 0x0C);
		while (true)
		{
			word16 wLoc06_75 = (word16) ptrLoc06_101;
			word16 wLoc04_84 = SLICE(ptrLoc06_101, word16, 16);
			--si_19;
			if (si_19 == 0x00)
				break;
			ptrLoc06_74 = SEQ(wLoc04_84, wLoc06_75 + 0x01);
			ptrLoc06_101 = ptrLoc06_74;
			if (*ptrLoc06_101 == 0x0A)
				di_20 = (word16) di_20 + 1;
		}
		ax_55 = di_20;
	}
	return ax_55;
}

// 0C65:0052: Register word16 _fseek(Register Eq_99 ds, Stack Eq_97 ptrArg04, Stack ui32 dwArg08, Stack word16 wArg0C)
// Called from:
//      _setvbuf
word16 _fseek(Eq_99 ds, Eq_97 ptrArg04, ui32 dwArg08, word16 wArg0C)
{
	word16 bx_17;
	word16 dx_19;
	struct Eq_2567 * es_20;
	word16 cx_105;
	if (_fflush(ds, ptrArg04, out cx_105, out dx_19, out bx_17, out es_20) == 0x00)
	{
		if (wArg0C == 0x01 && *ptrArg04 > 0x00)
			dwArg08 -= (int32) fn0C65_0004(ptrArg04);
		*((word32) ptrArg04 + 2) &= ~0x01A0;
		*ptrArg04 = 0x00;
		Eq_97 ax_79 = *((word32) ptrArg04 + 8);
		*((word32) ptrArg04 + 0x0E) = *((word32) ptrArg04 + 0x0A);
		*((word32) ptrArg04 + 0x0C) = ax_79;
		word16 dx_106;
		word16 ax_103 = _lseek(ds, (int16) *((word32) ptrArg04 + 4), dwArg08, (byte) wArg0C, out cx_105, out dx_106);
		if (dx_106 != ~0x00 || ax_103 != ~0x00)
			;
	}
	return cx_105;
}

// subject_0C79.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject_0C79.h"

// 0C79:0007: Register Eq_1415 _ioctl(Register Eq_99 ds, Stack word16 wArg06, Register out ptr16 cxOut)
// Called from:
//      _open
Eq_1415 _ioctl(Eq_99 ds, word16 wArg06, ptr16 & cxOut)
{
	byte bArg06 = (byte) wArg06;
	msdos_unknown_2144();
	Eq_1415 dx_31 = (word16) ptrArg08;
	Eq_1415 ax_21 = SEQ(0x44, bArg06);
	if (!C)
	{
		if (wArg06 == 0x00)
			ax_21 = dx_31;
	}
	else
		ax_21 = __IOERROR(ds, ax_21);
	cxOut = wArg0C;
	return ax_21;
}

// subject_0C7C.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject_0C7C.h"

// 0C7C:0004: Register cui16 _isatty(Stack int16 wArg04)
// Called from:
//      fn0C19_00FE
cui16 _isatty(int16 wArg04)
{
	cui16 dx_10;
	msdos_ioctl_get_device_info(wArg04, out dx_10);
	return dx_10 & 0x80;
}

// subject_0C7D.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject_0C7D.h"

// 0C7D:0006: Register word16 _setvbuf(Register Eq_99 ds, Stack Eq_97 ptrArg04, Stack Eq_97 wArg08, Stack Eq_99 wArg0A, Stack ci16 wArg0C, Stack Eq_99 wArg0E, Register out Eq_99 cxOut)
// Called from:
//      fn0C19_00FE
word16 _setvbuf(Eq_99 ds, Eq_97 ptrArg04, Eq_97 wArg08, Eq_99 wArg0A, ci16 wArg0C, Eq_99 wArg0E, union Eq_99 & cxOut)
{
	Eq_99 wArg04_253 = (word16) ptrArg04;
	word16 ax_189;
	if (*((word32) ptrArg04 + 18) != wArg04_253 || (wArg0C > 0x02 || wArg0E > 0x7FFF))
	{
		ax_189 = ~0x00;
		goto l0C7D_0144;
	}
	if (*((word32) ds + 0x0546) == 0x00)
	{
		cx = ds;
		if (wArg04_253 == 0x039C)
		{
			*((word32) ds + 0x0546) = 0x01;
l0C7D_0064:
			if (*ptrArg04 != 0x00)
				cx = _fseek(ds, ptrArg04, 0x00, 0x01);
			Eq_99 wArg06_272 = SLICE(ptrArg04, word16, 16);
			word16 wArg04_273 = (word16) ptrArg04;
			if ((*((word32) ptrArg04 + 2) & 0x04) != 0x00)
			{
				Eq_99 v21_99 = *((word32) ptrArg04 + 0x0A);
				_free(ds, *((word32) ptrArg04 + 8), v21_99);
				cx = v21_99;
			}
			*((word32) ptrArg04 + 2) &= ~0x0C;
			((word32) ptrArg04 + 6)->u0 = 0x00;
			*((word32) ptrArg04 + 0x0A) = wArg06_272;
			*((word32) ptrArg04 + 8) = wArg04_273 + 0x05;
			*((word32) ptrArg04 + 0x0E) = wArg06_272;
			*((word32) ptrArg04 + 0x0C) = wArg04_273 + 0x05;
			if (wArg0C != 0x02 && wArg0E > 0x00)
			{
				Mem162[ds:0x036C:word16] = 3239;
				((word32) ds + 874)->u0 = 0x07;
				if ((wArg08 | wArg0A) == 0x00)
				{
					Eq_99 dx_175;
					Eq_97 ax_172 = _malloc(ds, wArg0E, out dx_175);
					cx = wArg0E;
					wArg0A = dx_175;
					wArg08 = ax_172;
					if ((dx_175 | ax_172) == 0x00)
					{
						ax_189 = ~0x00;
l0C7D_0144:
						cxOut = cx;
						return ax_189;
					}
					*((word32) ptrArg04 + 2) |= 0x04;
				}
				*((word32) ptrArg04 + 0x0E) = wArg0A;
				*((word32) ptrArg04 + 0x0C) = wArg08;
				*((word32) ptrArg04 + 0x0A) = wArg0A;
				*((word32) ptrArg04 + 8) = wArg08;
				*((word32) ptrArg04 + 6) = wArg0E;
				if (wArg0C == 0x01)
					*((word32) ptrArg04 + 2) |= 0x08;
			}
			ax_189 = 0x00;
			goto l0C7D_0144;
		}
	}
	if (*((word32) ds + 0x0544) == 0x00)
	{
		cx = ds;
		if (wArg04_253 == 0x0388)
			*((word32) ds + 0x0544) = 0x01;
	}
	goto l0C7D_0064;
}

// subject_0C91.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject_0C91.h"

// 0C91:0008: Register Eq_99 _fclose(Register Eq_99 ds, Stack Eq_97 ptrArg04, Register out ptr16 bxOut, Register out (ptr16 Eq_1341) esOut)
// Called from:
//      _mcopy
//      fn0C19_00FE
Eq_99 _fclose(Eq_99 ds, Eq_97 ptrArg04, ptr16 & bxOut, struct Eq_1341 & esOut)
{
	Eq_99 wArg04_206 = (word16) ptrArg04;
	struct Eq_1341 * es_135 = SLICE(ptrArg04, selector, 16);
	ptr16 bx_136 = (word16) ptrArg04;
	Eq_99 dx_17 = wArg04_206;
	if (*((word32) ptrArg04 + 18) == wArg04_206)
	{
		if (*((word32) ptrArg04 + 6) != 0x00)
		{
			if (*ptrArg04 < 0x00)
			{
				word16 cx_277;
				if (_fflush(ds, ptrArg04, out cx_277, out dx_17, out bx_136, out es_135) != 0x00)
					goto l0C91_00D5;
			}
			if ((*((word32) ptrArg04 + 2) & 0x04) != 0x00)
				dx_17 = _free(ds, *((word32) ptrArg04 + 8), *((word32) ptrArg04 + 0x0A));
		}
		if (*((word32) ptrArg04 + 4) >= 0x00)
		{
			Eq_1415 ax_99 = (int16) *((word32) ptrArg04 + 4);
			_close((byte) ax_99, ds, ax_99);
		}
		*((word32) ptrArg04 + 2) = 0x00;
		((word32) ptrArg04 + 6)->u0 = 0x00;
		*ptrArg04 = 0x00;
		((word32) ptrArg04 + 4)->u0 = ~0x00;
		es_135 = SLICE(ptrArg04, selector, 16);
		bx_136 = (word16) ptrArg04;
		if (*((word32) ptrArg04 + 16) != 0x00)
		{
			struct Eq_2906 Eq_2924::* bp_155;
			word16 dx_158;
			segptr32 ax_154 = __MKNAME(ds, *((word32) ptrArg04 + 16), 0x00, out dx_158, out bp_155);
			Eq_97 sp_160 = <invalid>;
			ss->*((word32) sp_160 + 4) = dx_158;
			ss->*((word32) sp_160 + 2) = ax_154;
			dx_17 = _unlink((byte) ax_154, ds, ss->*((word32) sp_160 + 2));
			struct Eq_2940 * es_bx_182 = (ss->*bp_155).ptr0006;
			es_bx_182->w0010 = 0x00;
			es_135 = SLICE(es_bx_182, selector, 16);
			bx_136 = (word16) es_bx_182;
		}
	}
l0C91_00D5:
	bxOut = bx_136;
	esOut = es_135;
	return dx_17;
}

// subject_0C9E.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject_0C9E.h"

// 0C9E:0008: void _close(Register byte al, Register Eq_99 ds, Stack Eq_1415 wArg04)
// Called from:
//      _fclose
void _close(byte al, Eq_99 ds, Eq_1415 wArg04)
{
	if (wArg04 >= 0x00 && wArg04 < 0x14)
	{
		SEQ(ds, 0x0518)[wArg04 * 0x02] = ~0x00;
		__close(al, ds, wArg04);
	}
	else
		__IOERROR(ds, 0x06);
}

// subject_0CA1.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject_0CA1.h"

// 0CA1:0009: void __close(Register byte al, Register Eq_99 ds, Stack Eq_1415 wArg04)
// Called from:
//      _open
//      _close
void __close(byte al, Eq_99 ds, Eq_1415 wArg04)
{
	Eq_1415 ax_18 = SEQ(0x3E, al);
	if (!msdos_close_file(wArg04))
		SEQ(ds, 0x0518)[wArg04 * 0x02] = ~0x00;
	else
		__IOERROR(ds, ax_18);
}

// subject_0CAB.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject_0CAB.h"

// 0CAB:0001: Register (ptr16 Eq_2980) _write(Register Eq_99 ds, Stack Eq_2616 wArg04, Stack (ptr32 char) ptrArg06, Stack (ptr16 Eq_2980) wArg0A, Register out (ptr16 Eq_2985) cxOut, Register out ptr16 dxOut, Register out Eq_2987 bxOut, Register out (ptr16 Eq_2985) esOut)
// Called from:
//      _fflush
struct Eq_2980 * _write(Eq_99 ds, Eq_2616 wArg04, char * ptrArg06, struct Eq_2980 * wArg0A, struct Eq_2985 & cxOut, ptr16 & dxOut, union Eq_2987 & bxOut, struct Eq_2985 & esOut)
{
	struct Eq_2980 * ax_100;
	if (wArg0A < 0x01)
	{
		ax_100 = 0x00;
		goto l0CAB_0161;
	}
	if ((SEQ(ds, 0x0518)[wArg04 * 0x02] & 0x8000) != 0x00)
	{
		ax_100 = __write(ds, wArg04, ptrArg06, wArg0A, out cx, out dx, out bx);
		goto l0CAB_0161;
	}
	SEQ(ds, 0x0518)[wArg04 * 0x02] &= ~0x0200;
	struct Eq_2980 * wLoc8C_250 = wArg0A;
	es = ss;
	char * ptrLoc88_264 = ptrArg06;
	byte * ptrLoc90_401 = fp - 0x84;
	while (true)
	{
		word16 wLoc8E_268 = SLICE(ptrLoc90_401, word16, 16);
		word16 wLoc88_265 = (word16) ptrLoc88_264;
		word16 wLoc86_322 = SLICE(ptrLoc88_264, word16, 16);
		word16 wLoc90_254 = (word16) ptrLoc90_401;
		byte * ptrLoc90_269 = ptrLoc90_401;
		if (wLoc8C_250 == 0x00)
			break;
		struct Eq_2980 * v25_101 = wLoc8C_250 - 0x01;
		wLoc8C_250 = v25_101;
		byte al_108 = *ptrLoc88_264;
		ptrLoc88_264 = SEQ(wLoc86_322, wLoc88_265 + 0x01);
		if (al_108 == 0x0A)
		{
			*ptrLoc90_401 = 0x0D;
			ptrLoc90_269 = SEQ(wLoc8E_268, wLoc90_254 + 0x01);
		}
		*ptrLoc90_269 = al_108;
		word16 wLoc90_276 = (word16) ptrLoc90_269;
		cup16 ax_133 = wLoc90_276 + 0x01 - (fp - 0x84);
		word16 wLoc8E_325 = SLICE(ptrLoc90_269, word16, 16);
		es = SLICE(ptrLoc90_269, selector, 16);
		ci16 dx_136 = 0x00 - (ax_133 < 0x00);
		ptrLoc90_401 = SEQ(wLoc8E_325, wLoc90_276 + 0x01);
		if (dx_136 < 0x00)
			continue;
		if (dx_136 == 0x00)
		{
			ptrLoc90_401 = SEQ(wLoc8E_325, wLoc90_276 + 0x01);
			if (ax_133 < 0x80)
				continue;
		}
		struct Eq_2980 * ax_151 = wLoc90_276 + 0x01 - (fp - 0x84);
		struct Eq_2980 * ax_171 = __write(ds, wArg04, fp - 0x84, ax_151, out cx, out dx, out bx);
		if (ax_171 != ax_151)
		{
			if (Test(ULT,false))
				ax_100 = ~0x00;
			else
				ax_100 = ax_171 + (wArg0A - v25_101) - ax_151;
			goto l0CAB_0161;
		}
		es = ss;
		ptrLoc90_401 = (byte *) (fp - 0x84);
	}
	struct Eq_2980 * ax_53 = wLoc90_254 - (fp - 0x84);
	cx = ss;
	bx = fp - 0x84;
	dx = 0x00 - (ax_53 < 0x00);
	if (ax_53 > 0x00)
	{
		struct Eq_2980 * ax_76 = __write(ds, wArg04, fp - 0x84, ax_53, out cx, out dx, out bx);
		if (ax_76 != ax_53)
		{
			if (Test(ULT,false))
				ax_100 = ~0x00;
			else
				ax_100 = wArg0A + ax_76 - ax_53;
l0CAB_0161:
			cxOut = cx;
			dxOut = dx;
			bxOut = bx;
			esOut = es;
			return ax_100;
		}
	}
	ax_100 = wArg0A;
	goto l0CAB_0161;
}

// subject_0CC1.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject_0CC1.h"

// 0CC1:0007: Register Eq_1415 __write(Register Eq_99 ds, Stack Eq_2616 wArg04, Stack (ptr32 char) ptrArg06, Stack (ptr16 Eq_2980) wArg0A, Register out (ptr16 Eq_2980) cxOut, Register out ptr16 dxOut, Register out Eq_2616 bxOut)
// Called from:
//      _write
//      _fputc
Eq_1415 __write(Eq_99 ds, Eq_2616 wArg04, char * ptrArg06, struct Eq_2980 * wArg0A, struct Eq_2980 & cxOut, ptr16 & dxOut, union Eq_2616 & bxOut)
{
	if ((SEQ(ds, 0x0518)[wArg04 * 0x02] & 0x0800) != 0x00)
	{
		word16 cx_111;
		word16 dx_112;
		_lseek(ds, wArg04, 0x00, 0x02, out cx_111, out dx_112);
	}
	Eq_1415 ax_55;
	Eq_2616 bx_44 = wArg04;
	ptr16 dx_48 = (word16) ptrArg06;
	Eq_1415 ax_49;
	if (!msdos_write_file(wArg04, wArg0A, ptrArg06, out ax_49))
	{
		SEQ(ds, 0x0518)[wArg04 * 0x02] |= 0x1000;
		bx_44 = wArg04 << 0x01;
		ax_55 = ax_49;
	}
	else
		ax_55 = __IOERROR(ds, ax_49);
	cxOut = wArg0A;
	dxOut = dx_48;
	bxOut = bx_44;
	return ax_55;
}

// subject_0CCA.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject_0CCA.h"

// 0CCA:0002: Register Eq_1415 _lseek(Register Eq_99 ds, Stack Eq_2616 wArg04, Stack ui32 dwArg06, Stack byte bArg0A, Register out ptr16 cxOut, Register out ptr16 dxOut)
// Called from:
//      _fseek
//      __write
Eq_1415 _lseek(Eq_99 ds, Eq_2616 wArg04, ui32 dwArg06, byte bArg0A, ptr16 & cxOut, ptr16 & dxOut)
{
	ptr16 wArg08 = SLICE(dwArg06, word16, 16);
	ptr16 wArg06 = (word16) dwArg06;
	SEQ(ds, 0x0518)[wArg04 * 0x02] &= ~0x0200;
	Eq_1415 ax_21 = SEQ(66, bArg0A);
	ptr16 dx_19 = wArg06;
	if (msdos_set_file_position(wArg04, dwArg06, bArg0A, SEQ(wArg06, ax_21)))
	{
		word32 dx_ax_32 = (word32) __IOERROR(ds, ax_21);
		ax_21 = (word16) dx_ax_32;
		dx_19 = SLICE(dx_ax_32, word16, 16);
	}
	cxOut = wArg08;
	dxOut = dx_19;
	return ax_21;
}

// subject_0CCC.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject_0CCC.h"

// 0CCC:000F: void __LONGTOA(Stack Eq_99 bArg04, Stack Eq_99 bArg06, Stack Eq_3232 wArg08, Stack Eq_99 ptrArg0A, Stack Eq_99 wArg0E, Stack Eq_99 wArg10)
// Called from:
//      _ultoa
//      __VPRINTER
void __LONGTOA(Eq_99 bArg04, Eq_99 bArg06, Eq_3232 wArg08, Eq_99 ptrArg0A, Eq_99 wArg0E, Eq_99 wArg10)
{
	struct Eq_3236 * es_34 = SLICE(ptrArg0A, selector, 16);
	byte Eq_3236::* di_123 = (word16) ptrArg0A;
	cu8 bl_23 = (byte) wArg08;
	if (wArg08 > 0x24 || bl_23 < 0x02)
	{
l0CCC_007F:
		es_34->*di_123 = 0x00;
		return;
	}
	Eq_99 ax_26 = wArg0E;
	Eq_99 cx_28 = wArg10;
	if (wArg10 < 0x00 && bArg06 != 0x00)
	{
		*ptrArg0A = 0x2D;
		ax_26 = -wArg0E;
		++di_123;
		cx_28 = -wArg10 - (ax_26 == 0x00);
	}
	byte Eq_3279::* si_106 = fp - 0x24;
	if (cx_28 != 0x00)
	{
		do
		{
			uint32 dx_ax_52 = (uint32) (uint16) cx_28;
			uint32 dx_ax_60 = SEQ((uint16) (dx_ax_52 % wArg08), ax_26);
			ss->*si_106 = (byte) (uint16) (dx_ax_60 % wArg08);
			Eq_99 ax_56 = (uint16) (dx_ax_52 /u wArg08);
			cx_28 = ax_56;
			ax_26 = (uint16) (dx_ax_60 /u wArg08);
			++si_106;
		} while (ax_56 != 0x00);
l0CCC_0061:
		if (ax_26 == 0x00)
		{
			word16 cx_103;
			do
			{
				byte al_115;
				--si_106;
				cu8 al_110 = ss->*si_106;
				if (al_110 < 0x0A)
					al_115 = al_110 + 0x30;
				else
					al_115 = (byte) ((word32) bArg04 + (al_110 - 0x0A));
				es_34->*di_123 = al_115;
				++di_123;
				--cx_103;
			} while (cx_103 != 0x00);
			goto l0CCC_007F;
		}
	}
	uint32 dx_ax_79 = (uint32) (uint16) ax_26;
	ss->*si_106 = (byte) (uint16) (dx_ax_79 % wArg08);
	ax_26 = (uint16) (dx_ax_79 /u wArg08);
	++si_106;
	goto l0CCC_0061;
}

// 0CCC:00C0: Register Eq_99 _ultoa(Stack Eq_99 wArg04, Stack Eq_99 wArg06, Stack Eq_99 dwArg08, Stack Eq_3232 wArg0C)
// Called from:
//      __MKNAME
Eq_99 _ultoa(Eq_99 wArg04, Eq_99 wArg06, Eq_99 dwArg08, Eq_3232 wArg0C)
{
	__LONGTOA(0x61, 0x00, wArg0C, dwArg08, wArg04, wArg06);
	return wArg06;
}

// subject_0CDC.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject_0CDC.h"

// 0CDC:000B: Register Eq_2913 __MKNAME(Register Eq_99 ds, Stack Eq_99 wArg04, Stack Eq_2913 ptrArg06, Register out ptr16 dxOut, Register out ptr16 bpOut)
// Called from:
//      _fclose
Eq_2913 __MKNAME(Eq_99 ds, Eq_99 wArg04, Eq_2913 ptrArg06, ptr16 & dxOut, ptr16 & bpOut)
{
	cui16 wArg06 = (word16) ptrArg06;
	cui16 wArg08 = SLICE(ptrArg06, word16, 16);
	Eq_2913 ptrArg06_103 = ptrArg06;
	if ((wArg06 | wArg08) == 0x00)
		ptrArg06_103 = SEQ(ds, 0x06B0);
	*ptrArg06_103 = 0x00;
	_strcat(ptrArg06_103, SEQ(ds, 0x0548));
	struct Eq_3367 Eq_3378::* bp_65 = _ultoa(wArg04, 0x00, SEQ(SLICE(ptrArg06_103, word16, 16), (word16) ptrArg06_103 + 0x03), 0x0A);
	(ss->*bp_65).tFFFFFFFE = ds;
	(ss->*bp_65).tFFFFFFFC.u0 = 0x054C;
	(ss->*bp_65).ptrFFFFFFFA = (ss->*bp_65).ptr000A;
	(ss->*bp_65).tFFFFFFF8 = (ss->*bp_65).t0008;
	_strcat((ss->*bp_65).tFFFFFFF8, (ss->*bp_65).tFFFFFFFC);
	ptr16 dx_94 = (ss->*bp_65).ptr000A;
	Eq_2913 ax_95 = (ss->*bp_65).t0008;
	ptr16 bp_96 = (ss->*bp_65).ptr0000;
	dxOut = dx_94;
	bpOut = bp_96;
	return ax_95;
}

// subject_0CE7.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject_0CE7.h"

// 0CE7:000B: Register word16 _unlink(Register byte al, Register Eq_99 ds, Stack segptr32 ptrArg04)
// Called from:
//      _fclose
word16 _unlink(byte al, Eq_99 ds, segptr32 ptrArg04)
{
	word16 dx_15 = (word16) ptrArg04;
	Eq_1415 ax_21 = SEQ(0x41, al);
	if (msdos_delete_file(SLICE(ptrArg04, selector, 16), dx_15))
		__IOERROR(ds, ax_21);
	return dx_15;
}

// subject_0CE9.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject_0CE9.h"

// 0CE9:0007: void _strcat(Stack Eq_2913 ptrArg04, Stack Eq_3363 ptrArg08)
// Called from:
//      __MKNAME
void _strcat(Eq_2913 ptrArg04, Eq_3363 ptrArg08)
{
	byte Eq_3436::* di_20 = (word16) ptrArg04;
	struct Eq_3436 * es_123 = SLICE(ptrArg04, selector, 16);
	word16 cx_25 = ~0x00;
	while (cx_25 != 0x00)
	{
		++di_20;
		--cx_25;
		if (es_123->*di_20 != 0x00)
			break;
	}
	union Eq_3440 Eq_3436::* si_43 = di_20 - 0x01;
	struct Eq_3443 * es_125 = SLICE(ptrArg08, selector, 16);
	byte Eq_3443::* di_126 = (word16) ptrArg08;
	word16 cx_47 = ~0x00;
	while (cx_47 != 0x00)
	{
		++di_126;
		--cx_47;
		if (es_125->*di_126 != 0x00)
			break;
	}
	cu16 cx_58 = ~cx_47;
	Eq_3462 di_60 = di_126 - cx_58;
	union Eq_3440 Eq_3436::* di_121 = si_43;
	Eq_3462 si_120 = di_60;
	if ((di_60 & 0x01) != 0x00)
	{
		es_123->*si_43 = es_125->*di_60;
		si_120 = (word16) di_60 + 1;
		di_121 = (union Eq_3440 Eq_3436::*) ((char *) si_43 + 1);
		--cx_58;
	}
	uint16 cx_87 = cx_58 >> 0x01;
	cx_122 = cx_87;
	while (true)
	{
		uint16 cx_122;
		if (cx_122 == 0x00)
			break;
		es_123->*di_121 = es_125->*si_120;
		si_120 = (word16) si_120 + 2;
		di_121 = (union Eq_3440 Eq_3436::*) ((char *) di_121 + 2);
		--cx_122;
	}
	if (cx_87 < 0x00)
		es_123->*di_121 = es_125->*si_120;
}

// subject_0CED.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject_0CED.h"

// 0CED:0009: Register Eq_1415 __chmod(Register Eq_99 ds, Stack byte bArg08, Register out Eq_1415 cxOut)
// Called from:
//      _open
Eq_1415 __chmod(Eq_99 ds, byte bArg08, union Eq_1415 & cxOut)
{
	Eq_1415 ax_22;
	msdos_unknown_2143();
	Eq_1415 cx_14 = wArg0A;
	Eq_1415 ax_20 = SEQ(0x43, bArg08);
	if (!C)
	{
		cx_14 = ax_20;
		ax_22 = wArg0A;
	}
	else
		ax_22 = __IOERROR(ds, ax_20);
	cxOut = cx_14;
	return ax_22;
}

// subject_0CEF.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject_0CEF.h"

// 0CEF:000A: Register word16 _fflush(Register Eq_99 ds, Stack Eq_97 ptrArg04, Register out Eq_99 cxOut, Register out Eq_99 dxOut, Register out ptr16 bxOut, Register out (ptr16 Eq_2576) esOut)
// Called from:
//      _fseek
//      _fclose
//      _fputc
word16 _fflush(Eq_99 ds, Eq_97 ptrArg04, union Eq_99 & cxOut, union Eq_99 & dxOut, ptr16 & bxOut, struct Eq_2576 & esOut)
{
	Eq_99 wArg04_160 = (word16) ptrArg04;
	Eq_99 wArg06_166 = SLICE(ptrArg04, word16, 16);
	word16 ax_139;
	struct Eq_2576 * es_118 = SLICE(ptrArg04, selector, 16);
	ptr16 bx_105 = (word16) ptrArg04;
	Eq_99 dx_101 = wArg04_160;
	if (*((word32) ptrArg04 + 18) != wArg04_160)
	{
		ax_139 = ~0x00;
		goto l0CEF_00EF;
	}
	if (*ptrArg04 >= 0x00)
	{
		if ((*((word32) ptrArg04 + 2) & 0x08) == 0x00)
		{
			es_118 = SLICE(ptrArg04, selector, 16);
			dx_101 = *((word32) ptrArg04 + 0x0E);
			Eq_97 ax_102 = *((word32) ptrArg04 + 0x0C);
			bx_105 = (ptr16) ((word32) wArg04_160 + 5);
			if (dx_101 != wArg06_166 || ax_102 != (word32) wArg04_160 + 5)
			{
l0CEF_008C:
				cx = wArg06_166;
				ax_139 = 0x00;
				goto l0CEF_00EF;
			}
		}
		*ptrArg04 = 0x00;
		es_118 = SLICE(ptrArg04, selector, 16);
		dx_101 = *((word32) ptrArg04 + 0x0E);
		Eq_97 ax_121 = *((word32) ptrArg04 + 0x0C);
		bx_105 = (ptr16) ((word32) wArg04_160 + 5);
		if (dx_101 == wArg06_166 && ax_121 == (word32) wArg04_160 + 5)
		{
			dx_101 = *((word32) ptrArg04 + 0x0A);
			Eq_97 ax_133 = *((word32) ptrArg04 + 8);
			*((word32) ptrArg04 + 0x0E) = dx_101;
			*((word32) ptrArg04 + 0x0C) = ax_133;
			es_118 = SLICE(ptrArg04, selector, 16);
			bx_105 = (word16) ptrArg04;
		}
		goto l0CEF_008C;
	}
	word16 si_31 = Mem11[ptrArg04 + 0x06:word16] + Mem11[ptrArg04 + 0x00:word16];
	*ptrArg04 -= si_31 + 0x01;
	Eq_99 dx_44 = *((word32) ptrArg04 + 0x0A);
	Eq_97 ax_45 = *((word32) ptrArg04 + 8);
	*((word32) ptrArg04 + 0x0E) = dx_44;
	*((word32) ptrArg04 + 0x0C) = ax_45;
	if (_write(ds, (int16) *((word32) ptrArg04 + 4), SEQ(dx_44, ax_45), si_31 + 0x01, out cx, out dx_101, out bx_105, out es_118) != si_31 + 0x01)
	{
		es_118 = SLICE(ptrArg04, selector, 16);
		bx_105 = (word16) ptrArg04;
		if ((*((word32) ptrArg04 + 2) & 0x0200) == 0x00)
		{
			*((word32) ptrArg04 + 2) |= 0x10;
			es_118 = SLICE(ptrArg04, selector, 16);
			bx_105 = (word16) ptrArg04;
			ax_139 = ~0x00;
l0CEF_00EF:
			cxOut = cx;
			dxOut = dx_101;
			bxOut = bx_105;
			esOut = es_118;
			return ax_139;
		}
	}
	ax_139 = 0x00;
	goto l0CEF_00EF;
}

// subject_0CFE.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject_0CFE.h"

// 0CFE:0002: Register word16 _printf(Register Eq_99 cx, Register Eq_99 dx, Register Eq_99 bx, Register Eq_99 ds, Stack Eq_99 dwArg04)
// Called from:
//      _main
//      _mcopy
word16 _printf(Eq_99 cx, Eq_99 dx, Eq_99 bx, Eq_99 ds, Eq_99 dwArg04)
{
	word16 si_37 = __VPRINTER(cx, dx, bx, ds, fp + 0x08, dwArg04);
	return si_37;
}

// subject_0D00.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject_0D00.h"

// 0D00:0006: void __fputc(Register Eq_99 ds, Stack byte bArg04, Stack Eq_97 ptrArg06)
// Called from:
//      _mcopy
void __fputc(Eq_99 ds, byte bArg04, Eq_97 ptrArg06)
{
	--*ptrArg06;
	_fputc(ds, (byte) (int16) bArg04, ptrArg06);
}

// 0D00:0025: void _fputc(Register Eq_99 ds, Stack Eq_1372 bArg04, Stack Eq_97 ptrArg06)
// Called from:
//      __fputc
void _fputc(Eq_99 ds, Eq_1372 bArg04, Eq_97 ptrArg06)
{
	while (true)
	{
		Eq_100 v10_19 = (word32) *ptrArg06 + 1;
		*ptrArg06 = v10_19;
		if (v10_19 < 0x00)
			break;
		--*ptrArg06;
		if ((*((word32) ptrArg06 + 2) & 0x90) != 0x00 || (*((word32) ptrArg06 + 2) & 0x02) == 0x00)
		{
			*((word32) ptrArg06 + 2) |= 0x10;
			return;
		}
		*((word32) ptrArg06 + 2) |= 0x0100;
		if (*((word32) ptrArg06 + 6) == 0x00)
		{
			if (bArg04 != 0x0A || (*((word32) ptrArg06 + 2) & 0x40) != 0x00)
			{
l0D00_0129:
				word16 bx_107;
				word16 cx_108;
				word16 dx_109;
				if (__write(ds, (int16) *((word32) ptrArg06 + 4), fp + 0x04, 0x01, out cx_108, out dx_109, out bx_107) != 0x01)
				{
l0D00_0148:
					if ((*((word32) ptrArg06 + 2) & 0x0200) == 0x00)
					{
						*((word32) ptrArg06 + 2) |= 0x10;
						return;
					}
				}
				return;
			}
			else
			{
				word16 cx_78;
				word16 dx_79;
				word16 bx_373;
				if (__write(ds, (int16) *((word32) ptrArg06 + 4), SEQ(ds, 1412), 0x01, out cx_78, out dx_79, out bx_373) == 0x01)
					goto l0D00_0129;
				goto l0D00_0148;
			}
		}
		if (*ptrArg06 != 0x00)
		{
			word16 dx_164;
			struct Eq_3802 * es_372;
			word16 bx_371;
			word16 cx_370;
			if (_fflush(ds, ptrArg06, out cx_370, out dx_164, out bx_371, out es_372) != 0x00)
				return;
		}
		else
			*ptrArg06 = ~0x00 - *((word32) ptrArg06 + 6);
	}
	*((word32) ptrArg06 + 0x0C) = (word32) *((word32) ptrArg06 + 0x0C) + 1;
	*((word32) *((word32) ptrArg06 + 0x0C) - 1) = bArg04;
	if ((*((word32) ptrArg06 + 2) & 0x08) == 0x00 || bArg04 != 0x0A && bArg04 != 0x0D)
		return;
	word16 bx_223;
	word16 dx_225;
	struct Eq_3746 * es_226;
	word16 cx_369;
	if (_fflush(ds, ptrArg06, out cx_369, out dx_225, out bx_223, out es_226) == 0x00)
		;
}

// subject_0D28.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject_0D28.h"

// 0D28:0000: Register word16 fn0D28_0000(Sequence (ptr32 Eq_3884) es_di, Register Eq_99 ds, Stack Eq_99 wArg02)
// Called from:
//      __VPRINTER
word16 fn0D28_0000(struct Eq_3884 * es_di, Eq_99 ds, Eq_99 wArg02)
{
	word16 di = (word16) es_di;
	bcu8 dh_13 = SLICE(wArg02, byte, 8);
	es_di->b0000 = (uint16) (dh_13 >> 0x04) + 1421;
	es_di->b0001 = (uint16) (dh_13 & 0x0F) + 1421;
	bcu8 dl_29 = (byte) wArg02;
	es_di->b0002 = (uint16) (dl_29 >> 0x04) + 1421;
	es_di->b0003 = (uint16) (dl_29 & 0x0F) + 1421;
	return di + 4;
}

// 0D28:002B: Register word16 __VPRINTER(Register Eq_99 cx, Register Eq_99 dx, Register Eq_99 bx, Register Eq_99 ds, Stack (ptr32 Eq_3682) ptrArg04, Stack Eq_99 ptrArg08)
// Called from:
//      _printf
word16 __VPRINTER(Eq_99 cx, Eq_99 dx, Eq_99 bx, Eq_99 ds, struct Eq_3682 * ptrArg04, Eq_99 ptrArg08)
{
	ci8 bLoc57_1252 = 0x50;
	struct Eq_3933 Eq_99::* sp_1033 = fp - 0xA0;
	byte Eq_99::* wLoc98_1255 = fp - 0x56;
l0D28_0093:
	byte Eq_99::* di_1019 = wLoc98_1255;
l0D28_0097:
	struct Eq_4174 * psegArg0A_1702 = SLICE(ptrArg08, selector, 16);
	byte Eq_99::* si_1007 = (word16) ptrArg08;
	struct Eq_4094 * es_1183 = SLICE(ptrArg08, selector, 16);
	while (true)
	{
		byte al_37 = ds->*si_1007;
		++si_1007;
		byte al_1006 = al_37;
		if (al_37 == 0x00)
			break;
		if (al_37 == 0x25)
		{
			al_1006 = ds->*si_1007;
			++si_1007;
			if (al_1006 != 0x25)
			{
				wLoc98_1255 = di_1019;
				cu8 ch_1177 = 0x00;
				Eq_99 wLoc8E_1260 = 0x00;
				cui16 wLoc9A_1261 = 0x20;
				byte bLoc8F_1262 = 0x00;
				Eq_99 wLoc94_1263 = ~0x00;
				Eq_99 wLoc92_1264 = ~0x00;
				while (true)
				{
					Eq_99 ax_65 = (uint16) (uint8) al_1006;
					cu8 bl_68 = (byte) ax_65;
					byte bh_73 = SLICE(ax_65, byte, 8);
					word16 wArg04_1270 = (word16) ptrArg04;
					word16 wArg06_1597 = SLICE(ptrArg04, word16, 16);
					byte dl_134 = (byte) ax_65;
					bx = SEQ(bh_73, bl_68 - 0x20);
					cx = SEQ(ch_1177, 0x00);
					if (bl_68 >= 0x80)
						break;
					bx = SEQ(bh_73, ds->*((word32) bx + 0x059D));
					cx = SEQ(ch_1177, 0x00);
					dx = ax_65;
					if (bx > 0x17)
						goto l0D28_053A;
					byte * es_di_1959;
					byte * es_di_1972;
					Eq_99 bx_1966;
					Eq_99 bx_1976;
					byte * es_di_1963;
					Eq_99 bx_1956;
					byte bLoc95_1307;
					Eq_99 dx_239;
					Eq_99 cx_177;
					byte Eq_4047::* di_502;
					struct Eq_4047 * es_505;
					Eq_99 dx_370;
					Eq_99 ax_369;
					struct Eq_4050 * es_367;
					word16 di_368;
					bx <<= 0x01;
					byte bl_469 = (byte) (bx << 0x01);
					dx = ax_65;
					cx = SEQ(ch_1177, 0x00);
					switch (bx)
					{
					case 0x00:
						cx = SEQ(ch_1177, 0x00);
						if (ch_1177 > 0x00)
							goto l0D28_0138;
						if (bLoc8F_1262 != 0x2B)
							bLoc8F_1262 = dl_134;
						break;
					case 0x01:
						cx = SEQ(ch_1177, 0x00);
						if (ch_1177 > 0x00)
							goto l0D28_0138;
						wLoc9A_1261 |= 0x01;
						break;
					case 0x02:
						struct Eq_4094 * Eq_99::* sp_964 = sp_1033 - 2;
						ss->*sp_964 = es_1183;
						Eq_99 ax_970 = ptrArg04->w0000;
						es_1183 = ss->*sp_964;
						ptrArg04 = SEQ(wArg06_1597, wArg04_1270 + 0x02);
						if (ch_1177 < 0x02)
						{
							wLoc94_1263 = ax_970;
							ch_1177 = 0x03;
							goto l0D28_01AB;
						}
						cx = SEQ(ch_1177, 0x00);
						if (ch_1177 != 0x04)
							goto l0D28_0191;
						wLoc92_1264 = ax_970;
						++ch_1177;
						break;
					case 0x03:
						cx = SEQ(ch_1177, 0x00);
						if (ch_1177 > 0x00)
							goto l0D28_0138;
						wLoc9A_1261 |= 0x02;
						break;
					case 0x04:
						cx = SEQ(ch_1177, 0x00);
						if (ch_1177 >= 0x04)
							goto l0D28_0191;
						ch_1177 = 0x04;
						break;
					case 0x05:
l0D28_01C6:
						dx = bx;
						Eq_99 ax_915 = (int16) ((byte) ax_65 - 0x30);
						if (ch_1177 <= 0x02)
						{
							ch_1177 = 0x02;
							wLoc94_1263 = ax_915;
							if (wLoc94_1263 < 0x00)
								goto l0D28_01AB;
							wLoc94_1263 = (word32) ax_915 + ((wLoc94_1263 << 0x03) + (wLoc94_1263 << 0x01));
						}
						else
						{
							cx = SEQ(ch_1177, 0x00);
							if (ch_1177 != 0x04)
							{
l0D28_0191:
								goto l0D28_053A;
							}
							wLoc92_1264 = ax_915;
							if (wLoc92_1264 < 0x00)
								goto l0D28_01AB;
							wLoc92_1264 = (word32) ax_915 + ((wLoc92_1264 << 0x03) + (wLoc92_1264 << 0x01));
						}
						break;
					case 0x06:
						wLoc9A_1261 |= 0x10;
						ch_1177 = 0x05;
						break;
					case 0x07:
						wLoc9A_1261 = (wLoc9A_1261 | 0x0100) & ~0x10;
						ch_1177 = 0x05;
						break;
					case 0x08:
						wLoc9A_1261 = wLoc9A_1261 & ~0x10 | 0x80;
						ch_1177 = 0x05;
						break;
					case 0x09:
						if (ch_1177 > 0x00)
							goto l0D28_01C6;
						if ((wLoc9A_1261 & 0x02) == 0x00)
						{
							wLoc9A_1261 |= 0x08;
							ch_1177 = 0x01;
						}
						else
						{
l0D28_01AB:
						}
						break;
					case 0x0A:
						int32 dx_ax_380 = (int32) ptrArg04->w0000;
						bLoc95_1307 = 0x01;
						es_367 = SLICE(ptrArg04, selector, 16);
						di_368 = (word16) ptrArg04;
						ax_369 = (word16) dx_ax_380;
						dx_370 = SLICE(dx_ax_380, word16, 16);
						bx_1956 = SEQ(0x0A, bl_469);
						goto l0D28_026A;
					case 11:
						bx_1976 = SEQ(0x08, bl_469);
						goto l0D28_0240;
					case 0x0C:
						bx_1966 = SEQ(0x0A, bl_469);
						goto l0D28_0245;
					case 0x0D:
						bx_1976 = SEQ(0x10, dl_134 + 233);
l0D28_0240:
						bLoc8F_1262 = 0x00;
						bx_1966 = bx_1976;
l0D28_0245:
						bLoc95_1307 = 0x00;
						es_367 = SLICE(ptrArg04, selector, 16);
						di_368 = (word16) ptrArg04;
						ax_369 = ptrArg04->w0000;
						dx_370.u0 = 0x00;
						bx_1956 = bx_1966;
l0D28_026A:
						struct Eq_4302 Eq_4050::* di_382 = di_368 + 0x01;
						byte bh_449 = SLICE(bx_1956, byte, 8);
						struct Eq_4307 Eq_4050::* di_383 = &di_382->t0001;
						ptrArg08 = &(psegArg0A_1702->*si_1007);
						if ((wLoc9A_1261 & 0x10) != 0x00)
						{
							dx_370 = (es_367->*di_382).t0001;
							di_383 = (struct Eq_4307 Eq_4050::*) ((char *) &di_382->t0001 + 2);
						}
						ptrArg04 = SEQ(wArg06_1597, di_383);
						if (ax_369 == 0x00)
						{
							byte dh_1176 = SLICE(dx_370, byte, 8);
							if (dx_370 != 0x00)
								goto l0D28_02BA;
							bx = bx_1956;
							if (wLoc92_1264 == 0x00)
							{
								cx = wLoc94_1263;
								dx = dx_370;
								if (wLoc94_1263 != 0x00)
								{
									dx = dx_370;
									if (wLoc94_1263 != ~0x00)
									{
										byte dl_856;
										if ((wLoc9A_1261 & 0x08) != 0x00)
											dl_856 = 0x30;
										else
											dl_856 = 0x20;
										do
										{
											dx = SEQ(dh_1176, dl_856);
											di_1019 = fn0D28_0051(SEQ(ss, fp - 2), dl_856, cx, dx, bx_1956, di_1019);
											sp_1033 = (struct Eq_3933 Eq_99::*) ((char *) &sp_1033->t0000 + 0x0000FFFE);
											--cx;
										} while (cx != 0x00);
									}
								}
								goto l0D28_0097;
							}
						}
						else
						{
l0D28_02BA:
							wLoc9A_1261 |= 0x04;
						}
						struct Eq_4364 Eq_99::* sp_432 = sp_1033 - 2;
						(ss->*sp_432).t0000 = dx_370;
						(ss->*sp_432).tFFFFFFFE = ax_369;
						(ss->*sp_432).tFFFFFFFC = ss;
						(ss->*sp_432).tFFFFFFFA = fp - 0x89;
						Eq_3232 ax_454 = (int16) bh_449;
						(ss->*sp_432).tFFFFFFF8 = ax_454;
						(ss->*sp_432).tFFFFFFF6 = SEQ(SLICE(ax_454, byte, 8), bLoc95_1307);
						(ss->*sp_432).tFFFFFFF4 = bx_1956;
						__LONGTOA((ss->*sp_432).tFFFFFFF4, (ss->*sp_432).tFFFFFFF6, (ss->*sp_432).tFFFFFFF8, (ss->*sp_432).tFFFFFFFA, (ss->*sp_432).tFFFFFFFE, (ss->*sp_432).t0000);
						(ss->*sp_432).t0000 = ss;
						Eq_99 es_483 = (ss->*sp_432).t0000;
						sp_1033 = (struct Eq_3933 Eq_99::*) ((char *) &sp_432->t0000 + 2);
						dx_239 = wLoc92_1264;
						if (wLoc92_1264 > 0x00)
						{
							es_di_1963 = SEQ(es_483, fp - 0x89);
							goto l0D28_040E;
						}
						else
						{
							es_di_1972 = SEQ(es_483, fp - 0x89);
							goto l0D28_03FE;
						}
					case 0x0E:
						struct Eq_4160 Eq_99::* sp_282 = sp_1033 - 2;
						(ss->*sp_282).t0000 = ptrArg04->w0000;
						word16 bx_280 = (word16) ptrArg04;
						byte Eq_99::* di_277 = fp - 0x8A;
						ptrArg08 = &(psegArg0A_1702->*si_1007);
						ptrArg04 = SEQ(wArg06_1597, bx_280 + 0x02);
						if ((wLoc9A_1261 & 0x20) != 0x00)
						{
							(ss->*sp_282).tFFFFFFFE = ptrArg04->w0002;
							(ss->*sp_282).tFFFFFFFC = ss;
							Eq_99 es_299 = (ss->*sp_282).tFFFFFFFC;
							byte Eq_99::* di_305 = fn0D28_0000(SEQ(es_299, fp - 0x8A), ds, (ss->*sp_282).tFFFFFFFE);
							es_299->*di_305 = 0x3A;
							di_277 = di_305 + 1;
							ptrArg04 = SEQ(wArg06_1597, bx_280 + 0x04);
						}
						(ss->*sp_282).tFFFFFFFE = ss;
						Eq_99 es_320 = (ss->*sp_282).tFFFFFFFE;
						byte Eq_99::* di_328 = fn0D28_0000(SEQ(es_320, di_277), ds, (ss->*sp_282).t0000);
						ss->*di_328 = 0x00;
						sp_1033 = (struct Eq_3933 Eq_99::*) ((char *) &sp_282->t0000 + 2);
						wLoc9A_1261 &= ~0x04;
						Eq_99 di_343 = di_328 - (fp - 0x8A);
						dx_239 = wLoc92_1264;
						if (wLoc92_1264 <= di_343)
							dx_239 = di_343;
						es_di_1972 = SEQ(es_320, fp - 0x8A);
						goto l0D28_03FE;
					case 0x0F:
						Eq_99 es_220 = SLICE(ptrArg04, selector, 16);
						Eq_99 di_225 = (word16) ptrArg04;
						Eq_99 cx_212 = wLoc92_1264;
						dx_239 = ax_65;
						ptrArg08 = &(psegArg0A_1702->*si_1007);
						if (wLoc92_1264 < 0x00)
							cx_212.u0 = 0x06;
						word16 wLoc06_1291;
						word16 ax_253;
						struct Eq_4625 Eq_99::* sp_218 = sp_1033 - 2;
						(ss->*sp_218).t0000 = es_220;
						(ss->*sp_218).tFFFFFFFE = di_225;
						(ss->*sp_218).tFFFFFFFC = cx_212;
						(ss->*sp_218).tFFFFFFFA = ss;
						(ss->*sp_218).tFFFFFFF8 = fp - 0x89;
						(ss->*sp_218).tFFFFFFF6 = ax_65;
						(ss->*sp_218).tFFFFFFF4 = wLoc9A_1261 & 0x01;
						if ((wLoc9A_1261 & 0x80) != 0x00)
						{
							ax_253 = 0x02;
							wLoc06_1291 = 0x04;
						}
						else if ((wLoc9A_1261 & 0x0100) != 0x00)
						{
							ax_253 = 0x08;
							wLoc06_1291 = 0x0A;
						}
						else
						{
							wLoc06_1291 = 0x08;
							ax_253 = 0x06;
						}
						(ss->*sp_218).wFFFFFFF2 = ax_253;
						__REALCVT(ds);
						(ss->*sp_218).tFFFFFFF0 = ss;
						sp_1033 = sp_218 - 0x0E;
						ptrArg04 = SEQ(wArg06_1597, wArg04_1270 + wLoc06_1291);
						es_di_1972 = SEQ((ss->*sp_218).tFFFFFFF0, fp - 0x89);
l0D28_03FE:
						es_505 = SLICE(es_di_1972, selector, 16);
						di_502 = (word16) es_di_1972;
						if ((wLoc9A_1261 & 0x08) != 0x00)
						{
							dx_239 = wLoc94_1263;
							es_di_1963 = es_di_1972;
							if (wLoc94_1263 > 0x00)
							{
l0D28_040E:
								es_505 = SLICE(es_di_1963, selector, 16);
								di_502 = (word16) es_di_1963;
								Eq_99 cx_509 = fn0D28_0044(di_502, es_505);
								if (*es_di_1963 == 0x2D)
									--cx_509;
								dx_239 -= cx_509;
								if (dx_239 > 0x00)
									wLoc8E_1260 = dx_239;
							}
						}
						if (bLoc8F_1262 != 0x00 && es_505->*di_502 != 0x2D)
						{
							--di_502;
							es_505->*di_502 = bLoc8F_1262;
							Eq_4580 v41_545 = wLoc8E_1260 - 0x01;
							wLoc8E_1260 = v41_545 + (v41_545 <u 0x00);
						}
						cx_177 = fn0D28_0044(di_502, es_505);
						es_di_1959 = &(es_505->*di_502);
						goto l0D28_043F;
					case 0x10:
						union Eq_99 Eq_99::* sp_198 = sp_1033 - 2;
						ss->*sp_198 = ss;
						sp_1033 = (struct Eq_3933 Eq_99::*) ((char *) sp_198 + 2);
						cx_177.u0 = 0x01;
						dx_239 = ax_65;
						ptrArg08 = &(psegArg0A_1702->*si_1007);
						ptrArg04 = SEQ(wArg06_1597, wArg04_1270 + 0x02);
						es_di_1959 = SEQ(ss->*sp_198, fp - 0x89);
						goto l0D28_043F;
					case 0x11:
						byte * es_di_141;
						bool Z_161;
						byte * Eq_99::* di_140 = (word16) ptrArg04;
						dx_239 = ax_65;
						ptrArg08 = &(psegArg0A_1702->*si_1007);
						if ((wLoc9A_1261 & 0x20) == 0x00)
						{
							word16 di_151 = ptrArg04->w0000;
							union Eq_99 Eq_99::* sp_154 = sp_1033 - 2;
							ss->*sp_154 = ds;
							Z_161 = SLICE(cond(di_151), bool, 2);
							ptrArg04 = SEQ(wArg06_1597, wArg04_1270 + 0x02);
							es_di_141 = SEQ(ss->*sp_154, di_151);
						}
						else
						{
							es_di_141 = ds->*di_140;
							Z_161 = SLICE(cond(SLICE(es_di_141, selector, 16) | (word16) es_di_141), bool, 2);
							ptrArg04 = SEQ(wArg06_1597, wArg04_1270 + 0x04);
						}
						byte * es_di_1969 = es_di_141;
						if (!Z_161)
						{
							union Eq_99 Eq_99::* sp_165 = sp_1033 - 2;
							ss->*sp_165 = ds;
							es_di_1969 = SEQ(ss->*sp_165, 1414);
						}
						cx_177 = fn0D28_0044((word16) es_di_1969, SLICE(es_di_1969, selector, 16));
						if (cx_177 > wLoc92_1264)
							cx_177 = wLoc92_1264;
						es_di_1959 = es_di_1969;
l0D28_043F:
						byte Eq_99::* di_563 = (word16) es_di_1959;
						byte Eq_99::* si_1162 = di_563;
						Eq_99 bx_576 = wLoc94_1263;
						if ((wLoc9A_1261 & 0x05) == 0x05)
						{
							if (dl_134 != 111)
							{
								if (dl_134 == 0x78 || dl_134 == 88)
								{
									Eq_99 v38_597 = wLoc8E_1260 - 0x02;
									wLoc9A_1261 |= 0x40;
									bx_576 = wLoc94_1263 - 0x02;
									wLoc8E_1260 = v38_597;
									if (v38_597 < 0x00)
										wLoc8E_1260.u0 = 0x00;
								}
l0D28_048C:
								cx = cx_177 + wLoc8E_1260;
								if ((wLoc9A_1261 & 0x02) == 0x00)
								{
									for (; bx_576 > cx; --bx_576)
									{
										di_1019 = fn0D28_0051(SEQ(ss, fp - 2), 0x20, cx, dx_239, bx_576, di_1019);
										sp_1033 = (struct Eq_3933 Eq_99::*) ((char *) &sp_1033->t0000 + 0x0000FFFE);
									}
								}
								if ((wLoc9A_1261 & 0x40) != 0x00)
								{
									di_1019 = fn0D28_0051(SEQ(ss, fp - 2), dl_134, cx, dx_239, bx_576, fn0D28_0051(SEQ(ss, fp - 2), 0x30, cx, dx_239, bx_576, di_1019));
									sp_1033 = (struct Eq_3933 Eq_99::*) ((char *) &sp_1033->t0000 + 0x0000FFFC);
								}
								dx = wLoc8E_1260;
								if (wLoc8E_1260 > 0x00)
								{
									Eq_99 cx_703 = cx - wLoc8E_1260;
									bx_576 -= wLoc8E_1260;
									byte al_720 = *es_di_1959;
									if (al_720 == 0x2D || (al_720 == 0x20 || al_720 == 0x2B))
									{
										si_1162 = di_563 + 1;
										di_1019 = fn0D28_0051(SEQ(ss, fp - 2), ds->*di_563, cx_703, wLoc8E_1260, bx_576, di_1019);
										sp_1033 = (struct Eq_3933 Eq_99::*) ((char *) &sp_1033->t0000 + 0x0000FFFE);
										--cx_703;
										--bx_576;
									}
									Eq_99 cx_775 = wLoc8E_1260;
									if (wLoc8E_1260 != 0x00)
									{
										do
										{
											di_1019 = fn0D28_0051(SEQ(ss, fp - 2), 0x30, cx_775, cx_703, bx_576, di_1019);
											sp_1033 = (struct Eq_3933 Eq_99::*) ((char *) &sp_1033->t0000 + 0x0000FFFE);
											--cx_775;
										} while (cx_775 != 0x00);
									}
									dx = cx_775;
									cx = cx_703;
								}
								if (cx != 0x00)
								{
									bx_576 -= cx;
									do
									{
										ss->*di_1019 = ds->*si_1162;
										ci8 v43_812 = bLoc57_1252 - 0x01;
										++si_1162;
										++di_1019;
										bLoc57_1252 = v43_812;
										if (v43_812 <= 0x00)
											di_1019 = fn0D28_005A(SEQ(ss, fp - 2), cx, dx, bx_576, di_1019);
										--cx;
									} while (cx != 0x00);
								}
								bx = bx_576;
								if (bx_576 > 0x00)
								{
									cx = bx_576;
									do
									{
										di_1019 = fn0D28_0051(SEQ(ss, fp - 2), 0x20, cx, dx, bx_576, di_1019);
										sp_1033 = (struct Eq_3933 Eq_99::*) ((char *) &sp_1033->t0000 + 0x0000FFFE);
										--cx;
									} while (cx != 0x00);
								}
								goto l0D28_0097;
							}
							if (wLoc8E_1260 <= 0x00)
								wLoc8E_1260.u0 = 0x01;
						}
						goto l0D28_048C;
					case 0x12:
						uint16 * es_di_104;
						uint16 * Eq_99::* di_103 = (word16) ptrArg04;
						ptrArg08 = &(psegArg0A_1702->*si_1007);
						if ((wLoc9A_1261 & 0x20) == 0x00)
						{
							word16 di_109 = ptrArg04->w0000;
							union Eq_99 Eq_99::* sp_114 = sp_1033 - 2;
							ss->*sp_114 = ds;
							ptrArg04 = SEQ(wArg06_1597, wArg04_1270 + 0x02);
							es_di_104 = SEQ(ss->*sp_114, di_109);
						}
						else
						{
							es_di_104 = ds->*di_103;
							ptrArg04 = SEQ(wArg06_1597, wArg04_1270 + 0x04);
						}
						*es_di_104 = (uint16) (uint8) (0x50 - bLoc57_1252);
						goto l0D28_0093;
					case 0x13:
					case 0x14:
					case 0x15:
l0D28_053A:
						byte Eq_99::* si_1017 = si_1007;
						byte al_1020 = 0x25;
						do
						{
							di_1019 = fn0D28_0051(SEQ(ss, fp - 2), al_1020, cx, dx, bx, di_1019);
							byte al_1038 = ds->*si_1017;
							sp_1033 = (struct Eq_3933 Eq_99::*) ((char *) &sp_1033->t0000 + 0x0000FFFE);
							++si_1017;
							al_1020 = al_1038;
						} while (al_1038 != 0x00);
						goto l0D28_0550;
					case 22:
						wLoc9A_1261 &= ~0x20;
						ch_1177 = 0x05;
						break;
					case 0x17:
						wLoc9A_1261 |= 0x20;
						ch_1177 = 0x05;
						break;
					}
					al_1006 = ds->*si_1007;
					++si_1007;
				}
l0D28_0138:
				dx = ax_65;
				goto l0D28_053A;
			}
		}
		ss->*di_1019 = al_1006;
		ci8 v16_1090 = bLoc57_1252 - 0x01;
		++di_1019;
		bLoc57_1252 = v16_1090;
		if (v16_1090 <= 0x00)
			di_1019 = fn0D28_005A(SEQ(ss, fp - 2), cx, dx, bx, di_1019);
	}
l0D28_0550:
	if (bLoc57_1252 < 0x50)
		fn0D28_005A(SEQ(ss, fp - 2), cx, dx, bx, di_1019);
	struct Eq_3984 Eq_99::* sp_1068 = (char *) &sp_1033->t0000 + 2;
	return (ss->*sp_1068).w0002;
}

// 0D28:0044: Register word16 fn0D28_0044(Register (memptr (ptr16 Eq_4047) byte) di, Register (ptr16 Eq_4047) es)
// Called from:
//      __VPRINTER
word16 fn0D28_0044(byte Eq_4047::* di, struct Eq_4047 * es)
{
	word16 cx_12 = ~0x00;
	while (cx_12 != 0x00)
	{
		di = di_45 + 1;
		--cx_12;
		di_45 = di;
		if (es->*di_45 != 0x00)
			return ~cx_12 - 0x01;
	}
	return ~cx_12 - 0x01;
}

// 0D28:0051: Register (memptr Eq_99 byte) fn0D28_0051(Sequence (ptr32 Eq_3973) ss_bp, Register byte al, Register Eq_99 cx, Register Eq_99 dx, Register Eq_99 bx, Register (memptr Eq_99 byte) di)
// Called from:
//      __VPRINTER
byte Eq_99::* fn0D28_0051(struct Eq_3973 * ss_bp, byte al, Eq_99 cx, Eq_99 dx, Eq_99 bx, byte Eq_99::* di)
{
	Eq_99 ss = SLICE(ss_bp, selector, 16);
	ss->*di = al;
	ci8 v8_10 = ss_bp->bFFFFFFAB - 0x01;
	ss_bp->bFFFFFFAB = v8_10;
	if (v8_10 <= 0x00)
		return di + 1;
	return fn0D28_005A(ss_bp, cx, dx, bx, di + 1);
}

// 0D28:005A: Register (memptr Eq_99 byte) fn0D28_005A(Sequence (ptr32 Eq_3973) ss_bp, Register Eq_99 cx, Register Eq_99 dx, Register Eq_99 bx, Register (memptr Eq_99 byte) di)
// Called from:
//      __VPRINTER
//      fn0D28_0051
byte Eq_99::* fn0D28_005A(struct Eq_3973 * ss_bp, Eq_99 cx, Eq_99 dx, Eq_99 bx, byte Eq_99::* di)
{
	word16 bp = (word16) ss_bp;
	word16 di_20 = di - (bp - 0x54);
	word16 ax_39;
	ss_bp->ptr0012();
	if (ax_39 == 0x00)
		ss_bp->wFFFFFFFE = 0x01;
	ss_bp->bFFFFFFAB = 0x50;
	ss_bp->wFFFFFFA8 += di_20;
	return bp - 0x54;
}

// subject_0D7F.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject_0D7F.h"

// 0D7F:0004: Register word16 _free(Register Eq_99 ds, Stack Eq_97 wArg04, Stack Eq_99 wArg06)
// Called from:
//      _setvbuf
//      _fclose
word16 _free(Eq_99 ds, Eq_97 wArg04, Eq_99 wArg06)
{
	return _farfree(ds, wArg04, wArg06);
}

// 0D7F:0016: void fn0D7F_0016(Register Eq_99 ds, Stack Eq_97 ptrArg04)
// Called from:
//      fn0D7F_0212
void fn0D7F_0016(Eq_99 ds, Eq_97 ptrArg04)
{
	Eq_99 wArg06_88 = SLICE(ptrArg04, word16, 16);
	Eq_97 wArg04_89 = (word16) ptrArg04;
	word16 dx_105;
	fn0800_076C(*((word32) ds + 898), 0x00, *((word32) ds + 900), 0x00, out dx_105);
	Eq_97 Z_23 = <invalid>;
	if (!Z_23)
	{
		Eq_97 es_bx_47 = *((word32) *((word32) ds + 898) + 0x0C);
		Eq_97 es_bx_54 = *((word32) ds + 898);
		*((word32) es_bx_54 + 0x0E) = wArg06_88;
		*((word32) es_bx_54 + 0x0C) = wArg04_89;
		*((word32) es_bx_47 + 0x0A) = wArg06_88;
		*((word32) es_bx_47 + 8) = wArg04_89;
		*((word32) ptrArg04 + 0x0E) = SLICE(es_bx_47, selector, 16);
		*((word32) ptrArg04 + 0x0C) = (word16) es_bx_47;
		Eq_97 ax_74 = *((word32) ds + 898);
		*((word32) ptrArg04 + 0x0A) = *((word32) ds + 900);
		*((word32) ptrArg04 + 8) = ax_74;
	}
	else
	{
		*((word32) ds + 900) = SLICE(ptrArg04, selector, 16);
		*((word32) ds + 898) = (word16) ptrArg04;
		*((word32) ptrArg04 + 0x0A) = wArg06_88;
		*((word32) ptrArg04 + 8) = wArg04_89;
		*((word32) ptrArg04 + 0x0E) = wArg06_88;
		*((word32) ptrArg04 + 0x0C) = wArg04_89;
	}
}

// 0D7F:00B5: Register word16 fn0D7F_00B5(Register Eq_99 ds, Stack Eq_97 ptrArg04, Stack Eq_97 ptrArg08)
// Called from:
//      fn0D7F_0212
word16 fn0D7F_00B5(Eq_99 ds, Eq_97 ptrArg04, Eq_97 ptrArg08)
{
	Eq_99 wArg0A_98 = SLICE(ptrArg08, word16, 16);
	Eq_97 wArg08_99 = (word16) ptrArg08;
	Eq_99 wArg06_102 = SLICE(ptrArg04, word16, 16);
	Eq_97 wArg04_103 = (word16) ptrArg04;
	ui32 v13_v11_94 = SEQ(*((word32) ptrArg04 + 2), *ptrArg04) + SEQ(*((word32) ptrArg08 + 2), *ptrArg08);
	*ptrArg04 = (word16) v13_v11_94;
	*((word32) ptrArg04 + 2) = SLICE(v13_v11_94, word16, 16);
	word16 dx_117;
	fn0800_076C(*((word32) ds + 894), wArg0A_98, *((word32) ds + 896), wArg08_99, out dx_117);
	Eq_97 Z_36 = <invalid>;
	if (!Z_36)
	{
		*((word32) ds + 896) = SLICE(ptrArg04, selector, 16);
		*((word32) ds + 894) = (word16) ptrArg04;
	}
	else
	{
		fn0800_0711(wArg08_99, *((word32) ptrArg08 + 2), wArg0A_98, *ptrArg08);
		Eq_97 dx_ax_116 = <invalid>;
		*((word32) dx_ax_116 + 6) = wArg06_102;
		*((word32) dx_ax_116 + 4) = wArg04_103;
	}
	return __pull_free_block(ds, ptrArg08);
}

// 0D7F:012D: Register word16 fn0D7F_012D(Register Eq_99 ds)
// Called from:
//      _farfree
word16 fn0D7F_012D(Eq_99 ds)
{
	word16 dx_129;
	word16 dx_211;
	fn0800_076C(*((word32) ds + 890), *((word32) ds + 896), *((word32) ds + 892), *((word32) ds + 894), out dx_211);
	Eq_97 Z_22 = <invalid>;
	if (!Z_22)
	{
		dx_129 = __brk(ds, SEQ(*((word32) ds + 892), *((word32) ds + 890)));
		((word32) ds + 896)->u0 = 0x00;
		((word32) ds + 894)->u0 = 0x00;
		((word32) ds + 892)->u0 = 0x00;
		((word32) ds + 890)->u0 = 0x00;
	}
	else
	{
		Eq_97 es_bx_27 = *((word32) *((word32) ds + 894) + 4);
		Eq_99 es_28 = SLICE(es_bx_27, selector, 16);
		Eq_97 bx_30 = (word16) es_bx_27;
		if ((*((word32) es_bx_27 + 2) & 0x00 | *es_bx_27 & 0x01) == 0x00)
		{
			__pull_free_block(ds, es_bx_27);
			word16 dx_212;
			fn0800_076C(bx_30, *((word32) ds + 892), es_28, *((word32) ds + 890), out dx_212);
			Eq_97 Z_96 = <invalid>;
			if (!Z_96)
			{
				((word32) ds + 896)->u0 = 0x00;
				((word32) ds + 894)->u0 = 0x00;
				((word32) ds + 892)->u0 = 0x00;
				((word32) ds + 890)->u0 = 0x00;
			}
			else
			{
				Eq_97 es_bx_101 = *((word32) es_bx_27 + 4);
				*((word32) ds + 896) = SLICE(es_bx_101, selector, 16);
				*((word32) ds + 894) = (word16) es_bx_101;
			}
			dx_129 = __brk(ds, es_bx_27);
		}
		else
		{
			dx_129 = __brk(ds, SEQ(*((word32) ds + 896), *((word32) ds + 894)));
			*((word32) ds + 896) = SLICE(es_bx_27, selector, 16);
			*((word32) ds + 894) = (word16) es_bx_27;
		}
	}
	return dx_129;
}

// 0D7F:0212: Register cui16 fn0D7F_0212(Register Eq_99 ds, Stack Eq_97 ptrArg04)
// Called from:
//      _farfree
cui16 fn0D7F_0212(Eq_99 ds, Eq_97 ptrArg04)
{
	Eq_99 wArg06_171 = SLICE(ptrArg04, word16, 16);
	Eq_97 wArg04_172 = (word16) ptrArg04;
	Eq_100 v9_13 = *ptrArg04 - 0x01;
	*ptrArg04 = v9_13;
	*((word32) ptrArg04 + 2) -= v9_13 < 0x00;
	fn0800_0711(wArg04_172, *((word32) ptrArg04 + 2), wArg06_171, *ptrArg04);
	Eq_97 dx_ax_227 = <invalid>;
	Eq_97 es_bx_40 = *((word32) ptrArg04 + 4);
	mp16 sp_136 = fp - 0x0A;
	word16 dx_29 = SLICE(dx_ax_227, word16, 16);
	Eq_97 ax_27 = (word16) dx_ax_227;
	Eq_99 wLoc04_186 = SLICE(es_bx_40, word16, 16);
	Eq_97 wLoc06_187 = (word16) es_bx_40;
	if ((*((word32) es_bx_40 + 2) & 0x00 | *es_bx_40 & 0x01) == 0x00)
	{
		word16 dx_228;
		fn0800_076C(wArg04_172, *((word32) ds + 892), wArg06_171, *((word32) ds + 890), out dx_228);
		Eq_97 Z_67 = <invalid>;
		if (!Z_67)
		{
			ui32 v19_v18_168 = SEQ(*((word32) es_bx_40 + 2), *es_bx_40) + SEQ(*((word32) ptrArg04 + 2), *ptrArg04);
			*es_bx_40 = (word16) v19_v18_168;
			*((word32) es_bx_40 + 2) = SLICE(v19_v18_168, word16, 16);
			*((word32) dx_ax_227 + 6) = wLoc04_186;
			*((word32) dx_ax_227 + 4) = wLoc06_187;
			wArg06_171 = SLICE(es_bx_40, selector, 16);
			wArg04_172 = (word16) es_bx_40;
l0D7F_02B2:
			cui16 dx_131 = *((word32) dx_ax_227 + 2) & 0x00 | *dx_ax_227 & 0x01;
			if (dx_131 == 0x00)
			{
				struct Eq_5240 Eq_5243::* sp_137 = sp_136 - 2;
				(ss->*sp_137).w0000 = dx_29;
				(ss->*sp_137).tFFFFFFFE = ax_27;
				(ss->*sp_137).tFFFFFFFC = wArg06_171;
				(ss->*sp_137).tFFFFFFFA = wArg04_172;
				dx_131 = fn0D7F_00B5(ds, (ss->*sp_137).tFFFFFFFA, (ss->*sp_137).tFFFFFFFE);
			}
			return dx_131;
		}
	}
	fn0D7F_0016(ds, ptrArg04);
	sp_136 = fp - 0x0C;
	goto l0D7F_02B2;
}

// 0D7F:02DE: Register word16 _farfree(Register Eq_99 ds, Stack Eq_97 wArg04, Stack Eq_99 wArg06)
// Called from:
//      _free
word16 _farfree(Eq_99 ds, Eq_97 wArg04, Eq_99 wArg06)
{
	if ((wArg04 | wArg06) != 0x00)
	{
		fn0800_0711(wArg04, ~0x00, wArg06, ~0x07);
		Eq_97 dx_ax_98 = <invalid>;
		word16 dx_99;
		fn0800_076C((word16) dx_ax_98, *((word32) ds + 896), SLICE(dx_ax_98, word16, 16), *((word32) ds + 894), out dx_99);
		Eq_97 Z_39 = <invalid>;
		if (!Z_39)
			dx = fn0D7F_012D(ds);
		else
			dx = fn0D7F_0212(ds, dx_ax_98);
	}
	return dx;
}

