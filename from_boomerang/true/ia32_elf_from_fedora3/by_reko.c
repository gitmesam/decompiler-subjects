// subject.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

// 080488E4: void __fpending()
void __fpending()
{
}

// 080488F4: void __overflow()
void __overflow()
{
}

// 08048904: void fputs_unlocked()
void fputs_unlocked()
{
}

// 08048914: void fprintf()
void fprintf()
{
}

// 08048924: void getenv()
void getenv()
{
}

// 08048934: void dcgettext()
void dcgettext()
{
}

// 08048944: void setlocale()
void setlocale()
{
}

// 08048954: void __cxa_atexit()
void __cxa_atexit()
{
}

// 08048964: void __errno_location()
void __errno_location()
{
}

// 08048974: void malloc()
void malloc()
{
}

// 08048984: void abort()
void abort()
{
}

// 08048994: void vfprintf()
void vfprintf()
{
}

// 080489A4: void bindtextdomain()
void bindtextdomain()
{
}

// 080489B4: void mbrtowc()
void mbrtowc()
{
}

// 080489C4: void __libc_start_main()
void __libc_start_main()
{
}

// 080489D4: void realloc()
void realloc()
{
}

// 080489E4: void textdomain()
void textdomain()
{
}

// 080489F4: void printf()
void printf()
{
}

// 08048A04: void memcpy()
void memcpy()
{
}

// 08048A14: void fclose()
void fclose()
{
}

// 08048A24: void __ctype_get_mb_cur_max()
void __ctype_get_mb_cur_max()
{
}

// 08048A34: void exit()
void exit()
{
}

// 08048A44: void calloc()
void calloc()
{
}

// 08048A54: void iswprint()
void iswprint()
{
}

// 08048A64: void free()
void free()
{
}

// 08048A74: void memset()
void memset()
{
}

// 08048A84: void mbsinit()
void mbsinit()
{
}

// 08048A94: void error()
void error()
{
}

// 08048AA4: void __ctype_b_loc()
void __ctype_b_loc()
{
}

// 08048AC0: void fn08048AC0(Register (ptr32 Eq_2) edx, Stack int32 dwArg00)
void fn08048AC0( * edx, int32 dwArg00)
{
	__align((char *) fp + 0x04);
	__libc_start_main(&globals->t8048C4A, dwArg00, (char *) fp + 0x04, &globals->t804A008, &globals->t804A05C, edx, fp);
	__hlt();
}

// 08048D81: void close_stdout()
void close_stdout()
{
	FILE ** edi_19 = globals->ptr804B958;
	FILE * edx_20 = *edi_19;
	int32 esi_119 = 0x00 - ((edx_20->dw0000 >> 0x05 & 0x01) < 0x01);
	if (esi_119 != 0x00 && __fpending(edx_20) == 0x00)
		return;
	if (fclose(*edi_19) != 0x00)
		esi_119 = *__errno_location();
	if (esi_119 < 0x00)
		return;
	dcgettext(null, "write error", 0x05);
	word32 eax_87 = globals->dw804BA04;
	if (eax_87 == 0x00)
		error(*globals->ptr804B95C, esi_119, "%s", tLoc30);
	else
	{
		fn08049A8B(eax_87);
		error(*globals->ptr804B95C, esi_119, "%s: %s", tLoc30);
	}
}

// 08048F36: void fn08048F36(Stack ptr32 dwArg04, Stack byte bArg08, Stack ui32 dwArg0C)
void fn08048F36(ptr32 dwArg04, byte bArg08, ui32 dwArg0C)
{
	ui32 ecx_18 = (word32) bArg08;
	ui32 eax_27 = (word32) ((byte) ecx_18 >> 0x05);
	int32 * edi_33 = (eax_27 << 0x02) + 0x04 + dwArg04;
	if (dwArg04 == 0x00)
	{
		int32 * edi_67 = 0x0804BB24 + (eax_27 << 0x02);
		byte cl_69 = (byte) (ecx_18 & 0x1F);
		int32 edx_71 = *edi_67;
		*edi_67 = edx_71 ^ (dwArg0C & 0x01 ^ edx_71 >> cl_69 & 0x01) << cl_69;
	}
	else
	{
		int32 edx_46 = *edi_33;
		byte cl_48 = (byte) (ecx_18 & 0x1F);
		*edi_33 = edx_46 ^ (dwArg0C & 0x01 ^ edx_46 >> cl_48 & 0x01) << cl_48;
	}
}

// 08048FF6: Register size_t fn08048FF6(Register size_t eax, Register Eq_63 edx, Stack Eq_182 dwArg04, Stack Eq_63 dwArg08, Stack uint32 dwArg0C, Stack (ptr32 Eq_185) dwArg10, Register out ptr32 espOut, Register out ptr32 ebpOut)
size_t fn08048FF6(size_t eax, size_t edx, Eq_182 dwArg04, size_t dwArg08, uint32 dwArg0C, Eq_185 * dwArg10, ptr32 & espOut, ptr32 & ebpOut)
{
	size_t dwLoc38_130 = 0x00;
	byte * dwLoc3C_173 = null;
	word32 eax_33 = (word32) (__ctype_get_mb_cur_max() == 0x01);
	if (dwArg0C <= 0x06)
	{
		<anonymous> * eax_73 = globals->a804A2CC[dwArg0C * 0x04] + 0x0804B94C;
		word32 esp_95;
		word32 ebp_96;
		word32 edi_97;
		word32 esi_98;
		word32 ebx_99;
		byte SCZO_100;
		Eq_63 eax_101;
		word32 edx_102;
		byte al_103;
		bool Z_104;
		byte CZ_105;
		byte SZO_106;
		bool C_107;
		byte dl_108;
		bool D_109;
		word32 ecx_110;
		byte cl_111;
		eax_73();
		return eax_101;
	}
	Eq_63 edx_220;
	Eq_63 dwLoc34_113 = 0x00;
	edx_220 = edx;
	while (dwArg08 != ~0x00)
	{
		edx_220 = dwArg08;
		if (dwLoc34_113 == dwArg08)
		{
l08049228:
			if (false)
			{
				while (true)
				{
					Eq_296 al_180 = (byte) (word32) *dwLoc3C_173;
					if (al_180 == 0x00)
						break;
					if (dwLoc38_130 < edx)
						Mem196[eax + dwLoc38_130:byte] = al_180;
					dwLoc38_130 = (Eq_63) ((word32) dwLoc38_130 + 0x01);
					++dwLoc3C_173;
				}
			}
			if (dwLoc38_130 < edx)
				Mem171[eax + dwLoc38_130:byte] = 0x00;
			word32 ebp_167;
			*ebpOut = ebp;
			word32 esp_168;
			*espOut = fp;
			return dwLoc38_130;
		}
l08049093:
		Eq_236 dl_251 = false;
		if ((DPB(edx_220, dl_251, 0) & (word32) false) != 0x00 && dwLoc34_113 <= dwArg08)
		{
			word32 esi_707 = dwArg04 + dwLoc34_113;
			word32 ecx_708 = 0x00;
			bool Z_711 = (bool) cond(0x00);
			byte * edi_715 = null;
			while (ecx_708 != 0x00)
			{
				Z_711 = (bool) cond(*esi_784 - *edi_785);
				esi_707 = esi_784 + 0x01;
				edi_715 = edi_785 + 0x01;
				--ecx_708;
				byte * esi_784 = esi_707;
				byte * edi_785 = edi_715;
				if (*esi_784 == *edi_785)
					break;
			}
			if (!Z_711)
			{
				if (dwLoc38_130 < edx)
					Mem744[eax + dwLoc38_130:byte] = 0x5C;
				dwLoc38_130 = (Eq_63) ((word32) dwLoc38_130 + 0x01);
			}
		}
		byte al_273 = (byte) (word32) Mem0[dwArg04 + dwLoc34_113:byte];
		byte bLoc5C_274 = al_273;
		uint32 eax_275 = (word32) al_273;
		if (eax_275 <= 0x7E)
		{
			<anonymous> * eax_280 = globals->a804A2E8[eax_275 * 0x04] + 0x0804B94C;
			word32 esp_283;
			word32 ebp_284;
			word32 edi_285;
			word32 esi_286;
			word32 ebx_287;
			byte SCZO_288;
			Eq_63 eax_289;
			word32 edx_290;
			byte al_291;
			bool Z_292;
			byte CZ_293;
			byte SZO_294;
			bool C_295;
			byte dl_296;
			bool D_297;
			word32 ecx_298;
			byte cl_299;
			eax_280();
			return eax_289;
		}
		Eq_321 dwLoc60_357;
		ui32 dwLoc64_358;
		if (eax_33 != 0x00)
		{
			ui32 edx_530 = (word32) *((char *) *__ctype_b_loc() + (word32) al_273 * 0x02);
			dwLoc60_357 = 0x01;
			dwLoc64_358 = edx_530 & 0x4000;
			edx_220 = (Eq_63) DPB(edx_530 & 0x4000, false, 0);
			if ((edx_220 & (word32) ((edx_530 & 0x4000) == 0x00)) != 0x00)
				goto l08049142;
			goto l0804933E;
		}
		dwLoc60_357 = 0x00;
		dwLoc64_358 = 0x01;
		if (dwArg08 == ~0x00)
		{
			Eq_63 ecx_674 = dwArg08;
			Eq_182 edi_681 = dwArg04;
			while (ecx_674 != 0x00)
			{
				edi_681 = (word32) edi_783 + 0x01;
				--ecx_674;
				Eq_182 edi_783 = edi_681;
				if (0x00 != *edi_783)
					break;
			}
			dwArg08 = ~ecx_674 - 0x01;
		}
		edx_220 = dwLoc34_113 + dwArg04;
		do
		{
			word32 esi_575 = dwLoc34_113 + dwLoc60_357;
			word32 eax_583 = mbrtowc(fp - 0x28, esi_575 + dwArg04, dwArg08 - esi_575, fp - 0x24);
			if (eax_583 == 0x00)
				break;
			if (eax_583 == ~0x00)
			{
				dwLoc64_358 = 0x00;
				if (dwLoc60_357 > 0x01)
					goto l08049142;
				goto l08049325;
			}
			if (eax_583 == ~0x01)
			{
				dwLoc64_358 = 0x00;
				if (esi_575 >= dwArg08 || Mem0[edx_220 + dwLoc60_357:byte] == 0x00)
					break;
				do
				{
					word32 v30_659 = dwLoc60_357 + 0x01;
					dwLoc60_357 = v30_659;
					if (dwLoc34_113 + v30_659 >=u dwArg08)
						goto l0804931A;
				} while (Mem0[edx_220 + v30_659:byte] != 0x00);
				if (v30_659 > 0x01)
					goto l08049142;
				goto l08049325;
			}
			dwLoc64_358 &= -(word32) (iswprint(dwLoc28) != 0x00);
			dwLoc60_357 += eax_583;
		} while (mbsinit(fp - 0x24) == 0x00);
l0804931A:
		if (dwLoc60_357 <= 0x01)
		{
l08049325:
			edx_220 = DPB(edx_220, false, 0);
			if ((edx_220 & (word32) (dwLoc64_358 == 0x00)) != 0x00)
				goto l08049142;
l0804933E:
			edx_220 = dwLoc34_113 + 0x01;
			if (0x00 != 0x00 && ((byte) ((dwArg10->a0004)[(word32) ((byte) ((word32) al_273) >> 0x05)] >> (byte) ((word32) al_273 & 0x1F)) & 0x01) != 0x00)
			{
				if (dwLoc38_130 < edx)
					Mem524[eax + dwLoc38_130:byte] = 0x5C;
				++dwLoc38_130;
				edx_220 = dwLoc34_113 + 0x01;
			}
		}
		else
		{
l08049142:
			word32 ecx_371 = dwLoc34_113 + dwLoc60_357;
			while (true)
			{
				if ((DPB(edx_220, false, 0) & (word32) (dwLoc64_358 == 0x00)) != 0x00)
				{
					if (dwLoc38_130 < edx)
						Mem469[eax + dwLoc38_130:byte] = 0x5C;
					size_t v25_426 = (word32) dwLoc38_130 + 0x01;
					if (v25_426 < edx)
						Mem466[eax + v25_426:byte] = ((byte) (word32) bLoc5C_274 >>u 0x06) + 0x30;
					if ((word32) v25_426 + 0x01 < edx)
						*((word32) eax + ((word32) v25_426 + 0x01)) = (Eq_63) (((byte) (word32) bLoc5C_274 >> 0x03 & 0x07) + 0x30);
					dwLoc38_130 = (Eq_63) ((word32) v25_426 + 0x02);
					bLoc5C_274 = ((byte) (word32) bLoc5C_274 & 0x07) + 0x30;
				}
				edx_220 = dwLoc34_113 + 0x01;
				if (edx_220 >= ecx_371)
					break;
				if (dwLoc38_130 < edx)
					Mem420[eax + dwLoc38_130:byte] = (byte) (word32) bLoc5C_274;
				dwLoc38_130 = (Eq_63) ((word32) dwLoc38_130 + 0x01);
				dwLoc34_113 = edx_220;
				bLoc5C_274 = (byte) (word32) Mem0[edx_220 + dwArg04:byte];
			}
		}
		if (dwLoc38_130 < edx)
			Mem346[eax + dwLoc38_130:byte] = (byte) (word32) bLoc5C_274;
		dwLoc38_130 = (Eq_63) ((word32) dwLoc38_130 + 0x01);
		dwLoc34_113 = edx_220;
	}
	if (Mem0[dwArg04 + dwLoc34_113:byte] == 0x00)
		goto l08049228;
	goto l08049093;
}

// 080496C3: Register word32 fn080496C3(Stack Eq_63 dwArg04, Stack Eq_63 dwArg08, Stack Eq_182 dwArg0C, Stack Eq_63 dwArg10, Stack (ptr32 Eq_185) dwArg14)
word32 fn080496C3(size_t dwArg04, size_t dwArg08, Eq_182 dwArg0C, size_t dwArg10, Eq_185 * dwArg14)
{
	struct Eq_185 * edi_19 = dwArg14;
	if (dwArg14 == null)
		edi_19 = &globals->t804BB20;
	int32 * eax_24 = __errno_location();
	word32 esp_42;
	ptr32 ebp_43;
	word32 eax_44 = fn08048FF6(dwArg04, dwArg08, dwArg0C, dwArg10, edi_19->dw0000, edi_19, out esp_42, out ebp_43);
	*eax_24 = *(ebp_43 - 0x10);
	return eax_44;
}

// 08049721: void fn08049721(Register Eq_602 eax, Register Eq_603 ebp, Register (ptr32 Eq_604) esi)
void fn08049721(Eq_602 eax, Eq_603 ebp, Eq_604 * esi)
{
	while (true)
	{
		__errno_location();
		if (eax < 0x00)
			break;
		if (globals->u804B9DC > eax)
		{
l080497C5:
			Eq_1331 eax_57[] = globals->ptr804B9E8;
			*(fp - 0x20) = eax_57[*(fp - 0x14)].dw0000;
			ptr32 edi_62 = eax_57[*(fp - 0x14)].ptr0004;
			word32 edx_64 = fp->dw0004;
			*(fp - 44) = fp->dw0008;
			*(fp - 0x30) = edx_64;
			word32 edx_68 = *(fp - 0x20);
			*(fp - 0x34) = *(fp - 0x18);
			*(fp - 0x3C) = edi_62;
			*(fp - 0x38) = edx_68;
			up32 eax_77 = fn080496C3(dwArg00, dwArg04, dwArg08, dwArg0C, dwArg10);
			if (*(fp - 0x20) <= eax_77)
			{
				struct Eq_604 * esi_104 = globals->ptr804B9E8;
				ui32 edx_98 = *(fp - 0x14);
				*(fp - 0x20) = eax_77 + 0x01;
				esi_104[edx_98] = (struct Eq_604) (eax_77 + 0x01);
				if (edi_62 != 0x0804BA20)
				{
					*(fp - 0x3C) = edi_62;
					fn08049FE0(dwArg00);
					esi_104 = globals->ptr804B9E8;
				}
				*(fp - 0x3C) = *(fp - 0x20);
				struct Eq_886 * esi_107;
				word32 edi_108;
				struct Eq_604 * eax_109 = fn08049DC5(&globals->t804B94C, fp - 0x04, esi_104, ebp, dwArg00, out esi_107, out edi_108);
				(&esi_107->a0004[*(fp - 0x14)].ptr0000.a0000)[0x00].dw0000 = eax_109;
				word32 eax_114 = fp->dw0008;
				*(fp - 0x30) = fp->dw0004;
				word32 edx_116 = *(fp - 0x20);
				*(fp - 44) = eax_114;
				word32 eax_118 = *(fp - 0x18);
				*(fp - 0x38) = edx_116;
				*(fp - 0x34) = eax_118;
				*(fp - 0x3C) = (struct Eq_604 **) eax_109;
				fn080496C3(dwArg00, dwArg04, dwArg08, dwArg0C, dwArg10);
			}
			*__errno_location() = *(fp - 0x1C);
			return;
		}
		Eq_705 edi_126 = (word32) eax + 0x01;
		if (edi_126 <= 0x1FFFFFFF)
		{
			struct Eq_604 * esi_129 = globals->ptr804B9E8;
			if (esi_129 == &globals->t804B9E0)
			{
				word32 esi_156;
				struct Eq_604 * eax_158 = fn08049DC5(&globals->t804B94C, fp - 0x04, esi_129, dwLoc40, 0x08, out esi_156, out edi_126);
				word32 edx_159 = globals->dw804B9E4;
				globals->ptr804B9E8 = eax_158;
				eax_158->a0000[0x00].dw0000 = globals->t804B9E0.dw0000;
				eax_158->dw0004 = edx_159;
				esi_129 = eax_158;
			}
			*(fp - 0x3C) = (struct Eq_604 **) esi_129;
			*(fp - 0x38) = edi_126 * 0x08;
			word32 esi_139;
			ui32 edi_140;
			void * eax_141 = fn08049E3F(fp - 0x04, esi_129, dwArg00, dwArg04, out esi_139, out edi_140);
			ui32 edx_142 = globals->u804B9DC;
			globals->ptr804B9E8 = eax_141;
			*(fp - 0x38) = 0x00;
			*(fp - 0x3C) = (char *) eax_141 + edx_142 * 0x08;
			*(fp - 0x34) = edi_140 - edx_142 << 0x03;
			memset(*(fp - 0x3C), *(fp - 0x38), *(fp - 0x34));
			globals->u804B9DC = edi_140;
			goto l080497C5;
		}
		fn08049D10(esi);
		dwLoc40 = fp - 0x04;
		eax = dwLoc38;
		dwLoc38.u0 = ~0x00;
		ebp = fp - 0x04;
	}
	abort();
}

// 080499F0: void fn080499F0(Stack word32 dwArg04, Stack byte bArg08)
void fn080499F0(word32 dwArg04, byte bArg08)
{
	fn08048F36(fp - 0x3C, (byte) (int32) bArg08, 0x01);
	fn08049721(0x00, fp - 0x04, fp - 0x3C);
}

// 08049A8B: void fn08049A8B(Stack word32 dwArg04)
void fn08049A8B(word32 dwArg04)
{
	fn080499F0(dwArg04, 0x3A);
}

// 08049D10: void fn08049D10(Register (ptr32 Eq_604) esi)
void fn08049D10(Eq_604 * esi)
{
	ptr32 ebx_10 = 0x0804B94C;
	<anonymous> * eax_14 = *globals->ptr804B970;
	if (eax_14 != null)
	{
		word32 esp_45;
		word32 ebp_46;
		byte SCZO_48;
		word32 eax_49;
		byte SZO_50;
		bool C_51;
		bool Z_52;
		word32 esi_53;
		eax_14();
	}
	dcgettext(null, *(ebx_10 - 0x08), 0x05);
	error(**(ebx_10 - 0x10), 0x00, ebx_10 + ~0x169F, tLoc20);
	abort();
}

// 08049DC5: Register (ptr32 void) fn08049DC5(Register (ptr32 Eq_604) ebx, Register Eq_732 ebp, Register (ptr32 Eq_604) esi, Stack Eq_603 dwArg00, Stack Eq_63 dwArg04, Register out ptr32 esiOut, Register out Eq_737 ediOut)
void(Eq_604 * ebx, Eq_732 ebp, Eq_604 * esi, Eq_603 dwArg00, size_t dwArg04, ptr32 & esiOut, Eq_737 & ediOut)
{
	*esiOut = esi;
	*ediOut = edi;
	void * eax_15 = malloc(dwArg04);
	if (eax_15 != null)
		return eax_15;
	fn08049D10(esi);
	if ((uint32) (~0x00 /u dwArg00) >= ebp)
	{
		*(fp - 0x28) = (struct Eq_604 **) ebx;
		*(fp - 0x24) = ebp *s dwArg00;
		void * eax_92 = realloc(*(fp - 0x28), *(fp - 0x24));
		if (eax_92 != null)
		{
			word32 esi_101;
			*esiOut = *(fp - 0x18);
			word32 edi_103;
			*ediOut = *(fp - 0x14);
			return eax_92;
		}
	}
	fn08049D10(ebx);
	word32 esi_85;
	word32 edi_86;
	return fn08049E3F(fp - 0x10, ebx, dwArg04, dwArg08, out esi_85, out edi_86);
}

// 08049E3F: Register (ptr32 void) fn08049E3F(Register Eq_603 ebp, Register (ptr32 Eq_604) esi, Stack Eq_63 dwArg04, Stack Eq_63 dwArg08, Register out ptr32 esiOut, Register out ptr32 ediOut)
void(Eq_603 ebp, Eq_604 * esi, size_t dwArg04, size_t dwArg08, ptr32 & esiOut, ptr32 & ediOut)
{
	*esiOut = esi;
	*ediOut = edi;
	void * eax_18 = realloc(dwArg04, dwArg08);
	if (eax_18 != null)
		return eax_18;
	fn08049D10(esi);
	Eq_1111 ecx_117 = *dwLoc14;
	if (dwArg08 != 0x00)
	{
		if ((uint32) (0x7FFFFFFF /u dwLoc10) < ecx_117)
		{
			fn08049D10(dwLoc10);
			*(fp - 0x3C) = fp - 0x20;
			*(fp - 0x40) = 0x0804B94C;
			int32 * edx_128 = *(fp - 0x30);
			word32 ecx_127 = *(fp - 0x34);
			int32 eax_132 = *edx_128;
			if (ecx_127 != 0x00)
			{
				if (eax_132 < 0x00)
				{
					fn08049D10(dwLoc10);
					*(fp - 88) = fp - 0x3C;
					*(fp - 0x5C) = (struct Eq_604 **) dwLoc10;
					*(fp - 0x60) = 0x0804B94C;
					struct Eq_604 * esi_172 = *(fp - 0x50);
					*(fp - 0x70) = (struct Eq_604 **) esi_172;
					word32 esi_174;
					word32 edi_175;
					struct Eq_604 * eax_176 = fn08049DC5(&globals->t804B94C, fp - 88, esi_172, ebp, dwArg00, out esi_174, out edi_175);
					*(fp - 0x68) = esi_174;
					*(fp - 0x6C) = 0x00;
					*(fp - 0x70) = (struct Eq_604 **) eax_176;
					void * eax_180 = memset(*(fp - 0x70), *(fp - 0x6C), *(fp - 0x68));
					word32 esi_187;
					*esiOut = *(fp - 0x5C);
					return eax_180;
				}
				eax_132 *= 0x02;
			}
			else if (eax_132 == 0x00)
				eax_132 = DPB(eax_132, 0x40, 0);
			*edx_128 = eax_132;
			*(fp - 0x50) = eax_132;
			*(fp - 0x54) = ecx_127;
			word32 esi_143;
			word32 edi_144;
			return fn08049E3F(fp - 0x3C, dwLoc10, dwArg00, dwArg04, out esi_143, out edi_144);
		}
		ecx_117 *= 0x02;
	}
	else if (ecx_117 == 0x00)
	{
		uint32 eax_205 = (uint32) (0x40 /u dwLoc10);
		ecx_117 = eax_205 + (word32) (eax_205 == 0x00);
	}
	*dwLoc14 = (union Eq_1111 *) ecx_117;
	word32 eax_88 = *(fp - 0x18);
	*(fp - 0x34) = ecx_117 *s dwLoc10;
	*(fp - 0x38) = eax_88;
	word32 esi_94;
	word32 edi_95;
	void * eax_96 = fn08049E3F(fp - 0x20, dwLoc10, dwArg00, dwArg04, out esi_94, out edi_95);
	word32 esi_103;
	*esiOut = *(fp - 0x28);
	word32 edi_105;
	*ediOut = *(fp - 0x24);
	return eax_96;
}

// 08049FE0: void fn08049FE0(Stack Eq_63 dwArg04)
void fn08049FE0(size_t dwArg04)
{
	if (dwArg04 != 0x00)
		free(dwArg04);
}

