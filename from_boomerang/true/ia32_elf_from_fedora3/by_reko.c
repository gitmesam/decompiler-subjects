// subject.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

// 08048AC0: void fn08048AC0(Register (ptr Eq_2) edx, Stack int32 dwArg00)
void fn08048AC0( * edx, int32 dwArg00)
{
	__align((char *) fp + 0x04);
	__libc_start_main(&globals->t8048C4A, dwArg00, (char *) fp + 0x04, &globals->t804A008, &globals->t804A05C, edx, fp);
	__hlt();
}

// 08048D64: Register Eq_28 fn08048D64(Stack Eq_28 dwArg00)
Eq_28 fn08048D64(Eq_28 dwArg00)
{
	return dwArg00;
}

// 08048D81: void close_stdout()
void close_stdout()
{
	struct Eq_30 * ebx_16 = fn08048D64(dwLoc14);
	FILE ** edi_158 = ebx_16->ptr2BB4;
	FILE * edx_21 = *edi_158;
	uint32 eax_24 = edx_21->dw0000 >> 0x05 & 0x01;
	struct Eq_51 * ebx_160 = (char *) &ebx_16->ptr2BB4 + 0x0C;
	struct Eq_54 * esp_156 = fp - 44;
	int32 esi_154 = 0x00 - (eax_24 < 0x01);
	if (esi_154 != 0x00)
	{
		word32 ebp_157;
		byte SCZO_161;
		word32 edx_162;
		word32 eax_163;
		byte SZO_164;
		byte C_165;
		byte Z_166;
		byte S_167;
		!__fpending();
		if (eax_163 == 0x00)
			return;
	}
	if (fclose(*edi_158) != 0x00)
		esi_154 = *__errno_location();
	if (esi_154 < 0x00)
		return;
	dcgettext(null, (char *) ebx_160 - 5808, 0x05);
	word32 eax_96 = ebx_160->dw00B8;
	if (eax_96 == 0x00)
	{
		word32 esp_131;
		word32 ebp_132;
		word32 edi_133;
		word32 esi_134;
		word32 ebx_135;
		byte SCZO_136;
		word32 edx_137;
		word32 eax_138;
		byte SZO_139;
		byte C_140;
		byte Z_141;
		byte S_142;
		!error();
	}
	else
	{
		word32 esi_101;
		word32 edi_102;
		word32 eax_103 = fn08049A8B(eax_96, out esi_101, out edi_102);
		esp_156->dw0010 = edi_102;
		esp_156->dw000C = eax_103;
		esp_156->dw0004 = esi_101;
		esp_156->ptr0008 = (char *) ebx_160 - 0x000016A4;
		word32 eax_110 = **(ebx_160 - 0x10);
		esp_156->dw0000 = eax_110;
		word32 esp_112;
		word32 ebp_113;
		word32 edi_114;
		word32 esi_115;
		word32 ebx_116;
		byte SCZO_117;
		word32 edx_118;
		word32 eax_119;
		byte SZO_120;
		byte C_121;
		byte Z_122;
		byte S_123;
		!error();
	}
}

// 08048F36: void fn08048F36(Stack ptr32 dwArg04, Stack byte bArg08, Stack ui32 dwArg0C)
void fn08048F36(ptr32 dwArg04, byte bArg08, ui32 dwArg0C)
{
	ui32 ecx_19 = (word32) bArg08;
	ui32 eax_28 = (word32) ((byte) ecx_19 >> 0x05);
	struct Eq_30 * ebx_16 = fn08048D64(dwLoc14);
	int32 * edi_34 = (eax_28 << 0x02) + 0x04 + dwArg04;
	if (dwArg04 == 0x00)
	{
		int32 * edi_68 = (char *) &ebx_16->ptr2BB4 + 0x002F + (eax_28 << 0x02);
		byte cl_70 = (byte) (ecx_19 & 0x1F);
		int32 edx_72 = *edi_68;
		*edi_68 = edx_72 ^ (dwArg0C & 0x01 ^ edx_72 >> cl_70 & 0x01) << cl_70;
	}
	else
	{
		int32 edx_47 = *edi_34;
		byte cl_49 = (byte) (ecx_19 & 0x1F);
		*edi_34 = edx_47 ^ (dwArg0C & 0x01 ^ edx_47 >> cl_49 & 0x01) << cl_49;
	}
}

// 08048FF6: Register Eq_237 fn08048FF6(Register Eq_237 eax, Register Eq_237 edx, Stack (ptr (arr Eq_657)) dwArg04, Stack (ptr (arr Eq_657)) dwArg08, Stack uint32 dwArg0C, Stack (ptr Eq_242) dwArg10, Register out ptr32 espOut, Register out ptr32 ebpOut)
size_t fn08048FF6(size_t eax, size_t edx, Eq_657 * dwArg04[], Eq_657 * dwArg08[], uint32 dwArg0C, Eq_242 * dwArg10, ptr32 & espOut, ptr32 & ebpOut)
{
}

// 080496C3: Register word32 fn080496C3(Stack Eq_237 dwArg04, Stack Eq_237 dwArg08, Stack (ptr (arr Eq_657)) dwArg0C, Stack (ptr (arr Eq_657)) dwArg10, Stack (ptr Eq_242) dwArg14)
word32 fn080496C3(size_t dwArg04, size_t dwArg08, Eq_657 * dwArg0C[], Eq_657 * dwArg10[], Eq_242 * dwArg14)
{
	struct Eq_30 * ebx_16 = fn08048D64(dwLoc14);
	struct Eq_242 * edi_20 = dwArg14;
	if (dwArg14 == null)
		edi_20 = (struct Eq_242 *) ((char *) &ebx_16->t22BC + 0x0196);
	int32 * eax_25 = __errno_location();
	word32 esp_43;
	ptr32 ebp_44;
	word32 eax_45 = fn08048FF6(dwArg04, dwArg08, dwArg0C, dwArg10, edi_20->dw0000, edi_20, out esp_43, out ebp_44);
	*eax_25 = *(ebp_44 - 0x10);
	return eax_45;
}

// 08049721: Register Eq_28 fn08049721(Register Eq_28 eax, Register Eq_28 ebp, Register Eq_28 esi)
Eq_28 fn08049721(Eq_28 eax, Eq_28 ebp, Eq_28 esi)
{
}

// 080499F0: Register word32 fn080499F0(Stack word32 dwArg04, Stack byte bArg08, Register out ptr32 ediOut)
word32 fn080499F0(word32 dwArg04, byte bArg08, ptr32 & ediOut)
{
	*ediOut = edi;
	fn08048D64(dwLoc10);
	fn08048F36(fp - 0x3C, (byte) (int32) bArg08, 0x01);
	return fn08049721(0x00, fp - 0x04, fp - 0x3C);
}

// 08049A8B: Register word32 fn08049A8B(Stack word32 dwArg04, Register out ptr32 esiOut, Register out ptr32 ediOut)
word32 fn08049A8B(word32 dwArg04, ptr32 & esiOut, ptr32 & ediOut)
{
	*esiOut = esi;
	fn08048D64(dwLoc0C);
	word32 edi_19;
	return fn080499F0(dwArg04, 0x3A, out edi_19);
}

// 08049D10: void fn08049D10(Register Eq_28 esi)
void fn08049D10(Eq_28 esi)
{
	struct Eq_30 * ebx_10 = fn08048D64(dwLoc0C);
	ptr32 ebx_11 = (char *) &ebx_10->ptr1C0F + 0x0024;
	<anonymous> * eax_15 = *ebx_10->ptr1C0F;
	if (eax_15 != null)
	{
		word32 esp_47;
		word32 ebp_48;
		byte SCZO_50;
		word32 eax_51;
		byte SZO_52;
		byte C_53;
		byte Z_54;
		word32 esi_55;
		eax_15();
	}
	dcgettext(null, *(ebx_11 - 0x08), 0x05);
	word32 esp_32;
	word32 ebp_33;
	word32 ebx_34;
	byte SCZO_35;
	word32 eax_36;
	byte SZO_37;
	byte C_38;
	byte Z_39;
	word32 esi_40;
	!error();
	abort();
}

// 08049DC5: Register Eq_28 fn08049DC5(Register Eq_28 ebx, Register Eq_866 ebp, Register Eq_28 esi, Stack Eq_28 dwArg00, Stack Eq_237 dwArg04, Register out ptr32 esiOut, Register out Eq_871 ediOut)
Eq_28 fn08049DC5(Eq_28 ebx, Eq_866 ebp, Eq_28 esi, Eq_28 dwArg00, size_t dwArg04, ptr32 & esiOut, Eq_871 & ediOut)
{
	*esiOut = esi;
	*ediOut = edi;
	fn08048D64(dwLoc0C);
	Eq_28 eax_16 = malloc(dwArg04);
	if (eax_16 != 0x00)
		return eax_16;
	fn08049D10(esi);
	fn08048D64(dwLoc20);
	if ((uint32) (~0x00 /u dwArg00) >= ebp)
	{
		*(fp - 0x28) = (union Eq_28 *) ebx;
		*(fp - 0x24) = ebp *s dwArg00;
		Eq_28 eax_96 = realloc(*(fp - 0x28), *(fp - 0x24));
		if (eax_96 != 0x00)
		{
			word32 esi_105;
			*esiOut = *(fp - 0x18);
			word32 edi_107;
			*ediOut = *(fp - 0x14);
			return eax_96;
		}
	}
	fn08049D10(ebx);
	word32 esi_89;
	word32 edi_90;
	return fn08049E3F(fp - 0x10, ebx, dwArg04, dwArg08, out esi_89, out edi_90);
}

// 08049E3F: Register Eq_28 fn08049E3F(Register Eq_28 ebp, Register Eq_28 esi, Stack Eq_237 dwArg04, Stack Eq_237 dwArg08, Register out ptr32 esiOut, Register out ptr32 ediOut)
Eq_28 fn08049E3F(Eq_28 ebp, Eq_28 esi, size_t dwArg04, size_t dwArg08, ptr32 & esiOut, ptr32 & ediOut)
{
	*esiOut = esi;
	*ediOut = edi;
	fn08048D64(dwLoc0C);
	Eq_28 eax_19 = realloc(dwArg04, dwArg08);
	if (eax_19 != 0x00)
		return eax_19;
	fn08049D10(esi);
	struct Eq_30 * ebx_71 = fn08048D64(dwLoc30);
	Eq_1267 ecx_119 = *dwLoc14;
	if (dwArg08 != 0x00)
	{
		if ((uint32) (0x7FFFFFFF /u dwLoc10) < ecx_119)
		{
			fn08049D10(dwLoc10);
			*(fp - 0x3C) = fp - 0x20;
			*(fp - 0x40) = (char *) ebx_71 + 0x00001ACC;
			struct Eq_30 * ebx_126 = fn08048D64(ebp);
			int32 * edx_130 = *(fp - 0x30);
			word32 ecx_129 = *(fp - 0x34);
			int32 eax_134 = *edx_130;
			if (ecx_129 != 0x00)
			{
				if (eax_134 < 0x00)
				{
					fn08049D10(dwLoc10);
					*(fp - 88) = fp - 0x3C;
					*(fp - 0x5C) = (union Eq_28 *) dwLoc10;
					*(fp - 0x60) = (char *) ebx_126 + 0x00001A61;
					struct Eq_30 * ebx_170 = fn08048D64(ebp);
					Eq_28 esi_174 = *(fp - 0x50);
					*(fp - 0x70) = (union Eq_28 *) esi_174;
					word32 esi_176;
					word32 edi_177;
					Eq_28 eax_178 = fn08049DC5((char *) ebx_170 + 0x00001A1B, fp - 88, esi_174, ebp, dwArg00, out esi_176, out edi_177);
					*(fp - 0x68) = esi_176;
					*(fp - 0x6C) = 0x00;
					*(fp - 0x70) = (union Eq_28 *) eax_178;
					Eq_28 eax_182 = memset(*(fp - 0x70), *(fp - 0x6C), *(fp - 0x68));
					word32 esi_189;
					*esiOut = *(fp - 0x5C);
					return eax_182;
				}
				eax_134 = eax_134 * 0x02;
			}
			else if (eax_134 == 0x00)
				eax_134 = DPB(eax_134, 0x40, 0);
			*edx_130 = eax_134;
			*(fp - 0x50) = eax_134;
			*(fp - 0x54) = ecx_129;
			word32 esi_145;
			word32 edi_146;
			return fn08049E3F(fp - 0x3C, dwLoc10, dwArg00, dwArg04, out esi_145, out edi_146);
		}
		ecx_119 = ecx_119 * 0x02;
	}
	else if (ecx_119 == 0x00)
	{
		uint32 eax_207 = (uint32) (0x40 /u dwLoc10);
		ecx_119 = eax_207 + (word32) (eax_207 == 0x00);
	}
	*dwLoc14 = (union Eq_1267 *) ecx_119;
	word32 eax_90 = *(fp - 0x18);
	*(fp - 0x34) = ecx_119 *s dwLoc10;
	*(fp - 0x38) = eax_90;
	word32 esi_96;
	word32 edi_97;
	Eq_28 eax_98 = fn08049E3F(fp - 0x20, dwLoc10, dwArg00, dwArg04, out esi_96, out edi_97);
	word32 esi_105;
	*esiOut = *(fp - 0x28);
	word32 edi_107;
	*ediOut = *(fp - 0x24);
	return eax_98;
}

// 08049FE0: void fn08049FE0(Stack Eq_237 dwArg04)
void fn08049FE0(size_t dwArg04)
{
	fn08048D64(dwLoc0C);
	if (dwArg04 != 0x00)
		free(dwArg04);
}

