// subject.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

// 00401000: Register word32 fn00401000(Stack uint32 dwArg04, Register out ptr32 ebxOut)
word32 fn00401000(uint32 dwArg04, ptr32 & ebxOut)
{
	if (dwArg04 > ~0x06)
	{
		word32 ebx_58;
		*ebxOut = fn004010A0(&globals->b406030);
		return 0x00;
	}
	else
	{
		switch (dwArg04 + ~0x01)
		{
		case 0x00:
			word32 ebx_16;
			*ebxOut = fn004010A0(&globals->b406060);
			return 0x00;
		case 0x01:
			word32 ebx_23;
			*ebxOut = fn004010A0(&globals->b406058);
			return 0x00;
		case 0x02:
			word32 ebx_30;
			*ebxOut = fn004010A0(&globals->b406050);
			return 0x00;
		case 0x03:
			word32 ebx_37;
			*ebxOut = fn004010A0(&globals->b406048);
			return 0x00;
		case 0x04:
			word32 ebx_44;
			*ebxOut = fn004010A0(&globals->b406040);
			return 0x00;
		case 0x05:
			word32 ebx_51;
			*ebxOut = fn004010A0(&globals->b406038);
			return 0x00;
		}
	}
}

// 004010A0: Register word32 fn004010A0(Stack (ptr32 ci8) dwArg04)
word32 fn004010A0(ci8 * dwArg04)
{
	word32 eax_10 = fn00401230(&globals->t406098);
	fn00401330(dwArg04);
	fn004012D0(eax_10, &globals->t406098);
	return ebx;
}

// 004010E0: Register Eq_70 Win32CrtStartup()
Eq_70 Win32CrtStartup()
{
	ptr32 eax_14 = fs->ptr0000;
	fs->ptr0000 = fp - 0x14;
	Eq_70 eax_29 = GetVersion();
	word32 edx_33 = (word32) SLICE(eax_29, byte, 8);
	globals->dw40892C = edx_33;
	globals->dw408928 = eax_29 & 0xFF;
	globals->dw408924 = ((eax_29 & 0xFF) << 0x08) + edx_33;
	globals->dw408920 = eax_29 >> 0x10;
	if (fn00402B80() == 0x00)
		fn00401200(0x1C);
	fn00402980();
	word32 ebx_54 = fn00402970();
	globals->t409D04 = GetCommandLineA();
	Eq_117 eax_57 = fn00402540(ebx_54);
	globals->t4088F8 = eax_57;
	if (eax_57 == 0x00 || globals->t409D04 == 0x00)
		fn00401F00(ebx_54, ~0x00);
	fn004021A0(fn00402290());
	fn00401ED0();
	globals->t408940 = globals->t40893C;
	word32 ebx_76;
	Eq_70 eax_77 = fn00401000(globals->dw408930, out ebx_76);
	Eq_70 eax_83 = fn00401F00(ebx_76, eax_77);
	fs->ptr0000 = eax_14;
	return eax_83;
}

// 00401200: Register word32 fn00401200(Stack ui32 dwArg04)
word32 fn00401200(ui32 dwArg04)
{
	if (globals->dw408900 != 0x02)
		fn00402D90();
	word32 ecx_9 = fn00402DD0(dwArg04);
	word32 esp_14;
	byte SCZO_15;
	bool Z_16;
	word32 eax_17;
	word32 ecx_18;
	globals->ptr406068();
	return ecx_18;
}

// 00401230: Register word32 fn00401230(Stack (ptr32 Eq_57) dwArg04)
word32 fn00401230(Eq_57 * dwArg04)
{
	if (fn00403060(dwArg04->t0010) == 0x00)
		return 0x00;
	ui32 edi_45;
	if (dwArg04 == &globals->t406098)
		edi_45 = 0x00;
	else
	{
		if (dwArg04 != &globals->t4060B8)
			return 0x00;
		edi_45 = 0x01;
	}
	globals->dw408910 = globals->dw408910 + 0x01;
	if ((dwArg04->dw000C & 0x010C) != 0x00)
		return 0x00;
	if (globals->a408908[edi_45 * 0x04] == 0x00)
	{
		word32 ecx_77;
		Eq_117 eax_78 = fn00402FB0(0x1000, out ecx_77);
		globals->a408908[edi_45 * 0x04] = (word32) eax_78;
		if (eax_78 == 0x00)
			return 0x00;
	}
	word32 eax_60 = globals->a408908[edi_45 * 0x04];
	dwArg04->dw0018 = 0x1000;
	dwArg04->dw0008 = eax_60;
	dwArg04->dw0000 = eax_60;
	ui32 eax_64 = dwArg04->dw000C;
	dwArg04->dw0004 = 0x1000;
	dwArg04->dw000C = eax_64 | 0x1102;
	return 0x01;
}

// 004012D0: void fn004012D0(Stack word32 dwArg04, Stack (ptr32 Eq_67) dwArg08)
void fn004012D0(word32 dwArg04, Eq_67 * dwArg08)
{
	if (dwArg04 == 0x00)
	{
		if ((dwArg08->b000D & 0x10) != 0x00)
			fn004030E0(dwArg08);
	}
	else
	{
		if ((dwArg08->b000D & 0x10) == 0x00)
			return;
		fn004030E0(dwArg08);
		ui32 eax_46 = dwArg08->dw000C;
		dwArg08->dw0018 = 0x00;
		dwArg08->dw000C = DPB(eax_46, SLICE(eax_46, byte, 8) & ~0x11, 8);
		dwArg08->t0000.u0 = 0x00;
		dwArg08->t0008.u0 = 0x00;
	}
}

// 00401330: void fn00401330(Stack (ptr32 ci8) dwArg08)
void fn00401330(ci8 * dwArg08)
{
}

// 00401CC0: void fn00401CC0(Stack Eq_117 dwArg04, Stack (ptr32 Eq_490) dwArg08, Stack (ptr32 ui32) dwArg0C)
void fn00401CC0(Eq_117 dwArg04, Eq_490 * dwArg08, ui32 * dwArg0C)
{
	ui32 eax_16;
	int32 eax_5 = dwArg08->dw0004;
	dwArg08->dw0004 = eax_5 - 0x01;
	if (eax_5 >= 0x01)
	{
		*dwArg08->t0000 = (byte) dwArg04;
		dwArg08->t0000 = (word32) dwArg08->t0000 + 0x01;
		eax_16 = dwArg04 & 0xFF;
	}
	else
		eax_16 = fn00403350(dwArg04, dwArg08);
	if (eax_16 != ~0x00)
		*dwArg0C = *dwArg0C + 0x01;
	else
		*dwArg0C = eax_16;
}

// 00401D10: void fn00401D10(Stack Eq_117 dwArg04, Stack (ptr32 Eq_490) dwArg08, Stack (ptr32 Eq_490) dwArg0C, Stack (ptr32 ui32) dwArg10)
void fn00401D10(Eq_117 dwArg04, Eq_490 * dwArg08, Eq_490 * dwArg0C, ui32 * dwArg10)
{
	int32 ebp_14 = dwArg08 - 0x01;
	if (dwArg08 > null)
	{
		do
		{
			fn00401CC0(dwArg04, dwArg0C, dwArg10);
			if (*dwArg10 == ~0x00)
				return;
			ebp_14 = ebp_68 - 0x01;
			int32 ebp_68 = ebp_14;
		} while (ebp_68 > 0x00);
	}
}

// 00401D50: void fn00401D50(Stack Eq_117 dwArg04, Stack (ptr32 Eq_490) dwArg08, Stack (ptr32 Eq_490) dwArg0C, Stack (ptr32 ui32) dwArg10)
void fn00401D50(Eq_117 dwArg04, Eq_490 * dwArg08, Eq_490 * dwArg0C, ui32 * dwArg10)
{
	int32 ebp_14 = dwArg08 - 0x01;
	if (dwArg08 > null)
	{
		Eq_117 esi_48 = dwArg04;
		do
		{
			fn00401CC0((int32) *esi_48, dwArg0C, dwArg10);
			esi_48 = (word32) esi_48 + 0x01;
			if (*dwArg10 == ~0x00)
				return;
			ebp_14 = ebp_71 - 0x01;
			int32 ebp_71 = ebp_14;
		} while (ebp_71 > 0x00);
	}
}

// 00401D90: Register Eq_2089 fn00401D90(Stack Eq_117 dwArg04, Register out ptr32 ecxOut)
Eq_2089 fn00401D90(Eq_117 dwArg04, ptr32 & ecxOut)
{
	Eq_2090 ecx_5 = *dwArg04;
	*dwArg04 = (word32) ecx_5 + 0x04;
	word32 ecx_6;
	*ecxOut = (word32) ecx_5 + 0x04;
	return *ecx_5;
}

// 00401DB0: Register Eq_2089 fn00401DB0(Stack Eq_117 dwArg04, Register out ptr32 edxOut)
Eq_2089 fn00401DB0(Eq_117 dwArg04, ptr32 & edxOut)
{
	Eq_2090 ecx_5 = *dwArg04;
	*dwArg04 = (word32) ecx_5 + 0x08;
	word32 edx_10;
	*edxOut = (word32) *((word32) ecx_5 + 0x04);
	return *ecx_5;
}

// 00401DD0: Register word32 fn00401DD0(Stack Eq_117 dwArg04)
word32 fn00401DD0(Eq_117 dwArg04)
{
	Eq_2090 ecx_5 = *dwArg04;
	*dwArg04 = (word32) ecx_5 + 0x04;
	return DPB((word32) ecx_5 + 0x04, *ecx_5, 0);
}

// 00401ED0: void fn00401ED0()
void fn00401ED0()
{
	ptr32 esp_1 = fp;
	<anonymous> * eax_3 = globals->ptr408CEC;
	if (eax_3 != null)
	{
		word32 eax_29;
		byte SZO_30;
		bool C_31;
		bool Z_32;
		byte SCZO_33;
		eax_3();
	}
	word32 * esp_11 = esp_1 - 0x04;
	*esp_11 = 0x00406010;
	*(esp_11 - 0x04) = 0x00406008;
	fn00401FF0(dwArg00, dwArg04);
	*esp_11 = 0x00406004;
	*(esp_11 - 0x04) = 0x00406000;
	fn00401FF0(dwArg00, dwArg04);
}

// 00401F00: Register word32 fn00401F00(Register word32 ebx, Stack Eq_70 dwArg04)
word32 fn00401F00(word32 ebx, Eq_70 dwArg04)
{
	return fn00401F40(ebx, dwArg04, 0x00, 0x00);
}

// 00401F40: Register word32 fn00401F40(Register word32 ebx, Stack Eq_70 dwArg04, Stack word32 dwArg08, Stack word32 dwArg0C)
word32 fn00401F40(word32 ebx, Eq_70 dwArg04, word32 dwArg08, word32 dwArg0C)
{
	Eq_70 ebp_100 = dwArg04;
	if (globals->dw40895C == 0x01)
		TerminateProcess(GetCurrentProcess(), dwArg04);
	globals->dw408958 = 0x01;
	globals->b408954 = (byte) dwArg0C;
	ptr32 esp_102 = fp - 0x0C;
	word32 ebx_101 = dwArg0C;
	if (dwArg08 == 0x00)
	{
		word32 * ecx_117 = globals->ptr408CE8;
		if (ecx_117 != null)
		{
			up32 esi_79 = globals->dw408CE4;
			word32 * esi_103 = esi_79 - 0x04;
			if (esi_79 - 0x04 >= ecx_117)
			{
				do
				{
					<anonymous> * eax_90 = *esi_103;
					if (eax_90 != null)
					{
						word32 eax_107;
						byte SCZO_110;
						bool Z_112;
						byte SZO_113;
						bool C_114;
						byte bl_115;
						word32 ecx_116;
						eax_90();
						ecx_117 = globals->ptr408CE8;
					}
					esi_103 = esi_103 - 0x04;
				} while (esi_103 >= ecx_117);
			}
		}
		word32 * esp_72 = esp_102 - 0x04;
		*esp_72 = 0x0040601C;
		*(esp_72 - 0x04) = 0x00406014;
		fn00401FF0(dwArg00, dwArg04);
		esp_102 = esp_72 + 0x01;
	}
	union Eq_70 * esp_40 = esp_102 - 0x04;
	*esp_40 = 0x00406024;
	*(esp_40 - 0x04) = 0x00406020;
	word32 eax_45 = fn00401FF0(dwArg00, dwArg04);
	if (ebx_101 != 0x00)
		return eax_45;
	*esp_40 = (union Eq_70 *) ebp_100;
	globals->dw40895C = 0x01;
	ExitProcess(*esp_40);
}

// 00401FF0: Register (ptr32 code) fn00401FF0(Stack Eq_70 dwArg04, Stack Eq_70 dwArg08)
code * fn00401FF0(Eq_70 dwArg04, Eq_70 dwArg08)
{
	Eq_70 esi_30 = dwArg04;
	Eq_70 edi_11 = dwArg08;
	if (dwArg04 < dwArg08)
	{
		do
		{
			eax = (<anonymous> *) *esi_30;
			if (eax != null)
			{
				word32 esp_45;
				byte SCZO_48;
				bool C_49;
				byte SZO_51;
				bool Z_52;
				eax();
			}
			esi_30 = (word32) esi_30 + 0x04;
		} while (esi_30 < edi_11);
	}
	return eax;
}

// 004021A0: void fn004021A0(Register ui32 ecx)
void fn004021A0(ui32 ecx)
{
	Eq_117 edx_206 = globals->t4088F8;
	byte al_17 = *edx_206;
	ui32 esi_20 = 0x00;
	if (al_17 != 0x00)
	{
		do
		{
			if (al_17 != 0x3D)
				esi_20 = esi_20 + 0x01;
			Eq_117 edi_216 = edx_206;
			ui32 ecx_217 = ecx | ~0x00;
			while (ecx_217 != 0x00)
			{
				edi_216 = (word32) edi_246 + 0x01;
				ecx_217 = ecx_217 - 0x01;
				Eq_117 edi_246 = edi_216;
				if (0x00 != *edi_246)
					break;
			}
			int32 ecx_229 = ~ecx_217;
			ecx = ecx_229 - 0x01;
			al_17 = (byte) ((word32) edx_206 + 0x01 + (ecx_229 - 0x01));
			edx_206 = (word32) edx_206 + 0x01 + (ecx_229 - 0x01);
		} while (al_17 != 0x00);
	}
	struct Eq_133 * ecx_106;
	Eq_117 eax_38 = fn00402FB0(esi_20 * 0x04 + 0x04, out ecx_106);
	globals->t40893C = eax_38;
	Eq_117 esi_118 = eax_38;
	Eq_117 dwLoc04_112 = eax_38;
	if (eax_38 == 0x00)
		ecx_106 = fn00401200(0x09);
	Eq_117 ebp_123 = globals->t4088F8;
	Eq_2353 dl_121 = *ebp_123;
	if (dl_121 != 0x00)
	{
		do
		{
			Eq_117 edi_101 = ebp_123;
			ui32 ecx_102 = ecx_106 | ~0x00;
			while (ecx_102 != 0x00)
			{
				edi_101 = (word32) edi_244 + 0x01;
				ecx_102 = ecx_102 - 0x01;
				Eq_117 edi_244 = edi_101;
				if (0x00 != *edi_244)
					break;
			}
			Eq_117 ecx_105 = ~ecx_102;
			ecx_106 = ecx_105 - 0x01;
			if (dl_121 != 0x3D)
			{
				struct Eq_133 * ecx_129;
				Eq_117 eax_130 = fn00402FB0(ecx_105, out ecx_129);
				*esi_118 = eax_130;
				if (eax_130 == 0x00)
					ecx_129 = fn00401200(0x09);
				Eq_117 edi_140 = ebp_123;
				ui32 ecx_141 = ecx_129 | ~0x00;
				while (ecx_141 != 0x00)
				{
					edi_140 = (word32) edi_140 + 0x01;
					ecx_141 = ecx_141 - 0x01;
					if (0x00 != *edi_140)
						break;
				}
				uint32 ecx_155 = ~ecx_141;
				union Eq_2449 * esi_159 = edi_140 - ecx_155;
				union Eq_2451 * edi_160 = *dwLoc04_112;
				uint32 ecx_161 = ecx_155 >> 0x02;
				while (ecx_161 != 0x00)
				{
					*edi_160 = (union Eq_2451 *) *esi_159;
					esi_159 = (union Eq_2449 *) ((char *) esi_159 + 0x04);
					edi_160 = (union Eq_2451 *) ((char *) edi_160 + 0x04);
					ecx_161 = ecx_161 - 0x01;
				}
				ecx_106 = ecx_155 & 0x03;
				Eq_117 eax_173 = (word32) dwLoc04_112 + 0x04;
				while (ecx_106 != null)
				{
					*edi_160 = (union Eq_2451 *) *esi_159;
					esi_159 = (union Eq_2449 *) ((char *) esi_159 + 0x01);
					edi_160 = (union Eq_2451 *) ((char *) edi_160 + 0x01);
					ecx_106 = ecx_106 - 0x01;
				}
				dwLoc04_112 = eax_173;
				esi_118 = eax_173;
			}
			dl_121 = Mem45[ebp_123 + ecx_105:byte];
			ebp_123 = ebp_123 + ecx_105;
		} while (dl_121 != 0x00);
	}
	fn00403590(ecx_106, globals->t4088F8);
	globals->t4088F8.u0 = 0x00;
	esi_118->u0 = 0x00;
}

// 00402290: Register word32 fn00402290()
word32 fn00402290()
{
	GetModuleFileNameA(null, 0x00408968, 0x0104);
	Eq_117 edi_18 = globals->t409D04;
	globals->dw40894C = 0x00408968;
	if (*edi_18 == 0x00)
		edi_18.u0 = 0x00408968;
	fn00402330(edi_18, 0x00, null, fp - 0x08, fp - 0x04);
	word32 ecx_45;
	Eq_117 eax_46 = fn00402FB0(dwLoc04 + dwLoc08 * 0x04, out ecx_45);
	if (eax_46 == 0x00)
		fn00401200(0x08);
	word32 ecx_66 = fn00402330(edi_18, eax_46, (word32) eax_46 + dwLoc08 * 0x04, fp - 0x08, fp - 0x04);
	globals->t408934 = eax_46;
	globals->dw408930 = dwLoc08 - 0x01;
	return ecx_66;
}

// 00402330: Register word32 fn00402330(Stack Eq_117 dwArg04, Stack Eq_117 dwArg08, Stack (ptr32 byte) dwArg0C, Stack (ptr32 word32) dwArg10, Stack (ptr32 word32) dwArg14)
word32 fn00402330(Eq_117 dwArg04, Eq_117 dwArg08, byte * dwArg0C, word32 * dwArg10, word32 * dwArg14)
{
	*dwArg14 = 0x00;
	*dwArg10 = 0x01;
	Eq_117 ebp_11 = dwArg08;
	byte * esi_118 = dwArg0C;
	struct Eq_2581 * eax_119 = (word32) dwArg04 + 0x01;
	if (dwArg08 != 0x00)
	{
		*dwArg08 = dwArg0C;
		ebp_11 = (word32) dwArg08 + 0x04;
		dwArg08 = (word32) dwArg08 + 0x04;
	}
	dwArg14_370 = dwArg14;
	if (*dwArg04 == 0x22)
	{
		Eq_2608 cl_295 = *((word32) dwArg04 + 0x01);
		struct Eq_2612 * ecx_296 = DPB(ecx, cl_295, 0);
		eax_119 = (word32) dwArg04 + 0x01;
		if (cl_295 != 0x22)
		{
			while (cl_295 != 0x00)
			{
				struct Eq_2630 * ecx_332 = ecx_296 & 0xFF;
				if ((ecx_332->b408A79 & 0x04) != 0x00)
				{
					*dwArg14 = *dwArg14 + 0x01;
					if (esi_118 != null)
					{
						*esi_118 = eax_119->b0000;
						esi_118 = esi_118 + 0x01;
						eax_119 = eax_119 + 0x01;
					}
				}
				*dwArg14 = *dwArg14 + 0x01;
				if (esi_118 != null)
				{
					*esi_118 = eax_119->b0000;
					esi_118 = esi_118 + 0x01;
				}
				cl_295 = eax_119[0x01];
				ecx_296 = (struct Eq_2612 *) DPB(ecx_332, cl_295, 0);
				eax_119 = eax_119 + 0x01;
				if (cl_295 == 0x22)
					break;
			}
		}
		*dwArg14 = *dwArg14 + 0x01;
		if (esi_118 != null)
		{
			*esi_118 = 0x00;
			esi_118 = esi_118 + 0x01;
		}
		if (eax_119->b0000 == 0x22)
			eax_119 = eax_119 + 0x01;
	}
	else
	{
		do
		{
			word32 * dwArg14_370;
			*dwArg14 = *dwArg14 + 0x01;
			if (esi_118 != null)
			{
				*esi_118 = eax_119->b0000;
				esi_118 = esi_118 + 0x01;
			}
			byte cl_383 = eax_119->b0000;
			eax_119 = &eax_119->b0000;
			dwArg14_370 = DPB(dwArg14_370, cl_383, 0);
			if (((dwArg14_370 & 0xFF)->b408A79 & 0x04) != 0x00)
			{
				*dwArg14 = *dwArg14 + 0x01;
				if (esi_118 != null)
				{
					*esi_118 = eax_119->b0000;
					esi_118 = esi_118 + 0x01;
				}
				eax_119 = eax_119 + 0x01;
			}
			if (cl_383 == 0x20)
				break;
			if (cl_383 == 0x00)
				goto l00402409;
		} while (cl_383 != 0x09);
		if (cl_383 == 0x00)
		{
l00402409:
			eax_119 = eax_119 - 0x01;
		}
		else if (esi_118 != null)
			*(esi_118 - 0x01) = 0x00;
	}
	word32 edx_114 = 0x00;
	word32 dwArg14_115 = 0x00;
	while (eax_119->b0000 != 0x00)
	{
		while (true)
		{
			byte cl_91 = eax_119->b0000;
			if (cl_91 != 0x20 && cl_91 != 0x09)
				break;
			eax_119 = eax_119 + 0x01;
		}
		if (eax_119->b0000 == 0x00)
			break;
		if (ebp_11 != 0x00)
		{
			*ebp_11 = esi_118;
			dwArg08 = (word32) ebp_11 + 0x04;
		}
		*dwArg10 = *dwArg10 + 0x01;
		while (true)
		{
			uint32 ecx_122 = 0x00;
			byte cl_123 = 0x00;
			word32 ebp_126 = 0x01;
			if (eax_119->b0000 == 0x5C)
			{
				do
				{
					ecx_122 = ecx_122 + 0x01;
					eax_119 = eax_441 + 0x01;
					cl_123 = (byte) ecx_122;
					struct Eq_2581 * eax_441 = eax_119;
				} while (eax_441[0x01] == 0x5C);
			}
			if (eax_119->b0000 == 0x22)
			{
				if ((cl_123 & 0x01) == 0x00)
				{
					if (edx_114 != 0x00 && eax_119[0x01] == 0x22)
						eax_119 = eax_119 + 0x01;
					else
						ebp_126 = 0x00;
					edx_114 = (word32) (dwArg14_115 == 0x00);
					dwArg14_115 = edx_114;
				}
				ecx_122 = ecx_122 >> 0x01;
			}
			word32 ecx_141 = ecx_122 - 0x01;
			if (ecx_122 != 0x00)
			{
				ecx_141 = ecx_141 + 0x01;
				do
				{
					if (esi_118 != null)
					{
						*esi_118 = 0x5C;
						esi_118 = esi_118 + 0x01;
					}
					*dwArg14 = *dwArg14 + 0x01;
					ecx_141 = ecx_141 - 0x01;
				} while (ecx_141 != 0x00);
			}
			byte cl_149 = eax_119->b0000;
			ui32 ecx_150 = DPB(ecx_141, cl_149, 0);
			if (cl_149 == 0x00 || edx_114 == 0x00 && (cl_149 == 0x20 || cl_149 == 0x09))
				break;
			if (ebp_126 != 0x00)
			{
				if (esi_118 != null)
				{
					if (((ecx_150 & 0xFF)->b408A79 & 0x04) != 0x00)
					{
						*esi_118 = cl_149;
						*dwArg14 = *dwArg14 + 0x01;
						esi_118 = esi_118 + 0x01;
						eax_119 = eax_119 + 0x01;
					}
					*esi_118 = eax_119->b0000;
					*dwArg14 = *dwArg14 + 0x01;
					esi_118 = esi_118 + 0x01;
					eax_119 = eax_119 + 0x01;
					continue;
				}
				if (((ecx_150 & 0xFF)->b408A79 & 0x04) != 0x00)
				{
					*dwArg14 = *dwArg14 + 0x01;
					eax_119 = eax_119 + 0x01;
				}
				*dwArg14 = *dwArg14 + 0x01;
			}
			eax_119 = eax_119 + 0x01;
		}
		if (esi_118 != null)
		{
			*esi_118 = 0x00;
			esi_118 = esi_118 + 0x01;
		}
		*dwArg14 = *dwArg14 + 0x01;
		ebp_11 = dwArg08;
	}
	if (ebp_11 != 0x00)
		*ebp_11 = 0x00;
	word32 ecx_80 = *dwArg10;
	*dwArg10 = ecx_80 + 0x01;
	return ecx_80 + 0x01;
}

// 00402540: Register Eq_117 fn00402540(Register word32 ebx)
Eq_117 fn00402540(word32 ebx)
{
	word32 eax_3 = globals->dw408A70;
	Eq_2998 esi_14 = 0x00;
	Eq_3000 ebx_15 = 0x00;
	ptr32 esp_16 = fp - 0x10;
	if (eax_3 == 0x00)
	{
		Eq_2998 eax_315 = GetEnvironmentStringsW();
		esi_14 = eax_315;
		if (eax_315 != 0x00)
			eax_3 = 0x01;
		else
		{
			Eq_3000 eax_327 = GetEnvironmentStrings();
			ebx_15 = eax_327;
			if (eax_327 == 0x00)
				return 0x00;
			eax_3 = 0x02;
		}
		globals->dw408A70 = eax_3;
	}
	if (eax_3 != 0x01)
	{
		if (eax_3 != 0x02)
			return 0x00;
		if (ebx_15 == 0x00)
		{
			Eq_3000 eax_300 = GetEnvironmentStrings();
			ebx_15 = eax_300;
			if (eax_300 == 0x00)
				return 0x00;
		}
		Eq_3000 eax_207 = ebx_15;
		if (*ebx_15 != 0x00)
		{
			do
			{
				do
				{
					eax_207 = (word32) eax_334 + 0x01;
					Eq_3000 eax_334 = eax_207;
				} while (*((word32) eax_334 + 0x01) != 0x00);
				eax_207 = eax_207 + 0x01;
			} while (*((word32) eax_207 + 0x01) != 0x00);
		}
		Eq_3119 eax_213 = eax_207 - ebx_15;
		union Eq_3000 * esp_218 = esp_16 - 0x04;
		Mem219[esp_218 + 0x00:word32] = eax_213 + 0x01;
		word32 ecx_221;
		Eq_117 eax_222 = fn00402FB0(dwArg00, out ecx_221);
		if (eax_222 != 0x00)
		{
			Eq_3000 esi_244 = ebx_15;
			Eq_117 edi_246 = eax_222;
			word32 ecx_247 = eax_213 + 0x01 >>u 0x02;
			while (ecx_247 != 0x00)
			{
				*edi_246 = *esi_244;
				esi_244 = esi_244 + 0x04;
				edi_246 = (word32) edi_246 + 0x04;
				ecx_247 = ecx_247 - 0x01;
			}
			*esp_218 = (union Eq_3000 *) ebx_15;
			word32 ecx_263 = eax_213 + 0x01 & 0x03;
			while (ecx_263 != 0x00)
			{
				*edi_246 = *esi_244;
				esi_244 = esi_244 + 0x01;
				edi_246 = (word32) edi_246 + 0x01;
				ecx_263 = ecx_263 - 0x01;
			}
			FreeEnvironmentStringsA(*esp_218);
			return eax_222;
		}
		else
		{
			*esp_218 = (union Eq_3000 *) ebx_15;
			FreeEnvironmentStringsA(*esp_218);
			return 0x00;
		}
	}
	else
	{
		if (esi_14 == 0x00)
		{
			Eq_2998 eax_189 = GetEnvironmentStringsW();
			esi_14 = eax_189;
			if (eax_189 == 0x00)
				return 0x00;
		}
		Eq_2998 eax_182 = esi_14;
		if (*esi_14 != 0x00)
		{
			do
			{
				do
					eax_182 = eax_182 + 0x02;
				while (*eax_182 != 0x00);
				eax_182 = eax_182 + 0x02;
			} while (Mem0[eax_182 + 0x02:word16] != 0x00);
		}
		int32 eax_89 = (eax_182 - esi_14 >> 0x01) + 0x01;
		Eq_117 eax_105 = WideCharToMultiByte(0x00, 0x00, esi_14, eax_89, 0x00, 0x00, null, null);
		if (eax_105 != 0x00)
		{
			struct Eq_133 * ecx_132;
			Eq_117 eax_133 = fn00402FB0(eax_105, out ecx_132);
			Eq_117 ebx_134 = eax_133;
			if (eax_133 != 0x00)
			{
				if (WideCharToMultiByte(0x00, 0x00, esi_14, eax_89, eax_133, eax_105, null, null) == 0x00)
				{
					fn00403590(ecx_132, eax_133);
					ebx_134.u0 = 0x00;
				}
				FreeEnvironmentStringsW(esi_14);
				return ebx_134;
			}
		}
		FreeEnvironmentStringsW(esi_14);
		return 0x00;
	}
}

// 004026A0: void fn004026A0(Stack Eq_70 dwArg04)
void fn004026A0(Eq_70 dwArg04)
{
	Eq_70 eax_20 = fn00402890(dwArg04);
	if (eax_20 == globals->t408B7C)
		return;
	if (eax_20 != 0x00)
	{
		ui32 edx_82 = 0x00;
		struct Eq_3223 * eax_86 = globals->a406388;
		do
		{
			if (eax_86->dw0000 == eax_20)
			{
				ui32 ecx_253 = 0x40;
				struct Eq_3230 * edi_259 = globals->a408A78;
				ui32 ebx_260 = edx_82 * 0x03;
				while (ecx_253 != 0x00)
				{
					edi_259->b0000 = (byte) 0x00;
					edi_259 = edi_259 + 0x01;
					ecx_253 = ecx_253 - 0x01;
				}
				edi_259->b0000 = 0x00;
				byte * edi_271 = globals->a406380;
				struct Eq_3286 * ebp_275 = (ebx_260 << 0x04) + 0x00406398;
				do
				{
					struct Eq_3286 * esi_286 = ebp_275;
					if (ebp_275->b0000 != 0x00)
					{
						do
						{
							byte cl_337 = esi_370->b0001;
							ecx_253 = DPB(ecx_253, cl_337, 0);
							if (cl_337 == 0x00)
								break;
							ecx_253 = ecx_253 & 0xFF;
							struct Eq_3401 * eax_346 = (word32) esi_370->b0000;
							if (eax_346 <= (ecx_253 & 0xFF))
							{
								byte dl_359 = *edi_271;
								do
								{
									eax_346[4229753] = (struct Eq_3401) (eax_346[4229753] | dl_359);
									eax_346 = eax_346 + 0x01;
								} while (eax_346 <= (ecx_253 & 0xFF));
							}
							esi_286 = &esi_370->b0002;
							struct Eq_3286 * esi_370 = esi_286;
						} while (esi_370->b0002 != 0x00);
					}
					edi_271 = edi_271 + 0x01;
					ebp_275 = ebp_275 + 0x01;
				} while (edi_271 < (byte *) 4290747524);
				globals->t408B7C = eax_20;
				word32 eax_308 = fn004028E0(eax_20);
				word32 ecx_309 = globals->a40638C[ebx_260];
				word32 edx_310 = globals->a406390[ebx_260];
				globals->dw408B80 = eax_308;
				globals->dw408B88 = ecx_309;
				word32 eax_315 = globals->a406394[ebx_260];
				globals->dw408B8C = edx_310;
				globals->dw408B90 = eax_315;
				return;
			}
			eax_86 = eax_86 + 0x01;
			edx_82 = edx_82 + 0x01;
		} while (eax_86 < &globals->t406478);
		if (GetCPInfo(eax_20, fp - 0x14) != 0x01)
		{
			if (globals->dw408B94 == 0x00)
				return;
			fn00402940();
		}
		else
		{
			ui32 ecx_111 = 0x40;
			struct Eq_3261 * edi_117 = globals->a408A78;
			while (ecx_111 != 0x00)
			{
				edi_117->b0000 = (byte) 0x00;
				edi_117 = edi_117 + 0x01;
				ecx_111 = ecx_111 - 0x01;
			}
			edi_117->b0000 = 0x00;
			if (dwLoc14 > 0x01)
			{
				if (bLoc0E != 0x00)
				{
					byte * edx_187 = fp - 0x0D + 0x01;
					do
					{
						byte cl_197 = *edx_369;
						ui32 ecx_198 = DPB(ecx_111, cl_197, 0);
						if (cl_197 == 0x00)
							break;
						ecx_111 = ecx_198 & 0xFF;
						struct Eq_3320 * eax_206 = (word32) *(edx_369 - 0x01);
						if (eax_206 <= (ecx_198 & 0xFF))
						{
							do
							{
								eax_206[4229753] = (struct Eq_3320) (eax_206[4229753] | 0x04);
								eax_206 = eax_206 + 0x01;
							} while (eax_206 <= (ecx_198 & 0xFF));
						}
						edx_187 = edx_369 + 0x02;
						byte * edx_369 = edx_187;
					} while (*edx_369 != 0x00);
				}
				struct Eq_3310 * eax_170 = (struct Eq_3310 *) 0x01;
				do
				{
					eax_170[4229753] = (struct Eq_3310) (eax_170[4229753] | 0x08);
					eax_170 = eax_170 + 0x01;
				} while (eax_170 < (struct Eq_3310 *) 0xFF);
				globals->t408B7C = eax_20;
				globals->dw408B80 = fn004028E0(eax_20);
			}
			else
			{
				globals->t408B7C.u0 = 0x00;
				globals->dw408B80 = 0x00;
			}
			globals->dw408B88 = 0x00;
			globals->dw408B8C = 0x00;
			globals->dw408B90 = 0x00;
		}
	}
	else
		fn00402940();
}

// 00402890: Register Eq_70 fn00402890(Stack Eq_70 dwArg04)
Eq_70 fn00402890(Eq_70 dwArg04)
{
	globals->dw408B94 = 0x00;
	Eq_70 eax_18 = dwArg04;
	if (dwArg04 != ~0x01)
	{
		if (dwArg04 != ~0x02)
		{
			if (dwArg04 == ~0x03)
			{
				eax_18 = globals->t408BB8;
				globals->dw408B94 = 0x01;
			}
			return eax_18;
		}
		else
		{
			globals->dw408B94 = 0x01;
			return GetACP();
		}
	}
	else
	{
		globals->dw408B94 = 0x01;
		return GetOEMCP();
	}
}

// 004028E0: Register word32 fn004028E0(Stack Eq_70 dwArg04)
word32 fn004028E0(Eq_70 dwArg04)
{
	if (dwArg04 > ~0x03B5)
		return 0x00;
	switch ((word32) dwArg04 - 0x03A4)
	{
	case 0x00:
		return 0x0411;
	case 0x01:
	case 0x02:
	case 0x03:
	case 0x05:
	case 0x06:
	case 0x07:
	case 0x08:
	case 0x09:
	case 0x0A:
	case 11:
	case 0x0C:
	case 0x0D:
	case 0x0E:
	case 0x0F:
	case 0x10:
		return 0x00;
	case 0x04:
		return 0x0804;
	case 0x11:
		return 0x0412;
	case 0x12:
		return 0x0404;
	}
}

// 00402940: void fn00402940()
void fn00402940()
{
	word32 ecx_12 = 0x40;
	struct Eq_3506 * edi_10 = globals->a408A78;
	while (ecx_12 != 0x00)
	{
		edi_10->b0000 = (byte) 0x00;
		edi_10 = edi_10 + 0x01;
		ecx_12 = ecx_12 - 0x01;
	}
	edi_10->b0000 = 0x00;
	globals->t408B7C.u0 = 0x00;
	globals->dw408B80 = 0x00;
	globals->dw408B88 = 0x00;
	globals->dw408B8C = 0x00;
	globals->dw408B90 = 0x00;
}

// 00402970: Register word32 fn00402970()
word32 fn00402970()
{
	fn004026A0(~0x02);
	return ebx;
}

// 00402980: void fn00402980()
void fn00402980()
{
	word32 ecx_18;
	Eq_117 eax_19 = fn00402FB0(0x0100, out ecx_18);
	Eq_117 esi_20 = eax_19;
	if (eax_19 == 0x00)
		fn00401200(0x1B);
	globals->t408BE0 = eax_19;
	globals->t408CE0.u0 = 0x20;
	if (eax_19 < (word32) eax_19 + 0x0100)
	{
		do
		{
			*((word32) esi_20 + 0x04) = 0x00;
			*esi_20 = ~0x00;
			*((word32) esi_20 + 0x05) = 0x0A;
			esi_20 = (word32) esi_20 + 0x08;
		} while (esi_20 < (word32) globals->t408BE0 + 0x0100);
	}
	GetStartupInfoA(fp - 0x44);
	if (wLoc12 != 0x00 && dwLoc10 != null)
	{
		Eq_70 ecx_120 = *dwLoc10;
		byte * edi_121 = (char *) dwLoc10 + 0x04;
		Eq_70 dwLoc48_124 = ecx_120;
		word32 ebp_125 = dwLoc10 + 0x04 + ecx_120;
		if (ecx_120 >= 0x0800)
			dwLoc48_124.u0 = 0x0800;
		if (globals->t408CE0 < dwLoc48_124)
		{
			up32 * esi_204 = globals->a408BE4;
			do
			{
				word32 ecx_211;
				Eq_117 eax_212 = fn00402FB0(0x0100, out ecx_211);
				if (eax_212 == 0x00)
				{
					dwLoc48_124 = globals->t408CE0;
					break;
				}
				Eq_70 ecx_218 = globals->t408CE0;
				*esi_204 = (up32) eax_212;
				globals->t408CE0 = (word32) ecx_218 + 0x0020;
				if (eax_212 < (word32) eax_212 + 0x0100)
				{
					do
					{
						*((word32) eax_212 + 0x04) = 0x00;
						*eax_212 = ~0x00;
						*((word32) eax_212 + 0x05) = 0x0A;
						eax_212 = (word32) eax_212 + 0x08;
					} while (eax_212 < *esi_204 + 0x0100);
				}
				esi_204 = esi_204 + 0x01;
			} while (globals->t408CE0 < dwLoc48_124);
		}
		Eq_70 esi_141 = 0x00;
		if (dwLoc48_124 > 0x00)
		{
			do
			{
				Eq_2213 ecx_155 = *ebp_125;
				if (ecx_155 != ~0x00)
				{
					byte al_174 = *edi_121;
					if ((al_174 & 0x01) != 0x00 && ((al_174 & 0x08) != 0x00 || GetFileType(ecx_155) != 0x00))
					{
						ui32 eax_188 = esi_141 & 0x1F;
						Eq_6525 ecx_191[] = (&(&globals->t408BE0)[esi_141 >> 0x05])[0x00].dw0000;
						ecx_191[eax_188].dw0000 = *ebp_125;
						*((word32) &(&(ecx_191 + eax_188)->dw0000)[0x00].dw0000 + 0x04) = (Eq_6525 (*)[]) *edi_121;
					}
				}
				esi_141 = (word32) esi_141 + 0x01;
				edi_121 = edi_121 + 0x01;
				ebp_125 = ebp_125 + 0x01;
			} while (esi_141 < dwLoc48_124);
		}
	}
	int32 ebx_62 = 0x00;
	do
	{
		Eq_117 edx_70 = globals->t408BE0;
		struct Eq_3613 * esi_72 = (word32) edx_70 + ebx_62 * 0x08;
		if (*((word32) edx_70 + ebx_62 * 0x08) == ~0x00)
			esi_72->b0004 = 0x81;
		esi_72->b0004 = esi_72->b0004 | 0x80;
		ebx_62 = ebx_62 + 0x01;
	} while (ebx_62 < 0x03);
	SetHandleCount(globals->t408CE0);
}

// 00402B80: Register Eq_2213 fn00402B80()
Eq_2213 fn00402B80()
{
	Eq_2213 eax_8 = HeapCreate(0x01, 0x1000, 0x00);
	globals->t408BD4 = eax_8;
	if (eax_8 == 0x00)
		return eax_8;
	if (fn004035E0() != 0x00)
		return 0x01;
	HeapDestroy(globals->t408BD4);
	return 0x00;
}

// 00402D90: void fn00402D90()
void fn00402D90()
{
	word32 eax_3 = globals->dw408900;
	if (eax_3 == 0x01 || eax_3 == 0x00 && globals->dw40606C == 0x01)
	{
		word32 ecx_17 = fn00402DD0(252);
		<anonymous> * eax_18 = globals->ptr408B98;
		ptr32 esp_19 = fp;
		if (eax_18 != null)
		{
			word32 eax_35;
			byte SCZO_36;
			bool Z_37;
			byte SZO_38;
			bool C_39;
			word32 ecx_40;
			eax_18();
		}
		*(esp_19 - 0x04) = 0xFF;
		fn00402DD0(dwArg00);
	}
}

// 00402DD0: Register ui32 fn00402DD0(Stack ui32 dwArg04)
ui32 fn00402DD0(ui32 dwArg04)
{
	ui32 ecx_117 = dwArg04;
	struct Eq_3826 * eax_23 = globals->a406498;
	ui32 ebp_19 = 0x00;
	while (dwArg04 != eax_23->dw0000)
	{
		eax_23 = eax_23 + 0x01;
		ebp_19 = ebp_19 + 0x01;
		if (eax_23 >= &globals->ptr406528)
			break;
	}
	if (dwArg04 != (globals->a406498)[ebp_19])
		return ecx_117;
	word32 eax_83 = globals->dw408900;
	if (eax_83 != 0x01 && (eax_83 != 0x00 || globals->dw40606C != 0x01))
	{
		if (dwArg04 == 252)
			return ecx_117;
		if (GetModuleFileNameA(null, fp - 0x0104, 0x0104) == 0x00)
		{
			ecx_117 = 0x05;
			struct Eq_3883 * esi_433 = globals->a40535E;
			struct Eq_3885 * edi_434 = fp - 0x0104 + 0x02;
			while (ecx_117 != 0x00)
			{
				edi_434->w0000 = esi_433->w0000;
				esi_433 = esi_433 + 0x01;
				edi_434 = edi_434 + 0x01;
				ecx_117 = ecx_117 - 0x01;
			}
			edi_434->w0000 = esi_433->w0000;
			edi_434->w0000 = esi_433->w0000;
		}
		byte * edi_160 = fp - 0x0104;
		ui32 ecx_161 = ecx_117 | ~0x00;
		struct Eq_3879 * ebx_166 = fp - 0x0104;
		while (ecx_161 != 0x00)
		{
			edi_160 = edi_459 + 0x01;
			ecx_161 = ecx_161 - 0x01;
			byte * edi_459 = edi_160;
			if (0x00 != *edi_459)
				break;
		}
		uint32 ecx_174 = ~ecx_161;
		if (ecx_174 > 0x3C)
		{
			byte * edi_398 = fp - 0x0104;
			ui32 ecx_399 = ecx_174 | ~0x00;
			while (ecx_399 != 0x00)
			{
				edi_398 = edi_466 + 0x01;
				ecx_399 = ecx_399 - 0x01;
				byte * edi_466 = edi_398;
				if (0x00 != *edi_466)
					break;
			}
			ebx_166 = ~ecx_399 - 0x01 + (fp - 0x013F);
			fn00403D90(ebx_166, &globals->b405358, 0x03);
		}
		ui32 ecx_184 = 0x06;
		struct Eq_3934 * esi_185 = globals->a40533C;
		struct Eq_3936 * edi_186 = fp - 0x01A4;
		while (ecx_184 != 0x00)
		{
			edi_186->w0000 = esi_185->w0000;
			esi_185 = esi_185 + 0x01;
			edi_186 = edi_186 + 0x01;
			ecx_184 = ecx_184 - 0x01;
		}
		edi_186->w0000 = esi_185->w0000;
		ui32 ecx_202 = ecx_184 | ~0x00;
		struct Eq_3879 * edi_205 = ebx_166;
		while (ecx_202 != 0x00)
		{
			edi_205 = edi_205 + 0x01;
			ecx_202 = ecx_202 - 0x01;
			if (0x00 != edi_205->t0000)
				break;
		}
		struct Eq_4016 * ecx_214 = ~ecx_202;
		struct Eq_4018 * esi_218 = edi_205 - ecx_214;
		ui32 ecx_219 = ecx_214 | ~0x00;
		Eq_4023 edi_222 = fp - 0x01A4;
		while (ecx_219 != 0x00)
		{
			edi_222 = edi_222 + 0x01;
			ecx_219 = ecx_219 - 0x01;
			if (0x00 != *edi_222)
				break;
		}
		Eq_4037 edi_230 = edi_222 - 0x01;
		uint32 ecx_231 = ecx_214 >> 0x02;
		while (ecx_231 != 0x00)
		{
			*edi_230 = esi_218->t0000;
			esi_218 = esi_218 + 0x04;
			edi_230 = edi_230 + 0x04;
			ecx_231 = ecx_231 - 0x01;
		}
		ui32 ecx_243 = ecx_214 & 0x03;
		while (ecx_243 != 0x00)
		{
			*edi_230 = esi_218->t0000;
			esi_218 = esi_218 + 0x01;
			edi_230 = edi_230 + 0x01;
			ecx_243 = ecx_243 - 0x01;
		}
		byte * edi_256 = &globals->b405338;
		ui32 ecx_257 = ecx_243 | ~0x00;
		while (ecx_257 != 0x00)
		{
			edi_256 = edi_256 + 0x01;
			ecx_257 = ecx_257 - 0x01;
			if (0x00 != *edi_256)
				break;
		}
		uint32 ecx_268 = ~ecx_257;
		union Eq_4119 * esi_272 = edi_256 - ecx_268;
		Eq_4121 edi_274 = fp - 0x01A4;
		ui32 ecx_275 = ecx_268 | ~0x00;
		while (ecx_275 != 0x00)
		{
			edi_274 = edi_274 + 0x01;
			ecx_275 = ecx_275 - 0x01;
			if (0x00 != *edi_274)
				break;
		}
		Eq_4138 edi_285 = edi_274 - 0x01;
		uint32 ecx_286 = ecx_268 >> 0x02;
		while (ecx_286 != 0x00)
		{
			*edi_285 = *esi_272;
			esi_272 = (union Eq_4119 *) ((char *) esi_272 + 0x04);
			edi_285 = edi_285 + 0x04;
			ecx_286 = ecx_286 - 0x01;
		}
		ui32 ecx_298 = ecx_268 & 0x03;
		while (ecx_298 != 0x00)
		{
			*edi_285 = *esi_272;
			esi_272 = (union Eq_4119 *) ((char *) esi_272 + 0x01);
			edi_285 = edi_285 + 0x01;
			ecx_298 = ecx_298 - 0x01;
		}
		byte * edi_309 = globals->a40649C[ebp_19];
		ui32 ecx_310 = ecx_298 | ~0x00;
		while (ecx_310 != 0x00)
		{
			edi_309 = edi_309 + 0x01;
			ecx_310 = ecx_310 - 0x01;
			if (0x00 != *edi_309)
				break;
		}
		uint32 ecx_321 = ~ecx_310;
		union Eq_4196 * esi_323 = edi_309 - ecx_321;
		Eq_4198 edi_325 = fp - 0x01A4;
		ui32 ecx_326 = ecx_321 | ~0x00;
		while (ecx_326 != 0x00)
		{
			edi_325 = edi_325 + 0x01;
			ecx_326 = ecx_326 - 0x01;
			if (0x00 != *edi_325)
				break;
		}
		Eq_4215 edi_336 = edi_325 - 0x01;
		uint32 ecx_337 = ecx_321 >> 0x02;
		while (ecx_337 != 0x00)
		{
			*edi_336 = *esi_323;
			esi_323 = (union Eq_4196 *) ((char *) esi_323 + 0x04);
			edi_336 = edi_336 + 0x04;
			ecx_337 = ecx_337 - 0x01;
		}
		ui32 ecx_349 = ecx_321 & 0x03;
		while (ecx_349 != 0x00)
		{
			*edi_336 = *esi_323;
			esi_323 = (union Eq_4196 *) ((char *) esi_323 + 0x01);
			edi_336 = edi_336 + 0x01;
			ecx_349 = ecx_349 - 0x01;
		}
		return fn00403D00();
	}
	Eq_2213 esi_137;
	Eq_117 eax_88 = globals->t408BE0;
	if (eax_88 != 0x00)
	{
		esi_137 = *((word32) eax_88 + 0x0010);
		if (esi_137 != ~0x00)
		{
l00402F78:
			Eq_117 edx_96 = globals->a40649C[ebp_19];
			Eq_117 edi_102 = edx_96;
			ui32 ecx_103 = fp - 424 | ~0x00;
			while (ecx_103 != 0x00)
			{
				edi_102 = (word32) edi_458 + 0x01;
				ecx_103 = ecx_103 - 0x01;
				Eq_117 edi_458 = edi_102;
				if (0x00 != *edi_458)
					break;
			}
			ui32 ecx_116 = ~ecx_103;
			WriteFile(esi_137, edx_96, ecx_116 - 0x01, fp - (struct Eq_6764 *) 424, null);
			ecx_117 = ecx_116 - 0x01;
			return ecx_117;
		}
	}
	esi_137 = GetStdHandle(~0x0B);
	goto l00402F78;
}

// 00402FB0: Register word32 fn00402FB0(Stack Eq_117 dwArg04, Register out ptr32 ecxOut)
word32 fn00402FB0(Eq_117 dwArg04, ptr32 & ecxOut)
{
	word32 ecx_10;
	return fn00402FD0(dwArg04, globals->dw408BCC, out ecx_10);
}

// 00402FD0: Register word32 fn00402FD0(Stack Eq_117 dwArg04, Stack word32 dwArg08, Register out ptr32 ecxOut)
word32 fn00402FD0(Eq_117 dwArg04, word32 dwArg08, ptr32 & ecxOut)
{
	*ecxOut = ecx;
	word32 eax_20;
	Eq_117 esi_42 = dwArg04;
	if (dwArg04 <= ~0x1F)
	{
		if (dwArg04 == 0x00)
			esi_42.u0 = 0x01;
		do
		{
			if (esi_42 <= ~0x1F)
			{
				word32 ecx_76;
				eax_20 = fn00403020(esi_42, out ecx_76);
			}
			else
				eax_20 = 0x00;
			if (eax_20 != 0x00 || dwArg08 == 0x00)
				return eax_20;
			word32 ecx_68;
		} while (fn00403E90(esi_42, out ecx_68) != 0x00);
	}
	eax_20 = 0x00;
	return eax_20;
}

// 00403020: Register Eq_117 fn00403020(Stack Eq_117 dwArg04, Register out ptr32 ecxOut)
Eq_117 fn00403020(Eq_117 dwArg04, ptr32 & ecxOut)
{
	*ecxOut = ecx;
	Eq_117 eax_26;
	Eq_117 esi_10 = (word32) dwArg04 + 0x0F & ~0x0F;
	if (esi_10 <= globals->t408774)
	{
		word32 ecx_49;
		eax_26 = fn00403940(esi_10 >> 0x04, out ecx_49);
		if (eax_26 != 0x00)
			return eax_26;
	}
	eax_26 = HeapAlloc(globals->t408BD4, 0x00, esi_10);
	return eax_26;
}

// 00403060: Register ui32 fn00403060(Stack Eq_70 dwArg04)
ui32 fn00403060(Eq_70 dwArg04)
{
	if (dwArg04 < globals->t408CE0)
		return DPB(dwArg04 & 0x1F, (&globals->t408BE0)[dwArg04 >> 0x05]->a0004[dwArg04 & 0x1F].b0000, 0) & 0x40;
	return 0x00;
}

// 004030E0: void fn004030E0(Stack (ptr32 Eq_67) dwArg04)
void fn004030E0(Eq_67 * dwArg04)
{
	ui32 eax_15 = dwArg04->dw000C;
	if ((byte) (eax_15 & 0x03) == 0x02 && (eax_15 & 0x0108) != 0x00)
	{
		Eq_117 eax_65 = dwArg04->t0008;
		Eq_70 edi_68 = dwArg04->t0000 - eax_65;
		if (edi_68 > 0x00)
		{
			Eq_70 eax_78 = fn00403F10(dwArg04->t0010, eax_65, edi_68);
			ui32 eax_82 = dwArg04->dw000C;
			byte al_83 = (byte) eax_82;
			if (eax_78 == edi_68)
			{
				if ((al_83 & 0x80) != 0x00)
				{
					dwArg04->dw0004 = 0x00;
					dwArg04->dw000C = DPB(eax_82, al_83 & ~0x02, 0);
					dwArg04->t0000 = dwArg04->t0008;
					return;
				}
			}
			else
				dwArg04->dw000C = DPB(eax_82, al_83 | 0x20, 0);
		}
	}
	Eq_117 eax_52 = dwArg04->t0008;
	dwArg04->dw0004 = 0x00;
	dwArg04->t0000 = eax_52;
}

// 004031E0: Register Eq_117 fn004031E0(Stack Eq_117 dwArg04, Stack cup16 wArg08)
Eq_117 fn004031E0(Eq_117 dwArg04, cup16 wArg08)
{
	Eq_117 eax_117 = dwArg04;
	if (dwArg04 == 0x00)
		return dwArg04;
	if (globals->dw408BA8 == 0x00)
	{
		Eq_2090 cl_91 = (byte) wArg08;
		if (wArg08 <= 0xFF)
		{
			*dwArg04 = cl_91;
			return 0x01;
		}
	}
	else
	{
		eax_117 = WideCharToMultiByte(globals->t408BB8, 0x0220, fp + 0x08, 0x01, dwArg04, globals->t408780, null, fp + 0x04);
		if (eax_117 != 0x00 && 0x00 == 0x00)
			return eax_117;
	}
	globals->ptr408914 = (struct Eq_4471 *) 0x2A;
	eax_117 = eax_117 | ~0x00;
	return eax_117;
}

// 00403260: Register uint32 fn00403260(Stack Eq_117 dwArg04, Stack (ptr32 Eq_490) dwArg08, Stack Eq_117 dwArg0C, Stack (ptr32 ui32) dwArg10, Register out ptr32 edxOut)
uint32 fn00403260(Eq_117 dwArg04, Eq_490 * dwArg08, Eq_117 dwArg0C, ui32 * dwArg10, ptr32 & edxOut)
{
	uint32 eax_21;
	if (dwArg10 == null)
	{
		uint64 edx_eax_35 = (uint64) (uint32) dwArg08;
		eax_21 = (uint32) (SEQ((uint32) (edx_eax_35 % dwArg0C), dwArg04) /u dwArg0C);
		word32 edx_46;
		*edxOut = (uint32) (edx_eax_35 /u dwArg0C);
	}
	else
	{
		ui32 * ecx_49 = dwArg10;
		Eq_117 ebx_50 = dwArg0C;
		struct Eq_490 * edx_51 = dwArg08;
		Eq_117 eax_52 = dwArg04;
		do
		{
			ui32 * ecx_58 = ecx_49 >> 0x01;
			edx_51 = edx_51 >> 0x01;
			ebx_50 = __rcr(ebx_50, 0x01, (bool) cond(ecx_58));
			eax_52 = __rcr(eax_52, 0x01, (bool) cond(edx_51));
			uint64 edx_eax_68 = eax_52;
			ecx_49 = ecx_58;
		} while (ecx_58 != null);
		uint32 eax_74 = (uint32) (edx_eax_68 /u ebx_50);
		uint64 edx_eax_80 = eax_74 * dwArg0C;
		uint32 esi_100 = eax_74;
		Eq_117 eax_81 = (word32) edx_eax_80;
		struct Eq_490 * edx_83 = SLICE(edx_eax_80, word32, 32) + (word32) (dwArg10 * eax_74);
		if (edx_83 < null || (edx_83 > dwArg08 || edx_83 >= dwArg08 && eax_81 > dwArg04))
			esi_100 = eax_74 - 0x01;
		word32 edx_91;
		*edxOut = 0x00;
		eax_21 = esi_100;
	}
	return eax_21;
}

// 004032D0: Register uint32 fn004032D0(Stack Eq_117 dwArg04, Stack (ptr32 Eq_490) dwArg08, Stack Eq_117 dwArg0C, Stack (ptr32 ui32) dwArg10)
uint32 fn004032D0(Eq_117 dwArg04, Eq_490 * dwArg08, Eq_117 dwArg0C, ui32 * dwArg10)
{
	uint32 eax_17;
	if (dwArg10 == null)
		eax_17 = (uint32) (SEQ((uint32) ((uint64) (uint32) dwArg08 % dwArg0C), dwArg04) % dwArg0C);
	else
	{
		ui32 * ecx_46 = dwArg10;
		Eq_117 ebx_47 = dwArg0C;
		struct Eq_490 * edx_48 = dwArg08;
		Eq_117 eax_49 = dwArg04;
		do
		{
			ui32 * ecx_55 = ecx_46 >> 0x01;
			edx_48 = edx_48 >> 0x01;
			ebx_47 = __rcr(ebx_47, 0x01, (bool) cond(ecx_55));
			eax_49 = __rcr(eax_49, 0x01, (bool) cond(edx_48));
			uint64 edx_eax_65 = eax_49;
			ecx_46 = ecx_55;
		} while (ecx_55 != null);
		uint32 eax_71 = (uint32) (edx_eax_65 /u ebx_47);
		uint64 edx_eax_78 = dwArg0C * eax_71;
		Eq_117 eax_112 = (word32) edx_eax_78;
		struct Eq_490 * edx_113 = SLICE(edx_eax_78, word32, 32) + (word32) (dwArg10 * eax_71);
		if (edx_113 < null || (edx_113 > dwArg08 || edx_113 >= dwArg08 && eax_112 > dwArg04))
		{
			word64 edx_eax_111 = eax_112 - dwArg0C - _;
			eax_112 = (word32) edx_eax_111;
			edx_113 = SLICE(edx_eax_111, word32, 32);
		}
		eax_17 = -(word32) (eax_112 - dwArg04 - _);
	}
	return eax_17;
}

// 00403350: Register ui32 fn00403350(Stack Eq_117 dwArg04, Stack (ptr32 Eq_490) dwArg08)
ui32 fn00403350(Eq_117 dwArg04, Eq_490 * dwArg08)
{
	ui32 eax_17 = dwArg08->dw000C;
	byte al_18 = (byte) eax_17;
	Eq_70 ebp_19 = dwArg08->t0010;
	if ((al_18 & 0x82) != 0x00 && (al_18 & 0x40) == 0x00)
	{
		Eq_70 ebx_150 = 0x00;
		if ((al_18 & 0x01) == 0x00)
		{
l00403389:
			ui32 eax_69 = dwArg08->dw000C;
			dwArg08->dw0004 = 0x00;
			ui32 eax_74 = DPB(eax_69, (byte) eax_69 & ~0x10 | 0x02, 0);
			dwArg08->dw000C = eax_74;
			if ((eax_74 & 0x010C) == 0x00 && (dwArg08 != &globals->t406098 && dwArg08 != &globals->t4060B8 || fn00403060(ebp_19) == 0x00))
				fn00404200(dwArg08);
			Eq_70 edi_135;
			if ((dwArg08->dw000C & 0x0108) != 0x00)
			{
				Eq_117 eax_131 = dwArg08->t0008;
				word32 ecx_134 = dwArg08->dw0018;
				edi_135 = dwArg08->t0000 - eax_131;
				dwArg08->t0000 = (word32) eax_131 + 0x01;
				dwArg08->dw0004 = ecx_134 - 0x01;
				if (edi_135 > 0x00)
				{
					Eq_70 eax_148 = fn00403F10(ebp_19, eax_131, edi_135);
					*dwArg08->t0008 = bArg04;
					ebx_150 = eax_148;
				}
				else
				{
					struct Eq_4740 * eax_160;
					if (ebp_19 != ~0x00)
						eax_160 = (&globals->t408BE0)[ebp_19 >> 0x05] + (ebp_19 & 0x1F) * 0x08;
					else
						eax_160 = &globals->t406478;
					if ((eax_160->b0004 & 0x20) != 0x00)
						fn00404140(ebp_19, 0x00, 0x02);
					*dwArg08->t0008 = bArg04;
				}
			}
			else
			{
				edi_135.u0 = 0x01;
				ebx_150 = fn00403F10(ebp_19, fp + 0x04, 0x01);
			}
			if (ebx_150 == edi_135)
				return dwArg04 & 0xFF;
			ui32 eax_100 = dwArg08->dw000C;
			ui32 eax_103 = DPB(eax_100, (byte) eax_100 | 0x20, 0);
			dwArg08->dw000C = eax_103;
			return eax_103 | ~0x00;
		}
		dwArg08->dw0004 = 0x00;
		if ((al_18 & 0x10) != 0x00)
		{
			dwArg08->t0000 = dwArg08->t0008;
			dwArg08->dw000C = DPB(eax_17, al_18 & ~0x01, 0);
			goto l00403389;
		}
	}
	ui32 eax_41 = DPB(eax_17, al_18 | 0x20, 0);
	dwArg08->dw000C = eax_41;
	return eax_41 | ~0x00;
}

// 00403590: void fn00403590(Register (ptr32 Eq_133) ecx, Stack Eq_117 dwArg04)
void fn00403590(Eq_133 * ecx, Eq_117 dwArg04)
{
	if (dwArg04 == 0x00)
		return;
	byte * eax_50 = fn00403880(dwArg04, fp - 0x04, fp + 0x04);
	if (eax_50 == null)
		HeapFree(globals->t408BD4, 0x00, dwArg04);
	else
		fn004038E0(ecx, dwArg04, eax_50);
}

// 004035E0: Register Eq_117 fn004035E0()
Eq_117 fn004035E0()
{
	Eq_117 ebp_196;
	if (globals->dw406760 == ~0x00)
		ebp_196.u0 = 0x00406750;
	else
	{
		Eq_117 eax_204 = HeapAlloc(globals->t408BD4, 0x00, 0x2020);
		ebp_196 = eax_204;
		if (eax_204 == 0x00)
			return 0x00;
	}
	Eq_117 eax_63 = VirtualAlloc(0x00, 0x00400000, 0x2000, 0x04);
	Eq_117 esi_162 = eax_63;
	if (eax_63 != 0x00)
	{
		if (VirtualAlloc(eax_63, 0x00010000, 0x1000, 0x04) != 0x00)
		{
			if (ebp_196 == 0x00406750)
			{
				if (globals->dw406750 == 0x00)
					globals->dw406750 = 0x00406750;
				if (globals->t406754 == 0x00)
					globals->t406754.u0 = 0x00406750;
			}
			else
			{
				*ebp_196.u0 = 0x00406750;
				*((char *) ebp_196.u0 + 0x04) = globals->t406754;
				globals->t406754 = ebp_196;
				**((char *) ebp_196.u0 + 0x04) = ebp_196;
			}
			Mem107[ebp_196 + 0x14:word32] = eax_63 + 0x00400000;
			*((char *) ebp_196.u0 + 0x0010) = eax_63;
			word32 ecx_105 = ebp_196 + 0x18;
			*((char *) ebp_196.u0 + 0x08) = ecx_105;
			Mem110[ebp_196 + 0x0C:word32] = ebp_196 + 0x98;
			int32 eax_111 = 0x00;
			do
			{
				ecx_105 = (word32) ecx_105 + 0x08;
				*(ecx_105 - 0x08) = ((word32) (eax_111 >= 0x10) - 0x01 & 0xF1) - 0x01;
				*(ecx_105 - 0x04) = 0xF1;
				eax_111 = eax_111 + 0x01;
			} while (eax_111 < 0x0400);
			word32 ecx_133 = 0x4000;
			Eq_117 edi_138 = eax_63;
			while (ecx_133 != 0x00)
			{
				*edi_138 = 0x00;
				edi_138 = edi_138 + 0x04;
				ecx_133 = ecx_133 - 0x01;
			}
			if (eax_63 < (word32) (*((char *) ebp_196.u0 + 0x0010)) + 0x00010000)
			{
				do
				{
					((word32) esi_162 + 0x04)->u0 = 0xF0;
					Mem165[esi_162 + 0x00:word32] = esi_162 + 0x08;
					*((word32) esi_162 + 0x00F8) = ~0x00;
					esi_162 = esi_162 + 0x1000;
				} while (esi_162 < (word32) (*((char *) ebp_196.u0 + 0x0010)) + 0x00010000);
			}
			return ebp_196;
		}
		VirtualFree(eax_63, 0x00, 0x8000);
	}
	if (ebp_196 != 0x00406750)
		HeapFree(globals->t408BD4, 0x00, ebp_196);
	return 0x00;
}

// 00403750: void fn00403750(Stack Eq_117 dwArg04)
void fn00403750(Eq_117 dwArg04)
{
	VirtualFree(*((word32) dwArg04 + 0x0010), 0x00, 0x8000);
	if (globals->t408770 == dwArg04)
		globals->t408770 = *((word32) dwArg04 + 0x04);
	if (dwArg04 == 0x00406750)
		globals->dw406760 = ~0x00;
	else
	{
		**((word32) dwArg04 + 0x04) = *dwArg04;
		*((word32) *dwArg04 + 0x04) = *((word32) dwArg04 + 0x04);
		HeapFree(globals->t408BD4, 0x00, dwArg04);
	}
}

// 004037B0: void fn004037B0(Stack int32 dwArg04)
void fn004037B0(int32 dwArg04)
{
	Eq_117 edi_111 = globals->t406754;
	do
	{
		if (*((word32) edi_111 + 0x0010) != ~0x00)
		{
			word32 ebp_107 = 0x00;
			struct Eq_5061 * esi_149 = (word32) edi_111 + 0x00002010;
			int32 ebx_148 = 0x003FF000;
			do
			{
				if (esi_149->dw0000 == 0xF0 && VirtualFree((word32) (*((word32) edi_111 + 0x0010)) + ebx_148, 0x1000, 0x4000) != 0x00)
				{
					esi_149->dw0000 = ~0x00;
					globals->dw408BBC = globals->dw408BBC - 0x01;
					struct Eq_5061 * eax_170 = *((word32) edi_111 + 0x0C);
					if (eax_170 == null || eax_170 > esi_149)
						*((word32) edi_111 + 0x0C) = esi_149;
					int32 eax_178 = dwArg04 - 0x01;
					ebp_107 = ebp_107 + 0x01;
					dwArg04 = eax_178;
					if (eax_178 == 0x00)
						break;
				}
				ebx_148 = ebx_148 - 0x1000;
				esi_149 = esi_149 - 0x08;
			} while (ebx_148 >= 0x00);
			edi_111 = *((word32) edi_111 + 0x04);
			if (ebp_107 != 0x00 && *((word32) edi_111 + 0x0018) == ~0x00)
			{
				int32 eax_117 = 0x01;
				struct Eq_5133 * ecx_118 = (word32) edi_111 + 0x0020;
				while (ecx_118->dw0000 == ~0x00)
				{
					eax_117 = eax_117 + 0x01;
					ecx_118 = ecx_118 + 0x01;
					if (eax_117 >= 0x0400)
						break;
				}
				if (eax_117 == 0x0400)
					fn00403750(edi_111);
			}
		}
	} while (edi_111 != globals->t406754 && dwArg04 > 0x00);
}

// 00403880: Register int32 fn00403880(Stack Eq_117 dwArg04, Stack (ptr32 (ptr32 Eq_5155)) dwArg08, Stack (ptr32 ui32) dwArg0C)
int32 fn00403880(Eq_117 dwArg04, Eq_5155 * * dwArg08, ui32 * dwArg0C)
{
	byte cl_4 = (byte) dwArg04;
	struct Eq_5155 * eax_28 = &globals->dw406750;
	do
	{
		if (dwArg04 > eax_28->t0010 && dwArg04 < eax_28->t0014)
		{
			if ((cl_4 & 0x0F) != 0x00 || (dwArg04 & 0x0FFF) < 0x0100)
				return 0x00;
			*dwArg08 = (struct Eq_5155 **) eax_28;
			*dwArg0C = dwArg04 & ~0x0FFF;
			return (dwArg04 - (dwArg04 & ~0x0FFF) - 0x0100 >> 0x04) + 0x08 + (dwArg04 & ~0x0FFF);
		}
		eax_28 = eax_28->ptr0000;
	} while (eax_28 != &globals->dw406750);
	return 0x00;
}

// 004038E0: void fn004038E0(Stack (ptr32 Eq_133) dwArg04, Stack Eq_117 dwArg08, Stack (ptr32 byte) dwArg0C)
void fn004038E0(Eq_133 * dwArg04, Eq_117 dwArg08, byte * dwArg0C)
{
	int32 ecx_11 = dwArg08 - dwArg04->dw0010;
	struct Eq_5202 * eax_14 = &dwArg04->a0018->dw0000 + ((ecx_11 >> 0x0C) * 0x08) / 0x0018;
	eax_14->dw0000 = dwArg04->a0018[ecx_11 >> 0x0C].dw0000 + (word32) (*dwArg0C);
	*dwArg0C = 0x00;
	word32 ecx_22 = eax_14->dw0000;
	eax_14->dw0004 = 0xF1;
	if (ecx_22 == 0xF0)
	{
		word32 eax_33 = globals->dw408BBC;
		globals->dw408BBC = eax_33 + 0x01;
		if (eax_33 == ~0x1E)
			fn004037B0(0x10);
	}
}

// 00403940: Register Eq_5251 fn00403940(Stack Eq_117 dwArg04, Register out ptr32 ecxOut)
Eq_5251 fn00403940(Eq_117 dwArg04, ptr32 & ecxOut)
{
	Eq_117 ecx_296 = globals->t408770;
	Eq_5255 bl_12 = (byte) dwArg04;
	Eq_117 dwLoc04_183 = ecx_296;
	do
	{
		Eq_117 eax_43 = *((word32) ecx_296 + 0x0010);
		if (eax_43 != ~0x00)
		{
			Eq_5255 edi_278 = *((word32) ecx_296 + 0x08);
			Eq_5255 ebp_279 = (word32) ecx_296 + 0x00002018;
			Eq_117 esi_285 = (word32) eax_43 + (((edi_278 - ecx_296) - 0x18 >> 0x03) << 0x0C);
			if (edi_278 < ebp_279)
			{
				do
				{
					Eq_117 eax_373 = *edi_278;
					if (eax_373 >= dwArg04 && *((word32) edi_278 + 0x04) > dwArg04)
					{
						Eq_5251 eax_397 = fn00403B80(esi_285, eax_373, dwArg04);
						if (eax_397 != 0x00)
						{
							globals->t408770 = dwLoc04_183;
							*edi_278 = *edi_278 - dwArg04;
							*((word32) dwLoc04_183 + 0x08) = edi_278;
							word32 ecx_419;
							*ecxOut = dwLoc04_183;
							return eax_397;
						}
						*((word32) edi_278 + 0x04) = dwArg04;
						ecx_296 = dwLoc04_183;
					}
					edi_278 = edi_278 + 0x08;
					esi_285 = (word32) esi_285 + 0x00001000;
				} while (edi_278 < ebp_279);
			}
			Eq_5255 ebp_298 = *((word32) ecx_296 + 0x08);
			Eq_117 edi_299 = *((word32) ecx_296 + 0x0010);
			Eq_5255 esi_300 = (word32) ecx_296 + 0x0018;
			if (esi_300 < ebp_298)
			{
				do
				{
					Eq_117 eax_314 = *esi_300;
					if (eax_314 >= dwArg04 && *((word32) esi_300 + 0x04) > dwArg04)
					{
						Eq_5251 eax_338 = fn00403B80(edi_299, eax_314, dwArg04);
						if (eax_338 != 0x00)
						{
							globals->t408770 = dwLoc04_183;
							*esi_300 = *esi_300 - dwArg04;
							*((word32) dwLoc04_183 + 0x08) = esi_300;
							word32 ecx_360;
							*ecxOut = dwLoc04_183;
							return eax_338;
						}
						*((word32) esi_300 + 0x04) = dwArg04;
						ecx_296 = dwLoc04_183;
					}
					esi_300 = (word32) esi_300 + 0x08;
					edi_299 = (word32) edi_299 + 0x00001000;
				} while (esi_300 < ebp_298);
			}
		}
		ecx_296 = *ecx_296;
		dwLoc04_183 = ecx_296;
	} while (ecx_296 != globals->t408770);
	Eq_117 ebp_120 = 0x00406750;
	do
	{
		if (*((word32) ebp_120 + 0x0010) != (ecx_296 | ~0x00) && *((word32) ebp_120 + 0x0C) != null)
		{
			Eq_5255 eax_157 = (word32) *((word32) ebp_120 + 0x0C) + 0x08;
			Eq_117 edi_166 = (word32) *((word32) ebp_120 + 0x0010) + (((eax_157 - ebp_120) - 0x18 >> 0x03) << 0x0C);
			int32 esi_167 = 0x00;
			eax_269 = eax_157;
			if (*eax_157 == (ecx_296 | ~0x00))
			{
				do
				{
					Eq_5255 eax_269;
					if (esi_167 >= 0x10)
						break;
					eax_269 = (word32) eax_421 + 0x08;
					esi_167 = esi_167 + 0x01;
					Eq_5255 eax_421 = eax_269;
				} while (*eax_421 == (ecx_296 | ~0x00));
			}
			Eq_117 eax_176 = esi_167 << 0x0C;
			dwLoc04_183 = eax_176;
			if (VirtualAlloc(edi_166, eax_176, 0x1000, 0x04) != edi_166)
				goto l00403B6B;
			struct Eq_5480 * ecx_193 = (word32) eax_157 + 0x04;
			if (esi_167 > 0x00)
			{
				word32 eax_250 = edi_166 + 0x04;
				do
				{
					*eax_250 = 0xF0;
					Mem256[eax_250 - 0x04 + 0x00:word32] = eax_250 + 0x04;
					*((word32) eax_250 + 244) = ~0x00;
					ecx_193->dw0000 = 0xF0;
					ecx_193->dw0000 = 0xF1;
					eax_250 = eax_250 + 0x1000;
					ecx_193 = ecx_193 + 0x08;
					esi_167 = esi_167 - 0x01;
				} while (esi_167 != 0x00);
			}
			globals->t408770 = ebp_120;
			struct Eq_5480 * eax_197 = (word32) ebp_120 + 0x00002018;
			Eq_5490 C_203 = (bool) cond(ecx_193 - eax_197);
			if (ecx_193 < eax_197)
			{
				while (ecx_193->dw0000 != ~0x00)
				{
					ecx_193 = ecx_193 + 0x08;
					if (ecx_193 >= eax_197)
						break;
				}
				C_203 = (bool) cond(ecx_193 - eax_197);
			}
			*((word32) ebp_120 + 0x0C) = 0x00 - C_203 & ecx_193;
			*((word32) edi_166 + 0x08) = bl_12;
			*((word32) ebp_120 + 0x08) = eax_157;
			*eax_157 = *eax_157 - dwArg04;
			*((word32) edi_166 + 0x04) = *((word32) edi_166 + 0x04) - dwArg04;
			Mem224[edi_166 + 0x00:word32] = edi_166 + 0x08 + dwArg04;
			word32 ecx_234;
			*ecxOut = eax_176;
			return edi_166 + 0x0100;
		}
		ebp_120 = *ebp_120;
	} while (ebp_120 != 0x00406750);
	Eq_117 eax_123 = fn004035E0();
	if (eax_123 == 0x00)
	{
l00403B6B:
		word32 ecx_115;
		*ecxOut = dwLoc04_183;
		return 0x00;
	}
	else
	{
		Eq_117 ecx_129 = *((word32) eax_123 + 0x0010);
		*((word32) ecx_129 + 0x08) = bl_12;
		globals->t408770 = eax_123;
		*ecx_129 = (word32) dwArg04 + ((word32) ecx_129 + 0x08);
		*((word32) ecx_129 + 0x04) = 0xF0 - dwArg04;
		*((word32) eax_123 + 0x0018) = *((word32) eax_123 + 0x0018) - (dwArg04 & 0xFF);
		word32 ecx_151;
		*ecxOut = ecx_296;
		return (word32) ecx_129 + 0x0100;
	}
}

// 00403B80: Register ui32 fn00403B80(Stack Eq_117 dwArg04, Stack Eq_117 dwArg08, Stack Eq_117 dwArg0C)
ui32 fn00403B80(Eq_117 dwArg04, Eq_117 dwArg08, Eq_117 dwArg0C)
{
	Eq_5577 ecx_22 = *dwArg04;
	byte dl_4 = (byte) dwArg0C;
	Eq_117 eax_20 = *((word32) dwArg04 + 0x04);
	Eq_5577 esi_102 = ecx_22;
	if (eax_20 < dwArg0C)
	{
		word32 eax_73 = eax_20 + ecx_22;
		if (*eax_73 != 0x00)
			esi_102 = eax_73;
		Eq_5577 ecx_131;
		word32 eax_210 = esi_102 + dwArg0C;
		Eq_117 ebx_135 = dwArg08;
		ecx_131 = ecx_22;
		ecx_131 = ecx_22;
		if (eax_210 < (word32) dwArg04 + 0x00F8)
		{
			do
			{
				byte al_215 = *esi_102;
				uint32 eax_216 = DPB(eax_210, al_215, 0);
				if (al_215 == 0x00)
				{
					Eq_5577 eax_231 = (word32) esi_102 + 0x01;
					Eq_117 ecx_233 = 0x01;
					if (*((word32) esi_102 + 0x01) == 0x00)
					{
						do
						{
							eax_231 = (word32) eax_231 + 0x01;
							ecx_233 = (word32) ecx_233 + 0x01;
						} while (*eax_231 == 0x00);
					}
					if (ecx_233 >= dwArg0C)
					{
						word32 eax_251 = esi_102 + dwArg0C;
						if (eax_251 < (word32) dwArg04 + 0x00F8)
						{
							*dwArg04 = eax_251;
							*((word32) dwArg04 + 0x04) = ecx_233 - dwArg0C;
						}
						else
						{
							*dwArg04 = (word32) dwArg04 + 0x08;
l00403CCF:
							((word32) dwArg04 + 0x04)->u0 = 0x00;
						}
l00403CD6:
						*esi_102 = dl_4;
						return (esi_102 + 0x08 << 0x04) - (dwArg04 * 0x03 + dwArg04 * 0x0C);
					}
					if (esi_102 == ecx_22)
					{
						*((word32) dwArg04 + 0x04) = ecx_233;
						esi_102 = eax_231;
						ecx_131 = ecx_22;
					}
					else
					{
						ebx_135 = ebx_135 - ecx_233;
						if (ebx_135 < dwArg0C)
							return 0x00;
						ecx_131 = ecx_22;
						esi_102 = eax_231;
					}
				}
				else
					esi_102 = (word32) esi_102 + (eax_216 & 0xFF);
				eax_210 = (word32) dwArg04 + 0x00F8;
			} while (esi_102 + dwArg0C <u dwArg04 + 0xF8);
		}
		esi_102 = (word32) dwArg04 + 0x08;
		if ((word32) dwArg04 + 0x08 >= ecx_131)
			return 0x00;
		do
		{
			if (esi_102 + dwArg0C >=u dwArg04 + 0xF8)
				return 0x00;
			byte al_149 = *esi_102;
			Eq_5703 eax_150 = DPB((word32) dwArg04 + 0x00F8, al_149, 0);
			if (al_149 == 0x00)
			{
				Eq_5577 eax_176 = (word32) esi_102 + 0x01;
				Eq_117 ecx_178 = 0x01;
				if (*((word32) esi_102 + 0x01) == 0x00)
				{
					do
					{
						eax_176 = (word32) eax_176 + 0x01;
						ecx_178 = (word32) ecx_178 + 0x01;
					} while (*eax_176 == 0x00);
				}
				if (ecx_178 >= dwArg0C)
				{
					word32 eax_189 = esi_102 + dwArg0C;
					if (eax_189 >= (word32) dwArg04 + 0x00F8)
					{
						*dwArg04 = (word32) dwArg04 + 0x08;
						goto l00403CCF;
					}
					else
					{
						*dwArg04 = eax_189;
						*((word32) dwArg04 + 0x04) = ecx_178 - dwArg0C;
						goto l00403CD6;
					}
				}
				ebx_135 = ebx_135 - ecx_178;
				if (ebx_135 < dwArg0C)
					return 0x00;
				esi_102 = eax_176;
			}
			else
				esi_102 = (word32) esi_102 + (eax_150 & 0xFF);
		} while (esi_102 < ecx_22);
		return 0x00;
	}
	else
	{
		*ecx_22 = dl_4;
		if (ecx_22 + dwArg0C <u dwArg04 + 0xF8)
		{
			Eq_117 eax_66 = *((word32) dwArg04 + 0x04) - dwArg0C;
			Mem68[dwArg04 + 0x00:word32] = Mem42[dwArg04 + 0x00:word32] + dwArg0C;
			*((word32) dwArg04 + 0x04) = eax_66;
		}
		else
		{
			((word32) dwArg04 + 0x04)->u0 = 0x00;
			*dwArg04 = (word32) dwArg04 + 0x08;
		}
		return (ecx_22 + 0x08 << 0x04) - (dwArg04 * 0x03 + dwArg04 * 0x0C);
	}
}

// 00403D00: Register word32 fn00403D00()
word32 fn00403D00()
{
	word32 ebx_108 = 0x00;
	if (globals->t408BC0 == null)
	{
		Eq_2505 eax_111 = LoadLibraryA(&globals->t4053A4);
		if (eax_111 == null)
			return ecx;
		Eq_5784 eax_134 = GetProcAddress(eax_111, &globals->t405398);
		globals->t408BC0 = eax_134;
		if (eax_134 == null)
			return ecx;
		globals->t408BC4 = GetProcAddress(eax_111, &globals->t405388);
		globals->t408BC8 = GetProcAddress(eax_111, &globals->t405374);
	}
	struct Eq_5787 * esp_35 = fp - 0x0C;
	Eq_5784 eax_36 = globals->t408BC4;
	if (eax_36 != null)
	{
		word32 eax_99;
		word32 ebx_100;
		byte SZO_101;
		bool C_102;
		word32 esi_103;
		word32 edi_104;
		bool Z_105;
		word32 ecx_106;
		word32 edx_107;
		eax_36();
		ebx_108 = eax_99;
	}
	if (ebx_108 != 0x00)
	{
		Eq_5784 eax_81 = globals->t408BC8;
		if (eax_81 != null)
		{
			word32 * esp_85 = esp_35 - 0x04;
			*esp_85 = ebx_108;
			word32 eax_88;
			word32 ebx_89;
			byte SZO_90;
			bool C_91;
			word32 esi_92;
			word32 edi_93;
			bool Z_94;
			word32 ecx_95;
			word32 edx_96;
			eax_81();
			ebx_108 = eax_88;
		}
	}
	word32 eax_54 = esp_35->dw0018;
	word32 ecx_55 = esp_35->dw0014;
	word32 edx_56 = esp_35->dw0010;
	word32 * esp_57 = esp_35 - 0x04;
	*esp_57 = eax_54;
	*(esp_57 - 0x04) = ecx_55;
	*(esp_57 - 0x08) = edx_56;
	*(esp_57 - 0x0C) = ebx_108;
	word32 esp_65;
	word32 eax_66;
	word32 ebx_67;
	byte SZO_68;
	bool C_69;
	word32 esi_70;
	word32 edi_71;
	bool Z_72;
	word32 ecx_73;
	word32 edx_74;
	globals->t408BC0();
	return ecx_73;
}

// 00403D90: void fn00403D90(Stack (ptr32 Eq_3879) dwArg04, Stack (ptr32 byte) dwArg08, Stack uint32 dwArg0C)
void fn00403D90(Eq_3879 * dwArg04, byte * dwArg08, uint32 dwArg0C)
{
	uint32 ecx_260 = dwArg0C;
	if (dwArg0C == 0x00)
		return;
	uint32 ecx_200;
	uint32 ecx_168;
	byte al_100;
	uint32 ebx_103 = dwArg0C;
	byte * esi_120 = dwArg08;
	struct Eq_3879 * edi_105 = dwArg04;
	if ((dwArg08 & 0x03) == 0x00)
	{
		ecx_200 = dwArg0C >> 0x02;
		if (dwArg0C >> 0x02 == 0x00)
			goto l00403DD5;
	}
	else
	{
		do
		{
			al_100 = *esi_120;
			edi_105->t0000.u0 = al_100;
			esi_120 = esi_120 + 0x01;
			edi_105 = edi_105 + 0x01;
			ecx_260 = ecx_260 - 0x01;
			if (ecx_260 == 0x00)
				return;
			if (al_100 == 0x00)
			{
				if ((edi_105 & 0x03) != 0x00)
				{
					do
					{
						edi_105->t0000.u0 = al_100;
						edi_105 = edi_105 + 0x01;
						ecx_260 = ecx_260 - 0x01;
						if (ecx_260 == 0x00)
							return;
					} while ((edi_105 & 0x03) != 0x00);
				}
				ebx_103 = ecx_260;
				ecx_168 = ecx_260 >> 0x02;
				if (ecx_168 != 0x00)
				{
l00403E77:
					do
					{
						edi_105->t0000.u1 = 0x00;
						edi_105 = edi_105 + 0x04;
						ecx_168 = ecx_168 - 0x01;
					} while (ecx_168 != 0x00);
l00403E81:
					al_100 = 0x00;
					ebx_103 = ebx_103 & 0x03;
					if (ebx_103 == 0x00)
						return;
				}
				do
				{
					edi_105->t0000.u0 = al_100;
					edi_105 = edi_105 + 0x01;
l00403E0E:
					ebx_103 = ebx_103 - 0x01;
				} while (ebx_103 != 0x00);
				return;
			}
		} while ((esi_120 & 0x03) != 0x00);
		ebx_103 = ecx_260;
		ecx_200 = ecx_260 >> 0x02;
		if (ecx_260 >> 0x02 == 0x00)
		{
l00403DD0:
			ebx_103 = ebx_103 & 0x03;
			if (ebx_103 == 0x00)
				return;
l00403DD5:
			do
			{
				al_100 = *esi_120;
				edi_105->t0000.u0 = al_100;
				esi_120 = esi_120 + 0x01;
				edi_105 = edi_105 + 0x01;
				if (al_100 == 0x00)
					goto l00403E0E;
				ebx_103 = ebx_103 - 0x01;
			} while (ebx_103 != 0x00);
			return;
		}
	}
	do
	{
		Eq_5933 edx_210 = *esi_120;
		Eq_5937 eax_206 = *esi_120;
		byte dl_211 = (byte) edx_210;
		byte dh_212 = SLICE(edx_210, byte, 8);
		esi_120 = esi_120 + 0x04;
		if (((eax_206 ^ ~0x00 ^ (word32) eax_206 + 0x7EFEFEFF) & 0x81010100) != 0x00)
		{
			if (dl_211 != 0x00)
			{
				if (dh_212 != 0x00)
				{
					if ((edx_210 & 0x00FF0000) != 0x00)
					{
						if ((edx_210 & 0xFF000000) != 0x00)
							goto l00403E19;
						edi_105->t0000 = edx_210;
					}
					else
						edi_105->t0000 = edx_210 & 0xFFFF;
				}
				else
					edi_105->t0000 = edx_210 & 0xFF;
			}
			else
				edi_105->t0000.u1 = 0x00;
			edi_105 = edi_105 + 0x04;
			ecx_168 = ecx_200 - 0x01;
			if (ecx_168 != 0x00)
				goto l00403E77;
			goto l00403E81;
		}
l00403E19:
		edi_105->t0000 = edx_210;
		edi_105 = edi_105 + 0x04;
		ecx_200 = ecx_200 - 0x01;
	} while (ecx_200 != 0x00);
	goto l00403DD0;
}

// 00403E90: Register word32 fn00403E90(Stack Eq_117 dwArg04, Register out ptr32 ecxOut)
word32 fn00403E90(Eq_117 dwArg04, ptr32 & ecxOut)
{
	*ecxOut = ecx;
	<anonymous> * eax_3 = globals->ptr408BD0;
	if (eax_3 == null)
		return 0x00;
	word32 esp_31;
	word32 eax_32;
	byte SZO_33;
	bool C_34;
	bool Z_35;
	word32 ecx_36;
	byte SCZO_37;
	eax_3();
	if (eax_32 == 0x00)
		return 0x00;
	return 0x01;
}

// 00403F10: Register ui32 fn00403F10(Stack Eq_70 dwArg04, Stack Eq_117 dwArg08, Stack Eq_70 dwArg0C)
ui32 fn00403F10(Eq_70 dwArg04, Eq_117 dwArg08, Eq_70 dwArg0C)
{
	Eq_70 eax_171 = dwArg04;
	if (dwArg04 < globals->t408CE0)
	{
		union Eq_2213 * esi_110 = (dwArg04 & 0x1F) << 0x03;
		union Eq_2213 ** edi_109 = (dwArg04 >> 0x05) * 0x04 + 0x00408BE0;
		byte cl_113 = Mem0[esi_110 + 0x04 + 0x00408BE0[(dwArg04 >> 0x05) * 0x04]:byte];
		if ((cl_113 & 0x01) != 0x00)
		{
			Eq_70 dwLoc041C_123 = 0x00;
			word32 dwLoc040C_124 = 0x00;
			if (dwArg0C == 0x00)
				return 0x00;
			if ((cl_113 & 0x20) != 0x00)
				fn00404140(dwArg04, 0x00, 0x02);
			Eq_70 dwLoc0414_156;
			word32 eax_145 = Mem0[edi_109 + 0x00:word32] + esi_110;
			if ((eax_145->b0004 & 0x80) != 0x00)
			{
				dwLoc0414_156.u0 = 0x00;
				Eq_117 edi_243 = dwArg08;
				if (!DPB(CZ, false, 0))
				{
					do
					{
						Eq_6175 eax_262 = fp - 0x0404;
						while (edi_243 - dwArg08 < dwArg0C)
						{
							Eq_2018 cl_327 = *edi_243;
							edi_243 = edi_243 + 0x01;
							if (cl_327 == 0x0A)
							{
								*eax_262 = 0x0D;
								eax_262 = eax_262 + 0x01;
								dwLoc040C_124 = dwLoc040C_124 + 0x01;
							}
							*eax_262 = cl_327;
							eax_262 = eax_262 + 0x01;
							if (eax_262 - (fp - 0x0404) >= 0x0400)
								break;
						}
						Eq_70 esi_285 = eax_262 - (fp - 0x0404);
						if (WriteFile(Mem0[esi_110 + Mem0[edi_109 + 0x00:word32]:word32], fp - 0x0404, esi_285, fp - 0x0410, 0x00) == 0x00)
						{
							dwLoc0414_156 = GetLastError();
							break;
						}
						dwLoc041C_123 = dwLoc041C_123 + dwLoc0410;
					} while (dwLoc0410 >= esi_285 && edi_243 - dwArg08 < dwArg0C);
				}
			}
			else if (WriteFile(eax_145->t0000, dwArg08, dwArg0C, fp - 0x0410, null) != 0x00)
			{
				dwLoc0414_156.u0 = 0x00;
				dwLoc041C_123 = dwLoc0410;
			}
			else
				dwLoc0414_156 = GetLastError();
			if (dwLoc041C_123 != 0x00)
				return dwLoc041C_123 - dwLoc040C_124;
			eax_171 = dwLoc0414_156;
			if (dwLoc0414_156 != 0x00)
			{
				if (dwLoc0414_156 != 0x05)
					return fn004043D0(dwLoc0414_156) | ~0x00;
				globals->t408918 = dwLoc0414_156;
				globals->ptr408914 = (struct Eq_4471 *) 0x09;
				return dwLoc0414_156 | ~0x00;
			}
			if ((Mem0[esi_110 + 0x04 + Mem0[edi_109 + 0x00:word32]:byte] & 0x40) != 0x00 && *dwArg08 == 0x1A)
				return 0x00;
			globals->ptr408914 = (struct Eq_4471 *) 0x1C;
l004040C7:
			globals->t408918.u0 = 0x00;
			return eax_171 | ~0x00;
		}
	}
	globals->ptr408914 = (struct Eq_4471 *) 0x09;
	goto l004040C7;
}

// 00404140: void fn00404140(Stack Eq_70 dwArg04, Stack Eq_4798 dwArg08, Stack Eq_70 dwArg0C)
void fn00404140(Eq_70 dwArg04, LONG dwArg08, Eq_70 dwArg0C)
{
	if (dwArg04 < globals->t408CE0)
	{
		struct Eq_6338 ** ebx_59 = (dwArg04 >> 0x05) * 0x04 + 0x00408BE0;
		int32 esi_60 = (dwArg04 & 0x1F) << 0x03;
		if (((&globals->t408BE0)[dwArg04 >> 0x05]->a0004[esi_60] & 0x01) != 0x00)
		{
			Eq_2213 eax_66 = fn00404380(dwArg04);
			if (eax_66 != ~0x00)
			{
				Eq_70 eax_128;
				if (SetFilePointer(eax_66, dwArg08, null, dwArg0C) == ~0x00)
					eax_128 = GetLastError();
				else
					eax_128.u0 = 0x00;
				if (eax_128 == 0x00)
				{
					struct Eq_6338 * eax_114 = *ebx_59;
					eax_114->a0004[esi_60] = eax_114->a0004[esi_60] & ~0x02;
					return;
				}
				else
				{
					fn004043D0(eax_128);
					return;
				}
			}
			else
			{
				globals->ptr408914 = (struct Eq_4471 *) 0x09;
				return;
			}
		}
	}
	globals->ptr408914 = (struct Eq_4471 *) 0x09;
	globals->t408918.u0 = 0x00;
}

// 00404200: void fn00404200(Stack (ptr32 Eq_490) dwArg04)
void fn00404200(Eq_490 * dwArg04)
{
	globals->dw408910 = globals->dw408910 + 0x01;
	word32 ecx_9;
	Eq_117 eax_10 = fn00402FB0(0x1000, out ecx_9);
	dwArg04->t0008 = eax_10;
	ui32 eax_18 = dwArg04->dw000C;
	byte al_19 = (byte) eax_18;
	if (eax_10 == 0x00)
	{
		dwArg04->dw0018 = 0x02;
		dwArg04->dw000C = DPB(eax_18, al_19 | 0x04, 0);
		dwArg04->t0008 = (char *) &dwArg04->t0010 + 0x04;
		dwArg04->t0000 = (char *) &dwArg04->t0010 + 0x04;
		dwArg04->dw0004 = 0x00;
	}
	else
	{
		Eq_117 edx_25 = dwArg04->t0008;
		dwArg04->dw000C = DPB(eax_18, al_19 | 0x08, 0);
		dwArg04->dw0018 = 0x1000;
		dwArg04->t0000 = edx_25;
		dwArg04->dw0004 = 0x00;
	}
}

// 00404380: Register Eq_2018 fn00404380(Stack Eq_70 dwArg04)
Eq_2018 fn00404380(Eq_70 dwArg04)
{
	Eq_70 eax_22 = dwArg04;
	if (dwArg04 < globals->t408CE0)
	{
		struct Eq_6434 * edx_31 = (&globals->t408BE0)[dwArg04 >> 0x05];
		eax_22 = edx_31 + (dwArg04 & 0x1F) * 0x02;
		if ((edx_31->a0004[dwArg04 & 0x1F].b0000 & 0x01) != 0x00)
			return *eax_22;
	}
	globals->ptr408914 = (struct Eq_4471 *) 0x09;
	globals->t408918.u0 = 0x00;
	return eax_22 | ~0x00;
}

// 004043D0: Register (ptr32 Eq_4471) fn004043D0(Stack Eq_70 dwArg04)
Eq_4471 * fn004043D0(Eq_70 dwArg04)
{
	globals->t408918 = dwArg04;
	ui32 ecx_10 = 0x00;
	struct Eq_4471 * eax_19 = globals->a408790;
	do
	{
		if (dwArg04 == eax_19->dw0000)
		{
			struct Eq_4471 * eax_40 = globals->a408794[ecx_10];
			globals->ptr408914 = eax_40;
			return eax_40;
		}
		eax_19 = eax_19 + 0x01;
		ecx_10 = ecx_10 + 0x01;
	} while (eax_19 < &globals->t4088F8);
	if (dwArg04 < 0x13 || dwArg04 > 0x24)
	{
		if (dwArg04 >= 188)
		{
			globals->ptr408914 = (struct Eq_4471 *) 0x08;
			if (dwArg04 <= 202)
				return eax_19;
		}
		globals->ptr408914 = (struct Eq_4471 *) 22;
		return eax_19;
	}
	else
	{
		globals->ptr408914 = (struct Eq_4471 *) 0x0D;
		return eax_19;
	}
}

