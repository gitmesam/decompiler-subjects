// subject.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

// 00401024: Register (ptr32 Eq_2) fn00401024(Register (ptr32 Eq_2) eax, Register word32 ecx, Register (ptr32 word32) edx, Register (ptr32 byte) esi, Register (ptr32 byte) edi)
Eq_2 * fn00401024(Eq_2 * eax, word32 ecx, word32 * edx, byte * esi, byte * edi)
{
}

// 00412513: Register Eq_47 Win32CrtStartup()
Eq_47 Win32CrtStartup()
{
	GetLastError();
	ptr32 esp_13 = fp - 0x48;
	do
	{
		word32 * esp_177 = esp_13 - 0x04;
		*esp_177 = 0x00;
l0041252C:
		Eq_47 eax_133;
		struct Eq_168 * esp_37 = esp_177 - 0x04;
		esp_37->t0000.u0 = 0x00;
		*(esp_37 - 0x04) = 0x80000000;
		*(esp_37 - 0x08) = 0x0042F897;
		ptr32 esp_339 = (char *) &esp_37->t0010 + 0x04;
		if (CreateFileW(*(esp_37 - 0x08), *(esp_37 - 0x04), esp_37->t0000, esp_37->t0004, esp_37->t0008, esp_37->t000C, esp_37->t0010) != ~0x00)
			goto l0041275E;
		esp_37->t0010.u0 = 0x0042F934;
		Eq_172 eax_136 = GetModuleHandleA(esp_37->t0010);
		esp_37->t0010.u0 = 4389083;
		esp_37->t000C.u0 = 0x00;
		esp_37->t0008.u0 = 0x01A1;
		esp_37->t0004.u0 = 0x03;
		esp_37->t0000.u0 = 0x00;
		*(esp_37 - 0x04) = 0x06;
		*(esp_37 - 0x08) = 0xC0000000;
		*(esp_37 - 0x0C) = 0x0042F8CC;
		esp_13 = &esp_37->t0010;
	} while (CreateFileA(*(esp_37 - 0x0C), *(esp_37 - 0x08), *(esp_37 - 0x04), esp_37->t0000, esp_37->t0004, esp_37->t0008, esp_37->t000C) != ~0x00);
	esp_37->t000C.u0 = 0x00;
	esp_37->t0008.u0 = 0x0122;
	esp_37->t0004.u0 = 0x03;
	esp_37->t0000.u0 = 0x00;
	*(esp_37 - 0x04) = 0x04;
	*(esp_37 - 0x08) = 0x60000000;
	*(esp_37 - 0x0C) = 4389131;
	struct Eq_290 * esp_172 = esp_37 - 0x0C;
	do
	{
		esp_177 = (word32 *) ((char *) &esp_355->t0018 + 0x04);
		if (CreateFileW(esp_355->t0000, esp_355->t0004, esp_355->t0008, esp_355->t000C, esp_355->t0010, esp_355->t0014, esp_355->t0018) != ~0x00)
			goto l0041252C;
		*(esp_177 - 0x04) = (HMODULE *) eax_136;
		*(esp_177 - 0x08) = 0x00;
		*(esp_177 - 0x0C) = 0x24;
		*(esp_177 - 0x10) = 0x03;
		*(esp_177 - 0x14) = 0x00;
		*(esp_177 - 0x18) = 0x00;
		*(esp_177 - 0x1C) = 0x00;
		*(esp_177 - 0x20) = 4389143;
		esp_172 = esp_177 - 0x04;
		struct Eq_290 * esp_355 = esp_172;
	} while (CreateFileW(*(esp_177 - 0x20), *(esp_177 - 0x1C), *(esp_177 - 0x18), *(esp_177 - 0x14), *(esp_177 - 0x10), *(esp_177 - 0x0C), *(esp_177 - 0x08)) != ~0x00);
	Eq_463 eax_203 = GetProcAddress(*(esp_177 - 0x04), *esp_177);
	GetLastError();
	*esp_177 = 0x00;
	GetLastError();
	*(esp_177 - 0x04) = 0x00;
	*(esp_177 - 0x08) = 0x00;
	*(esp_177 - 0x0C) = 0x0185;
	*(esp_177 - 0x10) = 0x03;
	*(esp_177 - 0x14) = 0x00;
	*(esp_177 - 0x18) = 0x00;
	*(esp_177 - 0x1C) = 0x80000000;
	*(esp_177 - 0x20) = 4389029;
	CreateFileA(*(esp_177 - 0x20), *(esp_177 - 0x1C), *(esp_177 - 0x18), *(esp_177 - 0x14), *(esp_177 - 0x10), *(esp_177 - 0x0C), *(esp_177 - 0x08));
	*(esp_177 - 0x08) = 0x00;
	*(esp_177 - 0x0C) = 0x00;
	*(esp_177 - 0x10) = 0xA3;
	*(esp_177 - 0x14) = 0x03;
	*(esp_177 - 0x18) = 0x00;
	*(esp_177 - 0x1C) = 0x03;
	*(esp_177 - 0x20) = 0xE0000000;
	*(esp_177 - 0x24) = 0x0042F8F8;
	if (CreateFileW(*(esp_177 - 0x24), *(esp_177 - 0x20), *(esp_177 - 0x1C), *(esp_177 - 0x18), *(esp_177 - 0x14), *(esp_177 - 0x10), *(esp_177 - 0x0C)) == ~0x00)
		dwLoc3C = eax_203();
	GetCommandLineA();
	DWORD * esp_257 = &esp_355->t0014;
	*(esp_257 - 0x04) = 0x00;
	*(esp_257 - 0x08) = 0x0101;
	*(esp_257 - 0x0C) = 0x03;
	*(esp_257 - 0x10) = 0x00;
	*(esp_257 - 0x14) = 0x05;
	*(esp_257 - 0x18) = 0xC0000000;
	*(esp_257 - 0x1C) = 0x0042F8BB;
	Eq_701 v10_261 = dwLoc3C ^ 0xC0000005;
	eax_133 = CreateFileW(*(esp_257 - 0x1C), *(esp_257 - 0x18), *(esp_257 - 0x14), *(esp_257 - 0x10), *(esp_257 - 0x0C), *(esp_257 - 0x08), *(esp_257 - 0x04));
	if (eax_133 == ~0x00)
	{
		Eq_47 eax_287 = GetLastError();
		ptr32 esp_288;
		word32 ebp_289;
		byte SCZO_290;
		word32 eax_291;
		bool Z_292;
		byte SZO_293;
		bool C_294;
		word32 ecx_295;
		word32 edx_296;
		word32 esi_297;
		word32 edi_298;
		(*((word32) v10_261 + 0x004126EF))();
		GetCommandLineA();
		*(esp_288 - 0x04) = fp - 0x10;
		*(esp_288 - 0x08) = 0x40;
		GetCommandLineA();
		*(esp_288 - 0x0C) = 0x00011252;
		GetLastError();
		*(esp_288 - 0x10) = 0x00401000;
		GetCommandLineA();
		VirtualProtect(*(esp_288 - 0x10), *(esp_288 - 0x0C), *(esp_288 - 0x08), *(esp_288 - 0x04));
		GetCommandLineA();
		GetCommandLineA();
		*(esp_288 - 0x04) = (union Eq_160 *) dwLoc3C;
		*(esp_288 - 0x08) = 0x00;
		*(esp_288 - 0x0C) = 0x0126;
		*(esp_288 - 0x10) = 0x03;
		*(esp_288 - 0x14) = 0x00;
		*(esp_288 - 0x18) = 0x03;
		*(esp_288 - 0x1C) = 0x40000000;
		*(esp_288 - 0x20) = 0x0042F928;
		CreateFileW(*(esp_288 - 0x20), *(esp_288 - 0x1C), *(esp_288 - 0x18), *(esp_288 - 0x14), *(esp_288 - 0x10), *(esp_288 - 0x0C), *(esp_288 - 0x08));
		GetLastError();
		*(esp_288 - 0x08) = 0x00011252;
		*(esp_288 - 0x0C) = 0x00401000;
		esp_339 = esp_288 - 0x0C;
l0041275E:
		GetCommandLineA();
		union Eq_47 * esp_92 = esp_339 - 0x04;
		*esp_92 = 0x00;
		*(esp_92 - 0x04) = 388;
		*(esp_92 - 0x08) = 0x03;
		*(esp_92 - 0x0C) = 0x00;
		*(esp_92 - 0x10) = 0x04;
		*(esp_92 - 0x14) = 0x60000000;
		*(esp_92 - 0x18) = 4389101;
		CreateFileA(*(esp_92 - 0x18), *(esp_92 - 0x14), *(esp_92 - 0x10), *(esp_92 - 0x0C), *(esp_92 - 0x08), *(esp_92 - 0x04), *esp_92);
		GetLastError();
		Eq_57 eax_115 = GetCommandLineA();
		word32 esp_122;
		word32 ebp_123;
		byte SCZO_124;
		struct Eq_2 * eax_125;
		bool Z_126;
		byte SZO_127;
		bool C_128;
		word32 ecx_129;
		word32 * edx_130;
		byte * esi_131;
		byte * edi_132;
		(dwLoc3C - 3216955433)();
		eax_133 = fn00401024(eax_125, ecx_129, edx_130, esi_131, edi_132);
	}
	return eax_133;
}

