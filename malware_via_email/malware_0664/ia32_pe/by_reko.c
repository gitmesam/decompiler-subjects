// subject.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

// 080010D7: Register DWORD Win32CrtStartup()
DWORD Win32CrtStartup()
{
	word32 edi_8 = __ror(edi, 22);
	byte al_16 = Mem0[dwArg00 - ~0x06 + 0x00:byte];
	word32 edx_20 = ~(edx | 0x266C65F3);
	word32 eax_17 = (word32) al_16;
	word16 ax_19 = DPB(ax, al_16, 0);
	word16 dx_21 = (word16) edx_20;
	byte dl_22 = (byte) edx_20;
	if (eax_17 == 0x90)
	{
		word32 edx_69;
		word32 ebx_70;
		word32 ebp_71;
		word32 esi_72;
		word32 edi_73;
		word32 ecx_74 = fn0800114D((word16) (dwArg00 - ~0x06 + ebp), edx_20, ebp, esi ^ 3499039971, edi_8 + 0x22A4B2A3, out edx_69, out ebx_70, out ebp_71, out esi_72, out edi_73);
		byte al_76 = __inb(0x00);
		word16 cx_75 = (word16) ecx_74;
		word32 eax_77 = DPB(-eax_17, al_76, 0);
		if (P)
		{
			word32 ecx_103;
			word32 edx_104;
			word32 ebx_105;
			word32 ebp_106;
			word32 esi_107;
			word32 edi_108;
			return fn08001180(eax_77, ecx_74, ebp_71, esi_72, edi_73, out ecx_103, out edx_104, out ebx_105, out ebp_106, out esi_107, out edi_108);
		}
		else
		{
			__psrld(mm6, mm0);
			Mem84[eax_77 + 0x00:byte] = Mem0[eax_77 + 0x00:byte] + al_76;
			byte v28_88 = (edx_69 + 0x17)[ebx_70 * 0x04] + dl_22;
			(edx_69 + 0x17)[ebx_70 * 0x04] = v28_88;
			__lock();
			if (OVERFLOW(v28_88))
				__syscall(0x04);
			__indw(~0x08);
			word32 ecx_93;
			word32 edx_94;
			word32 ebx_95;
			word32 ebp_96;
			word32 esi_97;
			word32 edi_98;
			real64 rArg0_99;
			return fn0800114E(cx_75, ebp_71, esi_72 + 0x04, edi_73 + 0x04, dwArg00, rArg0, out ecx_93, out edx_94, out ebx_95, out ebp_96, out esi_97, out edi_98, out rArg0_99);
		}
	}
	else
	{
		word16 ax_43 = __ror(ax_19, 0x06);
		Mem52[ebx + 0x00:word32] = Mem0[ebx + 0x00:word32] - 0x001DCFC1 - ((edi_8 + 0x22A4B2A3) - ebx <u 0x00);
		word32 eax_45 = DPB(eax_17, ax_43, 0);
		Mem54[eax_45 + 0x00:byte] = Mem52[eax_45 + 0x00:byte] + (byte) ax_43;
		Mem56[1178847361:word32] = Mem54[1178847361:word32] ^ eax_45;
		return __indw(dx_21);
	}
}

// 0800114D: Register word32 fn0800114D(Register word16 cx, Register word32 edx, Register word32 ebp, Register word32 esi, Register word32 edi, Register out ptr32 edxOut, Register out ptr32 ebxOut, Register out ptr32 ebpOut, Register out ptr32 esiOut, Register out ptr32 ediOut)
word32 fn0800114D(word16 cx, word32 edx, word32 ebp, word32 esi, word32 edi, ptr32 & edxOut, ptr32 & ebxOut, ptr32 & ebpOut, ptr32 & esiOut, ptr32 & ediOut)
{
	word32 ecx_12;
	word32 edx_13;
	word32 ebx_14;
	word32 ebp_15;
	word32 esi_16;
	word32 edi_17;
	real64 rArg0_18;
	fn0800114E(cx, ebp, esi, edi, dwArg00, rArg0, out ecx_12, out edx_13, out ebx_14, out ebp_15, out esi_16, out edi_17, out rArg0_18);
	return ecx_12;
}

// 0800114E: Register word32 fn0800114E(Register word16 cx, Register word32 ebp, Register word32 esi, Register word32 edi, Stack word32 dwArg00, FpuStack real64 rArg0, Register out ptr32 ecxOut, Register out ptr32 edxOut, Register out ptr32 ebxOut, Register out ptr32 ebpOut, Register out ptr32 esiOut, Register out ptr32 ediOut, FpuStack out ptr32 rArg0Out)
word32 fn0800114E(word16 cx, word32 ebp, word32 esi, word32 edi, word32 dwArg00, real64 rArg0, ptr32 & ecxOut, ptr32 & edxOut, ptr32 & ebxOut, ptr32 & ebpOut, ptr32 & esiOut, ptr32 & ediOut, ptr32 & rArg0Out)
{
	ptr32 fp;
	real64 rArg0;
	word32 esi;
	<type-error> Mem0;
	word32 edi;
	word16 si;
	word32 ecx;
	word32 dwArg00;
	word32 ebp;
	ptr32 ecxOut;
	ptr32 edxOut;
	ptr32 ebxOut;
	ptr32 ebpOut;
	ptr32 esiOut;
	ptr32 ediOut;
	esp_1 = fp;
	rArg0_5 = rArg0 - (real64) Mem0[(esi - 0x3F) + 0x00:word32];
	v5_6 = (Mem0[esi + 0x00:word32] & 0x0100) != 0x00;
	Mem7[esi + 0x00:word32] = __rol(Mem0[esi + 0x00:word32], 88);
	edi_9 = edi & edi;
	edx_10 = fp;
	dx_11 = (word16) edx_10;
	v10_13 = (si & 0x8000) != 0x00;
	si_14 = __rol(si, 0x01);
	eax_15 = 0xB00120C0;
	v13_16 = true;
	eax_17 = __rol(0xB00120C0, 0x04);
	ecx_20 = ecx + dwArg00;
	cx_21 = (word16) ecx_20;
	ax_22 = dx_11;
	eax_23 = DPB(eax_17, ax_22, 0);
	cx_24 = cx_21 + ~0x0D;
	edi_25 = Mem7[eax_23 + 0x00:word32];
	edx_26 = fp | 720902371;
	C_27 = false;
	ecx_28 = 0x080010A8;
	cx_29 = (word16) ecx_28;
	edx_30 = edx_26 - 0x01;
	SZO_31 = cond(edx_30);
	esi_32 = Mem7[0x080010D3:word32];
	si_33 = (word16) esi_32;
	eax_41 = fn08001182(eax_23, ecx_28, ebp, esi_32, edi_25, out ecx_35, out edx_36, out ebx_37, out ebp_38, out esi_39, out edi_40);
	ax_42 = (word16) eax_41;
	return eax_41;
}

// 08001180: Register word32 fn08001180(Register word32 eax, Register word32 ecx, Register word32 ebp, Register word32 esi, Register word32 edi, Register out ptr32 ecxOut, Register out ptr32 edxOut, Register out ptr32 ebxOut, Register out ptr32 ebpOut, Register out ptr32 esiOut, Register out ptr32 ediOut)
word32 fn08001180(word32 eax, word32 ecx, word32 ebp, word32 esi, word32 edi, ptr32 & ecxOut, ptr32 & edxOut, ptr32 & ebxOut, ptr32 & ebpOut, ptr32 & esiOut, ptr32 & ediOut)
{
	ptr32 fp;
	word32 eax;
	<type-error> Mem0;
	byte al;
	word32 ecx;
	word32 ebp;
	word32 esi;
	word32 edi;
	ptr32 ecxOut;
	ptr32 edxOut;
	ptr32 ebxOut;
	ptr32 ebpOut;
	ptr32 esiOut;
	ptr32 ediOut;
	esp_1 = fp;
	v5_5 = Mem0[eax + 0x00:byte] + al;
	Mem6[eax + 0x00:byte] = v5_5;
	SCZO_7 = cond(v5_5);
	eax_18 = fn08001182(eax, ecx, ebp, esi, edi, out ecx_12, out edx_13, out ebx_14, out ebp_15, out esi_16, out edi_17);
	al_19 = (byte) eax_18;
	return eax_18;
}

// 08001182: Register word32 fn08001182(Register word32 eax, Register word32 ecx, Register word32 ebp, Register word32 esi, Register word32 edi, Register out ptr32 ecxOut, Register out ptr32 edxOut, Register out ptr32 ebxOut, Register out ptr32 ebpOut, Register out ptr32 esiOut, Register out ptr32 ediOut)
word32 fn08001182(word32 eax, word32 ecx, word32 ebp, word32 esi, word32 edi, ptr32 & ecxOut, ptr32 & edxOut, ptr32 & ebxOut, ptr32 & ebpOut, ptr32 & esiOut, ptr32 & ediOut)
{
	ptr32 fp;
	word32 eax;
	word32 ecx;
	word32 ebp;
	word32 esi;
	word32 edi;
	ptr32 ecxOut;
	ptr32 edxOut;
	ptr32 ebxOut;
	ptr32 ebpOut;
	ptr32 esiOut;
	ptr32 ediOut;
	esp_1 = fp;
	eax_3 = eax << 0x0A;
	SCZO_4 = cond(eax_3);
	eax_15 = fn08001185(eax_3, ecx, ebp, esi, edi, out ecx_9, out edx_10, out ebx_11, out ebp_12, out esi_13, out edi_14);
	return eax_15;
}

// 08001185: Register word32 fn08001185(Register word32 eax, Register word32 ecx, Register word32 ebp, Register word32 esi, Register word32 edi, Register out ptr32 ecxOut, Register out ptr32 edxOut, Register out ptr32 ebxOut, Register out ptr32 ebpOut, Register out ptr32 esiOut, Register out ptr32 ediOut)
word32 fn08001185(word32 eax, word32 ecx, word32 ebp, word32 esi, word32 edi, ptr32 & ecxOut, ptr32 & edxOut, ptr32 & ebxOut, ptr32 & ebpOut, ptr32 & esiOut, ptr32 & ediOut)
{
	do
		edi = edi + 0x01;
	while (~Mem0[edi + 0x00:word32] + esi != 0x01);
	word32 esi_33 = -__rol(esi, 0x0D);
	word32 edx_35 = (word32) Mem0[edi - ~0x02 + 0x00:word16];
	Mem46[v3 - 0x04 + 0x00:word32] = v3;
	word32 edi_47 = Mem46[v3 - 0x04 + 0x00:word32];
	word32 esi_52 = DPB(esi_33 >> 0x0D, __rol((word16) (esi_33 >> 0x0D), 0x03), 0);
	word32 eax_55 = Mem46[edi_47 + 0x00:word32];
	__ror(esi_52, 0x03);
	word32 ebx_40;
	*ebxOut = edx_35;
	word32 edx_60 = Mem46[0x08001025:word32];
	do
	{
		eax_55 = eax_55 + 0x01;
		word32 edi_75 = Mem46[eax_55 + 0x00:word32] ^ edx_60;
	} while (edi_75 != 0x00);
	Mem87[v3 - 0x04 + 0x00:word32] = 0x07FF25D0;
	Mem92[v3 - 0x04 + 0x00:word32] = Mem87[v3 - 0x04 + 0x00:word32] + edx_35;
	word32 eax_96 = __rol(edx_35, 0x0F);
	word32 edx_98 = Mem92[fs:0x00:word32];
	Mem100[v3 - 0x08 + 0x00:word32] = edx_98;
	Mem106[fs:0x00:word32] = v3 - 0x08;
	word32 edx_108 = __rol(edx_98, 0x12);
	Mem110[v3 - 0x0C + 0x00:word32] = 0x00;
	word32 edi_118;
	*ediOut = __ror(DPB(edi_75 - 0x01, (word16) (edi_75 - 0x01) | ~0x20, 0), 0x03);
	Mem121[v3 - 0x10 + 0x00:word32] = eax_55;
	word32 ecx_111;
	*ecxOut = ~(v3 - 0x08);
	word32 edx_114;
	*edxOut = eax_55;
	word32 ebp_116;
	*ebpOut = edx_108;
	word32 esi_122;
	*esiOut = Mem121[v3 - 0x10 + 0x00:word32];
	return eax_96;
}

