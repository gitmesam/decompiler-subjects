// subject.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

// 080010D7: Register Eq_2 Win32CrtStartup()
DWORD Win32CrtStartup()
{
	up32 edi_8 = __ror(edi, 22);
	byte al_17 = *(dwArg00 - ~0x06);
	ui32 edx_21 = ~(edx | 0x266C65F3);
	word16 si_15 = (word16) (esi ^ 3499039971);
	word32 eax_18 = (word32) al_17;
	word16 ax_20 = DPB(ax, al_17, 0);
	word16 dx_22 = (word16) edx_21;
	if (eax_18 == 0x90)
	{
		int32 ebp_62;
		ptr32 esi_63;
		Eq_39 edi_64;
		word32 ecx_65 = fn0800114D((word16) (dwArg00 - ~0x06 + ebp), edx_21, ebp, si_15, edi_8 + 0x22A4B2A3, dwLoc04, dwArg00, out ebp_62, out esi_63, out edi_64);
		union Eq_39 * eax_68 = DPB(-eax_18, __inb(0x00), 0);
		if (P)
		{
			word32 ecx_71;
			word32 ebp_72;
			word32 esi_73;
			word32 edi_74;
			return fn08001180(eax_68, ecx_65, ebp_62, esi_63, edi_64, out ecx_71, out ebp_72, out esi_73, out edi_74);
		}
	}
	else
	{
		word16 ax_38 = __ror(ax_20, 0x06);
		*ebx = *ebx - 0x001DCFC1 - ((edi_8 + 0x22A4B2A3) - ebx < 0x00);
		byte * eax_40 = DPB(eax_18, ax_38, 0);
		*eax_40 = *eax_40 + (byte) ax_38;
		(ui32 *) 1178847361 = (ui32 *) 1178847361 ^ eax_40;
		return __indw(dx_22);
	}
}

// 0800114D: Register word32 fn0800114D(Register word16 cx, Register ui32 edx, Register int32 ebp, Register word16 si, Register word32 edi, Stack word32 dwArg00, Stack ptr32 dwArg04, Register out ptr32 ebpOut, Register out ptr32 esiOut, Register out ptr32 ediOut)
word32 fn0800114D(word16 cx, ui32 edx, int32 ebp, word16 si, word32 edi, word32 dwArg00, ptr32 dwArg04, ptr32 & ebpOut, ptr32 & esiOut, ptr32 & ediOut)
{
	__rol(cx, 0x06);
	__rol(si, 0x01);
	union Eq_39 * eax_26 = DPB(__rol(0xB00120C0, 0x04), (word16) (fp + 0x04), 0);
	Eq_39 edi_29 = *eax_26;
	ptr32 esi_37 = globals->ptr80010D3;
	word32 ecx_40;
	word32 ebp_41;
	word32 esi_42;
	word32 edi_43;
	fn08001180(eax_26, 0x080010A8, ebp, esi_37, edi_29, out ecx_40, out ebp_41, out esi_42, out edi_43);
	return ecx_40;
}

// 08001180: Register (ptr Eq_39) fn08001180(Register (ptr Eq_39) eax, Register word32 ecx, Register int32 ebp, Register ptr32 esi, Register Eq_39 edi, Register out ptr32 ecxOut, Register out ptr32 ebpOut, Register out ptr32 esiOut, Register out ptr32 ediOut)
Eq_39 * fn08001180(Eq_39 * eax, word32 ecx, int32 ebp, ptr32 esi, Eq_39 edi, ptr32 & ecxOut, ptr32 & ebpOut, ptr32 & esiOut, ptr32 & ediOut)
{
	*ecxOut = ecx;
	*ebpOut = ebp;
	*esiOut = esi;
	*ediOut = edi;
	*eax = (union Eq_39 *) ((char *) *eax + al);
	word32 ecx_14;
	word32 ebp_15;
	word32 esi_16;
	word32 edi_17;
	return fn08001185(eax << 0x0A, ecx, ebp, esi, edi, out ecx_14, out ebp_15, out esi_16, out edi_17);
}

// 08001185: Register (ptr Eq_39) fn08001185(Register (ptr Eq_39) eax, Register word32 ecx, Register int32 ebp, Register ptr32 esi, Register Eq_39 edi, Register out ptr32 ecxOut, Register out ptr32 ebpOut, Register out ptr32 esiOut, Register out ptr32 ediOut)
Eq_39 * fn08001185(Eq_39 * eax, word32 ecx, int32 ebp, ptr32 esi, Eq_39 edi, ptr32 & ecxOut, ptr32 & ebpOut, ptr32 & esiOut, ptr32 & ediOut)
{
	do
		edi = (word32) edi + 0x01;
	while (~*edi + esi != 0x01);
	int32 esi_33 = -__rol(esi, 0x0D);
	ptr32 edx_35 = (word32) *(edi - ~0x02);
	*(v3 - 0x04) = v3;
	struct Eq_255 ** edi_47 = *(v3 - 0x04);
	int32 esi_52 = DPB(esi_33 >> 0x0D, __rol((word16) (esi_33 >> 0x0D), 0x03), 0);
	struct Eq_255 * eax_55 = *edi_47;
	__ror(esi_52, 0x03);
	word32 edx_60 = globals->dw8001025;
	do
	{
		eax_55 = eax_55 + 0x01;
		ui32 edi_75 = eax_55->dw0000 ^ edx_60;
	} while (edi_75 != 0x00);
	*(v3 - 0x04) = 0x07FF25D0;
	*(v3 - 0x04) = *(v3 - 0x04) + edx_35;
	union Eq_39 * eax_96 = __rol(edx_35, 0x0F);
	ptr32 edx_98 = fs->ptr0000;
	*(v3 - 0x08) = edx_98;
	fs->ptr0000 = v3 - 0x08;
	union Eq_39 * edx_108 = __rol(edx_98, 0x12);
	*(v3 - 0x0C) = 0x00;
	word32 edi_117;
	*ediOut = __ror(DPB(edi_75 - 0x01, (word16) (edi_75 - 0x01) | ~0x20, 0), 0x03);
	*(v3 - 0x10) = (struct Eq_255 **) eax_55;
	word32 ecx_111;
	*ecxOut = ~(v3 - 0x08);
	word32 ebp_115;
	*ebpOut = edx_108;
	word32 esi_121;
	*esiOut = *(v3 - 0x10);
	return eax_96;
}

