// subject.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

// 08001340: void fn08001340(Stack Eq_2 dwArg04, Stack Eq_3 dwArg08, Stack Eq_3 dwArg0C)
void fn08001340(SIZE_T dwArg04, Eq_3 dwArg08, Eq_3 dwArg0C)
{
	while (true)
	{
		dwArg0C = dwArg0C - 0x01;
		if (dwArg0C == 0x00)
			break;
		dwArg04->b0000 = (byte) *dwArg08;
		dwArg04 = (Eq_2) (dwArg04 + 0x01);
		dwArg08 = (word32) dwArg08 + 0x01;
	}
}

// 08001390: void fn08001390(Stack (ptr byte) dwArg04, Stack byte bArg08, Stack word32 dwArg0C)
void fn08001390(byte * dwArg04, byte bArg08, word32 dwArg0C)
{
	while (true)
	{
		dwArg0C = dwArg0C - 0x01;
		if (dwArg0C == 0x00)
			break;
		*dwArg04 = bArg08;
		dwArg04 = dwArg04 + 0x01;
	}
}

// 080013D0: Register Eq_3 fn080013D0(Stack Eq_2 dwArg04, Register out ptr32 ebpOut)
Eq_3 fn080013D0(SIZE_T dwArg04, ptr32 & ebpOut)
{
	word32 * esp_22 = fp - 0x04;
	if (globals->t8003008 == null)
		globals->t8003008 = GetProcessHeap();
	Eq_3 eax_21;
	if (globals->t8003008 != null)
	{
		esp_22 = fp - 0x10;
		eax_21 = HeapAlloc(globals->t8003008, 0x00, dwArg04);
	}
	else
		eax_21.u0 = 0x00;
	word32 ebp_23;
	*ebpOut = *esp_22;
	return eax_21;
}

// 08001420: Register word32 fn08001420(Stack Eq_3 dwArg04)
word32 fn08001420(Eq_3 dwArg04)
{
	word32 * esp_21 = fp - 0x04;
	if (globals->t8003008 != null)
	{
		HeapFree(globals->t8003008, 0x00, dwArg04);
		esp_21 = fp - 0x10;
	}
	return *esp_21;
}

// 08001450: Register Eq_3 fn08001450(Register word32 ebx, Register Eq_95 ebp, Register word32 esi, Register word32 edi, Register (ptr Eq_98) es, Register (ptr Eq_99) ds, Register out ptr32 edxOut)
Eq_3 fn08001450(word32 ebx, LPCSTR ebp, word32 esi, word32 edi, Eq_98 * es, Eq_99 * ds, ptr32 & edxOut)
{
	ui32 eax_11 = globals->dw8003000 ^ fp - (CHAR *) 0x04;
	fn08001390(fp - 0x0170, 0x00, 0x40);
	lstrcpyA(fp - 636, GetCommandLineA());
	Eq_125 dwLoc0128_133 = fp - 636;
	Eq_128 edx_100;
	*edxOut = fp - 636;
	Eq_131 esp_128 = fp - 644;
	if ((int32) bLoc027C == 0x22)
	{
		(&(&(&(&(&(&(&(&(&(&(&(&(&(&(&(&(&(&(&(fp - 0x027E)[lstrlenA(fp - (CHAR *) 636)].a0000)[0x00].a0000)[0x00].a0000)[0x00].a0000)[0x00].a0000)[0x00].a0000)[0x00].a0000)[0x00].a0000)[0x00].a0000)[0x00].a0000)[0x00].a0000)[0x00].a0000)[0x00].a0000)[0x00].a0000)[0x00].a0000)[0x00].a0000)[0x00].a0000)[0x00].a0000)[0x00].a0000)[0x00] = (Eq_175) 0x00;
		esp_128 = fp - (CHAR *) 0x0288;
		*edxOut = fp - (CHAR *) 0x027B;
		dwLoc0128_133 = fp - (CHAR *) 0x027B;
	}
	union Eq_3 * esp_42 = esp_128 - 0x04;
	*esp_42 = 0x0104;
	*(esp_42 - 0x04) = (LPCSTR *) dwLoc0128_133;
	*(esp_42 - 0x08) = (LPCSTR *) dwLoc0128_133;
	if (GetShortPathNameA(*(esp_42 - 0x08), *(esp_42 - 0x04), *esp_42) == 0x00)
		return fn08001FF8(0x00, eax_11 ^ fp - (CHAR *) 0x04, edx_100, ebx, fp - (CHAR *) 0x04, esi, edi, es, ds, ebp);
	*(esp_42 - 0x0C) = 0x080010DC;
	*(esp_42 - 0x10) = (LPCSTR *) (fp - (CHAR *) 0x0114);
	lstrcpyA(*(esp_42 - 0x10), *(esp_42 - 0x0C));
	*(esp_42 - 0x14) = (LPCSTR *) dwLoc0128_133;
	*(esp_42 - 0x18) = (LPCSTR *) (fp - (CHAR *) 0x0114);
	lstrcatA(*(esp_42 - 0x18), *(esp_42 - 0x14));
	*(esp_42 - 0x1C) = 0x080010D4;
	*(esp_42 - 0x20) = (LPCSTR *) (fp - (CHAR *) 0x0114);
	lstrcatA(*(esp_42 - 0x20), *(esp_42 - 0x1C));
	*(esp_42 - 0x24) = 0x0104;
	*(esp_42 - 0x28) = (LPCSTR *) dwLoc0128_133;
	*(esp_42 - 44) = 0x080010CC;
	GetEnvironmentVariableA(*(esp_42 - 44), *(esp_42 - 0x28), *(esp_42 - 0x24));
	*(esp_42 - 0x30) = (LPCSTR *) (fp - (CHAR *) 292);
	*(esp_42 - 0x34) = (LPCSTR *) (fp - (CHAR *) 0x0174);
	*(esp_42 - 0x38) = 0x00;
	*(esp_42 - 0x3C) = 0x00;
	*(esp_42 - 0x40) = 0x08000000;
	*(esp_42 - 0x44) = 0x00;
	*(esp_42 - 0x48) = 0x00;
	*(esp_42 - 0x4C) = 0x00;
	*(esp_42 - 0x50) = (LPCSTR *) (fp - (CHAR *) 0x0114);
	*(esp_42 - 0x54) = (LPCSTR *) dwLoc0128_133;
	*edxOut = fp - (CHAR *) 0x0174;
	if (CreateProcessA(*(esp_42 - 0x54), *(esp_42 - 0x50), *(esp_42 - 0x4C), *(esp_42 - 0x48), *(esp_42 - 0x44), *(esp_42 - 0x40), *(esp_42 - 0x3C), *(esp_42 - 0x38), *(esp_42 - 0x34), *(esp_42 - 0x30)) == 0x00)
		return fn08001FF8(0x00, eax_11 ^ fp - (CHAR *) 0x04, edx_100, ebx, fp - (CHAR *) 0x04, esi, edi, es, ds, ebp);
	*(esp_42 - 88) = 0x00;
	ExitProcess(*(esp_42 - 88));
}

// 080015A0: Register word32 fn080015A0(Register Eq_95 ebp, Stack Eq_3 dwArg04, Stack Eq_3 dwArg08, Stack Eq_3 dwArg0C, Stack (ptr Eq_3) dwArg10)
word32 fn080015A0(LPCSTR ebp, Eq_3 dwArg04, Eq_3 dwArg08, Eq_3 dwArg0C, Eq_3 * dwArg10)
{
	ptr32 ebp_44 = fp - 0x04;
	ptr32 esp_111 = fp - 0x18;
	Eq_475 dwLoc08_10 = null;
	if (dwArg08 != 0x00)
	{
		esp_111 = fp - 0x24;
		dwLoc08_10 = FindResourceA(dwArg04, (word32) wArg08, 0x080010E4);
	}
	else if (dwArg0C != 0x00)
	{
		esp_111 = fp - 0x24;
		dwLoc08_10 = FindResourceA(dwArg04, dwArg0C, 0x080010E4);
	}
	HRSRC * esp_20 = esp_111 - 0x04;
	*esp_20 = (HRSRC *) dwLoc08_10;
	*(esp_20 - 0x04) = (union Eq_3 *) dwArg04;
	Eq_503 eax_26 = LoadResource(*(esp_20 - 0x04), *esp_20);
	*(esp_20 - 0x08) = (HRSRC *) dwLoc08_10;
	*(esp_20 - 0x0C) = (union Eq_3 *) dwArg04;
	Eq_3 eax_34 = SizeofResource(*(esp_20 - 0x0C), *(esp_20 - 0x08));
	if (eax_26 != null)
	{
		*(esp_20 - 0x10) = (HGLOBAL *) eax_26;
		if (LockResource(*(esp_20 - 0x10)) != 0x00)
		{
			*dwArg10 = (union Eq_3 *) eax_34;
			*(esp_20 - 0x14) = (union Eq_3 *) eax_34;
			word32 eax_74 = fn080013D0(dwArg00, out ebp_44);
			*(ebp_44 - 0x0C) = eax_74;
			*(esp_20 - 0x14) = *(ebp_44 - 0x08);
			*(esp_20 - 0x18) = *(ebp_44 - 0x14);
			*(esp_20 - 0x1C) = *(ebp_44 - 0x0C);
			fn08001340(dwArg00, dwArg04, dwArg08);
		}
		ptr32 esp_60 = esp_111 - 0x14;
		*(esp_60 - 0x04) = *(ebp_44 - 0x10);
		FreeResource(*(esp_60 - 0x04));
	}
	return *(ebp_44 - 0x0C);
}

// 08001670: Register word32 fn08001670(Stack Eq_3 dwArg04, Stack Eq_3 dwArg08, Stack Eq_3 dwArg0C)
word32 fn08001670(Eq_3 dwArg04, Eq_3 dwArg08, Eq_3 dwArg0C)
{
	word32 eax_108;
	if (dwArg08 != 0x00 && dwArg0C != 0x00)
	{
		Eq_39 eax_85 = CreateFileA(dwArg04, 0x40000000, 0x00, null, 0x02, 0x80, null);
		if (eax_85 != (void *) ~0x00)
		{
			WriteFile(eax_85, dwArg08, dwArg0C, fp + 0x0C, null);
			CloseHandle(eax_85);
			eax_108 = 0x01;
			return eax_108;
		}
	}
	eax_108 = 0x00;
	return eax_108;
}

// 080016E0: Register word16 fn080016E0()
word16 fn080016E0()
{
	QueryPerformanceCounter(fp - 0x0C);
	return (word16) dwLoc0C;
}

// 08001700: Register Eq_3 fn08001700(Stack Eq_3 dwArg04, Stack Eq_3 dwArg08)
Eq_3 fn08001700(Eq_3 dwArg04, Eq_3 dwArg08)
{
	*dwArg08 = (byte) ((int32) ((int64) (word32) fn080016E0() % 0x19) + 0x41);
	*((word32) dwArg08 + 0x01) = (byte) ((int32) ((int64) (word32) fn080016E0() % 0x19) + 0x61);
	*((word32) dwArg08 + 0x02) = (byte) ((int32) ((int64) (word32) fn080016E0() % 0x19) + 0x61);
	*((word32) dwArg08 + 0x03) = (byte) ((int32) ((int64) (word32) fn080016E0() % 0x09) + 0x30);
	*((word32) dwArg08 + 0x04) = (byte) ((int32) ((int64) (word32) fn080016E0() % 0x09) + 0x30);
	*((word32) dwArg08 + 0x05) = 0x00;
	GetEnvironmentVariableA(0x08001104, dwArg04, 0x0104);
	lstrcatA(dwArg04, 0x080010F0);
	lstrcatA(dwArg04, dwArg08);
	lstrcatA(dwArg04, 0x080010E8);
	return dwArg04;
}

// 080017E0: Register Eq_3 fn080017E0(Stack Eq_3 dwArg04)
Eq_3 fn080017E0(Eq_3 dwArg04)
{
	GetEnvironmentVariableA(0x08001104, dwArg04, 0x0104);
	lstrcatA(dwArg04, 0x08001110);
	return dwArg04;
}

// 08001820: void fn08001820(Stack Eq_3 dwArg04, Stack Eq_3 dwArg08)
void fn08001820(Eq_3 dwArg04, Eq_3 dwArg08)
{
	Eq_793 eax_16 = OpenSCManagerA(0x00, 0x00, 0x000F003F);
	Eq_793 eax_27 = OpenServiceA(eax_16, dwArg08, 0x000F01FF);
	ptr32 esp_135 = fp - 44;
	Eq_793 dwLoc08_138 = eax_27;
	if (eax_27 == null)
	{
		esp_135 = fp - 0x60;
		dwLoc08_138 = CreateServiceA(eax_16, dwArg08, 0x00, 0x000F01FF, 0x01, 0x03, 0x00, dwArg04, 0x00, null, 0x00, 0x00, 0x00);
	}
	if (dwLoc08_138 != null)
	{
		LPCSTR ** esp_94 = esp_135 - 0x04;
		*esp_94 = (LPCSTR **) null;
		*(esp_94 - 0x04) = 0x00;
		*(esp_94 - 0x08) = (SC_HANDLE *) dwLoc08_138;
		esp_135 = esp_94 - 0x08;
		if (StartServiceA(*(esp_94 - 0x08), *(esp_94 - 0x04), *esp_94) != 0x00)
		{
l080018CC:
			if (dwLoc08_138 != null)
			{
				SC_HANDLE * esp_81 = esp_135 - 0x04;
				*esp_81 = (SC_HANDLE *) dwLoc08_138;
				CloseServiceHandle(*esp_81);
			}
			return;
		}
	}
	goto l080018CC;
}

// 080018F0: void fn080018F0(Register word32 ebx, Register word32 esi, Register word32 edi, Register (ptr Eq_98) es, Register (ptr Eq_99) ds, Stack Eq_3 dwArg04)
void fn080018F0(word32 ebx, word32 esi, word32 edi, Eq_98 * es, Eq_99 * ds, Eq_3 dwArg04)
{
	ui32 eax_11 = globals->dw8003000 ^ fp - 0x04;
	lstrcpyA(fp - 0x020C, 0x08001164);
	lstrcatA(fp - 0x020C, dwArg04);
	lstrcatA(fp - 0x020C, 0x080010E8);
	lstrcpyA(fp - 0x010C, 0x08001130);
	lstrcatA(fp - 0x010C, dwArg04);
	lstrcatA(fp - 0x010C, 0x080010E8);
	RegCreateKeyA((struct HKEY__ *) 0x80000002, fp - 0x020C, fp - 0x0210);
	RegSetValueA(dwLoc0210, 0x00, 0x01, 0x08001128, 0x08);
	RegCloseKey(dwLoc0210);
	RegCreateKeyA((struct HKEY__ *) 0x80000002, fp - 0x010C, fp - 0x0210);
	RegSetValueA(dwLoc0210, 0x00, 0x01, 0x08001128, 0x08);
	fn08001FF8(RegCloseKey(dwLoc0210), eax_11 ^ fp - 0x04, dwLoc0210, ebx, fp - 0x04, esi, edi, es, ds, dwLoc028C);
}

// 08001A00: void fn08001A00(Register word32 ebx, Register word32 esi, Register word32 edi, Register (ptr Eq_98) es, Register (ptr Eq_99) ds, Stack Eq_3 dwArg04, Stack Eq_3 dwArg08)
void fn08001A00(word32 ebx, word32 esi, word32 edi, Eq_98 * es, Eq_99 * ds, Eq_3 dwArg04, Eq_3 dwArg08)
{
	ui32 eax_11 = globals->dw8003000 ^ fp - 0x04;
	lstrcpyA(fp - 0x020C, dwArg08);
	lstrcatA(fp - 0x020C, dwArg04);
	RegCreateKeyA((struct HKEY__ *) 0x80000002, fp - 0x020C, fp - 0x0210);
	RegSetValueExA(dwLoc0210, 134222292, 0x00, 0x04, fp - 0x0318, 0x04);
	RegSetValueExA(dwLoc0210, 0x080011CC, 0x00, 0x04, fp - 0x08, 0x04);
	lstrcpyA(fp - 788, 0x080011B8);
	lstrcatA(fp - 788, dwArg04);
	lstrcatA(fp - 788, 0x080010E8);
	RegSetValueExA(dwLoc0210, 134222252, 0x00, 0x01, fp - 788, lstrlenA(fp - 788) + 0x01);
	fn08001390(fp - 0x0101, 0x00, 0xF5);
	RegSetValueExA(dwLoc0210, 134222232, 0x00, 0x01, fp - 0x010C, lstrlenA(fp - 0x010C) + 0x01);
	fn08001FF8(RegCloseKey(dwLoc0210), eax_11 ^ fp - 0x04, fp - 0x010C, ebx, fp - 0x04, esi, edi, es, ds, dwLoc03BC);
}

// 08001BA0: void fn08001BA0()
void fn08001BA0()
{
	RegCreateKeyA((struct HKEY__ *) 0x80000002, 0x08001210, fp - 0x0C);
	RegSetValueExA(dwLoc0C, 0x08001204, 0x00, 0x01, &globals->t800126C, lstrlenA(134222444) + 0x01);
	RegSetValueExA(dwLoc0C, 0x080011F8, 0x00, 0x01, &globals->t8001258, lstrlenA(134222424) + 0x01);
	RegSetValueExA(dwLoc0C, 0x080011EC, 0x00, 0x04, fp - 0x08, 0x04);
	RegSetValueExA(dwLoc0C, 0x080011DC, 0x00, 0x04, fp - 0x18, 0x04);
	RegCloseKey(dwLoc0C);
}

// 08001C70: Register Eq_39 fn08001C70()
HANDLE fn08001C70()
{
	return CreateFileA(0x08001278, 0xC0000000, 0x00, null, 0x02, 0x80, null);
}

// 08001CA0: Register Eq_3 Win32CrtStartup()
Eq_3 Win32CrtStartup()
{
	GetModuleHandleA(0x00);
	GetVersionExA(fp - 0x03CC);
	word32 edi_143 = edi;
	if (dwLoc03C8 != 0x05 || dwLoc03C4 != 0x00)
		;
	if (dwLoc03C8 != 0x05 || dwLoc03C4 != 0x01)
		;
	if (dwLoc03C8 != 0x05 || dwLoc03C4 != 0x02)
		;
	word32 ebp_41 = fn080017E0(fp - 0x011C);
	*(fp - 0x0410) = ebp_41 - 0x0220;
	*(fp - 0x0414) = ebp_41 - 0x0330;
	Eq_95 ebp_116 = fn08001700(dwArg00, dwArg04);
	if (*(ebp_116 - 0x04) != 0x00 || (*(ebp_116 - 0x0224) != 0x00 || *(ebp_116 - 0x08) != 0x00))
	{
		ptr32 esp_107;
		*(fp - 0x0410) = ebp_116 - 0x03D0;
		*(fp - 0x0414) = 0x00;
		*(fp - 0x0418) = 101;
		*(fp - 0x041C) = *(ebp_116 - 0x0228);
		*(ebp_116 - 0x03CC) = fn080015A0(ebp_116, dwArg00, dwArg04, dwArg08, dwArg0C);
		*(fp - 0x0410) = ebp_116 - 0x03D4;
		*(fp - 0x0414) = 0x00;
		*(fp - 0x0418) = 0x66;
		*(fp - 0x041C) = *(ebp_116 - 0x0228);
		*(ebp_116 - 988) = fn080015A0(ebp_116, dwArg00, dwArg04, dwArg08, dwArg0C);
		*(ebp_116 - 0x03D8) = 0x00;
		(word32 *) 0x08000E98 = fn08001C70();
		if ((word32 *) 0x08000E98 != ~0x00)
		{
			*(fp - 0x0410) = 0x00;
			*(fp - 0x0414) = 0x08000E94;
			*(fp - 0x0418) = 0x00;
			*(fp - 0x041C) = 0x00;
			*(fp - 0x0420) = (word32 *) 0x08000EA8;
			*(fp - 0x0424) = (union Eq_3 *) 0x08000EAC;
			*(fp - 0x0428) = 0x9D082440;
			*(fp - 0x042C) = (word32 *) 0x08000E98;
			DeviceIoControl(*(fp - 0x042C), *(fp - 0x0428), *(fp - 0x0424), *(fp - 0x0420), *(fp - 0x041C), *(fp - 0x0418), *(fp - 0x0414), *(fp - 0x0410));
			*(fp - 0x0430) = 0x00;
			*(fp - 0x0434) = 0x08000E94;
			*(fp - 1080) = 0x00;
			*(fp - 0x043C) = 0x00;
			*(fp - 0x0440) = (word32 *) 0x08000EA4;
			*(fp - 0x0444) = (word32 *) 0x08000E9C;
			*(fp - 0x0448) = 0x9D082444;
			*(fp - 1100) = (word32 *) 0x08000E98;
			DeviceIoControl(*(fp - 1100), *(fp - 0x0448), *(fp - 0x0444), *(fp - 0x0440), *(fp - 0x043C), *(fp - 1080), *(fp - 0x0434), *(fp - 0x0430));
			*(fp - 0x0450) = (word32 *) 0x08000E98;
			CloseHandle(*(fp - 0x0450));
			esp_107 = fp - 0x0450;
		}
		else
		{
			*(fp - 0x0410) = (word32 *) 0x08000EA4;
			*(fp - 0x0414) = (word32 *) 0x08000E9C;
			*(fp - 0x0418) = 0x08001160;
			if (fn08001670(dwArg00, dwArg04, dwArg08) == 0x01)
				(word32 *) 0x08000EA0 = 0x01;
			*(fp - 0x0410) = (word32 *) 0x08000EA8;
			*(fp - 0x0414) = (union Eq_3 *) 0x08000EAC;
			*(fp - 0x0418) = 0x08000F48;
			fn08001670(dwArg00, dwArg04, dwArg08);
			fn08001BA0();
			*(fp - 0x0410) = 0x08001058;
			fn080018F0(ebx, esi, edi, es, ds, dwArg00);
			*(fp - 0x0410) = 0x08001058;
			*(fp - 0x0414) = 0x08000F48;
			fn08001820(dwArg00, dwArg04);
			*(fp - 0x0410) = 500;
			Sleep(*(fp - 0x0410));
			*(fp - 0x0414) = 0x080012A8;
			*(fp - 0x0418) = 0x08001058;
			fn08001A00(ebx, esi, edi, es, ds, dwArg00, dwArg04);
			*(fp - 0x0414) = 0x08001288;
			*(fp - 0x0418) = 0x08001058;
			fn08001A00(ebx, esi, edi, es, ds, dwArg00, dwArg04);
			*(fp - 0x0414) = 500;
			Sleep(*(fp - 0x0414));
			(word32 *) 0x08000E90 = fn08001C70();
			esp_107 = fp - 0x0414;
			if ((word32 *) 0x08000E90 != ~0x00)
			{
				*(fp - 0x0418) = 0x00;
				*(fp - 0x041C) = 0x08000E8C;
				*(fp - 0x0420) = 0x00;
				*(fp - 0x0424) = 0x00;
				*(fp - 0x0428) = (word32 *) 0x08000EA4;
				*(fp - 0x042C) = (word32 *) 0x08000E9C;
				*(fp - 0x0430) = 0x9D082444;
				*(fp - 0x0434) = (word32 *) 0x08000E90;
				DeviceIoControl(*(fp - 0x0434), *(fp - 0x0430), *(fp - 0x042C), *(fp - 0x0428), *(fp - 0x0424), *(fp - 0x0420), *(fp - 0x041C), *(fp - 0x0418));
				*(fp - 1080) = 0x00;
				*(fp - 0x043C) = 0x08000E8C;
				*(fp - 0x0440) = 0x00;
				*(fp - 0x0444) = 0x00;
				*(fp - 0x0448) = 0x00;
				*(fp - 1100) = 0x00;
				*(fp - 0x0450) = 2634556544;
				*(fp - 0x0454) = (word32 *) 0x08000E90;
				DeviceIoControl(*(fp - 0x0454), *(fp - 0x0450), *(fp - 1100), *(fp - 0x0448), *(fp - 0x0444), *(fp - 0x0440), *(fp - 0x043C), *(fp - 1080));
				*(fp - 1112) = (word32 *) 0x08000E90;
				CloseHandle(*(fp - 1112));
				esp_107 = fp - 1112;
			}
		}
		union Eq_3 * esp_109 = esp_107 - 0x04;
		*esp_109 = (union Eq_3 *) 0x08000EAC;
		*esp_109 = *(fn08001420(dwArg00) - 988);
		ebp_116 = fn08001420(dwArg00);
		if (*(ebp_116 - 0x03D8) != 0x00)
		{
			*esp_109 = (union Eq_3 *) (ebp_116 - 0x0118);
			*(ebp_116 - 0x03F0) = (union Eq_3 *) LoadLibraryA(*esp_109);
			if (*(ebp_116 - 0x03F0) != 0x00)
			{
				*(esp_109 - 0x04) = 0x08001284;
				word32 edx_133 = *(ebp_116 - 0x03F0);
				*(esp_109 - 0x08) = edx_133;
				Eq_1650 eax_136 = GetProcAddress(*(esp_109 - 0x08), *(esp_109 - 0x04));
				*(ebp_116 - 1012) = (FARPROC *) eax_136;
				if (*(ebp_116 - 1012) != 0x00)
				{
					word32 esp_142;
					byte SCZO_145;
					word32 eax_146;
					byte SZO_147;
					byte C_148;
					byte Z_149;
					word32 ecx_150;
					word32 edx_151;
					(*(ebp_116 - 1012))();
				}
			}
		}
	}
	Eq_128 edx_63;
	Eq_90 eax_64 = fn08001450(ebx, ebp_116, esi, edi_143, es, ds, out edx_63);
	return fn08001FF8(eax_64, *(ebp_116 - 0x0C) ^ ebp_116, edx_63, ebx, ebp_116, esi, edi_143, es, ds, ebp);
}

// 08001FF8: Register Eq_90 fn08001FF8(Register Eq_90 eax, Register ui32 ecx, Register Eq_128 edx, Register word32 ebx, Register Eq_95 ebp, Register word32 esi, Register word32 edi, Register (ptr Eq_98) es, Register (ptr Eq_99) ds, Stack Eq_95 dwArg00)
Eq_90 fn08001FF8(Eq_90 eax, ui32 ecx, HKEY edx, word32 ebx, LPCSTR ebp, word32 esi, word32 edi, Eq_98 * es, Eq_99 * ds, LPCSTR dwArg00)
{
	if (ecx == globals->dw8003000)
		return eax;
	globals->t8003110 = eax;
	globals->dw800310C = ecx;
	globals->t8003108 = edx;
	globals->dw8003104 = ebx;
	globals->dw8003100 = esi;
	globals->dw80030FC = edi;
	globals->ptr8003128 = ss;
	globals->ptr800311C = cs;
	globals->ptr80030F8 = ds;
	globals->ptr80030F4 = es;
	globals->ptr80030F0 = fs;
	globals->ptr80030EC = gs;
	globals->t8003120 = cond(fp - 0x0324);
	globals->ptr8003124 = fp + 0x04;
	globals->t8003118 = dwArg00;
	globals->dw8003060 = 0x00010001;
	globals->t800301C = dwArg00;
	globals->t8003114 = ebp;
	globals->dw8003010 = 0xC0000409;
	globals->dw8003014 = 0x01;
	SetUnhandledExceptionFilter(null);
	UnhandledExceptionFilter(&globals->t80012C8);
	return TerminateProcess(GetCurrentProcess(), 0xC0000409);
}

