// subject.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

// 00401020: Register Eq_2 Win32CrtStartup()
DWORD Win32CrtStartup()
{
	fn00401260();
	ui32 eax_17 = (dwLoc20 << 0x0E) + 0x000A5020;
	Eq_271 ecx_20[] = (eax_17 & 0xFFFF0000) + 4294865484;
	Mem27[fp - 0xEB + dwLoc20:word32] = ecx_20[dwLoc20 * 0x0200] - 0x28;
	Eq_27 eax_31 = (eax_17 & 0xFFFF0000) + *(&(ecx_20 + (dwLoc20 << 0x09) / 0x0200)->dw0000 - 0x04) + 0xFF - dwLoc20;
	VirtualProtect(eax_31, dwLoc14, 0x04, fp - 0x08);
	fn004011F0(eax_31, dwLoc14, dwLoc20);
	word32 ebx_63 = Mem27[eax_31 + 0x0113 - dwLoc20 + 0x00:word32] + eax_31;
	byte dl_65 = ebx_63->b0006;
	Eq_27 eax_85 = VirtualAlloc(ebx_63->t0034, *((char *) &ebx_63->t0034 + 0x0D8C - ((dwLoc20 << 0x05) >> 0x01)), 0x3000, (dwLoc20 << 0x05) + ~0x1A9F);
	fn00401240(Mem27[ebx_63 + 299 - dwLoc20 + 0x00:word32], eax_31, eax_85);
	word32 dwLoc1C_102 = (word32) dl_65;
	struct Eq_109 * esi_101 = (char *) &ebx_63->t0034 + 0x00C4;
	do
	{
		fn00401240(esi_101->dw0010, eax_31 + Mem27[esi_101 + 0x14:word32], eax_85 + Mem27[esi_101 + 0x0C:word32]);
		word32 v23_121 = dwLoc1C_102 - 0x01;
		esi_101 = esi_101 + 0x01;
		dwLoc1C_102 = v23_121;
	} while (v23_121 != 0x00);
	Mem131[fp + 0xD7 - dwLoc20 + 0x00:word32] = Mem27[ebx_63 - 0xAF + dwLoc20:word32] + eax_85;
	word32 esp_151;
	word32 ebp_152;
	byte SCZO_153;
	word32 eax_154;
	word32 ecx_155;
	word32 edx_156;
	byte SZO_157;
	bool C_158;
	word32 ebx_159;
	word32 esi_160;
	byte dl_161;
	bool Z_162;
	fn003FDC80();
	fn004011F0(fp - 88, 0x38, dwLoc20);
	Eq_27 eax_177 = eax_85;
	do
		eax_177 = eax_177 + 0x01;
	while (Mem131[eax_177 + 0x00:word32] != dwLoc20 + 0xAABBCC06);
	*(fp - 0x68) = (union Eq_27 *) eax_177;
	Mem187[fp - 0x6C + 0x00:word32] = fp - 303 + dwLoc20;
	*(fp - (ptr32 *) 0x70) = 0x010F - dwLoc20;
	return fn00401240(dwArg00, dwArg04, dwArg08);
}

// 004011F0: void fn004011F0(Stack Eq_27 dwArg04, Stack Eq_44 dwArg08, Stack Eq_7 dwArg0C)
void fn004011F0(Eq_27 dwArg04, Eq_44 dwArg08, Eq_7 dwArg0C)
{
	Eq_27 ebx_26 = dwArg04;
	Eq_44 ecx_10 = dwArg08;
	word32 eax_16 = (word32) dwArg0C + 311805790;
	word32 dwLoc08_22 = 0x01;
	while (true)
	{
		*ebx_26 = *ebx_26 ^ eax_16;
		ecx_10 = ecx_10 - 0x04;
		if (ecx_10 <= 0x00)
			break;
		eax_16 = eax_16 + 891907372 + dwLoc08_22;
		ebx_26 = (word32) ebx_26 + 0x00DB - dwArg0C;
		dwLoc08_22 = -*(fp - 0x08);
	}
}

// 00401240: Register word32 fn00401240(Stack word32 dwArg04, Stack Eq_27 dwArg08, Stack Eq_27 dwArg0C)
word32 fn00401240(word32 dwArg04, Eq_27 dwArg08, Eq_27 dwArg0C)
{
	Eq_27 edi_13 = dwArg0C;
	Eq_27 esi_15 = dwArg08;
	word32 ecx_17 = dwArg04;
	do
	{
		byte al_24 = *esi_15;
		*edi_13 = al_24;
		eax = DPB(eax, al_24, 0);
		esi_15 = (word32) esi_15 + 0x01;
		edi_13 = (word32) edi_13 + 0x01;
		ecx_17 = ecx_17 - 0x01;
	} while (ecx_17 != 0x00);
	return eax;
}

// 00401260: void fn00401260()
void fn00401260()
{
	struct Eq_247 * esp_9;
	uint32 eax_10;
	byte SCZO_11;
	byte SZO_12;
	word32 edx_13;
	bool C_14;
	word32 ecx_15;
	((<anonymous> **) 0x7FFE0300)();
	*esp_9->ptr0004 = (eax_10 & 0x0F) + ((eax_10 >> 0x18) + 0x10) - 0x01;
}

