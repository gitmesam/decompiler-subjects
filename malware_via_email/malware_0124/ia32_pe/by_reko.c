// subject.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

// 00401030: Register DWORD Win32CrtStartup()
DWORD Win32CrtStartup()
{
	word32 edi_13;
	word32 edx_14 = fn00401140(out edi_13);
	Mem18[fp + 303975 - edx_14 + 0x40:word32] = edx_14;
	word32 eax_25 = (edx_14 << 0x09) + 0xF6F88230 & 155618816 - (edx_14 << 0x09);
	word32 edx_34 = fp + ~0x0004A3DA + dwLoc20;
	Mem35[edx_34 + 0x00:word32] = (eax_25 + 3983606860)[edx_14 * 0x0400] - 0x28;
	word32 eax_39 = eax_25 + Mem35[(((eax_25 + 3983606860) + (edx_14 << 0x0A)) - 0x04) + 0x00:word32] + 304111 - dwLoc20;
	fn00401250(dwLoc20);
	word32 ecx_56 = Mem35[fp + 4294663193 + dwLoc20:word32];
	fn00401180(ecx_56, edi_13, dwLoc70);
	word32 esp_71;
	word32 edi_72;
	word32 ebp_73;
	byte SCZO_74;
	word32 edx_75;
	word32 ecx_76;
	word32 eax_77;
	word32 ebx_78;
	byte SZO_79;
	bool C_80;
	word32 esi_81;
	(dwLoc20 + 3894553)();
	Mem89[esp_71 - 0x04 + 0x00:word32] = 0x00;
	word32 v17_86 = eax_39 + 304119 - dwLoc20;
	Mem94[esp_71 - 0x08 + 0x00:word32] = v17_86 + 0x0BCA;
	word32 esp_95;
	word32 edi_96;
	word32 ebp_97;
	byte SCZO_98;
	word32 edx_99;
	word32 ecx_100;
	word32 eax_101;
	word32 ebx_102;
	byte SZO_103;
	bool C_104;
	word32 esi_105;
	v17_86();
	int3();
	Mem107[esp_95 - 0x04 + 0x00:word32] = fp - 0x04;
	word32 edx_111 = Mem107[esp_95 + 0x0C:word32];
	word32 ecx_113 = Mem107[esp_95 + 4294663233 + edx_111:word32];
	word32 ebx_116 = (esp_95 + ~0x00128F17)[edx_111 * 0x04];
	Mem118[esp_95 - 0x10 + 0x00:word32] = 323605826;
	word32 eax_121 = Mem118[esp_95 - 0x10 + 0x00:word32] - (edx_111 << 0x02);
	Mem123[esp_95 - 0x10 + 0x00:word32] = 0x0F1F3124;
	Mem124[esp_95 - 0x08 + 0x00:word32] = 0x01;
	Mem125[esp_95 - 0x0C + 0x00:word32] = Mem124[esp_95 - 0x10 + 0x00:word32];
	Mem128[esp_95 - 0x0C + 0x00:word32] = Mem125[esp_95 - 0x0C + 0x00:word32] + (edx_111 << 0x02);
	while (true)
	{
		Mem135[ebx_116 + 0x00:word32] = Mem128[ebx_116 + 0x00:word32] ^ eax_121;
		ecx_113 = ecx_113 - 0x04;
		if (ecx_113 <= 0x00)
			break;
		eax_121 = eax_121 + Mem135[(esp_95 - 0x0C) + 0x00:word32] + Mem135[(esp_95 - 0x08) + 0x00:word32];
		ebx_116 = ebx_116 + 304075 - Mem135[esp_95 + 0x0C:word32];
		Mem145[esp_95 - 0x08 + 0x00:word32] = -Mem135[esp_95 - 0x08 + 0x00:word32];
	}
	return eax_121;
}

// 00401140: Register word32 fn00401140(Register out ptr32 ediOut)
word32 fn00401140(ptr32 & ediOut)
{
	word32 edi_5;
	word32 eax_14 = fn00401230(0x19, out edi_5) + 0x01 + CreateEventW;
	word32 esp_21;
	word32 eax_22;
	word32 edx_23;
	byte SZO_24;
	byte SCZO_25;
	word32 ebx_26;
	word32 edi_27;
	eax_14();
	word32 edx_32 = Mem0[edi_27 + 3060:word32];
	word32 edi_34;
	*ediOut = edi_27 - (edx_32 - 3220921489);
	return edx_32 - 3220921489;
}

// 00401180: void fn00401180(Register word32 ecx, Register word32 edi, Stack word32 dwArg00)
void fn00401180(word32 ecx, word32 edi, word32 dwArg00)
{
	word32 eax_4 = fn00401190(ecx, edi);
	fn004011B0(eax_4, ecx);
	word32 esp_8;
	word32 ebx_9;
	word32 eax_10;
	word32 ecx_11;
	word32 edi_12;
	eax_4();
	Mem14[esp_8 - 0x04 + 0x00:word32] = ebx_9;
}

// 00401190: Register word32 fn00401190(Register word32 ecx, Register word32 edi)
word32 fn00401190(word32 ecx, word32 edi)
{
	return Mem0[Mem0[Mem0[Mem0[Mem0[edi + 0x30 + ecx:word32] + 0x0C:word32] + 0x1C:word32] + 0x00:word32] + 0x08:word32];
}

// 004011B0: void fn004011B0(Register word32 eax, Register word32 ecx)
void fn004011B0(word32 eax, word32 ecx)
{
	word32 esi_24 = Mem0[Mem0[Mem0[eax + ((ecx << 0x01) + ~0x0004A38A) - ecx + 0x00:word32] + eax + 0x78:word32] + eax + 0x20:word32] + eax;
	Mem32[fp + 304063 - ecx + 0x00:word32] = 1443174442 - ecx;
	word32 dwLoc0C_36 = 0x00;
	while (dwLoc08 != Mem32[((Mem32[esi_24 + dwLoc0C_36:word32] + eax) + ~0x0004A3BA) + ecx:word32])
		dwLoc0C_36 = dwLoc0C_36 + 0x04;
}

// 00401230: Register word32 fn00401230(Stack word32 dwArg04, Register out ptr32 ediOut)
word32 fn00401230(word32 dwArg04, ptr32 & ediOut)
{
	word32 edi_11;
	*ediOut = Mem0[fs:dwArg04 - 0x01 + 0x00:word32];
	return ~0x00;
}

// 00401250: void fn00401250(Register word32 ecx)
void fn00401250(word32 ecx)
{
}

