// subject.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

// 00401000: Register Eq_2 Win32CrtStartup()
DWORD Win32CrtStartup()
{
	word32 esi_359 = AddAce(null, 0x00, 0x00, null, 0x00) + 0x25 + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00);
	Eq_3 ebx_15 = null;
	if (AreAnyAccessesGranted(~0x00, ~0x00) == 0x00)
		esi_359 = esi_359 - 0x22;
	struct Eq_246 * ecx_370 = null;
	do
	{
		if (ebx_15 == esi_359)
			ebx_15 = null;
		ecx_370[4199088] = (struct Eq_246) (ecx_370[4199088] ^ ebx_15[0x00404000]);
		ecx_370 = ecx_370 + 0x01;
		ebx_15 = (Eq_3) (ebx_15 + 0x01);
	} while (ecx_370 < (struct Eq_246 *) 5152);
	word32 edi_396 = 0x00401030;
	struct Eq_270 * edx_398 = &globals->t402590;
	up32 dwLoc0244_401 = 0x00;
	struct Eq_274 * esp_402 = fp - 0x0254;
	do
	{
		Eq_278 eax_409 = edx_398->t0004;
		cui16 * ecx_416 = (char *) &edx_398->t0004 + 0x04;
		if (eax_409 - 0x08 >> 0x01 > 0x00)
		{
			uint32 esi_564 = eax_409 - 0x08 >> 0x01;
			do
			{
				if ((*ecx_416 & 0xF000) == 0x3000)
				{
					struct Eq_300 * eax_582 = ((word32) *ecx_416 & 0x0FFF) + edx_398->dw0000;
					eax_582->dw401030 = eax_582->dw401030 + 0xF0401030;
				}
				ecx_416 = ecx_416 + 0x01;
				esi_564 = esi_564 - 0x01;
			} while (esi_564 != 0x00);
		}
		Eq_278 eax_421 = edx_398->t0004;
		up32 ecx_423 = (word32) eax_421.u0 + dwLoc0244_401;
		edx_398 = edx_398 + eax_421;
		dwLoc0244_401 = ecx_423;
	} while (ecx_423 < 228);
	struct Eq_327 * ebx_428 = &globals->t401D8C;
	edi_456 = edi_396;
	ebx_457 = ebx_428;
	esp_459 = esp_402;
	if (globals->dw401D9C != 0x00)
	{
		do
		{
			word32 edi_456;
			struct Eq_327 * ebx_457;
			struct Eq_274 * esp_459;
			struct Eq_366 * esp_462 = esp_459 - 0x04;
			esp_462->t0000 = ebx_457->dw000C + edi_456;
			Eq_376 eax_464 = LoadLibraryA(esp_462->t0000);
			*(esp_462 - 0x04) = 0x62;
			esp_462->t0014 = eax_464;
			CloseHandle(*(esp_462 - 0x04));
			*(esp_462 - 0x08) = 0x62;
			CloseHandle(*(esp_462 - 0x08));
			esp_459 = esp_462 - 0x08 + 0x10;
			if (eax_464 != null)
			{
				word32 ebp_495 = ebx_457->dw0000;
				if (ebp_495 == 0x00)
					ebp_495 = ebx_457->dw0010;
				word32 * ebp_501 = ebp_495 + edi_456;
				word32 * ebx_502 = ebx_457->dw0010 + edi_456;
				if (*ebp_501 != 0x00)
				{
					do
					{
						int32 eax_530 = *ebp_501;
						word16 ax_532 = (word16) eax_530;
						if (eax_530 < 0x00)
						{
							word32 eax_546 = esp_459[0x05];
							LPCSTR * esp_547 = esp_459 - 0x04;
							*esp_547 = (LPCSTR *) (word32) ax_532;
							*(esp_547 - 0x04) = eax_546;
							*ebx_502 = (word32) GetProcAddress(*(esp_547 - 0x04), *esp_547);
						}
						else
						{
							word32 edx_555 = esp_459[0x05];
							LPCSTR * esp_557 = esp_459 - 0x04;
							*esp_557 = (LPCSTR *) (eax_530 + 0x02 + edi_456);
							*(esp_557 - 0x04) = edx_555;
							*ebx_502 = (word32) GetProcAddress(*(esp_557 - 0x04), *esp_557);
						}
						esp_459 = esp_459 - 0x08;
						ebp_501 = ebp_501 + 0x01;
						edi_456 = (word32) esp_459[0x06];
						ebx_502 = ebx_502 + 0x01;
					} while (*ebp_501 != 0x00);
				}
				ebx_457 = esp_459->dw0000;
			}
			ebx_457 = ebx_457 + 0x01;
			esp_459[0x04] = (struct Eq_274) ebx_457;
		} while (ebx_457->dw0010 != 0x00);
	}
	ptr32 esp_435;
	byte SCZO_436;
	word32 ebx_437;
	word32 ebp_438;
	word32 esi_439;
	word32 edi_440;
	byte SZO_441;
	byte C_442;
	word32 edx_443;
	word32 eax_444;
	byte Z_445;
	word32 ecx_446;
	byte al_447;
	word16 ax_448;
	byte S_449;
	globals->t401A80();
	*(esp_435 - 0x04) = 0x00;
	ExitProcess(*(esp_435 - 0x04));
}

