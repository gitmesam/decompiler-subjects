// subject.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

// 00401000: Register Eq_2 Win32CrtStartup()
DWORD Win32CrtStartup()
{
	ui32 eax_9 = ecx - 0x01 & edi;
	word32 esi_67;
	word32 edi_68;
	Eq_2 eax_69 = fn0040105F(0x00, eax_9 + (edi + esi) + esi + esi + esi + esi, 13128104, 0x00, eax_9, out esi_67, out edi_68);
	*(fp - 44) = edi_68;
	*(fp - 0x30) = esi_67;
	word32 esi_82;
	word32 edi_83;
	return fn0040105F(eax_69, dwArg00, dwArg14, dwArg18, dwArg24, out esi_82, out edi_83);
}

// 0040105F: Register Eq_2 fn0040105F(Register Eq_2 eax, Stack ui32 dwArg00, Stack word32 dwArg14, Stack word32 dwArg18, Stack ui32 dwArg24, Register out ptr32 esiOut, Register out ptr32 ediOut)
DWORD fn0040105F(DWORD eax, ui32 dwArg00, word32 dwArg14, word32 dwArg18, ui32 dwArg24, ptr32 & esiOut, ptr32 & ediOut)
{
	ui32 eax_106 = dwArg00;
	cui16 ax_107 = (word16) dwArg00;
	while (true)
	{
		word16 * eax_37 = DPB(eax_106, ax_107 & 0x00, 0);
		word32 ecx_48 = DPB(ecx, *eax_37, 0);
		ecx = ecx_48 + 42418;
		if ((word16) (ecx_48 + 42418) == 0x01)
			break;
		eax_106 = eax_37 - 0x00010000;
		ax_107 = (word16) (eax_37 - 0x00010000);
	}
	word32 eax_137 = DPB(eax_106, 0x00, 0);
	struct Eq_81 * ebx_393;
	word32 ecx_394 = fn00401324(fp - 0x28, fp - 0x28, out ebx_393);
	struct Eq_94 * esp_490;
	word32 eax_491;
	byte SZO_492;
	word32 edi_493;
	word32 esi_494;
	word32 ebp_495;
	word32 edx_496;
	word16 ax_497;
	bool C_498;
	word16 cx_499;
	word32 ecx_500;
	byte SCZO_501;
	bool Z_502;
	word32 ebx_503;
	struct Eq_108 * fs_504;
	ebx_393->ptr0020();
	*(esp_490 - 0x04) = fp - 0x28;
	*(esp_490 - 0x08) = esi_494;
	ptr32 esi_509 = *(esp_490 - 0x08);
	word32 eax_513 = *(esi_509 - 0x01);
	*(esp_490 - 0x04) = *(esp_490 - 0x04);
	*(esp_490 - 0x08) = esi_509;
	word32 esi_519 = *(esp_490 - 0x08);
	word32 edi_521 = *(esp_490 - 0x04);
	esp_490->dw0038 = eax_513;
	*(esp_490 - 0x04) = ebx_503;
	*(esp_490 - 0x04) = *(esp_490 - 0x04) - 0x04;
	*(esp_490 - 0x08) = edi_521;
	*(esp_490 - 0x0C) = esi_519;
	word32 esi_533 = *(esp_490 - 0x0C);
	*(esp_490 - 0x08) = *(esp_490 - 0x04);
	*(esp_490 - 0x0C) = esi_533;
	word32 esi_542 = *(esp_490 - 0x0C);
	*(esp_490 - 0x08) = **(esp_490 - 0x08);
	*(esp_490 - 0x0C) = esi_542;
	word32 esi_551 = *(esp_490 - 0x0C);
	esp_490->dw003C = ebx_503;
	word32 edi_556 = *(esp_490 - 0x04);
	*(esp_490 - 0x04) = eax_513;
	*(esp_490 - 0x08) = edi_556;
	*(esp_490 - 0x0C) = esi_551;
	word32 esi_564 = *(esp_490 - 0x0C);
	word32 edi_566 = *(esp_490 - 0x08);
	*(esp_490 - 0x08) = ecx_500;
	*(esp_490 - 0x0C) = edi_566;
	*(esp_490 - 0x10) = esi_564;
	word32 esi_574 = *(esp_490 - 0x10);
	word32 edi_576 = *(esp_490 - 0x0C);
	*(esp_490 - 0x0C) = esp_490 - 0x08;
	*(esp_490 - 0x10) = 0x40;
	*(esp_490 - 0x14) = esp_490->dw0020;
	*(esp_490 - 0x18) = edi_576;
	*(esp_490 - 0x1C) = esi_574;
	word32 esi_590 = *(esp_490 - 0x1C);
	word32 edi_592 = *(esp_490 - 0x18);
	*(esp_490 - 0x18) = esp_490->dw0014;
	*(esp_490 - 0x1C) = edi_592;
	*(esp_490 - 0x20) = esi_590;
	word32 esi_601 = *(esp_490 - 0x20);
	*(esp_490 - 0x1C) = *(esp_490 - 0x1C);
	*(esp_490 - 0x20) = esi_601;
	word32 esi_611 = *(esp_490 - 0x20);
	word32 edi_613 = *(esp_490 - 0x1C);
	esp_490->dw0018 = 0x00;
	*(esp_490 - 0x1C) = edi_613;
	*(esp_490 - 0x20) = esi_611;
	struct Eq_402 * edi_622 = *(esp_490 - 0x1C);
	struct Eq_408 * esp_624;
	struct Eq_409 Eq_422::* eax_625;
	byte SZO_626;
	word32 edi_627;
	word32 esi_628;
	word32 ebp_629;
	word32 edx_630;
	word16 ax_631;
	bool C_632;
	word16 cx_633;
	word32 ecx_634;
	byte SCZO_635;
	bool Z_636;
	word32 ebx_637;
	struct Eq_422 * fs_638;
	edi_622->ptr000C();
	esp_624->dw0004 = esp_624->dw0004;
	esp_624->dw0000 = esi_628;
	word32 esi_647 = esp_624->dw0000;
	esp_624->dw0008 = esp_624->dw0008;
	esp_624->dw0004 = esi_647;
	word32 esi_657 = esp_624->dw0004;
	esp_624->dw000C = esp_624->dw0008;
	esp_624->dw0008 = esi_657;
	word32 esi_671 = esp_624->dw0010;
	esp_624->dw0010 = esp_624->dw000C;
	esp_624->dw000C = esi_671;
	word32 esi_677 = esp_624->dw000C;
	esp_624->dw0010 = esp_624->dw0010;
	esp_624->dw000C = esi_677;
	word32 esi_686 = esp_624->dw000C;
	struct Eq_488 * eax_690 = (fs_638->*eax_625).ptr002F;
	esp_624->dw0010 = esp_624->dw0010;
	esp_624->dw000C = esi_686;
	word32 esi_695 = esp_624->dw000C;
	esp_624->dw0010 = esp_624->dw0010;
	esp_624->dw000C = esi_695;
	word32 esi_704 = esp_624->dw000C;
	word32 ecx_708 = eax_690->dw0004;
	esp_624->dw0010 = esp_624->dw0010;
	esp_624->dw000C = esi_704;
	word32 esi_713 = esp_624->dw000C;
	word32 edi_715 = esp_624->dw0010;
	esp_624->dw003C = esp_624->dw003C ^ ecx_708;
	esp_624->dw0010 = edi_715;
	esp_624->dw000C = esi_713;
	word32 esi_724 = esp_624->dw000C;
	*(esp_624 - 0xF8) = esp_624->dw0010;
	*(esp_624 - 252) = esi_724;
	word32 esi_734 = *(esp_624 - 252);
	byte * eax_738 = esp_624->ptr001C;
	*(esp_624 - 0xF8) = *(esp_624 - 0xF8);
	*(esp_624 - 252) = esi_734;
	int32 ecx_748 = esp_624->dw002C;
	word32 esi_760;
	word32 edi_761;
	return BeginNjsukaqfoi(eax_738, ecx_748, eax_137 + 0x00016030, dwArg04, dwArg0104, dwArg0108, dwArg010C, dwArg0118, dwArg011C, dwArg012C, dwArg0130, dwArg0134, dwArg0138, out esi_760, out edi_761);
}

// 0040130E: Register (ptr32 byte) BeginNjsukaqfoi(Register (ptr32 byte) eax, Register int32 ecx, Stack word32 dwArg00, Stack word32 dwArg04, Stack word32 dwArg0104, Stack word32 dwArg0108, Stack (ptr32 byte) dwArg010C, Stack ptr32 dwArg0118, Stack word32 dwArg011C, Stack word32 dwArg012C, Stack word32 dwArg0130, Stack word32 dwArg0134, Stack (ptr32 Eq_609) dwArg0138, Register out ptr32 esiOut, Register out ptr32 ediOut)
byte * BeginNjsukaqfoi(byte * eax, int32 ecx, word32 dwArg00, word32 dwArg04, word32 dwArg0104, word32 dwArg0108, byte * dwArg010C, ptr32 dwArg0118, word32 dwArg011C, word32 dwArg012C, word32 dwArg0130, word32 dwArg0134, Eq_609 * dwArg0138, ptr32 & esiOut, ptr32 & ediOut)
{
	Eq_627 eax_24 = 0x00;
	byte al_25 = 0x00;
	do
	{
		word32 ecx_45 = fp + 0x08 + eax_24;
		*ecx_45 = al_25;
		eax_24 = (word32) eax_24 + 0x01;
		al_25 = (byte) eax_24;
	} while (eax_24 < 0x0100);
	ptr32 ecx_133 = 0x00;
	int32 esi_149 = 0x00;
	Eq_648 ebp_153 = 0x00;
	do
	{
		byte ah_173 = Mem48[fp + 0x08 + ebp_153:byte];
		word32 edx_192 = (word32) (ecx_133 + ecx);
		word32 ebx_194 = (word32) ah_173;
		int32 edx_215 = (word32) (byte) (edx_192 + (ebx_194 + esi_149));
		ecx_133 = ecx_133 + 0x01;
		if (ecx_133 >= dwArg0118)
			ecx_133 = 0x00;
		byte al_247 = (&fp->a0008->t0000)[edx_215 / 0x08];
		word32 esi_259 = fp + 0x08 + ebp_153;
		*esi_259 = al_247;
		(&(&(&(&(&(&(&(&(&(&(&(&(&(&(&(&(&(&(&(fp - 0x10)[edx_215 + 0x18].a0000)[0x00].a0000)[0x00].a0000)[0x00].a0000)[0x00].a0000)[0x00].a0000)[0x00].a0000)[0x00].a0000)[0x00].a0000)[0x00].a0000)[0x00].a0000)[0x00].a0000)[0x00].a0000)[0x00].a0000)[0x00].a0000)[0x00].a0000)[0x00].a0000)[0x00].a0000)[0x00].a0000)[0x00] = ah_173;
		ebp_153 = (word32) ebp_153 + 0x01;
		esi_149 = edx_215;
	} while (ebp_153 < 0x0100);
	word32 ecx_355 = dwArg0134;
	byte ch_356 = SLICE(dwArg0134, byte, 8);
	byte SCZO_371 = cond(ch_356 + 0x88);
	if (ch_356 == 0x88)
	{
		int32 eax_627 = 0x00;
		int32 esi_645 = 0x00;
		word32 ebp_650 = dwArg011C;
		byte * edi_651 = eax;
		Eq_946 CZ_656 = DPB(SCZO_371, false, 0);
		if (!CZ_656)
		{
			do
			{
				int32 eax_763 = (word32) (byte) (eax_627 + 0x01);
				Eq_960 cl_774 = (&fp->a0008->t0000)[eax_763 / 0x08];
				word32 ecx_775 = DPB(ecx_355, cl_774, 0);
				byte dl_794 = (byte) ((word32) cl_774 + esi_645);
				int32 edx_796 = (word32) dl_794;
				(&fp->a0008->t0000)[eax_763 / 0x08] = (&fp->a0008->t0000)[edx_796 / 0x08];
				(&fp->a0008->t0000)[edx_796 / 0x08] = (struct Eq_632) cl_774;
				Mem957[edi_651 + 0x00:byte] = Mem853[edi_651 + 0x00:byte] ^ Mem853[(fp - 0x0C) + ((word32) ((byte) (Mem853[(fp + 0x08) + eax_763:word32] + ecx_775)) + 0x14):byte];
				eax_627 = eax_763;
				ecx_355 = 0x00;
				esi_645 = edx_796;
				edi_651 = edi_651 + 0x01;
				ebp_650 = ebp_650 - 0x01;
			} while (ebp_650 != 0x00);
		}
		word32 esi_737;
		*esiOut = esi;
		word32 edi_739;
		*ediOut = edi;
		return dwArg010C;
	}
	else
	{
		ptr32 esp_428;
		word32 edi_429;
		word32 esi_430;
		word32 eax_431;
		word32 ecx_432;
		byte SZO_433;
		bool C_434;
		byte al_435;
		byte SCZO_436;
		word32 ebp_437;
		struct Eq_711 * ebx_438;
		byte ah_439;
		word32 edx_440;
		byte dl_441;
		byte bh_442;
		byte ch_443;
		bool Z_444;
		byte CZ_445;
		byte cl_446;
		dwArg0138->ptr0020();
		*(esp_428 - 0x04) = edi_429;
		*(esp_428 - 0x08) = esi_430;
		ptr32 esp_455;
		word32 edi_456;
		word32 esi_457;
		word32 eax_458;
		word32 ecx_459;
		byte SZO_460;
		bool C_461;
		byte al_462;
		byte SCZO_463;
		word32 ebp_464;
		struct Eq_743 * ebx_465;
		byte ah_466;
		word32 edx_467;
		byte dl_468;
		byte bh_469;
		byte ch_470;
		bool Z_471;
		byte CZ_472;
		byte cl_473;
		ebx_438->ptr0008();
		*(esp_455 - 0x04) = edi_456;
		*(esp_455 - 0x08) = esi_457;
		ptr32 esp_482;
		word32 edi_483;
		word32 esi_484;
		word32 eax_485;
		word32 ecx_486;
		byte SZO_487;
		bool C_488;
		byte al_489;
		byte SCZO_490;
		word32 ebp_491;
		struct Eq_775 * ebx_492;
		byte ah_493;
		word32 edx_494;
		byte dl_495;
		byte bh_496;
		byte ch_497;
		bool Z_498;
		byte CZ_499;
		byte cl_500;
		ebx_465->ptr0014();
		*(esp_482 - 0x04) = edi_483;
		*(esp_482 - 0x08) = esi_484;
		ptr32 esp_509;
		word32 edi_510;
		word32 esi_511;
		word32 eax_512;
		word32 ecx_513;
		byte SZO_514;
		bool C_515;
		byte al_516;
		byte SCZO_517;
		word32 ebp_518;
		ptr32 ebx_519;
		byte ah_520;
		word32 edx_521;
		byte dl_522;
		byte bh_523;
		byte ch_524;
		bool Z_525;
		byte CZ_526;
		byte cl_527;
		ebx_492->ptr001C();
		*(esp_509 - 0x04) = edi_510;
		*(esp_509 - 0x08) = esi_511;
		ptr32 esp_536;
		word32 edi_537;
		word32 esi_538;
		word32 eax_539;
		word32 ecx_540;
		byte SZO_541;
		bool C_542;
		byte al_543;
		byte SCZO_544;
		word32 ebp_545;
		struct Eq_839 * ebx_546;
		byte ah_547;
		word32 edx_548;
		byte dl_549;
		byte bh_550;
		byte ch_551;
		bool Z_552;
		byte CZ_553;
		byte cl_554;
		(*(ebx_519 - 0x04))();
		*(esp_536 - 0x04) = edi_537;
		*(esp_536 - 0x08) = esi_538;
		ptr32 esp_563;
		word32 edi_564;
		word32 esi_565;
		word32 eax_566;
		word32 ecx_567;
		byte SZO_568;
		bool C_569;
		byte al_570;
		byte SCZO_571;
		word32 ebp_572;
		struct Eq_873 * ebx_573;
		byte ah_574;
		word32 edx_575;
		byte dl_576;
		byte bh_577;
		byte ch_578;
		bool Z_579;
		byte CZ_580;
		byte cl_581;
		ebx_546->ptr0014();
		*(esp_563 - 0x04) = edi_564;
		*(esp_563 - 0x08) = esi_565;
		ptr32 esp_590;
		word32 edi_591;
		word32 esi_592;
		byte * eax_593;
		word32 ecx_594;
		byte SZO_595;
		bool C_596;
		byte al_597;
		byte SCZO_598;
		word32 ebp_599;
		word32 ebx_600;
		byte ah_601;
		word32 edx_602;
		byte dl_603;
		byte bh_604;
		byte ch_605;
		bool Z_606;
		byte CZ_607;
		byte cl_608;
		ebx_573->ptr0014();
		*(esp_590 - 0x04) = edi_591;
		*(esp_590 - 0x08) = esi_592;
		word32 esi_613;
		*esiOut = *(esp_590 - 0x08);
		word32 edi_615;
		*ediOut = *(esp_590 - 0x04);
		return eax_593;
	}
}

// 00401324: Register int32 fn00401324(Stack ptr32 dwArg00, Stack ptr32 dwArg04, Register out ptr32 ebxOut)
int32 fn00401324(ptr32 dwArg00, ptr32 dwArg04, ptr32 & ebxOut)
{
	ptr32 eax_3 = dwArg00;
	while (true)
	{
		word16 ax_49 = DPB(eax_3, 0x00, 0) + 0x00;
		word32 eax_59 = DPB(eax_3, ax_49 + 42421, 0);
		if (ax_49 == 42419)
			break;
		eax_3 = eax_59 - 0x00010000;
	}
	struct Eq_1017 * eax_93 = DPB(eax_3, 0x00, 0);
	int32 ecx_138 = eax_93[(&(eax_93 + eax_93->dw003C / 0x0040)->dw003C)[0x0011] / 0x0040];
	word32 ebx_165;
	*ebxOut = (char *) (eax_93 + ecx_138 / 0x0040) + 0x04;
	return ecx_138;
}

