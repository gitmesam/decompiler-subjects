// subject.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

// 00401015: Register Eq_2 Win32CrtStartup()
DWORD Win32CrtStartup()
{
	Eq_3 eax_21 = CreateFileA(4415501, 0x80000000, 0x02, null, 0x03, 292, 0x00);
	if (eax_21 != ~0x00)
	{
		GetFileSize(dwLoc10, null);
		GetOEMCP();
		CreateFileA(0x00436048, 0xA0000000, 0x02, null, 0x03, 422, 0x00);
		GetProcessHeap();
		CloseHandle(eax_21);
		VirtualProtect(&globals->v401238, eax_21, 0xE454, &globals->t436048);
		GetFileType(dwLoc20);
		GetFileSize(dwLoc10, null);
		CreateFileA(0x00436023, 0x40000000, 0x04, null, 0x03, 0x0181, 0x00);
		word32 esp_277;
		word32 ebp_278;
		byte SCZO_279;
		word32 eax_280;
		byte Z_281;
		byte SZO_282;
		byte C_283;
		bcuisposr0 None_284;
		byte bh_285;
		byte ch_286;
		word32 edx_287;
		word16 dx_288;
		word16 ax_289;
		word32 ebx_290;
		byte cl_291;
		word32 ecx_292;
		byte al_293;
		real64 rArg0_294;
		byte P_295;
		(dwLoc1C - ~0x404011F4)();
		Eq_3 eax_299 = GetProcessHeap();
		int64 edx_eax_306 = SEQ(edx_287, eax_299 ^ 874516727);
		int32 edx_309 = (int32) (edx_eax_306 % *(eax_299 ^ 874516727));
		word16 dx_310 = (word16) edx_309;
		word16 ax_312 = (word16) (int32) (edx_eax_306 / *(eax_299 ^ 874516727));
		__outw(dx_310, ax_312);
		word32 esp_316;
		word32 ebp_317;
		byte SCZO_318;
		word32 eax_319;
		byte Z_320;
		byte SZO_321;
		byte C_322;
		bcuisposr0 None_323;
		byte bh_324;
		byte ch_325;
		word32 edx_326;
		word16 dx_327;
		word16 ax_328;
		cu8 * ebx_329;
		byte cl_330;
		struct Eq_209 * ecx_331;
		byte al_332;
		real64 rArg0_333;
		bool P_334;
		fnE984CD7F();
		cu8 v27_335 = *ebx_329 + cl_330 + C_322;
		*ebx_329 = v27_335;
		byte al_342 = __inb(dx_327);
		struct Eq_229 * eax_343 = DPB(eax_319, al_342, 0);
		cu8 v30_344 = eax_343->b88BEB17C + al_342 + (v27_335 < 0x00);
		eax_343->b88BEB17C = v30_344;
		byte al_350 = __inb(11);
		word32 eax_351 = DPB(eax_319, al_350, 0);
		if (P_334)
			return eax_351;
		ecx_331->b5A02044D = ecx_331->b5A02044D + al_350 + (v30_344 < 0x00);
		__wait();
		byte al_361;
		__das(227, &al_361);
	}
	else
	{
		Eq_100 eax_83 = GetModuleHandleA(4415513);
		GetCommandLineA();
		GetACP();
		GetACP();
		Eq_3 eax_94 = GetProcAddress(eax_83, 0x00436000);
		GetProcessHeap();
		SizeofResource(null, eax_94);
		GetCurrentThreadId();
		GetFileType(eax_94);
		CreateFileA(4415535, 0x40000000, 0x05, null, 0x03, 0x26, 0x00);
		<anonymous> * eax_177 = (eax_94() ^ 0xC0000005) + 0x00401102;
		word32 esp_179;
		word32 ebp_180;
		byte SCZO_181;
		Eq_2 eax_182;
		byte Z_183;
		byte SZO_184;
		byte C_185;
		bcuisposr0 None_186;
		byte bh_187;
		byte ch_188;
		word32 edx_189;
		word16 dx_190;
		word16 ax_191;
		word32 ebx_192;
		byte cl_193;
		word32 ecx_194;
		byte al_195;
		real64 rArg0_196;
		byte P_197;
		eax_177();
		return eax_182;
	}
}

