// subject.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

// 004011B9: Register DWORD Win32CrtStartup()
DWORD Win32CrtStartup()
{
	word32 ecx_8;
	word32 edx_9;
	byte bl_10;
	word32 ebp_11;
	word32 esi_12;
	word32 edi_13;
	word32 eax_14 = fn004011CA(eax, ecx, edx, ebp, esi, edi, out ecx_8, out edx_9, out bl_10, out ebp_11, out esi_12, out edi_13);
	Mem18[edx_9 + 0x12:byte] = Mem0[edx_9 + 0x12:byte] + dl;
	Mem20[eax_14 - 0x6C + eax_14:byte] = Mem18[eax_14 - 0x6C + eax_14:byte] + dl;
	Mem22[edx_9 + 0x8100C200:byte] = Mem20[edx_9 + 0x8100C200:byte] + bl_10;
	word32 ecx_25;
	word32 edx_26;
	byte bl_27;
	word32 ebp_28;
	word32 esi_29;
	word32 edi_30;
	return fn004011CB(eax_14, ecx_8, edx_9, ebp_11, esi_12, edi_13, dwArg00, out ecx_25, out edx_26, out bl_27, out ebp_28, out esi_29, out edi_30);
}

// 004011CA: Register word32 fn004011CA(Register word32 eax, Register word32 ecx, Register word32 edx, Register word32 ebp, Register word32 esi, Register word32 edi, Register out ptr32 ecxOut, Register out ptr32 edxOut, Register out ptr32 blOut, Register out ptr32 ebpOut, Register out ptr32 esiOut, Register out ptr32 ediOut)
word32 fn004011CA(word32 eax, word32 ecx, word32 edx, word32 ebp, word32 esi, word32 edi, ptr32 & ecxOut, ptr32 & edxOut, ptr32 & blOut, ptr32 & ebpOut, ptr32 & esiOut, ptr32 & ediOut)
{
	word32 ecx_17;
	word32 edx_18;
	byte bl_19;
	word32 ebp_20;
	word32 esi_21;
	word32 edi_22;
	return fn004011CB(eax & 2693926694, ecx, edx, ebp, esi, edi, dwArg00, out ecx_17, out edx_18, out bl_19, out ebp_20, out esi_21, out edi_22);
}

// 004011CB: Register word32 fn004011CB(Register word32 eax, Register word32 ecx, Register word32 edx, Register word32 ebp, Register word32 esi, Register word32 edi, Stack word32 dwArg00, Register out ptr32 ecxOut, Register out ptr32 edxOut, Register out ptr32 blOut, Register out ptr32 ebpOut, Register out ptr32 esiOut, Register out ptr32 ediOut)
word32 fn004011CB(word32 eax, word32 ecx, word32 edx, word32 ebp, word32 esi, word32 edi, word32 dwArg00, ptr32 & ecxOut, ptr32 & edxOut, ptr32 & blOut, ptr32 & ebpOut, ptr32 & esiOut, ptr32 & ediOut)
{
	ptr32 fp;
	word32 ecx;
	bool Z;
	ptr32 ecxOut;
	ptr32 edxOut;
	ptr32 blOut;
	ptr32 ebpOut;
	ptr32 esiOut;
	ptr32 ediOut;
	byte bl;
	word32 ebp;
	bool C;
	word32 eax;
	byte al;
	word32 edi;
	word32 esi;
	word32 edx;
	word32 dwArg00;
	<type-error> Mem0;
	word16 si;
	word16 dx;
	esp_1 = fp;
	ecx_3 = ecx - 0x01;
	cx_4 = (word16) ecx_3;
	if (!Z || ecx_3 == 0x00)
	{
		Mem49[eax + 2347839839:byte] = C;
		al_52 = al ^ 0x24;
		edi_54 = edi << 0x11;
		di_55 = (word16) edi_54;
		esi_57 = esi + 0x08;
		si_58 = (word16) esi_57;
		edx_60 = edx - ebp;
		eax_61 = 0x00;
		edx_63 = edx_60 + dwArg00;
		al_64 = Mem49[esi_57 + 0x00:byte];
		eax_65 = DPB(eax_61, al_64, 0);
		edx_66 = edx_63 + 0x01;
		dx_67 = (word16) edx_66;
		ecx_68 = 0x00;
		ecx_69 = 0x90;
		cx_70 = (word16) ecx_69;
		SCZO_71 = cond(0x90);
		edi_72 = edi_54 ^ 0x4F5D446D;
		di_73 = (word16) edi_72;
		SZO_74 = cond(edi_72);
		C_75 = false;
	}
	else
	{
		v14_77 = Mem0[ecx_3 + 1564765687:byte] + al;
		Mem78[ecx_3 + 1564765687:byte] = v14_77;
		SCZO_79 = cond(v14_77);
		edi_80 = edi - 0x01;
		di_81 = (word16) edi_80;
		SZO_82 = cond(edi_80);
	}
	si_6 = ϕ(si_58, si);
	dx_7 = ϕ(dx_67, dx);
	SCZO_8 = ϕ(SCZO_71, SCZO_79);
	di_9 = ϕ(di_73, di_81);
	ecx_10 = ϕ(ecx_69, ecx_3);
	edx_11 = ϕ(edx_66, edx);
	esi_12 = ϕ(esi_57, esi);
	edi_13 = ϕ(edi_72, edi_80);
	eax_14 = ϕ(eax_65, eax);
	al_15 = ϕ(al_64, al);
	ecx_16 = ecx_10 ^ eax_14;
	cx_17 = (word16) ecx_16;
	v15_18 = (di_9 & 0x04) != 0x00;
	di_19 = __ror(di_9, 0x02);
	edi_20 = DPB(edi_13, di_19, 0);
	SZO_21 = cond(ecx_16 & ecx_16);
	Z_22 = (bool) SZO_21;
	C_23 = false;
	if ((ecx_16 & ecx_16) == 0x00)
	{
		eax_46 = fn00401237(cx_17, dx_7, ebp, esi_12, di_19, out ecx_40, out edx_41, out bl_42, out ebp_43, out esi_44, out edi_45);
		al_47 = (byte) eax_46;
		return eax_46;
	}
	else
	{
		fn00401208(eax_14, si_6);
		return eax_14;
	}
}

// 00401208: void fn00401208(Register word32 eax, Register word16 si)
void fn00401208(word32 eax, word16 si)
{
	__rol(eax, 0x1E);
}

// 00401237: Register word32 fn00401237(Register word16 cx, Register word16 dx, Register word32 ebp, Register word32 esi, Register word16 di, Register out ptr32 ecxOut, Register out ptr32 edxOut, Register out ptr32 blOut, Register out ptr32 ebpOut, Register out ptr32 esiOut, Register out ptr32 ediOut)
word32 fn00401237(word16 cx, word16 dx, word32 ebp, word32 esi, word16 di, ptr32 & ecxOut, ptr32 & edxOut, ptr32 & blOut, ptr32 & ebpOut, ptr32 & esiOut, ptr32 & ediOut)
{
	word32 esi_22 = Mem0[DPB(1195703, (word16) v3, 0) + 0x00:word32];
	__rol(v3, 0x19);
	word32 ecx_30 = Mem0[0x004010C8:word32];
	do
	{
		esi_22 = esi_22 + 0x01;
		word32 eax_44 = Mem0[esi_22 + 0x00:word32] - ecx_30;
	} while (eax_44 != 0x00);
	word32 ecx_59 = (word32) Mem0[esi_22 + ~0x02:word16];
	__ror(-eax_44, 0x0F);
	word32 edi_68 = __rol(esi_22 + ~0x02, 22);
	Mem71[v3 - 0x04 + 0x00:word32] = v3;
	word32 edx_76 = Mem71[Mem71[v3 - 0x04 + 0x00:word32] + 0x00:word32];
	__rol(edx_76, 0x12);
	word32 edx_85 = Mem71[0x00401024:word32];
	__ror((word16) (edi_68 + 4186048469), 0x04);
	byte bl_65;
	*blOut = (byte) ecx_59;
	word32 ecx_79 = edx_76;
	word32 eax_100 = 0x0040100A;
	do
	{
		word32 edi_93 = Mem71[ecx_79 + 0x00:word32];
		__rol((word16) edi_93, 0x06);
		ecx_79 = ecx_79 - ~0x00;
		eax_100 = eax_100 & ebp;
	} while ((edi_93 ^ edx_85) != 0x00);
	Mem121[v3 - 0x04 + 0x00:word32] = ecx_59 + 4163506;
	word32 eax_118 = eax_100 - ecx_59;
	word32 eax_126 = DPB(eax_118, __ror((word16) eax_118, 0x0F), 0);
	word32 ecx_128 = Mem121[fs:0x00:word32];
	Mem131[v3 - 0x08 + 0x00:word32] = ecx_128;
	Mem136[v3 - 0x0C + 0x00:word32] = v3 - 0x08;
	word32 edx_137 = Mem136[v3 - 0x0C + 0x00:word32];
	Mem141[fs:0x00:word32] = edx_137;
	Mem144[v3 - 0x0C + 0x00:word32] = 0x00;
	word32 edx_147;
	*edxOut = DPB(edx_137, __rol((word16) edx_137, 0x02), 0);
	Mem156[v3 - 0x10 + 0x00:word32] = ecx_79;
	word32 ecx_149;
	*ecxOut = ecx_79;
	word32 ebp_151;
	*ebpOut = ecx_128 - edx_137;
	word32 edi_152;
	*ediOut = DPB(ecx_59 + 4163506, (word16) (ecx_59 + 4163506) | 0x30, 0) + ecx_79 + 22246013;
	word32 esi_157;
	*esiOut = 0x01;
	return eax_126;
}

