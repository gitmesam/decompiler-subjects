// subject.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

// 00401000: void fn00401000(Register (ptr32 Eq_2) ebx, Stack (ptr32 byte) dwArg04)
void fn00401000(Eq_2 * ebx, byte * dwArg04)
{
	*dwArg04 = globals->b405388;
	Eq_9 eax_106 = 0x00;
	byte * ecx_115 = dwArg04 + 0x01;
	byte * ebp_122 = &globals->b405389;
	word32 dwLoc7C_116 = 0x00;
	word32 dwLoc78_243 = 0x00;
	byte * dwLoc88_125 = dwArg04 + 0x01;
	byte * dwLoc8C_114 = &globals->b405389;
	uint32 edx_110 = dwLoc84;
l00401044:
	Eq_9 dwLoc80_109 = eax_106 - 0x01;
	if (eax_106 == 0x00)
	{
		ebp_122 = ebp_122 + 0x01;
		edx_110 = (word32) *ebp_122;
		dwLoc8C_114 = ebp_122;
		dwLoc80_109.u0 = 0x07;
	}
	edx_110 = edx_110 * 0x02;
	if ((edx_110 >> 0x07 & 0x01) == 0x00)
	{
		*ecx_115 = *ebp_122;
		ebp_122 = ebp_122 + 0x01;
		ecx_115 = ecx_115 + 0x01;
		dwLoc8C_114 = ebp_122;
		goto l004012AD;
	}
	Eq_9 esi_132 = dwLoc80_109;
	dwLoc80_109 = dwLoc80_109 - 0x01;
	if (dwLoc80_109 == 0x00)
	{
		ebp_122 = ebp_122 + 0x01;
		esi_132 = dwLoc80_109 - edx_110;
		edx_110 = (word32) *ebp_122;
		dwLoc8C_114 = ebp_122;
		dwLoc80_109.u0 = 0x07;
	}
	uint32 eax_146 = edx_110 >> 0x07;
	uint32 edx_149 = edx_110 * 0x02;
	if ((eax_146 & 0x01) != 0x00)
	{
		dwLoc80_109 = dwLoc80_109 - 0x01;
		if (dwLoc80_109 == 0x00)
		{
			edx_149 = (word32) *ebp_122;
			ebp_122 = ebp_122 + 0x01;
			dwLoc80_109.u0 = 0x07;
		}
		edx_110 = edx_149 * 0x02;
		if ((edx_149 >> 0x07 & 0x01) != 0x00)
		{
			ui32 edi_177 = 0x00;
			word32 dwLoc7C_180 = 0x04;
			do
			{
				dwLoc80_109 = dwLoc80_109 - 0x01;
				if (dwLoc80_109 == 0x00)
				{
					edx_110 = (word32) *ebp_122;
					ebp_122 = ebp_122 + 0x01;
					dwLoc80_109.u0 = 0x07;
				}
				word32 v16_206 = dwLoc7C_180 - 0x01;
				edx_110 = edx_110 * 0x02;
				dwLoc7C_180 = v16_206;
				edi_177 = (edx_110 >> 0x07 & 0x01) + edi_177 * 0x02;
			} while (v16_206 != 0x00);
			dwLoc8C_114 = ebp_122;
			if (edi_177 != 0x00)
			{
				*ecx_115 = *(ecx_115 - edi_177);
				ecx_115 = ecx_115 + 0x01;
			}
			else
			{
				*ecx_115 = 0x00;
				ecx_115 = ecx_115 + 0x01;
			}
l004012AD:
			dwLoc7C_116 = 0x00;
			dwLoc88_125 = ecx_115;
			goto l004012B1;
		}
		uint32 edi_233 = (word32) *ebp_122;
		ebp_122 = ebp_122 + 0x01;
		ui32 esi_238 = (edi_233 & 0x01) + 0x02;
		dwLoc8C_114 = ebp_122;
		if (edi_233 >> 0x01 != 0x00)
		{
			if (esi_238 != 0x00)
			{
				do
				{
					*ecx_115 = *(ecx_115 - (edi_233 >> 0x01));
					ecx_115 = ecx_115 + 0x01;
					esi_238 = esi_238 - 0x01;
				} while (esi_238 != 0x00);
				dwLoc88_125 = ecx_115;
				dwLoc74 = edi_233 >> 0x01;
				dwLoc7C_116 = 0x01;
				goto l004012B1;
			}
		}
		else
			dwLoc78_243 = 0x01;
		dwLoc74 = edi_233 >> 0x01;
		dwLoc7C_116 = 0x01;
		goto l004012B1;
	}
	ui32 eax_297;
	Eq_9 eax_275 = fn004015C0(eax_146 & 0x01, esi_132, fp - 0x8C);
	if (dwLoc7C_116 == 0x00)
	{
		if (eax_275 == 0x02)
		{
			Eq_9 eax_358 = fn004015C0(eax_275, fp - 0xA0, fp - 0x8C);
			ecx_115 = dwLoc88_125;
			if (eax_358 != 0x00)
			{
				do
				{
					ecx_115 = ecx_115 + 0x01;
					*(ecx_115 - 0x01) = *(ecx_115 - dwLoc74);
					eax_358 = eax_358 - 0x01;
				} while (eax_358 != 0x00);
				edx_110 = edx_149;
				ebp_122 = dwLoc8C_114;
				dwLoc88_125 = ecx_115;
				dwLoc7C_116 = 0x01;
l004012B1:
				if (dwLoc78_243 != 0x00)
					return;
				eax_106 = dwLoc80_109;
				goto l00401044;
			}
			goto l00401288;
		}
		eax_297 = eax_275 - 0x03;
	}
	else
		eax_297 = eax_275 - 0x02;
	Eq_9 eax_301 = (eax_297 << 0x08) + (word32) (*dwLoc8C_114);
	dwLoc8C_114 = dwLoc8C_114 + 0x01;
	Eq_9 eax_307 = fn004015C0(eax_301, eax_301, fp - 0x8C);
	if (eax_301 >= 0x7D00)
		eax_307 = (word32) eax_307 + 0x01;
	if (eax_301 >= 0x0500)
		eax_307 = (word32) eax_307 + 0x01;
	if (eax_301 < 0x80)
		eax_307 = (word32) eax_307 + 0x02;
	ecx_115 = dwLoc88_125;
	if (eax_307 != 0x00)
	{
		do
		{
			*ecx_115 = *(ecx_115 - eax_301);
			ecx_115 = ecx_115 + 0x01;
			eax_307 = eax_307 - 0x01;
		} while (eax_307 != 0x00);
		dwLoc88_125 = ecx_115;
	}
	dwLoc74 = eax_301;
l00401288:
	edx_110 = edx_149;
	ebp_122 = dwLoc8C_114;
	dwLoc7C_116 = 0x01;
	goto l004012B1;
}

// 00401480: Register Eq_272 fn00401480(Register Eq_272 eax, Register (ptr32 byte) edx, Register word32 ebx, Register Eq_275 esi, Register (ptr32 Eq_276) edi, Stack Eq_272 dwArg04, Stack ui32 dwArg08, Register out ptr32 ecxOut, Register out ptr32 edxOut)
Eq_272 fn00401480(Eq_272 eax, byte * edx, word32 ebx, LPVOID esi, Eq_276 * edi, Eq_272 dwArg04, ui32 dwArg08, ptr32 & ecxOut, ptr32 & edxOut)
{
	word32 edi_34 = Mem0[Mem0[dwArg04 + 0x3C:word32] + dwArg04 + 0x78:word32] + dwArg04;
	GetModuleHandleA(0x00);
	byte * ecx_130 = edx;
	word32 dwLoc0138_161 = 0x00;
	word32 eax_43[] = (word32) dwArg04 + edi_34->dw001C;
	int32 esi_44[] = (word32) dwArg04 + edi_34->dw0020;
	int32 dwLoc013C_123 = 0x00;
	if (edi_34->dw0018 > 0x00)
	{
		do
		{
			int32 ecx_127 = esi_44[dwLoc013C_123];
			byte al_128 = *((word32) dwArg04 + ecx_127);
			ecx_130 = (word32) dwArg04 + ecx_127;
			ui32 edx_131 = 0x00;
			if (al_128 != 0x00)
			{
				do
				{
					ecx_130 = ecx_130 + 0x01;
					edx_131 = __rol(edx_131, 0x03) ^ (int32) al_128;
					al_128 = *ecx_130;
				} while (al_128 != 0x00);
			}
			ui32 eax_140 = 0x7C;
			word32 ebx_142 = 0x0F;
			do
			{
				eax_140 = eax_140 + 0x05;
				ui32 dwLoc0130_150 = eax_140;
				if (eax_140 != 0x00)
				{
					eax_140 = 0x06;
					dwLoc0130_150 = 0x06;
				}
				ecx_130 = ecx_130 - dwLoc0130_150;
				ebx_142 = ebx_142 - 0x01;
			} while (ebx_142 != 0x00);
			if (edx_131 == dwArg08)
			{
				dwLoc0138_161 = 0x01;
				break;
			}
			int32 eax_169 = dwLoc013C_123 + 0x01;
			dwLoc013C_123 = eax_169;
		} while (eax_169 < edi_34->dw0018);
	}
	word32 ecx_60;
	word32 edx_61;
	word16 ebx_62[];
	fn00401980(ecx_130, out ecx_60, out edx_61, out ebx_62);
	if (dwLoc0138_161 == 0x00)
		return 0x00;
	GetLastError();
	ui32 edx_106 = (word32) ebx_62[dwLoc013C_123];
	*edxOut = edx_106;
	word32 ecx_105;
	*ecxOut = dwLoc013C_123;
	return (word32) dwArg04 + eax_43[edx_106];
}

// 004015C0: Register Eq_9 fn004015C0(Register Eq_9 eax, Register Eq_9 esi, Register (ptr32 Eq_85) edi)
Eq_9 fn004015C0(Eq_9 eax, Eq_9 esi, Eq_85 * edi)
{
	Eq_9 ebp_12 = 0x01;
	word32 ecx_20 = edi->dw000C;
	uint32 eax_21 = edi->dw0008;
	do
	{
		word32 ecx_30 = ecx_20 - 0x01;
		if (ecx_20 == 0x00)
		{
			byte * ecx_82 = edi->ptr0000;
			eax_21 = (word32) *ecx_82;
			edi->ptr0000 = ecx_82 + 0x01;
			ecx_30 = ecx_20 + 0x07;
		}
		ebp_12 = (eax_21 >> 0x07 & 0x01) + ebp_12 * 0x02;
		uint32 eax_44 = eax_21 * 0x02;
		ecx_20 = ecx_30 - 0x01;
		if (ecx_30 == 0x00)
		{
			byte * ecx_74 = edi->ptr0000;
			eax_44 = (word32) *ecx_74;
			edi->ptr0000 = ecx_74 + 0x01;
			ecx_20 = ecx_30 + 0x07;
		}
		eax_21 = eax_44 * 0x02;
	} while ((eax_44 >> 0x07 & 0x01) != 0x00);
	edi->dw0008 = eax_21;
	edi->dw000C = ecx_20;
	return ebp_12;
}

// 00401640: Register Eq_471 fn00401640(Register word32 ebx, Register ptr32 ebp)
LCID fn00401640(word32 ebx, ptr32 ebp)
{
	__align(fp - 0x04);
	ui32 ecx_19 = 877;
	word32 edx_20 = 0x06;
	do
	{
		ecx_19 = ecx_19 << 0x04;
		if (ecx_19 == 0x00)
			ecx_19 = 0x09;
		edx_20 = edx_20 - 0x01;
	} while (edx_20 != 0x00);
	Eq_292 edi_37 = globals->t40537C;
	CloseHandle(0x00);
	struct Eq_276 * edi_51;
	fn00401DE0(ecx_19 ^ fp - 0x02F4, edx_20, 0x00, edi_37, out edi_51);
	GetThreadLocale();
	Eq_275 esi_57 = (word32) edi_51[(edi_51->ptr003C + 22) / 0x0040];
	byte * edx_82;
	fn00401D70(fp - 0x02D8, fp - 0x02C0, 11, out edx_82);
	word32 ecx_102;
	word32 edx_103;
	<anonymous> * eax_104 = fn00401480(fp - 0x02F4, edx_82, dwLoc0206 + 11, esi_57, edi_51, LoadLibraryA(fp - 0x02D8), 3321835334, out ecx_102, out edx_103);
	struct Eq_2 * esp_118;
	word32 ebp_119;
	byte SCZO_120;
	word32 ebx_121;
	word32 esi_122;
	word32 ecx_124;
	word32 edx_125;
	bool Z_126;
	word32 eax_127;
	byte SZO_128;
	bool C_129;
	byte al_130;
	byte bl_131;
	word16 si_132;
	bool S_133;
	struct Eq_577 * fs_134;
	union Eq_578 * edi_123;
	eax_104();
	esp_118->dw007B = (word32) GetLastError() + esp_118->dw007B;
	*(esp_118 - 0x04) = (union Eq_578 **) edi_123;
	fn00401000(esp_118, dwArg00);
	union Eq_578 * eax_147 = edi_123;
	word32 ecx_149 = 0x000147FF;
	do
	{
		*eax_147 = (union Eq_578 *) ((char *) *eax_147 + 0x00005C16);
		eax_147 = (union Eq_578 *) ((char *) eax_147 + 0x04);
		ecx_149 = ecx_149 - 0x01;
	} while (ecx_149 != 0x00);
	struct Eq_614 * ecx_160 = (struct Eq_614 *) 0x6B;
	word32 edx_161 = 11;
	do
	{
		ecx_160 = ecx_160 - 0x0A;
		esp_118->ptr002C = ecx_160;
		if (ecx_160 == null)
		{
			esp_118->ptr002C = (struct Eq_614 *) 0x06;
			ecx_160 = (struct Eq_614 *) 0x06;
		}
		edx_161 = edx_161 - 0x01;
	} while (edx_161 != 0x00);
	*(esp_118 - 0x04) = edx_161;
	GetModuleHandleA(*(esp_118 - 0x04));
	Eq_272 eax_181 = esp_118->t0030;
	word32 ebp_182 = Mem177[edi_123 + 0x3C:word32] + edi_123;
	ebp_182->w0016 = si_132;
	struct Eq_657 * esi_184 = ebp_182->ptr00A0;
	esp_118->ptr002C = ebp_182;
	ebp_182->t00C0 = eax_181;
	if (esi_184 != null)
	{
		esi_184 = esi_184 + Mem190[0x0040537C:word32];
		edi_123 = esp_118->ptr01B9;
		esp_118->dw018C = esp_118->dw018C & GetLastError();
		word32 edx_408 = globals->t40537C - ebp_182->dw0034;
		if (esi_184->dw0000 != 0x00)
		{
			do
			{
				Eq_710 eax_419 = esi_184[0x01];
				word16 * ecx_425 = esi_184 + 0x02;
				if (eax_419 - 0x08 >> 0x01 > 0x00)
				{
					edi_123 = eax_419 - 0x08 >> 0x01;
					do
					{
						ui32 eax_439 = (word32) *ecx_425;
						if ((eax_439 & 0xF000) == 0x3000)
						{
							word32 * eax_457 = (word32) globals->t40537C + ((eax_439 & 0x0FFF) + esi_184->dw0000);
							*eax_457 = *eax_457 + edx_408;
						}
						ecx_425 = ecx_425 + 0x01;
						edi_123 = edi_123 - 0x01;
					} while (edi_123 != null);
				}
				esi_184 = esi_184 + Mem404[esi_184 + 0x04:word32];
			} while (esi_184->dw0000 != 0x00);
		}
	}
	if (ebp_182->dw0080 != 0x00)
	{
		*(esp_118 - 0x04) = 0x00;
		esp_118->dw01C5 = (word32) GetModuleHandleA(*(esp_118 - 0x04)) + esp_118->dw01C5;
		esi_184 = esi_184 + edi_123;
		struct Eq_802 * ebp_277 = (word32) globals->t40537C + ebp_182->dw0080;
		if (ebp_277->dw0010 != 0x00)
		{
			do
			{
				*(esp_118 - 0x04) = (word32) globals->t40537C + ebp_277->dw000C;
				Eq_272 eax_310 = LoadLibraryA(*(esp_118 - 0x04));
				esp_118->t0030 = eax_310;
				Eq_272 ecx_312 = eax_310;
				if (eax_310 != 0x00)
				{
					word32 edi_333 = ebp_277->dw0000;
					if (edi_333 == 0x00)
						edi_333 = ebp_277->dw0010;
					Eq_292 eax_338 = globals->t40537C;
					word32 * edi_340 = (word32) eax_338 + edi_333;
					esi_184 = (word32) eax_338 + ebp_277->dw0010;
					int32 eax_343 = *edi_340;
					if (eax_343 != 0x00)
					{
						while (true)
						{
							int32 eax_364;
							if (eax_343 < 0x00)
							{
								esp_118->dw0261 = esp_118->dw0261 + eax_343;
								esp_118->dw0276 = esp_118->dw0276 - eax_343;
								eax_364 = (word32) *edi_340;
							}
							else
								eax_364 = (word32) globals->t40537C + (eax_343 + 0x02);
							*(esp_118 - 0x04) = eax_364;
							*(esp_118 - 0x08) = (union Eq_272 *) ecx_312;
							esi_184->dw0000 = (int32) GetProcAddress(*(esp_118 - 0x08), *(esp_118 - 0x04));
							edi_340 = edi_340 + 0x01;
							eax_343 = *edi_340;
							esi_184 = esi_184 + 0x01;
							if (eax_343 == 0x00)
								break;
							ecx_312 = esp_118->t0030;
						}
					}
				}
				ebp_277 = ebp_277 + 0x01;
			} while (ebp_277->dw0010 != 0x00);
		}
		ebp_182 = esp_118->ptr002C;
	}
	<anonymous> * ecx_216 = (word32) globals->t40537C + ebp_182->dw0028;
	esp_118->ptr0014 = null;
	globals->ptr405384 = ecx_216;
	*(esp_118 - 0x04) = (struct Eq_657 **) esi_184;
	esp_118->ptr0014 = fs_134->ptr0030;
	struct Eq_772 * esi_229 = esp_118->ptr0014->ptr000C->ptr000C;
	do
		esi_229 = esi_229->ptr0000;
	while (esi_229->t0018 != globals->t40537C);
	Eq_471 eax_244 = GetThreadLocale();
	esi_229->ptr001C = globals->ptr405384;
	&esp_118->t0030.u0->unused = 0x00;
	word32 ecx_249 = 22;
	do
	{
		eax_244 = eax_244 - esp_118->t0030;
		ecx_249 = ecx_249 - 0x01;
	} while (ecx_249 != 0x00);
	return eax_244;
}

// 00401980: Register word32 fn00401980(Register (ptr32 byte) ecx, Register out ptr32 ecxOut, Register out ptr32 edxOut, Register out ptr32 ebxOut)
word32 fn00401980(byte * ecx, ptr32 & ecxOut, ptr32 & edxOut, ptr32 & ebxOut)
{
	CloseHandle(0x00);
	GetLastError();
	GetModuleHandleA(0x00);
	uint32 ecx_39 = 788;
	word32 edx_40 = 0x09;
	do
	{
		ecx_39 = ecx_39 >> 0x07;
		if (ecx_39 == 0x00)
			ecx_39 = 0x08;
		edx_40 = edx_40 - 0x01;
	} while (edx_40 != 0x00);
	Eq_272 eax_65 = GetModuleHandleA(*esp_57);
	word32 esp_75;
	word32 ebp_76;
	byte SCZO_77;
	<anonymous> * ebx_78;
	word32 esi_79;
	word32 edi_80;
	word32 eax_81;
	byte SZO_82;
	bool C_83;
	word32 ecx_84;
	word32 edx_85;
	bool Z_86;
	byte CZ_87;
	ebx_62();
	ptr32 esp_88;
	word32 ebp_89;
	byte SCZO_90;
	word32 ebx_91;
	<anonymous> * esi_92;
	word32 edi_93;
	word32 eax_94;
	byte SZO_95;
	bool C_96;
	word32 ecx_97;
	word32 edx_98;
	bool Z_99;
	byte CZ_100;
	ebx_78();
	uint32 ecx_101 = 0xBA;
	word32 edx_102 = 0x0A;
	do
	{
		ecx_101 = ecx_101 >> 0x01;
		if (ecx_101 == 0x00)
			ecx_101 = 0x00;
		edx_102 = edx_102 - 0x01;
	} while (edx_102 != 0x00);
	*(esp_88 - 0x04) = edx_102;
	ptr32 esp_125;
	word32 ebp_126;
	byte SCZO_127;
	word32 ebx_128;
	word32 esi_129;
	<anonymous> * edi_130;
	word32 eax_131;
	byte SZO_132;
	bool C_133;
	word32 ecx_134;
	word32 edx_135;
	bool Z_136;
	Eq_1062 CZ_137;
	esi_92();
	word32 edx_140 = 0x30;
	do
	{
		CZ_137 = DPB(CZ_137, false, 0);
		edx_140 = edx_140 - 0x01;
	} while (edx_140 != 0x00);
	*(esp_125 - 0x04) = edx_140;
	ptr32 esp_171;
	word32 ebp_172;
	byte SCZO_173;
	word32 ebx_174;
	word32 esi_175;
	<anonymous> * edi_176;
	word32 eax_177;
	byte SZO_178;
	bool C_179;
	word32 ecx_180;
	word32 edx_181;
	bool Z_182;
	byte CZ_183;
	edi_130();
	*(esp_171 - 0x04) = 0x00;
	word32 esp_186;
	word32 ebp_187;
	byte SCZO_188;
	<anonymous> * ebx_189;
	word32 esi_190;
	word32 edi_191;
	word32 eax_192;
	byte SZO_193;
	bool C_194;
	word32 ecx_195;
	word32 edx_196;
	bool Z_197;
	byte CZ_198;
	edi_176();
	word32 eax_203 = 0x02;
	do
		eax_203 = eax_203 - 0x01;
	while (eax_203 != 0x00);
	ptr32 esp_218;
	word32 ebp_219;
	byte SCZO_220;
	word32 ebx_221;
	word32 esi_222;
	<anonymous> * edi_223;
	word32 eax_224;
	byte SZO_225;
	bool C_226;
	word32 ecx_227;
	word32 edx_228;
	bool Z_229;
	byte CZ_230;
	ebx_189();
	Eq_471 eax_240 = GetThreadLocale();
	*(esp_218 - 0x04) = 0x00;
	word32 esp_244;
	word32 ebp_245;
	byte SCZO_246;
	word32 ebx_247;
	<anonymous> * esi_248;
	word32 edi_249;
	word32 eax_250;
	byte SZO_251;
	bool C_252;
	word32 ecx_253;
	word32 edx_254;
	bool Z_255;
	byte CZ_256;
	edi_223();
	word32 ecx_268 = 0x08;
	do
		ecx_268 = ecx_268 - 0x01;
	while (ecx_268 != 0x00);
	ptr32 esp_276;
	word32 ebp_277;
	byte SCZO_278;
	word32 ebx_279;
	word32 esi_280;
	word32 edi_281;
	word32 eax_282;
	byte SZO_283;
	bool C_284;
	word32 ecx_285;
	word32 edx_286;
	bool Z_287;
	byte CZ_288;
	esi_248();
	GetLastError();
	*(esp_276 - 0x04) = 0x00;
	CloseHandle(*(esp_276 - 0x04));
	word32 ecx_308 = 0x14;
	do
		ecx_308 = ecx_308 - 0x01;
	while (ecx_308 != 0x00);
	*(esp_276 - 0x04) = ecx_308;
	GetModuleHandleA(*(esp_276 - 0x04));
	uint32 ecx_325 = 0x030F;
	word32 edi_326 = 0x09;
	do
	{
		uint32 edx_331 = SLICE(ecx_325 * 0x24924925, word32, 32);
		uint32 ecx_334 = (ecx_325 - edx_331 >> 0x01) + edx_331;
		ecx_325 = ecx_334 >> 0x02;
		if (ecx_334 >> 0x02 == 0x00)
			ecx_325 = 0x02;
		edi_326 = edi_326 - 0x01;
	} while (edi_326 != 0x00);
	GetThreadLocale();
	*(esp_276 - 0x04) = edi_326;
	CloseHandle(*(esp_276 - 0x04));
	*(esp_355 - 0x04) = edi_360;
	ptr32 esp_380;
	word32 ebp_381;
	byte SCZO_382;
	word32 ebx_383;
	<anonymous> * esi_384;
	word32 edi_385;
	word32 eax_386;
	byte SZO_387;
	bool C_388;
	word32 ecx_389;
	word32 edx_390;
	bool Z_391;
	byte CZ_392;
	esi_359();
	*(esp_380 - 0x04) = edi_385;
	ptr32 esp_395;
	word32 ebp_396;
	byte SCZO_397;
	word32 ebx_398;
	<anonymous> * esi_399;
	word32 edi_400;
	word32 eax_401;
	byte SZO_402;
	bool C_403;
	word32 ecx_404;
	word32 edx_405;
	bool Z_406;
	byte CZ_407;
	esi_384();
	uint32 ecx_412 = 0x024E;
	word32 edi_413 = 22;
	do
	{
		uint32 edx_418 = SLICE(ecx_412 * 0x24924925, word32, 32);
		uint32 ecx_421 = (ecx_412 - edx_418 >> 0x01) + edx_418;
		ecx_412 = ecx_421 >> 0x02;
		if (ecx_421 >> 0x02 != 0x00)
			ecx_412 = 0x05;
		edi_413 = edi_413 - 0x01;
	} while (edi_413 != 0x00);
	*(esp_395 - 0x04) = 0x00;
	GetModuleHandleA(*(esp_395 - 0x04));
	word32 eax_443 = 0x01CC;
	word32 edx_444 = 0x0E;
	do
	{
		eax_443 = eax_443 - 0x01;
		if (eax_443 != 0x00)
			eax_443 = 0x01;
		edx_444 = edx_444 - 0x01;
	} while (edx_444 != 0x00);
	GetThreadLocale();
	uint32 eax_463 = 900;
	word32 edx_464 = 0x0F;
	do
	{
		eax_463 = eax_463 >> 0x03;
		if (eax_463 == 0x00)
			eax_463 = 0x06;
		edx_464 = edx_464 - 0x01;
	} while (edx_464 != 0x00);
	*(esp_395 - 0x04) = edx_464;
	ptr32 esp_483;
	word32 ebp_484;
	byte SCZO_485;
	word32 ebx_486;
	word32 esi_487;
	<anonymous> * edi_488;
	word32 eax_489;
	byte SZO_490;
	bool C_491;
	word32 ecx_492;
	word32 edx_493;
	bool Z_494;
	byte CZ_495;
	esi_399();
	*(esp_483 - 0x04) = 0x00;
	ptr32 esp_511;
	word32 ebp_512;
	byte SCZO_513;
	word32 ebx_514;
	word32 esi_515;
	word32 edi_516;
	word32 eax_517;
	byte SZO_518;
	bool C_519;
	word32 ecx_520;
	word32 edx_521;
	bool Z_522;
	byte CZ_523;
	edi_488();
	word32 ecx_524 = 0x026A;
	word32 edx_525 = 0x0D;
	do
	{
		ecx_524 = ecx_524 + 0x08;
		if (ecx_524 == 0x00)
			ecx_524 = 0x01;
		edx_525 = edx_525 - 0x01;
	} while (edx_525 != 0x00);
	*(esp_511 - 0x04) = edx_525;
	CloseHandle(*(esp_511 - 0x04));
	GetThreadLocale();
	word32 ecx_562 = 0x0160;
	word32 edx_563 = 0x09;
	do
	{
		ecx_562 = ecx_562 - 0x06;
		if (ecx_562 == 0x00)
			ecx_562 = 0x01;
		edx_563 = edx_563 - 0x01;
	} while (edx_563 != 0x00);
	*(esp_511 - 0x04) = edx_563;
	GetModuleHandleA(*(esp_511 - 0x04));
	*(esp_511 - 0x04) = 0x00;
	GetModuleHandleA(*(esp_511 - 0x04));
	word32 edx_595 = 0x02;
	do
		edx_595 = edx_595 - 0x01;
	while (edx_595 != 0x00);
	GetLastError();
	word32 edx_622 = 0x0F;
	ui32 ecx_624 = 0x0168;
	do
	{
		ui32 ecx_629 = ecx_624 * 0x05;
		ecx_624 = ecx_629 * 0x02;
		if (ecx_629 * 0x02 == 0x00)
			ecx_624 = 0x0A;
		edx_622 = edx_622 - 0x01;
	} while (edx_622 != 0x00);
	GetThreadLocale();
	word32 ecx_644 = 0x09;
	do
		ecx_644 = ecx_644 - 0x01;
	while (ecx_644 != 0x00);
	*(esp_511 - 0x04) = ecx_644;
	GetModuleHandleA(*(esp_511 - 0x04));
	ptr32 esp_673;
	word32 ebp_674;
	byte SCZO_675;
	word32 ebx_676;
	<anonymous> * esi_677;
	word32 edi_678;
	word32 eax_679;
	byte SZO_680;
	bool C_681;
	word32 ecx_682;
	word32 edx_683;
	bool Z_684;
	byte CZ_685;
	ebx_662();
	*(esp_673 - 0x04) = 0x00;
	CloseHandle(*(esp_673 - 0x04));
	*(esp_673 - 0x04) = 0x00;
	CloseHandle(*(esp_673 - 0x04));
	GetThreadLocale();
	ui32 ecx_718 = 0x0204;
	word32 edx_719 = 0x1D;
	do
	{
		ui32 ecx_725 = ecx_718 * 0x02;
		ecx_718 = ecx_725 * 0x04;
		if (ecx_725 * 0x04 == 0x00)
			ecx_718 = 0x08;
		edx_719 = edx_719 - 0x01;
	} while (edx_719 != 0x00);
	*(esp_673 - 0x04) = edx_719;
	struct Eq_1542 * esp_740;
	word32 ebp_741;
	byte SCZO_742;
	word32 ebx_743;
	word32 esi_744;
	word32 edi_745;
	word32 eax_746;
	byte SZO_747;
	bool C_748;
	word32 ecx_749;
	word32 edx_750;
	bool Z_751;
	byte CZ_752;
	esi_677();
	word32 ebx_757;
	*ebxOut = esp_740->dw0008;
	return eax_746;
}

// 00401D70: Register (ptr32 byte) fn00401D70(Register (ptr32 byte) eax, Register (ptr32 byte) ecx, Register word32 ebx, Register out ptr32 edxOut)
byte * fn00401D70(byte * eax, byte * ecx, word32 ebx, ptr32 & edxOut)
{
	*edxOut = edx;
	byte * esi_10 = ecx;
	byte * edi_12 = eax;
	cu8 al_14 = *ecx;
	if (al_14 != 0x00)
	{
		do
		{
			ui8 al_112;
			cu8 cl_55 = al_14 - 0x41;
			ecx = DPB(ecx, cl_55, 0);
			if (cl_55 <= 0x19)
			{
				int32 edx_86 = (int32) ((int64) ((int32) al_14 - 0x41 + ebx) % 0x1A);
				byte dl_87 = (byte) edx_86;
				ecx = (byte *) 0x1A;
				*edxOut = DPB(edx_86, dl_87 + 0x41, 0);
				al_112 = dl_87 + 0x41;
			}
			else if (al_14 <= 122 && al_14 >= 0x61)
			{
				int32 edx_106 = (int32) ((int64) ((int32) al_14 - 0x61 + ebx) % 0x1A);
				byte dl_107 = (byte) edx_106;
				ecx = (byte *) 0x1A;
				*edxOut = DPB(edx_106, dl_107 + 0x61, 0);
				al_112 = dl_107 + 0x61;
			}
			else
			{
				byte dl_117 = 0x1A - bl;
				*edxOut = DPB(edx, dl_117, 0);
				al_112 = al_14 ^ dl_117;
			}
			*edi_12 = al_112;
			esi_10 = esi_10 + 0x01;
			al_14 = *esi_10;
			edi_12 = edi_12 + 0x01;
		} while (al_14 != 0x00);
	}
	return ecx;
}

// 00401DE0: Register word32 fn00401DE0(Register ui32 ecx, Register word32 edx, Register word32 ebx, Register Eq_292 edi, Register out ptr32 ediOut)
word32 fn00401DE0(ui32 ecx, word32 edx, word32 ebx, Eq_292 edi, ptr32 & ediOut)
{
	GetModuleHandleA(0x00);
	GetThreadLocale();
	GetLastError();
	word32 edx_66;
	fn00401D70(fp - 0x18, fp - 88, 0x13, out edx_66);
	Eq_272 eax_71 = LoadLibraryA(fp - 0x18);
	GetLastError();
	Eq_929 eax_90 = GetProcAddress(eax_71, 202);
	CloseHandle(0x00);
	CloseHandle(0x00);
	<anonymous> * eax_115 = eax_90();
	word32 ebx_112 = <invalid>;
	ptr32 esp_109 = fp - 0x02E4;
	if (eax_115 == null)
	{
		word32 ebp_288;
		byte SCZO_289;
		word32 esi_291;
		word32 edi_292;
		word32 eax_293;
		byte SZO_294;
		bool C_295;
		word32 edx_296;
		word32 ecx_297;
		byte al_298;
		bool Z_299;
		word16 di_300;
		eax_115();
	}
	union Eq_292 * esp_129 = esp_109 - 0x04;
	*esp_129 = (union Eq_292 *) 0x00;
	GetModuleHandleA(*esp_129);
	*esp_129 = (union Eq_292 *) 0xA7;
	*(esp_129 - 0x04) = ebx_112;
	GetProcAddress(*(esp_129 - 0x04), *esp_129);
	GetLastError();
	GetThreadLocale();
	*esp_129 = (union Eq_292 *) (fp - 0x28);
	*(esp_129 - 0x04) = fp - 0x38;
	*(esp_129 - 0x08) = fp - 0x48;
	word32 ebp_166;
	byte SCZO_167;
	word32 ebx_168;
	<anonymous> * esi_169;
	word32 edi_170;
	<anonymous> * eax_171;
	byte SZO_172;
	bool C_173;
	word32 edx_174;
	word32 ecx_175;
	byte al_176;
	bool Z_177;
	word16 di_178;
	word32 esp_165;
	OLEAUT32.dll!Ordinal_318();
	if ((fp - 0x48 & fp - 0x48) != 0x00)
	{
		word32 ebp_272;
		byte SCZO_273;
		word32 ebx_274;
		word32 esi_275;
		word32 edi_276;
		word32 eax_277;
		byte SZO_278;
		bool C_279;
		word32 edx_280;
		word32 ecx_281;
		byte al_282;
		bool Z_283;
		word16 di_284;
		eax_171();
	}
	union Eq_1769 * esp_184 = esp_165 - 0x04;
	*esp_184 = (union Eq_1769 *) (fp - 0x28);
	*(esp_184 - 0x04) = (union Eq_1774 *) (fp - 0x38);
	*(esp_184 - 0x08) = (union Eq_1781 *) (fp - 0x48);
	word32 ebp_193;
	byte SCZO_194;
	word32 ebx_195;
	word32 esi_196;
	word32 edi_197;
	byte SZO_199;
	bool C_200;
	word32 edx_201;
	word32 ecx_202;
	byte al_203;
	bool Z_204;
	<anonymous> * eax_198;
	word16 di_205;
	struct Eq_1800 * esp_192;
	esi_169();
	if (eax_198 != null)
	{
		word32 ebp_258;
		byte SCZO_259;
		word32 ebx_260;
		word32 esi_261;
		word32 edi_262;
		byte SZO_264;
		bool C_265;
		word32 edx_266;
		word32 ecx_267;
		byte al_268;
		bool Z_269;
		eax_198();
	}
	if (wLoc28 != di_205)
	{
		word32 ebp_244;
		byte SCZO_245;
		word32 ebx_246;
		word32 esi_247;
		word32 edi_248;
		word32 eax_249;
		byte SZO_250;
		bool C_251;
		word32 edx_252;
		word32 ecx_253;
		byte al_254;
		bool Z_255;
		word16 di_256;
		eax_198();
	}
	word32 edi_233;
	*ediOut = esp_192->dw0000;
	return esp_192->dw0004;
}

// 00401F50: Register Eq_292 Win32CrtStartup()
Eq_292 Win32CrtStartup()
{
	uint32 ecx_11 = 0x01E5;
	word32 edx_12 = 0x10;
	do
	{
		ecx_11 = ecx_11 >> 0x07;
		if (ecx_11 == 0x00)
			ecx_11 = 0x04;
		edx_12 = edx_12 - 0x01;
	} while (edx_12 != 0x00);
	word32 eax_27 = 400;
	word32 edx_28 = 0x03;
	do
	{
		eax_27 = eax_27 - 0x04;
		if (eax_27 != 0x00)
			eax_27 = 0x00;
		edx_28 = edx_28 - 0x01;
	} while (edx_28 != 0x00);
	word32 ebx_50;
	if (fn00401FC0(ebx, fp - 0x04, edi, out ebx_50) != 0x00)
		fn00401640(ebx_50, fp - 0x04);
	word32 esp_66;
	word32 ebp_67;
	word32 ecx_68;
	word32 edx_69;
	byte SCZO_70;
	bool Z_71;
	Eq_292 eax_72;
	byte SZO_73;
	bool C_74;
	word32 ebx_75;
	word32 edi_76;
	globals->ptr405384();
	return eax_72;
}

// 00401FC0: Register word32 fn00401FC0(Register word32 ebx, Register ptr32 ebp, Register word32 edi, Register out ptr32 ebxOut)
word32 fn00401FC0(word32 ebx, ptr32 ebp, word32 edi, ptr32 & ebxOut)
{
	word32 ebp_32;
	byte SCZO_33;
	word32 esi_35;
	<anonymous> * eax_36;
	word16 ax_38;
	byte SZO_41;
	bool C_42;
	bool Z_43;
	byte dl_45;
	byte CZ_290;
	ui32 ecx_285;
	word32 edx_286;
	Eq_292 edi_283;
	word32 ebx_280;
	struct Eq_1925 * esp_277;
	OLEAUT32.dll!Ordinal_318();
	if ((fp - 0x44 & fp - 0x44) != 0x00)
	{
		word32 ebp_278;
		byte SCZO_279;
		word32 esi_281;
		word32 eax_282;
		word16 ax_284;
		byte SZO_287;
		bool C_288;
		bool Z_289;
		byte dl_291;
		eax_36();
	}
	if (globals->dw405378 == 0x00)
	{
		globals->dw405378 = 0x01;
		struct Eq_1951 * esp_99 = esp_277 - 0x04;
		esp_99->t0000.u0 = 4202432;
		struct Eq_276 * edi_101;
		fn00401DE0(ecx_285, edx_286, ebx_280, edi_283, out edi_101);
		globals->t40537C = esp_99->t0000;
		globals->t40537C.u0 = 0x00;
		Eq_292 eax_107 = globals->t40537C;
		word32 ecx_108 = *((word32) eax_107 + 0x003C);
		word32 esi_109 = *((word32) eax_107 + (ecx_108 + 0x50));
		esp_99->t0000.u0 = 0x40;
		*(esp_99 - 0x04) = 0x1000;
		*(esp_99 - 0x08) = esi_109;
		*(esp_99 - 0x0C) = 0x00;
		Eq_2003 eax_121 = VirtualAlloc(*(esp_99 - 0x0C), *(esp_99 - 0x08), *(esp_99 - 0x04), esp_99->t0000);
		globals->t405380 = eax_121;
		struct Eq_2030 * ecx_112 = (word32) eax_107 + ecx_108;
		struct Eq_2032 * ebx_120 = &globals->dw403038;
		if (!DPB(CZ_290, false, 0))
		{
			Eq_2003 ecx_266 = eax_121;
			edi_101 = globals->t40537C - eax_121;
			do
			{
				Mem272[ecx_266 + 0x00:byte] = Mem127[edi_101 + ecx_266:byte];
				ecx_266 = ecx_266 + 0x01;
				esi_109 = esi_109 - 0x01;
			} while (esi_109 != 0x00);
		}
		Eq_275 eax_131 = eax_121 - globals->t40537C;
		if (globals->dw403038 != 0x00)
		{
			do
			{
				word32 edx_205 = 0x17;
				do
					edx_205 = edx_205 - 0x01;
				while (edx_205 != 0x00);
				uint32 eax_224 = ebx_120->t0004 - 0x08 >> 0x01;
				word16 * ecx_228 = (char *) &ebx_120->t0004 + 0x04;
				if (eax_224 != 0x00)
				{
					uint32 edx_238 = eax_224;
					do
					{
						ui32 eax_244 = (word32) *ecx_228;
						edi_101 = eax_244 & 0xF000;
						if ((eax_244 & 0xF000) == 0x3000)
						{
							edi_101 = ebx_120->ptr0000;
							word32 * eax_260 = edi_101 + ((word32) globals->t405380 + (eax_244 & 0x0FFF)) / 0x0040;
							*eax_260 = (char *) eax_131 + *eax_260;
						}
						ecx_228 = ecx_228 + 0x01;
						edx_238 = edx_238 - 0x01;
					} while (edx_238 != 0x00);
				}
				ebx_120 = ebx_120 + Mem127[ebx_120 + 0x04:word32];
			} while (ebx_120->ptr0000 != null);
		}
		esp_99->t0000.u0 = 0x00;
		CloseHandle(esp_99->t0000);
		byte * edx_153;
		fn00401D70(fp - 0x10, &globals->b42A8B8, 0x10, out edx_153);
		esp_99->t0000 = fp - (byte *) 0x10;
		Eq_272 eax_158 = LoadLibraryA(esp_99->t0000);
		esp_99->t0000.u0 = 35392525;
		*(esp_99 - 0x04) = (union Eq_272 *) eax_158;
		word32 ecx_166;
		word32 edx_167;
		if (fn00401480(eax_158, edx_153, 0x10, eax_131, edi_101, dwArg00, dwArg04, out ecx_166, out edx_167) == null)
			globals->ptr405384 = (word32) globals->t405380 + ecx_112->dw0028;
		word32 ebx_186;
		*ebxOut = esp_99->dw000C;
		return 0x00;
	}
	else
	{
		word32 ebx_90;
		*ebxOut = esp_277->dw0008;
		return 0x01;
	}
}

