// subject.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

// 0055A4D0: Register DWORD Win32CrtStartup()
DWORD Win32CrtStartup()
{
	word32 esp_1 = fp;
	word32 edi_102 = 0x0055B200;
	word32 esi_100 = 0x0055B200;
	word32 ebx_17 = 5617276;
l0055A4EF:
	word32 esp_27 = esp_1 - 0x04;
	Mem28[esp_27 + 0x00:word32] = 0x00;
	Mem31[esp_27 - 0x04 + 0x00:word32] = esp_27;
	Mem33[esp_27 - 0x08 + 0x00:word32] = esp_27;
	Mem35[esp_27 - 0x0C + 0x00:word32] = esp_27;
	Mem37[esp_27 - 0x10 + 0x00:word32] = 0x00;
	Mem39[esp_27 - 0x14 + 0x00:word32] = 0x00;
	word32 eax_40 = GetTapePosition(Mem39[esp_27 - 0x14 + 0x00:HANDLE], Mem39[esp_27 - 0x10 + 0x00:DWORD], Mem39[esp_27 - 0x0C + 0x00:LPDWORD], Mem39[esp_27 - 0x08 + 0x00:LPDWORD], Mem39[esp_27 - 0x04 + 0x00:LPDWORD]);
	word32 edx_29 = esp_27;
	word32 ecx_42 = Mem39[esp_27 + 0x00:word32];
	esp_1 = esp_27 + 0x04;
	word32 eax_46 = eax_40 + ~0x40DC2006;
	byte al_47 = (byte) (eax_40 + ~0x40DC2006);
	do
	{
		Mem65[edi_102 + 0x00:word32] = Mem39[edi_102 + 0x00:word32] + eax_46;
		Mem67[edi_102 + 0x00:word32] = __ror(Mem65[edi_102 + 0x00:word32], 0x10);
		word32 edi_68 = edi_102 + 0x12;
		edi_102 = edi_68 - 0x0E;
		if (edi_68 - 0x0E <= ebx_17)
			goto l0055A4EF;
		byte cl_79;
		word16 si_82;
		word16 di_83;
		fn0055B200(eax_46, ecx_42, edx_29, ebx_17, ebp, esi_100, edi_68 - 0x0E, rArg0, out eax_46, out cl_79, out edx_29, out ebx_17, out si_82, out di_83, out rArg0);
		__outb(0xC5, al_47);
		word32 esp_86 = esp_1 + 0x06;
		ebp = Mem67[esp_86 + 0x00:word32];
		Mem92[edi_68 - 0x0E + 0x00:byte] = al_47;
		ecx_42 = DPB(ecx_42, 0x2B, 8);
		esp_1 = esp_86 + 0x04;
		esi_100 = DPB(esi_100, si_82 + 0x01, 0);
		edi_102 = DPB(edi_68 - 0x0D, (word16) (edi_68 - 0x0D) + 0x01, 0);
	} while (P);
	Mem109[edi_102 + 0x00:byte] = Mem92[esi_100 + 0x00:byte];
}

// 0055B1C4: void fn0055B1C4(Register word32 eax, Register word32 ecx, Register word32 edx, Register word32 ebx, Register word32 ebp, Register word32 esi, Register word32 edi)
void fn0055B1C4(word32 eax, word32 ecx, word32 edx, word32 ebx, word32 ebp, word32 esi, word32 edi)
{
	byte al_6;
	byte ah_7;
	__aas((byte) (eax - 0x01), SLICE(eax - 0x01, byte, 8), &al_6, &ah_7);
	word32 v10_12 = Mem0[edi + 77:word32] + edx;
	Mem13[edi + 77:word32] = v10_12;
	byte al_22;
	byte ah_23;
	__aas((byte) (eax - 0x02), SLICE(eax - 0x02, byte, 8), &al_22, &ah_23);
	word32 ebx_17 = ebx + edi + (v10_12 <u 0x00);
	fn0055B1CF(eax - 0x02, ecx, edx, ebx_17, ebp, esi, edi);
}

// 0055B1CF: void fn0055B1CF(Register word32 eax, Register word32 ecx, Register word32 edx, Register word32 ebx, Register word32 ebp, Register word32 esi, Register word32 edi)
void fn0055B1CF(word32 eax, word32 ecx, word32 edx, word32 ebx, word32 ebp, word32 esi, word32 edi)
{
	ptr32 fp;
	word32 edi;
	<type-error> Mem0;
	word32 edx;
	word32 ebx;
	word32 eax;
	word32 esi;
	word32 ecx;
	word32 ebp;
	esp_1 = fp;
	v5_5 = Mem0[edi + 77:word32] + edx;
	Mem6[edi + 77:word32] = v5_5;
	SCZO_7 = cond(v5_5);
	C_8 = (bool) SCZO_7;
	ebx_10 = ebx + edi + (v5_5 <u 0x00);
	eax_12 = eax - 0x01;
	al_13 = (byte) eax_12;
	ah_14 = SLICE(eax_12, byte, 8);
	C_17 = __aas(al_13, ah_14, &al_15, &ah_16);
	v13_18 = Mem6[edi + 77:word32] + edx;
	Mem19[edi + 77:word32] = v13_18;
	SCZO_20 = cond(v13_18);
	C_21 = (bool) SCZO_20;
	ebx_22 = ebx_10 + edi + (v13_18 <u 0x00);
	eax_23 = eax_12 - 0x01;
	al_24 = (byte) eax_23;
	ah_25 = SLICE(eax_23, byte, 8);
	C_28 = __aas(al_24, ah_25, &al_26, &ah_27);
	v14_29 = Mem19[edi + 77:word32] + edx;
	Mem30[edi + 77:word32] = v14_29;
	SCZO_31 = cond(v14_29);
	C_32 = (bool) SCZO_31;
	ebx_33 = ebx_22 + edi + (v14_29 <u 0x00);
	eax_34 = eax_23 - 0x01;
	al_35 = (byte) eax_34;
	ah_36 = SLICE(eax_34, byte, 8);
	C_39 = __aas(al_35, ah_36, &al_37, &ah_38);
	v15_40 = Mem30[edi + 77:word32] + edx;
	Mem41[edi + 77:word32] = v15_40;
	SCZO_42 = cond(v15_40);
	C_43 = (bool) SCZO_42;
	ebx_44 = ebx_33 + edi + (v15_40 <u 0x00);
	eax_45 = eax_34 - 0x01;
	al_46 = (byte) eax_45;
	ah_47 = SLICE(eax_45, byte, 8);
	C_50 = __aas(al_46, ah_47, &al_48, &ah_49);
	v16_51 = Mem41[edi + 77:word32] + edx;
	Mem52[edi + 77:word32] = v16_51;
	SCZO_53 = cond(v16_51);
	C_54 = (bool) SCZO_53;
	ebx_55 = ebx_44 + edi + (v16_51 <u 0x00);
	eax_56 = eax_45 - 0x01;
	al_57 = (byte) eax_56;
	ah_58 = SLICE(eax_56, byte, 8);
	C_61 = __aas(al_57, ah_58, &al_59, &ah_60);
	v17_62 = Mem52[edi + 77:word32] + edx;
	Mem63[edi + 77:word32] = v17_62;
	SCZO_64 = cond(v17_62);
	C_65 = (bool) SCZO_64;
	ebx_66 = ebx_55 + edi + (v17_62 <u 0x00);
	eax_67 = eax_56 - 0x01;
	al_68 = (byte) eax_67;
	ah_69 = SLICE(eax_67, byte, 8);
	C_72 = __aas(al_68, ah_69, &al_70, &ah_71);
	v19_74 = (edi + 0x31)[esi * 0x02] + edx;
	(edi + 0x31)[esi * 0x02] = v19_74;
	SCZO_76 = cond(v19_74);
	SZO_77 = SCZO_76;
	C_78 = (bool) SCZO_76;
	fn0055B203(eax_67, ecx, ebx_66, ebp, esi, edi);
}

// 0055B200: FlagGroup bool fn0055B200(Register word32 eax, Register word32 ecx, Register word32 edx, Register word32 ebx, Register word32 ebp, Register word32 esi, Register word32 edi, FpuStack real64 rArg0, Register out ptr32 eaxOut, Register out ptr32 clOut, Register out ptr32 edxOut, Register out ptr32 ebxOut, Register out ptr32 siOut, Register out ptr32 diOut, FpuStack out ptr32 rArg0Out)
bool fn0055B200(word32 eax, word32 ecx, word32 edx, word32 ebx, word32 ebp, word32 esi, word32 edi, real64 rArg0, ptr32 & eaxOut, ptr32 & clOut, ptr32 & edxOut, ptr32 & ebxOut, ptr32 & siOut, ptr32 & diOut, ptr32 & rArg0Out)
{
	ptr32 fp;
	byte CZ;
	word32 ecx;
	bool FPUF;
	byte dl;
	ptr32 es_edx;
	word32 edx;
	word32 esi;
	ptr32 es_esi;
	selector ds;
	byte SO;
	bool S;
	bool O;
	byte SZO;
	word32 eax;
	word32 ebx;
	word16 si;
	ptr32 eaxOut;
	ptr32 clOut;
	ptr32 edxOut;
	ptr32 ebxOut;
	ptr32 siOut;
	ptr32 diOut;
	word32 ebp;
	word32 edi;
	bool C;
	real64 rArg0;
	byte cl;
	word16 bx;
	byte bl;
	byte bh;
	byte ah;
	byte al;
	word16 di;
	byte SCZO;
	<type-error> Mem0;
	selector ss;
	esp_1 = fp;
	v3_2 = fp;
	esp_3 = fp - 0x04;
	dwLoc04_4 = fp;
	if (CZ)
	{
l0055B234:
		ecx_67 = ϕ(ecx, ecx_94, ecx_94);
		FPUF_68 = ϕ(FPUF, FPUF_120, FPUF_120);
		dl_69 = ϕ(dl, dl_200, dl_200);
		es_edx_70 = ϕ(es_edx, es_edx_201, es_edx_201);
		edx_71 = ϕ(edx, edx_202, edx_202);
		esi_72 = ϕ(esi, esi_104, esi_104);
		es_esi_73 = ϕ(es_esi, es_esi_125, es_esi_125);
		ds_74 = ϕ(ds, ds_105, ds_105);
		SO_75 = ϕ(SO, SO_108, SO_108);
		S_76 = ϕ(S, S_109, S_109);
		O_77 = ϕ(O, O_197, O_197);
		esp_78 = ϕ(esp_3, esp_127, esp_127);
		SZO_79 = ϕ(SZO, SZO_196, SZO_196);
		eax_80 = ϕ(eax, eax_193, eax_193);
		ebx_81 = ϕ(ebx, ebx_100, ebx_100);
		si_82 = ϕ(si, si_113, si_113);
		CZ_83 = ϕ(CZ, CZ_114, CZ_114);
		v17_85 = Mem0[edi + 0x00:word32] + ebx_81;
		Mem86[edi + 0x00:word32] = v17_85;
		C_87 = true;
		v19_88 = Mem86[edx_71 + 0x00:byte] - 0x60 - C_87;
		Mem89[edx_71 + 0x00:byte] = v19_88;
		SCZO_90 = cond(v19_88);
		v20_91 = eax_80;
		eax_92 = ecx_67;
		al_93 = (byte) eax_92;
		ecx_94 = v20_91;
		cl_95 = (byte) ecx_94;
		ah_96 = ~0x49;
		eax_97 = DPB(eax_92, ah_96, 8);
		v23_98 = esp_78;
		esp_99 = ebx_81;
		ebx_100 = v23_98;
		bx_101 = (word16) ebx_100;
		bl_102 = (byte) ebx_100;
		bh_103 = SLICE(ebx_100, byte, 8);
		do
		{
			esi_104 = ϕ(esi_72, esi_130);
			ds_105 = ϕ(ds_74, ds_134);
			ah_106 = ϕ(ah_96, ah_143);
			al_107 = ϕ(al_93, al_144);
			SO_108 = ϕ(SO_75, SO_148);
			S_109 = ϕ(S_76, S_150);
			O_110 = ϕ(O_77, O_151);
			esp_111 = ϕ(esp_99, esp_135);
			eax_112 = ϕ(eax_97, eax_142);
			si_113 = ϕ(si_82, si_131);
			CZ_114 = ϕ(CZ_83, CZ_146);
			C_117 = __aas(al_107, ah_106, &al_115, &ah_116);
			v25_118 = Mem89[edx_71 + 0x085480F5:word32] + ecx_94;
			Mem119[edx_71 + 0x085480F5:word32] = v25_118;
			FPUF_120 = cond(rArg0 - (real64) Mem119[eax_112 + 0x43992001:word16]);
			ah_121 = ah_116 + Mem119[eax_112 + 0x00:byte];
			eax_122 = DPB(eax_112, ah_121, 8);
			SCZO_123 = cond(ah_121);
			SZO_124 = SCZO_123;
			es_esi_125 = Mem119[ecx_94 + 0x00:segptr32];
			esp_126 = Mem119[esp_111 + 0x00:word32];
			esp_127 = esp_126 + 0x04;
			if (ah_121 <= 0x00)
			{
				eax_193 = eax_122 + 0x01;
				ah_194 = SLICE(eax_193, byte, 8);
				al_195 = (byte) eax_193;
				SZO_196 = cond(eax_193);
				O_197 = (bool) SZO_196;
				v37_198 = Mem119[edx_71 + 55:byte];
				Mem199[edx_71 + 55:byte] = dl_69;
				dl_200 = v37_198;
				es_edx_201 = DPB(es_edx_70, dl_200, 0);
				edx_202 = DPB(edx_71, dl_200, 0);
				if (OVERFLOW(eax_193 - 0x00))
					__syscall(0x04);
				goto l0055B234;
			}
			ah_128 = FPUF_120;
			eax_129 = DPB(eax_122, ah_128, 8);
			esi_130 = Mem119[esp_127 + 0x00:word32];
			si_131 = (word16) esi_130;
			es_esi_132 = esi_130;
			esp_133 = esp_127 + 0x04;
			ds_134 = Mem119[esp_133 + 0x00:selector];
			esp_135 = esp_133 + 0x02;
			v31_136 = Mem119[eax_129 + 0x00:word16] - bx_101;
			Mem137[eax_129 + 0x00:word16] = v31_136;
			Mem139[ecx_94 - 0x17 + 0x00:word16] = ss;
			ah_140 = ah_128 & bl_102;
			eax_141 = DPB(eax_129, ah_140, 8);
			eax_142 = eax_141 + Mem139[ecx_94 + 0x00:word32];
			ah_143 = SLICE(eax_142, byte, 8);
			al_144 = (byte) eax_142;
			SCZO_145 = cond(eax_142);
			CZ_146 = SCZO_145;
			SZO_147 = SCZO_145;
			SO_148 = SCZO_145;
			C_149 = (bool) SCZO_145;
			S_150 = (bool) SCZO_145;
			O_151 = (bool) SCZO_145;
		} while (eax_142 >= 0x00);
		eax_152 = eax_142 + 0x01;
		ah_153 = SLICE(eax_152, byte, 8);
		al_154 = (byte) eax_152;
		SZO_155 = cond(eax_152);
		if (eax_142 >=u 0x00)
		{
			SZO_171 = cond(Mem139[ecx_94 + 0x1E:byte] & bl_102);
			esp_172 = esp_135 - 0x04;
			Mem173[esp_172 + 0x00:word32] = eax_152;
			eax_174 = eax_152 + 0x01;
			ah_175 = SLICE(eax_174, byte, 8);
			al_176 = (byte) eax_174;
			int3();
			v40_177 = Mem173[ebx_100 + 2072789212:word32] + ebp;
			Mem178[ebx_100 + 2072789212:word32] = v40_177;
			C_181 = __aaa(al_176, ah_175, &al_179, &ah_180);
			ebp_182 = ebp - 0x01;
			al_183 = al_179 - 171 - C_181;
			eax_184 = DPB(eax_174, al_183, 0);
			SCZO_185 = cond(al_183);
			SZO_186 = SCZO_185;
			SO_187 = SCZO_185;
			S_188 = (bool) SCZO_185;
			O_189 = (bool) SCZO_185;
			C_190 = false;
			CZ_191 = DPB(CZ_146, C_190, 0);
			SCZO_192 = DPB(SCZO_185, C_190, 0);
			return C_190;
		}
		else
		{
			ebp_156 = Mem139[esp_135 + 0x00:word32];
			esp_157 = esp_135 + 0x04;
			esp_158 = esp_157 - 0x04;
			Mem159[esp_158 + 0x00:word32] = ebx_100;
			v36_160 = Mem159[0xDC200141:byte] | bl_102;
			Mem161[0xDC200141:byte] = v36_160;
			SZO_162 = cond(Mem161[0xDC200141:byte]);
			C_163 = false;
			C_168 = fn0055B26F(eax_152, bl_102, bh_103, esi_130, edi, out eax_164, out ebx_165, out si_166, out di_167);
			CZ_169 = DPB(CZ_146, C_168, 0);
			SCZO_170 = DPB(SCZO_145, C_168, 0);
			return C_168;
		}
	}
	else
	{
		fn0055B203(eax, ecx, ebx, ebp, esi, edi);
		return C;
	}
}

// 0055B203: void fn0055B203(Register word32 eax, Register word32 ecx, Register word32 ebx, Register word32 ebp, Register word32 esi, Register word32 edi)
void fn0055B203(word32 eax, word32 ecx, word32 ebx, word32 ebp, word32 esi, word32 edi)
{
}

// 0055B214: FlagGroup bool fn0055B214(Register word32 eax, Register word32 ecx, Register word32 edx, Register word32 ebx, Register word32 ebp, Register word32 esi, Register word32 edi, FpuStack real64 rArg0, FpuStack real64 rArg1, Register out ptr32 eaxOut, Register out ptr32 ebxOut, Register out ptr32 siOut, Register out ptr32 diOut, FpuStack out ptr32 rArg0Out)
bool fn0055B214(word32 eax, word32 ecx, word32 edx, word32 ebx, word32 ebp, word32 esi, word32 edi, real64 rArg0, real64 rArg1, ptr32 & eaxOut, ptr32 & ebxOut, ptr32 & siOut, ptr32 & diOut, ptr32 & rArg0Out)
{
	*eaxOut = eax;
	*ebxOut = ebx;
	*siOut = si;
	*diOut = di;
	word32 v8_9 = Mem0[ecx + 0x601C80F5:word32] + ebp;
	Mem10[ecx + 0x601C80F5:word32] = v8_9;
	bool C_14 = (bool) cond(v8_9);
	if (v8_9 >= 0x00)
	{
		word32 eax_46;
		word32 ebx_47;
		word16 si_48;
		word16 di_49;
		return fn0055B271(al, ah, bl, bh, esi, edi, out eax_46, out ebx_47, out si_48, out di_49);
	}
	else if (v8_9 != 0x00 && ecx != 0x01)
	{
		fn0055B1CF(eax, ecx - 0x01, edx, ebx, ebp, esi, edi);
		return C_14;
	}
	else
		__hlt();
}

// 0055B26F: FlagGroup bool fn0055B26F(Register word32 eax, Register byte bl, Register byte bh, Register word32 esi, Register word32 edi, Register out ptr32 eaxOut, Register out ptr32 ebxOut, Register out ptr32 siOut, Register out ptr32 diOut)
bool fn0055B26F(word32 eax, byte bl, byte bh, word32 esi, word32 edi, ptr32 & eaxOut, ptr32 & ebxOut, ptr32 & siOut, ptr32 & diOut)
{
	byte al_4 = (byte) (eax + 0x01);
	byte ah_5 = SLICE(eax + 0x01, byte, 8);
	byte bh_8 = bh ^ bl;
	word32 eax_15;
	word32 ebx_16;
	word16 si_17;
	word16 di_18;
	return fn0055B272(al_4, ah_5, bl, bh_8, esi, edi, out eax_15, out ebx_16, out si_17, out di_18);
}

// 0055B271: FlagGroup bool fn0055B271(Register byte al, Register byte ah, Register byte bl, Register byte bh, Register word32 esi, Register word32 edi, Register out ptr32 eaxOut, Register out ptr32 ebxOut, Register out ptr32 siOut, Register out ptr32 diOut)
bool fn0055B271(byte al, byte ah, byte bl, byte bh, word32 esi, word32 edi, ptr32 & eaxOut, ptr32 & ebxOut, ptr32 & siOut, ptr32 & diOut)
{
	ptr32 fp;
	byte al;
	byte ah;
	byte bl;
	byte bh;
	word32 esi;
	word32 edi;
	byte SCZO;
	ptr32 eaxOut;
	ptr32 ebxOut;
	ptr32 siOut;
	ptr32 diOut;
	esp_1 = fp;
	__sti();
	C_12 = fn0055B272(al, ah, bl, bh, esi, edi, out eax_8, out ebx_9, out si_10, out di_11);
	SCZO_14 = DPB(SCZO, C_12, 0);
	return C_12;
}

// 0055B272: FlagGroup bool fn0055B272(Register byte al, Register byte ah, Register byte bl, Register byte bh, Register word32 esi, Register word32 edi, Register out ptr32 eaxOut, Register out ptr32 ebxOut, Register out ptr32 siOut, Register out ptr32 diOut)
bool fn0055B272(byte al, byte ah, byte bl, byte bh, word32 esi, word32 edi, ptr32 & eaxOut, ptr32 & ebxOut, ptr32 & siOut, ptr32 & diOut)
{
}

