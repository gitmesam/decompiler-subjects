// subject.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

// 00401000: void fn00401000(Stack word32 dwArg04, Stack word32 dwArg08, Stack word32 dwArg0C)
void fn00401000(word32 dwArg04, word32 dwArg08, word32 dwArg0C)
{
	word32 dwLoc08_15 = 0x00;
	while (dwLoc08_15 < dwArg0C)
	{
		Mem29[dwArg04 + dwLoc08_15:byte] = Mem0[dwArg08 + dwLoc08_15:byte];
		dwLoc08_15 = dwLoc08_15 + 0x01;
	}
}

// 00401040: void fn00401040(Stack word32 dwArg04, Stack word32 dwArg08, Stack word32 dwArg0C)
void fn00401040(word32 dwArg04, word32 dwArg08, word32 dwArg0C)
{
	if (dwArg0C >=u 0x01)
	{
		byte cl_46 = Mem0[dwArg04 + 0x00:byte];
		word32 dwLoc0C_113 = 0x01;
		word32 dwLoc18_109 = 0x00;
		do
		{
			word32 ecx_64 = dwLoc0C_113 + 0x01;
			byte al_61 = Mem0[dwArg04 + dwLoc0C_113:byte];
			dwLoc0C_113 = ecx_64;
			if ((word32) al_61 == (word32) cl_46)
			{
				if ((word32) Mem0[dwArg04 + ecx_64:byte] == 0x00)
				{
					Mem106[dwArg08 + dwLoc18_109:byte] = cl_46;
					dwLoc18_109 = dwLoc18_109 + 0x01;
					dwLoc0C_113 = ecx_64 + 0x01;
				}
				else
				{
					word32 eax_124 = fn00401150(fp - 0x10, dwArg04 + ecx_64) + ecx_64;
					dwLoc0C_113 = fn00401150(fp - 0x24, dwArg04 + eax_124) + eax_124;
					word32 dwLoc1C_139 = 0x00;
					while (dwLoc1C_139 <u dwLoc10)
					{
						Mem156[dwArg08 + dwLoc18_109:byte] = Mem0[dwArg08 + (dwLoc18_109 - dwLoc24):byte];
						dwLoc18_109 = dwLoc18_109 + 0x01;
						dwLoc1C_139 = dwLoc1C_139 + 0x01;
					}
				}
			}
			else
			{
				Mem168[dwArg08 + dwLoc18_109:byte] = al_61;
				dwLoc18_109 = dwLoc18_109 + 0x01;
			}
		} while (dwLoc0C_113 <u dwArg0C);
	}
}

// 00401150: Register word32 fn00401150(Stack word32 dwArg04, Stack word32 dwArg08)
word32 fn00401150(word32 dwArg04, word32 dwArg08)
{
	word32 dwLoc08_12 = 0x00;
	word32 dwLoc14_13 = 0x00;
	do
	{
		word32 ecx_16 = (word32) Mem0[dwArg08 + 0x00:byte];
		word32 eax_25 = dwLoc08_12 << 0x07 | ecx_16 & 0x7F;
		word32 edx_28 = dwLoc14_13 + 0x01;
		dwArg08 = dwArg08 + 0x01;
		dwLoc08_12 = eax_25;
		dwLoc14_13 = edx_28;
	} while ((ecx_16 & 0x80) != 0x00);
	Mem38[dwArg04 + 0x00:word32] = eax_25;
	return edx_28;
}

// 004011B0: Register word32 fn004011B0(Stack word32 dwArg04)
word32 fn004011B0(word32 dwArg04)
{
	word32 eax_27;
	word32 eax_23 = CreateFileA(dwArg04, 0x80000000, 0x01, 0x00, 0x03, 0x80, 0x00);
	if (eax_23 == ~0x00)
		eax_27 = 0x00;
	else
		eax_27 = eax_23;
	return eax_27;
}

// 004011F0: Register DWORD Win32CrtStartup()
DWORD Win32CrtStartup()
{
	GetModuleHandleA(0x00);
	LoadIconA(GetModuleHandleA(0x00), 0x00);
	word32 eax_46 = DPB(LoadCursorA(0x00, 0x7F00), RegisterClassA(fp - 0x60), 0);
	if ((word32) RegisterClassA(fp - 0x60) == 0x00)
		return 0x00;
	if (dwArg08 != 0x01)
		Mem585[0x00403068:word32] = 0x00;
	else
	{
		Mem586[0x00403068:word32] = 0x01;
		Mem588[0x00403058:word32] = dwArg04;
	}
	word32 dwLoc20_231;
	CreateWindowExA(0x00, 0x0040302C, 0x00403018, 0x01, 0x9942, 0x05622121, 1127991, 108151449, 0x00, 0x00, GetModuleHandleA(0x00), 0x00);
	word32 dwLoc10_198 = 0x00 >> (byte) (dwLoc10 - 133361) << (byte) dwLoc10 >> (byte) (dwLoc10 + 308593);
	word32 esp_224 = fp - 0xCC;
	if (Mem0[0x00403068:word32] == 0x00)
	{
		esp_224 = fp - 0xD0;
		dwLoc20_231 = GetModuleHandleA(0x00);
	}
	else
		dwLoc20_231 = dwArg04;
	word32 eax_237 = dwLoc20_231 + Mem0[dwLoc20_231 + 0x3C:word32];
	word32 eax_248 = ((word32) Mem0[eax_237 + 0x06:word16] - 0x01) *s 0x28 + ((eax_237 + 0x18) + (word32) Mem0[eax_237 + 0x14:word16]);
	word32 eax_264 = (uint32) ((uint64) (uint32) (Mem0[eax_248 + 0x10:word32] - 0x01 + Mem0[eax_237 + 0x3C:word32]) /u Mem0[eax_237 + 0x3C:word32]) *s Mem0[eax_237 + 0x3C:word32] + Mem0[eax_248 + 0x14:word32];
	word32 esp_267 = esp_224 - 0x04;
	Mem268[esp_267 + 0x00:word32] = 0x0200;
	word32 eax_270 = fn00401DC0(dwArg00);
	if (eax_270 == 0x00)
		return 0x00;
	Mem281[esp_267 + 0x00:word32] = 0x0200;
	Mem284[esp_267 - 0x04 + 0x00:word32] = eax_270;
	Mem287[esp_267 - 0x08 + 0x00:word32] = dwLoc20_231;
	GetModuleFileNameA(Mem287[esp_267 - 0x08 + 0x00:HMODULE], Mem287[esp_267 - 0x04 + 0x00:LPSTR], Mem287[esp_267 + 0x00:DWORD]);
	Mem291[esp_267 - 0x0C + 0x00:word32] = eax_270;
	word32 eax_292 = fn004011B0(dwArg00);
	if (eax_292 == 0x00)
		return 0x00;
	Mem303[esp_267 - 0x0C + 0x00:word32] = 0x00;
	Mem306[esp_267 - 0x10 + 0x00:word32] = eax_292;
	word32 eax_308 = GetFileSize(Mem306[esp_267 - 0x10 + 0x00:HANDLE], Mem306[esp_267 - 0x0C + 0x00:LPDWORD]) - eax_264;
	if (eax_308 == 0x00)
		return 0x00;
	Mem321[esp_267 - 0x14 + 0x00:word32] = eax_308 + 0x10;
	word32 eax_322 = fn00401DC0(dwArg00);
	if (eax_322 == 0x00)
		return 0x00;
	Mem333[esp_267 - 0x14 + 0x00:word32] = 0x00;
	Mem335[esp_267 - 0x18 + 0x00:word32] = 0x00;
	Mem338[esp_267 - 0x1C + 0x00:word32] = eax_264;
	Mem341[esp_267 - 0x20 + 0x00:word32] = eax_292;
	SetFilePointer(Mem341[esp_267 - 0x20 + 0x00:HANDLE], Mem341[esp_267 - 0x1C + 0x00:LONG], Mem341[esp_267 - 0x18 + 0x00:PLONG], Mem341[esp_267 - 0x14 + 0x00:DWORD]);
	Mem344[esp_267 - 0x24 + 0x00:word32] = 0x00;
	Mem347[esp_267 - 0x28 + 0x00:word32] = fp - 0x28;
	Mem350[esp_267 - 44 + 0x00:word32] = eax_308;
	Mem353[esp_267 - 0x30 + 0x00:word32] = eax_322;
	Mem356[esp_267 - 0x34 + 0x00:word32] = eax_292;
	if (ReadFile(Mem356[esp_267 - 0x34 + 0x00:HANDLE], Mem356[esp_267 - 0x30 + 0x00:LPVOID], Mem356[esp_267 - 44 + 0x00:DWORD], Mem356[esp_267 - 0x28 + 0x00:LPDWORD], Mem356[esp_267 - 0x24 + 0x00:LPOVERLAPPED]) == 0x00)
		return 0x00;
	Mem368[esp_267 - 0x38 + 0x00:word32] = eax_292;
	CloseHandle(Mem368[esp_267 - 0x38 + 0x00:HANDLE]);
	if (dwLoc28 != eax_308)
		return 0x00;
	word32 eax_379 = GetDesktopWindow();
	Mem382[esp_267 - 0x3C + 0x00:word32] = 200;
	word32 eax_383 = fn00401DC0(dwArg00);
	Mem387[eax_383 + 0x00:byte] = 0x01;
	Mem389[esp_267 - 0x3C + 0x00:word32] = 200;
	Mem392[esp_267 - 0x40 + 0x00:word32] = eax_383;
	Mem395[esp_267 - 0x44 + 0x00:word32] = eax_379;
	GetWindowTextA(Mem395[esp_267 - 0x44 + 0x00:HWND], Mem395[esp_267 - 0x40 + 0x00:LPSTR], Mem395[esp_267 - 0x3C + 0x00:int32]);
	if ((word32) Mem395[eax_383 + 0x00:byte] != 0x00)
	{
		Mem572[esp_267 - 0x48 + 0x00:word32] = eax_383;
		fn00401D90(dwArg00);
		return 0x00;
	}
	else
	{
		Mem404[esp_267 - 0x48 + 0x00:word32] = eax_383;
		fn00401D90(dwArg00);
		Mem408[esp_267 - 0x48 + 0x00:word32] = 0x40;
		Mem413[esp_267 - 0x4C + 0x00:word32] = eax_322 - 0x40 + eax_308;
		Mem416[esp_267 - 0x50 + 0x00:word32] = eax_322;
		fn00401000(dwArg00, dwArg04, dwArg08);
		word32 eax_421 = Mem416[eax_322 + 0x00:word32];
		word32 edx_424 = Mem416[eax_322 + 0x04:word32];
		word32 dwLoc0C_426 = 0x00;
		while (dwLoc0C_426 <u eax_421)
		{
			word32 edx_444 = dwLoc10_198 - Mem416[0x00403080:word32] << (byte) ((Mem416[0x0040306C:word32] *s Mem416[0x00403050:word32] + Mem416[0x00403080:word32]) - dwLoc10_198 *s dwLoc10_198);
			Mem453[eax_322 + dwLoc0C_426 + 0x08:word32] = Mem416[eax_322 + dwLoc0C_426 + 0x08:word32] ^ 11;
			Mem469[0x00403070:word32] = 0xEB70 >> (byte) Mem453[0x0040304C:word32] << (byte) (959564 - (edx_444 << ~0x1D)) >> (byte) (edx_444 << ~0x1D) << (byte) Mem453[0x00403050:word32];
			dwLoc10_198 = edx_444 << ~0x1D;
			dwLoc0C_426 = dwLoc0C_426 + 0x08;
		}
		Mem476[esp_267 - 0x48 + 0x00:word32] = edx_424;
		Mem479[0x00403064:word32] = fn00401DC0(dwArg00);
		if (Mem479[0x00403064:word32] != 0x00)
		{
			word32 esp_514;
			Mem486[esp_267 - 0x48 + 0x00:word32] = eax_421;
			Mem489[esp_267 - 0x4C + 0x00:word32] = Mem486[0x00403064:word32];
			Mem494[esp_267 - 0x50 + 0x00:word32] = eax_322 + 0x08;
			fn00401040(dwArg00, dwArg04, dwArg08);
			Mem496[0x00403054:word32] = edi;
			Mem497[0x00403048:word32] = esi;
			Mem498[0x00403060:word32] = ebx;
			Mem499[0x0040305C:word32] = fp - 0x04;
			Mem502[esp_267 - 0x48 + 0x00:word32] = 4199926;
			word32 eax_503 = Mem502[esp_267 - 0x48 + 0x00:word32];
			Mem508[0x00403078:word32] = Mem502[fs:0x18:word32];
			if (Mem508[0x00403068:word32] != 0x00)
			{
				Mem557[esp_267 - 0x48 + 0x00:word32] = eax_503 - Mem508[0x00403058:word32];
				fn00401650(fp - 0x04, dwArg00);
				esp_514 = esp_267 - 0x44;
			}
			else
			{
				Mem561[esp_267 - 0x48 + 0x00:word32] = 0x00;
				Mem567[esp_267 - 0x4C + 0x00:word32] = eax_503 - GetModuleHandleA(Mem561[(esp_267 - 0x48) + 0x00:LPCSTR]);
				fn00401650(fp - 0x04, dwArg00);
				esp_514 = esp_267 - 0x48;
			}
			word32 esp_516 = esp_514 - 0x04;
			Mem517[esp_516 + 0x00:word32] = Mem508[0x00403064:word32];
			word32 eax_518 = fn004017C0(fp - 0x04, dwArg00);
			if (eax_518 != 0x00)
			{
				word32 esp_538;
				word32 ebp_539;
				byte SCZO_540;
				word32 ebx_541;
				word32 esi_542;
				word32 edi_543;
				word32 eax_544;
				word32 ecx_545;
				word32 edx_546;
				word16 ax_547;
				byte SZO_548;
				byte C_549;
				byte Z_550;
				byte cl_551;
				selector fs_552;
				Mem517[0x0040307C:word32]();
				return eax_544;
			}
			else
			{
				Mem527[esp_516 + 0x00:word32] = Mem517[0x00403064:word32];
				fn00401D90(dwArg00);
				Mem531[esp_516 + 0x00:word32] = 0x0446;
				ExitProcess(Mem531[esp_516 + 0x00:UINT]);
			}
		}
		else
		{
			Mem483[esp_267 - 0x48 + 0x00:word32] = 0x07783872;
			ExitProcess(Mem483[esp_267 - 0x48 + 0x00:UINT]);
		}
	}
}

// 00401650: void fn00401650(Register word32 ebp, Stack word32 dwArg04)
void fn00401650(word32 ebp, word32 dwArg04)
{
	word32 dwLoc24_14;
	word32 esp_16 = fp - 0x28;
	if (Mem0[0x00403068:word32] != 0x00)
		dwLoc24_14 = Mem0[0x00403058:word32];
	else
	{
		esp_16 = fp - 44;
		dwLoc24_14 = GetModuleHandleA(0x00);
	}
	if (dwLoc24_14 == 0x00)
		return;
	word32 edx_61 = dwLoc24_14 + Mem0[dwLoc24_14 + 0x3C:word32];
	word32 esp_63 = esp_16 - 0x04;
	Mem64[esp_63 + 0x00:word32] = 0x40;
	Mem66[esp_63 - 0x04 + 0x00:word32] = 0x3000;
	Mem70[esp_63 - 0x08 + 0x00:word32] = Mem66[edx_61 + 0x50:word32];
	Mem72[esp_63 - 0x0C + 0x00:word32] = 0x00;
	Mem74[0x00403074:word32] = VirtualAlloc(Mem72[esp_63 - 0x0C + 0x00:LPVOID], Mem72[esp_63 - 0x08 + 0x00:SIZE_T], Mem72[esp_63 - 0x04 + 0x00:DWORD], Mem72[esp_63 + 0x00:DWORD]);
	if (Mem74[0x00403074:word32] == 0x00)
		return;
	Mem83[esp_63 - 0x10 + 0x00:word32] = Mem74[edx_61 + 0x50:word32];
	Mem86[esp_63 - 0x14 + 0x00:word32] = dwLoc24_14;
	word32 edx_87 = Mem86[0x00403074:word32];
	Mem89[esp_63 - 0x18 + 0x00:word32] = edx_87;
	fn00401000(dwArg00, dwArg04, dwArg08);
	word32 eax_95 = Mem89[0x00403074:word32] - dwLoc24_14;
	if (Mem89[edx_61 + 0xA4:word32] != 0x00)
	{
		word32 dwLoc0C_127 = dwLoc24_14 + Mem89[edx_61 + 0xA0:word32];
		while (Mem89[dwLoc0C_127 + 0x04:word32] != 0x00)
		{
			word32 eax_142 = Mem89[dwLoc0C_127 + 0x04:word32] - 0x08 >>u 0x01;
			word32 ecx_145 = dwLoc0C_127 + 0x08;
			word32 dwLoc08_148 = 0x00;
			while (dwLoc08_148 <u eax_142)
			{
				if ((word32) ecx_145[dwLoc08_148 * 0x02] >> 0x0C == 0x03)
					Mem189[Mem89[0x00403074:word32] + Mem89[dwLoc0C_127 + 0x00:word32] + ((word32) ecx_145[dwLoc08_148 * 0x02] & 0x0FFF):word32] = Mem89[Mem89[0x00403074:word32] + Mem89[dwLoc0C_127 + 0x00:word32] + ((word32) ecx_145[dwLoc08_148 * 0x02] & 0x0FFF):word32] + eax_95;
				dwLoc08_148 = dwLoc08_148 + 0x01;
			}
			dwLoc0C_127 = dwLoc0C_127 + Mem89[dwLoc0C_127 + 0x04:word32];
		}
	}
	Mem106[esp_63 - 0x10 + 0x00:word32] = dwArg04;
	word32 eax_109 = Mem106[esp_63 - 0x10 + 0x00:word32] + Mem106[0x00403074:word32];
	word32 esp_113;
	word32 ebp_114;
	byte SCZO_115;
	word32 esi_116;
	byte Z_117;
	word32 eax_118;
	byte SZO_119;
	byte C_120;
	word32 ecx_121;
	word32 edx_122;
	eax_109();
}

// 004017C0: Register word32 fn004017C0(Register word32 ebp, Stack word32 dwArg04)
word32 fn004017C0(word32 ebp, word32 dwArg04)
{
}

// 00401CF0: void fn00401CF0(Stack word32 dwArg04, Stack word32 dwArg08)
void fn00401CF0(word32 dwArg04, word32 dwArg08)
{
}

// 00401D60: void fn00401D60(Stack word32 dwArg04)
void fn00401D60(word32 dwArg04)
{
	Mem22[Mem0[Mem0[0x00403078:word32] + 0x30:word32] + 0x08:word32] = dwArg04;
}

// 00401D90: void fn00401D90(Stack word32 dwArg04)
void fn00401D90(word32 dwArg04)
{
	HeapFree(GetProcessHeap(), 0x00, dwArg04);
}

// 00401DC0: Register word32 fn00401DC0(Stack word32 dwArg04)
word32 fn00401DC0(word32 dwArg04)
{
	return HeapAlloc(GetProcessHeap(), 0x00, dwArg04);
}

