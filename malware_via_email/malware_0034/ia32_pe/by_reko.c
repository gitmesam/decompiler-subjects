// subject.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

// 00401000: Register Eq_2 Win32CrtStartup()
DWORD Win32CrtStartup()
{
	word32 ecx_15;
	word32 edx_16;
	byte al_17 = fn00401078(0x00401148, 0x062E, out ecx_15, out edx_16);
	fn00401148(al_17, ecx_15, edx_16, ebx, fp - 0x04, esi, rArg0);
	word32 ecx_40;
	word32 edx_41;
	fn00401078(0x00401148, 0x062E, out ecx_40, out edx_41);
	if (false)
	{
		*(fp - 0x18) = 0x00405000;
		*(fp - 0x1C) = 0x00401000;
		lstrcpyA(*(fp - 0x1C), *(fp - 0x18));
	}
	return 0x00;
}

// 00401078: Register byte fn00401078(Stack int32 dwArg04, Stack Eq_9 dwArg08, Register out ptr32 ecxOut, Register out ptr32 edxOut)
byte fn00401078(int32 dwArg04, Eq_9 dwArg08, ptr32 & ecxOut, ptr32 & edxOut)
{
	*ecxOut = ecx;
	*edxOut = edx;
	Eq_9 dwLoc08_20 = 0x00;
	while (true)
	{
		byte al_24 = (byte) dwLoc08_20;
		if (dwLoc08_20 >= dwArg08)
			break;
		if (dwLoc08_20 > 0x01 && (dwLoc08_20 - 0x01 & 0x01) == 0x00)
		{
			byte * eax_152 = (word32) dwLoc08_20 + dwArg04;
			byte * edx_149 = (word32) dwLoc08_20 + dwArg04;
			*edxOut = edx_149;
			*edx_149 = (byte) (DPB(eax_152, *eax_152, 0) ^ 0x1E);
		}
		if (dwLoc08_20 > 0x01)
		{
			Eq_104 edx_113 = dwLoc08_20 - 0x01;
			word32 ecx_115;
			*ecxOut = 0x03;
			int32 edx_120 = (int32) (SEQ(edx_113 >> 0x1F, edx_113) % 0x03);
			*edxOut = edx_120;
			if (edx_120 == 0x00)
			{
				byte * eax_132 = (word32) dwLoc08_20 + dwArg04;
				byte * edx_129 = (word32) dwLoc08_20 + dwArg04;
				*edxOut = edx_129;
				*edx_129 = (byte) (DPB(eax_132, *eax_132, 0) + 0x0038);
			}
		}
		if (dwLoc08_20 > 0x03)
		{
			Eq_139 edx_85 = dwLoc08_20 - 0x03;
			word32 ecx_87;
			*ecxOut = 0x03;
			int32 edx_92 = (int32) (SEQ(edx_85 >> 0x1F, edx_85) % 0x03);
			*edxOut = edx_92;
			if (edx_92 == 0x00)
			{
				byte * eax_104 = (word32) dwLoc08_20 + dwArg04;
				byte * edx_101 = (word32) dwLoc08_20 + dwArg04;
				*edxOut = edx_101;
				*edx_101 = (byte) (DPB(eax_104, *eax_104, 0) - 122);
			}
		}
		if ((dwLoc08_20 & 0x01) == 0x00)
		{
			byte * ecx_73 = (word32) dwLoc08_20 + dwArg04;
			*ecxOut = ecx_73;
			*ecx_73 = *((word32) dwLoc08_20 + dwArg04) - (byte) dwLoc08_20;
			word32 edx_76;
			*edxOut = dwLoc08_20;
		}
		dwLoc08_20 = (word32) dwLoc08_20 + 0x01;
	}
	return al_24;
}

// 00401148: FpuStack real64 fn00401148(Register byte al, Register word32 ecx, Register word32 edx, Register word32 ebx, Register (ptr Eq_23) ebp, Register word32 esi, FpuStack real64 rArg0)
real64 fn00401148(byte al, word32 ecx, word32 edx, word32 ebx, Eq_23 * ebp, word32 esi, real64 rArg0)
{
	if (ecx != 0x00)
	{
		__fldcw(ebp->w005E);
		byte ah_37 = fp->bED1FD993 - bLoc0F;
		__sti();
		if (ah_37 == 0x00 && DPB(0x08D68696, (bLoc2482ECAB + 0x96) + C, 0) != 0x01)
			__inb(0xE0);
	}
}

