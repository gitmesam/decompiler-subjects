// subject.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

// 00401ABB: Register ui32 fn00401ABB(Register ptr32 eax, Register ui32 edx, Register ui32 esi, Register word32 edi)
ui32 fn00401ABB(ptr32 eax, ui32 edx, ui32 esi, word32 edi)
{
	return ~edx;
}

// 00401AF2: Register ptr32 fn00401AF2(Register ui32 edx, Register ui32 esi, Register word32 edi, Register out ptr32 ecxOut, Register out ptr32 edxOut, Register out ptr32 esiOut)
ptr32 fn00401AF2(ui32 edx, ui32 esi, word32 edi, ptr32 & ecxOut, ptr32 & edxOut, ptr32 & esiOut)
{
	word32 edx_23;
	*edxOut = fn00401ABB(fp - 0x01CC, edx, esi, edi);
	word32 ecx_24;
	*ecxOut = fp - 0x01B5;
	word32 esi_25;
	*esiOut = esi | 0x50;
	return fp - 0x01CC;
}

// 00401B1B: Register word32 fn00401B1B(Register word32 ecx, Register ui32 edx, Register word32 ebx, Register word32 esi, Register word32 edi, Register out ptr32 ecxOut, Register out ptr32 edxOut, Register out ptr32 ebxOut, Register out ptr32 esiOut)
word32 fn00401B1B(word32 ecx, ui32 edx, word32 ebx, word32 esi, word32 edi, ptr32 & ecxOut, ptr32 & edxOut, ptr32 & ebxOut, ptr32 & esiOut)
{
	word32 ebx_27;
	*ebxOut = ebx + edx + (dwLoc2C <u 0x00);
	word32 ecx_34;
	word32 edx_35;
	word32 esi_36;
	return fn00401AF2(edx & 5396590, esi - 0x55, edi - ecx, out ecx_34, out edx_35, out esi_36);
}

// 00401B4E: Register ptr32 fn00401B4E(Register ptr32 edx, Register word32 esi, Register ui32 edi, Register out ptr32 ediOut)
ptr32 fn00401B4E(ptr32 edx, word32 esi, ui32 edi, ptr32 & ediOut)
{
	word32 edi_25;
	*ediOut = edi | 0x61;
	return edx - 0x01;
}

// 00401B89: Register ptr32 fn00401B89(Register word32 eax, Register ptr32 edx, Register word32 esi, Register ui32 edi, Register out ptr32 edxOut, Register out ptr32 ediOut)
ptr32 fn00401B89(word32 eax, ptr32 edx, word32 esi, ui32 edi, ptr32 & edxOut, ptr32 & ediOut)
{
	word32 edi_23;
	word32 edx_24;
	*edxOut = fn00401B4E(edx, esi, edi, out edi_23);
	return fp - 100;
}

// 00401BBD: FlagGroup bool fn00401BBD(Register Eq_90 eax, Register Eq_91 edx, Register word32 ebx, Register word32 esi, Register ui32 edi)
bool fn00401BBD(Eq_90 eax, Eq_91 edx, word32 ebx, word32 esi, ui32 edi)
{
	return (bool) cond(dwLoc6C);
}

// 00401C23: FlagGroup bool fn00401C23(Register Eq_90 eax, Register Eq_91 edx, Register out ptr32 eaxOut)
bool fn00401C23(Eq_90 eax, Eq_91 edx, ptr32 & eaxOut)
{
	word32 eax_9;
	*eaxOut = eax & edx;
	return false;
}

// 00401C32: FlagGroup bool fn00401C32(Register Eq_90 eax, Register ptr32 ecx, Register Eq_91 edx, Register word32 ebx, Register out ptr32 eaxOut, Register out ptr32 ecxOut, Register out ptr32 ebxOut)
bool fn00401C32(Eq_90 eax, ptr32 ecx, Eq_91 edx, word32 ebx, ptr32 & eaxOut, ptr32 & ecxOut, ptr32 & ebxOut)
{
	word32 ebx_9;
	*ebxOut = ebx ^ ecx;
	word32 ecx_11;
	*ecxOut = ecx - 0x01;
	word32 eax_23;
	return fn00401C23(eax, edx, out eax_23);
}

// 00401C50: Register Eq_90 fn00401C50(Register Eq_90 eax, Register ptr32 ecx, Register Eq_91 edx, Register word32 ebx, Register word32 esi, Register ui32 edi, Register out ptr32 ebxOut)
Eq_90 fn00401C50(Eq_90 eax, ptr32 ecx, Eq_91 edx, word32 ebx, word32 esi, ui32 edi, ptr32 & ebxOut)
{
	Eq_90 eax_20;
	word32 ecx_21;
	word32 ebx_22;
	Eq_136 C_23 = fn00401C32(eax, ecx, edx, ebx, out eax_20, out ecx_21, out ebx_22);
	word32 ebx_25 = ebx_22 - ecx_21 - C_23;
	*ebxOut = ebx_25;
	fn00401BBD(eax_20, edx, ebx_25, esi, edi);
	return eax_20;
}

// 00401D38: void fn00401D38(Register word32 edx, Register word32 ebx, Register ptr32 ebp, Register word32 esi, Register ui32 edi, Stack word32 dwArg00)
void fn00401D38(word32 edx, word32 ebx, ptr32 ebp, word32 esi, ui32 edi, word32 dwArg00)
{
	BOOL eax_14 = ShowWindow((struct HWND__ *) 0xF1350A1C, fp - 0xD0);
	word32 * esp_15 = (word32) fp.u1 - 0x0174;
	if (eax_14 == 0x00)
	{
		word32 ebx_48;
		word32 eax_49 = fn00401C50(fp - 0xAC, fp - 344, fp - 0x01B4, ebx, esi, edi, out ebx_48);
		ui32 edx_57;
		word32 edi_58;
		word32 ecx_59 = fn00401B89(eax_49, fp - 0x01B4, esi, edi, out edx_57, out edi_58);
		word32 ecx_69;
		Eq_159 edx_70;
		word32 ebx_71;
		ui32 esi_72;
		int32 eax_73 = fn00401B1B(ecx_59, edx_57, ebx_48, esi, edi_58, out ecx_69, out edx_70, out ebx_71, out esi_72);
		CreateWindowExW(dwLoc01F4, null, null, dwLocE4, eax_73, eax_73, eax_73, dwLoc015C, edx_70, (struct HMENU__ *) 12610, (struct HINSTANCE__ *) 4062624692, dwLoc01FC);
		SelectObject((struct HDC__ *) 3536055139, (void *) 4175336183);
		ShowWindow(null, fp - 0x54);
		SetEvent((void *) 4029245541);
		GetDlgItem((struct HWND__ *) 0xF2F8CC03, esi_72 | 0x54376477);
		CreateCompatibleBitmap((struct HDC__ *) ~0x035AF144, fp - 220, fp - 0x54);
		GetCommandLineA();
		Eq_160 esi_152 = (esi_72 | 0x54376477) + (ecx_69 - eax_73) + (fp < 0x07);
		fn0040670A(fp - 0x07, ebx_71, ebp, esi_152, 0x43);
	}
	else
	{
		*eax_14 = eax_14;
		while (eax_14 != 0x00)
		{
			esp_15 = esp_15 - 0x04;
			*esp_15 = (word32) eax_14;
		}
	}
}

// 004062D0: Register ptr32 fn004062D0(Register ptr32 ecx, Register ptr32 edx, Register word32 ebx, Register word32 edi)
ptr32 fn004062D0(ptr32 ecx, ptr32 edx, word32 ebx, word32 edi)
{
	return ~ecx;
}

// 0040635B: void fn0040635B()
void fn0040635B()
{
}

// 004063B4: Register ptr32 fn004063B4(Register ptr32 eax, Register ptr32 ecx, Register Eq_300 ebx, Register Eq_160 esi, Register word32 edi, Register out ptr32 ebxOut, Register out ptr32 esiOut)
ptr32 fn004063B4(ptr32 eax, ptr32 ecx, LPARAM ebx, Eq_160 esi, word32 edi, ptr32 & ebxOut, ptr32 & esiOut)
{
	fn00406B9B(ecx, edi);
	word32 ebx_36;
	*ebxOut = ebx - 113 - ((bool) (dwLoc3C < 0x00) + (dwLoc48 + eax) < 0x00);
	word32 esi_39;
	*esiOut = (word32) esi + 0x01;
	return fp - 0x54;
}

// 00406491: Register word32 fn00406491(Register word32 ecx)
word32 fn00406491(word32 ecx)
{
	return ~ecx;
}

// 00406693: void fn00406693()
void fn00406693()
{
}

// 0040670A: void fn0040670A(Register ptr32 edx, Register word32 ebx, Register ptr32 ebp, Register Eq_160 esi, Register word32 edi)
void fn0040670A(ptr32 edx, word32 ebx, ptr32 ebp, Eq_160 esi, word32 edi)
{
	Eq_211 v4_4 = *(ebp - 0x0160);
	GetModuleFileNameA((struct HINSTANCE__ *) 3366050869, ebp - 484, v4_4);
	Eq_156 eax_19 = ShowWindow(null, esi);
	fn00406DB0(esi);
	fn00406CBC(eax_19, ebp - 484, esi);
	Eq_211 eax_21 = GetCurrentProcessId();
	Eq_300 ebx_35 = fn00406EF3(eax_21, edx, ebx, esi, edi);
	GetStockObject(0x0A);
	GetCommandLineA();
	fn00406C31();
	SendMessageW((struct HWND__ *) ~0x6A172822, ebp - 0x01C8, 0x3733, ebx_35);
	SleepEx(0x01, 0x00);
	if ((word32) *(ebp - 0x01C8) != 2242)
		return;
	CreateCompatibleBitmap((struct HDC__ *) 2667035701, *(ebp - 0x019C), ebp - 336);
	ShowWindow(null, ebp - 0x017C);
	Eq_270 eax_100 = GetCommandLineA();
	word32 ecx_111;
	ptr32 ebp_112;
	ptr32 eax_113 = fn00406B55(eax_100, ebp - 0x017C, ebp - 336, esi, edi, out ecx_111, out ebp_112);
	*(fp - 0x18) = 0x40;
	*(fp - 0x1C) = (int32) ebx_35;
	fn00406C6C(eax_113, ecx_111, esi);
	*(fp - 0x1C) = 0x1000;
	*(fp - 0x20) = *(ebp_112 - 0x30);
	*(fp - 0x24) = 0x33;
	*(fp - 0x28) = 116;
	*(fp - 44) = 66;
	*(fp - 0x30) = 0x7748;
	ptr32 ecx_133 = fn00406491(ecx_111);
	*(fp - 0x20) = 87674;
	*(fp - 0x24) = *(ebp_112 - 0x01A4);
	*(fp - 0x28) = 27767;
	word32 ebx_142;
	word32 esi_143;
	word32 eax_144 = fn004063B4(eax_113, ecx_133, ebx_35, esi, edi, out ebx_142, out esi_143);
	*(fp - 0x24) = 0x00;
	*(fp - 0x28) = *(ebp_112 - 0x34);
	word32 ebx_151;
	word32 esi_152;
	word32 edi_153;
	fn00406F5D(eax_144, ecx_133, ebp - 336, ebx_142, esi_143, edi, out ebx_151, out esi_152, out edi_153);
	*(fp - 0x28) = ebp_112 - 0x0160;
	fn00406693();
	Eq_222 eax_160 = VirtualAlloc(*(fp - 0x24), *(fp - 0x20), *(fp - 0x1C), *(fp - 0x18));
	*(fp - 0x18) = fp - 0x14;
	struct Eq_617 * edx_165 = *(fp - 0x18);
	*(fp - 0x18) = (union Eq_222 *) eax_160;
	edx_165->dw0014 = *(fp - 0x18);
	byte * esi_180 = *(fp - 0x14);
	Mem187[fp - 0x14 + 0x00:word32] = eax_160 + 6639;
	Eq_222 eax_191 = eax_160;
	word32 edi_197 = 0x3D38;
	do
	{
		*eax_191 = (word32) *eax_191 + (__ror(*esi_180 ^ 0x00, 0x0C) + 0x1B);
		esi_180 = esi_180 + 0x01;
		eax_191 = eax_191 + 0x01;
		edi_197 = edi_197 - 0x01;
	} while (edi_197 != 0x00);
}

// 004067A2: void fn004067A2(Register Eq_160 esi)
void fn004067A2(Eq_160 esi)
{
	fn0040635B();
}

// 00406B55: Register Eq_270 fn00406B55(Register Eq_270 eax, Register Eq_434 ecx, Register ptr32 edx, Register Eq_160 esi, Register word32 edi, Register out ptr32 ecxOut, Register out ptr32 ebpOut)
LPSTR fn00406B55(LPSTR eax, Eq_434 ecx, ptr32 edx, Eq_160 esi, word32 edi, ptr32 & ecxOut, ptr32 & ebpOut)
{
	Eq_270 eax_9 = -eax;
	word32 ecx_11;
	*ecxOut = ecx | 0x32;
	word32 ebp_77;
	*ebpOut = fn00406C27(fp - 0x04, esi);
	return eax_9;
}

// 00406B9B: void fn00406B9B(Register ptr32 ecx, Register word32 edi)
void fn00406B9B(ptr32 ecx, word32 edi)
{
}

// 00406C27: Register (ptr32 Eq_691) fn00406C27(Register (ptr32 Eq_691) ebp, Register Eq_160 esi)
Eq_691 * fn00406C27(Eq_691 * ebp, Eq_160 esi)
{
	fn004067A2(esi);
	return ebp->ptr0000;
}

// 00406C31: void fn00406C31()
void fn00406C31()
{
}

// 00406C6C: void fn00406C6C(Register ptr32 eax, Register word32 ecx, Register Eq_160 esi)
void fn00406C6C(ptr32 eax, word32 ecx, Eq_160 esi)
{
}

// 00406CBC: void fn00406CBC(Register Eq_156 eax, Register ptr32 ecx, Register Eq_160 esi)
void fn00406CBC(BOOL eax, ptr32 ecx, Eq_160 esi)
{
}

// 00406DB0: void fn00406DB0(Register Eq_160 esi)
void fn00406DB0(Eq_160 esi)
{
}

// 00406EF3: Register word32 fn00406EF3(Register Eq_211 eax, Register ptr32 edx, Register word32 ebx, Register Eq_160 esi, Register word32 edi)
word32 fn00406EF3(DWORD eax, ptr32 edx, word32 ebx, Eq_160 esi, word32 edi)
{
	word32 ebx_10 = ebx - esi;
	fn00406F9F(eax, edx, ebx_10, esi, edi);
	return ebx_10;
}

// 00406F5D: Register ptr32 fn00406F5D(Register word32 eax, Register ptr32 ecx, Register ptr32 edx, Register word32 ebx, Register word32 esi, Register word32 edi, Register out ptr32 ebxOut, Register out ptr32 esiOut, Register out ptr32 ediOut)
ptr32 fn00406F5D(word32 eax, ptr32 ecx, ptr32 edx, word32 ebx, word32 esi, word32 edi, ptr32 & ebxOut, ptr32 & esiOut, ptr32 & ediOut)
{
	word32 ebx_50;
	*ebxOut = ebx + edx;
	word32 edi_53;
	*ediOut = edi ^ 0x77513172;
	word32 esi_71;
	*esiOut = fn00406FF0(fp - 0x10, edx, esi);
	return fp - 0x10;
}

// 00406F9F: Register word32 fn00406F9F(Register Eq_211 eax, Register ptr32 edx, Register word32 ebx, Register Eq_160 esi, Register word32 edi)
word32 fn00406F9F(DWORD eax, ptr32 edx, word32 ebx, Eq_160 esi, word32 edi)
{
	word32 ecx_14 = fn004062D0(fp - 0x94, edx, ebx, edi);
	return ecx_14;
}

// 00406FF0: Register word32 fn00406FF0(Register ptr32 ecx, Register ptr32 edx, Register word32 esi)
word32 fn00406FF0(ptr32 ecx, ptr32 edx, word32 esi)
{
	word32 esi_11 = ~esi - 0x68 - (fp < ~0xD3);
	return esi_11;
}

