// subject.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

// 00405023: void fn00405023(Register Eq_2 ecx, FpuStack real64 rArg0, FpuStack real64 rArg1, FpuStack real64 rArg2)
void fn00405023(Eq_2 ecx, real64 rArg0, real64 rArg1, real64 rArg2)
{
fn00405023_entry:
	esp = fp
	branch ecx == 0x00 l00405007
l00405007:
	branch Test(LT,SO) l00405007_then
	fn00404FF7()
	return
l00405007_then:
l00405009:
	ax = __aam(al)
	al = (byte) ax
	SCZO = cond(cl - al)
	SZO = SCZO
	Z = (bool) SCZO
	SO = SCZO
	C = (bool) SCZO
	SCZDOP = SCZO
	O = (bool) SCZO
	S = (bool) SCZO
	esp = esp - 0x04
	sp = (word16) esp
	*esp = SCZDOP
	ah.u0 = 161
	eax = DPB(eax, ah, 8)
	ax = DPB(ax, ah, 8)
	edx_eax = DPB(edx_eax, ah, 8)
	branch Test(NE,Z) l00405088
l00405012:
	eax = eax ^ 441252874
	al = (byte) eax
	ah = SLICE(eax, byte, 8)
	ax = (word16) eax
	__outb(dx, al)
	C = __aaa(al, ah, &al, &ah)
	edx = edx - 0x01
	dl = (byte) edx
	edx_eax = (int64) eax
	dx = (word16) edx
	dh = SLICE(edx, byte, 8)
	SZO = cond(edx)
	SCZO = SZO
	Z = (bool) SZO
	SO = SZO
	SCZDOP = SZO
	O = (bool) SZO
	S = (bool) SZO
	ss = sp
	es_edi = edx->t72FD4F05
	edi = es_edi
	branch Test(NO,O) l00405007
l00405023:
l00405024:
	ecx = ecx - 0x01
	es_ecx = ecx
	cl = (byte) ecx
	ch = SLICE(ecx, byte, 8)
	branch ecx != 0x00 l00405060
l00405025:
	SCZO = cond(dl - *((word32) esi - 0x6F16C069))
l00405026:
	C = __aaa(al, ah, &al, &ah)
	edx->t0000 = (int64) rArg0
	v12 = eax
	eax = esi
	al = (byte) eax
	ah = SLICE(eax, byte, 8)
	esi = v12
	C = __aaa(al, ah, &al, &ah)
	edx->t0000 = (int16) rArg1
	al = __inb(0x34)
	eax = DPB(eax, al, 0)
	*((word32) esi + 0x36DF33C3) = (int16) trunc(rArg1)
	eax = eax ^ *((word64) ecx + 0x0061)
	al = (byte) eax
	C.u0 = false
	al = (bool) C.u0 + (al + 0x32)
	eax = DPB(eax, al, 0)
	SCZO = cond(al)
	C = (bool) SCZO
	eax = (word32) eax + 0x01
	al = (byte) eax
	ah = SLICE(eax, byte, 8)
	edx_eax = (int64) eax
	ax = (word16) eax
	SZO = cond(eax)
	SCZO = SZO
	Z = (bool) SZO
	SO = SZO
	SCZDOP = SZO
	O = (bool) SZO
	S = (bool) SZO
	*edi = __in(dx)
	edi = (word32) edi + 0x01
	es_edi = edi
	rArg2 = (real64) edx->w0062 - rArg2
l00405043:
	branch Test(NE,Z) l004050AD
l00405047:
	v21 = *eax - cl - C
	*eax = v21
	*edi = __in(dx)
	edi = (word32) edi + 0x01
	ebx = esi *s 0x62
	SCZO = cond(ebx)
	ss = *esp
	esp = (word32) esp + 0x02
	eax = (word32) eax + 0x01
	al = (byte) eax
	ah = SLICE(eax, byte, 8)
	edx_eax = (int64) eax
	ax = (word16) eax
	SZO = cond(eax)
	return
l00405060:
	edx->t0000 = (int16) rArg0
	al = al + 55 + C
	eax = DPB(eax, al, 0)
	esp = ebp
	ebp = *esp
	esp = (word32) esp + 0x04
	SCZO = cond(al - *((word32) ebp + 101))
	C = (bool) SCZO
	dh = (bool) C.u0 + (dh + cl)
	esi = (word32) esi + 0x01
	v32 = *((word32) eax + 0x0011) | eax
	*((word32) eax + 0x0011) = v32
	SZO = cond(*((word32) eax + 0x0011))
	v33 = eax
	edi = v33
	es_edi = edi
	dl = dl & Mem0[edi + esi:byte]
	edx = DPB(edx, dl, 0)
	dx = DPB(dx, dl, 0)
	cl = 0x39
	ecx = DPB(ecx, cl, 0)
	eax = __indw(dx)
	ds = *esp
	esp = (word32) esp + 0x02
	sp = (word16) esp
	((word64) ecx + 971442061)->u1 = (int64) rArg0
	eax = (word32) eax + 1820870431
	al = (byte) eax
	al = al + 0x32
	ah = FPUF
	al = al ^ 0x30
	eax = DPB(eax, al, 0)
	ax = DPB(ax, al, 0)
	edx_eax = DPB(edx_eax, al, 0)
	SZO = cond(al)
	C.u0 = false
	SCZO = cond(eax - *edi)
	edi = (word32) edi + 0x04
	ax = *ebx * al
	SCZO = cond(ax)
	SZO = SCZO
	Z = (bool) SCZO
	SO = SCZO
	C = (bool) SCZO
	SCZDOP = SCZO
	O = (bool) SCZO
	S = (bool) SCZO
	edx->t0000 = (int64) rArg1
	goto l0040508E
l00405088:
	v41 = *((word32) edi + 987702262) ^ ch
	*((word32) edi + 987702262) = v41
	SZO = cond(*((word32) edi + 987702262))
	Z = (bool) SZO
	SO = SZO
	O = (bool) SZO
	S = (bool) SZO
	C.u0 = false
	SCZO.u0 = DPB(SCZO, C, 0)
	SCZDOP.u0 = DPB(SCZDOP, C, 0)
	goto l0040508E
l00405089:
l0040508E:
	v36 = eax
	edi = *esp
	es_edi = edi
	esp = (word32) esp + 0x04
	esi = *esp
	esp = (word32) esp + 0x04
	ebp = *esp
	esp = (word32) esp + 0x04
	esp = (word32) esp + 0x04
	ebx = (bu8 *) *esp
	esp = (word32) esp + 0x04
	edx = (struct Eq_32 *) *esp
	esp = (word32) esp + 0x04
	ecx = *esp
	es_ecx = ecx
	cl = (byte) ecx
	ch = SLICE(ecx, byte, 8)
	esp = (word32) esp + 0x04
	eax = *esp
	al = (byte) eax
	ah = SLICE(eax, byte, 8)
	ax = (word16) eax
	esp = (word32) esp + 0x04
	esp = esp + eax + C
	esp = esp - 0x02
	sp = (word16) esp
	*esp = cs
	edx = edx - 0x01
	dl = (byte) edx
	edx_eax = (int64) eax
	dx = (word16) edx
	dh = SLICE(edx, byte, 8)
	v38 = *((word32) esi + 0x0034) ^ ebp
	*((word32) esi + 0x0034) = v38
	SZO = cond(*((word32) esi + 0x0034))
	Z = (bool) SZO
	SO = SZO
	O = (bool) SZO
	S = (bool) SZO
	C.u0 = false
	SCZO.u0 = DPB(SCZO, C, 0)
	SCZDOP.u0 = DPB(SCZDOP, C, 0)
l00405098:
	ecx = ecx - 0x01
	es_ecx = ecx
	cl = (byte) ecx
	ch = SLICE(ecx, byte, 8)
	branch ecx != 0x00 l00405043
l0040509A:
	SCZDOP = *esp
	esp = (word32) esp + 0x04
	sp = (word16) esp
l0040509B:
	C = __aas(al, ah, &al, &ah)
	esp = esp - 0x04
	*esp = ecx
	v39 = (bool) C.u0 + ((word32) (*((byte) esi.u0 + 583719070)) + dl)
	((byte) esi.u0 + 583719070)->u0 = v39
	esp = (word32) esp + 0x01
	esp = esp - 0x04
	*esp = ebp
	ebp = esp
	esp = esp - ~0x2D49
	sp = (word16) esp
	edx->t0000 = (int64) rArg2
	__outb(dx, al)
	esi.u0 = (byte) esi.u0 + 0x01
	al = al ^ 0x43
	eax = DPB(eax, al, 0)
	ax = DPB(ax, al, 0)
	edx_eax = DPB(edx_eax, al, 0)
	SZO = cond(al)
	C.u0 = false
l004050AD:
	v42 = eax
	eax = esp
	esp = v42
	sp = (word16) esp
	eax = (word32) eax + 0x721B0B7A
	al = (byte) eax
	ah = SLICE(eax, byte, 8)
	edx_eax = (int64) eax
	ax = (word16) eax
	SCZO = ah
	SZO = SCZO
	Z = (bool) SCZO
	SO = SCZO
	C = (bool) SCZO
	SCZDOP = SCZO
	O = (bool) SCZO
	S = (bool) SCZO
	branch Test(NO,O) l00405100
l004050B6:
	ah = ah + Mem0[328604138:byte] + C
	eax = DPB(eax, ah, 8)
	ax = DPB(ax, ah, 8)
	edx_eax = DPB(edx_eax, ah, 8)
	SCZO = cond(ah)
	ecx = ecx - 0x01
	es_ecx = ecx
	cl = (byte) ecx
	ch = SLICE(ecx, byte, 8)
	branch ecx != 0x00 l004050F3
l004050BE:
	edx = (struct Eq_32 *) *esp
	dl = (byte) edx
	esp = (word32) esp + 0x04
	dl = dl - edx->t0000
	v43 = eax
	esi = v43
	esi = (word32) esi + 0x01
	edi = *esp
	esp = (word32) esp + 0x04
	esi = *esp
	esp = (word32) esp + 0x04
	ebp = *esp
	esp = (word32) esp + 0x04
	esp = (word32) esp + 0x04
	ebx = (bu8 *) *esp
	esp = (word32) esp + 0x04
	edx = (struct Eq_32 *) *esp
	dx = (word16) edx
	dh = SLICE(edx, byte, 8)
	esp = (word32) esp + 0x04
	ecx = *esp
	cl = (byte) ecx
	esp = (word32) esp + 0x04
	eax = *esp
	esp = (word32) esp + 0x04
	edi = edi ^ eax
	es_edi = edi
	eax = eax & 1510158276
	al = (byte) eax
	__outb(dx, al)
	esi = (word32) esi + 0x01
	ebx = ebx | esi
	esi = *esp
	esp = (word32) esp + 0x04
	eax = eax & 338115635
	al = (byte) eax
	SCZO = cond(*ebx - dh)
	edx = (struct Eq_32 *) *esp
	dl = (byte) edx
	dx = (word16) edx
	dh = SLICE(edx, byte, 8)
	esp = (word32) esp + 0x04
	v44 = (*((word32) eax + 0x0026) & 0x01 << cl) != 0x00
	((word32) eax + 0x0026)->u0 = __ror(*((word32) eax + 0x0026), cl)
	edx->t0000 = ecx
	es_ecx = *((word32) eax + 0x15DFC115)
	ecx = es_ecx
	cl = (byte) es_ecx
	ch = SLICE(es_ecx, byte, 8)
	v46 = *(eax - 0x3D) >> 0x0C
	*(eax - 0x3D) = v46
	SCZO = cond(v46)
	C = (bool) SCZO
	al = (bool) C.u0 + (al + 191)
	eax = __indw(dx)
	__outdw(dx, eax)
	esi = (word32) esi + 0x04
	eax = *esp
	al = (byte) eax
	ah = SLICE(eax, byte, 8)
	edx_eax = (int64) eax
	ax = (word16) eax
	esp = (word32) esp + 0x04
	sp = (word16) esp
	v47 = *((word64) ecx + 396302656) | eax
	*((word64) ecx + 396302656) = v47
	SZO = cond(*((word64) ecx + 396302656))
	Z = (bool) SZO
	SO = SZO
	O = (bool) SZO
	S = (bool) SZO
	C.u0 = false
	SCZO.u0 = DPB(SCZO, C, 0)
	SCZDOP.u0 = DPB(SCZDOP, C, 0)
	branch Test(SG,S) l00405117
	goto l004050F4
l004050F3:
	eax = eax & edi
	al = (byte) eax
	ah = SLICE(eax, byte, 8)
	edx_eax = (int64) eax
	ax = (word16) eax
	SZO = cond(eax)
	Z = (bool) SZO
	SO = SZO
	O = (bool) SZO
	S = (bool) SZO
	C.u0 = false
	SCZO.u0 = DPB(SCZO, C, 0)
	SCZDOP.u0 = DPB(SCZDOP, C, 0)
	goto l004050F5
l004050F4:
	ebp.u0 = 854039253
l004050F5:
	ebx = ebx - 0x01
	SZO = cond(ebx)
	SCZO = SZO
	Z = (bool) SZO
	SO = SZO
	SCZDOP = SZO
	O = (bool) SZO
	S = (bool) SZO
	branch Test(ULT,C) l00405098
l004050FD:
	edx_eax = (int64) eax
	eax = (word32) edx_eax
	ecx = ecx - 0x01
	es_ecx = ecx
	cl = (byte) ecx
	ch = SLICE(ecx, byte, 8)
	eax = (bool) C.u0 + ((word32) eax + 0x018ABA2B)
	al = (byte) eax
	ah = SLICE(eax, byte, 8)
	edx_eax = (int64) eax
	ax = (word16) eax
	SCZO = cond(eax)
	ebp = ebp - 0x01
	v50 = *((word64) ecx + 0x0057) >> 0x24
	*((word64) ecx + 0x0057) = v50
	SCZO = cond(v50)
	cl = 229
	ebx = ebx + 0x01
	SZO = cond(ebx)
	(uint8 *) 0x8F48841D = (uint8 *) al
	esi.u0 = 985827187
	return
l00405100:
	edi = edi - edx->dwC14D018A
	es_edi = edi
	SCZO = cond(edi)
	edx = *((word32) edi + 0x0024) *s 2722358705
	dl = (byte) edx
	edx_eax = (int64) eax
	dx = (word16) edx
	dh = SLICE(edx, byte, 8)
	SCZO = cond(edx)
	SZO = SCZO
	Z = (bool) SCZO
	SO = SCZO
	C = (bool) SCZO
	SCZDOP = SCZO
	O = (bool) SCZO
	S = (bool) SCZO
	eax = eax - 0xBE8F4884 - C
	al = (byte) eax
	ah = SLICE(eax, byte, 8)
	edx_eax = (int64) eax
	ax = (word16) eax
	SCZO = cond(eax)
	SZO = SCZO
	Z = (bool) SCZO
	SO = SCZO
	C = (bool) SCZO
	SCZDOP = SCZO
	O = (bool) SCZO
	S = (bool) SCZO
	branch Test(UGE,C) l0040509B
	goto l00405114
l00405104:
l00405106:
l00405109:
l0040510D:
l00405111:
l00405112:
l00405114:
	return
l00405116:
l00405117:
	eax = eax ^ 2875333252
	al = (byte) eax
	ah = SLICE(eax, byte, 8)
	edi = edx *s 0x1F
	SCZO = cond(dl - *((word32) esi + 0x6770C3C3))
	al = al ^ 0xA9
	eax = DPB(eax, al, 0)
	ax = DPB(ax, al, 0)
	edx_eax = DPB(edx_eax, al, 0)
	ebp = ebp | edx->dw001E
	SZO = cond(ebp)
	C.u0 = false
	return
fn00405023_exit:
}

// 00417FAB: Register Eq_753 Win32CrtStartup()
Eq_753 Win32CrtStartup()
{
	DWORD * esp_121;
	ptr32 esp_128;
	GetLastError();
	Eq_759 eax_10 = GetModuleHandleA(&globals->t430273);
	Eq_753 eax_27 = CreateFileA(&globals->t430243, 0x20000000, 0x01, null, 0x03, 0x01A2, 0x00);
	ptr32 esp_149 = fp - 0x34;
	if (eax_27 == ~0x00)
	{
		GetFileType(eax_27);
		GetLastError();
		GetCommandLineA();
		Eq_888 eax_320 = GetProcAddress(eax_10, &globals->t4302BE);
		GetLastError();
		CloseHandle(eax_27);
		GetFileSize(eax_27, 0x00);
		GetFileType(eax_27);
		GetFileSize(eax_27, 0x00);
		dwLoc2C = eax_320();
		Eq_753 eax_383 = CreateFileA(&globals->t43029A, 0x40000000, 0x02, null, 0x03, 0x01A0, 0x00);
		esp_149 = fp - 0x40;
		dwLoc0C = eax_383;
		if (eax_383 != ~0x00)
			goto l00418173;
	}
	Eq_789 v13_230 = dwLoc2C ^ 0xC0000005;
	union Eq_753 * esp_235 = esp_149 - 0x04;
	*esp_235 = 0x00;
	*(esp_235 - 0x04) = 0x06;
	*(esp_235 - 0x08) = 0x03;
	*(esp_235 - 0x0C) = 0x00;
	*(esp_235 - 0x10) = 0x04;
	*(esp_235 - 0x14) = 0xC0000000;
	*(esp_235 - 0x18) = 0x004302AE;
	Eq_753 eax_249 = CreateFileA(*(esp_235 - 0x18), *(esp_235 - 0x14), *(esp_235 - 0x10), *(esp_235 - 0x0C), *(esp_235 - 0x08), *(esp_235 - 0x04), *esp_235);
	dwLoc24 = (word32) v13_230 + 0x0041810B;
	esp_121 = (DWORD *) ((char *) esp_235 + 0x04);
	dwLoc08 = eax_249;
	if (eax_249 != ~0x00)
		goto l0041820C;
	ptr32 esp_257;
	word32 ebp_258;
	byte SCZO_259;
	word32 eax_260;
	bool Z_261;
	byte SZO_262;
	bool C_263;
	word32 ecx_264;
	real64 rArg0_265;
	real64 rArg1_266;
	real64 rArg2_267;
	(*((word32) v13_230 + 0x0041810B))();
	GetCommandLineA();
	GetLastError();
	*(esp_257 - 0x04) = fp - 0x18;
	GetCommandLineA();
	*(esp_257 - 0x08) = 0x40;
	*(esp_257 - 0x0C) = 0x00;
	*(esp_257 - 0x10) = (union Eq_753 *) eax_249;
	GetFileSize(*(esp_257 - 0x10), *(esp_257 - 0x0C));
	word32 * esp_282 = esp_257 - 0x08;
	do
	{
		GetCommandLineA();
		word32 * esp_285 = esp_282 - 0x04;
		*esp_285 = 77623;
		*(esp_285 - 0x04) = 0x00;
		*(esp_285 - 0x08) = 0x0103;
		*(esp_285 - 0x0C) = 0x03;
		*(esp_285 - 0x10) = 0x00;
		*(esp_285 - 0x14) = 0x01;
		*(esp_285 - 0x18) = 0xA0000000;
		*(esp_285 - 0x1C) = 4391515;
		Eq_753 eax_301 = CreateFileW(*(esp_285 - 0x1C), *(esp_285 - 0x18), *(esp_285 - 0x14), *(esp_285 - 0x10), *(esp_285 - 0x0C), *(esp_285 - 0x08), *(esp_285 - 0x04));
		esp_282 = esp_285;
		dwLoc28 = eax_301;
	} while (eax_301 != ~0x00);
	*(esp_285 - 0x04) = 0x00405000;
	esp_149 = esp_285 - 0x04;
l00418173:
	struct Eq_928 * esp_150 = esp_149 - 0x04;
	esp_150->t0000.u0 = 0x00;
	*(esp_150 - 0x04) = 388;
	*(esp_150 - 0x08) = 0x03;
	*(esp_150 - 0x0C) = 0x00;
	*(esp_150 - 0x10) = 0x05;
	*(esp_150 - 0x14) = 0x40000000;
	*(esp_150 - 0x18) = 0x0043020C;
	Eq_753 eax_164 = CreateFileW(*(esp_150 - 0x18), *(esp_150 - 0x14), *(esp_150 - 0x10), *(esp_150 - 0x0C), *(esp_150 - 0x08), *(esp_150 - 0x04), esp_150->t0000);
	esp_128 = &esp_150->t0004;
	if (eax_164 != ~0x00)
		goto l00418226;
	VirtualProtect(esp_150->t0004, esp_150->t0008, esp_150->t000C, esp_150->t0010);
	esp_150->t0010.u0 = 0x00;
	esp_150->t000C = dwLoc08;
	GetFileSize(esp_150->t000C, esp_150->t0010);
	esp_150->t0010 = dwLoc2C;
	esp_150->t000C = eax_164;
	GetFileType(esp_150->t000C);
	esp_150->t000C.u0 = 77623;
	esp_150->t0008.u0 = 0x00;
	esp_150->t0004.u0 = 0x86;
	esp_150->t0000.u0 = 0x03;
	*(esp_150 - 0x04) = 0x00;
	*(esp_150 - 0x08) = 0x00;
	*(esp_150 - 0x0C) = 0xE0000000;
	*(esp_150 - 0x10) = 4391549;
	esp_150->t0008 = CreateFileW(*(esp_150 - 0x10), *(esp_150 - 0x0C), *(esp_150 - 0x08), *(esp_150 - 0x04), esp_150->t0000, esp_150->t0004, esp_150->t0008);
	GetFileType(esp_150->t0008);
	esp_150->t0008.u0 = 0x00405000;
	esp_121 = (DWORD *) &esp_150->t0008;
l0041820C:
	union Eq_790 * esp_122 = esp_121 - 0x04;
	*esp_122 = (union Eq_790 *) 0x00;
	*(esp_122 - 0x04) = (union Eq_753 *) dwLoc0C;
	GetFileSize(*(esp_122 - 0x04), *esp_122);
	esp_128 = (char *) esp_122 + 0x04;
	dwLoc24 = dwLoc2C;
l00418226:
	union Eq_753 * esp_54 = esp_128 - 0x04;
	*esp_54 = 0x00;
	*(esp_54 - 0x04) = 0x0183;
	*(esp_54 - 0x08) = 0x03;
	*(esp_54 - 0x0C) = 0x00;
	*(esp_54 - 0x10) = 0x07;
	*(esp_54 - 0x14) = 0x00;
	*(esp_54 - 0x18) = 0x00430227;
	*esp_54 = (union Eq_753 *) CreateFileW(*(esp_54 - 0x18), *(esp_54 - 0x14), *(esp_54 - 0x10), *(esp_54 - 0x0C), *(esp_54 - 0x08), *(esp_54 - 0x04), *esp_54);
	Eq_753 eax_79 = CloseHandle(*esp_54);
	ptr32 esp_81;
	word32 ebp_82;
	byte SCZO_83;
	word32 eax_84;
	bool Z_85;
	byte SZO_86;
	bool C_87;
	Eq_2 ecx_88;
	real64 rArg0_89;
	real64 rArg1_90;
	real64 rArg2_91;
	(dwLoc24 - ~0x40417F45)();
	*(esp_81 - 0x04) = (union Eq_753 *) dwLoc28;
	Eq_753 eax_95 = CloseHandle(*(esp_81 - 0x04));
	fn00405023(ecx_88, rArg0_89, rArg1_90, rArg2_91);
	return eax_95;
}

