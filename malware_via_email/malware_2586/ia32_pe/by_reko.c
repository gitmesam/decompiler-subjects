// subject.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

// 00405023: void fn00405023(Register Eq_2 ecx, FpuStack real64 rArg0, FpuStack real64 rArg1)
void fn00405023(Eq_2 ecx, real64 rArg0, real64 rArg1)
{
fn00405023_entry:
	esp = fp
	branch ecx == 0x00 l00405007
l00405007:
	branch Test(LT,SO) l00405007_then
	fn00404FF7()
	return
l00405007_then:
l00405009:
	ax = __aam(al)
	al = (byte) ax
	SCZO = cond(cl - al)
	SO = SCZO
	Z = SCZO
	SZO = SCZO
	C = SCZO
	SCZDOP = SCZO
	O = SCZO
	S = SCZO
	esp = esp - 0x04
	sp = (word16) esp
	*esp = SCZDOP
	ah.u0 = 161
	eax = DPB(eax, ah, 8)
	ax = DPB(ax, ah, 8)
	edx_eax = DPB(edx_eax, ah, 8)
	branch Test(NE,Z) l00405088
l00405012:
	eax = eax ^ 441252874
	al = (byte) eax
	ah = SLICE(eax, byte, 8)
	ax = (word16) eax
	__outb(dx, al)
	C = __aaa(al, ah, &al, &ah)
	edx = edx - 0x01
	dl = (byte) edx
	edx_eax = (int64) eax
	dx = (word16) edx
	dh = SLICE(edx, byte, 8)
	SZO = cond(edx)
	SCZO = SZO
	SO = SZO
	SCZDOP = SZO
	Z = SZO
	O = SZO
	S = SZO
	ss = sp
	es_edi = edx->t72FD4F05
	edi = es_edi
	branch Test(NO,O) l00405007
l00405023:
l00405024:
	ecx = ecx - 0x01
	es_ecx = ecx
	cl = (byte) ecx
	ch = SLICE(ecx, byte, 8)
	branch ecx != 0x00 l00405060
l00405025:
	SCZO = cond(dl - *((word32) esi - 0x6F16C069))
l00405026:
	C = __aaa(al, ah, &al, &ah)
	edx->t0000 = (int64) rArg0
	v12 = eax
	eax = esi
	al = (byte) eax
	ah = SLICE(eax, byte, 8)
	esi = v12
	C = __aaa(al, ah, &al, &ah)
	edx->t0000 = (int16) rArg1
	al = __inb(0x34)
l00405043:
	esp = esp - (struct Eq_292 *) 0x04
	sp = (word16) esp
	*esp = 0x62
	branch Test(NE,Z) l004050AD
l00405047:
	v48 = *eax - cl - C
	*eax = v48
	*edi = __in(dx)
	edi = (word32) edi + 0x01
	ebx = esi *s 0x62
	SCZO = cond(ebx)
	ss = *esp
	esp = (word32) esp + 0x02
	eax = (word32) eax + 0x01
	al = (byte) eax
	ah = SLICE(eax, byte, 8)
	edx_eax = (int64) eax
	ax = (word16) eax
	SZO = cond(eax)
	return
l00405060:
	edx->t0000 = (int16) rArg0
	al = (byte) C.u0 + (al + 55)
	eax = DPB(eax, al, 0)
	esp = ebp
	ebp = *esp
	esp = (word32) esp + 0x04
	SCZO = cond(al - *((word32) ebp + 101))
	C = SCZO
	dh = (byte) C.u0 + (dh + cl)
	esi = (word32) esi + 0x01
	v28 = *((word32) eax + 0x0011) | eax
	*((word32) eax + 0x0011) = v28
	SZO = cond(*((word32) eax + 0x0011))
	v29 = eax
	edi = v29
	es_edi = edi
	dl = dl & Mem0[edi + esi:byte]
	edx = DPB(edx, dl, 0)
	dx = DPB(dx, dl, 0)
	cl = 0x39
	ecx = DPB(ecx, cl, 0)
	eax = __indw(dx)
	ds = *esp
	esp = (word32) esp + 0x02
	sp = (word16) esp
	((word64) ecx + 971442061)->u1 = (int64) rArg0
	eax = (word32) eax + 1820870431
	al = (byte) eax
	al = al + 0x32
	ah = FPUF
	al = al ^ 0x30
	eax = DPB(eax, al, 0)
	ax = DPB(ax, al, 0)
	edx_eax = DPB(edx_eax, al, 0)
	SZO = cond(al)
	C.u0 = false
	SCZO = cond(eax - *edi)
	edi = (word32) edi + 0x04
	ax = *ebx * al
	SCZO = cond(ax)
	SO = SCZO
	Z = SCZO
	SZO = SCZO
	C = SCZO
	SCZDOP = SCZO
	O = SCZO
	S = SCZO
	edx->t0000 = (int64) rArg1
	goto l0040508E
l00405088:
	v35 = *((word32) edi + 987702262) ^ ch
	*((word32) edi + 987702262) = v35
	SZO = cond(*((word32) edi + 987702262))
	SO = SZO
	Z = SZO
	O = SZO
	S = SZO
	C.u0 = false
	SCZO = C
	SCZDOP = C
	goto l0040508E
l00405089:
l0040508E:
	v36 = eax
	edi = *esp
	es_edi = edi
	esp = (word32) esp + 0x04
	esi = *esp
	esp = (word32) esp + 0x04
	ebp = *esp
	esp = (word32) esp + 0x04
	esp = (word32) esp + 0x04
	ebx = (bu8 *) *esp
	esp = (word32) esp + 0x04
	edx = (struct Eq_87 *) *esp
	esp = (word32) esp + 0x04
	ecx = *esp
	es_ecx = ecx
	cl = (byte) ecx
	ch = SLICE(ecx, byte, 8)
	esp = (word32) esp + 0x04
	eax = *esp
	al = (byte) eax
	ah = SLICE(eax, byte, 8)
	ax = (word16) eax
	esp = (word32) esp + 0x04
	esp = esp + eax + C
	esp = esp - (struct Eq_266 *) 0x02
	sp = (word16) esp
	*esp = cs
	edx = edx - 0x01
	dl = (byte) edx
	edx_eax = (int64) eax
	dx = (word16) edx
	dh = SLICE(edx, byte, 8)
	v38 = *((word32) esi + 0x0034) ^ ebp
	*((word32) esi + 0x0034) = v38
	SZO = cond(*((word32) esi + 0x0034))
	SO = SZO
	Z = SZO
	O = SZO
	S = SZO
	C.u0 = false
	SCZO = C
	SCZDOP = C
l00405098:
	ecx = ecx - 0x01
	es_ecx = ecx
	cl = (byte) ecx
	ch = SLICE(ecx, byte, 8)
	branch ecx != 0x00 l00405043
l0040509A:
	SCZDOP = *esp
	esp = esp + 0x04
	C = __aas(al, ah, &al, &ah)
	esp = esp - (struct Eq_314 *) 0x04
	*esp = ecx
	v39 = (byte) C.u0 + ((word32) (*((word32) esi + 583719070)) + dl)
	*((word32) esi + 583719070) = v39
	esp = esp + 0x01
	esp = esp - (struct Eq_330 *) 0x04
	*esp = ebp
	ebp = esp
	esp = esp - (struct Eq_335 *) ~0x2D49
	sp = (word16) esp
	edx->t0000 = (int64) rArg0
	__outb(dx, al)
	esi = (word32) esi + 0x01
	al = al ^ 0x43
	eax = DPB(eax, al, 0)
	ax = DPB(ax, al, 0)
	edx_eax = DPB(edx_eax, al, 0)
	SZO = cond(al)
	C.u0 = false
l004050AD:
	v40 = eax
	eax = esp
	esp = v40
	sp = (word16) esp
	eax = (word32) eax + 0x721B0B7A
	al = (byte) eax
	ah = SLICE(eax, byte, 8)
	edx_eax = (int64) eax
	ax = (word16) eax
	SCZO = ah
	SO = SCZO
	Z = SCZO
	SZO = SCZO
	C = SCZO
	SCZDOP = SCZO
	O = SCZO
	S = SCZO
	branch Test(NO,O) l00405100
l004050B6:
	ah = ah + Mem0[328604138:byte] + C
	eax = DPB(eax, ah, 8)
	ax = DPB(ax, ah, 8)
	edx_eax = DPB(edx_eax, ah, 8)
	SCZO = cond(ah)
	ecx = ecx - 0x01
	es_ecx = ecx
	cl = (byte) ecx
	ch = SLICE(ecx, byte, 8)
	branch ecx != 0x00 l004050F3
l004050BE:
	edx = (struct Eq_87 *) *esp
	dl = (byte) edx
	esp = esp + 0x04
	dl = dl - edx->t0000
	v41 = eax
	esi = v41
	esi = (word32) esi + 0x01
	edi = *esp
	esp = esp + 0x04
	esi = *esp
	esp = esp + 0x04
	ebp = *esp
	esp = esp + 0x04
	esp = esp + 0x04
	ebx = (bu8 *) *esp
	esp = esp + 0x04
	edx = (struct Eq_87 *) *esp
	dx = (word16) edx
	dh = SLICE(edx, byte, 8)
	esp = esp + 0x04
	ecx = *esp
	cl = (byte) ecx
	esp = esp + 0x04
	eax = *esp
	esp = esp + 0x04
	edi = edi ^ eax
	es_edi = edi
	eax = eax & 1510158276
	al = (byte) eax
	__outb(dx, al)
	esi = (word32) esi + 0x01
	ebx = ebx | esi
	esi = *esp
	esp = esp + 0x04
	eax = eax & 338115635
	al = (byte) eax
	SCZO = cond(*ebx - dh)
	edx = (struct Eq_87 *) *esp
	dl = (byte) edx
	dx = (word16) edx
	dh = SLICE(edx, byte, 8)
	esp = esp + 0x04
	v42 = (*((word32) eax + 0x0026) & 0x01 << cl) != 0x00
	*((word32) eax + 0x0026) = __ror(*((word32) eax + 0x0026), cl)
	edx->t0000 = ecx
	es_ecx = *((word32) eax + 0x15DFC115)
	ecx = es_ecx
	cl = (byte) es_ecx
	ch = SLICE(es_ecx, byte, 8)
	v44 = *(eax - 0x3D) >> 0x0C
	*(eax - 0x3D) = v44
	SCZO = cond(v44)
	C = SCZO
	al = (byte) C.u0 + (al + 191)
	eax = __indw(dx)
	__outdw(dx, eax)
	esi = (word32) esi + 0x04
	eax = *esp
	al = (byte) eax
	ah = SLICE(eax, byte, 8)
	edx_eax = (int64) eax
	ax = (word16) eax
	esp = esp + 0x04
	sp = (word16) esp
	v45 = *((word64) ecx + 396302656) | eax
	*((word64) ecx + 396302656) = v45
	SZO = cond(*((word64) ecx + 396302656))
	SO = SZO
	Z = SZO
	O = SZO
	S = SZO
	C.u0 = false
	SCZO = C
	SCZDOP = C
	branch Test(SG,S) l00405117
	goto l004050F4
l004050F3:
	eax = eax & edi
	al = (byte) eax
	ah = SLICE(eax, byte, 8)
	edx_eax = (int64) eax
	ax = (word16) eax
	SZO = cond(eax)
	SO = SZO
	Z = SZO
	O = SZO
	S = SZO
	C.u0 = false
	SCZO = C
	SCZDOP = C
	goto l004050F5
l004050F4:
	ebp.u0 = 854039253
l004050F5:
	ebx = ebx - 0x01
	SZO = cond(ebx)
	SCZO = SZO
	SO = SZO
	SCZDOP = SZO
	Z = SZO
	O = SZO
	S = SZO
	branch Test(ULT,C) l00405098
l004050FD:
	edx_eax = (int64) eax
	eax = (word32) edx_eax
	ecx = ecx - 0x01
	es_ecx = ecx
	cl = (byte) ecx
	ch = SLICE(ecx, byte, 8)
	eax = eax + 25868843 + C
	al = (byte) eax
	ah = SLICE(eax, byte, 8)
	edx_eax = (int64) eax
	ax = (word16) eax
	SCZO = cond(eax)
	ebp = ebp - (struct Eq_564 *) 0x01
	v49 = *((word64) ecx + 0x0057) >> 0x24
	*((word64) ecx + 0x0057) = v49
	SCZO = cond(v49)
	goto l00405106
l00405100:
	edi = edi - edx->tC14D018A
	SCZO = cond(edi)
	goto l00405106
l00405104:
l00405106:
	cl = 229
	ebx = ebx + 0x01
	SZO = cond(ebx)
	(uint8 *) 0x8F48841D = (uint8 *) al
	esi.u0 = 985827187
	return
l00405117:
	SCZO = cond(al - 0x51)
fn00405023_exit:
}

// 00417FAB: Register Eq_629 Win32CrtStartup()
Eq_629 Win32CrtStartup()
{
	ptr32 esp_139;
	ptr32 esp_143;
	GetLastError();
	Eq_635 eax_10 = GetModuleHandleA(0x00430273);
	ptr32 esp_172 = fp - 0x54;
	Eq_638 eax_26 = CreateFileA(0x00430243, 0x20000000, 0x01, null, 0x03, 0x01A2, 0x00);
	if (eax_26 == ~0x00)
	{
		GetFileType(eax_26);
		GetLastError();
		GetCommandLineA();
		Eq_763 eax_338 = GetProcAddress(eax_10, eax_26);
		GetLastError();
		CloseHandle(eax_26);
		GetFileSize(eax_26, null);
		GetFileType(eax_26);
		GetFileSize(eax_26, null);
		dwLoc2C = eax_338();
		Eq_638 eax_395 = CreateFileA(0x0043029A, 0x40000000, 0x02, null, 0x03, 0x01A0, 0x00);
		esp_172 = fp - 0xA0;
		dwLoc0C = eax_395;
		if (eax_395 != ~0x00)
			goto l00418173;
	}
	Eq_665 v13_253 = dwLoc2C ^ 0xC0000005;
	union Eq_638 * esp_258 = esp_172 - 0x04;
	*esp_258 = (union Eq_638 *) 0x00;
	*(esp_258 - 0x04) = 0x06;
	*(esp_258 - 0x08) = 0x03;
	*(esp_258 - 0x0C) = 0x00;
	*(esp_258 - 0x10) = 0x04;
	*(esp_258 - 0x14) = 0xC0000000;
	*(esp_258 - 0x18) = 0x004302AE;
	Eq_638 eax_272 = CreateFileA(*(esp_258 - 0x18), *(esp_258 - 0x14), *(esp_258 - 0x10), *(esp_258 - 0x0C), *(esp_258 - 0x08), *(esp_258 - 0x04), *esp_258);
	dwLoc24 = (word32) v13_253 + 0x0041810B;
	esp_139 = esp_258 - 0x18;
	dwLoc08 = eax_272;
	if (eax_272 != ~0x00)
		goto l0041820C;
	ptr32 esp_279;
	word32 ebp_280;
	byte SCZO_281;
	word32 eax_282;
	byte Z_283;
	byte SZO_284;
	byte C_285;
	word32 ecx_286;
	real64 rArg0_287;
	real64 rArg1_288;
	(*((word32) v13_253 + 0x0041810B))();
	GetCommandLineA();
	GetLastError();
	*(esp_279 - 0x04) = fp - 0x18;
	GetCommandLineA();
	*(esp_279 - 0x08) = 0x40;
	*(esp_279 - 0x0C) = 0x00;
	*(esp_279 - 0x10) = (union Eq_638 *) eax_272;
	GetFileSize(*(esp_279 - 0x10), *(esp_279 - 0x0C));
	ptr32 esp_300 = esp_279 - 0x10;
	do
	{
		GetCommandLineA();
		word32 * esp_305 = esp_300 - 0x04;
		*esp_305 = 77623;
		*(esp_305 - 0x04) = 0x00;
		*(esp_305 - 0x08) = 0x0103;
		*(esp_305 - 0x0C) = 0x03;
		*(esp_305 - 0x10) = 0x00;
		*(esp_305 - 0x14) = 0x01;
		*(esp_305 - 0x18) = 0xA0000000;
		*(esp_305 - 0x1C) = 4391515;
		Eq_638 eax_321 = CreateFileW(*(esp_305 - 0x1C), *(esp_305 - 0x18), *(esp_305 - 0x14), *(esp_305 - 0x10), *(esp_305 - 0x0C), *(esp_305 - 0x08), *(esp_305 - 0x04));
		esp_300 = esp_305 - 0x1C;
		dwLoc28 = eax_321;
	} while (eax_321 != ~0x00);
	*(esp_305 - 0x20) = 0x00405000;
	esp_172 = esp_305 - 0x20;
l00418173:
	union Eq_638 * esp_173 = esp_172 - 0x04;
	*esp_173 = (union Eq_638 *) 0x00;
	*(esp_173 - 0x04) = 388;
	*(esp_173 - 0x08) = 0x03;
	*(esp_173 - 0x0C) = 0x00;
	*(esp_173 - 0x10) = 0x05;
	*(esp_173 - 0x14) = 0x40000000;
	*(esp_173 - 0x18) = 0x0043020C;
	esp_143 = esp_173 - 0x18;
	Eq_638 eax_187 = CreateFileW(*(esp_173 - 0x18), *(esp_173 - 0x14), *(esp_173 - 0x10), *(esp_173 - 0x0C), *(esp_173 - 0x08), *(esp_173 - 0x04), *esp_173);
	if (eax_187 != ~0x00)
		goto l00418226;
	VirtualProtect(*(esp_173 - 0x18), *(esp_173 - 0x14), *(esp_173 - 0x10), *(esp_173 - 0x0C));
	*(esp_173 - 0x1C) = 0x00;
	*(esp_173 - 0x20) = (union Eq_638 *) dwLoc08;
	GetFileSize(*(esp_173 - 0x20), *(esp_173 - 0x1C));
	*(esp_173 - 0x24) = (union Eq_666 *) dwLoc2C;
	*(esp_173 - 0x28) = (union Eq_638 *) eax_187;
	GetFileType(*(esp_173 - 0x28));
	*(esp_173 - 44) = 77623;
	*(esp_173 - 0x30) = 0x00;
	*(esp_173 - 0x34) = 0x86;
	*(esp_173 - 0x38) = 0x03;
	*(esp_173 - 0x3C) = 0x00;
	*(esp_173 - 0x40) = 0x00;
	*(esp_173 - 0x44) = 0xE0000000;
	*(esp_173 - 0x48) = 4391549;
	*(esp_173 - 0x4C) = (union Eq_638 *) CreateFileW(*(esp_173 - 0x48), *(esp_173 - 0x44), *(esp_173 - 0x40), *(esp_173 - 0x3C), *(esp_173 - 0x38), *(esp_173 - 0x34), *(esp_173 - 0x30));
	GetFileType(*(esp_173 - 0x4C));
	*(esp_173 - 0x50) = 0x00405000;
	esp_139 = esp_173 - 0x50;
l0041820C:
	LPDWORD * esp_140 = esp_139 - 0x04;
	*esp_140 = (LPDWORD *) null;
	*(esp_140 - 0x04) = (union Eq_638 *) dwLoc0C;
	GetFileSize(*(esp_140 - 0x04), *esp_140);
	esp_143 = esp_140 - 0x04;
	dwLoc24 = dwLoc2C;
l00418226:
	union Eq_638 * esp_70 = esp_143 - 0x04;
	*esp_70 = (union Eq_638 *) 0x00;
	*(esp_70 - 0x04) = 0x0183;
	*(esp_70 - 0x08) = 0x03;
	*(esp_70 - 0x0C) = 0x00;
	*(esp_70 - 0x10) = 0x07;
	*(esp_70 - 0x14) = 0x00;
	*(esp_70 - 0x18) = 0x00430227;
	*(esp_70 - 0x1C) = (union Eq_638 *) CreateFileW(*(esp_70 - 0x18), *(esp_70 - 0x14), *(esp_70 - 0x10), *(esp_70 - 0x0C), *(esp_70 - 0x08), *(esp_70 - 0x04), *esp_70);
	Eq_629 eax_94 = CloseHandle(*(esp_70 - 0x1C));
	ptr32 esp_95;
	word32 ebp_96;
	byte SCZO_97;
	word32 eax_98;
	byte Z_99;
	byte SZO_100;
	byte C_101;
	Eq_2 ecx_102;
	real64 rArg0_103;
	real64 rArg1_104;
	(dwLoc24 - ~0x40417F45)();
	*(esp_95 - 0x04) = (union Eq_638 *) dwLoc28;
	Eq_629 eax_108 = CloseHandle(*(esp_95 - 0x04));
	fn00405023(ecx_102, rArg0_103, rArg1_104);
	return eax_108;
}

