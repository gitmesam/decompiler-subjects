// subject.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

// 0040102D: Register word16 fn0040102D(Register ui32 eax, Register word32 ecx, Register ui32 edi, Register out ptr32 ecxOut, Register out Eq_7 dxOut, Register out ptr32 ebpOut)
word16 fn0040102D(ui32 eax, word32 ecx, ui32 edi, ptr32 & ecxOut, Eq_7 & dxOut, ptr32 & ebpOut)
{
	struct Eq_9 * edx_13 = fp << 0x10 >> 0x10;
	word16 dx_18;
	*dxOut = (word16) &edx_13->dw120004;
	word32 ebp_21;
	*ebpOut = edx_13->dw120004;
	word32 ecx_22;
	*ecxOut = ecx ^ edi << 0x1E | 1312339229;
	return (word16) (eax | 1184058661);
}

// 00401128: Register Eq_34 Win32CrtStartup()
DWORD Win32CrtStartup()
{
	word32 ecx_11;
	word16 dx_12;
	struct Eq_37 * ebp_13;
	fn0040102D(eax, ecx, edi, out ecx_11, out dx_12, out ebp_13);
	byte al_27 = (byte) ebx;
	*ebx = *ebx + al_27;
	*ebx = *ebx + al_27;
	*ebx = *ebx + al_27;
	*ebx = *ebx + al_27;
	*ebx = *ebx + al_27;
	*ebx = *ebx + al_27;
	*ebx = *ebx + al_27;
	*ebx = *ebx + al_27;
	*ebx = *ebx + al_27;
	*ebx = *ebx + al_27;
	*ebx = *ebx + al_27;
	*ebx = *ebx + al_27;
	*ebx = *ebx + al_27;
	*ebx = *ebx + al_27;
	*ebx = *ebx + al_27;
	*ebx = *ebx + al_27;
	word32 ecx_76 = (word32) ebp_13->b0007;
	__ror(~0x0902, 0x0F);
	cui16 di_22 = (word16) ebx;
	struct Eq_281 ** esp_244 = fp;
	byte * edi_74 = DPB(ebx, di_22 - ~0x28, 0);
	if (ecx_76 != 0x90)
	{
		Eq_184 eax_242 = CopyFileExA((CHAR *) 0x90, (CHAR *) 3963125073, dwArg00, tArg04, tArg08, tArg0C);
		Eq_200 eax_254 = DPB(eax_242, bh, 8);
		eax_254->b6C00E0 = eax_254->b6C00E0 + bh;
		eax_254->t0000.b0000 = (byte) ((byte) eax_242).b0000 + (eax_254->t0000).b0000;
		(ui32 *) 0x66008500 = (ui32 *) 0x66008500 ^ edi_74;
		esp_244 = (struct Eq_281 **) ((char *) fp + 0x0010);
	}
	word16 dx_93 = (word16) esp_244;
	struct Eq_226 * ecx_101 = DPB(1194964, dx_93, 0) + 0x00;
	__ror(dx_93, 0x06);
	__ror(DPB(ebx, di_22 - ~0x28 | ~0x5C, 0) + 1194964, 0x02);
	word32 eax_108 = 0x004010DB;
	ui32 esi_114 = globals->dw40111D;
	do
	{
		ecx_101 = ecx_101 + 0x01;
		word32 edx_126 = ecx_101->dw0000;
		eax_108 = __rol(-eax_108, 0x1E);
	} while (edx_126 - esi_114 != 0x00);
	struct Eq_237 * ecx_147 = DPB(ecx_101, *(ecx_101 - 0x03), 0);
	__ror((word16) (esi_114 * 0x02), 0x02);
	struct Eq_281 * esi_156 = *esp_244;
	word32 edi_162 = globals->dw40105E;
	ecx_168 = ecx_147;
	do
	{
		struct Eq_237 * ecx_168;
		ui32 eax_169 = esi_156->dw0000;
		__ror(ecx_168, 0x11);
		esi_156 = esi_156 - ~0x00;
		ecx_168 = eax_169 ^ edi_162;
	} while (ecx_168 != null);
	uint32 * esp_206 = esp_244 - 0x04;
	*esp_206 = (ecx_147 << 0x10 >> 0x10) + 4177108;
	*(esp_206 - 0x04) = fs->ptr0000;
	fs->ptr0000 = esp_206 - 0x04;
	*(esp_206 - 0x08) = 0x00;
	__rol((word16) (esp_206 - 0x04), 0x0E);
	*(esp_206 - 0x0C) = (struct Eq_281 **) esi_156;
	__ror(null, 0x12);
	ui32 eax_193 = eax_169 - 382895693 << 0x1E;
	return DPB(eax_193 + 0x01, (word16) (eax_193 + 0x01) - 0x2A, 0) + 0x01;
}

