// subject.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

// 004064F2: Register DWORD Win32CrtStartup()
DWORD Win32CrtStartup()
{
}

// 004074FF: FlagGroup bool fn004074FF(Register byte al, Register byte cl, Register word16 dx, Register byte bl, Register word32 ebp, Register word32 esi, Register out ptr32 eaxOut, Register out ptr32 ecxOut, Register out ptr32 dlOut, Register out ptr32 dhOut, Register out ptr32 ebxOut, Register out ptr32 ebpOut, Register out ptr32 esiOut, Register out ptr32 ediOut)
bool fn004074FF(byte al, byte cl, word16 dx, byte bl, word32 ebp, word32 esi, ptr32 & eaxOut, ptr32 & ecxOut, ptr32 & dlOut, ptr32 & dhOut, ptr32 & ebxOut, ptr32 & ebpOut, ptr32 & esiOut, ptr32 & ediOut)
{
	byte al_10 = (byte) ebx + 0x5C + C;
	__cli();
	word32 eax_11 = DPB(ebx, al_10, 0);
	byte al_18 = (byte) eax + 0x7C + (al_10 <u 0x00);
	word16 ax_25 = (word16) eax_11;
	word16 bx_28 = (word16) DPB(eax, al_18, 0);
	if (al_18 < 0x00)
	{
		Mem33[1763822403:word32] = esi;
		word32 eax_30 = DPB(eax_11, 0xC3, 8);
		Mem35[eax_30 + 0x00:byte] = __ror(Mem33[eax_30 + 0x00:byte], 0x01);
		word16 ax_31 = DPB(ax_25, 0xC3, 8);
		word32 eax_41;
		word32 ecx_42;
		byte dl_43;
		byte dh_44;
		word32 ebx_45;
		word32 ebp_46;
		word32 esi_47;
		word32 edi_48;
		real64 rArg0_49;
		return fn0040751D(ax_31, cl, dx, bx_28, ebp, esi, 0x148F8F8F, rArg0, out eax_41, out ecx_42, out dl_43, out dh_44, out ebx_45, out ebp_46, out esi_47, out edi_48, out rArg0_49);
	}
}

// 0040751D: FlagGroup byte fn0040751D(Register word16 ax, Register byte cl, Register word16 dx, Register word16 bx, Register word32 ebp, Register word32 esi, Register word32 edi, FpuStack real64 rArg0, Register out ptr32 eaxOut, Register out ptr32 ecxOut, Register out ptr32 dlOut, Register out ptr32 dhOut, Register out ptr32 ebxOut, Register out ptr32 ebpOut, Register out ptr32 esiOut, Register out ptr32 ediOut, FpuStack out ptr32 rArg0Out)
byte fn0040751D(word16 ax, byte cl, word16 dx, word16 bx, word32 ebp, word32 esi, word32 edi, real64 rArg0, ptr32 & eaxOut, ptr32 & ecxOut, ptr32 & dlOut, ptr32 & dhOut, ptr32 & ebxOut, ptr32 & ebpOut, ptr32 & esiOut, ptr32 & ediOut, ptr32 & rArg0Out)
{
}

// 004078D8: FlagGroup byte fn004078D8(Register word32 eax, Register word32 ecx, Register byte dl, Register byte dh, Register byte bl, Register word32 ebp, Register word32 esi, Register word32 edi, Register out ptr32 eaxOut, Register out ptr32 ecxOut, Register out ptr32 dlOut, Register out ptr32 dhOut, Register out ptr32 ebxOut, Register out ptr32 ebpOut, Register out ptr32 esiOut, Register out ptr32 ediOut)
byte fn004078D8(word32 eax, word32 ecx, byte dl, byte dh, byte bl, word32 ebp, word32 esi, word32 edi, ptr32 & eaxOut, ptr32 & ecxOut, ptr32 & dlOut, ptr32 & dhOut, ptr32 & ebxOut, ptr32 & ebpOut, ptr32 & esiOut, ptr32 & ediOut)
{
	ptr32 fp;
	byte dh;
	word32 edx;
	word16 dx;
	word32 eax;
	word32 ecx;
	byte dl;
	byte bl;
	word32 ebp;
	word32 esi;
	word32 edi;
	real64 rArg0;
	ptr32 eaxOut;
	ptr32 ecxOut;
	ptr32 dlOut;
	ptr32 dhOut;
	ptr32 ebxOut;
	ptr32 ebpOut;
	ptr32 esiOut;
	ptr32 ediOut;
	esp_1 = fp;
	dh_3 = dh + 0x26;
	edx_5 = DPB(edx, dh_3, 8);
	dx_7 = DPB(dx, dh_3, 8);
	eax_9 = eax << 0x18;
	ah_10 = SLICE(eax_9, byte, 8);
	ax_11 = (word16) eax_9;
	SCZO_12 = cond(eax_9);
	SZO_13 = SCZO_12;
	Z_14 = SCZO_12;
	C_15 = SCZO_12;
	Z_30 = fn004078DD(eax_9, ecx, dl, bl, ebp, esi, edi, out eax_22, out ecx_23, out dl_24, out dh_25, out ebx_26, out ebp_27, out esi_28, out edi_29);
	SCZO_31 = Z_30;
	SZO_32 = Z_30;
	return Z_30;
}

// 004078DD: FlagGroup byte fn004078DD(Register word32 eax, Register word32 ecx, Register byte dl, Register byte bl, Register word32 ebp, Register word32 esi, Register word32 edi, Register out ptr32 eaxOut, Register out ptr32 ecxOut, Register out ptr32 dlOut, Register out ptr32 dhOut, Register out ptr32 ebxOut, Register out ptr32 ebpOut, Register out ptr32 esiOut, Register out ptr32 ediOut)
byte fn004078DD(word32 eax, word32 ecx, byte dl, byte bl, word32 ebp, word32 esi, word32 edi, ptr32 & eaxOut, ptr32 & ecxOut, ptr32 & dlOut, ptr32 & dhOut, ptr32 & ebxOut, ptr32 & ebpOut, ptr32 & esiOut, ptr32 & ediOut)
{
	ptr32 fp;
	word32 esi;
	<type-error> Mem0;
	byte ah;
	byte C;
	word32 ecx;
	word32 edx;
	word16 dx;
	ptr32 eaxOut;
	ptr32 ecxOut;
	ptr32 dlOut;
	ptr32 dhOut;
	ptr32 ebxOut;
	ptr32 ebpOut;
	ptr32 esiOut;
	ptr32 ediOut;
	word32 eax;
	byte bl;
	word32 ebp;
	word32 edi;
	word32 ebx;
	esp_1 = fp;
	v6_6 = Mem0[esi - 0x2D + 0x00:byte] - ah - C;
	Mem7[esi - 0x2D + 0x00:byte] = v6_6;
	v8_9 = (Mem7[ecx + 2763716801:word32] & 0x10) != 0x00;
	Mem10[ecx + 2763716801:word32] = __rol(Mem7[ecx + 2763716801:word32], 0x7C);
	v10_11 = (ecx & 0x00040000) != 0x00;
	ecx_12 = __ror(ecx, 0x12);
	C_13 = v10_11;
	v11_14 = (ecx_12 & 0x08000000) != 0x00;
	ecx_15 = __rcr(ecx_12, 0x1B, C_13);
	edx_17 = edx ^ 1517819373;
	dl_18 = (byte) edx_17;
	dh_19 = SLICE(edx_17, byte, 8);
	dl_20 = dl_18 - 0x53;
	edx_21 = DPB(edx_17, dl_20, 0);
	dx_23 = DPB(dx, dl_20, 0);
	esp_24 = fp - 0x04;
	dwLoc04_25 = ecx_15;
	v15_26 = fp - 0x04;
	esp_27 = fp - 0x08;
	dwLoc08_28 = fp - 0x04;
	esp_29 = fp - 0x0C;
	dwLoc0C_30 = ~0x40;
	ecx_31 = ~0x40;
	cx_32 = (word16) ecx_31;
	cl_33 = (byte) ecx_31;
	esp_34 = fp - 0x08;
	SCZO_35 = cond(0x2A988A46);
	C_36 = SCZO_35;
	SZO_37 = SCZO_35;
	Z_38 = SCZO_35;
	if (0x2A988A46 != 0x00)
	{
		fn00407964();
		return Z_38;
	}
	else
	{
		Z_70 = fn00407903(eax, ecx_31, dx_23, bl, ebp, esi, edi, out eax_62, out ecx_63, out dl_64, out dh_65, out ebx_66, out ebp_67, out esi_68, out edi_69);
		SCZO_71 = Z_70;
		SZO_72 = Z_70;
		return Z_70;
	}
}

// 00407903: FlagGroup byte fn00407903(Register word32 eax, Register word32 ecx, Register word16 dx, Register byte bl, Register word32 ebp, Register word32 esi, Register word32 edi, Register out ptr32 eaxOut, Register out ptr32 ecxOut, Register out ptr32 dlOut, Register out ptr32 dhOut, Register out ptr32 ebxOut, Register out ptr32 ebpOut, Register out ptr32 esiOut, Register out ptr32 ediOut)
byte fn00407903(word32 eax, word32 ecx, word16 dx, byte bl, word32 ebp, word32 esi, word32 edi, ptr32 & eaxOut, ptr32 & ecxOut, ptr32 & dlOut, ptr32 & dhOut, ptr32 & ebxOut, ptr32 & ebpOut, ptr32 & esiOut, ptr32 & ediOut)
{
	word32 eax_12;
	word32 ecx_13;
	byte dl_14;
	byte dh_15;
	word32 ebx_16;
	word32 ebp_17;
	word32 esi_18;
	word32 edi_19;
	return fn00407908(eax + 0x6E041DAE, ecx, dx, bl, ebp, esi, edi, out eax_12, out ecx_13, out dl_14, out dh_15, out ebx_16, out ebp_17, out esi_18, out edi_19);
}

// 00407908: FlagGroup byte fn00407908(Register word32 eax, Register word32 ecx, Register word16 dx, Register byte bl, Register word32 ebp, Register word32 esi, Register word32 edi, Register out ptr32 eaxOut, Register out ptr32 ecxOut, Register out ptr32 dlOut, Register out ptr32 dhOut, Register out ptr32 ebxOut, Register out ptr32 ebpOut, Register out ptr32 esiOut, Register out ptr32 ediOut)
byte fn00407908(word32 eax, word32 ecx, word16 dx, byte bl, word32 ebp, word32 esi, word32 edi, ptr32 & eaxOut, ptr32 & ecxOut, ptr32 & dlOut, ptr32 & dhOut, ptr32 & ebxOut, ptr32 & ebpOut, ptr32 & esiOut, ptr32 & ediOut)
{
fn00407908_entry:
	esp = fp
	bl = bl - dl
	bx = DPB(bx, bl, 0) (alias)
	bx = bx & dx
	bh = SLICE(bx, byte, 8) (alias)
	bh = bh << cl
	ebx = DPB(ebx, bh, 8) (alias)
	v12 = (eax & 0x02000000) != 0x00
	eax = __ror(eax, 0x19)
	ah = SLICE(eax, byte, 8) (alias)
	C = v12
	v14 = (ah & 0x00) != 0x00
	ah = __rcr(ah, 22, C)
	ah = ah - 0x4C
	eax = DPB(eax, ah, 8) (alias)
	ebx = ebx >> 0x17
	bl = (byte) ebx (alias)
	bh = SLICE(ebx, byte, 8) (alias)
	edi = edi - ~0x0390
	SCZO = cond(edi)
	C = SCZO (alias)
	v18 = (eax & 0x01 << cl) != 0x00
	eax = __rcr(eax, cl, C)
	ah = SLICE(eax, byte, 8) (alias)
	ax = (word16) eax (alias)
	bl = bl >>u 0x09
	bx = DPB(bx, bl, 0) (alias)
	ebx = DPB(ebx, bl, 0) (alias)
	v19 = (dl & 0x00) != 0x00
	dl = __rol(dl, 0x11)
	dx = DPB(dx, dl, 0) (alias)
	C = v19
	v20 = (dx & 0x01 << cl) != 0x00
	dx = __rcr(dx, cl, C)
	dl = (byte) dx (alias)
	edx = DPB(edx, dx, 0) (alias)
	dh = SLICE(dx, byte, 8) (alias)
	SCZO = cond(ecx - 1416393454)
	SZO = SCZO (alias)
	Z = SCZO (alias)
	C = SCZO (alias)
	branch Test(NE,Z) l00407932_thunk_fn0040751D
l00407908:
l00407908:
	bl = bl - dl
	bx = DPB(bx, bl, 0) (alias)
	bx = bx & dx
	bh = SLICE(bx, byte, 8) (alias)
	bh = bh << cl
	ebx = DPB(ebx, bh, 8) (alias)
	v23 = (eax & 0x02000000) != 0x00
	eax = __ror(eax, 0x19)
	ah = SLICE(eax, byte, 8) (alias)
	C = v23
	v24 = (ah & 0x00) != 0x00
	ah = __rcr(ah, 22, C)
	ah = ah - 0x4C
	eax = DPB(eax, ah, 8) (alias)
	ebx = ebx >> 0x17
	bl = (byte) ebx (alias)
	edi = edi - ~0x0390
	SCZO = cond(edi)
	C = SCZO (alias)
	v25 = (eax & 0x01 << cl) != 0x00
	eax = __rcr(eax, cl, C)
	bl = bl >>u 0x09
	v26 = (dl & 0x00) != 0x00
	dl = __rol(dl, 0x11)
	dx = DPB(dx, dl, 0) (alias)
	C = v26
	v27 = (dx & 0x01 << cl) != 0x00
	dx = __rcr(dx, cl, C)
	SCZO = cond(ecx - 1416393454)
	Z = SCZO (alias)
	branch Test(NE,Z) l00407932_thunk_fn0040751D
l00407932_thunk_fn0040751D:
	Z = fn0040751D(ax, cl, dx, bx, ebp, esi, edi, rArg0, out eax, out ecx, out dl, out dh, out ebx, out ebp, out esi, out edi, out rArg0)
	SCZO = Z (alias)
	SZO = Z (alias)
	return Z
l00407932_thunk_fn00407938:
	Z = fn00407938(eax, ecx, edx, ebx, ebp, esi, edi, psegArg00, out eax, out ecx, out dl, out dh, out ebx, out ebp, out esi, out edi)
	SCZO = Z (alias)
	SZO = Z (alias)
	return Z
fn00407908_exit:
	use eax (=> eaxOut)
	use ecx (=> ecxOut)
	use dl (=> dlOut)
	use dh (=> dhOut)
	use ebx (=> ebxOut)
	use ebp (=> ebpOut)
	use esi (=> esiOut)
	use edi (=> ediOut)
}

// 00407938: FlagGroup bool fn00407938(Register word32 eax, Register word32 ecx, Register word32 edx, Register word32 ebx, Register word32 ebp, Register word32 esi, Register word32 edi, Stack selector psegArg00, Register out ptr32 eaxOut, Register out ptr32 ecxOut, Register out ptr32 dlOut, Register out ptr32 dhOut, Register out ptr32 ebxOut, Register out ptr32 ebpOut, Register out ptr32 esiOut, Register out ptr32 ediOut)
bool fn00407938(word32 eax, word32 ecx, word32 edx, word32 ebx, word32 ebp, word32 esi, word32 edi, selector psegArg00, ptr32 & eaxOut, ptr32 & ecxOut, ptr32 & dlOut, ptr32 & dhOut, ptr32 & ebxOut, ptr32 & ebpOut, ptr32 & esiOut, ptr32 & ediOut)
{
	*ebpOut = ebp;
	byte v7_9 = Mem0[edi + 0x00:byte] - al - C;
	Mem10[edi + 0x00:byte] = v7_9;
	if (v7_9 <= 0x00)
	{
		word32 eax_53;
		word32 ecx_54;
		byte dl_55;
		byte dh_56;
		word32 ebx_57;
		word32 ebp_58;
		word32 esi_59;
		word32 edi_60;
		return fn0040797E(eax, ecx, edx, ebx, ebp, esi, dwLoc02, out eax_53, out ecx_54, out dl_55, out dh_56, out ebx_57, out ebp_58, out esi_59, out edi_60);
	}
	else
	{
		word32 eax_38;
		word32 ecx_39;
		byte dl_40;
		byte dh_41;
		word32 ebx_42;
		word32 esi_43;
		word32 edi_44;
		return fn0040793D(al, ah, ecx, dl, dh, bx, esi, edi, out eax_38, out ecx_39, out dl_40, out dh_41, out ebx_42, out esi_43, out edi_44);
	}
}

// 0040793D: FlagGroup bool fn0040793D(Register byte al, Register byte ah, Register word32 ecx, Register byte dl, Register byte dh, Register word16 bx, Register word32 esi, Register word32 edi, Register out ptr32 eaxOut, Register out ptr32 ecxOut, Register out ptr32 dlOut, Register out ptr32 dhOut, Register out ptr32 ebxOut, Register out ptr32 esiOut, Register out ptr32 ediOut)
bool fn0040793D(byte al, byte ah, word32 ecx, byte dl, byte dh, word16 bx, word32 esi, word32 edi, ptr32 & eaxOut, ptr32 & ecxOut, ptr32 & dlOut, ptr32 & dhOut, ptr32 & ebxOut, ptr32 & esiOut, ptr32 & ediOut)
{
	word32 ecx_6 = ecx - esi;
	byte cl_7 = (byte) ecx_6;
	word16 bx_14 = __rcr(bx, cl_7, cond(ecx_6));
	word32 edx_25 = DPB(edx, dh - (byte) bx_14, 8);
	byte ch_8 = SLICE(ecx_6, byte, 8);
	word32 ebx_16;
	*ebxOut = DPB(ebx, bx_14, 0);
	byte bh_18 = SLICE(bx_14, byte, 8);
	byte dl_27;
	*dlOut = (byte) (edx_25 + 853253922);
	byte dh_28;
	*dhOut = SLICE(edx_25 + 853253922, byte, 8);
	byte al_30 = al ^ cl_7;
	word32 edi_37;
	*ediOut = edi << 0x11;
	word32 esi_40 = __rol(__rcr(__rcl(esi - 0x01, 0x0E, (bx & 0x01 << cl_7) != 0x00), cl_7, false), 0x1A);
	word32 eax_43;
	word32 ecx_44;
	word32 esi_45;
	return fn00407992(ah, al_30, cl_7, ch_8, bh_18, esi_40, out eax_43, out ecx_44, out esi_45);
}

// 00407964: void fn00407964()
void fn00407964()
{
}

// 0040797A: FlagGroup bool fn0040797A(Register word32 eax, Register word32 ecx, Register word32 edx, Register word32 ebx, Register word32 ebp, Register word32 esi, Register out ptr32 eaxOut, Register out ptr32 ecxOut, Register out ptr32 dlOut, Register out ptr32 dhOut, Register out ptr32 ebxOut, Register out ptr32 ebpOut, Register out ptr32 esiOut, Register out ptr32 ediOut)
bool fn0040797A(word32 eax, word32 ecx, word32 edx, word32 ebx, word32 ebp, word32 esi, ptr32 & eaxOut, ptr32 & ecxOut, ptr32 & dlOut, ptr32 & dhOut, ptr32 & ebxOut, ptr32 & ebpOut, ptr32 & esiOut, ptr32 & ediOut)
{
	word32 eax_4 = eax - 0x01 >>u 0x0F;
	word32 eax_12;
	word32 ecx_13;
	byte dl_14;
	byte dh_15;
	word32 ebx_16;
	word32 ebp_17;
	word32 esi_18;
	word32 edi_19;
	return fn0040797E(eax_4, ecx, edx, ebx, ebp, esi, dwLoc04, out eax_12, out ecx_13, out dl_14, out dh_15, out ebx_16, out ebp_17, out esi_18, out edi_19);
}

// 0040797E: FlagGroup byte fn0040797E(Register word32 eax, Register word32 ecx, Register word32 edx, Register word32 ebx, Register word32 ebp, Register word32 esi, Stack word32 dwArg00, Register out ptr32 eaxOut, Register out ptr32 ecxOut, Register out ptr32 dlOut, Register out ptr32 dhOut, Register out ptr32 ebxOut, Register out ptr32 ebpOut, Register out ptr32 esiOut, Register out ptr32 ediOut)
byte fn0040797E(word32 eax, word32 ecx, word32 edx, word32 ebx, word32 ebp, word32 esi, word32 dwArg00, ptr32 & eaxOut, ptr32 & ecxOut, ptr32 & dlOut, ptr32 & dhOut, ptr32 & ebxOut, ptr32 & ebpOut, ptr32 & esiOut, ptr32 & ediOut)
{
	esp = fp;
	eax = eax << 0x0F;
	ah = SLICE(eax, byte, 8);
	al = (byte) eax;
	SCZO = cond(ecx - 0x11DA01FA);
	Z = SCZO;
	if (Test(NE,Z))
	{
		SCZO = cond(Mem0[eax + 0x00:word32] - edx);
		Z = SCZO;
		if (Test(NE,Z))
		{
			Z = fn0040797A(eax, ecx, edx, ebx, ebp, esi, out eax, out ecx, out dl, out dh, out ebx, out ebp, out esi, out edi);
			return Z;
		}
		else
		{
			ecx = eax;
			eax = eax + Mem0[eax + 0x3C:word32];
			v14 = Mem0[eax + 0x50:word32];
			esp = fp - 0x04;
			dwLoc04 = v14;
			esp = fp - 0x08;
			dwLoc08 = ecx;
			eax = eax + 0x80;
			eax = Mem0[eax + 0x00:word32];
			eax = eax + ecx;
			SCZO = cond(eax);
			eax = Mem0[eax + 0x10:word32];
			eax = ecx + eax;
			Mem0[eax + 0x00:word32]();
			SCZO = cond(edx - 3577090330);
			if (Test(EQ,Z))
			{
				SCZO = cond(Mem0[ebx + 3210334705:byte] - bl);
				v17 = esp;
				esp = esp - 0x04;
				Mem0[esp + 0x00:word32] = v17;
			}
			else
			{
				ecx = Mem0[esp + 0x00:word32];
				esp = esp + 0x04;
				edi = 0x00779054;
			}
			edi = Mem0[esp + 0x00:word32];
			esp = esp + 0x04;
			v20 = (esi & 0x01 << 0x20 - cl) != 0x00;
			esi = __rcl(esi, cl, C);
			dh = dh + cl;
			SCZO = cond(dh);
			bh_dh = bh_dh + dh_cl;
			bx = bx >> cl;
			SCZO = cond(bx);
			bh = bh - ah - C;
			ecx = ecx & 0xA4280ABD;
			SZO = cond(ecx);
			C = false;
			Z = fn00407908(eax, ecx, dx, bl, ebp, esi, edi, out eax, out ecx, out dl, out dh, out ebx, out ebp, out esi, out edi);
			return Z;
		}
	}
	else
	{
		dh = 101;
		ebp = dwArg00;
		esp = fp + 0x04;
		ebx = ebx - 0x01;
		bl = (byte) ebx;
		bh = SLICE(ebx, byte, 8);
		bx = (word16) ebx;
		SZO = cond(ebx);
		v11 = eax;
		eax = esi;
		ah = SLICE(eax, byte, 8);
		al = (byte) eax;
		esi = v11;
		Z = fn00407992(ah, al, cl, ch, bh, esi, out eax, out ecx, out esi);
		return Z;
	}
}

// 00407992: FlagGroup bool fn00407992(Register byte ah, Register byte al, Register byte cl, Register byte ch, Register byte bh, Register word32 esi, Register out ptr32 eaxOut, Register out ptr32 ecxOut, Register out ptr32 esiOut)
bool fn00407992(byte ah, byte al, byte cl, byte ch, byte bh, word32 esi, ptr32 & eaxOut, ptr32 & ecxOut, ptr32 & esiOut)
{
	word32 esi_4 = esi >> cl;
	*esiOut = esi_4;
	byte ch_14 = ch >>u cl;
	__rcr(__rcl(al, cl, cond(esi_4)), 0x14, cond(ch_14));
	byte ah_21 = ah + bh >>u cl;
	word32 ecx_16;
	*ecxOut = DPB(ecx, ch_14, 8);
	word32 eax_23;
	*eaxOut = DPB(eax, ah_21, 8);
	return cond(ah_21);
}

