// subject.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

// 00401023: Register word32 fn00401023(Register word32 eax, Register word32 ecx, Register word32 ebx, Register word32 edi)
word32 fn00401023(word32 eax, word32 ecx, word32 ebx, word32 edi)
{
	word32 esp_7;
	word32 eax_8;
	word32 ebx_9;
	byte SZO_10;
	bool C_11;
	word32 edi_12;
	word32 ecx_13;
	fn0E8F6B5B();
	return eax_8;
}

// 00414059: Register Eq_15 Win32CrtStartup()
Eq_15 Win32CrtStartup()
{
	GetLastError();
	GetCommandLineA();
	GetCommandLineA();
	ptr32 esp_163 = fp + ~0x43;
l00414071:
	struct Eq_29 * esp_28 = esp_163 - 0x04;
	esp_28->t0000.u0 = 0x00;
	*(esp_28 - 0x04) = 0x0181;
	*(esp_28 - 0x08) = 0x03;
	*(esp_28 - 0x0C) = 0x00;
	*(esp_28 - 0x10) = 0x04;
	*(esp_28 - 0x14) = 0x80000000;
	*(esp_28 - 0x18) = 0x0042E037;
	Eq_15 eax_42 = CreateFileW(*(esp_28 - 0x18), *(esp_28 - 0x14), *(esp_28 - 0x10), *(esp_28 - 0x0C), *(esp_28 - 0x08), *(esp_28 - 0x04), esp_28->t0000);
	if (eax_42 != ~0x00)
	{
		esp_28->t0000.u0 = 0x00401000;
		*(esp_28 - 0x04) = 0x00;
		*(esp_28 - 0x08) = 0x0182;
		*(esp_28 - 0x0C) = 0x03;
		*(esp_28 - 0x10) = 0x00;
		*(esp_28 - 0x14) = 0x05;
		*(esp_28 - 0x18) = 0x20000000;
		*(esp_28 - 0x1C) = 0x0042E000;
		Eq_15 eax_330 = CreateFileW(*(esp_28 - 0x1C), *(esp_28 - 0x18), *(esp_28 - 0x14), *(esp_28 - 0x10), *(esp_28 - 0x0C), *(esp_28 - 0x08), *(esp_28 - 0x04));
		VirtualProtect(esp_28->t0000, esp_28->t0004, esp_28->t0008, esp_28->t000C);
		esp_28->t000C = eax_330;
		GetFileType(esp_28->t000C);
		GetLastError();
		esp_28->t000C.u0 = 0x00401000;
		GetCommandLineA();
		esp_28->t0008 = dwLoc1C;
		esp_28->t0004 = dwLoc34;
		GetFileType(esp_28->t0004);
		esp_28->t0004.u0 = 77889;
		GetLastError();
		esp_28->t0000.u0 = 0x00;
		*(esp_28 - 0x04) = 0xA7;
		*(esp_28 - 0x08) = 0x03;
		*(esp_28 - 0x0C) = 0x00;
		*(esp_28 - 0x10) = 0x01;
		*(esp_28 - 0x14) = 0x20000000;
		*(esp_28 - 0x18) = 0x0042E097;
		Eq_15 eax_371 = CreateFileA(*(esp_28 - 0x18), *(esp_28 - 0x14), *(esp_28 - 0x10), *(esp_28 - 0x0C), *(esp_28 - 0x08), *(esp_28 - 0x04), esp_28->t0000);
		esp_28->t0000.u0 = 0x00;
		*(esp_28 - 0x04) = (union Eq_15 *) dwLoc44;
		GetFileSize(*(esp_28 - 0x04), esp_28->t0000);
		esp_28->t0000 = eax_371;
		Eq_15 eax_389 = GetFileType(esp_28->t0000);
		word32 esp_391;
		word32 ebp_392;
		byte SCZO_393;
		word32 eax_394;
		bool Z_395;
		byte SZO_396;
		bool C_397;
		word32 ecx_398;
		word32 ebx_399;
		word32 edi_400;
		(*((word32) dwLoc1C + 4275553))();
		return fn00401023(eax_394, ecx_398, ebx_399, edi_400);
	}
	else
	{
		esp_28->t0000.u0 = 0x00;
		*(esp_28 - 0x04) = (union Eq_15 *) eax_42;
		struct Eq_315 * esp_183 = esp_28 - 0x04;
l004140AD:
		GetFileSize(esp_183->t0000, esp_183->t0004);
		ptr32 esp_86 = esp_183 + 0x01;
		*(esp_86 - 0x04) = 0x00;
		*(esp_86 - 0x08) = 0x01A3;
		*(esp_86 - 0x0C) = 0x03;
		*(esp_86 - 0x10) = 0x00;
		*(esp_86 - 0x14) = 0x07;
		*(esp_86 - 0x18) = 0x20000000;
		*(esp_86 - 0x1C) = 4382899;
		CreateFileA(*(esp_86 - 0x1C), *(esp_86 - 0x18), *(esp_86 - 0x14), *(esp_86 - 0x10), *(esp_86 - 0x0C), *(esp_86 - 0x08), *(esp_86 - 0x04));
		*(esp_86 - 0x04) = 0x00;
		ptr32 esp_104 = esp_86 - 0x04;
		do
		{
			struct Eq_398 * esp_111 = esp_104 - 0x04;
			esp_111->t0000.u0 = 0xA3;
			*(esp_111 - 0x04) = 0x03;
			*(esp_111 - 0x08) = 0x00;
			*(esp_111 - 0x0C) = 0x07;
			*(esp_111 - 0x10) = 0xA0000000;
			*(esp_111 - 0x14) = 0x0042E009;
			Eq_15 eax_123 = CreateFileA(*(esp_111 - 0x14), *(esp_111 - 0x10), *(esp_111 - 0x0C), *(esp_111 - 0x08), *(esp_111 - 0x04), esp_111->t0000, esp_111->t0004);
			esp_111->t0004.u0 = 0x00;
			esp_111->t0000.u0 = 0x0125;
			*(esp_111 - 0x04) = 0x03;
			*(esp_111 - 0x08) = 0x00;
			*(esp_111 - 0x0C) = 0x00;
			*(esp_111 - 0x10) = 0x60000000;
			*(esp_111 - 0x14) = 0x0042E03E;
			Eq_15 eax_140 = CreateFileA(*(esp_111 - 0x14), *(esp_111 - 0x10), *(esp_111 - 0x0C), *(esp_111 - 0x08), *(esp_111 - 0x04), esp_111->t0000, esp_111->t0004);
			esp_111->t0004 = eax_123;
			GetFileType(esp_111->t0004);
			esp_111->t0004.u0 = 0x00;
			esp_111->t0000.u0 = 0x0122;
			*(esp_111 - 0x04) = 0x03;
			*(esp_111 - 0x08) = 0x00;
			*(esp_111 - 0x0C) = 0x06;
			*(esp_111 - 0x10) = 0xE0000000;
			*(esp_111 - 0x14) = 4382943;
			dwLoc44 = eax_123;
			Eq_15 eax_162 = CreateFileA(*(esp_111 - 0x14), *(esp_111 - 0x10), *(esp_111 - 0x0C), *(esp_111 - 0x08), *(esp_111 - 0x04), esp_111->t0000, esp_111->t0004);
			esp_163 = (char *) &esp_111->t0004 + 0x04;
			if (eax_162 != ~0x00)
				goto l00414071;
			GetLastError();
			esp_111->t0004.u0 = 0x00;
			esp_111->t0000.u0 = 0x01A5;
			*(esp_111 - 0x04) = 0x03;
			*(esp_111 - 0x08) = 0x00;
			*(esp_111 - 0x0C) = 0x01;
			*(esp_111 - 0x10) = 0x60000000;
			*(esp_111 - 0x14) = 0x0042E0D4;
			Eq_15 eax_182 = CreateFileA(*(esp_111 - 0x14), *(esp_111 - 0x10), *(esp_111 - 0x0C), *(esp_111 - 0x08), *(esp_111 - 0x04), esp_111->t0000, esp_111->t0004);
			esp_183 = (struct Eq_315 *) ((char *) &esp_111->t0004 + 0x04);
			dwLoc34 = eax_182;
			if (eax_182 != ~0x00)
				goto l004140AD;
			esp_111->t0004 = eax_182;
			CloseHandle(esp_111->t0004);
			esp_111->t0004.u0 = 0x0042E08C;
			esp_111->t0000.u0 = 0x00;
			*(esp_111 - 0x04) = (union Eq_15 *) eax_140;
			GetFileSize(*(esp_111 - 0x04), esp_111->t0000);
			esp_111->t0000 = eax_162;
			CloseHandle(esp_111->t0000);
			Eq_15 eax_206 = LoadLibraryA(esp_111->t0004);
			GetCommandLineA();
			esp_111->t0004.u0 = 0x0042E0C4;
			esp_111->t0000 = eax_206;
			*(esp_111 - 0x04) = (union Eq_15 *) eax_182;
			CloseHandle(*(esp_111 - 0x04));
			Eq_642 eax_220 = GetProcAddress(esp_111->t0000, esp_111->t0004);
			GetCommandLineA();
			GetCommandLineA();
			esp_111->t0004.u0 = 0x00;
			esp_111->t0000 = eax_42;
			GetFileSize(esp_111->t0000, esp_111->t0004);
			GetLastError();
			esp_111->t0004.u0 = 0x00;
			esp_111->t0000.u0 = 0x86;
			*(esp_111 - 0x04) = 0x03;
			*(esp_111 - 0x08) = 0x00;
			*(esp_111 - 0x0C) = 0x05;
			*(esp_111 - 0x10) = 0xE0000000;
			*(esp_111 - 0x14) = 4382835;
			esp_104 = (char *) &esp_111->t0004 + 0x04;
		} while (CreateFileA(*(esp_111 - 0x14), *(esp_111 - 0x10), *(esp_111 - 0x0C), *(esp_111 - 0x08), *(esp_111 - 0x04), esp_111->t0000, esp_111->t0004) != ~0x00);
		int32 eax_265 = eax_220();
		GetLastError();
		esp_111->t0004.u0 = 0x00;
		esp_111->t0000.u0 = 0x0183;
		*(esp_111 - 0x04) = 0x03;
		*(esp_111 - 0x08) = 0x00;
		*(esp_111 - 0x0C) = 0x01;
		*(esp_111 - 0x10) = 0x60000000;
		*(esp_111 - 0x14) = 4382812;
		CreateFileW(*(esp_111 - 0x14), *(esp_111 - 0x10), *(esp_111 - 0x0C), *(esp_111 - 0x08), *(esp_111 - 0x04), esp_111->t0000, esp_111->t0004);
		esp_111->t0004 = eax_182;
		Eq_15 eax_302 = GetFileType(esp_111->t0004);
		word32 esp_304;
		word32 ebp_305;
		byte SCZO_306;
		Eq_15 eax_307;
		bool Z_308;
		byte SZO_309;
		bool C_310;
		word32 ecx_311;
		word32 ebx_312;
		word32 edi_313;
		(*((word32) (eax_265 ^ 0x06BD) + 0x004142C9))();
		return eax_307;
	}
}

