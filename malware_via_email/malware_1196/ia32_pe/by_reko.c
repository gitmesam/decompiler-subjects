// subject.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

// 00401000: void fn00401000(Stack word32 dwArg04)
void fn00401000(word32 dwArg04)
{
}

// 00401380: Register word32 fn00401380(Register word32 ecx, Register word32 ebx, Register word32 ebp, Register word32 edi, Register out ptr32 ecxOut, Register out ptr32 ebxOut, Register out ptr32 esiOut, Register out ptr32 ediOut)
word32 fn00401380(word32 ecx, word32 ebx, word32 ebp, word32 edi, ptr32 & ecxOut, ptr32 & ebxOut, ptr32 & esiOut, ptr32 & ediOut)
{
	word32 edx_21 = 0x15;
	do
		edx_21 = edx_21 - 0x01;
	while (edx_21 != 0x00);
	CharNextA(fp - 0x05);
	fn004018B0(fp - 0x14, 0x0A, 0x00409780);
	word32 edi_332 = LoadLibraryA(fp - 0x14);
	word32 esp_334 = fp - 188;
	word32 eax_60 = GetCurrentThread();
	if (eax_60 == 0x00)
	{
		word32 ebp_335;
		byte SCZO_336;
		word32 ebx_337;
		word32 esi_338;
		word32 ecx_340;
		word32 eax_341;
		word32 edx_342;
		byte SZO_343;
		byte C_344;
		byte Z_345;
		byte bl_346;
		byte SO_347;
		byte dl_348;
		0x00409780();
	}
	word32 esi_333 = 0x00;
	if (false)
		esi_333 = fn004017A0(out edi_332);
	do
		esi_333 = esi_333 + 0x01;
	while (esi_333 < 0x03);
	word32 esp_85 = esp_334 - 0x04;
	Mem86[esp_85 + 0x00:word32] = 0x021C0C0C;
	word32 ecx_90;
	word32 edx_91;
	word32 esi_92;
	word32 edi_93;
	word32 eax_94 = fn00401C20(edi_332, esi_333, edi_332, dwArg00, out ecx_90, out edx_91, out esi_92, out edi_93);
	word32 esp_105 = esp_85 + 0x04;
	do
	{
		word32 esp_99 = esp_105 - 0x04;
		Mem100[esp_99 + 0x00:word32] = 0x00;
		Mem102[esp_99 - 0x04 + 0x00:word32] = 0x00;
		Mem104[esp_99 - 0x08 + 0x00:word32] = 0x00;
		word32 ebp_106;
		byte SCZO_107;
		word32 ebx_108;
		word32 esi_109;
		word32 edi_110;
		word32 ecx_111;
		word32 eax_112;
		word32 edx_113;
		byte SZO_114;
		byte C_115;
		byte Z_116;
		byte bl_117;
		byte SO_118;
		byte dl_119;
		eax_94();
	} while (eax_112 != 0x00);
	Mem124[esp_105 - 0x04 + 0x00:word32] = ~0x00;
	Mem126[esp_105 - 0x08 + 0x00:word32] = ~0x00;
	Mem128[esp_105 - 0x0C + 0x00:word32] = ~0x00;
	word32 ebp_130;
	byte SCZO_131;
	word32 ecx_135;
	word32 eax_136;
	word32 edx_137;
	byte SZO_138;
	byte C_139;
	byte Z_140;
	byte bl_141;
	byte SO_142;
	byte dl_143;
	word32 edi_134;
	word32 esi_133;
	word32 ebx_132;
	word32 esp_129;
	esi_109();
	if (eax_136 != 0x00EFEF20)
	{
		word32 ebp_318;
		byte SCZO_319;
		word32 ecx_323;
		word32 eax_324;
		word32 edx_325;
		byte SZO_326;
		byte C_327;
		byte Z_328;
		byte bl_329;
		byte SO_330;
		byte dl_331;
		eax_136();
	}
	GetLastError();
	word32 esp_155 = esp_129 - 0x04;
	Mem156[esp_155 + 0x00:word32] = 3769334729;
	word32 ecx_157;
	word32 edx_158;
	word32 esi_159;
	word32 edi_160;
	word32 eax_161 = fn00401C20(ebx_132, esi_133, edi_134, dwArg00, out ecx_157, out edx_158, out esi_159, out edi_160);
	Mem172[esp_155 + 0x00:word32] = 0x00;
	Mem174[esp_155 - 0x04 + 0x00:word32] = 0x08;
	Mem176[esp_155 - 0x08 + 0x00:word32] = 2172712;
	word32 ebp_178;
	byte SCZO_179;
	word32 ecx_183;
	word32 eax_184;
	word32 edx_185;
	byte SZO_186;
	byte C_187;
	byte Z_188;
	byte bl_189;
	byte SO_190;
	byte dl_191;
	word32 edi_182;
	word32 esi_181;
	word32 ebx_180;
	word32 esp_177;
	eax_161();
	if (eax_184 != 0x00222728)
	{
		word32 ebp_303;
		byte SCZO_304;
		word32 ecx_308;
		word32 eax_309;
		word32 edx_310;
		byte SZO_311;
		byte C_312;
		byte Z_313;
		byte bl_314;
		byte SO_315;
		byte dl_316;
		eax_184();
	}
	word32 esp_198 = esp_177 - 0x04;
	Mem199[esp_198 + 0x00:word32] = 2921600904;
	word32 ecx_200;
	word32 edx_201;
	word32 esi_202;
	word32 edi_203;
	word32 eax_204 = fn00401C20(ebx_180, esi_181, edi_182, dwArg00, out ecx_200, out edx_201, out esi_202, out edi_203);
	Mem208[esp_198 + 0x00:word32] = 0x20;
	Mem211[esp_198 - 0x04 + 0x00:word32] = fp - 0x38;
	Mem213[esp_198 - 0x08 + 0x00:word32] = 11;
	word32 ebp_215;
	byte SCZO_216;
	word32 ebx_217;
	word32 esi_218;
	word32 edi_219;
	word32 ecx_220;
	word32 edx_222;
	byte SZO_223;
	byte C_224;
	byte Z_225;
	byte bl_226;
	byte SO_227;
	byte dl_228;
	word32 eax_221;
	word32 esp_214;
	eax_204();
	word32 ecx_229 = fp - 0x38;
	*ecxOut = ecx_229;
	if (eax_221 != fp - 0x38)
	{
		word32 ebp_288;
		byte SCZO_289;
		word32 ebx_290;
		word32 esi_291;
		word32 edi_292;
		word32 ecx_293;
		word32 edx_295;
		byte SZO_296;
		byte C_297;
		byte Z_298;
		byte bl_299;
		byte SO_300;
		byte dl_301;
		eax_221();
	}
	if (bLoc38 != bLoc37)
	{
		word32 ebp_273;
		byte SCZO_274;
		word32 ebx_275;
		word32 esi_276;
		word32 edi_277;
		word32 ecx_278;
		word32 edx_280;
		byte SZO_281;
		byte C_282;
		byte Z_283;
		byte bl_284;
		byte SO_285;
		byte dl_286;
		eax_221();
	}
	word32 esp_260 = esp_214 + 0x04;
	word32 edi_259;
	*ediOut = Mem213[esp_214 + 0x00:word32];
	word32 esi_261;
	*esiOut = Mem213[esp_260 + 0x00:word32];
	word32 ebx_263;
	*ebxOut = Mem213[esp_260 + 0x04:word32];
	return eax_221;
}

// 004014A0: Register word32 fn004014A0(Register word32 eax, Register word32 ecx, Register word32 ebx, Register word32 ebp, Register word32 edi)
word32 fn004014A0(word32 eax, word32 ecx, word32 ebx, word32 ebp, word32 edi)
{
	word32 esi_14 = Mem0[0x00405344:word32];
	word32 ebp_32 = fp - 0x04;
	word32 esp_15 = fp - 0x0274;
	word32 eax_24 = GetCurrentThread();
	if (eax_24 == 0x00)
	{
		byte SCZO_552;
		word32 esi_554;
		word32 eax_556;
		byte SZO_557;
		byte C_558;
		byte Z_559;
		word32 edx_561;
		byte al_562;
		word16 dx_563;
		byte S_564;
		selector fs_565;
		esi_14();
	}
	word32 ecx_37;
	word32 ebx_38;
	word32 esi_39;
	word32 edi_40;
	fn00401380(ecx, ebx, ebp_32, edi, out ecx_37, out ebx_38, out esi_39, out edi_40);
	word32 edx_53 = Mem0[Mem0[esi_39 + 0x3C:word32] + 0xC0 + esi_39:word32];
	fn004018B0(fp - 0x28, 0x18, fp - 0x38);
	word32 esp_81 = esp_15 - 0x04;
	Mem82[esp_81 + 0x00:word32] = fp - 0x28;
	word32 eax_83 = LoadLibraryA(Mem82[esp_81 + 0x00:LPCSTR]);
	Mem85[esp_81 - 0x04 + 0x00:word32] = 3321835334;
	word32 ecx_88;
	word32 edx_89;
	word32 esi_90;
	word32 edi_91;
	word32 eax_92 = fn00401C20(eax_83, esi_39, edi_40, dwArg00, out ecx_88, out edx_89, out esi_90, out edi_91);
	Mem97[esp_81 - 0x04 + 0x00:word32] = fp - 0x10;
	Mem99[esp_81 - 0x08 + 0x00:word32] = 0x40;
	Mem101[esp_81 - 0x0C + 0x00:word32] = 0x6200;
	Mem103[esp_81 - 0x10 + 0x00:word32] = 0x00;
	word32 esp_104;
	word32 ebp_105;
	byte SCZO_106;
	word32 ebx_107;
	word32 esi_108;
	word32 edi_109;
	word32 eax_110;
	byte SZO_111;
	byte C_112;
	byte Z_113;
	word32 ecx_114;
	word32 edx_115;
	byte al_116;
	word16 dx_117;
	byte S_118;
	selector fs_119;
	eax_92();
	Mem123[esp_104 - 0x04 + 0x00:word32] = 0x00;
	word32 edi_121 = GetModuleHandleA;
	word32 esp_122 = esp_104 - 0x04;
	word32 eax_124 = GetModuleHandleA(Mem123[esp_104 - 0x04 + 0x00:LPCSTR]);
	if (eax_124 == 0x00)
	{
		word32 ebp_512;
		byte SCZO_513;
		word32 ebx_514;
		word32 esi_515;
		word32 eax_517;
		byte SZO_518;
		byte C_519;
		byte Z_520;
		word32 ecx_521;
		word32 edx_522;
		byte al_523;
		word16 dx_524;
		byte S_525;
		selector fs_526;
		(fp - 0x04)();
	}
	word32 esp_146 = esp_122 - 0x04;
	Mem147[esp_146 + 0x00:word32] = esi_14;
	fn00401000(dwArg00);
	word32 eax_150 = esi_14;
	word32 ecx_152 = 0x187F;
	do
	{
		Mem156[eax_150 + 0x00:word32] = Mem147[eax_150 + 0x00:word32] + 0x4DF4;
		eax_150 = eax_150 + 0x04;
		ecx_152 = ecx_152 - 0x01;
	} while (ecx_152 != 0x00);
	Mem163[esp_146 + 0x00:word32] = ecx_152;
	word32 ebp_165;
	byte SCZO_166;
	word32 ebx_167;
	word32 esi_168;
	word32 edi_169;
	word32 eax_170;
	byte SZO_171;
	byte C_172;
	byte Z_173;
	word32 ecx_174;
	word32 edx_175;
	byte al_176;
	word16 dx_177;
	byte S_178;
	selector fs_179;
	word32 esp_164;
	edi_121();
	word32 edi_187 = Mem163[esi_168 + 0x3C:word32] + esi_168;
	Mem188[edi_187 + 0xC0:word32] = edx_53;
	word32 eax_189 = Mem188[edi_187 + 0xA0:word32];
	Mem195[edi_187 + 22:word16] = wLoc14;
	if (eax_189 != 0x00)
	{
		word32 esi_428 = eax_189 + Mem195[0x00405344:word32];
		Mem434[esp_164 - 0x04 + 0x00:word32] = fp - 0x14;
		CharNextA(Mem434[esp_164 - 0x04 + 0x00:LPCSTR]);
		esp_164 = esp_164 - 0x04;
		word32 edx_439 = Mem434[0x00405344:word32] - Mem434[edi_187 + 0x34:word32];
		word32 ecx_442 = 0x0162;
		word32 ebx_443 = 0x0A;
		do
		{
			ecx_442 = ecx_442 - 0x03;
			if (ecx_442 != 0x00)
				ecx_442 = 0x03;
			ebx_443 = ebx_443 - 0x01;
		} while (ebx_443 != 0x00);
		if (Mem434[esi_428 + 0x00:word32] != ebx_443)
		{
			esp_164 = esp_164 - 0x04;
			do
			{
				word32 eax_468 = Mem434[esi_428 + 0x04:word32];
				word32 ecx_474 = esi_428 + 0x08;
				if (eax_468 - 0x08 >>u 0x01 > 0x00)
				{
					word32 dwLoc18_483 = eax_468 - 0x08 >>u 0x01;
					do
					{
						word32 eax_486 = (word32) Mem434[ecx_474 + 0x00:word16];
						if ((eax_486 & 0xF000) == 0x3000)
						{
							word32 eax_502 = (eax_486 & 0x0FFF) + Mem434[esi_428 + 0x00:word32] + Mem434[0x00405344:word32];
							Mem504[eax_502 + 0x00:word32] = Mem434[eax_502 + 0x00:word32] + edx_439;
						}
						word32 v26_495 = dwLoc18_483 - 0x01;
						ecx_474 = ecx_474 + 0x02;
						dwLoc18_483 = v26_495;
					} while (v26_495 != 0x00);
				}
				esi_428 = esi_428 + Mem434[esi_428 + 0x04:word32];
			} while (Mem434[esi_428 + 0x00:word32] != 0x00);
		}
	}
	if (Mem195[edi_187 + 0x80:word32] != 0x00)
	{
		esp_164 = esp_164 - 0x04;
		Mem300[esp_164 + 0x00:word32] = 0x00;
		CloseHandle(Mem300[esp_164 + 0x00:HANDLE]);
		word32 ebx_303 = Mem300[edi_187 + 0x80:word32] + Mem300[0x00405344:word32];
		word32 dwLoc14_306 = ebx_303;
		if (Mem300[ebx_303 + 0x10:word32] != 0x00)
		{
			do
			{
				esp_164 = esp_164 - 0x04;
				Mem322[esp_164 + 0x00:word32] = Mem300[ebx_303 + 0x0C:word32] + Mem300[0x00405344:word32];
				word32 eax_323 = LoadLibraryA(Mem322[esp_164 + 0x00:LPCSTR]);
				if (eax_323 != 0x00)
				{
					word32 ebx_356;
					word32 eax_351 = Mem322[ebx_303 + 0x00:word32];
					if (eax_351 != 0x00)
						ebx_356 = eax_351;
					else
						ebx_356 = Mem322[ebx_303 + 0x10:word32];
					word32 eax_357 = Mem322[0x00405344:word32];
					word32 ebx_360 = ebx_356 + eax_357;
					word32 eax_362 = Mem322[ebx_360 + 0x00:word32];
					word32 esi_361 = Mem322[dwLoc14_306 + 0x10:word32] + eax_357;
					byte S_366 = cond(eax_362);
					if (eax_362 != 0x00)
					{
						do
						{
							word32 edx_399;
							if (!S_366)
								edx_399 = (word32) Mem322[ebx_360 + 0x00:word16];
							else
								edx_399 = eax_362 + 0x02 + Mem322[0x00405344:word32];
							word32 esp_401 = esp_164 - 0x04;
							Mem402[esp_401 + 0x00:word32] = edx_399;
							Mem404[esp_401 - 0x04 + 0x00:word32] = eax_323;
							Mem407[esi_361 + 0x00:word32] = GetProcAddress(Mem404[esp_401 - 0x04 + 0x00:HMODULE], Mem404[esp_401 + 0x00:LPCSTR]);
							ebx_360 = ebx_360 + 0x04;
							eax_362 = Mem407[ebx_360 + 0x00:word32];
							esp_164 = esp_401 - 0x04;
							esi_361 = esi_361 + 0x04;
							S_366 = cond(eax_362);
						} while (eax_362 != 0x00);
					}
					ebx_303 = dwLoc14_306;
				}
				ebx_303 = ebx_303 + 0x14;
				dwLoc14_306 = ebx_303;
			} while (Mem322[ebx_303 + 0x10:word32] != 0x00);
		}
	}
	word32 eax_228 = Mem195[edi_187 + 0x28:word32] + Mem195[0x00405344:word32];
	Mem231[0x0040534C:word32] = eax_228;
	word32 esp_232 = esp_164 - 0x04;
	Mem233[esp_232 + 0x00:word32] = eax_228;
	word32 edi_240 = Mem233[Mem233[Mem233[fs_179:0x30:word32] + 0x0C:word32] + 0x0C:word32];
	word32 eax_241 = Mem233[0x00405344:word32];
	do
		edi_240 = Mem233[edi_240 + 0x00:word32];
	while (Mem233[edi_240 + 0x18:word32] != eax_241);
	Mem251[esp_232 + 0x00:word32] = fp - 0x08;
	CharNextA(Mem251[esp_232 + 0x00:LPCSTR]);
	Mem267[edi_240 + 0x1C:word32] = Mem251[0x0040534C:word32];
	word32 ecx_268 = 0x03B3;
	word32 edx_269 = 0x0A;
	do
	{
		ecx_268 = ecx_268 + 0x02;
		if (ecx_268 == 0x00)
			ecx_268 = 0x01;
		edx_269 = edx_269 - 0x01;
	} while (edx_269 != 0x00);
	return ecx_268;
}

// 004017A0: Register word32 fn004017A0(Register out ptr32 ediOut)
word32 fn004017A0(ptr32 & ediOut)
{
	*ediOut = edi;
	word32 esp_14 = fp - 0x30;
	if (GetMessageA(fp - 0x1C, 0x00, 0x00, 0x00) != 0x00)
	{
		word32 esp_49 = fp - 0x38 + 0x0C;
		do
		{
			word32 esp_52 = esp_49 - 0x04;
			Mem53[esp_52 + 0x00:word32] = esp_49 + 0x00;
			TranslateMessage(Mem53[esp_52 + 0x00:(ptr MSG)]);
			Mem57[esp_52 - 0x04 + 0x00:word32] = esp_52 + 0x0C;
			DispatchMessageA(Mem57[esp_52 - 0x04 + 0x00:(ptr MSG)]);
			Mem60[esp_52 - 0x08 + 0x00:word32] = 0x00;
			Mem62[esp_52 - 0x0C + 0x00:word32] = 0x00;
			Mem64[esp_52 - 0x10 + 0x00:word32] = 0x00;
			Mem67[esp_52 - 0x14 + 0x00:word32] = esp_52 + 0x08;
			esp_49 = esp_52 - 0x14;
		} while (GetMessageA(Mem67[esp_52 - 0x14 + 0x00:LPMSG], Mem67[esp_52 - 0x10 + 0x00:HWND], Mem67[esp_52 - 0x0C + 0x00:UINT], Mem67[esp_52 - 0x08 + 0x00:UINT]) != 0x00);
		word32 edi_72;
		*ediOut = Mem67[esp_52 - 0x14 + 0x00:word32];
		esp_14 = esp_52 - 0x0C;
	}
	return Mem0[esp_14 + 0x00:word32];
}

// 00401800: Register DWORD Win32CrtStartup()
DWORD Win32CrtStartup()
{
	word32 ebp_110 = fp - 0x04;
	word32 eax_11 = 0x035E;
	word32 edx_12 = 0x31;
	do
	{
		eax_11 = eax_11 - 0x0A;
		word32 dwLoc08_121 = eax_11;
		if (eax_11 == 0x00)
		{
			eax_11 = 0x08;
			dwLoc08_121 = 0x08;
		}
		word32 ecx_111 = dwLoc08_121;
		edx_12 = edx_12 - 0x01;
	} while (edx_12 != 0x00);
	word32 esp_109 = fp - 0x1C;
	word32 eax_112 = RegQueryValueA(edx_12, edx_12, edx_12, edx_12);
	if (eax_112 != 0x06)
	{
		word32 edx_113;
		byte SCZO_114;
		byte Z_115;
		byte SZO_116;
		byte C_117;
		(fp - 0x04)();
	}
	word32 ecx_47;
	word32 ebx_48;
	word32 edi_49;
	word32 eax_50 = fn00401920(eax_112, ecx_111, ebx, edi, out ecx_47, out ebx_48, out edi_49);
	if (eax_50 != 0x00)
	{
		word32 esp_86 = esp_109 - 0x04;
		Mem87[esp_86 + 0x00:word32] = 66;
		word32 eax_100 = DPB(eax_50, GetKeyState(Mem87[esp_86 + 0x00:int32]), 0);
		word32 ecx_105 = 0x033B;
		word32 edx_101 = 0x06;
		do
		{
			ecx_105 = ecx_105 >>u 0x08;
			word32 dwLoc08_106 = ecx_105;
			if (ecx_105 == 0x00)
			{
				ecx_105 = 0x08;
				dwLoc08_106 = 0x08;
			}
			eax_100 = eax_100 ^ dwLoc08_106;
			edx_101 = edx_101 - 0x01;
		} while (edx_101 != 0x00);
		fn004014A0(eax_100, ecx_105, ebx_48, ebp_110, edi_49);
	}
	word32 eax_59 = 0x02D6;
	word32 edx_60 = 0x4C;
	do
	{
		eax_59 = eax_59 - 0x07;
		if (eax_59 == 0x00)
			eax_59 = 0x09;
		edx_60 = edx_60 - 0x01;
	} while (edx_60 != 0x00);
	return Mem0[0x0040534C:word32];
}

// 004018B0: void fn004018B0(Register word32 eax, Register word32 ecx, Register word32 edx)
void fn004018B0(word32 eax, word32 ecx, word32 edx)
{
	word32 esi_58 = edx;
	word32 edi_11 = eax;
	byte al_13 = Mem0[edx + 0x00:byte];
	if (al_13 != 0x00)
	{
		byte cl_48 = (byte) ecx;
		do
		{
			byte al_111;
			if (al_13 <=u 0x5A && al_13 >=u 0x41)
				al_111 = (byte) (int32) ((int64) ((int32) al_13 - 0x41 + ecx) % 0x1A) + 0x41;
			else if (al_13 <=u 122 && al_13 >=u 0x61)
				al_111 = (byte) (int32) ((int64) ((int32) al_13 - 0x61 + ecx) % 0x1A) + 0x61;
			else
				al_111 = al_13 ^ 0x1A - cl_48;
			Mem73[edi_11 + 0x00:byte] = al_111;
			esi_58 = esi_58 + 0x01;
			al_13 = Mem73[esi_58 + 0x00:byte];
			edi_11 = edi_11 + 0x01;
		} while (al_13 != 0x00);
	}
}

// 00401920: Register word32 fn00401920(Register word32 eax, Register word32 ecx, Register word32 ebx, Register word32 edi, Register out ptr32 ecxOut, Register out ptr32 ebxOut, Register out ptr32 ediOut)
word32 fn00401920(word32 eax, word32 ecx, word32 ebx, word32 edi, ptr32 & ecxOut, ptr32 & ebxOut, ptr32 & ediOut)
{
	*ecxOut = ecx;
	word32 ebp_287 = fp - 0x04;
	word32 edi_21 = edi - dwLoc0138;
	word32 esp_28 = fp - 0x0170;
	word32 eax_30 = RegQueryValueA(0x00, 0x00, 0x00, 0x00);
	if (eax_30 != 0x06)
	{
		byte SCZO_288;
		word32 esi_290;
		word32 eax_292;
		byte SZO_293;
		byte C_294;
		byte Z_295;
		byte CZ_297;
		byte dl_298;
		word32 edx_299;
		ecx();
	}
	if (Mem0[0x00405340:word32] == 0x00)
	{
		Mem92[0x00405340:word32] = 0x01;
		word32 esp_94 = esp_28 - 0x04;
		Mem95[esp_94 + 0x00:word32] = 0x00401920;
		word32 ecx_96;
		word32 ebx_97;
		word32 esi_98;
		word32 edi_99;
		fn00401380(ecx, ebx, ebp_287, edi_21, out ecx_96, out ebx_97, out esi_98, out edi_99);
		Mem103[0x00405344:word32] = Mem95[esp_94 + 0x00:word32];
		Mem104[0x00405344:word16] = 0x00;
		word32 ecx_105 = Mem104[0x00405344:word32];
		word32 eax_106 = Mem104[ecx_105 + 0x3C:word32];
		word32 esi_107 = Mem104[eax_106 + 0x50 + ecx_105:word32];
		Mem109[esp_94 + 0x00:word32] = 0x40;
		Mem112[esp_94 - 0x04 + 0x00:word32] = 0x1000;
		Mem114[esp_94 - 0x08 + 0x00:word32] = esi_107;
		Mem116[esp_94 - 0x0C + 0x00:word32] = 0x00;
		word32 eax_119 = VirtualAlloc(Mem116[esp_94 - 0x0C + 0x00:LPVOID], Mem116[esp_94 - 0x08 + 0x00:SIZE_T], Mem116[esp_94 - 0x04 + 0x00:DWORD], Mem116[esp_94 + 0x00:DWORD]);
		Mem124[0x00405348:word32] = eax_119;
		word32 eax_110 = eax_106 + ecx_105;
		word32 esp_115 = esp_94 - 0x0C;
		word32 ebx_118 = 0x00403000;
		if (true)
		{
			word32 ecx_275 = eax_119;
			word32 eax_276 = Mem124[0x00405344:word32] - eax_119;
			do
			{
				Mem281[ecx_275 + 0x00:byte] = Mem124[eax_276 + ecx_275:byte];
				ecx_275 = ecx_275 + 0x01;
				esi_107 = esi_107 - 0x01;
			} while (esi_107 != 0x00);
		}
		word32 edi_129 = eax_119 - Mem124[0x00405344:word32];
		if (Mem124[0x00403000:word32] != 0x00)
		{
			do
			{
				word32 esp_226 = esp_28 - 0x10;
				word32 ecx_227 = 0x0D;
				do
					ecx_227 = ecx_227 - 0x01;
				while (ecx_227 != 0x00);
				word32 eax_236 = Mem124[ebx_118 + 0x04:word32] - 0x08 >>u 0x01;
				word32 ecx_239 = ebx_118 + 0x08;
				if (eax_236 != 0x00)
				{
					word32 edx_249 = eax_236;
					do
					{
						word32 eax_255 = (word32) Mem124[ecx_239 + 0x00:word16];
						if ((eax_255 & 0xF000) == 0x3000)
						{
							word32 eax_270 = (eax_255 & 0x0FFF) + Mem124[ebx_118 + 0x00:word32] + Mem124[0x00405348:word32];
							Mem272[eax_270 + 0x00:word32] = Mem124[eax_270 + 0x00:word32] + edi_129;
						}
						ecx_239 = ecx_239 + 0x02;
						edx_249 = edx_249 - 0x01;
					} while (edx_249 != 0x00);
				}
				esp_115 = esp_226;
				ebx_118 = ebx_118 + Mem124[ebx_118 + 0x04:word32];
			} while (Mem124[ebx_118 + 0x00:word32] != 0x00);
		}
		word32 edx_140 = 0x0A;
		do
			edx_140 = edx_140 - 0x01;
		while (edx_140 != 0x00);
		word32 esp_157 = esp_115 - 0x04;
		Mem158[esp_157 + 0x00:word32] = edx_140;
		Mem160[esp_157 - 0x04 + 0x00:word32] = edx_140;
		Mem162[esp_157 - 0x08 + 0x00:word32] = edx_140;
		Mem164[esp_157 - 0x0C + 0x00:word32] = edx_140;
		word32 esp_163 = esp_157 - 0x0C;
		word32 eax_165 = RegQueryValueA(Mem164[esp_157 - 0x0C + 0x00:HKEY], Mem164[esp_157 - 0x08 + 0x00:LPCSTR], Mem164[esp_157 - 0x04 + 0x00:LPSTR], Mem164[esp_157 + 0x00:PLONG]);
		if (eax_165 != 0x06)
		{
			word32 edi_200 = edi_129 - dwLoc3D;
			word32 ebp_205;
			byte SCZO_206;
			word32 ebx_207;
			word32 esi_208;
			word32 edi_209;
			word32 eax_210;
			byte SZO_211;
			byte C_212;
			byte Z_213;
			word32 ecx_214;
			byte CZ_215;
			byte dl_216;
			word32 edx_217;
			edi_200();
		}
		word32 ecx_184 = Mem164[eax_110 + 0x28:word32] + Mem164[0x00405348:word32];
		*ecxOut = ecx_184;
		Mem185[0x0040534C:word32] = ecx_184;
		word32 edi_188;
		*ediOut = Mem185[esp_163 + 0x00:word32];
		word32 ebx_195;
		*ebxOut = Mem185[esp_163 + 0x08:word32];
		return 0x00;
	}
	else
	{
		word32 edi_78;
		*ediOut = Mem0[esp_28 + 0x00:word32];
		word32 ebx_82;
		*ebxOut = Mem0[esp_28 + 0x08:word32];
		return 0x01;
	}
}

// 00401AC0: Register word32 fn00401AC0(Register word32 ebx, Register word32 esi)
word32 fn00401AC0(word32 ebx, word32 esi)
{
	word32 ecx_18 = Mem0[esi + 0x0C:word32];
	word32 eax_22 = Mem0[esi + 0x08:word32];
	word32 edi_14 = 0x01;
	do
	{
		word32 ecx_26 = ecx_18 - 0x01;
		if (ecx_18 == 0x00)
		{
			word32 ecx_81 = Mem0[esi + 0x00:word32];
			eax_22 = (word32) Mem0[ecx_81 + 0x00:byte];
			Mem85[esi + 0x00:word32] = ecx_81 + 0x01;
			ecx_26 = ecx_18 + 0x07;
		}
		edi_14 = (eax_22 >>u 0x07 & 0x01) + edi_14 * 0x02;
		word32 eax_43 = eax_22 * 0x02;
		ecx_18 = ecx_26 - 0x01;
		if (ecx_26 == 0x00)
		{
			word32 ecx_75 = Mem0[esi + 0x00:word32];
			eax_43 = (word32) Mem0[ecx_75 + 0x00:byte];
			Mem79[esi + 0x00:word32] = ecx_75 + 0x01;
			ecx_18 = ecx_26 + 0x07;
		}
		eax_22 = eax_43 * 0x02;
	} while ((eax_43 >>u 0x07 & 0x01) != 0x00);
	Mem63[esi + 0x0C:word32] = ecx_18;
	Mem64[esi + 0x08:word32] = eax_22;
	return edi_14;
}

// 00401C20: Register word32 fn00401C20(Register word32 ebx, Register word32 esi, Register word32 edi, Stack word32 dwArg04, Register out ptr32 ecxOut, Register out ptr32 edxOut, Register out ptr32 esiOut, Register out ptr32 ediOut)
word32 fn00401C20(word32 ebx, word32 esi, word32 edi, word32 dwArg04, ptr32 & ecxOut, ptr32 & edxOut, ptr32 & esiOut, ptr32 & ediOut)
{
}

