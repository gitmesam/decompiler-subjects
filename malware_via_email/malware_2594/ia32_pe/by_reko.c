// subject.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

// 004244C2: Register Eq_2 Win32CrtStartup()
Eq_2 Win32CrtStartup()
{
	GetCurrentThreadId();
	GetCommandLineW();
	GetOEMCP();
	GetCommandLineA();
	GetModuleHandleA(0x00431076);
	Eq_20 eax_49 = CreateFileA(0x00431080, 0x00, 0x01, null, 0x03, 0x0101, 0x00);
	Eq_38 eax_51 = GetProcAddress(0x00431080, 0x00);
	do
	{
		eax_51();
		CreateFileA(0x00431000, 0xC0000000, 0x04, null, 0x03, 0x0107, 0x00);
		fn0042474E(dwArg00, dwArg04, dwArg08);
		LoadResource(0x00, eax_49);
		GetCommandLineW();
		ptr32 esp_104 = fp - 0x98;
		do
		{
			PDWORD * esp_111 = esp_104 - 0x04;
			*esp_111 = (PDWORD *) (fp - 0x1C);
			*(esp_111 - 0x04) = 0x40;
			*(esp_111 - 0x08) = 29499;
			GetOEMCP();
			*(esp_111 - 0x0C) = 0x00429000;
			GetCommandLineA();
			VirtualProtect(*(esp_111 - 0x0C), *(esp_111 - 0x08), *(esp_111 - 0x04), *esp_111);
			*(esp_111 - 0x10) = 0x00;
			*(esp_111 - 0x14) = 0x26;
			*(esp_111 - 0x18) = 0x03;
			*(esp_111 - 0x1C) = 0x00;
			*(esp_111 - 0x20) = 0x06;
			*(esp_111 - 0x24) = 0x00;
			*(esp_111 - 0x28) = 0x00431045;
			CreateFileA(*(esp_111 - 0x28), *(esp_111 - 0x24), *(esp_111 - 0x20), *(esp_111 - 0x1C), *(esp_111 - 0x18), *(esp_111 - 0x14), *(esp_111 - 0x10));
			*(esp_111 - 0x28) = 0x00;
			*(esp_111 - 44) = 0xA4;
			*(esp_111 - 0x30) = 0x03;
			*(esp_111 - 0x34) = 0x00;
			*(esp_111 - 0x38) = 0x00;
			*(esp_111 - 0x3C) = 0xE0000000;
			*(esp_111 - 0x40) = 4395045;
			CreateFileA(*(esp_111 - 0x40), *(esp_111 - 0x3C), *(esp_111 - 0x38), *(esp_111 - 0x34), *(esp_111 - 0x30), *(esp_111 - 44), *(esp_111 - 0x28));
			GetCommandLineA();
			*(esp_111 - 0x40) = (union Eq_20 *) eax_49;
			*(esp_111 - 0x44) = 0x00;
			SizeofResource(*(esp_111 - 0x44), *(esp_111 - 0x40));
			*(esp_111 - 0x44) = 0x00;
			*(esp_111 - 0x48) = 0x26;
			*(esp_111 - 0x4C) = 0x03;
			*(esp_111 - 0x50) = 0x00;
			*(esp_111 - 0x54) = 0x02;
			*(esp_111 - 88) = 0x60000000;
			*(esp_111 - 0x5C) = 0x00431060;
			esp_104 = esp_111 - 0x5C;
		} while (CreateFileA(*(esp_111 - 0x5C), *(esp_111 - 88), *(esp_111 - 0x54), *(esp_111 - 0x50), *(esp_111 - 0x4C), *(esp_111 - 0x48), *(esp_111 - 0x44)) != ~0x00);
		*(esp_111 - 0x60) = 0x00;
		*(esp_111 - 100) = 0x87;
		*(esp_111 - 0x68) = 0x03;
		*(esp_111 - 0x6C) = 0x00;
		*(esp_111 - 0x70) = 0x07;
		*(esp_111 - 116) = 0xA0000000;
		*(esp_111 - 0x78) = 0x0043103D;
	} while (CreateFileA(*(esp_111 - 0x78), *(esp_111 - 116), *(esp_111 - 0x70), *(esp_111 - 0x6C), *(esp_111 - 0x68), *(esp_111 - 100), *(esp_111 - 0x60)) != ~0x00);
	Eq_99 eax_211 = CloseHandle(*(ebp - 0x04));
	ebp->r41C5A1EB = rArg0_74;
	word32 esp_215;
	word32 ebp_216;
	byte SCZO_217;
	word32 ebx_218;
	word32 edi_219;
	word32 esi_220;
	word32 eax_221;
	byte Z_222;
	word32 ecx_223;
	byte SZO_224;
	real64 rArg0_225;
	fnEBE06D54();
	return eax_221;
}

// 0042474E: void fn0042474E(Stack (ptr word32) dwArg04, Stack uint32 dwArg08, Stack word32 dwArg0C)
void fn0042474E(word32 * dwArg04, uint32 dwArg08, word32 dwArg0C)
{
	word32 * edi_16 = dwArg04;
	uint32 edx_19 = dwArg08 >> 0x02;
	do
	{
		*edi_16 = *edi_16 - dwArg0C;
		*edi_16 = *edi_16 + dwArg0C;
		*edi_16 = *edi_16 - dwArg0C;
		*edi_16 = *edi_16 ^ 3070175363;
		*edi_16 = *edi_16 + 3161557686;
		*edi_16 = *edi_16 + 0xF02C43D1;
		*edi_16 = *edi_16 + 4232936312;
		*edi_16 = *edi_16 ^ dwArg0C;
		*edi_16 = *edi_16 + dwArg0C;
		edi_16 = edi_16 + 0x01;
		edx_19 = edx_19 - 0x01;
	} while (edx_19 != 0x00);
}

