// subject.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

// 00401100: void fn00401100(Register word32 esi, Register word32 edi)
void fn00401100(word32 esi, word32 edi)
{
	SetUnhandledExceptionFilter(0x00401000);
	fn00402AE0();
	word32 esp_25;
	word32 ebp_26;
	word32 ebx_27;
	byte SCZO_28;
	word32 eax_29;
	word32 edx_30;
	word32 ecx_31;
	byte SZO_32;
	byte C_33;
	byte Z_34;
	word32 esi_35;
	word32 edi_36;
	_getmainargs();
	word32 eax_37 = Mem0[0x00406120:word32];
	if (eax_37 != 0x00)
	{
		word32 esp_103;
		Mem89[0x004042D0:word32] = eax_37;
		word32 edx_111 = iob;
		esp_103 = esp_25;
		if (iob != 0x00)
		{
			Mem153[esp_25 + 0x04:word32] = eax_37;
			word32 eax_155 = Mem153[iob + 0x10:word32];
			Mem156[esp_25 + 0x00:word32] = eax_155;
			word32 ebp_158;
			word32 ebx_159;
			byte SCZO_160;
			word32 eax_161;
			word32 edx_162;
			word32 ecx_163;
			byte SZO_164;
			byte C_165;
			byte Z_166;
			word32 esi_167;
			word32 edi_168;
			setmode();
			edx_111 = iob;
		}
		if (edx_111 != ~0x1F)
		{
			word32 eax_135 = Mem89[0x00406120:word32];
			Mem136[esp_103 + 0x04:word32] = eax_135;
			word32 ecx_138 = Mem136[iob + 0x30:word32];
			Mem139[esp_103 + 0x00:word32] = ecx_138;
			word32 ebp_141;
			word32 ebx_142;
			byte SCZO_143;
			word32 eax_144;
			word32 edx_145;
			word32 ecx_146;
			byte SZO_147;
			byte C_148;
			byte Z_149;
			word32 esi_150;
			word32 edi_151;
			setmode();
			edx_111 = iob;
		}
		if (edx_111 != ~0x3F)
		{
			word32 ebx_118 = Mem89[0x00406120:word32];
			Mem119[esp_103 + 0x04:word32] = ebx_118;
			word32 edx_121 = Mem119[iob + 0x50:word32];
			Mem122[esp_103 + 0x00:word32] = edx_121;
			word32 esp_123;
			word32 ebp_124;
			word32 ebx_125;
			byte SCZO_126;
			word32 eax_127;
			word32 edx_128;
			word32 ecx_129;
			byte SZO_130;
			byte C_131;
			byte Z_132;
			word32 esi_133;
			word32 edi_134;
			setmode();
		}
	}
	word32 esp_41;
	word32 ebp_42;
	word32 ebx_43;
	byte SCZO_44;
	word32 eax_45;
	word32 edx_46;
	word32 ecx_47;
	byte SZO_48;
	byte C_49;
	byte Z_50;
	word32 esi_51;
	word32 edi_52;
	_p__fmode();
	word32 ebx_53 = Mem0[0x004042D0:word32];
	Mem54[eax_45 + 0x00:word32] = ebx_53;
	word32 eax_55 = fn00402AB0();
	__align(esp_41);
	word32 esp_56;
	word32 ebp_57;
	word32 ebx_58;
	byte SCZO_59;
	word32 eax_60;
	word32 edx_61;
	word32 ecx_62;
	byte SZO_63;
	byte C_64;
	byte Z_65;
	word32 esi_66;
	word32 edi_67;
	_p__environ();
	word32 ecx_68 = Mem54[eax_60 + 0x00:word32];
	Mem69[esp_56 + 0x08:word32] = ecx_68;
	word32 edx_70 = Mem69[0x00406000:word32];
	Mem71[esp_56 + 0x04:word32] = edx_70;
	Mem73[esp_56 + 0x00:word32] = Mem71[0x00406004:word32];
	word32 eax_74 = fn00402990(esi_66, edi_67);
	word32 esp_76;
	word32 ebp_77;
	word32 ebx_78;
	byte SCZO_79;
	word32 eax_80;
	word32 edx_81;
	word32 ecx_82;
	byte SZO_83;
	byte C_84;
	byte Z_85;
	word32 esi_86;
	word32 edi_87;
	cexit();
	Mem88[esp_76 + 0x00:word32] = ebx_78;
	ExitProcess(Mem88[esp_76 + 0x00:UINT]);
}

// 00401240: Register DWORD Win32CrtStartup()
DWORD Win32CrtStartup()
{
	word32 esp_9;
	word32 ebp_10;
	byte SCZO_11;
	word32 esi_12;
	word32 eax_13;
	word32 edi_14;
	_set_app_type();
	fn00401100(esi_12, edi_14);
	fn00401260();
	return eax_13;
}

// 00401260: void fn00401260()
void fn00401260()
{
	atexit(Mem11[esp_7 + 0x00:(ptr (fn void ()))]);
}

// 00401430: void fn00401430(Stack word32 dwArg04, Stack word32 dwArg08)
void fn00401430(word32 dwArg04, word32 dwArg08)
{
}

// 00401B90: Register word32 fn00401B90()
word32 fn00401B90()
{
}

// 00402162: Register word32 fn00402162()
word32 fn00402162()
{
	word32 ebp_2 = fn00402162();
	word32 ebp_7;
	fn00402167(ebp_2, dwArg00, dwArg04, dwArg08, dwArg0C, out ebp_7);
	return ebp_7;
}

// 00402167: Register word32 fn00402167(Register word32 ebp, Stack word32 dwArg00, Stack word32 dwArg04, Stack word32 dwArg08, Stack word32 dwArg0C, Register out ptr32 ebpOut)
word32 fn00402167(word32 ebp, word32 dwArg00, word32 dwArg04, word32 dwArg08, word32 dwArg0C, ptr32 & ebpOut)
{
	ptr32 fp;
	<type-error> Mem0;
	word32 ebp;
	<type-error> Mem0;
	ptr32 ebpOut;
	esp_1 = fp;
	edi_2 = 0x00;
	eax_3 = GetActiveWindow();
	dwArg0C_4 = 0x00;
	edx_5 = 0x00;
	dwArg08_6 = 0x00;
	ebx_8 = Mem0[0x00406014:word32];
	dwArg00_9 = eax_3;
	dwArg04_10 = ebx_8;
	eax_11 = MessageBoxW(dwArg00_9, dwArg04_10, 0x00, 0x00);
	esp_12 = fp - 0x10;
	edx_13 = 0x00;
	SZO_14 = cond(0x00);
	C_15 = false;
	esp_17 = ebp - 0x0C;
	eax_18 = 0x00;
	ebx_20 = Mem0[esp_17 + 0x00:word32];
	esp_21 = esp_17 + 0x04;
	esi_22 = Mem0[esp_21 + 0x00:word32];
	esp_23 = esp_21 + 0x04;
	edi_24 = Mem0[esp_23 + 0x00:word32];
	esp_25 = esp_23 + 0x04;
	ebp_26 = Mem0[esp_25 + 0x00:word32];
	esp_27 = esp_25 + 0x04;
	return eax_18;
}

// 00402990: Register word32 fn00402990(Register word32 esi, Register word32 edi)
word32 fn00402990(word32 esi, word32 edi)
{
}

// 00402AB0: Register word32 fn00402AB0()
word32 fn00402AB0()
{
	word32 ecx_11 = 0x004050F4;
	while (ecx_11 <u 0x004050EC)
	{
		word32 edx_17 = Mem0[ecx_11 + 0x00:word32];
		eax = Mem0[ecx_11 + 0x00:word32];
		Mem21[edx_17 + 0x00400000:word32] = Mem0[edx_17 + 0x00400000:word32] + eax;
		ecx_11 = ecx_11 + 0x08;
	}
	return eax;
}

// 00402AE0: void fn00402AE0()
void fn00402AE0()
{
	__fninit();
}

// 00402B90: void fn00402B90(Register word32 esi)
void fn00402B90(word32 esi)
{
	word32 esp_57 = fp - 0x0C;
	if (Mem0[0x00406130:word32] == 0x00)
	{
		word32 eax_34 = Mem0[0x00403020:word32];
		Mem36[0x00406130:word32] = 0x01;
		if (eax_34 == ~0x00)
		{
			eax_34 = 0x00;
			byte Z_77 = cond(Mem36[0x00403024:word32]);
			while (Z_77)
			{
				eax_34 = eax_34 + 0x01;
				Z_77 = cond(0x00403024[eax_34 * 0x04]);
			}
		}
		if (eax_34 != 0x00)
		{
			do
			{
				word32 ebp_61;
				word32 ebx_62;
				byte SCZO_63;
				word32 eax_64;
				byte SZO_65;
				byte C_66;
				byte Z_67;
				word32 esi_68;
				word32 ecx_69;
				word32 edx_70;
				0x00403020[eax_34 * 0x04]();
			} while (ebx_62 != 0x01);
		}
		Mem58[esp_57 + 0x00:word32] = 0x00402AF0;
		fn00401260();
	}
}

// 00402EF0: void fn00402EF0(Register word32 eax, Stack word32 dwArg00)
void fn00402EF0(word32 eax, word32 dwArg00)
{
	word32 ecx_10 = fp + 0x04;
	while (eax >=u 0x1000)
	{
		ecx_10 = ecx_10 - 0x1000;
		Mem18[ecx_10 + 0x00:word32] = Mem0[ecx_10 + 0x00:word32];
		eax = eax - 0x1000;
	}
	word32 ecx_22 = ecx_10 - eax;
	Mem24[ecx_22 + 0x00:word32] = Mem0[ecx_22 + 0x00:word32];
	word32 esp_32;
	word32 ecx_33;
	byte SCZO_34;
	word32 eax_35;
	byte C_36;
	byte SZO_37;
	bcuisposr0 None_38;
	dwArg00();
}

