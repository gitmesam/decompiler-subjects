// subject.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

// 00401005: Register DWORD Win32CrtStartup()
DWORD Win32CrtStartup()
{
	word32 eax_26 = 0x00 - ecx + edi - ecx + edi - ecx + edi - ecx + edi;
	Mem57[fp - 44 + 0x00:word32] = fn0040105F(eax_26, eax_26, 81267607, 0x00, eax);
	word32 eax_58 = Mem57[fp - 44 + 0x00:word32];
	return fn0040105F(eax_58, dwArg00, dwArg14, dwArg18, dwArg24);
}

// 0040105F: Register word32 fn0040105F(Register word32 eax, Stack word32 dwArg00, Stack word32 dwArg14, Stack word32 dwArg18, Stack word32 dwArg24)
word32 fn0040105F(word32 eax, word32 dwArg00, word32 dwArg14, word32 dwArg18, word32 dwArg24)
{
	word32 eax_14 = dwArg00;
	word16 ax_15 = (word16) dwArg00;
	do
	{
		word32 eax_25 = DPB(eax_14, ax_15 & 0x00, 0);
		word32 ecx_33 = DPB(ecx, Mem0[eax_25 + 0x00:word16], 0);
		ecx = ecx_33 + 42418;
		word16 cx_43 = (word16) (ecx_33 + 42418);
		if (cx_43 == 0x01)
			break;
		eax_14 = eax_25 - 0x00010000;
		ax_15 = (word16) (eax_25 - 0x00010000);
	} while (eax_25 != 0x00010000);
	word32 ebx_225;
	word32 ecx_226 = fn0040164A(dwArg24, fp - 0x28, out ebx_225);
	word32 esp_272;
	word32 eax_273;
	byte SZO_274;
	word32 ecx_275;
	word32 ebp_276;
	word32 edx_277;
	word16 ax_278;
	bool C_279;
	word16 cx_280;
	byte SCZO_281;
	bool Z_282;
	word32 esi_283;
	word32 ebx_284;
	word32 edi_285;
	selector fs_286;
	Mem0[ebx_225 + 0x20:word32]();
	Mem288[esp_272 - 0x04 + 0x00:word32] = eax_273;
	word32 eax_291 = Mem288[esi_283 - 0x02 + 0x00:word32];
	Mem296[esp_272 + 0x38:word32] = eax_291 >>u 0x08;
	Mem298[esp_272 - 0x04 + 0x00:word32] = eax_291 >>u 0x08;
	word32 eax_299 = Mem298[esp_272 - 0x04 + 0x00:word32];
	Mem305[esp_272 - 0x04 + 0x00:word32] = ebx_284;
	Mem307[esp_272 - 0x04 + 0x00:word32] = Mem305[esp_272 - 0x04 + 0x00:word32] - 0x04;
	Mem310[esp_272 - 0x08 + 0x00:word32] = eax_299 + 0x01;
	Mem315[esp_272 - 0x08 + 0x00:word32] = Mem310[esp_272 - 0x08 + 0x00:word32];
	Mem320[esp_272 - 0x08 + 0x00:word32] = Mem315[esp_272 - 0x08 + 0x00:word32];
	word32 eax_321 = Mem320[esp_272 - 0x08 + 0x00:word32];
	Mem323[esp_272 + 0x3C:word32] = ebx_284;
	Mem325[esp_272 - 0x08 + 0x00:word32] = eax_321;
	word32 eax_326 = Mem325[esp_272 - 0x08 + 0x00:word32];
	word32 edi_329 = Mem325[esp_272 - 0x04 + 0x00:word32];
	Mem332[esp_272 - 0x04 + 0x00:word32] = eax_326;
	Mem334[esp_272 - 0x08 + 0x00:word32] = ecx_275;
	Mem336[esp_272 - 0x0C + 0x00:word32] = eax_326;
	word32 eax_337 = Mem336[esp_272 - 0x0C + 0x00:word32];
	Mem341[esp_272 - 0x0C + 0x00:word32] = esp_272 - 0x08;
	Mem343[esp_272 - 0x10 + 0x00:word32] = eax_337;
	word32 eax_344 = Mem343[esp_272 - 0x10 + 0x00:word32];
	Mem347[esp_272 - 0x10 + 0x00:word32] = 0x40;
	Mem349[esp_272 - 0x14 + 0x00:word32] = eax_344;
	word32 eax_350 = Mem349[esp_272 - 0x14 + 0x00:word32];
	Mem354[esp_272 - 0x14 + 0x00:word32] = Mem349[esp_272 + 0x20:word32];
	Mem356[esp_272 - 0x18 + 0x00:word32] = eax_350;
	word32 eax_357 = Mem356[esp_272 - 0x18 + 0x00:word32];
	Mem361[esp_272 - 0x18 + 0x00:word32] = Mem356[esp_272 + 0x14:word32];
	Mem363[esp_272 - 0x1C + 0x00:word32] = eax_357;
	Mem368[esp_272 - 0x1C + 0x00:word32] = Mem363[esp_272 - 0x1C + 0x00:word32];
	word32 esp_375;
	word32 eax_376;
	byte SZO_377;
	word32 ecx_378;
	word32 ebp_379;
	word32 edx_380;
	word16 ax_381;
	bool C_382;
	word16 cx_383;
	byte SCZO_384;
	bool Z_385;
	word32 esi_386;
	word32 ebx_387;
	word32 edi_388;
	selector fs_389;
	Mem368[edi_329 + 0x0C:word32]();
	Mem391[esp_375 - 0x04 + 0x00:word32] = eax_376;
	Mem397[esp_375 + 0x00:word32] = Mem391[esp_375 - 0x04 + 0x00:word32];
	Mem403[esp_375 + 0x04:word32] = Mem397[esp_375 + 0x00:word32];
	Mem409[esp_375 + 0x08:word32] = Mem403[esp_375 + 0x04:word32];
	Mem415[esp_375 + 0x0C:word32] = Mem409[esp_375 + 0x08:word32];
	Mem421[esp_375 + 0x10:word32] = Mem415[esp_375 + 0x0C:word32];
	Mem426[esp_375 + 0x10:word32] = Mem421[esp_375 + 0x10:word32] + 0x2F;
	Mem431[esp_375 + 0x10:word32] = Mem426[fs_389:Mem426[esp_375 + 0x10:word32] + 0x00:word32];
	word32 eax_432 = Mem431[esp_375 + 0x10:word32];
	word32 ecx_437 = Mem431[eax_432 + 0x04:word32];
	Mem440[esp_375 + 0x3C:word32] = Mem431[esp_375 + 0x3C:word32] ^ ecx_437;
	Mem443[esp_375 + 0x10:word32] = eax_432 + 0x04;
	Mem448[esp_375 + 0x10:word32] = Mem443[esp_375 + 0x1C:word32];
	word32 ecx_451 = Mem448[esp_375 + 44:word32];
	Mem453[esp_375 + 0x10:word32] = Mem448[esp_375 + 0x10:word32];
	Mem459[esp_375 - 0xF8 + 0x00:word32] = Mem453[esp_375 + 0x10:word32];
	Mem464[esp_375 - 0xF8 + 0x00:word32] = Mem459[esp_375 - 0xF8 + 0x00:word32];
	word32 eax_465 = Mem464[esp_375 - 0xF8 + 0x00:word32];
	Mem471[esp_375 - 244 + 0x00:word32] = eax_465;
	Mem473[esp_375 - 0xF8 + 0x00:word32] = eax_465;
	word32 eax_474 = Mem473[esp_375 - 0xF8 + 0x00:word32];
	Mem476[esp_375 - 0xF0 + 0x00:word32] = ecx_451;
	Mem478[esp_375 - 0xF8 + 0x00:word32] = eax_474;
	Mem485[esp_375 - 0xF8 + 0x00:word32] = 0x00;
	word32 eax_486 = Mem485[esp_375 - 0xF8 + 0x00:word32];
	return fn0040133E(eax_486);
}

// 0040133E: Register word32 fn0040133E(Register word32 eax)
word32 fn0040133E(word32 eax)
{
	ptr32 fp;
	word32 eax;
	esp_1 = fp;
	ecx_3 = fp + 0x08 + eax;
	esp_4 = fp - 0x04;
	dwLoc04_5 = eax;
	eax_6 = ecx_3;
	eax_7 = Hgomiqdjr(ecx_3, dwLoc04_5);
	return eax_7;
}

// 00401346: Register word32 Hgomiqdjr(Register word32 ecx, Stack word32 dwArg00)
word32 Hgomiqdjr(word32 ecx, word32 dwArg00)
{
	Mem6[ecx + 0x00:byte] = (byte) dwArg00;
	return Nckurdj(dwArg00 + 0x01, dwArg08, dwArg011C, dwArg0138, dwArg013C);
}

// 00401363: Register word32 Nckurdj(Stack word32 dwArg00, Stack word32 dwArg08, Stack word32 dwArg011C, Stack word32 dwArg0138, Stack word32 dwArg013C)
word32 Nckurdj(word32 dwArg00, word32 dwArg08, word32 dwArg011C, word32 dwArg0138, word32 dwArg013C)
{
	if (Z)
		return fn0040133E(dwArg00);
	word32 ecx_102 = 0x00;
	word32 esi_105 = 0x00;
	word32 ebp_106 = 0x00;
	word32 eax_107 = dwArg00;
	do
	{
		word32 eax_111 = DPB(eax_107, Mem0[fp + 0x0C + ebp_106:byte], 8);
		byte dl_139 = (byte) ((word32) Mem0[ecx_102 + dwArg08:byte] + ((word32) SLICE(eax_111, byte, 8) + esi_105));
		word32 edx_144 = (word32) dl_139;
		ecx_102 = ecx_102 + 0x01;
		if (ecx_102 >=u dwArg011C)
			ecx_102 = 0x00;
		byte al_173 = Mem0[fp + 0x0C + edx_144:byte];
		word32 eax_174 = DPB(eax_111, al_173, 0);
		word32 esi_182 = fp + 0x0C + ebp_106;
		Mem183[esi_182 + 0x00:byte] = 0x00;
		Mem190[esi_182 + 0x00:byte] = Mem183[esi_182 + 0x00:byte] + al_173;
		Mem223[fp - 0x0C + (edx_144 + 0x18):byte] = SLICE(eax_174, byte, 8);
		ebp_106 = ebp_106 + 0x01;
		eax_107 = eax_174;
		esi_105 = edx_144;
	} while (ebp_106 <u 0x0100);
	byte ch_252 = SLICE(dwArg0138, byte, 8);
	byte SCZO_266 = cond(ch_252 + ~0x05);
	word32 ecx_251 = dwArg0138;
	word32 eax_261 = dwArg013C;
	word32 esp_264 = fp - 0x0C;
	byte CZ_270 = SCZO_266;
	if (ch_252 != ~0x05)
	{
		word32 esp_531;
		word32 eax_532;
		bool Z_533;
		word32 ecx_534;
		word32 ebp_535;
		word32 esi_536;
		word32 edi_537;
		byte SZO_538;
		bool C_539;
		word32 ebx_540;
		byte ah_541;
		word32 edx_542;
		byte SCZO_543;
		byte dl_544;
		byte al_545;
		byte bh_546;
		byte ch_547;
		byte CZ_548;
		byte cl_549;
		Mem223[dwArg013C - 0x04 + 0x00:word32]();
		Mem551[esp_531 - 0x04 + 0x00:word32] = eax_532;
		do
		{
			word32 esp_556;
			word32 eax_557;
			bool Z_558;
			word32 ecx_559;
			word32 ebp_560;
			word32 esi_561;
			word32 edi_562;
			byte SZO_563;
			bool C_564;
			word32 ebx_565;
			byte ah_566;
			word32 edx_567;
			byte SCZO_568;
			byte dl_569;
			byte al_570;
			byte bh_571;
			byte ch_572;
			byte CZ_573;
			byte cl_574;
			Mem551[ebx_540 + 0x08:word32]();
			Mem576[esp_556 - 0x04 + 0x00:word32] = eax_557;
			Mem581[esp_556 - 0x04 + 0x00:word32] = Mem576[esp_556 - 0x04 + 0x00:word32];
			word32 eax_582 = Mem581[esp_556 - 0x04 + 0x00:word32];
			Mem587[esp_556 + 0x00:word32] = Mem581[esp_556 + 0x00:word32] | eax_582;
		} while (ebp_560 != 0x01);
		Mem596[esp_556 - 0x04 + 0x00:word32] = eax_582;
		Mem600[esp_556 - 0x04 + 0x00:word32] = Mem596[esp_556 - 0x04 + 0x00:word32];
		word32 esp_603;
		word32 eax_604;
		bool Z_605;
		word32 ebp_607;
		word32 esi_608;
		word32 edi_609;
		byte SZO_610;
		bool C_611;
		word32 ebx_612;
		byte ah_613;
		word32 edx_614;
		byte SCZO_615;
		byte dl_616;
		byte al_617;
		byte bh_618;
		byte ch_619;
		byte cl_621;
		Mem600[ebx_565 + 0x14:word32]();
		Mem623[esp_603 - 0x04 + 0x00:word32] = eax_604;
		word32 eax_624 = Mem623[esp_603 - 0x04 + 0x00:word32];
		__syscall(0x90);
		Mem627[esp_603 - 0x04 + 0x00:word32] = eax_624;
		Mem632[esp_603 - 0x04 + 0x00:word32] = Mem627[esp_603 - 0x04 + 0x00:word32];
		eax_261 = Mem632[esp_603 - 0x04 + 0x00:word32];
		esp_264 = esp_603;
	}
	word32 esp_284 = esp_264 - 0x04;
	Mem285[esp_284 + 0x00:word32] = eax_261;
	Mem292[esp_284 + 0x00:word32] = 0x00;
	Mem298[esp_284 + 0x04:word32] = Mem292[esp_284 + 0x00:word32];
	word32 ebp_301 = Mem298[esp_284 + 0x0130:word32];
	Mem303[esp_284 + 0x04:word32] = Mem298[esp_284 + 0x04:word32];
	word32 esi_283 = 0x00;
	word32 eax_304 = Mem303[esp_284 + 0x04:word32];
	word32 esp_307 = esp_284 + 0x08;
	word32 edi_308 = Mem303[esp_284 + 0x14:word32];
	byte CZ_313 = DPB(CZ_270, false, 0);
	if (!CZ_313)
	{
		Mem365[esp_284 + 0x04:word32] = eax_304;
		word32 eax_366 = Mem365[esp_284 + 0x04:word32];
		do
		{
			word32 esp_379 = esp_264 + 0x04;
			Mem382[esp_379 - 0x04 + 0x00:word32] = eax_366 + 0x01;
			Mem388[esp_379 - 0x04 + 0x00:word32] = (word32) (byte) Mem382[esp_379 - 0x04 + 0x00:word32];
			word32 eax_389 = Mem388[esp_379 - 0x04 + 0x00:word32];
			byte cl_391 = Mem388[esp_379 + 0x14 + eax_389:byte];
			Mem394[esp_379 - 0x04 + 0x00:word32] = eax_389;
			Mem399[esp_379 - 0x04 + 0x00:word32] = Mem394[esp_379 - 0x04 + 0x00:word32];
			Mem405[esp_379 - 0x04 + 0x00:word32] = Mem399[esp_379 - 0x04 + 0x00:word32];
			Mem410[esp_379 - 0x04 + 0x00:word32] = Mem405[esp_379 - 0x04 + 0x00:word32];
			Mem415[esp_379 - 0x04 + 0x00:word32] = Mem410[esp_379 - 0x04 + 0x00:word32];
			word32 edx_408 = (word32) (byte) ((word32) cl_391 + esi_283);
			byte dl_418 = Mem415[esp_379 + 0x14 + edx_408:byte];
			Mem421[esp_379 - 0x04 + 0x00:word32] = Mem415[esp_379 - 0x04 + 0x00:word32];
			word32 ecx_392 = DPB(ecx_251, cl_391, 0);
			word32 eax_422 = Mem421[esp_379 - 0x04 + 0x00:word32];
			Mem428[esp_379 + 0x14 + eax_422:byte] = dl_418;
			Mem431[esp_379 + 0x10:word32] = eax_422;
			Mem436[esp_379 + 0x10:word32] = Mem431[esp_379 + 0x10:word32];
			word32 eax_437 = Mem436[esp_379 + 0x10:word32];
			Mem443[esp_379 + 0x10:word32] = edx_408;
			word32 eax_444 = Mem443[esp_379 + 0x10:word32];
			Mem446[esp_379 + 0x14 + eax_444:byte] = cl_391;
			Mem448[esp_379 + 0x10:word32] = eax_444;
			word32 eax_449 = Mem448[esp_379 + 0x10:word32];
			esi_283 = eax_449;
			word32 edx_459 = Mem448[esp_379 + 0x14 + eax_437:word32];
			Mem461[esp_379 - 0x04 + 0x00:word32] = eax_437;
			Mem467[esp_379 - 0x04 + 0x00:word32] = Mem461[esp_379 - 0x04 + 0x00:word32];
			Mem472[esp_379 - 0x04 + 0x00:word32] = Mem467[esp_379 - 0x04 + 0x00:word32];
			Mem477[esp_379 - 0x04 + 0x00:word32] = Mem472[esp_379 - 0x04 + 0x00:word32];
			Mem482[esp_379 - 0x04 + 0x00:word32] = Mem477[esp_379 - 0x04 + 0x00:word32];
			byte cl_485 = Mem482[esp_379 + ((word32) ((byte) (edx_459 + ecx_392)) + 0x14):byte];
			Mem487[esp_379 - 0x04 + 0x00:word32] = Mem482[esp_379 - 0x04 + 0x00:word32];
			byte ch_490 = Mem487[edi_308 + 0x00:byte];
			Mem492[esp_379 - 0x04 + 0x00:word32] = Mem487[esp_379 - 0x04 + 0x00:word32];
			Mem498[esp_379 - 0x04 + 0x00:word32] = Mem492[esp_379 - 0x04 + 0x00:word32];
			word32 eax_499 = Mem498[esp_379 - 0x04 + 0x00:word32];
			Mem501[edi_308 + 0x00:byte] = ch_490 ^ cl_485;
			Mem503[esp_379 - 0x04 + 0x00:word32] = eax_499;
			Mem508[esp_379 - 0x04 + 0x00:word32] = Mem503[esp_379 - 0x04 + 0x00:word32];
			Mem515[esp_379 - 0x04 + 0x00:word32] = Mem508[esp_379 - 0x04 + 0x00:word32];
			ecx_251 = 0x00;
			edi_308 = edi_308 + 0x01;
			ebp_301 = ebp_301 - 0x01;
			eax_366 = Mem515[esp_379 - 0x04 + 0x00:word32];
		} while (ebp_301 != 0x00);
		Mem521[esp_379 - 0x04 + 0x00:word32] = eax_366;
		eax_304 = Mem521[esp_379 - 0x04 + 0x00:word32];
		esp_307 = esp_379;
	}
	word32 esp_327 = esp_307 + 0x04;
	Mem329[esp_327 - 0x04 + 0x00:word32] = eax_304;
	Mem335[esp_327 + 0x00:word32] = Mem329[esp_327 - 0x04 + 0x00:word32];
	Mem341[esp_327 + 0x04:word32] = Mem335[esp_327 + 0x00:word32];
	word32 eax_346 = Mem341[esp_327 + 0x0114:word32];
	Mem353[esp_327 + 0x013C:word32] = eax_346;
	word32 eax_354 = Mem353[esp_327 + 0x013C:word32];
	Mem357[esp_327 + 0x013C:word32] = eax_354;
	Mem359[esp_327 + 0x0138:word32] = eax_354;
	return Mem359[esp_327 + 0x0138:word32];
}

// 0040164A: Register word32 fn0040164A(Stack word32 dwArg00, Stack word32 dwArg04, Register out ptr32 ebxOut)
word32 fn0040164A(word32 dwArg00, word32 dwArg04, ptr32 & ebxOut)
{
	word32 eax_117 = dwArg00;
	do
	{
		word16 ax_31 = Mem0[DPB(eax_117, 0x00, 0) + 0x00:word16];
		word32 eax_39 = DPB(eax_117, ax_31 + 42421, 0);
		word32 eax_121 = eax_39;
		if (ax_31 == 42419)
			goto l004016AA;
		eax_117 = eax_39 - 0x00010000;
	} while (eax_39 != 0x00010000);
	eax_121 = eax_39 - 0x00010000;
l004016AA:
	word32 eax_56 = DPB(eax_121, 0x00, 0);
	word32 ecx_64 = Mem0[eax_56 + 0x3C:word32];
	word32 ecx_65 = eax_56 + ecx_64;
	word32 ecx_76 = Mem0[eax_56 + Mem0[ecx_65 + 0x80:word32]:word32];
	word32 ebx_91;
	*ebxOut = eax_56 + ecx_76 + 0x04;
	return ecx_76;
}

