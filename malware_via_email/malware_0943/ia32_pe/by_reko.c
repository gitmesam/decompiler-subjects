// subject.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

// 00406420: Register DWORD Win32CrtStartup()
DWORD Win32CrtStartup()
{
}

// 00407493: Register word32 fn00407493(Register word32 eax, Register byte cl, Register word32 edx, Register byte bh, Register byte bl, Register word32 esi, Register word16 di, Register out ptr32 edxOut, Register out ptr32 ebxOut, Register out ptr32 esiOut, Register out ptr32 ediOut)
word32 fn00407493(word32 eax, byte cl, word32 edx, byte bh, byte bl, word32 esi, word16 di, ptr32 & edxOut, ptr32 & ebxOut, ptr32 & esiOut, ptr32 & ediOut)
{
	byte cl_11 = __ror(cl, 0x12);
	word32 ebx_18 = DPB(ebx, bl + 0x53 + ((cl & 0x00) != 0x00), 0);
	word32 ecx_22 = DPB(ecx, cl_11, 0) << cl_11;
	byte bl_21 = (byte) (ebx_18 ^ 2825087515);
	byte bh_25 = SLICE(ebx_18 ^ 2825087515, byte, 8) >>u (byte) ecx_22;
	word32 ecx_31 = DPB(ecx_22, (SLICE(ecx_22, byte, 8) >> 0x02) - (byte) (edx ^ 3860675572), 8);
	word32 edx_38;
	word32 ebx_39;
	word32 esi_40;
	word32 edi_41;
	return fn0040759F(eax, ecx_31, edx ^ 3860675572, bl_21, bh_25, esi, di, out edx_38, out ebx_39, out esi_40, out edi_41);
}

// 0040759F: Register word32 fn0040759F(Register word32 eax, Register word32 ecx, Register word32 edx, Register byte bl, Register byte bh, Register word32 esi, Register word16 di, Register out ptr32 edxOut, Register out ptr32 ebxOut, Register out ptr32 esiOut, Register out ptr32 ediOut)
word32 fn0040759F(word32 eax, word32 ecx, word32 edx, byte bl, byte bh, word32 esi, word16 di, ptr32 & edxOut, ptr32 & ebxOut, ptr32 & esiOut, ptr32 & ediOut)
{
	esp = v3;
	esi = esi << cl;
	SCZO = cond(esi);
	C = SCZO;
	edi = edi + 0x01;
	di = (word16) edi;
	di = di - 0x01;
	edi = DPB(edi, di, 0);
	esi = esi - eax - C;
	edi = edi | 0x90E1C612;
	C = false;
	v12 = (esi & 0x01 << 0x20 - cl) != 0x00;
	esi = __rcl(esi, cl, C);
	esi = esi >>u 0x1B;
	ecx = ecx - 0x08F8B6F9;
	cl = (byte) ecx;
	cx = (word16) ecx;
	SCZO = cond(ecx);
	C = SCZO;
	v14 = (esi & 0x01 << 0x20 - cl) != 0x00;
	esi = __rcl(esi, cl, C);
	edi = edx;
	di = (word16) edi;
	esi = esi >> cl;
	esi = esi << 0x0E;
	si = (word16) esi;
	SCZO = cond(esi);
	eax = fn004075F3(eax, cl, edx, bl, bh, si, edi, out edx, out ebx, out esi, out edi);
	ax = (word16) eax;
	ah = SLICE(eax, byte, 8);
	al = (byte) eax;
	return eax;
}

// 004075DF: Register word32 fn004075DF(Register word32 eax, Register byte cl, Register word32 edx, Register byte bl, Register byte bh, Register word16 si, Register word32 edi, Register out ptr32 edxOut, Register out ptr32 ebxOut, Register out ptr32 esiOut, Register out ptr32 ediOut)
word32 fn004075DF(word32 eax, byte cl, word32 edx, byte bl, byte bh, word16 si, word32 edi, ptr32 & edxOut, ptr32 & ebxOut, ptr32 & esiOut, ptr32 & ediOut)
{
	ptr32 fp;
	word32 edi;
	byte C;
	word32 edx;
	ptr32 edxOut;
	ptr32 ebxOut;
	ptr32 esiOut;
	ptr32 ediOut;
	word32 eax;
	byte cl;
	byte bl;
	byte bh;
	word16 si;
	word16 dx;
	word32 ebx;
	word32 esi;
	esp_1 = fp;
	v3_3 = (edi & 0x08000000) != 0x00;
	edi_5 = __rcl(edi, 0x05, C);
	SCZO_7 = cond(edx - 3730427374);
	Z_8 = SCZO_7;
	if (edx != 3730427374)
	{
		fn00407873(dx, si);
		return eax;
	}
	else
	{
		eax_27 = fn004075EE(eax, cl, edx, bl, bh, si, edi_5, out edx_23, out ebx_24, out esi_25, out edi_26);
		return eax_27;
	}
}

// 004075EE: Register word32 fn004075EE(Register word32 eax, Register byte cl, Register word32 edx, Register byte bl, Register byte bh, Register word16 si, Register word32 edi, Register out ptr32 edxOut, Register out ptr32 ebxOut, Register out ptr32 esiOut, Register out ptr32 ediOut)
word32 fn004075EE(word32 eax, byte cl, word32 edx, byte bl, byte bh, word16 si, word32 edi, ptr32 & edxOut, ptr32 & ebxOut, ptr32 & esiOut, ptr32 & ediOut)
{
	word32 edx_12;
	word32 ebx_13;
	word32 esi_14;
	word32 edi_15;
	return fn004075F3(eax ^ 3060632310, cl, edx, bl, bh, si, edi, out edx_12, out ebx_13, out esi_14, out edi_15);
}

// 004075F3: Register word32 fn004075F3(Register word32 eax, Register byte cl, Register word32 edx, Register byte bl, Register byte bh, Register word16 si, Register word32 edi, Register out ptr32 edxOut, Register out ptr32 ebxOut, Register out ptr32 esiOut, Register out ptr32 ediOut)
word32 fn004075F3(word32 eax, byte cl, word32 edx, byte bl, byte bh, word16 si, word32 edi, ptr32 & edxOut, ptr32 & ebxOut, ptr32 & esiOut, ptr32 & ediOut)
{
}

// 00407625: Register word32 fn00407625(Register word32 eax, Register byte cl, Register byte ch, Register byte dl, Register byte bl, Register word32 esi, Register word16 di, Register out ptr32 edxOut, Register out ptr32 ebxOut, Register out ptr32 esiOut, Register out ptr32 ediOut)
word32 fn00407625(word32 eax, byte cl, byte ch, byte dl, byte bl, word32 esi, word16 di, ptr32 & edxOut, ptr32 & ebxOut, ptr32 & esiOut, ptr32 & ediOut)
{
	byte cl_18 = (byte) (DPB(ecx, (ch << 0x17) - 0x6A, 8) & 1126015095);
	word32 edx_29;
	word32 ebx_30;
	word32 esi_31;
	word32 edi_32;
	return fn00407493(eax, cl_18, 3860672806, ~0x13, bl ^ 0x31, esi, di, out edx_29, out ebx_30, out esi_31, out edi_32);
}

// 00407684: Register word32 fn00407684(Register word32 eax, Register byte cl, Register byte dl, Register byte dh, Register byte bl, Register byte bh, Register word32 esi, Register word32 edi, Register out ptr32 edxOut, Register out ptr32 ebxOut, Register out ptr32 esiOut, Register out ptr32 ediOut)
word32 fn00407684(word32 eax, byte cl, byte dl, byte dh, byte bl, byte bh, word32 esi, word32 edi, ptr32 & edxOut, ptr32 & ebxOut, ptr32 & esiOut, ptr32 & ediOut)
{
	byte cl_6 = cl - ah;
	word32 edi_10 = __ror(edi | 2959339324, 0x01);
	byte bl_18 = bl | bh;
	word16 cx_22 = __rol(DPB(cx, cl_6, 0), cl_6);
	byte dh_15 = dh >> cl_6;
	word32 edi_29 = edi_10 - DPB(ebx, bl_18, 0);
	word32 ecx_34 = DPB(ecx, (byte) cx_22 + SLICE(cx_22, byte, 8), 0);
	word32 edx_37;
	word32 ebx_38;
	word32 esi_39;
	word32 edi_40;
	return fn00407714(eax, ecx_34, dh_15, bl_18, bh, esi, edi_29, out edx_37, out ebx_38, out esi_39, out edi_40);
}

// 004076AC: Register word32 fn004076AC(Register word16 ax, Register word16 cx, Register word32 edx, Register word16 bx, Register word32 ebp, Register word32 edi, Register selector ds, Stack selector psegArg00)
word32 fn004076AC(word16 ax, word16 cx, word32 edx, word16 bx, word32 ebp, word32 edi, selector ds, selector psegArg00)
{
	word16 bx_7 = bx & cx;
	word32 edi_17 = edi >>u 0x13 ^ eax;
	word16 di_21 = (word16) edi_17 + bx_7;
	byte cl_34 = cl - 0x01 ^ ch;
	word32 ebx_9 = DPB(ebx, bx_7, 0);
	byte bh_10 = SLICE(bx_7, byte, 8);
	word32 edi_22 = DPB(edi_17, di_21, 0);
	word32 eax_30 = DPB(eax, ah + 0x5A + (cl - 0x01) + (al << 0x19 <u 0x00), 8);
	word32 ecx_37 = DPB(ecx, cl_34, 0);
	if ((edx & 1654565968) != ~0x45C1761B)
	{
		word32 edx_122;
		word32 ebx_123;
		word32 esi_124;
		word32 edi_125;
		fn0040789E(DPB(ebx_9, bh_10 << cl_34, 8), ebp, edi >>u 0x13, edi_22, ds, dwLoc10, out edx_122, out ebx_123, out esi_124, out edi_125);
		if (esi_124 != 1130614140)
		{
			word32 edx_155;
			word32 ebx_156;
			word32 esi_157;
			word32 edi_158;
			return fn0040789E(ebx_123, ebp, esi_124, edi_125, ds, dwArg00, out edx_155, out ebx_156, out esi_157, out edi_158);
		}
		else
		{
			Mem138[fp - 0x10 + 0x00:word32] = ebp;
			fn00407875();
			return edx_122;
		}
	}
	else
	{
		word32 edx_69 = (edx & 1654565968) + 0x01;
		byte dh_70 = SLICE(edx_69, byte, 8);
		byte dl_72 = (byte) edx_69;
		byte cl_78 = (byte) (ecx_37 + 0x01);
		byte ch_79 = SLICE(ecx_37 + 0x01, byte, 8);
		word32 eax_83 = __rol(eax_30, 0x01);
		word32 edx_89;
		word32 ebx_90;
		word32 esi_91;
		word32 edi_92;
		return fn004076DB(eax_83, cl_78, ch_79, dl_72, dh_70, ebx_9, edi >>u 0x13, di_21, ds, out edx_89, out ebx_90, out esi_91, out edi_92);
	}
}

// 004076DB: Register word32 fn004076DB(Register word32 eax, Register byte cl, Register byte ch, Register byte dl, Register byte dh, Register word32 ebx, Register word32 esi, Register word16 di, Register selector ds, Register out ptr32 edxOut, Register out ptr32 ebxOut, Register out ptr32 esiOut, Register out ptr32 ediOut)
word32 fn004076DB(word32 eax, byte cl, byte ch, byte dl, byte dh, word32 ebx, word32 esi, word16 di, selector ds, ptr32 & edxOut, ptr32 & ebxOut, ptr32 & esiOut, ptr32 & ediOut)
{
	ptr32 fp;
	byte ch;
	word32 ecx;
	word16 di;
	word16 ax;
	word32 edi;
	word16 bx;
	word32 eax;
	word32 esi;
	word32 ebx;
	byte dh;
	byte bh;
	word16 dx;
	word32 edx;
	ptr32 ds_ecx;
	ptr32 edxOut;
	ptr32 ebxOut;
	ptr32 esiOut;
	ptr32 ediOut;
	selector ds;
	esp_1 = fp;
	v3_3 = (ch & 0x00) != 0x00;
	ch_4 = __rol(ch, 0x09);
	ecx_6 = DPB(ecx, ch_4, 8);
	di_9 = di - ax;
	edi_11 = DPB(edi, di_9, 0);
	SCZO_12 = cond(di_9);
	C_13 = SCZO_12;
	edi_14 = edi_11 - 1181159469 - (di_9 <u 0x00);
	di_15 = (word16) edi_14;
	di_17 = di_15 - bx;
	edi_18 = DPB(edi_14, di_17, 0);
	eax_20 = eax - ~0x0A69;
	ax_21 = (word16) eax_20;
	ah_22 = SLICE(eax_20, byte, 8);
	esi_24 = esi | ecx_6;
	ecx_26 = ecx_6 ^ ebx;
	ch_27 = SLICE(ecx_26, byte, 8);
	dh_30 = dh | bh;
	dx_32 = DPB(dx, dh_30, 8);
	dx_33 = ~dx_32;
	edx_35 = DPB(edx, dx_33, 0);
	ebx_36 = ebx >>u 0x12;
	bx_37 = (word16) ebx_36;
	bh_38 = SLICE(ebx_36, byte, 8);
	bl_39 = (byte) ebx_36;
	cl_40 = ah_22;
	ecx_41 = DPB(ecx_26, cl_40, 0);
	ds_ecx_43 = DPB(ds_ecx, cl_40, 0);
	edx_44 = edx_35 << 0x19;
	dh_45 = SLICE(edx_44, byte, 8);
	dx_46 = (word16) edx_44;
	dl_47 = (byte) edx_44;
	v22_48 = (edi_18 & 0x01 << 0x20 - cl_40) != 0x00;
	edi_49 = __rol(edi_18, cl_40);
	di_50 = (word16) edi_49;
	edi_di_51 = edi_49;
	SCZO_52 = cond(esi_24 - 799485382);
	Z_53 = SCZO_52;
	if (esi_24 != 799485382)
	{
		eax_77 = fn00407684(eax_20, cl_40, dl_47, dh_45, bl_39, bh_38, esi_24, edi_49, out edx_73, out ebx_74, out esi_75, out edi_76);
		ax_78 = (word16) eax_77;
		ah_79 = SLICE(eax_77, byte, 8);
		return eax_77;
	}
	else
	{
		eax_70 = fn0040770F(eax_20, ecx_41, bl_39, bh_38, esi_24, edi_49, ds, out edx_66, out ebx_67, out esi_68, out edi_69);
		ax_71 = (word16) eax_70;
		ah_72 = SLICE(eax_70, byte, 8);
		return eax_70;
	}
}

// 0040770F: Register word32 fn0040770F(Register word32 eax, Register word32 ecx, Register byte bl, Register byte bh, Register word32 esi, Register word32 edi, Register selector ds, Register out ptr32 edxOut, Register out ptr32 ebxOut, Register out ptr32 esiOut, Register out ptr32 ediOut)
word32 fn0040770F(word32 eax, word32 ecx, byte bl, byte bh, word32 esi, word32 edi, selector ds, ptr32 & edxOut, ptr32 & ebxOut, ptr32 & esiOut, ptr32 & ediOut)
{
	byte dh_6 = SLICE(ds, byte, 8);
	word32 edx_20;
	word32 ebx_21;
	word32 esi_22;
	word32 edi_23;
	return fn00407714(ecx, eax, dh_6, bl, bh, esi, edi, out edx_20, out ebx_21, out esi_22, out edi_23);
}

// 00407714: Register word32 fn00407714(Register word32 eax, Register word32 ecx, Register byte dh, Register byte bl, Register byte bh, Register word32 esi, Register word32 edi, Register out ptr32 edxOut, Register out ptr32 ebxOut, Register out ptr32 esiOut, Register out ptr32 ediOut)
word32 fn00407714(word32 eax, word32 ecx, byte dh, byte bl, byte bh, word32 esi, word32 edi, ptr32 & edxOut, ptr32 & ebxOut, ptr32 & esiOut, ptr32 & ediOut)
{
	word16 di_12 = (word16) __ror(edi, 0x06);
	word32 esi_15 = __ror(esi, 0x1D);
	word32 ecx_21 = __rcl(ecx + 0x01, 0x05, (esi & 0x20000000) != 0x00);
	word16 cx_26 = ~(word16) ecx_21;
	byte cl_28 = (byte) cx_26;
	byte ch_29 = SLICE(cx_26, byte, 8);
	byte dl_36 = (byte) (DPB(edx, __rcl(0x6D, 0x1B, (ecx + 0x01 & 0x08000000) != 0x00) ^ 0x7F, 0) | DPB(ecx_21, cx_26, 0));
	word32 edx_40;
	word32 ebx_41;
	word32 esi_42;
	word32 edi_43;
	return fn00407625(eax + ~0x0A69, cl_28, ch_29, dl_36, bl, esi_15, di_12, out edx_40, out ebx_41, out esi_42, out edi_43);
}

// 004077FA: Register word32 fn004077FA(Register word32 eax, Register byte ch, Register byte cl, Register word32 edx, Register byte bl, Register byte bh, Register word16 si, Register word32 edi, Register out ptr32 edxOut, Register out ptr32 ebxOut, Register out ptr32 esiOut, Register out ptr32 ediOut)
word32 fn004077FA(word32 eax, byte ch, byte cl, word32 edx, byte bl, byte bh, word16 si, word32 edi, ptr32 & edxOut, ptr32 & ebxOut, ptr32 & esiOut, ptr32 & ediOut)
{
	ptr32 fp;
	byte ch;
	byte bl;
	byte cl;
	word32 ecx;
	byte dh;
	word16 cx;
	word16 si;
	word16 di;
	word32 esi;
	word32 edi;
	word32 edx;
	word32 eax;
	byte bh;
	ptr32 edxOut;
	ptr32 ebxOut;
	ptr32 esiOut;
	ptr32 ediOut;
	esp_1 = fp;
	ch_4 = ch - bl;
	cl_6 = cl >>u 0x08;
	cl_7 = cl_6 ^ 0x38;
	C_8 = false;
	v9_9 = (ch_4 & 0x01 << 0x08 - cl_7) != 0x00;
	ch_10 = __rcl(ch_4, cl_7, C_8);
	ecx_12 = DPB(ecx, ch_10, 8);
	C_13 = v9_9;
	v10_14 = (ecx_12 & 0x00040000) != 0x00;
	ecx_15 = __rcr(ecx_12, 0x12, C_13);
	ch_16 = SLICE(ecx_15, byte, 8);
	cl_17 = (byte) ecx_15;
	ch_18 = ch_16 >> cl_17;
	v12_19 = (cl_17 & 0x01 << cl_17) != 0x00;
	cl_20 = __ror(cl_17, cl_17);
	C_21 = v12_19;
	cl_23 = cl_20 + dh + ((cl_17 & 0x01 << cl_17) != 0x00);
	cx_25 = DPB(cx, cl_23, 0);
	si_28 = si | di;
	esi_30 = DPB(esi, si_28, 0);
	esi_32 = esi_30 & edi;
	si_33 = (word16) esi_32;
	cx_34 = cx_25 - 0x01;
	cl_35 = (byte) cx_34;
	cl_36 = cl_35 << 0x0C;
	SCZO_37 = cond(cl_36);
	ecx_39 = edx;
	ch_40 = SLICE(ecx_39, byte, 8);
	cl_41 = (byte) ecx_39;
	cx_42 = (word16) ecx_39;
	eax_49 = fn0040759F(eax, ecx_39, edx, bl, bh, esi_32, di, out edx_45, out ebx_46, out esi_47, out edi_48);
	return eax_49;
}

// 00407873: void fn00407873(Register word16 dx, Register word16 si)
void fn00407873(word16 dx, word16 si)
{
	fn00407875();
}

// 00407875: void fn00407875()
void fn00407875()
{
	ptr32 fp;
	esp_1 = fp;
}

// 0040789E: Register word32 fn0040789E(Register word32 ebx, Register word32 ebp, Register word32 esi, Register word32 edi, Register selector ds, Stack word32 dwArg00, Register out ptr32 edxOut, Register out ptr32 ebxOut, Register out ptr32 esiOut, Register out ptr32 ediOut)
word32 fn0040789E(word32 ebx, word32 ebp, word32 esi, word32 edi, selector ds, word32 dwArg00, ptr32 & edxOut, ptr32 & ebxOut, ptr32 & esiOut, ptr32 & ediOut)
{
	word32 eax_16 = dwArg00;
	word32 edx_11 = ~~0x00905A4D;
	while (Mem0[eax_16 + 0x00:word32] != edx_11)
		eax_16 = eax_16 - 0x01 >>u 0x0F << 0x0F;
	word32 eax_25 = eax_16 + Mem0[eax_16 + 0x3C:word32];
	word32 eax_39 = eax_16 + Mem0[(Mem0[eax_25 + 0x80:word32] + eax_16) + 0x10:word32];
	word32 esp_40;
	word32 eax_41;
	word32 edx_42;
	byte SCZO_43;
	byte Z_44;
	word32 ecx_45;
	byte SZO_46;
	word16 dx_47;
	word16 ax_48;
	selector ss_49;
	byte O_50;
	word32 ebp_51;
	real64 rLoc1_52;
	word32 esi_53;
	byte dl_54;
	byte C_55;
	byte bh_56;
	word16 si_57;
	byte cl_58;
	byte ah_59;
	byte dh_60;
	byte bl_61;
	word16 cx_62;
	word16 bx_63;
	word32 edi_64;
	word32 ebx_65;
	selector ds_66;
	byte ch_67;
	word16 di_68;
	Mem0[eax_39 + 0x00:word32]();
	word32 ecx_69 = Mem0[esp_40 + 0x00:word32];
	byte cl_70 = (byte) ecx_69;
	word16 cx_71 = (word16) ecx_69;
	if (edx_42 != 3138688406)
	{
		word32 eax_142 = Mem0[esp_40 + 0x04:word32];
		word16 ax_143 = (word16) eax_142;
		byte dl_148 = (byte) ax_143;
		word32 esi_150 = esi_53 << 0x10 | 1646096091;
		byte ch_155 = SLICE(ecx_69 + 713998497, byte, 8);
		byte dh_158 = __ror(SLICE(ax_143, byte, 8) ^ SLICE(eax_142, byte, 8), 0x10);
		byte cl_161 = (byte) (ecx_69 + 713998497) + bl_61;
		word32 edx_165;
		word32 ebx_166;
		word32 esi_167;
		word32 edi_168;
		return fn004076DB(eax_142, cl_161, ch_155, dl_148, dh_158, ebx_65, esi_150, di_68, ds_66, out edx_165, out ebx_166, out esi_167, out edi_168);
	}
	else
	{
		__outw(dx_47, 0x9054);
		Mem110[esp_40 + 0x02:word16] = ss_49;
		if (OVERFLOW(edx_42 - 3138688406))
		{
			word32 edx_135;
			word32 ebx_136;
			word32 esi_137;
			word32 edi_138;
			return fn004075DF(0x00779054, cl_70, edx_42, bl_61, bh_56, si_57, edi_64, out edx_135, out ebx_136, out esi_137, out edi_138);
		}
		else
		{
			Mem112[esp_40 - 0x02 + 0x00:word32] = ebp_51;
			__fbld(Mem112[esi_53 - 0x2D + 0x00:80]);
			__rol(bh_56 - 0x92, 0x11);
			word32 ebx_125;
			*ebxOut = DPB(ebx_65, bl_61 << 0x18, 0);
			word32 esi_132;
			*esiOut = DPB(esi_53, __rcl(si_57 >>u cl_70, cl_70, false), 0);
			return DPB(0x00779054, DPB(0x9054, 0x90 - dh_60 - v45, 8) | cx_71, 0);
		}
	}
}

