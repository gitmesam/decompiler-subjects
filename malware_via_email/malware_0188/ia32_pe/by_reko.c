// subject.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

// 00401010: Register Eq_2 Win32CrtStartup()
DWORD Win32CrtStartup()
{
	fn004012F8(fn004013FE());
	fn00401109(fn004015EC(ebp), ebp);
	word32 eax_12 = fn004011F4(ebp, globals->ptr402178);
	word32 ebx_19;
	word32 ecx_20 = fn00401393(globals->ptr402174, out ebx_19);
	fn00401690();
	fn00401293(fn004010BA(ecx_20, ebx_19), eax_12);
	Sleep(100);
	ExitProcess(0x00);
}

// 00401060: void fn00401060()
void fn00401060()
{
	word32 ecx_22 = (word32) globals->a402080;
	byte * ebx_19 = globals->dw4021A0 + (word32) (globals->t4021A4 * 0xA0);
	*ebx_19 = (byte) ecx_22;
	byte * esi_24 = globals->a402081;
	byte * edi_28 = ebx_19 + 0x01;
	while (ecx_22 != 0x00)
	{
		*edi_28 = *esi_24;
		esi_24 = esi_24 + 0x01;
		edi_28 = edi_28 + 0x01;
		ecx_22 = ecx_22 - 0x01;
	}
	globals->t4021A4 = (word32) globals->t4021A4 + 0x01;
	fn00401097();
}

// 00401097: void fn00401097()
void fn00401097()
{
	if (globals->t4021A4 == 0x0200)
	{
		globals->t4021A4.u0 = 0x0100;
		globals->dw4021A8 = 0x09;
	}
}

// 004010BA: Register (ptr32 byte) fn004010BA(Register word32 ecx, Register word32 ebx)
byte * fn004010BA(word32 ecx, word32 ebx)
{
	if (0x00 == 0x00)
	{
		struct Eq_119 * ecx_56 = fs->ptr0018;
		struct Eq_151 * ecx_58 = ecx_56->ptr0030;
		struct Eq_32 * ebx_60 = globals->ptr402174;
		ecx_58->ptr0008 = ebx_60;
		return null;
	}
	else
	{
		ptr32 esp_25;
		struct Eq_124 * ebx_26;
		byte * eax_27;
		byte SZO_28;
		bool C_29;
		bool Z_30;
		struct Eq_129 * ecx_31;
		struct Eq_130 * fs_32;
		byte al_33;
		byte SCZO_34;
		byte cl_35;
		fn184D9C28();
		*eax_27 = *eax_27 + al_33;
		byte v14_39 = ebx_26->b1D8B3049 + cl_35;
		ebx_26->b1D8B3049 = v14_39;
		if (v14_39 == 0x00)
		{
			*(esp_25 - 0x04) = (struct Eq_129 **) ecx_31;
			globals->t4021A4 = *(esp_25 - 0x04);
			return eax_27;
		}
		else
		{
			ecx_31->bC35B0859 = ecx_31->bC35B0859 + cl_35;
			fn004010D5();
			return eax_27 + 0x01;
		}
	}
}

// 004010D5: void fn004010D5()
void fn004010D5()
{
	struct Eq_187 * ebx_15 = globals->dw4021A0 + 0x01;
	byte cl_13 = 0x00;
	Eq_69 ecx_12 = 0x0100;
	do
	{
		ebx_15->b0000 = 0x01;
		ebx_15->b0000 = cl_13;
		cl_13 = cl_13 + 0x01;
		ebx_15 = ebx_15 + 0x01;
		ecx_12 = DPB(ecx_12, cl_13, 0);
	} while (cl_13 != 0x00);
	globals->t4021A4 = ecx_12;
}

// 004010F8: void fn004010F8()
void fn004010F8()
{
	globals->b4021AC = globals->a402081;
}

// 00401109: void fn00401109(Register word32 eax, Register word32 ebp)
void fn00401109(word32 eax, word32 ebp)
{
	ptr32 esp_20;
	word32 ebp_21;
	byte SCZO_22;
	word32 ebx_23;
	byte SZO_24;
	bool C_25;
	word32 eax_26;
	word32 edx_27;
	byte SO_28;
	globals->ptr402004();
	globals->dw402184 = eax_26;
	*(esp_20 - 0x04) = 60000;
	*(esp_20 - 0x08) = 0x08;
	*(esp_20 - 0x0C) = eax_26;
	ptr32 esp_36;
	word32 ebp_37;
	byte SCZO_38;
	word32 ebx_39;
	byte SZO_40;
	bool C_41;
	struct Eq_24 * eax_42;
	word32 edx_43;
	byte SO_44;
	globals->ptr402000();
	globals->ptr402178 = eax_42;
	*(esp_36 - 0x04) = 0x00;
	*(esp_36 - 0x08) = 0x00;
	*(esp_36 - 0x0C) = 0x01;
	ptr32 esp_52;
	word32 ebp_53;
	byte SCZO_54;
	word32 ebx_55;
	byte SZO_56;
	bool C_57;
	word32 eax_58;
	word32 edx_59;
	byte SO_60;
	globals->ptr402004();
	globals->dw40218C = eax_58;
	globals->dw4021A0 = fn004011DA();
	fn004010D5();
	globals->dw4021A8 = 0x09;
	int32 eax_68 = fn0040157F();
	*(esp_52 - 0x04) = eax_68;
	fn004012BA(dwArg00);
	fn00401262();
	fn004010F8();
	int32 dwLoc0C_69 = eax_68;
	while (globals->dw40219C - globals->dw402170 >= globals->dw4021A8)
	{
		int32 eax_85 = fn0040157F();
		if (eax_85 > globals->t4021A4 - 0x01)
		{
			*(esp_52 - 0x04) = dwLoc0C_69;
			fn004012BA(dwArg00);
			fn004012E2();
		}
		else
		{
			*(esp_52 - 0x04) = eax_85;
			fn004012BA(dwArg00);
		}
		fn00401262();
		fn004010F8();
		*(esp_52 - 0x04) = dwLoc0C_69;
		fn004012BA(dwArg00);
		fn004012E2();
		fn00401060();
		dwLoc0C_69 = eax_85;
	}
}

// 004011DA: Register word32 fn004011DA()
word32 fn004011DA()
{
	word32 esp_13;
	word32 eax_14;
	globals->ptr402000();
	return eax_14;
}

// 004011F4: Register word32 fn004011F4(Register word32 ebp, Stack (ptr32 Eq_24) dwArg04)
word32 fn004011F4(word32 ebp, Eq_24 * dwArg04)
{
	word32 ebx_19 = dwArg04 + Mem0[dwArg04 + 0x3C:word32];
	globals->ptr402174 = ebx_19->ptr0034;
	word32 eax_23 = (word32) ebx_19->b0006;
	word32 dwLoc08_24 = eax_23;
	ptr32 esp_35;
	word32 ebp_36;
	byte SCZO_37;
	struct Eq_395 * ebx_38;
	word32 esi_39;
	word32 edi_40;
	word32 eax_41;
	word32 ecx_42;
	byte SZO_43;
	bool Z_44;
	globals->ptr402014();
	*(esp_35 - 0x04) = ebx_38->dw0054;
	*(esp_35 - 0x08) = (struct Eq_24 **) dwArg04;
	*(esp_35 - 0x0C) = eax_41;
	fn0040137D(dwArg00, dwArg04, dwArg08);
	struct Eq_430 * edi_57 = &ebx_38->dw0054 + 0x0029;
	do
	{
		ptr32 eax_62 = dwArg04 + edi_57->dw0014;
		word32 ecx_64 = eax_41 + edi_57->dw000C;
		*(esp_35 - 0x04) = edi_57->dw0010;
		*(esp_35 - 0x08) = eax_62;
		*(esp_35 - 0x0C) = ecx_64;
		fn0040137D(dwArg00, dwArg04, dwArg08);
		word32 v15_76 = dwLoc08_24 - 0x01;
		edi_57 = edi_57 + 0x01;
		dwLoc08_24 = v15_76;
	} while (v15_76 != 0x00);
	return ebx_38->dw0028 + eax_41;
}

// 00401262: void fn00401262()
void fn00401262()
{
	word32 ecx_33 = (word32) globals->a402080;
	byte * edi_31 = globals->ptr402178 + globals->dw40217C;
	globals->dw40217C = globals->dw40217C + ecx_33;
	byte * esi_37 = globals->a402081;
	while (ecx_33 != 0x00)
	{
		*edi_31 = *esi_37;
		esi_37 = esi_37 + 0x01;
		edi_31 = edi_31 + 0x01;
		ecx_33 = ecx_33 - 0x01;
	}
}

// 00401293: void fn00401293(Register word32 eax, Stack word32 dwArg04)
void fn00401293(word32 eax, word32 dwArg04)
{
	word32 esp_21;
	word32 ebp_22;
	word32 eax_23;
	globals->ptr402008();
	ptr32 esp_24;
	word32 ebp_25;
	word32 eax_26;
	globals->ptr402018();
	*(esp_24 - 0x04) = eax_26;
	word32 esp_29;
	word32 ebp_30;
	word32 eax_31;
	globals->ptr40200C();
}

// 004012BA: void fn004012BA(Stack uint32 dwArg04)
void fn004012BA(uint32 dwArg04)
{
	byte * ebx_37 = globals->dw4021A0 + (word32) (dwArg04 * 0xA0);
	byte * edi_29 = globals->a402080;
	word32 ecx_40 = (word32) *ebx_37 + 0x01;
	byte * esi_42 = ebx_37;
	while (ecx_40 != 0x00)
	{
		*edi_29 = *esi_42;
		esi_42 = esi_42 + 0x01;
		edi_29 = edi_29 + 0x01;
		ecx_40 = ecx_40 - 0x01;
	}
}

// 004012E2: void fn004012E2()
void fn004012E2()
{
	globals->a402080 = globals->a402080 + 0x01;
	((word32) globals->a402080)->b402080 = globals->b4021AC;
}

// 004012F8: void fn004012F8(Register word32 eax)
void fn004012F8(word32 eax)
{
	fn00401316(eax, fp - 0x04);
	fn00401340(fp - 0x04);
	fn0040136A(fp - 0x04);
}

// 00401316: void fn00401316(Register word32 eax, Register ptr32 ebp)
void fn00401316(word32 eax, ptr32 ebp)
{
	ptr32 esp_3;
	struct Eq_588 * ebp_4;
	word32 eax_5;
	byte SZO_6;
	bool C_7;
	word32 ecx_8;
	word32 edx_9;
	globals->ptr402018();
	*(ebp_4 - 0x08) = eax_5;
	word32 edx_14 = ebp_4->dw0008;
	*(esp_3 - 0x04) = 0x00;
	*(esp_3 - 0x08) = 0x04;
	*(esp_3 - 0x0C) = 0x00;
	*(esp_3 - 0x10) = edx_14 + 0x01;
	*(esp_3 - 0x14) = 0x00;
	*(esp_3 - 0x18) = 0x00;
	word32 esp_29;
	ptr32 ebp_30;
	word32 eax_31;
	byte SZO_32;
	bool C_33;
	word32 ecx_34;
	word32 edx_35;
	globals->ptr402008();
	*(ebp_30 - 0x04) = eax_31;
}

// 00401340: void fn00401340(Register ptr32 ebp)
void fn00401340(ptr32 ebp)
{
	*(ebp - 0x02D4) = 0x00010002;
	ptr32 esp_10;
	struct Eq_663 * ebp_11;
	struct Eq_664 * esi_12;
	word32 eax_13;
	globals->ptr40201C();
	word32 eax_14 = ebp_11->dw0008;
	esi_12->dw00B0 = eax_14;
	*(esp_10 - 0x04) = (struct Eq_664 **) esi_12;
	*(esp_10 - 0x08) = *(ebp_11 - 0x04);
	word32 esp_21;
	word32 ebp_22;
	word32 esi_23;
	word32 eax_24;
	globals->ptr402020();
}

// 0040136A: void fn0040136A(Register ptr32 ebp)
void fn0040136A(ptr32 ebp)
{
	ptr32 esp_7;
	ptr32 ebp_8;
	globals->ptr402024();
	*(esp_7 - 0x04) = *(ebp_8 - 0x08);
	word32 esp_12;
	word32 ebp_13;
	globals->ptr40200C();
}

// 0040137D: void fn0040137D(Stack (ptr32 byte) dwArg04, Stack (ptr32 Eq_24) dwArg08, Stack word32 dwArg0C)
void fn0040137D(byte * dwArg04, Eq_24 * dwArg08, word32 dwArg0C)
{
	byte * edi_13 = dwArg04;
	struct Eq_24 * esi_15 = dwArg08;
	word32 ecx_17 = dwArg0C;
	while (ecx_17 != 0x00)
	{
		*edi_13 = esi_15->b0000;
		esi_15 = esi_15 + 0x01;
		edi_13 = edi_13 + 0x01;
		ecx_17 = ecx_17 - 0x01;
	}
}

// 00401393: Register word32 fn00401393(Stack (ptr32 Eq_32) dwArg04, Register out ptr32 ebxOut)
word32 fn00401393(Eq_32 * dwArg04, ptr32 & ebxOut)
{
	struct Eq_732 * esp_27 = fp - 0x28;
	struct Eq_736 * ebx_39 = dwArg04 + (&(dwArg04 + dwArg04->ptr003C / 0x0040)->ptr003C)[0x0011] / 0x0040;
	do
	{
		word32 eax_44 = dwArg04 + ebx_39->dw000C / 0x0040;
		word32 * esp_46 = esp_27 - 0x04;
		*esp_46 = eax_44;
		word32 ebp_49;
		byte SCZO_50;
		word32 eax_51;
		word32 ecx_52;
		word32 edx_53;
		word32 * ebx_54;
		word32 esi_55;
		word32 edi_56;
		byte SZO_57;
		bool Z_58;
		bool C_59;
		globals->ptr40202C();
		word32 * esi_62 = dwArg04 + *ebx_54 / 0x0040;
		do
		{
			word32 * esp_74 = esp_27 - 0x04;
			*esp_74 = (char *) (dwArg04 + *esi_62 / 0x0040) + 0x02;
			*(esp_74 - 0x04) = eax_51;
			word32 ebp_80;
			byte SCZO_81;
			word32 eax_82;
			word32 ecx_83;
			word32 edx_84;
			struct Eq_769 * ebx_85;
			struct Eq_770 * esi_86;
			word32 * edi_87;
			byte SZO_88;
			bool Z_89;
			bool C_90;
			globals->ptr402028();
			*edi_87 = eax_82;
			esi_62 = (word32 *) &esi_86->dw0004;
		} while (esi_86->dw0004 != 0x00);
		ebx_39 = (struct Eq_736 *) ((char *) ebx_85 + 0x0014);
	} while (ebx_85->dw0020 != 0x00);
	word32 ebx_111;
	*ebxOut = esp_27->dw0010;
	return esp_27->dw0018;
}

// 004013FE: Register word32 fn004013FE()
word32 fn004013FE()
{
	struct Eq_829 * eax_11 = fn0040142A();
	fn0040148B(0x41636F72, fp - 0x0C, eax_11);
	return fn00401447(eax_11, dwLoc0C);
}

// 0040142A: Register (ptr32 Eq_849) fn0040142A()
Eq_849 * fn0040142A()
{
	struct Eq_849 * eax_10 = fs->ptr0000->dw0004 & 0xFFFF0000;
	do
		eax_10 = eax_10 - 0x00010000;
	while (eax_10->w0000 != 23117);
	return eax_10;
}

// 00401447: Register word32 fn00401447(Stack (ptr32 Eq_829) dwArg04, Stack (ptr32 code) dwArg08)
word32 fn00401447(Eq_829 * dwArg04, code * dwArg08)
{
	fn0040137D(&globals->b402030, &globals->t4014D3, 0xA5);
	struct Eq_872 * esp_39 = fp - 0x24;
	struct Eq_829 * edi_41 = dwArg04;
	ptr32 esi_42 = 0x004014D3;
	do
	{
		ptr32 * esp_47 = esp_39 - 0x04;
		*esp_47 = esi_42;
		*(esp_47 - 0x04) = (struct Eq_829 **) edi_41;
		word32 ebp_53;
		word32 eax_54;
		word32 ecx_55;
		word32 edx_56;
		word32 * ebx_57;
		byte SCZO_60;
		byte SZO_61;
		bool Z_62;
		struct Eq_879 * esi_58;
		dwArg08();
		*ebx_57 = eax_54;
		do
			esi_58 = esi_58 + 0x01;
		while (esi_58->b0000 != 0x00);
		esi_42 = esi_58 + 0x01;
	} while (esi_58[0x01] != 0x00);
	return esp_39->dw001C;
}

// 0040148B: void fn0040148B(Stack word32 dwArg04, Stack (ptr32 word32) dwArg08, Stack (ptr32 Eq_829) dwArg0C)
void fn0040148B(word32 dwArg04, word32 * dwArg08, Eq_829 * dwArg0C)
{
	word32 edi_38 = Mem0[Mem0[dwArg0C + 0x3C:word32] + 0x78 + dwArg0C:word32] + dwArg0C;
	ui32 ecx_39 = 0x00;
	int32 * ebx_41 = dwArg0C + edi_38->dw0020 / 0x0040;
	while (dwArg04 != *((char *) (dwArg0C + *ebx_41 / 0x0040) + 0x04))
	{
		ecx_39 = ecx_39 + 0x01;
		ebx_41 = ebx_41 + 0x01;
	}
	Mem63[dwArg08 + 0x00:word32] = (Mem0[edi_38 + 0x1C:word32] + dwArg0C)[ecx_39 * 0x04] + dwArg0C;
}

// 00401579: FlagGroup bool fn00401579(Register uint32 esi, Register out ptr32 esiOut)
bool fn00401579(uint32 esi, ptr32 & esiOut)
{
	word32 esi_3;
	*esiOut = esi >> 0x1F;
	return (bool) cond(esi >> 0x1F);
}

// 0040157F: Register word32 fn0040157F()
word32 fn0040157F()
{
	uint64 edx_eax_23 = (uint64) (uint32) globals->dw402170;
	uint32 edx_26 = (uint32) (edx_eax_23 % 0x20);
	int32 v16_32 = globals->dw4021A8;
	byte dl_27 = (byte) edx_26;
	word32 * ebx_30 = globals->dw402190 + ((uint32) (edx_eax_23 /u 0x20) << 0x02);
	int32 edi_35 = v16_32;
	word32 eax_40 = 0x00;
	do
	{
		edi_35 = edi_35 - 0x01;
		byte dil_52 = (byte) edi_35;
		ui32 esi_57;
		if (!fn00401579(fn004015E7(dl_27, __bswap(*ebx_30)), out esi_57))
			eax_40 = eax_40 + fn004015E2(esi_57, dil_52);
		edx_26 = edx_26 + 0x01;
		dl_27 = (byte) edx_26;
		if (edx_26 == 0x20)
		{
			ebx_30 = ebx_30 + 0x01;
			edx_26 = 0x00;
			dl_27 = 0x00;
		}
	} while (edi_35 != 0x00);
	globals->dw402170 = globals->dw402170 + v16_32;
	return eax_40;
}

// 004015E2: Register ui32 fn004015E2(Register ui32 esi, Register byte dil)
ui32 fn004015E2(ui32 esi, byte dil)
{
	return esi << (byte) edi;
}

// 004015E7: Register ui32 fn004015E7(Register byte dl, Register ui32 esi)
ui32 fn004015E7(byte dl, ui32 esi)
{
	return esi << dl;
}

// 004015EC: Register word32 fn004015EC(Register word32 ebp)
word32 fn004015EC(word32 ebp)
{
	ui32 ecx_17 = globals->dw405074;
	globals->dw402198 = ecx_17;
	globals->dw40219C = ecx_17 << 0x03;
	ptr32 esp_30;
	word32 ebp_31;
	word32 esi_32;
	word32 ebx_33;
	word32 eax_34;
	byte SZO_35;
	bool C_36;
	byte SCZO_37;
	word32 ecx_38;
	globals->ptr402004();
	globals->dw402180 = eax_34;
	*(esp_30 - 0x04) = globals->dw402198;
	*(esp_30 - 0x08) = 0x08;
	*(esp_30 - 0x0C) = eax_34;
	ptr32 esp_47;
	word32 ebp_48;
	word32 esi_49;
	word32 ebx_50;
	word32 eax_51;
	byte SZO_52;
	bool C_53;
	byte SCZO_54;
	word32 ecx_55;
	globals->ptr402000();
	globals->dw402190 = eax_51;
	word32 eax_57 = eax_51 + globals->dw402198;
	globals->dw402194 = eax_57;
	*(esp_47 - 0x04) = globals->dw402198;
	*(esp_47 - 0x08) = 0x00405088;
	*(esp_47 - 0x0C) = globals->dw402190;
	fn0040137D(dwArg00, dwArg04, dwArg08);
	*(esp_47 - 0x04) = globals->dw402198;
	*(esp_47 - 0x08) = globals->dw402190;
	fn00401672(dwArg00, dwArg04);
	return eax_57;
}

// 00401672: void fn00401672(Stack (ptr32 byte) dwArg04, Stack (ptr32 Eq_24) dwArg08)
void fn00401672(byte * dwArg04, Eq_24 * dwArg08)
{
	byte * edx_10 = dwArg04;
	struct Eq_24 * ecx_11 = dwArg08;
	do
	{
		*edx_10 = *edx_10 + 0x40;
		edx_10 = edx_10 + 0x01;
		ecx_11 = ecx_11 - 0x01;
	} while (ecx_11 != null);
	globals->dw402190 = globals->dw402190 + 0x04;
}

// 00401690: void fn00401690()
void fn00401690()
{
	ptr32 esp_6;
	globals->ptr402010();
	*(esp_6 - 0x04) = globals->dw40218C;
	word32 esp_10;
	globals->ptr402010();
}

