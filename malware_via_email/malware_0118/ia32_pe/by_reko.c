// subject.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

// 00401000: Register word32 fn00401000(Register word32 ebp, Stack Eq_4 dwArg04, Stack word32 dwArg08)
word32 fn00401000(word32 ebp, LPCSTR dwArg04, word32 dwArg08)
{
	ptr32 esp_13 = fp - 0x04;
	if (globals->t405000 == null)
	{
		globals->t405000 = LoadLibraryA(&globals->t40100E);
		esp_13 = fp - 0x08;
	}
	if (globals->dw405004 == 0x00)
	{
		word32 * esp_38 = esp_13 - 0x04;
		*esp_38 = 2517111233;
		*(esp_38 - 0x04) = (HMODULE *) globals->t405000;
		globals->dw405004 = fn00401091(dwArg00, dwArg04);
	}
	LPCSTR * esp_19 = esp_13 - 0x04;
	*esp_19 = (LPCSTR *) dwArg04;
	Eq_11 eax_21 = LoadLibraryA(*esp_19);
	*(esp_19 - 0x04) = dwArg08;
	*(esp_19 - 0x08) = (HMODULE *) eax_21;
	word32 eax_29 = fn00401091(dwArg00, dwArg04);
	if (eax_29 == 0x00)
		int3();
	return eax_29;
}

// 0040105B: Register word32 fn0040105B(Stack (ptr byte) dwArg04)
word32 fn0040105B(byte * dwArg04)
{
	byte * edi_32 = dwArg04;
	word32 ebx_33 = 0x00;
	byte bl_34 = 0x00;
	uint8 cl_36 = 0x00;
	do
	{
		cl_36 = cl_36 ^ *edi_32;
		word32 ebx_51 = DPB(ebx_33, bl_34 ^ *edi_32, 0);
		while (cl_36 >= 0x20)
			cl_36 = cl_36 - 0x20;
		ebx_33 = __rol(ebx_51, cl_36);
		edi_32 = edi_32 + 0x01;
		bl_34 = (byte) ebx_33;
	} while (*edi_32 != 0x00);
	return ebx_33;
}

// 00401091: Register word32 fn00401091(Stack (ptr Eq_52) dwArg04, Stack Eq_4 dwArg08)
word32 fn00401091(Eq_52 * dwArg04, LPCSTR dwArg08)
{
}

// 0040161D: void fn0040161D()
void fn0040161D()
{
}

// 00402764: void fn00402764(Register word32 ebp)
void fn00402764(word32 ebp)
{
	Eq_183 eax_21 = fn00401000(ebp, &globals->t40112B, globals->dw402766);
	ptr32 esp_22 = fp - 0x18;
	if (eax_21 != null)
	{
		word32 eax_41;
		byte SZO_42;
		byte C_43;
		byte Z_44;
		word32 ebp_45;
		eax_21();
	}
	ui32 * esp_34 = esp_22 - 0x04;
	*esp_34 = globals->dw40222C ^ 188;
	*(esp_34 - 0x04) = 4204458;
	*(esp_34 - 0x08) = 0x00401370;
}

// 0040298D: void fn0040298D(Register word32 ebp)
void fn0040298D(word32 ebp)
{
	Eq_183 eax_15 = fn00401000(ebp, &globals->t40168A, globals->dw401DDD);
	ptr32 esp_16 = fp - 0x0C;
	Eq_183 eax_17 = eax_15;
	if (eax_15 != null)
	{
		byte SZO_38;
		byte C_39;
		byte Z_40;
		word32 ebp_41;
		eax_15();
	}
	if (eax_17 == null)
		return;
	globals->t405AA8 = eax_17;
	word32 * esp_30 = esp_16 - 0x04;
	*esp_30 = 4204922;
	*(esp_30 - 0x04) = 4205003;
	*(esp_30 - 0x08) = 4199014;
}

// 0040306F: Register Eq_183 Win32CrtStartup()
DWORD Win32CrtStartup()
{
	fn0040298D(ebp);
	*(fp - 0x04) = 0x00;
	fn0040161D();
	*(fp - 0x04) = 0x01;
	fn00402764(ebp);
	*(fp - 0x04) = 0x0400;
	*(fp - 0x08) = 0x00406EE0;
	*(fp - 0x0C) = 0x00;
	*(fp - 0x10) = globals->dw401B20;
	*(fp - 0x14) = 4198699;
	Eq_183 eax_24 = fn00401000(ebp, dwArg00, dwArg04);
	ptr32 esp_25 = fp - 0x0C;
	Eq_183 eax_26 = eax_24;
	if (eax_24 != null)
	{
		byte SZO_47;
		byte C_48;
		byte Z_49;
		word32 ebp_50;
		eax_24();
	}
	globals->dw406BA0 = 0x44;
	globals->dw406BCC = 0x01;
	globals->w406BD0 = 0x02;
	word32 * esp_39 = esp_25 - 0x04;
	*esp_39 = 4205240;
	*(esp_39 - 0x04) = 0x004030D5;
	*(esp_39 - 0x08) = 4199014;
	return eax_26;
}

