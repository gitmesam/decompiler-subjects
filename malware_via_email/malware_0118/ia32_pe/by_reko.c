// subject.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

// 00401000: Register word32 fn00401000(Stack Eq_3 dwArg04, Stack word32 dwArg08)
word32 fn00401000(LPCSTR dwArg04, word32 dwArg08)
{
	if (globals->t405000 == null)
		globals->t405000 = LoadLibraryA(&globals->t40100E);
	if (globals->dw405004 == 0x00)
		globals->dw405004 = fn00401091(globals->t405000, 2517111233);
	word32 eax_28 = fn00401091(LoadLibraryA(dwArg04), dwArg08);
	if (eax_28 == 0x00)
		int3();
	return eax_28;
}

// 0040105B: Register word32 fn0040105B(Stack (ptr32 byte) dwArg04)
word32 fn0040105B(byte * dwArg04)
{
	byte * edi_32 = dwArg04;
	word32 ebx_33 = 0x00;
	byte bl_34 = 0x00;
	uint8 cl_36 = 0x00;
	do
	{
		cl_36 = cl_36 ^ *edi_32;
		word32 ebx_51 = DPB(ebx_33, bl_34 ^ *edi_32, 0);
		while (cl_36 >= 0x20)
			cl_36 = cl_36 - 0x20;
		ebx_33 = __rol(ebx_51, cl_36);
		edi_32 = edi_32 + 0x01;
		bl_34 = (byte) ebx_33;
	} while (*edi_32 != 0x00);
	return ebx_33;
}

// 00401091: Register word32 fn00401091(Stack Eq_6 dwArg04, Stack word32 dwArg08)
word32 fn00401091(HMODULE dwArg04, word32 dwArg08)
{
	if (dwArg04 == null)
		return eax;
	word32 dwLoc18_145 = 0x00;
	int32 v7_48 = dwArg04->dw003C;
	if (dwArg04[v7_48 / 0x0040] == 0x4550)
	{
		word32 ecx_73 = dwArg04[(v7_48 + 0x78) / 0x0040];
		if (ecx_73 != 0x00)
		{
			struct Eq_96 * ecx_78 = dwArg04 + ecx_73 / 0x0040;
			ui32 v12_79 = ecx_78->dw0018;
			word32 eax_91[] = dwArg04 + ecx_78->dw001C / 0x0040;
			Eq_312 edi_96[] = dwArg04 + ecx_78->dw0024 / 0x0040;
			word32 * esi_102 = dwArg04 + ecx_78->dw0020 / 0x0040;
			ui32 dwLoc08_106 = v12_79;
			do
			{
				if (fn0040105B(dwArg04 + *esi_102 / 0x0040) == dwArg08)
				{
					dwLoc18_145 = dwArg04 + eax_91[(edi_96)[v12_79 - dwLoc08_106].dw0000 & 0xFFFF] / 0x0040;
					return dwLoc18_145;
				}
				ui32 v17_124 = dwLoc08_106 - 0x01;
				esi_102 = esi_102 + 0x01;
				dwLoc08_106 = v17_124;
			} while (v17_124 != 0x00);
		}
	}
	return dwLoc18_145;
}

// 0040161D: void fn0040161D()
void fn0040161D()
{
}

// 00402764: void fn00402764()
void fn00402764()
{
	Eq_143 eax_20 = fn00401000(&globals->t40112B, globals->dw402766);
	ptr32 esp_21 = fp - 0x18;
	if (eax_20 != null)
	{
		word32 eax_39;
		byte SZO_40;
		bool C_41;
		bool Z_42;
		eax_20();
	}
	ui32 * esp_32 = esp_21 - 0x04;
	*esp_32 = globals->dw40222C ^ 188;
	*(esp_32 - 0x04) = 4204458;
	*(esp_32 - 0x08) = 0x00401370;
}

// 0040298D: void fn0040298D()
void fn0040298D()
{
	Eq_143 eax_14 = fn00401000(&globals->t40168A, globals->dw401DDD);
	ptr32 esp_15 = fp - 0x0C;
	Eq_143 eax_16 = eax_14;
	if (eax_14 != null)
	{
		byte SZO_36;
		bool C_37;
		bool Z_38;
		eax_14();
	}
	if (eax_16 == null)
		return;
	globals->t405AA8 = eax_16;
	word32 * esp_28 = esp_15 - 0x04;
	*esp_28 = 4204922;
	*(esp_28 - 0x04) = 4205003;
	*(esp_28 - 0x08) = 4199014;
}

// 0040306F: Register Eq_143 Win32CrtStartup()
DWORD Win32CrtStartup()
{
	fn0040298D();
	fn0040161D();
	*(fp - 0x04) = 0x01;
	fn00402764();
	*(fp - 0x04) = 0x0400;
	*(fp - 0x08) = 0x00406EE0;
	*(fp - 0x0C) = 0x00;
	*(fp - 0x10) = globals->dw401B20;
	*(fp - 0x14) = 4198699;
	Eq_143 eax_23 = fn00401000(dwArg00, dwArg04);
	ptr32 esp_24 = fp - 0x0C;
	Eq_143 eax_25 = eax_23;
	if (eax_23 != null)
	{
		byte SZO_45;
		bool C_46;
		bool Z_47;
		eax_23();
	}
	globals->dw406BA0 = 0x44;
	globals->dw406BCC = 0x01;
	globals->w406BD0 = 0x02;
	word32 * esp_37 = esp_24 - 0x04;
	*esp_37 = 4205240;
	*(esp_37 - 0x04) = 0x004030D5;
	*(esp_37 - 0x08) = 4199014;
	return eax_25;
}

