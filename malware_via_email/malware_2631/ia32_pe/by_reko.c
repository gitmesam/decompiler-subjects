// subject.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

// 0040100E: Register Eq_2 Win32CrtStartup()
DWORD Win32CrtStartup()
{
	Eq_3 eax_23 = CreateFileA(&globals->t435F0A, 0x40000000, 0x06, null, 0x03, 0x0105, 0x00);
	if (eax_23 != ~0x00)
	{
		GetFileSize(dwLoc08, null);
		CloseHandle(eax_23);
		GetVersion();
		GetCurrentThreadId();
		CloseHandle(eax_23);
		GetCurrentProcessId();
		VirtualProtect(&globals->v40125D, 60080, 0x40, eax_23);
		GetCommandLineW();
		GetCommandLineW();
		GetCurrentProcessId();
		GetCurrentProcessId();
		word32 esp_186;
		word32 ebp_187;
		byte SCZO_188;
		word32 eax_189;
		bool Z_190;
		byte SZO_191;
		bool C_192;
		struct Eq_71 * edx_193;
		ui32 esi_194;
		bool D_195;
		byte al_196;
		word32 ecx_197;
		byte dh_198;
		byte bl_199;
		word16 dx_200;
		real64 rArg0_201;
		(dwLoc1C - ~0x40401204)();
		GetOEMCP();
		*(ebp - 0x24) = (uint32) GetVersion();
		Eq_33 eax_211 = CloseHandle(*(ebp - 0x1C));
		byte al_212 = (byte) eax_211;
		edx_193->dw7B8412FD = edx_193->dw7B8412FD & esi_194;
		byte al_218;
		__das(al_212, &al_218);
		edx_193->dwB1C12FFD = edx_193->dwB1C12FFD & esi_194;
		if (edx_193->dwB1C12FFD != 0x00 && ecx_197 != 0x01)
		{
			byte al_236;
			__das(al_218, &al_236);
			edx_193->b0000 = edx_193->b0000 & bl_199;
			__outdw(dx_200, eax_211);
		}
		else
		{
			(eax_211 - (struct <anonymous> *) 0x14)->dw0000 = (eax_211 - (struct <anonymous> *) 0x14)->dw0000 + 3696836911;
			byte al_229;
			__das(al_218, &al_229);
			edx_193->b0000 = -edx_193->b0000;
		}
	}
	else
	{
		GetFileType(dwLoc18);
		Eq_3 eax_35 = GetModuleHandleA(&globals->t435EED);
		GetACP();
		Eq_118 eax_44 = GetProcAddress(eax_35, &globals->t435EF7);
		GetFileSize(eax_35, null);
		GetFileSize(eax_23, null);
		GetCurrentThreadId();
		CreateFileA(&globals->t435EE7, 0x40000000, 0x02, null, 0x03, 0x00, 0x00);
		GetCurrentThreadId();
		GetCommandLineA();
		int32 eax_91 = eax_44();
		GetProcessHeap();
		<anonymous> * eax_108 = (eax_91 ^ 0xC0000005) + 0x00401117;
		word32 esp_110;
		word32 ebp_111;
		byte SCZO_112;
		Eq_2 eax_113;
		bool Z_114;
		byte SZO_115;
		bool C_116;
		word32 edx_117;
		word32 esi_118;
		bool D_119;
		byte al_120;
		word32 ecx_121;
		byte dh_122;
		byte bl_123;
		word16 dx_124;
		real64 rArg0_125;
		eax_108();
		return eax_113;
	}
}

