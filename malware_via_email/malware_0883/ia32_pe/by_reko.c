// subject.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

// 00401005: Register Eq_2 Win32CrtStartup()
DWORD Win32CrtStartup()
{
	word32 edx_39 = edx + esi + esi + (fp + 0x10) + (fp + 0x10);
	word32 ebx_105;
	word32 ebp_106;
	word32 edi_107;
	Eq_2 eax_108 = fn004010CC(edx_39 + 3839249311, ebx, ebp, edi, dwLoc2C, dwLoc16, esi, out ebx_105, out ebp_106, out edi_107);
	word32 ebx_110;
	word32 ebp_111;
	word32 edi_112;
	return fn004010CC(eax_108, ebx_105, ebp_106, edi_107, dwLoc2C, dwLoc16, esi, out ebx_110, out ebp_111, out edi_112);
}

// 004010CC: Register Eq_2 fn004010CC(Register Eq_2 eax, Register word32 ebx, Register word32 ebp, Register word32 edi, Stack word32 dwArg00, Stack word32 dwArg16, Stack word32 dwArg24, Register out ptr32 ebxOut, Register out ptr32 ebpOut, Register out ptr32 ediOut)
DWORD fn004010CC(DWORD eax, word32 ebx, word32 ebp, word32 edi, word32 dwArg00, word32 dwArg16, word32 dwArg24, ptr32 & ebxOut, ptr32 & ebpOut, ptr32 & ediOut)
{
	word32 ecx_136;
	struct Eq_50 * ebx_137;
	fn00401696(ebx, dwLoc32, fp - 0x2A, out ecx_136, out ebx_137);
	word32 esp_156;
	word32 eax_157;
	byte SZO_158;
	word32 ebp_159;
	word32 edx_160;
	bool C_161;
	word16 ax_162;
	word16 cx_163;
	word32 ecx_164;
	byte SCZO_165;
	word32 esi_166;
	struct Eq_76 * ebx_167;
	word32 edi_168;
	word16 si_169;
	struct Eq_79 * fs_170;
	byte al_171;
	bool Z_172;
	byte dh_173;
	byte dl_174;
	byte bh_175;
	word16 bx_176;
	byte CZ_177;
	byte ah_178;
	byte cl_179;
	byte bl_180;
	ebx_137->ptr0018();
	ptr32 esp_182;
	word32 eax_183;
	byte SZO_184;
	word32 ebp_185;
	word32 edx_186;
	bool C_187;
	word16 ax_188;
	word16 cx_189;
	word32 ecx_190;
	byte SCZO_191;
	word32 esi_192;
	<anonymous> ** ebx_193;
	word32 edi_194;
	word16 si_195;
	struct Eq_107 * fs_196;
	byte al_197;
	bool Z_198;
	byte dh_199;
	byte dl_200;
	byte bh_201;
	word16 bx_202;
	byte CZ_203;
	byte ah_204;
	byte cl_205;
	byte bl_206;
	ebx_167->ptr001C();
	*(esp_182 - 0x04) = eax_183 + 0x06;
	*(esp_182 - 0x08) = eax_183 + 0x06;
	struct Eq_134 * esp_224;
	word32 eax_225;
	byte SZO_226;
	word32 ebp_227;
	word32 edx_228;
	bool C_229;
	word16 ax_230;
	word16 cx_231;
	word32 ecx_232;
	byte SCZO_233;
	word32 esi_234;
	word32 ebx_235;
	word32 edi_236;
	word16 si_237;
	struct Eq_148 * fs_238;
	byte al_239;
	bool Z_240;
	byte dh_241;
	byte dl_242;
	byte bh_243;
	word16 bx_244;
	byte CZ_245;
	byte ah_246;
	byte cl_247;
	byte bl_248;
	(*ebx_193)();
	esp_224->dw0038 = ebx_235;
	esp_224->dw003C = esi_234;
	*(esp_224 - 0x04) = ebx_235;
	*(esp_224 - 0x04) = *(esp_224 - 0x04) - 0x04;
	struct Eq_183 * edi_264 = *(esp_224 - 0x04);
	*(esp_224 - 0x04) = eax_225;
	*(esp_224 - 0x08) = ecx_232;
	*(esp_224 - 0x0C) = esp_224 - 0x08;
	*(esp_224 - 0x10) = 0x40;
	*(esp_224 - 0x14) = esp_224->dw0020;
	*(esp_224 - 0x18) = esp_224->dw0014;
	esp_224->dw0018 = 0x00;
	*(esp_224 - 0x1C) = ~0x00;
	struct Eq_236 * esp_297;
	struct Eq_237 Eq_249::* eax_298;
	byte SZO_299;
	word32 edx_301;
	bool C_302;
	word16 ax_303;
	word16 cx_304;
	word32 ecx_305;
	byte SCZO_306;
	word32 esi_307;
	word32 ebx_308;
	word32 edi_309;
	word16 si_310;
	struct Eq_249 * fs_311;
	byte al_312;
	bool Z_313;
	byte dh_314;
	byte dl_315;
	byte bh_316;
	word16 bx_317;
	byte ah_319;
	byte cl_320;
	byte bl_321;
	byte CZ_1224;
	word32 ebp_1206;
	edi_264->ptr0010();
	struct Eq_264 * eax_323 = eax_298 + (fs_311->*eax_298).dw002F / 0x0033;
	esp_297->dw0030 = esp_297->dw0030 + eax_323->dw0003;
	*(esp_297 - 0x04) = (struct Eq_264 **) eax_323;
	esp_297->dw0000 = *(esp_297 - 0x04);
	esp_297->dw0004 = esp_297->dw0000;
	word32 edi_349 = esp_297->dw0008;
	esp_297->dw0008 = esp_297->dw0004;
	word32 ebx_1214 = esp_297->dw000C;
	esp_297->dw000C = esp_297->dw0008;
	word32 eax_364 = esp_297->dw000C;
	word32 * esi_1213 = esp_297->ptr0010;
	esp_297->ptr0010 = eax_364 + 0x03;
	word32 * eax_380 = esp_297->ptr0010;
	word32 ecx_382 = *eax_380;
	esp_297->ptr0010 = eax_380;
	word32 * eax_386 = esp_297->ptr0010;
	esp_297->dw003C = esp_297->dw003C ^ ecx_382;
	esp_297->ptr0010 = eax_386;
	esp_297->ptr0010 = esp_297->ptr001C;
	word32 * eax_401 = esp_297->ptr0010;
	word32 ecx_406 = esp_297->dw002C;
	*(esp_297 - 244) = eax_401;
	*(esp_297 - 0xF8) = eax_401;
	word32 eax_415 = *(esp_297 - 0xF8);
	*(esp_297 - 0xF0) = ecx_406;
	*(esp_297 - 0xF8) = eax_415;
	*(esp_297 - 0xF8) = edi_349;
	int32 eax_425 = 0x00;
	do
	{
		*(esp_297 - 252) = eax_425;
		word32 eax_437 = *(esp_297 - 252);
		esp_297 - 0xEC + eax_425 = (byte *) (byte) eax_437;
		*(esp_297 - 252) = eax_437;
		*(esp_297 - 252) = *(esp_297 - 252) + 0x01;
		up32 eax_451 = *(esp_297 - 252);
		*(esp_297 - 252) = eax_451;
		eax_425 = *(esp_297 - 252);
	} while (eax_451 < 0x0100);
	*(esp_297 - 252) = eax_425;
	word32 edi_1215 = *(esp_297 - 0xF8);
	*(esp_297 - 0xF8) = *(esp_297 - 252);
	*(esp_297 - 0xF8) = &esp_297->dw003C + 0x02;
	byte * eax_479 = *(esp_297 - 0xF8);
	*(esp_297 - 0xF8) = (byte **) eax_479;
	ptr32 eax_1250 = *(esp_297 - 0xF8);
	ptr32 esp_1254 = esp_297 - 244;
	if (*eax_479 != 121)
	{
		struct Eq_490 * edi_1009 = *(eax_1250 - 0x04);
		do
		{
			ptr32 esp_1010;
			word32 eax_1011;
			byte SZO_1012;
			word32 ebp_1013;
			word32 edx_1014;
			bool C_1015;
			word16 ax_1016;
			word16 cx_1017;
			word32 ecx_1018;
			byte SCZO_1019;
			word32 esi_1020;
			word32 ebx_1021;
			struct Eq_544 * edi_1022;
			word16 si_1023;
			struct Eq_546 * fs_1024;
			byte al_1025;
			bool Z_1026;
			byte dh_1027;
			byte dl_1028;
			byte bh_1029;
			word16 bx_1030;
			byte CZ_1031;
			byte ah_1032;
			byte cl_1033;
			byte bl_1034;
			edi_1009->ptr0018();
			*(esp_1010 - 0x04) = eax_1011;
			word32 eax_1038 = *(esp_1010 - 0x04);
			int3();
			*(esp_1010 - 0x04) = eax_1038 + 0x02;
			ptr32 esp_1055;
			word32 eax_1056;
			byte SZO_1057;
			word32 ebp_1058;
			word32 edx_1059;
			bool C_1060;
			word16 ax_1061;
			word16 cx_1062;
			word32 ecx_1063;
			byte SCZO_1064;
			word32 esi_1065;
			word32 ebx_1066;
			struct Eq_649 * edi_1067;
			word16 si_1068;
			struct Eq_651 * fs_1069;
			byte al_1070;
			bool Z_1071;
			byte dh_1072;
			byte dl_1073;
			byte bh_1074;
			word16 bx_1075;
			byte CZ_1076;
			byte ah_1077;
			byte cl_1078;
			byte bl_1079;
			edi_1022->ptr0018();
			*(esp_1055 - 0x04) = eax_1056;
			ptr32 esp_1085;
			word32 eax_1086;
			byte SZO_1087;
			word32 ebp_1088;
			word32 edx_1089;
			bool C_1090;
			word16 ax_1091;
			word16 cx_1092;
			word32 ecx_1093;
			byte SCZO_1094;
			word32 esi_1095;
			word32 ebx_1096;
			struct Eq_682 * edi_1097;
			word16 si_1098;
			struct Eq_684 * fs_1099;
			byte al_1100;
			bool Z_1101;
			byte dh_1102;
			byte dl_1103;
			byte bh_1104;
			word16 bx_1105;
			byte CZ_1106;
			byte ah_1107;
			byte cl_1108;
			byte bl_1109;
			edi_1067->ptr0018();
			*(esp_1085 - 0x04) = eax_1086;
			ptr32 esp_1115;
			word32 eax_1116;
			byte SZO_1117;
			word32 ebp_1118;
			word32 edx_1119;
			bool C_1120;
			word16 ax_1121;
			word16 cx_1122;
			word32 ecx_1123;
			byte SCZO_1124;
			word32 esi_1125;
			word32 ebx_1126;
			struct Eq_715 * edi_1127;
			word16 si_1128;
			struct Eq_717 * fs_1129;
			byte al_1130;
			bool Z_1131;
			byte dh_1132;
			byte dl_1133;
			byte bh_1134;
			word16 bx_1135;
			byte CZ_1136;
			byte ah_1137;
			byte cl_1138;
			byte bl_1139;
			edi_1097->ptr0018();
			*(esp_1115 - 0x04) = eax_1116;
			ptr32 esp_1145;
			word32 eax_1146;
			byte SZO_1147;
			word32 ebp_1148;
			word32 edx_1149;
			bool C_1150;
			word16 ax_1151;
			word16 cx_1152;
			word32 ecx_1153;
			byte SCZO_1154;
			word32 esi_1155;
			word32 ebx_1156;
			struct Eq_748 * edi_1157;
			word16 si_1158;
			struct Eq_750 * fs_1159;
			byte al_1160;
			bool Z_1161;
			byte dh_1162;
			byte dl_1163;
			byte bh_1164;
			word16 bx_1165;
			byte CZ_1166;
			byte ah_1167;
			byte cl_1168;
			byte bl_1169;
			edi_1127->ptr0018();
			*(esp_1145 - 0x04) = eax_1146;
			word32 esp_1178;
			word32 eax_1179;
			byte SZO_1180;
			word32 ebp_1181;
			word32 edx_1182;
			bool C_1183;
			word16 ax_1184;
			word16 cx_1185;
			word32 ecx_1186;
			byte SCZO_1187;
			word32 esi_1188;
			word32 ebx_1189;
			struct Eq_781 * edi_1190;
			word16 si_1191;
			struct Eq_783 * fs_1192;
			byte al_1193;
			bool Z_1194;
			byte dh_1195;
			byte dl_1196;
			byte bh_1197;
			word16 bx_1198;
			byte CZ_1199;
			byte ah_1200;
			byte cl_1201;
			byte bl_1202;
			edi_1157->ptr0018();
			ptr32 esp_1203;
			word32 eax_1204;
			byte SZO_1205;
			word32 edx_1207;
			bool C_1208;
			word16 ax_1209;
			word16 cx_1210;
			word32 ecx_1211;
			byte SCZO_1212;
			word16 si_1216;
			struct Eq_812 * fs_1217;
			byte al_1218;
			bool Z_1219;
			byte dh_1220;
			byte dl_1221;
			byte bh_1222;
			word16 bx_1223;
			byte ah_1225;
			byte cl_1226;
			byte bl_1227;
			edi_1190->ptr0010();
			*(esp_1203 - 0x04) = eax_1204 + 0x01;
			word32 eax_1240 = *(esp_1203 - 0x04);
			cup16 ax_1243 = (word16) eax_1240 - cx_1210;
			*(esp_1203 - 0x04) = DPB(eax_1240, ax_1243, 0);
			eax_1250 = *(esp_1203 - 0x04);
			esp_1254 = esp_1203;
		} while (ax_1243 < 0x00);
	}
	struct Eq_496 * esp_517 = esp_1254 - 0x04;
	esp_517->dw0000 = ebp_1206;
	*(esp_517 - 0x04) = eax_1250;
	word32 eax_522 = *(esp_517 - 0x04);
	*(esp_517 - 0x04) = esi_1213;
	*(esp_517 - 0x08) = eax_522;
	word32 eax_529 = *(esp_517 - 0x08);
	*(esp_517 - 0x08) = edi_1215;
	up32 edi_537 = esp_517->dw011C;
	*(esp_517 - 0x0C) = eax_529;
	*(esp_517 - 0x0C) = 0x00;
	int32 eax_547 = *(esp_517 - 0x0C);
	*(esp_517 - 0x0C) = eax_547;
	*(esp_517 - 0x0C) = *(esp_517 - 0x0C);
	word32 eax_562 = *(esp_517 - 0x0C);
	*(esp_517 - 0x0C) = ebx_1214;
	*(esp_517 - 0x10) = eax_562;
	int32 esi_549 = eax_547;
	int32 ebp_556 = 0x00;
	int32 eax_569 = *(esp_517 - 0x10);
	do
	{
		struct Eq_798 * esp_591 = esp_1254 - 0x10;
		word32 ebx_592 = (word32) esp_591->a0018[ebp_556];
		word16 bx_594 = (word16) ebx_592;
		ptr32 edx_596 = esp_591->ptr0014;
		word32 edx_599 = (word32) (edx_596 + eax_569);
		word32 ecx_604 = ebx_592 + esi_549;
		*(esp_591 - 0x04) = eax_569;
		*(esp_591 - 0x04) = *(esp_591 - 0x04);
		*(esp_591 - 0x04) = *(esp_591 - 0x04) + 0x01;
		*(esp_591 - 0x04) = *(esp_591 - 0x04);
		up32 eax_632 = *(esp_591 - 0x04);
		*(esp_591 - 0x04) = eax_632;
		int32 edx_615 = DPB(edx_599 + ecx_604, 0x00, 8);
		esi_549 = edx_615;
		word32 eax_1004 = *(esp_591 - 0x04);
		if (eax_632 >= edi_537)
		{
			*(esp_591 - 0x04) = eax_1004;
			*(esp_591 - 0x04) = 0x00;
			eax_1004 = *(esp_591 - 0x04);
		}
		byte dl_648 = esp_591->a0018[edx_615];
		*(esp_591 - 0x04) = eax_1004;
		word32 eax_652 = *(esp_591 - 0x04);
		esp_591->a0018[ebp_556] = dl_648;
		ebp_556 = ebp_556 + 0x01;
		*(esp_591 - 0x04) = eax_652;
		int32 eax_664 = *(esp_591 - 0x04);
		ptr32 edx_669 = esp_591->a0018 + edx_615 - eax_664;
		word16 bx_675 = DPB(bx_594, eax_664 + 0x01 + edx_669, 8);
		eax_664 + edx_669 = (word16 *) bx_675;
		*(esp_591 - 0x04) = eax_664;
		*(esp_591 - 0x04) = *(esp_591 - 0x04);
		*(esp_591 - 0x04) = *(esp_591 - 0x04);
		eax_569 = *(esp_591 - 0x04);
	} while (SLICE(ebp_556, byte, 8) != 0x01);
	word32 esi_701 = 0x00;
	word32 ebx_711 = esp_591->dw0000;
	esp_591->dw0000 = 0x00;
	word32 ebp_718 = esp_591->dw012C;
	esp_591->dw0000 = esp_591->dw0000;
	ptr32 edi_724 = esp_591->ptr0010;
	esp_591->dw0000 = esp_591->dw0000;
	esp_591->dw0000 = esp_591->dw0000;
	esp_591->dw0000 = esp_591->dw0000;
	word32 edx_730 = ebx_711;
	word32 eax_744 = esp_591->dw0000;
	word32 * esp_748 = &esp_591->dw0000 + 0x01;
	if (!DPB(CZ_1224, false, 0))
	{
		esp_591->dw0000 = eax_744;
		eax_744 = esp_591->dw0000;
		do
		{
			word32 * esp_841 = esp_1254 - 0x0C;
			*(esp_841 - 0x04) = eax_744 + 0x01;
			*(esp_841 - 0x04) = DPB(*(esp_841 - 0x04), 0x00, 8);
			int32 eax_857 = *(esp_841 - 0x04);
			byte cl_862 = (esp_841 + 0x05)[eax_857];
			*(esp_841 - 0x04) = eax_857;
			*(esp_841 - 0x04) = *(esp_841 - 0x04);
			*(esp_841 - 0x04) = *(esp_841 - 0x04);
			*(esp_841 - 0x04) = *(esp_841 - 0x04);
			word32 ebx_882 = DPB((word32) cl_862 + esi_701, 0x00, 8);
			byte dl_897 = esp_841[ebx_882 + 0x14];
			*(esp_841 - 0x04) = *(esp_841 - 0x04);
			int32 eax_902 = *(esp_841 - 0x04);
			(esp_841 + 0x05)[eax_902] = (word32) dl_897;
			*(esp_841 - 0x04) = eax_902;
			word32 eax_908 = *(esp_841 - 0x04);
			*(esp_841 - 0x04) = eax_908;
			*(esp_841 - 0x08) = eax_908;
			*(esp_841 - 0x08) = esp_841 + (ebx_882 + 0x14);
			**(esp_841 - 0x08) = (byte **) cl_862;
			word32 eax_924 = *(esp_841 - 0x04);
			*(esp_841 - 0x04) = eax_924;
			*(esp_841 - 0x04) = *(esp_841 - 0x04);
			word32 edx_929 = (word32) dl_897;
			*(esp_841 - 0x04) = *(esp_841 - 0x04);
			word32 edx_937 = DPB(edx_929, (byte) edx_929 + cl_862, 0);
			ui32 ecx_951 = esp_841[edx_937 + 0x14];
			*(esp_841 - 0x04) = *(esp_841 - 0x04);
			*(esp_841 - 0x04) = *(esp_841 - 0x04);
			*(esp_841 - 0x04) = *(esp_841 - 0x04);
			word32 eax_968 = *(esp_841 - 0x04);
			*(edi_724 - 0x01) = *(edi_724 - 0x01) ^ (word16) (ecx_951 << 0x08);
			*(esp_841 - 0x04) = eax_968;
			*(esp_841 - 0x04) = *(esp_841 - 0x04);
			edx_730 = edx_937 + 0x14;
			esi_701 = ebx_882;
			edi_724 = edi_724 + 0x01;
			eax_744 = *(esp_841 - 0x04);
			esp_748 = esp_841;
			ebp_718 = ebp_718 - 0x01;
		} while (ebp_718 != 0x00);
	}
	word32 edi_771;
	*ediOut = *esp_748;
	struct Eq_1058 * esp_772 = esp_748 + 0x01;
	esp_772->dw0000 = eax_744;
	word32 ebp_780;
	*ebpOut = esp_772->dw0004;
	esp_772->dw0004 = esp_772->dw0000;
	esp_772->dw0110 = esp_772->dw0004;
	esp_772->t0114 = esp_772->t0114;
	esp_772->t013C = esp_772->t0114;
	Eq_2 eax_805 = esp_772->t013C;
	esp_772->t013C = eax_805;
	word32 ebx_812;
	*ebxOut = edx_730;
	return eax_805;
}

// 00401696: Register ptr32 fn00401696(Register word32 ebx, Stack word32 dwArg00, Stack ptr32 dwArg04, Register out ptr32 ecxOut, Register out ptr32 ebxOut)
ptr32 fn00401696(word32 ebx, word32 dwArg00, ptr32 dwArg04, ptr32 & ecxOut, ptr32 & ebxOut)
{
	word32 eax_24 = dwArg00;
	while (true)
	{
		word16 * eax_42 = DPB(eax_24, wLoc0A, 0);
		word16 ax_47 = *eax_42;
		word32 eax_56 = DPB(eax_24, ax_47 + 42421, 0);
		if (ax_47 == 42419)
			break;
		eax_24 = eax_56 - 0x00010000;
	}
	struct Eq_1340 * eax_89;
	__btr(eax_56, 0x01, out eax_89);
	int32 ecx_136 = eax_89[(&(eax_89 + eax_89->dw003C / 0x0040)->dw003C)[0x0011] / 0x0040];
	*ecxOut = ecx_136;
	ptr32 eax_142 = eax_89 + ecx_136 / 0x0040;
	word32 ebx_151;
	*ebxOut = eax_142 + 0x04;
	return eax_142 + 0x04;
}

