// subject.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

// 00401000: Register Eq_2 Win32CrtStartup()
DWORD Win32CrtStartup()
{
	word32 edi_357 = AddAce(null, 0x00, 0x00, null, 0x00) + 0x25 + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00);
	Eq_3 ebp_16 = null;
	struct Eq_237 * esp_355 = fp - 0x0250;
	if (AreAnyAccessesGranted(~0x00, ~0x00) == 0x00)
		edi_357 = edi_357 - 0x22;
	struct Eq_250 * eax_365 = null;
	do
	{
		if (ebp_16 == edi_357)
			ebp_16 = null;
		eax_365[0x00401290] = (struct Eq_250) (eax_365[0x00401290] ^ ebp_16[0x00404000]);
		eax_365 = eax_365 + 0x01;
		ebp_16 = (Eq_3) (ebp_16 + 0x01);
	} while (eax_365 < (struct Eq_250 *) 5152);
	struct Eq_272 * edx_396 = &globals->t402570;
	up32 dwLoc0240_401 = 0x00;
	do
	{
		Eq_276 eax_408 = edx_396->t0004;
		cui16 * ecx_414 = (char *) &edx_396->t0004 + 0x04;
		if (eax_408 - 0x08 >> 0x01 > 0x00)
		{
			uint32 esi_549 = eax_408 - 0x08 >> 0x01;
			do
			{
				if ((*ecx_414 & 0xF000) == 0x3000)
				{
					struct Eq_427 * eax_570 = ((word32) *ecx_414 & 0x0FFF) + edx_396->dw0000;
					eax_570->dw401010 = eax_570->dw401010 + 0xF0401010;
				}
				ecx_414 = ecx_414 + 0x01;
				esi_549 = esi_549 - 0x01;
			} while (esi_549 != 0x00);
		}
		Eq_276 eax_421 = edx_396->t0004;
		up32 ecx_423 = (word32) eax_421.u0 + dwLoc0240_401;
		edx_396 = edx_396 + eax_421;
		dwLoc0240_401 = ecx_423;
	} while (ecx_423 < 228);
	struct Eq_308 * ebx_428 = &globals->t401D6C;
	ebx_456 = ebx_428;
	esp_458 = esp_355;
	if (globals->dw401D7C != 0x00)
	{
		do
		{
			struct Eq_308 * ebx_456;
			struct Eq_237 * esp_458;
			struct Eq_346 * esp_462 = esp_458 - 0x04;
			esp_462->t0000 = ebx_456->dw000C + 0x00401010;
			Eq_357 eax_464 = LoadLibraryA(esp_462->t0000);
			*(esp_462 - 0x04) = 0x62;
			esp_462->t0010 = eax_464;
			CloseHandle(*(esp_462 - 0x04));
			esp_458 = esp_462 - 0x04;
			if (eax_464 != null)
			{
				struct Eq_395 * edi_489 = ebx_456->dw0000;
				if (edi_489 == null)
					edi_489 = ebx_456->dw0010;
				Eq_401 eax_495 = edi_489->t401010;
				union Eq_405 * edi_497 = &edi_489->t401010;
				word32 * esi_498 = ebx_456->dw0010 + 0x00401010;
				bool S_501 = cond(eax_495);
				if (eax_495 != 0x00)
				{
					do
					{
						if (!S_501)
						{
							word32 eax_536 = esp_458[0x04];
							word32 * esp_537 = esp_458 - 0x04;
							*esp_537 = (word32) *edi_497;
							*(esp_537 - 0x04) = eax_536;
						}
						else
						{
							word32 edx_541 = esp_458[0x04];
							word32 * esp_544 = esp_458 - 0x04;
							*esp_544 = (word32) eax_495 + 0x00401012;
							*(esp_544 - 0x04) = edx_541;
						}
						esp_458 = esp_458 - 0x08;
						*esi_498 = (word32) GetProcAddress(esp_458->t0000, esp_458[0x01]);
						edi_497 = (union Eq_405 *) ((char *) edi_497 + 0x04);
						eax_495 = *edi_497;
						esi_498 = esi_498 + 0x01;
						S_501 = cond(eax_495);
					} while (eax_495 != 0x00);
					ebx_456 = (struct Eq_308 *) esp_458[0x05];
				}
			}
			ebx_456 = ebx_456 + 0x01;
			esp_458[0x05] = (struct Eq_237) ebx_456;
		} while (ebx_456->dw0010 != 0x00);
	}
	ptr32 esp_435;
	byte SCZO_436;
	word32 ebx_437;
	word32 ebp_438;
	word32 esi_439;
	word32 edi_440;
	byte SZO_441;
	byte C_442;
	word32 eax_443;
	byte Z_444;
	word32 ecx_445;
	byte cl_446;
	word32 edx_447;
	word16 ax_448;
	byte S_449;
	globals->t401A60();
	*(esp_435 - 0x04) = 0x00;
	ExitProcess(*(esp_435 - 0x04));
}

