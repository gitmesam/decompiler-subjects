// subject.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

// 00401000: Register Eq_2 Win32CrtStartup()
DWORD Win32CrtStartup()
{
	struct Eq_3 * edx_15;
	word32 ecx_16 = fn00401078(globals->a401131, (Eq_110 (*)[]) 0x063C, out edx_15);
	fn00401131(ecx_16, edx_15, ebx, fp - 0x04, esi, edi, es, ds, dwLoc20, rArg0);
	word32 edx_43;
	fn00401078(globals->a401131, (Eq_110 (*)[]) 0x063C, out edx_43);
	if (false)
		lstrcpyA(&globals->t401000, &globals->t405000);
	return 0x00;
}

// 00401078: Register (ptr32 (arr Eq_110)) fn00401078(Stack (ptr32 (arr Eq_110)) dwArg04, Stack (ptr32 (arr Eq_110)) dwArg08, Register out ptr32 edxOut)
Eq_110 * fn00401078[](Eq_110 * dwArg04[], Eq_110 * dwArg08[], ptr32 & edxOut)
{
	*edxOut = edx;
	Eq_110 (* dwLoc08_22)[] = null;
	while (dwLoc08_22 < dwArg08)
	{
		if (dwLoc08_22 > null && (dwLoc08_22 & 0x01) == 0x00)
		{
			word32 eax_120 = dwLoc08_22 + dwArg04;
			Mem127[dwArg04 + dwLoc08_22:byte] = (byte) (DPB(eax_120, *eax_120, 0) ^ 0x3D);
		}
		if (dwLoc08_22 > (Eq_110 (*)[]) 0x01)
		{
			word32 eax_104 = dwLoc08_22 + dwArg04;
			Mem110[dwArg04 + dwLoc08_22:byte] = (byte) (DPB(eax_104, *eax_104, 0) + 0x08);
		}
		if (dwLoc08_22 > (Eq_110 (*)[]) 0x02 && (dwLoc08_22 - (Eq_110 (*)[]) 0x02 & 0x01) == 0x00)
		{
			Eq_110 eax_93[] = dwLoc08_22 + dwArg04;
			Mem99[dwArg04 + dwLoc08_22:byte] = (byte) (DPB(eax_93, eax_93[0x00].t0000, 0) - (Eq_110 (*)[]) 0x57);
		}
		ecx = (Eq_110 (*)[]) 0x03;
		int32 edx_52 = (int32) (SEQ(dwLoc08_22 >> 0x1F, dwLoc08_22) % 0x03);
		*edxOut = edx_52;
		if (edx_52 == 0x00)
		{
			ecx = dwArg04 + dwLoc08_22;
			Mem82[ecx + 0x00:byte] = Mem0[dwLoc08_22 + dwArg04:byte] - (byte) dwLoc08_22;
			word32 edx_75;
			*edxOut = dwLoc08_22;
		}
		dwLoc08_22 = dwLoc08_22 + 0x01;
	}
	return ecx;
}

// 00401131: FpuStack real64 fn00401131(Register word32 ecx, Register (ptr32 Eq_3) edx, Register (ptr32 Eq_18) ebx, Register (ptr32 Eq_19) ebp, Register Eq_20 esi, Register (ptr32 byte) edi, Register (ptr16 Eq_22) es, Register (ptr16 Eq_23) ds, Stack word32 dwArg00, FpuStack real64 rArg0)
real64 fn00401131(word32 ecx, Eq_3 * edx, Eq_18 * ebx, Eq_19 * ebp, Eq_20 esi, byte * edi, Eq_22 * es, Eq_23 * ds, word32 dwArg00, real64 rArg0)
{
	word64 edx_eax_7 = fp - 0x04;
	cu8 al_8 = (byte) (fp - 0x04);
	word16 ax_9 = (word16) (fp - 0x04);
	if (!SO)
		*(esi - 0x08) = *(esi - 0x08) & 114;
	byte al_11 = al_8 + 0x61;
	ptr32 eax_12 = DPB(fp - 0x04, al_8 + 0x61, 0);
	word64 edx_eax_13 = DPB(edx_eax_7, al_8 + 0x61, 0);
	word16 ax_14 = DPB(ax_9, al_8 + 0x61, 0);
	if (al_8 <= 0x61)
	{
		__lock();
		byte v18_29 = edx->bF75BF60A - dl;
		edx->bF75BF60A = v18_29;
		byte SCZO_31 = cond(v18_29);
		word32 * esp_123 = dwArg00 + 0x04;
		bool C_193 = (bool) SCZO_31;
		bool Z_196 = (bool) SCZO_31;
		word32 * eax_187 = DPB(eax_12, FPUF, 8);
		uint64 edx_eax_188 = DPB(edx_eax_13, FPUF, 8);
		word16 ax_191 = DPB(ax_14, FPUF, 8);
		struct Eq_197 * ecx_176 = ecx - 0x01;
		if (v18_29 == 0x00 && ecx != 0x01)
		{
			*edi = __in(dx);
l004011A7:
			(byte *) 0x72FE47E0 = (byte *) al_11;
			do
			{
				if (C_193)
				{
					if (false)
						*(esp_123 - 0x02) = (struct Eq_23 **) ds;
					ecx_176 = ecx_176 - 0x01;
					if ((edi + 0x01 & esi) == 0x00 && ecx_176 != 0x00)
					{
						do
							;
						while ((ebx->dw0000 & 443605320) >= 0x00);
						(byte *) 1996377561 = (byte *) al_11;
						__outw(dx, ax_191);
						bool C_215 = false;
						do
							;
						while (OVERFLOW(ebx->dw0000 & 443605320));
						if (true)
						{
							ebp->b0005 = ebp->b0005 & ~0x41;
							dx_266 = dx;
							dl_267 = dl;
							esi_268 = esi;
							do
							{
								word16 dx_266;
								byte dl_267;
								Eq_20 esi_268;
								Mem272[~0x1F14419E:word32] = Mem263[~0x1F14419E:word32] + esi_268;
								int32 eax_273 = __indw(dx_266);
								struct Eq_415 * edi_276 = *esp_123;
								__outb(dx_266, (byte) eax_273);
								edi_276->a8FF755F6[eax_273] = edi_276->a8FF755F6[eax_273] - dl_267;
								uint64 edx_eax_284 = DPB(edx_eax_188, __inb(0x50), 0);
								uint64 edx_eax_288 = SEQ((uint32) (edx_eax_284 % (uint32 *) ~0x1F144212), (uint32) (edx_eax_284 /u (uint32 *) ~0x1F144212));
								ebp->b005F = ebp->b005F - ~0x41;
								struct Eq_459 * edx_292 = (uint32) (edx_eax_288 % (bu8 *) ~0x1F144175);
								uint32 eax_296 = (uint32) (edx_eax_288 /u (bu8 *) ~0x1F144175);
								int32 edi_302 = edx_292->dw007D *s 0x03;
								esi_268 = ~0x088F0C15 - (word32 *) ~0x1F14419E;
								*((word32) esi_268 - 0x088FDC17) = 177;
								cu8 v49_305 = es->*((word32) esi_268 - 0x08500983) - ~0x41;
								es->*((word32) esi_268 - 0x08500983) = v49_305;
								(uint32 *) ~0x08551516 = eax_296;
								esp_123 = esp_123 + 0x04;
								dl_267 = (byte) edx_292;
								dx_266 = (word16) edx_292;
								edx_eax_188 = (uint64) eax_296;
							} while (v49_305 >= 0x00);
							*(ebp - 0x51) = *(ebp - 0x51) - ~0x41;
							uint32 eax_314 = (uint32) (edx_eax_188 /u (bu8 *) ~0x1F14414B);
							C_215 = (bool) cond(eax_314);
							do
								*((word32) esi_268 + 1349577751) = edi_302;
							while (eax_314 >= 0x00);
						}
						*(esp_123 * 0x02 + C_215 - 0x04) = ~0x1B;
						word32 esp_229;
						word32 ebp_230;
						word32 eax_231;
						byte SO_232;
						word32 esi_233;
						byte SZO_234;
						bool C_235;
						byte cl_236;
						byte dh_237;
						byte al_238;
						byte SCZO_239;
						byte CZ_240;
						bool D_241;
						word32 edx_242;
						byte dl_243;
						byte ah_244;
						bool FPUF_245;
						real64 rLoc1_246;
						word32 ecx_247;
						bool Z_248;
						word32 ebx_249;
						byte bh_250;
						word32 edi_251;
						word16 dx_252;
						word16 ax_253;
						bool P_254;
						word16 bx_255;
						bool S_256;
						bool O_257;
						real64 rArg0_258;
						byte CZP_259;
						struct Eq_390 * es_260;
						struct Eq_391 * ds_261;
						fn7437A576();
						return rArg0_258;
					}
					else
					{
						uint64 edx_eax_180 = &(edx->*esp_123);
						edx = (uint32) (edx_eax_180 % ebx->b006C);
						eax_187 = (uint32) (edx_eax_180 /u ebx->b006C);
						byte SCZO_192 = cond(eax_187);
						esp_123 = eax_187;
						dl = (byte) edx;
						dx = (word16) edx;
						edx_eax_188 = (uint64) &(edx->*eax_187);
						al_11 = (byte) eax_187;
						ax_191 = (word16) eax_187;
						C_193 = (bool) SCZO_192;
						Z_196 = (bool) SCZO_192;
						goto l004011A7;
					}
				}
				esp_123 = (word32 *) 4192829932;
			} while (Z_196);
			__outw(dx, ax_191);
			if (P)
			{
				word32 esp_134;
				word32 ebp_135;
				word32 eax_136;
				byte SO_137;
				word32 esi_138;
				byte SZO_139;
				bool C_140;
				byte cl_141;
				byte dh_142;
				byte al_143;
				byte SCZO_144;
				byte CZ_145;
				bool D_146;
				word32 edx_147;
				byte dl_148;
				byte ah_149;
				bool FPUF_150;
				real64 rLoc1_151;
				word32 ecx_152;
				bool Z_153;
				word32 ebx_154;
				byte bh_155;
				word32 edi_156;
				word16 dx_157;
				word16 ax_158;
				bool P_159;
				word16 bx_160;
				bool S_161;
				bool O_162;
				real64 rArg0_163;
				byte CZP_164;
				struct Eq_260 * es_165;
				struct Eq_261 * ds_166;
				fn74374CD1();
				return rArg0_163;
			}
			else
			{
				(word32 *) 4192829928 = *(ebp - 0x09);
				__indw(~0x07);
				__arpl(ecx_176->w0000, bx, &ecx_176->w0000);
			}
		}
		else
			ebp->b0060 = ebp->b0060 - bh;
	}
}

