// subject.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

// 00401000: Register Eq_2 fn00401000(Register Eq_2 eax, Register word32 ecx, Register (ptr Eq_4) ebp, Register Eq_5 esi, Stack Eq_2 tArg04, Stack Eq_7 tArg08, Stack Eq_2 tArg0C, Stack Eq_2 tArg10, Register out ptr32 ebpOut)
Eq_2 fn00401000(Eq_2 eax, word32 ecx, Eq_4 * ebp, Eq_5 esi, Eq_2 tArg04, SIZE_T tArg08, Eq_2 tArg0C, Eq_2 tArg10, ptr32 & ebpOut)
{
	*(v3 - 0x04) = (struct Eq_4 **) ebp;
	*(v3 - 0x08) = ecx;
	*(v3 - 0x0C) = (union Eq_5 *) esi;
	*(v3 - 0x60) = 0x00;
	*(v3 - 0x10) = v3 - 0x60;
	*(v3 - 0x14) = v3 - 0x60;
	*(v3 - 0x18) = v3 - 0x60;
	*(v3 - 0x1C) = v3 - 0x60;
	*(v3 - 0x20) = v3 - 0x60;
	*(v3 - 0x24) = v3 - 0x60;
	*(v3 - 0x28) = v3 - 0x60;
	ptr32 esp_30;
	word32 edi_31;
	ptr32 ebp_32;
	int32 ecx_33;
	word32 esi_34;
	ui32 edx_35;
	word32 eax_36;
	byte SZO_37;
	byte C_38;
	byte SCZO_39;
	byte Z_40;
	word32 ebx_41;
	byte dl_42;
	byte bl_43;
	byte al_44;
	WS2_32.dll!WSAConnect();
	ui32 edx_46 = edx_35 & eax_36 + 0x01;
	*(ebp_32 - 0x04) = *(ebp_32 - 0x04) & edx_46;
	*(ebp_32 - 0x08) = *(ebp_32 - 0x08) & edx_46;
	*(esp_30 - 0x04) = edx_46;
	*(ebp_32 - 0x0C) = *(ebp_32 - 0x0C) & edx_46;
	*(esp_30 - 0x08) = eax_36 + 0x01;
	*(esp_30 - 0x0C) = eax_36 + 0x01;
	*(ebp_32 - 0x0C) = *(ebp_32 - 0x0C) + (ecx_33 *s 0x00 - 0x01);
	*(ebp_32 - 0x5C) = 0x00;
	*(esp_30 - 0x10) = ebp_32 - 0x5C;
	*(esp_30 - 0x14) = ebp_32 - 0x5C;
	*(esp_30 - 0x18) = ebp_32 - 0x5C;
	*(esp_30 - 0x1C) = ebp_32 - 0x5C;
	*(esp_30 - 0x20) = ebp_32 - 0x5C;
	*(esp_30 - 0x24) = ebp_32 - 0x5C;
	*(esp_30 - 0x28) = ebp_32 - 0x5C;
	word32 esp_83;
	word32 edi_84;
	struct Eq_4 * ebp_85;
	word32 ecx_86;
	word32 esi_87;
	word32 edx_88;
	word32 eax_89;
	byte SZO_90;
	byte C_91;
	byte SCZO_92;
	byte Z_93;
	word32 ebx_94;
	byte dl_95;
	byte bl_96;
	byte al_97;
	WS2_32.dll!WSAConnect();
	if (eax_89 != 0x01)
		return VirtualAlloc(tArg04, tArg08, tArg0C, tArg10);
	word32 ebp_112;
	return fn00401067(eax_89 + 0x01, ebp_85, out ebp_112);
}

// 00401067: Register Eq_2 fn00401067(Register Eq_2 eax, Register (ptr Eq_4) ebp, Register out ptr32 ebpOut)
Eq_2 fn00401067(Eq_2 eax, Eq_4 * ebp, ptr32 & ebpOut)
{
	uint32 edi_5 = ebp->dw0010;
	if (*(ebp - 0x08) < edi_5)
	{
		ui32 eax_55 = -*(ebp - 0x0C);
		Mem58[ebp - 0x14 + 0x00:word32] = ~Mem0[(eax & 0x00) + Mem0[ebp + 0x0C:word32] + Mem0[(ebp - 0x08) + 0x00:word32]:word32];
		ui32 eax_60 = ~(eax_55 - 0x01 | *(ebp - 0x14));
		ui32 edx_63 = ebp->ptr0014 + *(ebp - 0x04);
		*(ebp - 0x14) = 0xFF;
		ui32 ebx_70 = edx_63 & *(ebp - 0x14);
		*(ebp - 0x14) = ~0x00;
		ui32 ebx_74 = ebx_70 ^ *(ebp - 0x14);
		ui32 ebx_82 = ebx_74 + 0x01 & 0x00 ^ ebp->dw0008;
		*(ebp - 0x08) = -*(ebp - 0x08);
		Eq_2 ebx_85 = ebx_82 - *(ebp - 0x08);
		*(ebp - 0x10) = *(ebp - 0x10) & 0x00;
		*(ebp - 0x10) = *(ebp - 0x10) | ebx_85;
		word32 ebx_96 = DPB(*ebx_85, (byte) ((eax_60 & 0xFF) + (ebx_74 + 0x01)), 0);
		*(ebp - 0x08) = -*(ebp - 0x08);
		*(v3 - 0x04) = 0x00;
		*ebx_85 = *(v3 - 0x04);
		*(v3 - 0x04) = (union Eq_2 *) ebx_85;
		*ebx_85 = (byte) fn00401420() + ((word32) (*ebx_85) + -ebx_96);
		ui32 edx_118 = *ebx_85 ^ *(ebp - 0x14);
		*ebx_85 = edx_118 + 0x01;
		ui32 edi_126 = (edi_5 & 0x00) + *(ebp - 0x04);
		*(ebp - 0x04) = edi_126 + 0x01;
		eax = ebx_85;
		if (edi_126 == 0x00)
			*(ebp - 0x04) = *(ebp - 0x04) & 0x00;
		if (*(ebp - 0x04) != 0x9A)
		{
			word32 ebp_136;
			return fn00401330(ebx_85, edx_118 + 0x01, ebp, out ebp_136);
		}
	}
	word32 ebp_42;
	*ebpOut = ebp->dw0000;
	return eax;
}

// 00401128: Register Eq_2 Win32CrtStartup()
Eq_2 Win32CrtStartup()
{
}

// 00401330: Register Eq_2 fn00401330(Register Eq_2 eax, Register int32 edx, Register (ptr Eq_4) ebp, Register out ptr32 ebpOut)
Eq_2 fn00401330(Eq_2 eax, int32 edx, Eq_4 * ebp, ptr32 & ebpOut)
{
	*(v3 - 0x04) = (union Eq_2 *) eax;
	ui32 ebx_11 = *(ebp - 0x08) - *(ebp - 0x0C);
	*(ebp - 0x08) = *(ebp - 0x08) & edx *s 0x00;
	*(ebp - 0x08) = *(ebp - 0x08) | ebx_11;
	word32 ebp_21;
	return fn00401067(eax, ebp, out ebp_21);
}

// 004013B6: Register (ptr Eq_4) fn004013B6(Register word32 ecx, Register (ptr Eq_4) ebp, Register Eq_5 esi)
Eq_4 * fn004013B6(word32 ecx, Eq_4 * ebp, Eq_5 esi)
{
	if (false)
		return fn004013C1(0x00, ecx, ebp, esi);
	struct Eq_4 * ebp_15;
	fn00401000(0x00, ecx, ebp, esi, tArg04, tArg08, tArg0C, tArg10, out ebp_15);
	return ebp_15;
}

// 004013C1: Register (ptr Eq_4) fn004013C1(Register Eq_2 eax, Register word32 ecx, Register (ptr Eq_4) ebp, Register Eq_5 esi)
Eq_4 * fn004013C1(Eq_2 eax, word32 ecx, Eq_4 * ebp, Eq_5 esi)
{
	if (true)
	{
		struct Eq_4 * ebp_65;
		fn00401000(eax, ecx, ebp, esi, tArg04, tArg08, tArg0C, tArg10, out ebp_65);
		return ebp_65;
	}
	else
	{
		word32 edi_28 = *(ebp - 0x08) + -~0x152F;
		*(ebp - 0x14) = *(ebp - 0x14) & 0x00;
		*(ebp - 0x14) = *(ebp - 0x14) + edi_28;
		*(ebp - 0x08) = -*(ebp - 0x08);
		return ebp;
	}
}

// 00401420: FlagGroup bool fn00401420()
bool fn00401420()
{
	return false;
}

