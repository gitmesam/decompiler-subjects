// subject.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

// 00401000: void fn00401000(Register word32 ecx, Register word32 edx)
void fn00401000(word32 ecx, word32 edx)
{
	word32 eax_6 = Mem0[Mem0[edx + 0x3C:word32] + edx + 0x78:word32];
	if (eax_6 != 0x00)
	{
		word32 eax_28 = eax_6 + edx;
		Mem31[eax_28 + 0x1C:word32] = Mem0[eax_28 + 0x1C:word32] + ecx;
		Mem33[eax_28 + 0x24:word32] = Mem31[eax_28 + 0x24:word32] + ecx;
		Mem35[eax_28 + 0x20:word32] = Mem33[eax_28 + 0x20:word32] + ecx;
		Mem37[eax_28 + 0x0C:word32] = Mem35[eax_28 + 0x0C:word32] + ecx;
		word32 edi_43 = Mem37[eax_28 + 0x1C:word32] + edx;
		word32 esi_44 = 0x00;
		if (Mem37[eax_28 + 0x14:word32] >u 0x00)
		{
			do
			{
				edi_43[esi_44 * 0x04] = edi_43[esi_44 * 0x04] + ecx;
				esi_44 = esi_44 + 0x01;
			} while (esi_44 <u Mem68[eax_28 + 0x14:word32]);
		}
		word32 esi_49 = Mem37[eax_28 + 0x20:word32] + edx;
		word32 edx_50 = 0x00;
		if (Mem37[eax_28 + 0x18:word32] >u 0x00)
		{
			do
			{
				esi_49[edx_50 * 0x04] = esi_49[edx_50 * 0x04] + ecx;
				edx_50 = edx_50 + 0x01;
			} while (edx_50 <u Mem62[eax_28 + 0x18:word32]);
		}
	}
}

// 00401067: Register word32 fn00401067(Register byte ah, Register word32 ebp, Stack word32 dwArg04, Register out ptr32 clOut, Register out ptr32 chOut)
word32 fn00401067(byte ah, word32 ebp, word32 dwArg04, ptr32 & clOut, ptr32 & chOut)
{
}

// 0040112F: Register word32 fn0040112F(Register word32 ebp, Stack word32 dwArg04, Stack word32 dwArg08, Stack word32 dwArg10)
word32 fn0040112F(word32 ebp, word32 dwArg04, word32 dwArg08, word32 dwArg10)
{
	word32 eax_22;
	word32 ebp_134 = fp - 0x04;
	word32 esp_15 = fp - 0x80;
	if (dwArg10 != 0x00)
		eax_22 = dwArg04;
	else
	{
		esp_15 = fp - 0x84;
		eax_22 = GetModuleHandleA(0x00);
	}
	word32 esp_24 = esp_15 - 0x04;
	Mem25[esp_24 + 0x00:word32] = 0x40;
	Mem27[esp_24 - 0x04 + 0x00:word32] = 0x00;
	Mem29[esp_24 - 0x08 + 0x00:word32] = 0x00;
	Mem31[esp_24 - 0x0C + 0x00:word32] = 0x00;
	Mem33[esp_24 - 0x10 + 0x00:word32] = 220;
	Mem36[esp_24 - 0x14 + 0x00:word32] = eax_22;
	word32 eax_38 = LoadImageA(Mem36[esp_24 - 0x14 + 0x00:HINSTANCE], Mem36[esp_24 - 0x10 + 0x00:LPCSTR], Mem36[esp_24 - 0x0C + 0x00:UINT], Mem36[esp_24 - 0x08 + 0x00:int32], Mem36[esp_24 - 0x04 + 0x00:int32], Mem36[esp_24 + 0x00:UINT]);
	word32 esp_135 = esp_24 - 0x14;
	word32 eax_41 = GetLastError();
	if (eax_38 != 0x00 || eax_41 != 1812 && eax_41 != 1813)
	{
		Mem596[esp_24 - 0x18 + 0x00:word32] = eax_41;
		Mem601[esp_24 + ~0x47:word32] = 11;
		word32 ecx_602 = Mem601[esp_24 + ~0x47:word32];
		word32 edi_607 = esp_24 + ~0x43;
		word32 esi_608 = fp - 116;
		while (ecx_602 != 0x00)
		{
			Mem617[edi_607 + 0x00:word32] = Mem601[esi_608 + 0x00:word32];
			esi_608 = esi_608 + 0x04;
			edi_607 = edi_607 + 0x04;
			ecx_602 = ecx_602 - 0x01;
		}
		byte SCZO_634;
		word32 ebx_635;
		byte SZO_636;
		byte C_637;
		word32 esi_638;
		word32 edi_639;
		byte Z_640;
		word32 eax_641;
		word32 ecx_642;
		word32 edx_643;
		byte CZ_644;
		word16 ax_645;
		word16 cx_646;
		byte ch_647;
		byte bl_648;
		byte bh_649;
		byte cl_650;
		byte dl_651;
		byte dh_652;
		byte ah_653;
		0x94994887();
	}
	word32 eax_155;
	if (dwArg10 != 0x00 && dwArg08 != 0x01)
	{
l0040144A:
		word32 esp_143 = esp_135 - 0x04;
		Mem144[esp_143 + 0x00:word32] = Mem36[ebp_134 + 0x10:word32];
		Mem148[esp_143 - 0x04 + 0x00:word32] = Mem144[ebp_134 + 0x0C:word32];
		Mem151[esp_143 - 0x08 + 0x00:word32] = Mem148[ebp_134 + 0x08:word32];
		Mem154[esp_143 - 0x0C + 0x00:word32] = Mem151[ebp_134 + 0x14:word32];
		eax_155 = CreateEventW(Mem154[esp_143 - 0x0C + 0x00:LPSECURITY_ATTRIBUTES], Mem154[esp_143 - 0x08 + 0x00:BOOL], Mem154[esp_143 - 0x04 + 0x00:BOOL], Mem154[esp_143 + 0x00:LPCWSTR]);
		return eax_155;
	}
	word32 ebx_159 = fn00401996(ebp_134, fp - 116);
	word32 esp_160 = esp_135 - 0x04;
	Mem161[esp_160 + 0x00:word32] = 0x40;
	Mem163[esp_160 - 0x04 + 0x00:word32] = 0x3000;
	Mem167[esp_160 - 0x08 + 0x00:word32] = dwLoc68;
	Mem170[esp_160 - 0x0C + 0x00:word32] = ebx_159;
	word32 eax_171 = VirtualAlloc(Mem170[esp_160 - 0x0C + 0x00:LPVOID], Mem170[esp_160 - 0x08 + 0x00:SIZE_T], Mem170[esp_160 - 0x04 + 0x00:DWORD], Mem170[esp_160 + 0x00:DWORD]);
	if (eax_171 == ebx_159)
	{
l004011E7:
		eax_155 = 0x00;
		return eax_155;
	}
	word32 esi_228 = fn0040195A(eax_171, dwLoc70, dwLoc68);
	Mem233[esp_160 - 0x0C + 0x00:word32] = dwLoc54;
	Mem238[esp_160 - 0x10 + 0x00:word32] = dwLoc60;
	Mem240[esp_160 - 0x14 + 0x00:word32] = esi_228;
	fn004015D5(dwLoc68, dwArg00, dwArg04, dwArg08);
	Mem253[esp_160 - 0x0C + 0x00:word32] = dwLoc68 - dwLoc58 + esi_228;
	Mem256[esp_160 - 0x10 + 0x00:word32] = fp - 0x38;
	word32 edi_270 = fn00401466(ebp_134, eax_22);
	Mem274[esp_160 - 0x0C + 0x00:word32] = Mem256[ebp_134 - 0x68 + 0x00:word32];
	Mem276[esp_160 - 0x10 + 0x00:word32] = esi_228;
	word32 eax_277 = fn0040168F(edi_270, dwArg04);
	Mem280[ebp_134 - 0x20 + 0x00:word32] = eax_277;
	if (eax_277 == 0x00)
		goto l004011E7;
	word32 esi_285 = Mem280[eax_277 + 0x3C:word32];
	Mem287[ebp_134 - 0x14 + 0x00:word32] = Mem280[ebp_134 - 0x60 + 0x00:word32] + eax_277;
	word32 eax_288 = Mem287[ebp_134 - 0x70 + 0x00:word32];
	word32 ebx_290 = Mem287[eax_288 + 0x3C:word32] + eax_288;
	Mem297[ebp_134 - 0x18 + 0x00:word32] = (word32) Mem287[ebx_290 + 0x14:word16] + 0x18 + ebx_290;
	word32 esi_295 = esi_285 + eax_277;
	word32 eax_299 = (word32) Mem297[esi_295 + 0x14:word16] + 0x18 + esi_295;
	Mem301[esp_160 - 0x0C + 0x00:word32] = 706632649;
	Mem302[ebp_134 - 0x10 + 0x00:word32] = eax_299;
	Mem305[esp_160 - 0x10 + 0x00:word32] = fn0040192D();
	byte bl_291 = (byte) ebx_290;
	byte bh_292 = SLICE(ebx_290, byte, 8);
	byte cl_306;
	byte ch_307;
	byte dl_308;
	byte dh_309;
	word32 ebx_310;
	word32 ebp_311;
	word32 esi_312;
	word32 edi_313;
	word32 eax_314 = fn00401AC8(bl_291, bh_292, dwArg00, out cl_306, out ch_307, out dl_308, out dh_309, out ebx_310, out ebp_311, out esi_312, out edi_313);
	Mem317[esp_160 - 0x14 + 0x00:word32] = ebp_311 - 0x24;
	Mem319[esp_160 - 0x18 + 0x00:word32] = 0x04;
	Mem321[esp_160 - 0x1C + 0x00:word32] = 0x01;
	Mem323[esp_160 - 0x20 + 0x00:word32] = ebx_310;
	word32 esp_324;
	word32 ebp_325;
	byte SCZO_326;
	word32 ebx_327;
	byte SZO_328;
	byte C_329;
	word32 esi_330;
	word32 edi_331;
	byte Z_332;
	word32 eax_333;
	word32 ecx_334;
	word32 edx_335;
	byte CZ_336;
	word16 ax_337;
	word16 cx_338;
	byte ch_339;
	byte bl_340;
	byte bh_341;
	byte cl_342;
	byte dl_343;
	byte dh_344;
	byte ah_345;
	eax_314();
	Mem348[esp_324 - 0x04 + 0x00:word32] = Mem323[ebp_325 - 0x60 + 0x00:word32];
	Mem350[esp_324 - 0x08 + 0x00:word32] = edi_331;
	word32 ebx_351;
	word32 esi_353;
	word32 eax_354 = fn00401C1D(dh_344, dl_343, ebx_327, out ebx_351, out ebp_134, out esi_353);
	Mem356[ebp_134 - 0x04 + 0x00:word32] = eax_354;
	word32 edi_357 = eax_354 - Mem356[(ebp_134 - 0x70) + 0x00:word32];
	Mem361[ebp_134 - 0x1C + 0x00:word32] = edi_357;
	word32 esp_349 = esp_324 - 0x08;
	if (Mem361[ebp_134 + 0x14:word32] != 0x00)
	{
		word32 eax_582 = Mem361[esi_353 + 0x78:word32];
		if (eax_582 != 0x00)
		{
			Mem589[ebx_351 + 0x78:word32] = eax_582 + edi_357;
			Mem591[ebx_351 + 0x7C:word32] = Mem589[esi_353 + 0x7C:word32];
l004012F2:
			word32 ecx_367 = Mem361[esi_353 + 0x88:word32];
			if (ecx_367 != 0x00)
			{
				Mem553[ebx_351 + 0x88:word32] = ecx_367 + edi_357;
				word32 ecx_554 = Mem553[esi_353 + 0x8C:word32];
				word32 eax_555 = Mem553[ebx_351 + 0x88:word32];
				Mem556[ebx_351 + 0x8C:word32] = ecx_554;
				word32 eax_557 = eax_555 + Mem556[(ebp_134 - 0x70) + 0x00:word32];
				Mem560[esp_324 - 0x0C + 0x00:word32] = edi_357;
				Mem562[esp_324 - 0x10 + 0x00:word32] = eax_557;
				Mem564[esp_324 - 0x14 + 0x00:word32] = eax_557;
				word32 eax_569 = fn00401A52(ecx_554, edi_357, dwArg04, out ebx_351, out ebp_134, out esi_353, out edi_357);
				Mem574[ebx_351 + 0x50:word32] = (eax_569 | ~0x00) - Mem564[(ebp_134 - 0x70) + 0x00:word32];
				esp_349 = esp_324 - 0x04;
			}
			word32 eax_379 = Mem361[ebp_134 - 0x14 + 0x00:word32];
			word32 ecx_382 = Mem361[ebp_134 - 0x04 + 0x00:word32] - Mem361[esi_353 + 0x34:word32];
			Mem386[ebp_134 - 0x0C + 0x00:word32] = 0x00;
			byte ah_381 = SLICE(eax_379, byte, 8);
			if (Mem386[eax_379 + 0x00:word32] >u 0x00)
			{
				Mem533[ebp_134 - 0x08 + 0x00:word32] = eax_379 + 0x04;
				do
				{
					word32 eax_536 = Mem533[Mem533[ebp_134 - 0x08 + 0x00:word32] + 0x00:word32] + Mem533[(ebp_134 - 0x04) + 0x00:word32];
					Mem538[ebp_134 - 0x08 + 0x00:word32] = Mem533[ebp_134 - 0x08 + 0x00:word32] + 0x03;
					Mem540[ebp_134 - 0x08 + 0x00:word32] = Mem538[ebp_134 - 0x08 + 0x00:word32] - ~0x00;
					Mem542[eax_536 + 0x00:word32] = Mem540[eax_536 + 0x00:word32] + ecx_382;
					Mem544[ebp_134 - 0x0C + 0x00:word32] = Mem542[ebp_134 - 0x0C + 0x00:word32] + 0x01;
					word32 eax_545 = Mem544[ebp_134 - 0x14 + 0x00:word32];
					ah_381 = SLICE(eax_545, byte, 8);
				} while (Mem544[ebp_134 - 0x0C + 0x00:word32] <u Mem544[eax_545 + 0x00:word32]);
			}
			word32 esp_394 = esp_349 - 0x04;
			Mem395[esp_394 + 0x00:word32] = Mem386[ebp_134 - 0x04 + 0x00:word32];
			byte ch_397;
			byte cl_396;
			if (fn00401067(ah_381, ebp_134, dwArg00, out cl_396, out ch_397) != 0x00)
			{
				if (Mem395[ebp_134 + 0x14:word32] != 0x00)
				{
					fn00401000(edi_357, Mem395[ebp_134 - 0x70 + 0x00:word32]);
					ch_397 = SLICE(edi_357, byte, 8);
					cl_396 = (byte) edi_357;
				}
				Mem412[esp_394 + 0x00:word32] = Mem395[ebp_134 - 0x04 + 0x00:word32];
				if (fn00401713(Mem412[ebp_134 - 0x04 + 0x00:word32], cl_396, ch_397, ebp_134) != 0x00)
				{
					word32 edi_419 = Mem412[ebp_134 - 0x70 + 0x00:word32];
					Mem420[ebp_134 - 0x44 + 0x00:byte] = 0x43;
					Mem421[ebp_134 - 0x43 + 0x00:byte] = 114;
					Mem422[ebp_134 - 66 + 0x00:byte] = 101;
					Mem423[ebp_134 - 0x41 + 0x00:byte] = 0x61;
					Mem424[ebp_134 - 0x40 + 0x00:byte] = 116;
					Mem425[ebp_134 - 0x3F + 0x00:byte] = 101;
					Mem426[ebp_134 - 0x3E + 0x00:byte] = 0x45;
					Mem427[ebp_134 - 0x3D + 0x00:byte] = 118;
					Mem428[ebp_134 - 0x3C + 0x00:byte] = 101;
					Mem429[ebp_134 - 0x3B + 0x00:byte] = 110;
					Mem430[ebp_134 - 0x3A + 0x00:byte] = 116;
					Mem431[ebp_134 - 0x39 + 0x00:byte] = 0x57;
					Mem432[ebp_134 - 0x38 + 0x00:byte] = 0x00;
					Mem437[esp_394 + 0x00:word32] = Mem432[esi_353 + 0x28:word32] + Mem432[(ebp_134 - 0x04) + 0x00:word32];
					Mem440[esp_394 - 0x04 + 0x00:word32] = ebp_134 - 0x44;
					fn00401466(ebp_134, edi_419);
					word16 ax_444 = (word16) (word32) Mem440[esi_353 + 0x06:word16];
					Mem449[ebx_351 + 0x06:word16] = ax_444;
					word32 edx_446 = 0x00;
					if (0x00 <u ax_444)
					{
						do
						{
							word32 eax_480 = Mem449[ebp_134 - 0x18 + 0x00:word32];
							word32 esi_483 = Mem449[ebp_134 - 0x10 + 0x00:word32];
							Mem485[ebp_134 - 0x10 + 0x00:word32] = Mem449[ebp_134 - 0x10 + 0x00:word32] + 0x05;
							Mem487[ebp_134 - 0x10 + 0x00:word32] = Mem485[ebp_134 - 0x10 + 0x00:word32] + 0x23;
							word32 esp_489 = esp_349 - 0x04;
							Mem490[esp_489 + 0x00:word32] = 0x0A;
							word32 edi_491 = eax_480;
							word32 ecx_492 = Mem490[esp_489 + 0x00:word32];
							while (ecx_492 != 0x00)
							{
								Mem504[edi_491 + 0x00:word32] = Mem490[esi_483 + 0x00:word32];
								esi_483 = esi_483 + 0x04;
								edi_491 = edi_491 + 0x04;
								ecx_492 = ecx_492 - 0x01;
							}
							Mem514[eax_480 + 0x0C:word32] = Mem490[eax_480 + 0x0C:word32] + Mem490[(ebp_134 - 0x1C) + 0x00:word32];
							Mem518[ebp_134 - 0x18 + 0x00:word32] = eax_480 - ~0x27;
							edx_446 = edx_446 + 0x01;
						} while (edx_446 <u (word32) Mem518[ebx_351 + 0x06:word16]);
					}
					word32 esp_466 = esp_349 - 0x04;
					Mem467[esp_466 + 0x00:word32] = 0x8000;
					Mem469[esp_466 - 0x04 + 0x00:word32] = 0x00;
					Mem472[esp_466 - 0x08 + 0x00:word32] = Mem469[ebp_134 - 0x20 + 0x00:word32];
					VirtualFree(Mem472[esp_466 - 0x08 + 0x00:LPVOID], Mem472[esp_466 - 0x04 + 0x00:SIZE_T], Mem472[esp_466 + 0x00:DWORD]);
					esp_135 = esp_466 - 0x08;
					goto l0040144A;
				}
			}
			goto l004011E7;
		}
	}
	Mem580[ebx_351 + 0x78:word32] = 0x00;
	Mem581[ebx_351 + 0x7C:word32] = 0x00;
	goto l004012F2;
}

// 00401466: Register word32 fn00401466(Register word32 ebp, Register word32 edi)
word32 fn00401466(word32 ebp, word32 edi)
{
}

// 0040153A: Register word32 fn0040153A(Register word32 edx)
word32 fn0040153A(word32 edx)
{
	word32 esi_17 = 0x00;
	word32 eax_11 = fn00401901(edx);
	while (Mem0[edx + 0x00:byte] != 0x00)
	{
		esi_17 = esi_17 *s 65599 + (word32) Mem0[edx + 0x00:word16];
		edx = edx + 0x01;
	}
	if (esi_17 < 0x00)
		esi_17 = esi_17 & 0x7FFF0000 | eax_11 + 0x5BBB;
	return esi_17;
}

// 00401584: void fn00401584(Stack word32 dwArg04, Stack word32 dwArg08, Stack word32 dwArg0C)
void fn00401584(word32 dwArg04, word32 dwArg08, word32 dwArg0C)
{
	if (dwArg08 >=u 0x04)
	{
		word32 esi_36 = dwArg04;
		word32 edi_37 = dwArg04;
		word32 ecx_40 = dwArg08 - 0x03;
		word32 edx_43 = dwArg0C;
		do
		{
			Mem52[edi_37 + 0x00:word32] = Mem0[esi_36 + 0x00:word32] ^ edx_43;
			esi_36 = esi_36 + 0x01;
			edi_37 = edi_37 + 0x01;
			edx_43 = __ror(edx_43 + ecx_40, 0x0D);
			ecx_40 = ecx_40 - 0x01;
		} while (ecx_40 != 0x00);
	}
}

// 004015D5: void fn004015D5(Register word32 ebx, Stack word32 dwArg04, Stack word32 dwArg08, Stack word32 dwArg0C)
void fn004015D5(word32 ebx, word32 dwArg04, word32 dwArg08, word32 dwArg0C)
{
	word32 edi_20 = fp - 0x010C;
	word32 ecx_21 = 0x0100;
	while (ecx_21 != 0x00)
	{
		Mem25[edi_20 + 0x00:byte] = 0x00;
		edi_20 = edi_20 + 0x01;
		ecx_21 = ecx_21 - 0x01;
	}
	word32 edi_135 = dwArg04;
	do
	{
		byte al_46 = (byte) fn0040181B();
		word32 esi_47 = (word32) al_46;
		word32 eax_49 = fp - 0x010C + esi_47;
		if (Mem0[eax_49 + 0x00:byte] == 0x00)
		{
			Mem105[eax_49 + 0x00:byte] = 0x01;
			fn00401584(dwArg04, ebx, esi_47);
			word32 ecx_107 = dwArg04;
			word32 edx_108 = ebx;
			word32 eax_109 = 1207949762;
			do
			{
				eax_109 = eax_109 *s 33 ^ (word32) Mem105[ecx_107 + 0x00:byte];
				ecx_107 = ecx_107 + 0x01;
				edx_108 = edx_108 - 0x01;
			} while (edx_108 != 0x00);
			fn00401584(dwArg04, ebx, esi_47);
			edi_135 = eax_109;
			bLoc05 = al_46;
		}
	} while (edi_135 != dwArg0C);
	fn00401584(dwArg04, ebx, (word32) bLoc05);
	fn00401584(dwArg04, ebx, dwArg08);
}

// 0040168F: Register word32 fn0040168F(Register word32 edi, Stack word32 dwArg08)
word32 fn0040168F(word32 edi, word32 dwArg08)
{
	word32 esp_27 = fp - 0x24;
	word32 eax_30 = CreateEventA(edi, VirtualAlloc(0x00, dwArg08, 0x3000, 0x40), 0x00, dwArg08);
	if (eax_30 != 0x40 || eax_30 == ~0x00)
		VirtualFree(Mem88[esp_66 + 0x00:LPVOID], Mem89[esp_66 + 0x04:SIZE_T], Mem90[esp_66 + 0x08:DWORD]);
	word32 esp_39 = esp_27 - 0x04;
	Mem40[esp_39 + 0x00:word32] = 0x8000;
	Mem42[esp_39 - 0x04 + 0x00:word32] = 0x00;
	Mem45[esp_39 - 0x08 + 0x00:word32] = Mem42[esp_39 + 0x14:word32];
	VirtualFree(Mem91[esp_39 - 0x08 + 0x00:LPVOID], Mem92[esp_39 - 0x04 + 0x00:SIZE_T], Mem93[esp_39 + 0x00:DWORD]);
	return edi_49;
}

// 004016F1: Register word32 fn004016F1(Stack word32 dwArg04)
word32 fn004016F1(word32 dwArg04)
{
	word32 eax_13;
	if (dwArg04 == 0x00)
		eax_13 = 0x00;
	else
		eax_13 = (uint32) ((uint64) (uint32) fn0040181B() % dwArg04);
	return eax_13;
}

// 00401713: Register word32 fn00401713(Register word32 eax, Register byte cl, Register byte ch, Register word32 ebp)
word32 fn00401713(word32 eax, byte cl, byte ch, word32 ebp)
{
}

// 0040181B: Register word32 fn0040181B()
word32 fn0040181B()
{
	word64 edx_eax_11 = __rdtsc();
	word32 eax_13 = (word32) edx_eax_11;
	return eax_13 ^ __rol(SLICE(edx_eax_11, word32, 32) *s eax_13 + SCZDOP, (byte) (eax_13 & 0x0F));
}

// 00401832: Register DWORD Win32CrtStartup()
DWORD Win32CrtStartup()
{
	return ZfXtnlxWyhustKrybOty(bh, bl, esi, dwArg04, dwArg08, dwArg0C);
}

// 00401833: Register word32 ZfXtnlxWyhustKrybOty(Register byte bh, Register byte bl, Register word32 esi, Stack word32 dwArg08, Stack word32 dwArg0C, Stack word32 dwArg10)
word32 ZfXtnlxWyhustKrybOty(byte bh, byte bl, word32 esi, word32 dwArg08, word32 dwArg0C, word32 dwArg10)
{
ZfXtnlxWyhustKrybOty_entry:
	word32 eax_187
	GetModuleHandleW(Mem189[esp_13 + 0x00:LPCWSTR])
	Mem31[esp_16 - 0x04 + 0x00:word32] = 0x00
	word32 esp_33
	word32 ebp_34
	word32 esi_35
	word32 edi_36
	byte SZO_37
	byte C_38
	word32 eax_39
	word32 ecx_40
	byte Z_41
	byte SCZO_42
	byte SO_44
	byte bl_46
	byte bh_43
	word32 ebx_45
	call esi_18 (retsize: 4; depth: 4)
		uses: bh_26,bl_29,C_21,dwLoc04_5,dwLoc08_8,dwLoc0C_14,eax_32,ebp_17,ebx_28,ecx_23,edi_19,esi_18,esp_30,SCZO_25,SO_27,SZO_20,Z_24
		defs: bh_43,bl_46,C_38,eax_39,ebp_34,ebx_45,ecx_40,edi_36,esi_35,esp_33,SCZO_42,SO_44,SZO_37,Z_41
	Mem48[esp_33 - 0x04 + 0x00:word32] = eax_39
	word32 eax_50 = getenv(Mem48[esp_33 - 0x04 + 0x00:(ptr char)])
	word32 ecx_134 = Mem48[esp_33 - 0x04 + 0x00:word32]
	word32 esp_104 = esp_33
	branch eax_50 != 0x00 l004018CC
	goto l0040185C
l00401833:
l0040185C:
	Mem127[esp_33 - 0x04 + 0x00:word32] = 0x61
	Mem129[esp_33 - 0x08 + 0x00:word32] = 0x66
	word32 eax_131 = is_wctype(Mem129[esp_33 - 0x08 + 0x00:wint_t], Mem129[esp_33 - 0x04 + 0x00:wctype_t])
	ecx_134 = Mem129[esp_33 - 0x04 + 0x00:word32]
	esp_104 = esp_33
	branch eax_131 != 0x00 l004018CC
l00401872:
	Mem140[esp_33 - 0x04 + 0x00:word32] = 0x00
	branch GetModuleHandleW(Mem140[esp_33 - 0x04 + 0x00:LPCWSTR]) == 0x00 || (dwArg0C >=u 0x04 || ((word32) wArg08 != 0x00 || (dwArg10 & ~0x01) != 0x00)) l004018B5
	goto l004018A0
l0040187D:
l00401887:
l00401893:
l004018A0:
	Mem176[esp_33 - 0x08 + 0x00:word32] = 0x01
	Mem179[esp_33 - 0x0C + 0x00:word32] = dwArg10
	Mem182[esp_33 - 0x10 + 0x00:word32] = dwArg0C
	Mem186[esp_33 - 0x14 + 0x00:word32] = dwArg08
	eax_187 = fn0040112F(ebp_34, dwArg00, dwArg04, dwArg0C)
	goto l004018FB
l004018B5:
	Mem150[esp_33 - 0x08 + 0x00:word32] = 0x00
	Mem152[esp_33 - 0x0C + 0x00:word32] = 0x00
	Mem154[esp_33 - 0x10 + 0x00:word32] = 0x00
	Mem156[esp_33 - 0x14 + 0x00:word32] = 0x00
	Mem163[esp_33 - 0x08 + 0x00:word32] = fn0040112F(ebp_34, dwArg00, dwArg04, dwArg0C)
	ExitProcess(Mem163[esp_33 - 0x08 + 0x00:UINT])
l004018CC:
	word32 eax_89 = __indw(0x68)
	__bound(esp_104, dwLoc59)
	bh_43 = bh_43 * 0x02
	bool v16_100 = (Mem48[ecx_134 + 0x39:byte] & 0x02) != 0x00
	Mem101[ecx_134 + 0x39:byte] = __rcr(Mem48[ecx_134 + 0x39:byte], 0x01, cond(bh_43))
	eax_187 = eax_89 + 0x5058058C
	ebx_45 = DPB(ebx_45, bh_43, 8) (alias)
	branch bh_43 >= 0x00 l004018E6
l004018DE:
	branch bh_43 == 0x00 l004018F9
l004018E4:
	word32 esp_114 = esp_104 - 0x04
	Mem115[esp_114 + 0x00:word32] = 0x00
	Mem119[esp_114 - 0x04 + 0x00:word32] = dwArg10
	esp_104 = esp_114 - 0x04
	goto l004018E8
l004018E6:
	branch bh_43 != 0x00 l004018F8
l004018E8:
	branch CommConfigDialogW(Mem101[esp_104 + 0x00:LPCWSTR], Mem101[esp_104 + 0x04:HWND], Mem101[esp_104 + 0x08:LPCOMMCONFIG]) != 0x00 l004018CC
l004018F8:
	esp_104 = esp_104 - 0x04
	Mem122[esp_104 + 0x00:word32] = Mem101[ebx_45 + 0x00:word32]
l004018F9:
l004018FA:
	Mem124[0x5E:byte] = __rcr(Mem122[0x5E:byte], 0x5D, v16_100)
l004018FB:
l004018FE:
	return eax_187
ZfXtnlxWyhustKrybOty_exit:
}

// 00401901: Register word32 fn00401901(Stack word32 dwArg04)
word32 fn00401901(word32 dwArg04)
{
	word32 ecx_12 = 0x00;
	word32 edi_18 = dwArg04;
	while (true)
	{
		edi_18 = edi_18 + 0x01;
		if (0x00 == Mem0[edi_18 + 0x00:byte])
			break;
		ecx_12 = ecx_12 + 0x01;
	}
	return ecx_12;
}

// 0040192D: Register word32 fn0040192D()
word32 fn0040192D()
{
	word32 esi_12 = Mem0[Mem0[Mem0[fs:0x30:word32] + 0x0C:word32] + 0x1C:word32];
	do
	{
		word32 eax_14 = Mem0[esi_12 + 0x08:word32];
		word32 edi_15 = Mem0[esi_12 + 0x20:word32];
		esi_12 = Mem0[esi_12 + 0x00:word32];
	} while (Mem0[edi_15 + 0x00:byte] != 0x6B || Mem0[edi_15 + 0x18:byte] != 0x00);
	return eax_14;
}

// 0040195A: Register word32 fn0040195A(Register word32 ecx, Register word32 edx, Register word32 edi)
word32 fn0040195A(word32 ecx, word32 edx, word32 edi)
{
	if (ecx == 0x00 || (edx == 0x00 || edi == 0x00))
		return esi;
	if (false)
		return esi;
	word32 edx_38 = edx - ecx;
	return fn0040197D(ecx, edx_38, edi);
}

// 0040197D: Register word32 fn0040197D(Register word32 ecx, Register word32 edx, Register word32 esi)
word32 fn0040197D(word32 ecx, word32 edx, word32 esi)
{
	ptr32 fp;
	word32 edx;
	word32 ecx;
	<type-error> Mem0;
	word32 esi;
	word32 dwArg00;
	esp_1 = fp;
	al_5 = Mem0[edx + ecx:byte];
	esi_8 = IigGbliiYnqdwsdIovvTm(al_5, ecx, edx, esi, dwArg00);
	return esi_8;
}

// 00401980: Register word32 IigGbliiYnqdwsdIovvTm(Register byte al, Register word32 ecx, Register word32 edx, Register word32 esi, Stack word32 dwArg00)
word32 IigGbliiYnqdwsdIovvTm(byte al, word32 ecx, word32 edx, word32 esi, word32 dwArg00)
{
	Mem3[ecx + 0x00:byte] = al;
	if (esi != 0x01)
		return fn0040197D(ecx + 0x01, edx, esi - 0x01);
	return dwArg00;
}

// 00401996: Register word32 fn00401996(Register word32 ebp, Register word32 esi)
word32 fn00401996(word32 ebp, word32 esi)
{
	word32 eax_13 = Mem0[esi + 0x00:word32];
	Mem15[esi + 0x04:word32] = Mem0[esi + 0x04:word32] & 0x00;
	word32 ebx_30 = (word32) __ror(Mem15[Mem15[eax_13 + 0x3C:word32] + 0x08 + eax_13:word16] ^ 0x68E1, 0x01) + eax_13;
	word32 esi_38 = fn0040195A(esi + 0x08, ebx_30 + 0x10, 0x20);
	Mem41[fp - 0x14 + 0x00:word32] = 0x737C4887;
	Mem43[fp - 0x18 + 0x00:word32] = 0x20;
	Mem46[fp - 0x1C + 0x00:word32] = esi_38 + 0x08;
	fn00401584(dwArg00, dwArg04, dwArg08);
	word32 eax_51 = Mem46[esi_38 + 0x24:word32];
	Mem53[esi_38 + 0x10:word32] = Mem46[esi_38 + 0x10:word32] - eax_51;
	Mem55[esi_38 + 0x1C:word32] = Mem53[esi_38 + 0x1C:word32] + eax_51;
	Mem59[esi_38 + 0x08:word32] = Mem55[esi_38 + 0x08:word32] + eax_51 *s ~0x07;
	Mem65[esi_38 + 0x18:word32] = Mem59[esi_38 + 0x18:word32] + eax_51 *s ~0x0F;
	Mem68[esi_38 + 0x0C:word32] = Mem65[esi_38 + 0x0C:word32] + -eax_51 * 0x02;
	word32 ecx_70 = Mem68[esi_38 + 0x0C:word32];
	Mem72[fp - 0x14 + 0x00:word32] = 0x40;
	Mem75[fp - 0x18 + 0x00:word32] = 0x3000;
	Mem77[fp - 0x1C + 0x00:word32] = ecx_70 + 0x20;
	Mem79[fp - 0x20 + 0x00:word32] = 0x00;
	word32 eax_81 = VirtualAlloc(Mem79[fp - 0x20 + 0x00:LPVOID], Mem79[fp - 0x1C + 0x00:SIZE_T], Mem79[fp - 0x18 + 0x00:DWORD], Mem79[fp - 0x14 + 0x00:DWORD]);
	Mem82[esi_38 + 0x04:word32] = eax_81;
	word32 esp_78 = fp - 0x20;
	word32 dwLoc08_83 = eax_81;
	word32 dwLoc0C_102 = 0x04;
	do
	{
		word32 esi_92 = fn0040195A(dwLoc08_83, ebx_30 + 0x10, Mem82[ebx_30 + 0x08:word32]);
		word32 v22_101 = dwLoc0C_102 - 0x01;
		esp_78 = esp_78 + 0x04;
		dwLoc08_83 = dwLoc08_83 + Mem82[ebx_30 + 0x08:word32];
		ebx_30 = (Mem82[ebx_30 + 0x0C:word32] ^ 1187211489) + Mem82[esi_92 + 0x00:word32];
		dwLoc0C_102 = v22_101;
	} while (v22_101 != 0x00);
	Mem106[esi_92 + 0x04:word32] = Mem82[esi_92 + 0x04:word32] + 0x1D;
	Mem108[esi_92 + 0x04:word32] = Mem106[esi_92 + 0x04:word32] - ~0x02;
	return Mem108[esp_78 + 0x04:word32];
}

// 00401A52: Register word32 fn00401A52(Register word32 ecx, Register word32 edi, Stack word32 dwArg08, Register out ptr32 ebxOut, Register out ptr32 ebpOut, Register out ptr32 esiOut, Register out ptr32 ediOut)
word32 fn00401A52(word32 ecx, word32 edi, word32 dwArg08, ptr32 & ebxOut, ptr32 & ebpOut, ptr32 & esiOut, ptr32 & ediOut)
{
	*ebxOut = ebx;
	*ediOut = edi;
	word32 ecx_19 = (word32) Mem0[dwArg08 + 0x0C:word16];
	word32 eax_20 = (word32) Mem0[dwArg08 + 0x0E:word16] + ecx_19;
	if (eax_20 == 0x00)
	{
		word32 esi_43;
		*esiOut = esi;
		word32 ebp_45;
		*ebpOut = ebp;
		return eax_20;
	}
	else
	{
		word32 ebx_38;
		word32 ebp_39;
		word32 esi_40;
		word32 edi_41;
		return KaqKcgzYxmcfxqXq(ecx_19, fp - 0x04, dwArg08, edi, out ebx_38, out ebp_39, out esi_40, out edi_41);
	}
}

// 00401A6F: Register word32 KaqKcgzYxmcfxqXq(Register word32 ecx, Register word32 ebp, Register word32 esi, Register word32 edi, Register out ptr32 ebxOut, Register out ptr32 ebpOut, Register out ptr32 esiOut, Register out ptr32 ediOut)
word32 KaqKcgzYxmcfxqXq(word32 ecx, word32 ebp, word32 esi, word32 edi, ptr32 & ebxOut, ptr32 & ebpOut, ptr32 & esiOut, ptr32 & ediOut)
{
	word32 ebx_17 = Mem0[ebp + 0x10:word32];
	word32 edi_10 = Mem0[ebp + 0x08:word32];
	Mem11[ebp + 0x0C:word32] = esi + 0x14;
	word32 esp_20 = fp - 0x04;
	do
	{
		word32 eax_22 = Mem11[Mem11[ebp + 0x0C:word32] + 0x00:word32];
		if (eax_22 < 0x00)
		{
			word32 esp_56 = esp_20 - 0x04;
			Mem57[esp_56 + 0x00:word32] = ebx_17;
			Mem61[esp_56 - 0x04 + 0x00:word32] = (eax_22 & 0x7FFFFFFF) + edi_10;
			Mem63[esp_56 - 0x08 + 0x00:word32] = edi_10;
			fn00401A52(ecx, edi_10, dwArg04, out ebx_17, out ebp, out esi, out edi_10);
			esp_20 = esp_56 + 0x08;
		}
		else
		{
			word32 eax_71 = eax_22 + edi_10;
			Mem73[eax_71 + 0x00:word32] = Mem11[eax_71 + 0x00:word32] + ebx_17;
		}
		word32 eax_31 = (word32) Mem11[esi + 0x0E:word16];
		ecx = (word32) Mem11[esi + 0x0C:word16];
		Mem34[ebp - 0x04 + 0x00:word32] = Mem11[ebp - 0x04 + 0x00:word32] + 0x01;
		Mem36[ebp + 0x0C:word32] = Mem34[ebp + 0x0C:word32] + 0x06;
		Mem38[ebp + 0x0C:word32] = Mem36[ebp + 0x0C:word32] + 0x02;
		word32 eax_39 = eax_31 + ecx;
	} while (Mem38[ebp - 0x04 + 0x00:word32] <u eax_39);
	word32 esp_43 = esp_20 + 0x04;
	word32 edi_42;
	*ediOut = Mem38[esp_20 + 0x00:word32];
	word32 ebx_44;
	*ebxOut = Mem38[esp_43 + 0x00:word32];
	word32 esi_47;
	*esiOut = Mem0[esp_43 + 0x04:word32];
	word32 ebp_49;
	*ebpOut = Mem0[ebp + 0x00:word32];
	return eax_39;
}

// 00401AC8: Register word32 fn00401AC8(Register byte bl, Register byte bh, Stack word32 dwArg04, Register out ptr32 clOut, Register out ptr32 chOut, Register out ptr32 dlOut, Register out ptr32 dhOut, Register out ptr32 ebxOut, Register out ptr32 ebpOut, Register out ptr32 esiOut, Register out ptr32 ediOut)
word32 fn00401AC8(byte bl, byte bh, word32 dwArg04, ptr32 & clOut, ptr32 & chOut, ptr32 & dlOut, ptr32 & dhOut, ptr32 & ebxOut, ptr32 & ebpOut, ptr32 & esiOut, ptr32 & ediOut)
{
	*ebxOut = ebx;
	*ediOut = edi;
	word32 eax_16 = Mem0[dwArg04 + 0x3C:word32] + dwArg04;
	word32 esi_21 = Mem0[eax_16 + 0x78:word32];
	byte cl_22;
	byte ch_23;
	byte dl_24;
	byte dh_25;
	byte bl_26;
	word32 ebp_27;
	word32 esi_28;
	return SzfkIjqwtBv(eax_16, dwArg04, fp - 0x04, esi_21, out cl_22, out ch_23, out dl_24, out dh_25, out bl_26, out ebp_27, out esi_28);
}

// 00401AE6: Register word32 SzfkIjqwtBv(Register word32 eax, Register word32 ecx, Register word32 ebp, Register word32 esi, Register out ptr32 clOut, Register out ptr32 chOut, Register out ptr32 dlOut, Register out ptr32 dhOut, Register out ptr32 blOut, Register out ptr32 ebpOut, Register out ptr32 esiOut)
word32 SzfkIjqwtBv(word32 eax, word32 ecx, word32 ebp, word32 esi, ptr32 & clOut, ptr32 & chOut, ptr32 & dlOut, ptr32 & dhOut, ptr32 & blOut, ptr32 & ebpOut, ptr32 & esiOut)
{
}

// 00401C1D: Register word32 fn00401C1D(Register byte dh, Register byte dl, Register word32 ebx, Register out ptr32 ebxOut, Register out ptr32 ebpOut, Register out ptr32 esiOut)
word32 fn00401C1D(byte dh, byte dl, word32 ebx, ptr32 & ebxOut, ptr32 & ebpOut, ptr32 & esiOut)
{
	word32 ebx_11;
	word32 ebp_12;
	word32 esi_13;
	return CapPyyfdoxHghkvPrpqfoo(ebx, fp - 0x04, out ebx_11, out ebp_12, out esi_13);
}

// 00401C29: Register word32 CapPyyfdoxHghkvPrpqfoo(Register word32 ebx, Register word32 ebp, Register out ptr32 ebxOut, Register out ptr32 ebpOut, Register out ptr32 esiOut)
word32 CapPyyfdoxHghkvPrpqfoo(word32 ebx, word32 ebp, ptr32 & ebxOut, ptr32 & ebpOut, ptr32 & esiOut)
{
}

