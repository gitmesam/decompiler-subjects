// subject.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

// 00401000: void fn00401000(Register word32 ecx, Register word32 edx)
void fn00401000(word32 ecx, word32 edx)
{
	word32 eax_6 = Mem0[Mem0[edx + 0x3C:word32] + edx + 0x78:word32];
	if (eax_6 != 0x00)
	{
		word32 eax_28 = eax_6 + edx;
		Mem31[eax_28 + 0x1C:word32] = Mem0[eax_28 + 0x1C:word32] + ecx;
		Mem33[eax_28 + 0x24:word32] = Mem31[eax_28 + 0x24:word32] + ecx;
		Mem35[eax_28 + 0x20:word32] = Mem33[eax_28 + 0x20:word32] + ecx;
		Mem37[eax_28 + 0x0C:word32] = Mem35[eax_28 + 0x0C:word32] + ecx;
		word32 edi_43 = Mem37[eax_28 + 0x1C:word32] + edx;
		word32 esi_44 = 0x00;
		if (Mem37[eax_28 + 0x14:word32] >u 0x00)
		{
			do
			{
				edi_43[esi_44 * 0x04] = edi_43[esi_44 * 0x04] + ecx;
				esi_44 = esi_44 + 0x01;
			} while (esi_44 <u Mem68[eax_28 + 0x14:word32]);
		}
		word32 esi_49 = Mem37[eax_28 + 0x20:word32] + edx;
		word32 edx_50 = 0x00;
		if (Mem37[eax_28 + 0x18:word32] >u 0x00)
		{
			do
			{
				esi_49[edx_50 * 0x04] = esi_49[edx_50 * 0x04] + ecx;
				edx_50 = edx_50 + 0x01;
			} while (edx_50 <u Mem62[eax_28 + 0x18:word32]);
		}
	}
}

// 00401067: Register word32 fn00401067(Register word32 ebp, Stack word32 dwArg04, Register out ptr32 clOut, Register out ptr32 chOut)
word32 fn00401067(word32 ebp, word32 dwArg04, ptr32 & clOut, ptr32 & chOut)
{
	*clOut = cl;
	*chOut = ch;
	word32 eax_112;
	word32 ebp_126 = fp - 0x04;
	word32 edi_125 = dwArg04;
	word32 eax_19 = Mem0[Mem0[dwArg04 + 0x3C:word32] + dwArg04 + 0x80:word32];
	if (eax_19 == 0x00)
		eax_112 = eax_19 - ~0x00;
	else
	{
		word32 ebx_121 = eax_19 + dwArg04;
		byte bl_69 = (byte) ebx_121;
		byte bh_70 = SLICE(ebx_121, byte, 8);
		word32 eax_122 = ebx_121 + 0x0C;
		word32 esp_105 = fp + ~0x1B;
		if (Mem0[ebx_121 + 0x0C:word32] != 0x00)
		{
			word32 esi_115 = ebx_121;
			do
			{
				word32 esp_130 = esp_105 - 0x04;
				Mem131[esp_130 + 0x00:word32] = Mem0[eax_122 + 0x00:word32] + edi_125;
				word32 eax_133 = LoadLibraryA(Mem131[esp_130 + 0x00:LPCSTR]);
				Mem135[ebp_126 - 0x0C + 0x00:word32] = eax_133;
				esp_105 = esp_130 + 0x04;
				if (eax_133 == 0x00)
				{
l0040112B:
					eax_112 = 0x00;
					goto l00401124;
				}
				word32 esi_154 = Mem135[esi_115 + 0x10:word32];
				Mem156[ebp_126 - 0x04 + 0x00:word32] = Mem135[ebp_126 - 0x04 + 0x00:word32] & 0x00;
				word32 esi_158 = esi_154 + edi_125;
				if (Mem156[esi_158 + 0x00:word32] != 0x00)
				{
					word32 edi_180 = esi_158;
					do
					{
						word32 esp_186 = esp_105 - 0x04;
						Mem187[esp_186 + 0x00:word32] = Mem156[edi_180 + 0x00:word32];
						Mem190[esp_186 - 0x04 + 0x00:word32] = Mem187[ebp_126 - 0x0C + 0x00:word32];
						esp_105 = esp_186 - 0x04;
						byte cl_192;
						byte ch_193;
						byte dl_194;
						byte dh_195;
						word32 esi_198;
						word32 edi_199;
						word32 eax_200 = fn00401AC8(bl_69, bh_70, dwArg00, out cl_192, out ch_193, out dl_194, out dh_195, out ebx_121, out ebp_126, out esi_198, out edi_199);
						if (eax_200 == 0x00)
							goto l0040112B;
						Mem206[ebp_126 - 0x04 + 0x00:word32] = Mem190[ebp_126 - 0x04 + 0x00:word32] + 0x01;
						Mem207[edi_199 + 0x00:word32] = eax_200;
						edi_180 = esi_198 + Mem207[(ebp_126 - 0x04) + 0x00:word32] * 0x04;
					} while (Mem207[edi_180 + 0x00:word32] != 0x00);
					edi_125 = Mem207[ebp_126 + 0x08:word32];
				}
				Mem172[ebp_126 - 0x08 + 0x00:word32] = Mem156[ebp_126 - 0x08 + 0x00:word32] + 0x01;
				esi_115 = Mem172[ebp_126 - 0x08 + 0x00:word32] *s 0x14 + ebx_121;
				eax_122 = esi_115 + 0x0C;
			} while (Mem172[esi_115 + 0x0C:word32] != 0x00);
		}
		word32 esp_107 = esp_105 - 0x04;
		Mem108[esp_107 + 0x00:word32] = 0x01;
		Mem110[esp_107 + 0x00:word32] = Mem108[esp_107 + 0x00:word32];
		eax_112 = Mem110[esp_107 + 0x00:word32];
l00401124:
	}
	return eax_112;
}

// 0040112F: Register word32 fn0040112F(Register word32 ebp, Stack word32 dwArg04, Stack word32 dwArg08, Stack word32 dwArg10)
word32 fn0040112F(word32 ebp, word32 dwArg04, word32 dwArg08, word32 dwArg10)
{
	word32 eax_21;
	word32 ebp_133 = fp - 0x04;
	if (dwArg10 != 0x00)
		eax_21 = dwArg04;
	else
		eax_21 = GetModuleHandleA(0x00);
	word32 eax_36 = LoadImageA(eax_21, 220, 0x00, 0x00, 0x00, 0x40);
	word32 esp_134 = fp - 0x80;
	word32 eax_40 = GetLastError();
	if (eax_36 != 0x00 || eax_40 != 1812 && eax_40 != 1813)
	{
		word32 ecx_592 = 11;
		word32 edi_597 = fp - 0xB0;
		word32 esi_598 = fp - 116;
		while (ecx_592 != 0x00)
		{
			Mem607[edi_597 + 0x00:word32] = Mem0[esi_598 + 0x00:word32];
			esi_598 = esi_598 + 0x04;
			edi_597 = edi_597 + 0x04;
			ecx_592 = ecx_592 - 0x01;
		}
		byte SCZO_624;
		word32 ebx_625;
		byte SZO_626;
		bool C_627;
		word32 esi_628;
		word32 edi_629;
		bool Z_630;
		word32 eax_631;
		word32 ecx_632;
		word32 edx_633;
		byte CZ_634;
		word16 ax_635;
		word16 cx_636;
		byte ch_637;
		byte bl_638;
		byte bh_639;
		byte cl_640;
		byte dl_641;
		byte dh_642;
		fn94994887();
	}
	word32 eax_154;
	if (dwArg10 != 0x00 && dwArg08 != 0x01)
	{
l0040144A:
		word32 esp_142 = esp_134 - 0x04;
		Mem143[esp_142 + 0x00:word32] = Mem0[ebp_133 + 0x10:word32];
		Mem147[esp_142 - 0x04 + 0x00:word32] = Mem143[ebp_133 + 0x0C:word32];
		Mem150[esp_142 - 0x08 + 0x00:word32] = Mem147[ebp_133 + 0x08:word32];
		Mem153[esp_142 - 0x0C + 0x00:word32] = Mem150[ebp_133 + 0x14:word32];
		eax_154 = CreateEventW(Mem153[esp_142 - 0x0C + 0x00:LPSECURITY_ATTRIBUTES], Mem153[esp_142 - 0x08 + 0x00:BOOL], Mem153[esp_142 - 0x04 + 0x00:BOOL], Mem153[esp_142 + 0x00:LPCWSTR]);
		return eax_154;
	}
	word32 ebx_158 = fn00401996(ebp_133, fp - 116);
	word32 esp_159 = esp_134 - 0x04;
	Mem160[esp_159 + 0x00:word32] = 0x40;
	Mem162[esp_159 - 0x04 + 0x00:word32] = 0x3000;
	Mem166[esp_159 - 0x08 + 0x00:word32] = dwLoc68;
	Mem169[esp_159 - 0x0C + 0x00:word32] = ebx_158;
	word32 eax_170 = VirtualAlloc(Mem169[esp_159 - 0x0C + 0x00:LPVOID], Mem169[esp_159 - 0x08 + 0x00:SIZE_T], Mem169[esp_159 - 0x04 + 0x00:DWORD], Mem169[esp_159 + 0x00:DWORD]);
	if (eax_170 == ebx_158)
	{
l004011E7:
		eax_154 = 0x00;
		return eax_154;
	}
	word32 esi_227 = fn0040195A(eax_170, dwLoc70, dwLoc68);
	Mem232[esp_159 + 0x04:word32] = dwLoc54;
	Mem237[esp_159 + 0x00:word32] = dwLoc60;
	Mem239[esp_159 - 0x04 + 0x00:word32] = esi_227;
	fn004015D5(dwLoc68, dwArg00, dwArg04, dwArg08);
	Mem252[esp_159 + 0x04:word32] = dwLoc68 - dwLoc58 + esi_227;
	Mem255[esp_159 + 0x00:word32] = fp - 0x38;
	word32 edi_269 = fn00401466(ebp_133, eax_21);
	Mem273[esp_159 + 0x04:word32] = Mem255[ebp_133 - 0x68 + 0x00:word32];
	Mem275[esp_159 + 0x00:word32] = esi_227;
	word32 eax_277 = fn0040168F(esi_227, edi_269, dwArg00, dwArg04, dwArg0C);
	Mem280[ebp_133 - 0x20 + 0x00:word32] = eax_277;
	if (eax_277 == 0x00)
		goto l004011E7;
	word32 esi_285 = Mem280[eax_277 + 0x3C:word32];
	Mem287[ebp_133 - 0x14 + 0x00:word32] = Mem280[ebp_133 - 0x60 + 0x00:word32] + eax_277;
	word32 eax_288 = Mem287[ebp_133 - 0x70 + 0x00:word32];
	word32 ebx_290 = Mem287[eax_288 + 0x3C:word32] + eax_288;
	Mem297[ebp_133 - 0x18 + 0x00:word32] = (word32) Mem287[ebx_290 + 0x14:word16] + 0x18 + ebx_290;
	word32 esi_295 = esi_285 + eax_277;
	word32 eax_299 = (word32) Mem297[esi_295 + 0x14:word16] + 0x18 + esi_295;
	Mem301[esp_159 + 0x04:word32] = 706632649;
	Mem302[ebp_133 - 0x10 + 0x00:word32] = eax_299;
	Mem305[esp_159 + 0x00:word32] = fn0040192D();
	byte bl_291 = (byte) ebx_290;
	byte bh_292 = SLICE(ebx_290, byte, 8);
	byte cl_306;
	byte ch_307;
	byte dl_308;
	byte dh_309;
	word32 ebx_310;
	word32 ebp_311;
	word32 esi_312;
	word32 edi_313;
	word32 eax_314 = fn00401AC8(bl_291, bh_292, dwArg00, out cl_306, out ch_307, out dl_308, out dh_309, out ebx_310, out ebp_311, out esi_312, out edi_313);
	Mem317[esp_159 - 0x04 + 0x00:word32] = ebp_311 - 0x24;
	Mem319[esp_159 - 0x08 + 0x00:word32] = 0x04;
	Mem321[esp_159 - 0x0C + 0x00:word32] = 0x01;
	Mem323[esp_159 - 0x10 + 0x00:word32] = ebx_310;
	word32 esp_324;
	word32 ebp_325;
	byte SCZO_326;
	word32 ebx_327;
	byte SZO_328;
	bool C_329;
	word32 esi_330;
	word32 edi_331;
	bool Z_332;
	word32 eax_333;
	word32 ecx_334;
	word32 edx_335;
	byte CZ_336;
	word16 ax_337;
	word16 cx_338;
	byte ch_339;
	byte bl_340;
	byte bh_341;
	byte cl_342;
	byte dl_343;
	byte dh_344;
	eax_314();
	Mem347[esp_324 - 0x04 + 0x00:word32] = Mem323[ebp_325 - 0x60 + 0x00:word32];
	Mem349[esp_324 - 0x08 + 0x00:word32] = edi_331;
	word32 ebx_350;
	word32 esi_352;
	word32 eax_353 = fn00401C1D(dl_343, dh_344, ebx_327, out ebx_350, out ebp_133, out esi_352);
	Mem355[ebp_133 - 0x04 + 0x00:word32] = eax_353;
	word32 edi_356 = eax_353 - Mem355[(ebp_133 - 0x70) + 0x00:word32];
	Mem360[ebp_133 - 0x1C + 0x00:word32] = edi_356;
	word32 esp_348 = esp_324 - 0x08;
	if (Mem360[ebp_133 + 0x14:word32] != 0x00)
	{
		word32 eax_573 = Mem360[esi_352 + 0x78:word32];
		if (eax_573 != 0x00)
		{
			Mem579[ebx_350 + 0x78:word32] = eax_573 + edi_356;
			Mem581[ebx_350 + 0x7C:word32] = Mem579[esi_352 + 0x7C:word32];
l004012F2:
			word32 ecx_365 = Mem360[esi_352 + 0x88:word32];
			if (ecx_365 != 0x00)
			{
				Mem545[ebx_350 + 0x88:word32] = ecx_365 + edi_356;
				word32 ecx_546 = Mem545[esi_352 + 0x8C:word32];
				word32 eax_547 = Mem545[ebx_350 + 0x88:word32];
				Mem548[ebx_350 + 0x8C:word32] = ecx_546;
				word32 eax_549 = eax_547 + Mem548[(ebp_133 - 0x70) + 0x00:word32];
				Mem552[esp_324 - 0x0C + 0x00:word32] = edi_356;
				Mem554[esp_324 - 0x10 + 0x00:word32] = eax_549;
				Mem556[esp_324 - 0x14 + 0x00:word32] = eax_549;
				word32 eax_561 = fn00401A52(ecx_546, edi_356, dwArg04, out ebx_350, out ebp_133, out esi_352, out edi_356);
				Mem566[ebx_350 + 0x50:word32] = (eax_561 | ~0x00) - Mem556[(ebp_133 - 0x70) + 0x00:word32];
				esp_348 = esp_324 - 0x04;
			}
			word32 eax_377 = Mem360[ebp_133 - 0x14 + 0x00:word32];
			word32 ecx_379 = Mem360[ebp_133 - 0x04 + 0x00:word32] - Mem360[esi_352 + 0x34:word32];
			Mem383[ebp_133 - 0x0C + 0x00:word32] = 0x00;
			if (Mem383[eax_377 + 0x00:word32] >u 0x00)
			{
				Mem527[ebp_133 - 0x08 + 0x00:word32] = eax_377 + 0x04;
				do
				{
					word32 eax_530 = Mem527[Mem527[ebp_133 - 0x08 + 0x00:word32] + 0x00:word32] + Mem527[(ebp_133 - 0x04) + 0x00:word32];
					Mem532[ebp_133 - 0x08 + 0x00:word32] = Mem527[ebp_133 - 0x08 + 0x00:word32] + 0x03;
					Mem534[ebp_133 - 0x08 + 0x00:word32] = Mem532[ebp_133 - 0x08 + 0x00:word32] - ~0x00;
					Mem536[eax_530 + 0x00:word32] = Mem534[eax_530 + 0x00:word32] + ecx_379;
					Mem538[ebp_133 - 0x0C + 0x00:word32] = Mem536[ebp_133 - 0x0C + 0x00:word32] + 0x01;
				} while (Mem538[ebp_133 - 0x0C + 0x00:word32] <u Mem538[Mem538[(ebp_133 - 0x14) + 0x00:word32] + 0x00:word32]);
			}
			word32 esp_389 = esp_348 - 0x04;
			Mem390[esp_389 + 0x00:word32] = Mem383[ebp_133 - 0x04 + 0x00:word32];
			byte ch_392;
			byte cl_391;
			if (fn00401067(ebp_133, dwArg00, out cl_391, out ch_392) != 0x00)
			{
				if (Mem390[ebp_133 + 0x14:word32] != 0x00)
				{
					fn00401000(edi_356, Mem390[ebp_133 - 0x70 + 0x00:word32]);
					ch_392 = SLICE(edi_356, byte, 8);
					cl_391 = (byte) edi_356;
				}
				Mem407[esp_389 + 0x00:word32] = Mem390[ebp_133 - 0x04 + 0x00:word32];
				if (fn00401713(Mem407[ebp_133 - 0x04 + 0x00:word32], cl_391, ch_392, ebp_133) != 0x00)
				{
					word32 edi_414 = Mem407[ebp_133 - 0x70 + 0x00:word32];
					Mem415[ebp_133 - 0x44 + 0x00:byte] = 0x43;
					Mem416[ebp_133 - 0x43 + 0x00:byte] = 114;
					Mem417[ebp_133 - 66 + 0x00:byte] = 101;
					Mem418[ebp_133 - 0x41 + 0x00:byte] = 0x61;
					Mem419[ebp_133 - 0x40 + 0x00:byte] = 116;
					Mem420[ebp_133 - 0x3F + 0x00:byte] = 101;
					Mem421[ebp_133 - 0x3E + 0x00:byte] = 0x45;
					Mem422[ebp_133 - 0x3D + 0x00:byte] = 118;
					Mem423[ebp_133 - 0x3C + 0x00:byte] = 101;
					Mem424[ebp_133 - 0x3B + 0x00:byte] = 110;
					Mem425[ebp_133 - 0x3A + 0x00:byte] = 116;
					Mem426[ebp_133 - 0x39 + 0x00:byte] = 0x57;
					Mem427[ebp_133 - 0x38 + 0x00:byte] = 0x00;
					Mem432[esp_389 + 0x00:word32] = Mem427[esi_352 + 0x28:word32] + Mem427[(ebp_133 - 0x04) + 0x00:word32];
					Mem435[esp_389 - 0x04 + 0x00:word32] = ebp_133 - 0x44;
					fn00401466(ebp_133, edi_414);
					word16 ax_439 = (word16) (word32) Mem435[esi_352 + 0x06:word16];
					Mem444[ebx_350 + 0x06:word16] = ax_439;
					word32 edx_441 = 0x00;
					if (0x00 <u ax_439)
					{
						do
						{
							word32 eax_475 = Mem444[ebp_133 - 0x18 + 0x00:word32];
							word32 esi_477 = Mem444[ebp_133 - 0x10 + 0x00:word32];
							Mem479[ebp_133 - 0x10 + 0x00:word32] = Mem444[ebp_133 - 0x10 + 0x00:word32] + 0x05;
							Mem481[ebp_133 - 0x10 + 0x00:word32] = Mem479[ebp_133 - 0x10 + 0x00:word32] + 0x23;
							word32 esp_483 = esp_348 - 0x04;
							Mem484[esp_483 + 0x00:word32] = 0x0A;
							word32 edi_485 = eax_475;
							word32 ecx_486 = Mem484[esp_483 + 0x00:word32];
							while (ecx_486 != 0x00)
							{
								Mem498[edi_485 + 0x00:word32] = Mem484[esi_477 + 0x00:word32];
								esi_477 = esi_477 + 0x04;
								edi_485 = edi_485 + 0x04;
								ecx_486 = ecx_486 - 0x01;
							}
							Mem508[eax_475 + 0x0C:word32] = Mem484[eax_475 + 0x0C:word32] + Mem484[(ebp_133 - 0x1C) + 0x00:word32];
							Mem512[ebp_133 - 0x18 + 0x00:word32] = eax_475 - ~0x27;
							edx_441 = edx_441 + 0x01;
						} while (edx_441 <u (word32) Mem512[ebx_350 + 0x06:word16]);
					}
					word32 esp_460 = esp_348 - 0x04;
					Mem461[esp_460 + 0x00:word32] = 0x8000;
					Mem463[esp_460 - 0x04 + 0x00:word32] = 0x00;
					Mem466[esp_460 - 0x08 + 0x00:word32] = Mem463[ebp_133 - 0x20 + 0x00:word32];
					VirtualFree(Mem466[esp_460 - 0x08 + 0x00:LPVOID], Mem466[esp_460 - 0x04 + 0x00:SIZE_T], Mem466[esp_460 + 0x00:DWORD]);
					esp_134 = esp_460 + 0x04;
					goto l0040144A;
				}
			}
			goto l004011E7;
		}
	}
	Mem571[ebx_350 + 0x78:word32] = 0x00;
	Mem572[ebx_350 + 0x7C:word32] = 0x00;
	goto l004012F2;
}

// 00401466: Register word32 fn00401466(Register word32 ebp, Register word32 edi)
word32 fn00401466(word32 ebp, word32 edi)
{
	word32 ebp_126 = fp - 0x04;
	word32 eax_12 = Mem0[Mem0[edi + 0x3C:word32] + edi + 0x80:word32];
	if (eax_12 != 0x00)
	{
		word32 eax_54 = eax_12 + edi;
		if (Mem0[eax_54 + 0x0C:word32] != 0x00)
		{
			word32 esp_118 = fp - 0x18;
			word32 ebx_148 = eax_54 + 0x0C;
			byte bl_149 = (byte) (eax_54 + 0x0C);
			byte bh_150 = SLICE(eax_54 + 0x0C, byte, 8);
			while (Mem0[ebp_126 - 0x04 + 0x00:word32] == 0x00)
			{
				word32 esp_105 = esp_118 - 0x04;
				Mem106[esp_105 + 0x00:word32] = Mem0[ebx_148 + 0x00:word32] + edi;
				word32 eax_108 = GetModuleHandleA(Mem106[esp_105 + 0x00:LPCSTR]);
				word32 edx_110 = Mem106[ebp_126 + 0x08:word32];
				Mem113[ebp_126 - 0x08 + 0x00:word32] = eax_108;
				Mem116[esp_105 + 0x00:word32] = fn0040153A(edx_110);
				Mem119[esp_105 - 0x04 + 0x00:word32] = Mem116[ebp_126 - 0x08 + 0x00:word32];
				esp_118 = esp_105 - 0x04;
				byte cl_121;
				byte ch_122;
				byte dl_123;
				byte dh_124;
				word32 ebx_125;
				word32 esi_127;
				word32 eax_129 = fn00401AC8(bl_149, bh_150, dwArg00, out cl_121, out ch_122, out dl_123, out dh_124, out ebx_125, out ebp_126, out esi_127, out edi);
				if (eax_129 != 0x00)
				{
					word32 ecx_154 = Mem119[ebx_125 + 0x04:word32] + edi;
					while (true)
					{
						word32 edx_160 = ecx_154[esi_127 * 0x04];
						if (edx_160 == 0x00)
							break;
						if (edx_160 == eax_129)
						{
							Mem172[esp_105 - 0x08 + 0x00:word32] = 706632649;
							Mem173[ebp_126 - 0x04 + 0x00:word32] = ecx_154 + esi_127 * 0x04;
							Mem176[esp_105 - 0x0C + 0x00:word32] = fn0040192D();
							byte cl_177;
							byte ch_178;
							byte dl_179;
							byte dh_180;
							word32 ebx_181;
							word32 ebp_182;
							word32 esi_183;
							word32 edi_184;
							word32 eax_185 = fn00401AC8(bl_149, bh_150, dwArg00, out cl_177, out ch_178, out dl_179, out dh_180, out ebx_181, out ebp_182, out esi_183, out edi_184);
							Mem188[esp_105 - 0x10 + 0x00:word32] = ebp_182 - 0x0C;
							Mem190[esp_105 - 0x14 + 0x00:word32] = 0x04;
							Mem192[esp_105 - 0x18 + 0x00:word32] = 0x04;
							Mem195[esp_105 - 0x1C + 0x00:word32] = Mem192[ebp_182 - 0x04 + 0x00:word32];
							byte SCZO_198;
							word32 eax_199;
							word32 esi_201;
							byte SZO_202;
							bool C_203;
							bool Z_204;
							word32 edx_206;
							word32 ecx_207;
							byte bl_208;
							byte bh_209;
							byte cl_210;
							byte ch_211;
							byte dl_212;
							byte dh_213;
							eax_185();
							Mem216[Mem195[ebp_126 - 0x04 + 0x00:word32] + 0x00:word32] = Mem195[ebp_126 + 0x0C:word32];
							break;
						}
						esi_127 = esi_127 - ~0x00;
					}
				}
				word32 ebx_147 = ebx_125 + 0x01;
				ebx_148 = ebx_147 + 0x13;
				bl_149 = (byte) (ebx_147 + 0x13);
				bh_150 = SLICE(ebx_147 + 0x13, byte, 8);
				if (Mem119[ebx_147 + 0x13:word32] == 0x00)
					break;
			}
		}
	}
	return edi;
}

// 0040153A: Register word32 fn0040153A(Register word32 edx)
word32 fn0040153A(word32 edx)
{
	word32 esi_17 = 0x00;
	word32 eax_11 = fn00401901(edx);
	while (Mem0[edx + 0x00:byte] != 0x00)
	{
		esi_17 = esi_17 *s 65599 + (word32) Mem0[edx + 0x00:word16];
		edx = edx + 0x01;
	}
	if (esi_17 < 0x00)
		esi_17 = esi_17 & 0x7FFF0000 | eax_11 + 0x5BBB;
	return esi_17;
}

// 00401584: void fn00401584(Stack word32 dwArg04, Stack word32 dwArg08, Stack word32 dwArg0C)
void fn00401584(word32 dwArg04, word32 dwArg08, word32 dwArg0C)
{
	if (dwArg08 >=u 0x04)
	{
		word32 esi_36 = dwArg04;
		word32 edi_37 = dwArg04;
		word32 ecx_40 = dwArg08 - 0x03;
		word32 edx_43 = dwArg0C;
		do
		{
			Mem52[edi_37 + 0x00:word32] = Mem0[esi_36 + 0x00:word32] ^ edx_43;
			esi_36 = esi_36 + 0x01;
			edi_37 = edi_37 + 0x01;
			edx_43 = __ror(edx_43 + ecx_40, 0x0D);
			ecx_40 = ecx_40 - 0x01;
		} while (ecx_40 != 0x00);
	}
}

// 004015D5: void fn004015D5(Register word32 ebx, Stack word32 dwArg04, Stack word32 dwArg08, Stack word32 dwArg0C)
void fn004015D5(word32 ebx, word32 dwArg04, word32 dwArg08, word32 dwArg0C)
{
	word32 edi_20 = fp - 0x010C;
	word32 ecx_21 = 0x0100;
	while (ecx_21 != 0x00)
	{
		Mem25[edi_20 + 0x00:byte] = 0x00;
		edi_20 = edi_20 + 0x01;
		ecx_21 = ecx_21 - 0x01;
	}
	word32 edi_135 = dwArg04;
	do
	{
		byte al_46 = (byte) fn0040181B();
		word32 esi_47 = (word32) al_46;
		word32 eax_49 = fp - 0x010C + esi_47;
		if (Mem0[eax_49 + 0x00:byte] == 0x00)
		{
			Mem105[eax_49 + 0x00:byte] = 0x01;
			fn00401584(dwArg04, ebx, esi_47);
			word32 ecx_107 = dwArg04;
			word32 edx_108 = ebx;
			word32 eax_109 = 1207949762;
			do
			{
				eax_109 = eax_109 *s 33 ^ (word32) Mem105[ecx_107 + 0x00:byte];
				ecx_107 = ecx_107 + 0x01;
				edx_108 = edx_108 - 0x01;
			} while (edx_108 != 0x00);
			fn00401584(dwArg04, ebx, esi_47);
			edi_135 = eax_109;
			bLoc05 = al_46;
		}
	} while (edi_135 != dwArg0C);
	fn00401584(dwArg04, ebx, (word32) bLoc05);
	fn00401584(dwArg04, ebx, dwArg08);
}

// 0040168F: Register word32 fn0040168F(Register word32 esi, Register word32 edi, Stack word32 dwArg04, Stack word32 dwArg08, Stack word32 dwArg10)
word32 fn0040168F(word32 esi, word32 edi, word32 dwArg04, word32 dwArg08, word32 dwArg10)
{
	word32 eax_32 = CreateEventA(dwArg04, VirtualAlloc(0x00, dwArg08, 0x3000, 0x40), edi, esi);
	word32 esp_33 = fp - 0x04;
	if (eax_32 != dwArg10 || eax_32 == ~0x00)
		VirtualFree(Mem89[esp_70 + 0x00:LPVOID], Mem90[esp_70 + 0x04:SIZE_T], Mem91[esp_70 + 0x08:DWORD]);
	word32 esp_43 = esp_33 - 0x04;
	Mem44[esp_43 + 0x00:word32] = 0x8000;
	Mem46[esp_43 - 0x04 + 0x00:word32] = 0x00;
	Mem49[esp_43 - 0x08 + 0x00:word32] = Mem46[esp_43 + 0x14:word32];
	VirtualFree(Mem92[esp_43 - 0x08 + 0x00:LPVOID], Mem93[esp_43 - 0x04 + 0x00:SIZE_T], Mem94[esp_43 + 0x00:DWORD]);
	return edi_53;
}

// 004016F1: Register word32 fn004016F1(Stack word32 dwArg04)
word32 fn004016F1(word32 dwArg04)
{
	word32 eax_13;
	if (dwArg04 == 0x00)
		eax_13 = 0x00;
	else
		eax_13 = (uint32) ((uint64) (uint32) fn0040181B() % dwArg04);
	return eax_13;
}

// 00401713: Register word32 fn00401713(Register word32 eax, Register byte cl, Register byte ch, Register word32 ebp)
word32 fn00401713(word32 eax, byte cl, byte ch, word32 ebp)
{
	word32 eax_211;
	word32 esi_109 = Mem0[eax + 0x3C:word32] + eax;
	word32 ebp_111 = fp - 0x04;
	word32 esp_112 = fp - 0x20;
	word32 eax_34 = (word32) Mem0[esi_109 + 0x14:word16] + 0x18 + esi_109;
	if (0x00 <u Mem0[esi_109 + 0x06:word16])
	{
		word32 eax_108 = eax_34 + 0x24;
		do
		{
			word32 ecx_113 = Mem0[eax_108 + 0x00:word32];
			word32 edi_117 = 0x00;
			if ((ecx_113 & 0x20000000) != 0x00)
			{
				edi_117 = (0x00 - (-(ecx_113 & 0x80000000) == 0x00) & 0x20) - ~0x1F;
				goto l0040179B;
			}
			word32 esp_232;
			if (ecx_113 < 0x00)
			{
				esp_232 = esp_112 - 0x04 + 0x04;
				Mem236[esp_232 + 0x00:word32] = 0x04;
				goto l0040179A;
			}
			if ((ecx_113 & 0x40000000) != 0x00)
			{
				esp_232 = esp_112 - 0x04;
				Mem241[esp_232 + 0x00:word32] = 0x02;
l0040179A:
				edi_117 = Mem0[esp_232 + 0x00:word32];
				esp_112 = esp_232 + 0x00;
			}
l0040179B:
			if ((ecx_113 & 0x04000000) != 0x00)
				edi_117 = edi_117 | 0x0200;
			if (edi_117 != 0x00)
			{
				word32 ebx_158 = Mem0[eax_108 - 0x18 + 0x00:word32] + Mem0[ebp_111 + 0x08:word32];
				word32 eax_157 = Mem0[eax_108 - 0x1C + 0x00:word32];
				word32 esp_162 = esp_112 - 0x04;
				Mem163[esp_162 + 0x00:word32] = 706632649;
				Mem164[ebp_111 - 0x10 + 0x00:word32] = eax_157;
				Mem167[esp_162 - 0x04 + 0x00:word32] = fn0040192D();
				byte bl_159 = (byte) ebx_158;
				byte bh_160 = SLICE(ebx_158, byte, 8);
				byte cl_169;
				byte ch_170;
				byte dl_171;
				byte dh_172;
				word32 ebx_173;
				word32 ebp_174;
				word32 esi_175;
				word32 edi_176;
				word32 eax_177 = fn00401AC8(bl_159, bh_160, dwArg00, out cl_169, out ch_170, out dl_171, out dh_172, out ebx_173, out ebp_174, out esi_175, out edi_176);
				Mem180[esp_162 - 0x08 + 0x00:word32] = ebp_174 - 0x0C;
				Mem182[esp_162 - 0x0C + 0x00:word32] = edi_176;
				Mem185[esp_162 - 0x10 + 0x00:word32] = Mem182[ebp_174 - 0x10 + 0x00:word32];
				Mem187[esp_162 - 0x14 + 0x00:word32] = ebx_173;
				byte SCZO_190;
				byte ch_191;
				byte SZO_192;
				bool C_193;
				word32 ebx_194;
				word32 eax_196;
				word32 ecx_197;
				word32 edi_198;
				word16 cx_199;
				bool Z_200;
				bool S_201;
				byte cl_202;
				byte bl_203;
				byte bh_204;
				byte dl_205;
				byte dh_206;
				eax_177();
				if (eax_196 == 0x00)
				{
					eax_211 = 0x00;
					return eax_211;
				}
				eax_108 = Mem187[ebp_111 - 0x08 + 0x00:word32];
			}
			word32 ecx_148 = (word32) Mem0[esi_109 + 0x06:word16];
			Mem150[ebp_111 - 0x04 + 0x00:word32] = Mem0[ebp_111 - 0x04 + 0x00:word32] + 0x01;
			word32 eax_151 = eax_108 - ~0x13;
			Mem153[ebp_111 - 0x08 + 0x00:word32] = eax_151 + 0x14;
			eax_108 = eax_151 + 0x14;
		} while (Mem153[ebp_111 - 0x04 + 0x00:word32] <u ecx_148);
	}
	word32 esp_89 = esp_112 - 0x04;
	Mem90[esp_89 + 0x00:word32] = 0x01;
	Mem92[esp_89 + 0x00:word32] = Mem90[esp_89 + 0x00:word32];
	eax_211 = Mem92[esp_89 + 0x00:word32];
	return eax_211;
}

// 0040181B: Register word32 fn0040181B()
word32 fn0040181B()
{
	word64 edx_eax_11 = __rdtsc();
	word32 eax_13 = (word32) edx_eax_11;
	return eax_13 ^ __rol(SLICE(edx_eax_11, word32, 32) *s eax_13 + SCZDOP, (byte) (eax_13 & 0x0F));
}

// 00401832: Register DWORD Win32CrtStartup()
DWORD Win32CrtStartup()
{
	return ZfXtnlxWyhustKrybOty(bh, bl, esi, dwArg04, dwArg08, dwArg0C);
}

// 00401833: Register word32 ZfXtnlxWyhustKrybOty(Register byte bh, Register byte bl, Register word32 esi, Stack word32 dwArg08, Stack word32 dwArg0C, Stack word32 dwArg10)
word32 ZfXtnlxWyhustKrybOty(byte bh, byte bl, word32 esi, word32 dwArg08, word32 dwArg0C, word32 dwArg10)
{
ZfXtnlxWyhustKrybOty_entry:
	word32 eax_189
	GetModuleHandleW(Mem191[esp_13 + 0x00:LPCWSTR])
	Mem31[esp_16 - 0x04 + 0x00:word32] = 0x00
	word32 esp_33
	word32 ebp_34
	word32 esi_35
	word32 edi_36
	byte SZO_37
	bool C_38
	word32 eax_39
	word32 ecx_40
	bool Z_41
	byte SCZO_42
	byte SO_44
	byte bl_46
	byte bh_43
	word32 ebx_45
	call esi_18 (retsize: 4; depth: 4)
		uses: bh_26,bl_29,C_21,dwLoc04_5,dwLoc08_8,dwLoc0C_14,eax_32,ebp_17,ebx_28,ecx_23,edi_19,esi_18,esp_30,SCZO_25,SO_27,SZO_20,Z_24
		defs: bh_43,bl_46,C_38,eax_39,ebp_34,ebx_45,ecx_40,edi_36,esi_35,esp_33,SCZO_42,SO_44,SZO_37,Z_41
	Mem48[esp_33 - 0x04 + 0x00:word32] = eax_39
	word32 eax_50 = getenv(Mem48[esp_33 - 0x04 + 0x00:(ptr32 char)])
	word32 ecx_135 = Mem48[esp_33 - 0x04 + 0x00:word32]
	word32 esp_104 = esp_33
	branch eax_50 != 0x00 l004018CC
	goto l0040185C
l00401833:
l0040185C:
	Mem128[esp_33 - 0x04 + 0x00:word32] = 0x61
	Mem130[esp_33 - 0x08 + 0x00:word32] = 0x66
	word32 eax_132 = is_wctype(Mem130[esp_33 - 0x08 + 0x00:wint_t], Mem130[esp_33 - 0x04 + 0x00:wctype_t])
	ecx_135 = Mem130[esp_33 - 0x04 + 0x00:word32]
	esp_104 = esp_33
	branch eax_132 != 0x00 l004018CC
l00401872:
	Mem141[esp_33 - 0x04 + 0x00:word32] = 0x00
	branch GetModuleHandleW(Mem141[esp_33 - 0x04 + 0x00:LPCWSTR]) == 0x00 || (dwArg0C >=u 0x04 || ((word32) wArg08 != 0x00 || (dwArg10 & ~0x01) != 0x00)) l004018B5
	goto l004018A0
l0040187D:
l00401887:
l00401893:
l004018A0:
	Mem178[esp_33 - 0x04 + 0x00:word32] = 0x01
	Mem181[esp_33 - 0x08 + 0x00:word32] = dwArg10
	Mem184[esp_33 - 0x0C + 0x00:word32] = dwArg0C
	Mem188[esp_33 - 0x10 + 0x00:word32] = dwArg08
	eax_189 = fn0040112F(ebp_34, dwArg00, dwArg04, dwArg0C)
	goto l004018FB
l004018B5:
	Mem152[esp_33 - 0x04 + 0x00:word32] = 0x00
	Mem154[esp_33 - 0x08 + 0x00:word32] = 0x00
	Mem156[esp_33 - 0x0C + 0x00:word32] = 0x00
	Mem158[esp_33 - 0x10 + 0x00:word32] = 0x00
	Mem165[esp_33 - 0x04 + 0x00:word32] = fn0040112F(ebp_34, dwArg00, dwArg04, dwArg0C)
	ExitProcess(Mem165[esp_33 - 0x04 + 0x00:UINT])
l004018CC:
	word32 eax_89 = __indw(0x68)
	__bound(esp_104, dwLoc59)
	bh_43 = bh_43 * 0x02
	bool v16_100 = (Mem48[ecx_135 + 0x39:byte] & 0x02) != 0x00
	Mem101[ecx_135 + 0x39:byte] = __rcr(Mem48[ecx_135 + 0x39:byte], 0x01, (bool) cond(bh_43))
	eax_189 = eax_89 + 0x5058058C
	ebx_45 = DPB(ebx_45, bh_43, 8) (alias)
	branch bh_43 >= 0x00 l004018E6
l004018DE:
	branch bh_43 == 0x00 l004018F9
l004018E4:
	word32 esp_115 = esp_104 - 0x04
	Mem116[esp_115 + 0x00:word32] = 0x00
	Mem120[esp_115 - 0x04 + 0x00:word32] = dwArg10
	esp_104 = esp_115 - 0x04
	goto l004018E8
l004018E6:
	branch bh_43 != 0x00 l004018F8
l004018E8:
	branch CommConfigDialogW(Mem101[esp_104 + 0x00:LPCWSTR], Mem101[esp_104 + 0x04:HWND], Mem101[esp_104 + 0x08:LPCOMMCONFIG]) != 0x00 l004018CC
l004018F8:
	esp_104 = esp_104 - 0x04
	Mem123[esp_104 + 0x00:word32] = Mem101[ebx_45 + 0x00:word32]
l004018F9:
l004018FA:
	Mem125[0x5E:byte] = __rcr(Mem123[0x5E:byte], 0x5D, v16_100)
l004018FB:
l004018FE:
	return eax_189
ZfXtnlxWyhustKrybOty_exit:
}

// 00401901: Register word32 fn00401901(Stack word32 dwArg04)
word32 fn00401901(word32 dwArg04)
{
	word32 ecx_12 = 0x00;
	word32 edi_18 = dwArg04;
	while (true)
	{
		edi_18 = edi_18 + 0x01;
		if (0x00 == Mem0[edi_18 + 0x00:byte])
			break;
		ecx_12 = ecx_12 + 0x01;
	}
	return ecx_12;
}

// 0040192D: Register word32 fn0040192D()
word32 fn0040192D()
{
	word32 esi_12 = Mem0[Mem0[Mem0[fs:0x30:word32] + 0x0C:word32] + 0x1C:word32];
	do
	{
		word32 eax_14 = Mem0[esi_12 + 0x08:word32];
		word32 edi_15 = Mem0[esi_12 + 0x20:word32];
		esi_12 = Mem0[esi_12 + 0x00:word32];
	} while (Mem0[edi_15 + 0x00:byte] != 0x6B || Mem0[edi_15 + 0x18:byte] != 0x00);
	return eax_14;
}

// 0040195A: Register word32 fn0040195A(Register word32 ecx, Register word32 edx, Register word32 edi)
word32 fn0040195A(word32 ecx, word32 edx, word32 edi)
{
	if (ecx == 0x00 || edx == 0x00)
		return esi;
	byte CZ_34 = DPB(CZ, false, 0);
	if (edi == 0x00)
		return esi;
	if (CZ_34)
		return esi;
	word32 edx_38 = edx - ecx;
	return fn0040197D(ecx, edx_38, edi);
}

// 0040197D: Register word32 fn0040197D(Register word32 ecx, Register word32 edx, Register word32 esi)
word32 fn0040197D(word32 ecx, word32 edx, word32 esi)
{
	ptr32 fp;
	word32 edx;
	word32 ecx;
	<type-error> Mem0;
	word32 esi;
	word32 dwArg00;
	esp_1 = fp;
	al_5 = Mem0[edx + ecx:byte];
	esi_8 = IigGbliiYnqdwsdIovvTm(al_5, ecx, edx, esi, dwArg00);
	return esi_8;
}

// 00401980: Register word32 IigGbliiYnqdwsdIovvTm(Register byte al, Register word32 ecx, Register word32 edx, Register word32 esi, Stack word32 dwArg00)
word32 IigGbliiYnqdwsdIovvTm(byte al, word32 ecx, word32 edx, word32 esi, word32 dwArg00)
{
	Mem3[ecx + 0x00:byte] = al;
	if (esi != 0x01)
		return fn0040197D(ecx + 0x01, edx, esi - 0x01);
	return dwArg00;
}

// 00401996: Register word32 fn00401996(Register word32 ebp, Register word32 esi)
word32 fn00401996(word32 ebp, word32 esi)
{
	word32 eax_13 = Mem0[esi + 0x00:word32];
	Mem15[esi + 0x04:word32] = Mem0[esi + 0x04:word32] & 0x00;
	word32 ebx_100 = (word32) __ror(Mem15[Mem15[eax_13 + 0x3C:word32] + 0x08 + eax_13:word16] ^ 0x68E1, 0x01) + eax_13;
	word32 esi_38 = fn0040195A(esi + 0x08, ebx_100 + 0x10, 0x20);
	Mem41[fp - 0x14 + 0x00:word32] = 0x737C4887;
	Mem43[fp - 0x18 + 0x00:word32] = 0x20;
	Mem46[fp - 0x1C + 0x00:word32] = esi_38 + 0x08;
	fn00401584(dwArg00, dwArg04, dwArg08);
	word32 eax_51 = Mem46[esi_38 + 0x24:word32];
	Mem53[esi_38 + 0x10:word32] = Mem46[esi_38 + 0x10:word32] - eax_51;
	Mem55[esi_38 + 0x1C:word32] = Mem53[esi_38 + 0x1C:word32] + eax_51;
	Mem59[esi_38 + 0x08:word32] = Mem55[esi_38 + 0x08:word32] + eax_51 *s ~0x07;
	Mem65[esi_38 + 0x18:word32] = Mem59[esi_38 + 0x18:word32] + eax_51 *s ~0x0F;
	Mem68[esi_38 + 0x0C:word32] = Mem65[esi_38 + 0x0C:word32] + -eax_51 * 0x02;
	word32 ecx_70 = Mem68[esi_38 + 0x0C:word32];
	Mem72[fp - 0x14 + 0x00:word32] = 0x40;
	Mem75[fp - 0x18 + 0x00:word32] = 0x3000;
	Mem77[fp - 0x1C + 0x00:word32] = ecx_70 + 0x20;
	Mem79[fp - 0x20 + 0x00:word32] = 0x00;
	word32 eax_81 = VirtualAlloc(Mem79[fp - 0x20 + 0x00:LPVOID], Mem79[fp - 0x1C + 0x00:SIZE_T], Mem79[fp - 0x18 + 0x00:DWORD], Mem79[fp - 0x14 + 0x00:DWORD]);
	Mem83[esi_38 + 0x04:word32] = eax_81;
	word32 esp_82 = fp - 0x10;
	word32 dwLoc08_84 = eax_81;
	word32 dwLoc0C_103 = 0x04;
	do
	{
		word32 esi_93 = fn0040195A(dwLoc08_84, ebx_100 + 0x10, Mem83[ebx_100 + 0x08:word32]);
		word32 v22_102 = dwLoc0C_103 - 0x01;
		esp_82 = esp_82 + 0x04;
		dwLoc08_84 = dwLoc08_84 + Mem83[ebx_100 + 0x08:word32];
		ebx_100 = (Mem83[ebx_100 + 0x0C:word32] ^ 1187211489) + Mem83[esi_93 + 0x00:word32];
		dwLoc0C_103 = v22_102;
	} while (v22_102 != 0x00);
	Mem107[esi_93 + 0x04:word32] = Mem83[esi_93 + 0x04:word32] + 0x1D;
	Mem109[esi_93 + 0x04:word32] = Mem107[esi_93 + 0x04:word32] - ~0x02;
	return Mem109[esp_82 + 0x04:word32];
}

// 00401A52: Register word32 fn00401A52(Register word32 ecx, Register word32 edi, Stack word32 dwArg08, Register out ptr32 ebxOut, Register out ptr32 ebpOut, Register out ptr32 esiOut, Register out ptr32 ediOut)
word32 fn00401A52(word32 ecx, word32 edi, word32 dwArg08, ptr32 & ebxOut, ptr32 & ebpOut, ptr32 & esiOut, ptr32 & ediOut)
{
	*ebxOut = ebx;
	*ediOut = edi;
	word32 ecx_19 = (word32) Mem0[dwArg08 + 0x0C:word16];
	word32 eax_20 = (word32) Mem0[dwArg08 + 0x0E:word16] + ecx_19;
	if (eax_20 == 0x00)
	{
		word32 esi_43;
		*esiOut = esi;
		word32 ebp_45;
		*ebpOut = ebp;
		return eax_20;
	}
	else
	{
		word32 ebx_38;
		word32 ebp_39;
		word32 esi_40;
		word32 edi_41;
		return KaqKcgzYxmcfxqXq(ecx_19, fp - 0x04, dwArg08, edi, out ebx_38, out ebp_39, out esi_40, out edi_41);
	}
}

// 00401A6F: Register word32 KaqKcgzYxmcfxqXq(Register word32 ecx, Register word32 ebp, Register word32 esi, Register word32 edi, Register out ptr32 ebxOut, Register out ptr32 ebpOut, Register out ptr32 esiOut, Register out ptr32 ediOut)
word32 KaqKcgzYxmcfxqXq(word32 ecx, word32 ebp, word32 esi, word32 edi, ptr32 & ebxOut, ptr32 & ebpOut, ptr32 & esiOut, ptr32 & ediOut)
{
	word32 ebx_17 = Mem0[ebp + 0x10:word32];
	word32 edi_10 = Mem0[ebp + 0x08:word32];
	Mem11[ebp + 0x0C:word32] = esi + 0x14;
	word32 esp_20 = fp - 0x04;
	do
	{
		word32 eax_22 = Mem11[Mem11[ebp + 0x0C:word32] + 0x00:word32];
		if (eax_22 < 0x00)
		{
			word32 esp_56 = esp_20 - 0x04;
			Mem57[esp_56 + 0x00:word32] = ebx_17;
			Mem61[esp_56 - 0x04 + 0x00:word32] = (eax_22 & 0x7FFFFFFF) + edi_10;
			Mem63[esp_56 - 0x08 + 0x00:word32] = edi_10;
			fn00401A52(ecx, edi_10, dwArg04, out ebx_17, out ebp, out esi, out edi_10);
			esp_20 = esp_56 + 0x08;
		}
		else
		{
			word32 eax_71 = eax_22 + edi_10;
			Mem73[eax_71 + 0x00:word32] = Mem11[eax_71 + 0x00:word32] + ebx_17;
		}
		word32 eax_31 = (word32) Mem11[esi + 0x0E:word16];
		ecx = (word32) Mem11[esi + 0x0C:word16];
		Mem34[ebp - 0x04 + 0x00:word32] = Mem11[ebp - 0x04 + 0x00:word32] + 0x01;
		Mem36[ebp + 0x0C:word32] = Mem34[ebp + 0x0C:word32] + 0x06;
		Mem38[ebp + 0x0C:word32] = Mem36[ebp + 0x0C:word32] + 0x02;
		word32 eax_39 = eax_31 + ecx;
	} while (Mem38[ebp - 0x04 + 0x00:word32] <u eax_39);
	word32 esp_43 = esp_20 + 0x04;
	word32 edi_42;
	*ediOut = Mem38[esp_20 + 0x00:word32];
	word32 ebx_44;
	*ebxOut = Mem38[esp_43 + 0x00:word32];
	word32 esi_47;
	*esiOut = Mem0[esp_43 + 0x04:word32];
	word32 ebp_49;
	*ebpOut = Mem0[ebp + 0x00:word32];
	return eax_39;
}

// 00401AC8: Register word32 fn00401AC8(Register byte bl, Register byte bh, Stack word32 dwArg04, Register out ptr32 clOut, Register out ptr32 chOut, Register out ptr32 dlOut, Register out ptr32 dhOut, Register out ptr32 ebxOut, Register out ptr32 ebpOut, Register out ptr32 esiOut, Register out ptr32 ediOut)
word32 fn00401AC8(byte bl, byte bh, word32 dwArg04, ptr32 & clOut, ptr32 & chOut, ptr32 & dlOut, ptr32 & dhOut, ptr32 & ebxOut, ptr32 & ebpOut, ptr32 & esiOut, ptr32 & ediOut)
{
	*ebxOut = ebx;
	*ediOut = edi;
	word32 eax_16 = Mem0[dwArg04 + 0x3C:word32] + dwArg04;
	word32 esi_21 = Mem0[eax_16 + 0x78:word32];
	byte cl_22;
	byte ch_23;
	byte dl_24;
	byte dh_25;
	byte bl_26;
	word32 ebp_27;
	word32 esi_28;
	return SzfkIjqwtBv(eax_16, dwArg04, fp - 0x04, esi_21, out cl_22, out ch_23, out dl_24, out dh_25, out bl_26, out ebp_27, out esi_28);
}

// 00401AE6: Register word32 SzfkIjqwtBv(Register word32 eax, Register word32 ecx, Register word32 ebp, Register word32 esi, Register out ptr32 clOut, Register out ptr32 chOut, Register out ptr32 dlOut, Register out ptr32 dhOut, Register out ptr32 blOut, Register out ptr32 ebpOut, Register out ptr32 esiOut)
word32 SzfkIjqwtBv(word32 eax, word32 ecx, word32 ebp, word32 esi, ptr32 & clOut, ptr32 & chOut, ptr32 & dlOut, ptr32 & dhOut, ptr32 & blOut, ptr32 & ebpOut, ptr32 & esiOut)
{
	*clOut = cl;
	*chOut = ch;
	*dlOut = dl;
	*dhOut = dh;
	*blOut = bl;
	word32 eax_127;
	word32 esp_1 = fp;
	if (esi == 0x00)
	{
		eax_127 = 0x00;
		goto l00401C18;
	}
	word32 edi_138;
	word32 esi_69 = esi + ecx;
	word32 edx_64 = Mem0[ebp + 0x0C:word32];
	word32 ebx_70 = Mem0[esi_69 + 0x20:word32];
	word32 edi_73 = Mem0[esi_69 + 0x1C:word32];
	Mem74[ebp - 0x0C + 0x00:word32] = Mem0[eax + 0x7C:word32];
	word32 eax_246 = Mem74[esi_69 + 0x24:word32] + ecx;
	Mem81[ebp - 0x08 + 0x00:word32] = eax_246;
	word32 esp_103 = fp - 0x08;
	word32 ebx_77 = ebx_70 + ecx;
	word32 edi_80 = edi_73 + ecx;
	if (edx_64 < 0x00)
	{
		word32 edx_222 = (edx_64 & 0x7FFFFFFF) - Mem81[esi_69 + 0x10:word32];
		byte dl_223 = (byte) edx_222;
		*dlOut = dl_223;
		byte dh_224 = SLICE(edx_222, byte, 8);
		*dhOut = dh_224;
		if (edx_222 >=u Mem81[esi_69 + 0x14:word32])
			goto l00401BFB;
		edi_138 = edi_80[edx_222 * 0x04];
	}
	else
	{
		Mem231[ebp - 0x04 + 0x00:word32] = 0x00;
		word32 edx_228 = 0x00;
		byte dl_229;
		*dlOut = 0x00;
		byte dh_230;
		*dhOut = 0x00;
		bool Z_235 = (bool) cond(0x00 - Mem231[esi_69 + 0x18:word32]);
		if (0x00 <u Mem231[esi_69 + 0x18:word32])
		{
			while (Mem231[ebp + 0x0C:word32] != fn0040153A(ebx_77[edx_228 * 0x04] + ecx))
			{
				Mem277[ebp - 0x04 + 0x00:word32] = Mem231[ebp - 0x04 + 0x00:word32] + 0x01;
				if (Mem277[ebp - 0x04 + 0x00:word32] >=u Mem277[esi_69 + 0x18:word32])
					break;
				ecx = Mem277[ebp + 0x08:word32];
				edx_228 = Mem277[ebp - 0x04 + 0x00:word32];
			}
			edx_228 = Mem231[ebp - 0x04 + 0x00:word32];
			ecx = Mem231[ebp + 0x08:word32];
			byte dl_265;
			*dlOut = (byte) edx_228;
			byte dh_266;
			*dhOut = SLICE(edx_228, byte, 8);
			byte cl_268;
			*clOut = (byte) ecx;
			byte ch_269;
			*chOut = SLICE(ecx, byte, 8);
			eax_246 = Mem231[ebp - 0x08 + 0x00:word32];
			Z_235 = (bool) cond(edx_228 - Mem231[esi_69 + 0x18:word32]);
		}
		if (Z_235)
		{
l00401BFB:
			esp_103 = fp - 0x08;
			eax_127 = 0x00;
			goto l00401C16;
		}
		edi_138 = edi_80[(word32) eax_246[edx_228 * 0x02] * 0x04];
	}
	word32 edi_140 = edi_138 + ecx;
	if (edi_140 != 0x00 && (edi_140 <u Mem81[(ebp - 0x0C) + 0x00:word32] + esi_69 && edi_140 >=u esi_69))
	{
		word32 esi_170 = 0x00;
		if (Mem81[edi_140 + 0x00:byte] != 0x2E)
		{
			do
				esi_170 = esi_170 + 0x01;
			while (Mem81[esi_170 + edi_140:byte] != 0x2E);
		}
		memcpy(ebp - 0x0110, edi_140, esi_170);
		Mem190[ebp - 0x0110 + esi_170:byte] = 0x00;
		word32 eax_191 = LoadLibraryA(ebp - 0x0110);
		byte bl_194 = (byte) eax_191;
		byte bh_195 = SLICE(eax_191, byte, 8);
		if (eax_191 == 0x00)
			goto l00401BFB;
		fn0040153A(esi_170 + 0x01 + edi_140);
		esp_103 = fp - 0x10;
		byte cl_207;
		byte ch_208;
		byte dl_209;
		byte dh_210;
		word32 ebx_211;
		word32 esi_213;
		word32 edi_214;
		edi_140 = fn00401AC8(bl_194, bh_195, eax_191, out cl_207, out ch_208, out dl_209, out dh_210, out ebx_211, out ebp, out esi_213, out edi_214);
	}
	eax_127 = edi_140;
l00401C16:
	word32 esp_105 = esp_103 + 0x04;
	byte bl_107;
	*blOut = (byte) Mem81[esp_105 + 0x00:word32];
	esp_1 = esp_105 + 0x04;
l00401C18:
	word32 esi_30;
	*esiOut = Mem0[esp_1 + 0x00:word32];
	word32 ebp_32;
	*ebpOut = Mem0[ebp + 0x00:word32];
	return eax_127;
}

// 00401C1D: Register word32 fn00401C1D(Register byte dl, Register byte dh, Register word32 ebx, Register out ptr32 ebxOut, Register out ptr32 ebpOut, Register out ptr32 esiOut)
word32 fn00401C1D(byte dl, byte dh, word32 ebx, ptr32 & ebxOut, ptr32 & ebpOut, ptr32 & esiOut)
{
	word32 ebx_11;
	word32 ebp_12;
	word32 esi_13;
	return CapPyyfdoxHghkvPrpqfoo(ebx, fp - 0x04, out ebx_11, out ebp_12, out esi_13);
}

// 00401C29: Register word32 CapPyyfdoxHghkvPrpqfoo(Register word32 ebx, Register word32 ebp, Register out ptr32 ebxOut, Register out ptr32 ebpOut, Register out ptr32 esiOut)
word32 CapPyyfdoxHghkvPrpqfoo(word32 ebx, word32 ebp, ptr32 & ebxOut, ptr32 & ebpOut, ptr32 & esiOut)
{
	word32 esp_16 = fp - 0x02F8;
	word32 edi_12 = VirtualAlloc;
	do
	{
		word32 eax_126;
		word32 esp_17 = esp_16 - 0x04;
		Mem18[esp_17 + 0x00:word32] = 0x04;
		Mem20[esp_17 - 0x04 + 0x00:word32] = 0x2000;
		Mem23[esp_17 - 0x08 + 0x00:word32] = Mem20[ebp + 0x0C:word32];
		Mem26[esp_17 - 0x0C + 0x00:word32] = 0x00;
		byte SCZO_28;
		word32 esi_29;
		byte SZO_31;
		bool C_32;
		word32 eax_34;
		bool Z_35;
		word32 ebx_36;
		word32 edx_37;
		word32 ecx_38;
		word32 esp_117;
		edi_12();
		(ebp - 800)[esi_29 * 0x04] = eax_34;
		if (eax_34 == 0x00)
			goto l00401CD7;
		Mem75[esp_117 - 0x04 + 0x00:word32] = 0x01;
		Mem77[esp_117 - 0x04 + 0x00:word32] = Mem75[esp_117 - 0x04 + 0x00:word32] + esi_29;
		word32 esi_129 = Mem77[esp_117 - 0x04 + 0x00:word32];
		esp_16 = esp_117;
	} while (esi_129 <u 200);
	Mem83[esp_117 - 0x04 + 0x00:word32] = ebx_36;
	Mem85[esp_117 - 0x08 + 0x00:word32] = esi_129;
	word32 eax_87 = fn004016F1(dwArg00);
	if (esi_129 != 0x00)
	{
		do
		{
			if (esi_129 != eax_87)
			{
				Mem139[esp_117 - 0x08 + 0x00:word32] = 0x8000;
				Mem141[esp_117 - 0x0C + 0x00:word32] = 0x00;
				Mem144[esp_117 - 0x10 + 0x00:word32] = (ebp - 800)[esi_129 * 0x04];
				VirtualFree(Mem144[esp_117 - 0x10 + 0x00:LPVOID], Mem144[esp_117 - 0x0C + 0x00:SIZE_T], Mem144[esp_117 - 0x08 + 0x00:DWORD]);
			}
			esi_129 = esi_129 - 0x01;
		} while (esi_129 != 0x00);
	}
	word32 esi_94 = (ebp - 800)[eax_87 * 0x04];
	Mem96[esp_117 - 0x08 + 0x00:word32] = 0x04;
	Mem98[esp_117 - 0x0C + 0x00:word32] = 0x1000;
	Mem101[esp_117 - 0x10 + 0x00:word32] = Mem98[ebp + 0x0C:word32];
	Mem103[esp_117 - 0x14 + 0x00:word32] = esi_94;
	word32 esp_104;
	byte SCZO_105;
	word32 esi_106;
	word32 edi_107;
	byte SZO_108;
	bool C_109;
	word32 eax_111;
	bool Z_112;
	word32 ebx_113;
	word32 edx_114;
	word32 ecx_115;
	edi_12();
	word32 ebx_116;
	*ebxOut = Mem103[esp_104 + 0x00:word32];
	esp_117 = esp_104 + 0x04;
	if (eax_111 != 0x00)
	{
		esp_117 = esp_104 + 0x08;
		eax_126 = fn0040195A(esi_106, Mem103[ebp + 0x08:word32], Mem103[ebp + 0x0C:word32]);
	}
	else
	{
l00401CD7:
		eax_126 = 0x00;
	}
	word32 esi_55;
	*esiOut = Mem39[esp_117 + 0x04:word32];
	word32 ebp_57;
	*ebpOut = Mem39[ebp + 0x00:word32];
	return eax_126;
}

