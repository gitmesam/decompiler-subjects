// subject.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

// 00401000: Register Eq_2 Win32CrtStartup()
DWORD Win32CrtStartup()
{
	word32 esi_1058 = AddAce(null, 0x00, 0x00, null, 0x00) + 0x23 + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00);
	Eq_3 ebp_1093 = null;
	if (AreAnyAccessesGranted(~0x00, ~0x00) == 0x00)
		esi_1058 = esi_1058 - 0x22;
	CloseHandle((void *) 0x59);
	VirtualProtect(&globals->v401000, 0x3000, 0x40, fp - 0x08);
	struct Eq_680 * edx_1089 = null;
	do
	{
		if (ebp_1093 == esi_1058)
			ebp_1093 = null;
		edx_1089[0x00401480] = (struct Eq_680) (edx_1089[0x00401480] ^ ebp_1093[0x00404000]);
		edx_1089 = edx_1089 + 0x01;
		ebp_1093 = (Eq_3) (ebp_1093 + 0x01);
	} while (edx_1089 < (struct Eq_680 *) 5152);
	struct Eq_702 * esi_1117 = &globals->t402760;
	up32 edi_1121 = 0x00;
	up32 dwLoc04_1125 = 0x00;
	do
	{
		Eq_708 eax_1134 = esi_1117->t0004 - 0x08 >> 0x01;
		word16 * ecx_1137 = (char *) &esi_1117->t0004 + 0x04;
		if (eax_1134 > 0x00)
		{
			Eq_708 ebx_1285 = eax_1134;
			do
			{
				eax_1134 = (word32) *ecx_1137;
				if ((eax_1134 & 0xF000) == 0x3000)
				{
					struct Eq_738 * eax_1302 = (eax_1134 & 0x0FFF) + esi_1117->dw0000;
					eax_1302->dw401200 = eax_1302->dw401200 + 0xF0401200;
					eax_1134 = &eax_1302->dw401200;
				}
				ecx_1137 = ecx_1137 + 0x01;
				ebx_1285 = ebx_1285 - 0x01;
			} while (ebx_1285 != 0x00);
			edi_1121 = dwLoc04_1125;
		}
		edi_1121 = (word32) esi_1117->t0004 + edi_1121;
		dwLoc04_1125 = edi_1121;
		esi_1117 = esi_1117 + Mem1110[esi_1117 + 0x04:word32];
	} while (edi_1121 < 228);
	struct Eq_753 * esi_1156 = &globals->t401F5C;
	struct Eq_753 * dwLoc04_1157 = &globals->t401F5C;
	if (globals->dw401F6C != 0x00)
	{
		do
		{
			eax_1134 = LoadLibraryA(esi_1156->dw000C + 0x00401200);
			if (eax_1134 != 0x00)
			{
				struct Eq_790 * edi_1209 = esi_1156->dw0000;
				if (edi_1209 == null)
					edi_1209 = esi_1156->dw0010;
				eax_1134 = edi_1209->t401200;
				union Eq_799 * edi_1216 = &edi_1209->t401200;
				word32 * esi_1217 = esi_1156->dw0010 + 0x00401200;
				bool S_1220 = (bool) cond(eax_1134);
				if (eax_1134 != 0x00)
				{
					do
					{
						Eq_824 eax_1253;
						if (!S_1220)
							eax_1253 = GetProcAddress(eax_1134, (word32) *edi_1216);
						else
							eax_1253 = GetProcAddress(eax_1134, eax_1134 + 0x00401202);
						*esi_1217 = (word32) eax_1253;
						edi_1216 = (union Eq_799 *) ((char *) edi_1216 + 0x04);
						eax_1134 = *edi_1216;
						esi_1217 = esi_1217 + 0x01;
						S_1220 = (bool) cond(eax_1134);
					} while (eax_1134 != 0x00);
				}
				esi_1156 = dwLoc04_1157;
			}
			esi_1156 = esi_1156 + 0x01;
			dwLoc04_1157 = esi_1156;
		} while (esi_1156->dw0010 != 0x00);
	}
	fn00401C50(eax_1134, 0x00401C50);
	ExitProcess(0x00);
}

// 00401BFB: void fn00401BFB(Register Eq_708 eax, Register word32 edx, Stack (ptr32 Eq_854) dwArg00)
void fn00401BFB(Eq_708 eax, word32 edx, Eq_854 * dwArg00)
{
	if (S)
		fn00401C46(eax, edx);
	else
	{
		Eq_861 v6_13 = dwArg00->tE91E3724 << (byte) dwArg00;
		dwArg00->tE91E3724 = v6_13;
		*(eax - 0x03) = *(eax - 0x03) - 0x2D - (v6_13 < 0x00);
		fn00401C0D(al, edx);
	}
}

// 00401C0C: void fn00401C0C(Register Eq_708 eax, Register word32 edx)
void fn00401C0C(Eq_708 eax, word32 edx)
{
	byte al_4 = (byte) (eax - 2628479711);
	fn00401C0D(al_4, edx);
}

// 00401C0D: void fn00401C0D(Register byte al, Register word32 edx)
void fn00401C0D(byte al, word32 edx)
{
	__outb(dx, al);
}

// 00401C46: void fn00401C46(Register Eq_708 eax, Register word32 edx)
void fn00401C46(Eq_708 eax, word32 edx)
{
	Eq_708 eax_5 = (eax ^ ~0x048000BA) - 3127977714;
	fn00401C52(eax_5, edx);
}

// 00401C50: void fn00401C50(Register Eq_708 eax, Register word32 edx)
void fn00401C50(Eq_708 eax, word32 edx)
{
	ptr32 fp;
	bool O;
	Eq_708 eax;
	word32 edx;
	esp_1 = fp;
	if (O)
		fn00401C0C(eax, edx);
	else
		fn00401C52(eax, edx);
}

// 00401C52: void fn00401C52(Register Eq_708 eax, Register word32 edx)
void fn00401C52(Eq_708 eax, word32 edx)
{
}

// 00401C54: void fn00401C54()
void fn00401C54()
{
}

