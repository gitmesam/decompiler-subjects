// subject.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

// 004013C8: Register DWORD Win32CrtStartup()
DWORD Win32CrtStartup()
{
}

// 00405515: Register word32 fn00405515(Register word32 eax, Register word32 ecx, Register byte dl, Register byte dh, Register word32 ebx, Register word32 esi, Register out ptr32 ecxOut, Register out ptr32 ebxOut, Register out ptr32 ediOut)
word32 fn00405515(word32 eax, word32 ecx, byte dl, byte dh, word32 ebx, word32 esi, ptr32 & ecxOut, ptr32 & ebxOut, ptr32 & ediOut)
{
	*ebxOut = ebx;
	*ecxOut = ecx;
	word32 edi_3;
	*ediOut = 0xC0;
	if (ebx != 3540975544)
	{
		fn00405B86(eax, ecx, dl, bl, esi);
		return eax;
	}
	else
	{
		word32 edi_27;
		*ediOut = ~0x2F3B0850;
		word32 eax_34 = DPB(eax, al - 0xC1, 0);
		word32 ecx_42;
		*ecxOut = DPB(ecx, cl + 0xC6, 0);
		word32 ebx_54;
		*ebxOut = DPB(ebx, (bl & 0xC1 | 0xC6) ^ cl + 0xC6 ^ ~0x25, 0);
		return eax_34 | 0x00C5D0D8;
	}
}

// 0040555F: void fn0040555F(Register word32 eax, Register byte cl, Register byte dl, Register word16 bx, Register word32 esi, Register word32 edi)
void fn0040555F(word32 eax, byte cl, byte dl, word16 bx, word32 esi, word32 edi)
{
	ptr32 fp;
	byte cl;
	word32 edi;
	byte dl;
	word32 edx;
	word32 ebx;
	word32 eax;
	word32 esi;
	esp_1 = fp;
	cl_3 = cl + ~0x26;
	ecx_4 = 0xD5D6;
	edi_6 = edi & 0xC0C4C9C0;
	dl_8 = dl & 0xD0;
	edx_10 = DPB(edx, dl_8, 0);
	ecx_11 = 0x262F0D01;
	ch_12 = SLICE(ecx_11, byte, 8);
	cl_13 = ~0x29;
	ecx_14 = DPB(ecx_11, cl_13, 0);
	SZO_15 = cond(~0x29);
	C_16 = false;
	dl_17 = dl_8 & 0xC5;
	edx_18 = 0xD3CC;
	edi_19 = 0xD3CC;
	ebx_21 = ebx ^ 199;
	bh_22 = SLICE(ebx_21, byte, 8);
	ecx_23 = ecx_14 & 54223;
	bh_24 = bh_22 + 212;
	bh_25 = bh_24 | 0xC4;
	SZO_26 = cond(bh_25);
	C_27 = false;
	esp_28 = fp - 0x04;
	dwLoc04_30 = eax;
	eax_31 = dwLoc04_30;
	al_32 = (byte) eax_31;
	ah_33 = SLICE(eax_31, byte, 8);
	esp_34 = fp;
	edx_35 = 54222;
	C_36 = false;
	ebx_37 = 0xD3CC;
	edx_38 = 0xD308 - C_36;
	SCZO_39 = cond(edx_38);
	dl_40 = ~0x34;
	ecx_41 = ~0x65ABA44C;
	ch_42 = SLICE(ecx_41, byte, 8);
	dl_43 = 0x1B;
	dh_44 = 211;
	ebx_45 = 0xC0;
	bl_46 = (byte) ebx_45;
	bx_47 = (word16) ebx_45;
	dh_48 = 211;
	edx_49 = DPB(edx_38, dh_48, 8);
	SZO_50 = cond(211);
	C_51 = false;
	dh_52 = ch_42;
	edx_53 = DPB(edx_49, dh_52, 8);
	bl_54 = bl_46 - al_32;
	ebx_55 = DPB(ebx_45, bl_54, 0);
	bx_56 = DPB(bx_47, bl_54, 0);
	edx_57 = edx_53 ^ ~0x2C2F2E2C;
	dh_58 = SLICE(edx_57, byte, 8);
	C_59 = false;
	dl_60 = bl_54;
	dh_61 = dh_58 - 0xC6 - C_59;
	SCZO_62 = cond(dh_61);
	C_63 = (bool) SCZO_62;
	dh_64 = dh_61 + ~0x31 + (dh_61 <u 0x00);
	edx_65 = DPB(edx_57, dh_64, 8);
	ecx_66 = 16033;
	cl_67 = (byte) ecx_66;
	ch_68 = SLICE(ecx_66, byte, 8);
	edx_69 = edx_65 - ~0x30282D22;
	dh_70 = SLICE(edx_69, byte, 8);
	dh_71 = dh_70 - ch_68;
	SCZO_72 = cond(dh_71);
	edx_73 = edx_69 & 3569735626;
	dh_74 = SLICE(edx_73, byte, 8);
	bh_75 = 0x00 - al_32;
	edi_76 = 0x2227FDFE;
	dh_77 = dh_74 - ch_68;
	edx_78 = DPB(edx_73, dh_77, 8);
	edx_79 = edx_78 - 0x00D1DBD6;
	dl_80 = (byte) edx_79;
	bh_81 = bh_75 + 0xD2;
	SCZO_82 = cond(bh_81);
	ebx_83 = 0x00CCCFCC;
	bh_84 = SLICE(ebx_83, byte, 8);
	bl_85 = (byte) ebx_83;
	bx_86 = (word16) ebx_83;
	fn00405B86(eax_31, ecx_66, dl_80, bl_85, esi);
}

// 004055A2: void fn004055A2(Register word32 eax, Register byte ch, Register byte dl, Register byte bl, Register word32 edi, Stack word32 dwArg00)
void fn004055A2(word32 eax, byte ch, byte dl, byte bl, word32 edi, word32 dwArg00)
{
	esp = fp;
	esp = fp - 0x04;
	dwLoc04 = edi;
	edi = dwLoc04;
	esp = fp;
	esi = dwArg00;
	esp = fp + 0x04;
	edi = edi - 0xD7;
	SCZO = cond(edi);
	bl_edi = bl_edi - 0xC6000000D7;
	dl = dl - ch;
	SCZO = cond(dl);
	bl = bl + 0xC4 + C;
	ebx = ebx | 0x00CEDCC0;
	edx = edx - 0xD7;
	dl = (byte) edx;
	dh = SLICE(edx, byte, 8);
	SCZO = cond(edx);
	bh = bh - 0xD0;
	cl = dl;
	bl = bl & 0xC4;
	ch = ch - bl;
	cl = cl ^ dh;
	edi = edi ^ 0x00C4C2DD;
	dh = dh ^ 0xC5;
	SZO = cond(dh);
	C = false;
	esp = fp;
	dwArg00 = eax;
	eax = dwArg00;
	esp = fp + 0x04;
	edx = edx | 0x00C3D5DA;
	SZO = cond(edx);
	C = false;
	eax = eax + 10491;
	SCZO = cond(eax);
	edx = edi;
	ecx = ~0x30333D2A;
	edi = edi - 199 - C;
	edi = edi | 0xC0;
	cl = 151;
	SCZO = cond(151);
	esp = fp;
	dwArg00 = eax;
	bh = bh - ~0x31 - C;
	SCZO = cond(bh);
	ecx = edx;
	cl = cl + 212 + C;
	ebx = ebx ^ 14141147;
	SZO = cond(ebx);
	C = false;
	bh = bh | 0xC6;
	dl = dl ^ ~0x2A;
	dl = dl + ~0x32;
	bh = bh ^ dh;
	edi = ecx;
	dl = cl;
	eax = eax - 10491;
	cl = cl - dl;
	SCZO = cond(cl);
	fn0040555F(eax, cl, dl, bx, esi, edi);
}

// 004055EC: void fn004055EC(Register word32 eax, Register byte cl, Register byte ch, Register byte dl, Register byte bl, Register byte bh, Register word32 esi, Register word32 edi, Stack DWORD tArg00)
void fn004055EC(word32 eax, byte cl, byte ch, byte dl, byte bl, byte bh, word32 esi, word32 edi, DWORD tArg00)
{
	esp = fp;
	ch = ch | 0xC5;
	ch_bl = SEQ(ch, bl);
	bh = bh ^ cl;
	ebx = DPB(ebx, bh, 8);
	cl = cl - 202;
	ecx = DPB(ecx, cl, 0);
	cl_cl = SEQ(cl, cl);
	dl = dl + 0xC5;
	edx = DPB(edx, dl, 0);
	dl_bh = SEQ(dl, bh);
	eax = eax - 0xD8;
	al = (byte) eax;
	SCZO = cond(eax);
	v12 = eax;
	eax = v12;
	ah = SLICE(eax, byte, 8);
	edi = edi | 3554132435;
	edi = edi ^ 51145;
	SZO = cond(edi);
	C = false;
	edi = esi;
	al = ~0x24;
	eax = DPB(eax, al, 0);
	bl = bl + 200;
	ch_bl = SEQ(ch, bl);
	SCZO = cond(bl);
	ch_bl = ch_bl + ~0x3037;
	ch = SLICE(ch_bl, byte, 16);
	bl = (byte) ch_bl;
	ebx = DPB(ebx, ch_bl, -1);
	ecx = DPB(ecx, ch_bl, -1);
	SCZO = cond(ch_bl);
	C = (bool) SCZO;
	SZO = SCZO;
	Z = (bool) SCZO;
	S = (bool) SCZO;
	CZ = SCZO;
	edx = edx & ~0x3B3A2B22;
	ebx = ebx | ~0x3822283C;
	bh = SLICE(ebx, byte, 8);
	bl = (byte) ebx;
	ah = ah | dl;
	eax = DPB(eax, ah, 8);
	cl = cl ^ 212;
	ecx = DPB(ecx, cl, 0);
	cl_cl = SEQ(cl, cl);
	SZO = cond(cl);
	C = false;
	al = ~0x24;
	esp = fp - 0x04;
	dwLoc04 = 0x3000;
	edx = edx;
	ah = ah & 0xD2;
	C = false;
	ch = ch - 199 - C;
	edx = edx & 3386364358;
	SZO = cond(edx);
	C = false;
	edi = 49877;
	bh = bh ^ bl;
	edi = 0x00018499;
	edx = edx & ~0x233C2227;
	bl = bl - ~0x22;
	SCZO = cond(bl);
	bh = bh & ~0x32;
	eax = eax & 202;
	bh = bh ^ ch;
	ebx = ebx - ~0x2E3E2238;
	bh = bh - dl;
	SCZO = cond(bh);
	v21 = ecx;
	ecx = v21;
	dl = dl + ~0x28 + C;
	SCZO = cond(dl);
	v23 = edx;
	edx = v23;
	ecx = ecx - 3252214228 - C;
	bh = ah;
	bl = bl & 0xC2;
	al = al & 212;
	SZO = cond(al);
	C = false;
	edx = 0xC1;
	ch = ch + 0xC2 + C;
	ecx = ecx ^ 0xD5;
	edi = 156021;
	ecx = ecx ^ 0xC3DE;
	esp = fp - 0x08;
	dwLoc08 = 0x00011A78;
	bh = bh | 0xD8;
	C = false;
	al = al + 0xD1 + C;
	dh = dh - ah;
	SCZO = cond(dh);
	cl = cl | 0xC4;
	C = false;
	ch = ch + 222 + C;
	SCZO = cond(ch);
	al = bh;
	bl = bl - ~0x29 - C;
	ah = ah + 0xD8;
	SCZO = cond(ah);
	eax = ~0x32322631;
	eax = 0xF5051106 - C;
	bh = 200;
	ch = ch + 0xC1;
	SCZO = cond(ch);
	edx = eax;
	bl = bl + ~0x28 + C;
	ecx = ecx ^ 0xC0DE;
	dl = dl - cl;
	ecx = ecx & 0xD5;
	al = al ^ 220;
	ch = ch - 0xC9;
	dh = dh | 200;
	SZO = cond(dh);
	C = false;
	esi = esi - 0xC3DBC8C8 - C;
	SCZO = cond(esi);
	esp = fp - 0x0C;
	dwLoc0C = 0x00;
	dl = dl - 0xD1 - C;
	ch = ch ^ 0xC5;
	bl = bl + 200;
	ch = ch + ~0x29;
	ecx = ecx;
	edx = edx - 0xDAD0;
	al = al + ~0x30;
	edi = 0x54;
	SZO = cond(0x54);
	C = false;
	al = al | cl;
	bh = 200 - cl;
	ah = ah + 200;
	esi = edx;
	ch = ch + ~0x26;
	al = al & 0xC1;
	dh = dh | ah;
	esi = esi - 0xD6;
	SCZO = cond(esi);
	edx = edx ^ 0xDA;
	ebx = 0x54;
	eax = eax ^ 0xC2C1D1C7;
	C = false;
	dl = dl + 202 + C;
	edx = edx | 0xD2DD;
	SZO = cond(edx);
	C = false;
	eax = edx;
	ch = ch ^ 0xD8;
	edi = 303;
	SCZO = cond(303);
	eax = VirtualAlloc(0x00, 0x00011A78, 0x3000, tArg00);
	esp = fp + 0x04;
	esi = 0xCC;
	ecx = ecx | 0xC8DC;
	ebx = ~0x6C;
	cl = cl + 0xD2;
	bh = ~0x00 ^ al;
	ecx = ecx & 13353930;
	esi = 13228292;
	cl = cl - 0x93;
	SCZO = cond(cl);
	cl_cl = cl_cl + 54994;
	SCZO = cond(cl_cl);
	ecx = ecx ^ 212;
	bl = 88;
	bl = 0xC5;
	dh = dh - 0xC5;
	dl = dl - ~0x34;
	SCZO = cond(dl);
	bh = bh | al;
	SZO = cond(bh);
	C = false;
	bh = ~0x24;
	dl = dl & 211;
	dwLoc04 = eax;
	edi = 0xC6C2;
	bh = 0x10;
	SCZO = cond(0x10);
	bh = 0xC2;
	ecx = ecx - 0xD0 - C;
	bh = 0xC2 | al;
	ebx = ebx & ~0x36322E2A;
	C = false;
	cl = cl - ~0x31 - C;
	ebx = ebx - 0xCBD7;
	SCZO = cond(ebx);
	esp = fp;
	tArg00 = 0xC6C2;
	edi = 0xC6C2;
	esp = fp + 0x04;
	esp = fp;
	tArg00 = ecx;
	ecx = tArg00;
	esp = fp + 0x04;
	edx = edx + 57030;
	ch = ~0x32;
	cl = cl | bl;
	C = false;
	bl = ah;
	ecx = 0xC5;
	cl = 232 - C;
	edx = edx - 202;
	SCZO = cond(edx);
	fn004055A2(eax, ch, dl, bl, edi, dwArg04);
}

// 004056AA: void fn004056AA(Register byte al, Register word16 cx, Register word32 edx, Register byte bl, Register word32 esi)
void fn004056AA(byte al, word16 cx, word32 edx, byte bl, word32 esi)
{
	esp = fp;
	al = al | 202;
	C = false;
	ecx = ecx - 0xCAD0 - C;
	ch = SLICE(ecx, byte, 8);
	cl = (byte) ecx;
	edx = edx & 0x00DDC0D7;
	dh = SLICE(edx, byte, 8);
	dl = (byte) edx;
	C = false;
	bl = bl + ~0x32 + C;
	ebx = DPB(ebx, bl, 0);
	edx_ebx = DPB(edx_ebx, bl, 0);
	bh_bl = SEQ(bh, bl);
	SCZO = cond(bl);
	C = (bool) SCZO;
	ch = ch - 0xC4 - C;
	ecx = DPB(ecx, ch, 8);
	cx = DPB(cx, ch, 8);
	SCZO = cond(ch);
	esp = fp - 0x04;
	dwLoc04 = 0x00D4D8D0;
	esp = fp - 0x08;
	dwLoc08 = 0xDAC1C4CA;
	esp = fp - 0x0C;
	dwLoc0C = 0x00C5D9C5;
	esp = fp - 0x10;
	dwLoc10 = 0xD0D5;
	esp = fp - 0x14;
	dwLoc14 = 0xDB;
	esp = fp - 0x18;
	dwLoc18 = ecx;
	esp = fp - 0x1C;
	dwLoc1C = 0xD247A826;
	esp = fp - 0x20;
	dwLoc20 = ecx;
	eax = LocalAlloc(dwLoc20, 0xD247A826);
	esp = fp - 0x18;
	ebx = ebx - 0xD8;
	edx_ebx = SEQ(edx, ebx);
	SCZO = cond(ebx);
	edx_ebx = edx_ebx - 0xD5C5CAC1000000D8;
	bl = (byte) edx_ebx;
	bh = SLICE(edx_ebx, byte, 8);
	edx = esi;
	dh = SLICE(edx, byte, 8);
	dl = (byte) edx;
	bh = bh ^ dh;
	C = false;
	eax = eax - 0x00CACDD5 - C;
	al = (byte) eax;
	bl = bl + al;
	SCZO = cond(bl);
	C = (bool) SCZO;
	bh = bh - ~0x22 - C;
	ebx = DPB(ebx, bh, 8);
	edx_ebx = DPB(edx_ebx, bh, 8);
	bh_bl = SEQ(bh, bl);
	SCZO = cond(bh);
	esp = fp - 0x1C;
	dwLoc1C = edi;
	edi = dwLoc1C;
	esp = fp - 0x18;
	edx = edx + 14212810;
	edx_ebx = SEQ(edx, ebx);
	dh = SLICE(edx, byte, 8);
	dl = (byte) edx;
	SCZO = cond(edx);
	esp = fp - 0x1C;
	dwLoc1C = 3620330454;
	edi = edi;
	eax = GetSystemMetrics(3620330454);
	al = (byte) eax;
	esp = fp - 0x18;
	cl = cl - 0xD2;
	ch = ch - cl;
	ecx = DPB(ecx, ch, 8);
	esi = esi & 0xD5;
	al = al + bh;
	eax = DPB(eax, al, 0);
	ecx = ecx;
	ecx = ecx ^ 3638483141;
	ch = SLICE(ecx, byte, 8);
	cl = (byte) ecx;
	cx = (word16) ecx;
	edx = edx & 0xCE;
	edx_ebx = SEQ(edx, ebx);
	C = false;
	eax = eax - 0xC1 - C;
	SCZO = cond(eax);
	esi = esi;
	eax = dwLoc18;
	esp = fp - 0x14;
	ebx = ebx - 14140630;
	bl = (byte) ebx;
	bh = SLICE(ebx, byte, 8);
	v18 = esi;
	esi = v18;
	edi = 0xDB;
	esp = fp - 0x10;
	edx = 0xD0D5;
	dh = SLICE(edx, byte, 8);
	esp = fp - 0x0C;
	edi = 0x00C5D9C5;
	esp = fp - 0x08;
	dh = dh ^ bh;
	edx_ebx = DPB(edx_ebx, dh, 40);
	SZO = cond(dh);
	C = false;
	edx = 0xDAC1C4CA;
	esp = fp - 0x04;
	ecx = ecx - 0x00C9D7C2;
	ecx = ecx + 0x00C3C4CE;
	edx = 0x00D4D8D0;
	esp = fp;
	esp = fp - 0x04;
	dwLoc04 = 2658425475;
	eax = SetUnhandledExceptionFilter(2658425475);
	esp = fp;
	edi = 12915998;
	esi = esi & 0x00C6C0C3;
	SZO = cond(esi);
	C = false;
	eax = 0x00DCC0CC;
	ch = ch ^ ~0x32;
	edx = 0x00D5A899;
	dh = ah;
	bl = bl + ~0x26;
	esp = fp - 0x04;
	dwLoc04 = 0x40;
	ebx = ebx & 0x00DED6D6;
	esi = esi | ~0x252E3F21;
	SZO = cond(esi);
	C = false;
	fn004055EC(eax, cl, ch, dl, bl, bh, esi, edi, dwLoc04);
}

// 00405B86: void fn00405B86(Register word32 eax, Register word32 ecx, Register byte dl, Register byte bl, Register word32 esi)
void fn00405B86(word32 eax, word32 ecx, byte dl, byte bl, word32 esi)
{
	byte bl_4 = bl - ah;
	word16 dx_10 = DPB(dx, dl - ~0x24 - (bl_4 <u 0x00), 0);
	fn00405BEB(eax, ecx, dx_10, bl_4, esi);
}

// 00405BB3: void fn00405BB3(Register byte al, Register byte ah, Register byte cl, Register byte ch, Register byte dl, Register byte dh, Register byte bl, Register word32 esi)
void fn00405BB3(byte al, byte ah, byte cl, byte ch, byte dl, byte dh, byte bl, word32 esi)
{
	byte dl_7 = dl | dh;
	word32 edx_9 = DPB(edx, dl_7, 0);
	word16 cx_16 = DPB(cx, cl | dl_7, 0);
	fn004056AA(al + 177, cx_16, edx_9, bl, esi);
}

// 00405BEB: void fn00405BEB(Register word32 eax, Register word32 ecx, Register word16 dx, Register byte bl, Register word32 esi)
void fn00405BEB(word32 eax, word32 ecx, word16 dx, byte bl, word32 esi)
{
}

// 00405CEA: void fn00405CEA(Register word32 eax, Register byte cl, Register byte ch, Register word32 ebx, Register word16 di)
void fn00405CEA(word32 eax, byte cl, byte ch, word32 ebx, word16 di)
{
	esp = fp;
	ebx = ebx ^ ~0x33283927;
	bl = (byte) ebx;
	SZO = cond(ebx);
	C = false;
	edx = edi;
	dh = SLICE(edx, byte, 8);
	dl = (byte) edx;
	ch = ch | 199;
	ecx = 0xD7;
	cl = (byte) ecx;
	dh = dh ^ 0xC0;
	C = false;
	dh = ~0x22;
	v11 = dl;
	dl = v11;
	edx = DPB(edx, dl, 0);
	ch = 0x3A - C;
	ecx = DPB(ecx, ch, 8);
	cl_ch = SEQ(cl, ch);
	SCZO = cond(ch);
	v14 = ebx;
	ebx = v14;
	ebx = ebx & 0x00CBC7CA;
	ch = ch - al;
	SCZO = cond(ch);
	ebx = edi;
	eax = eax;
	bl = 0xD8;
	cl = cl + 0xC3 + C;
	ch = ch | 0xD0;
	ecx = ecx & 14011844;
	ch = SLICE(ecx, byte, 8);
	cl = (byte) ecx;
	SZO = cond(ecx);
	C = false;
	esi = eax;
	ebx = ebx | ~0x243B3333;
	dh = ~0x22 ^ cl;
	dl = dl | ah;
	dh = dh | 0xC0;
	SZO = cond(dh);
	C = false;
	edi = edi;
	fn00405BB3(al, ah, cl, ch, dl, dh, bl, esi);
}

