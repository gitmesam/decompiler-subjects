// subject.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

// 00401000: Register Eq_2 Win32CrtStartup()
DWORD Win32CrtStartup()
{
	byte dl_15;
	byte dh_16;
	byte al_17 = fn00401078(globals->a40112A, 0x062E, out dl_15, out dh_16);
	fn0040112A(al_17, dl_15, dh_16, ebx, fp - 0x04, esi, edi);
	byte dl_39;
	byte dh_40;
	fn00401078(globals->a40112A, 0x062E, out dl_39, out dh_40);
	if (false)
	{
		*(fp - 0x18) = 0x00405000;
		*(fp - 0x1C) = 0x00401000;
		lstrcpyA(*(fp - 0x1C), *(fp - 0x18));
	}
	return 0x00;
}

// 00401078: Register byte fn00401078(Stack (arr Eq_87) dwArg04, Stack int32 dwArg08, Register out Eq_10 dlOut, Register out Eq_11 dhOut)
byte fn00401078(Eq_87 dwArg04[], int32 dwArg08, Eq_10 & dlOut, Eq_11 & dhOut)
{
	*dlOut = dl;
	*dhOut = dh;
	int32 dwLoc08_22 = 0x00;
	while (true)
	{
		byte al_26 = (byte) dwLoc08_22;
		if (dwLoc08_22 >= dwArg08)
			break;
		if (dwLoc08_22 > 0x01)
		{
			byte * edx_135 = (dwArg04 + dwLoc08_22)->a0000->a0000->a0000->a0000->a0000->a0000->a0000->a0000->a0000->a0000->a0000->a0000->a0000->a0000->a0000->a0000->a0000->a0000->a0000;
			(&(&(&(&(&(&(&(&(&(&(&(&(&(&(&(&(&(&(&dwArg04[dwLoc08_22].a0000)[0x00].a0000)[0x00].a0000)[0x00].a0000)[0x00].a0000)[0x00].a0000)[0x00].a0000)[0x00].a0000)[0x00].a0000)[0x00].a0000)[0x00].a0000)[0x00].a0000)[0x00].a0000)[0x00].a0000)[0x00].a0000)[0x00].a0000)[0x00].a0000)[0x00].a0000)[0x00].a0000)[0x00] = *edx_135 ^ 0xC9;
			byte dl_136;
			*dlOut = (byte) edx_135;
			byte dh_137;
			*dhOut = SLICE(edx_135, byte, 8);
		}
		if (dwLoc08_22 > 0x02)
		{
			byte * edx_122 = (dwArg04 + dwLoc08_22)->a0000->a0000->a0000->a0000->a0000->a0000->a0000->a0000->a0000->a0000->a0000->a0000->a0000->a0000->a0000->a0000->a0000->a0000->a0000;
			(&(&(&(&(&(&(&(&(&(&(&(&(&(&(&(&(&(&(&dwArg04[dwLoc08_22].a0000)[0x00].a0000)[0x00].a0000)[0x00].a0000)[0x00].a0000)[0x00].a0000)[0x00].a0000)[0x00].a0000)[0x00].a0000)[0x00].a0000)[0x00].a0000)[0x00].a0000)[0x00].a0000)[0x00].a0000)[0x00].a0000)[0x00].a0000)[0x00].a0000)[0x00].a0000)[0x00].a0000)[0x00] = *edx_122 + ~0x0E;
			byte dl_123;
			*dlOut = (byte) edx_122;
			byte dh_124;
			*dhOut = SLICE(edx_122, byte, 8);
		}
		if (dwLoc08_22 > 0x02)
		{
			Eq_117 edx_90 = dwLoc08_22 - 0x02;
			int32 edx_97 = (int32) (SEQ(edx_90 >> 0x1F, edx_90) % 0x03);
			byte dl_98;
			*dlOut = (byte) edx_97;
			byte dh_99;
			*dhOut = SLICE(edx_97, byte, 8);
			if (edx_97 == 0x00)
			{
				(&(&(&(&(&(&(&(&(&(&(&(&(&(&(&(&(&(&(&dwArg04[dwLoc08_22].a0000)[0x00].a0000)[0x00].a0000)[0x00].a0000)[0x00].a0000)[0x00].a0000)[0x00].a0000)[0x00].a0000)[0x00].a0000)[0x00].a0000)[0x00].a0000)[0x00].a0000)[0x00].a0000)[0x00].a0000)[0x00].a0000)[0x00].a0000)[0x00].a0000)[0x00].a0000)[0x00].a0000)[0x00] = (&(&(&(&(&(&(&(&(&(&(&(&(&(&(&(&(&(&(&dwArg04[dwLoc08_22].a0000)[0x00].a0000)[0x00].a0000)[0x00].a0000)[0x00].a0000)[0x00].a0000)[0x00].a0000)[0x00].a0000)[0x00].a0000)[0x00].a0000)[0x00].a0000)[0x00].a0000)[0x00].a0000)[0x00].a0000)[0x00].a0000)[0x00].a0000)[0x00].a0000)[0x00].a0000)[0x00].a0000)[0x00] - ~0x45;
				byte dl_110;
				*dlOut = ~0x45;
			}
		}
		if ((dwLoc08_22 & 0x01) == 0x00)
		{
			byte dl_81 = (byte) dwLoc08_22;
			*dlOut = dl_81;
			(&(&(&(&(&(&(&(&(&(&(&(&(&(&(&(&(&(&(&dwArg04[dwLoc08_22].a0000)[0x00].a0000)[0x00].a0000)[0x00].a0000)[0x00].a0000)[0x00].a0000)[0x00].a0000)[0x00].a0000)[0x00].a0000)[0x00].a0000)[0x00].a0000)[0x00].a0000)[0x00].a0000)[0x00].a0000)[0x00].a0000)[0x00].a0000)[0x00].a0000)[0x00].a0000)[0x00].a0000)[0x00] = (&(&(&(&(&(&(&(&(&(&(&(&(&(&(&(&(&(&(&dwArg04[dwLoc08_22].a0000)[0x00].a0000)[0x00].a0000)[0x00].a0000)[0x00].a0000)[0x00].a0000)[0x00].a0000)[0x00].a0000)[0x00].a0000)[0x00].a0000)[0x00].a0000)[0x00].a0000)[0x00].a0000)[0x00].a0000)[0x00].a0000)[0x00].a0000)[0x00].a0000)[0x00].a0000)[0x00].a0000)[0x00] - dl_81;
			byte dh_82;
			*dhOut = SLICE(dwLoc08_22, byte, 8);
		}
		dwLoc08_22 = dwLoc08_22 + 0x01;
	}
	return al_26;
}

// 0040112A: void fn0040112A(Register byte al, Register byte dl, Register byte dh, Register (ptr Eq_22) ebx, Register (ptr word32) ebp, Register (ptr (ptr word32)) esi, Register word32 edi)
void fn0040112A(byte al, byte dl, byte dh, Eq_22 * ebx, word32 * ebp, word32 * * esi, word32 edi)
{
	*esi = ebp;
	byte cl_8 = (byte) ebp;
	byte dh_15 = __rol(dh, cl_8);
	cu8 v14_23 = ebx->b005F - bl - ((dh & 0x01 << 0x08 - cl_8) != 0x00);
	ebx->b005F = v14_23;
	int32 eax_11 = (int32) ax;
	DPB(edx, dh_15, 8) + 0x5D = (word32) 0xC4;
	cu8 al_27 = (byte) eax_11 - ~0x2A - (v14_23 < 0x00);
	__outw(DPB(dx, dh_15, 8), (word16) (DPB(eax_11, al_27, 0) + 0xE804EB31 + (al_27 < 0x00)));
	*ebp = 3565633089;
	ebx->dw0046 = ~0x38C5CC88;
	__hlt();
}

