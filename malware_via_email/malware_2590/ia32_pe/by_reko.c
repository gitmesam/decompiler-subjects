// subject.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

// 00401027: FpuStack real64 fn00401027(Register DWORD eax, Register (ptr ui32) ecx, Register int32 edx, Register (ptr Eq_6) ebx, Register word32 ebp, Register (ptr Eq_8) esi, Register ui32 edi, Stack word32 dwArg00, Stack word32 dwArg03, FpuStack real64 rArg0, FpuStack real64 rArg6)
real64 fn00401027(DWORD eax, ui32 * ecx, int32 edx, Eq_6 * ebx, word32 ebp, Eq_8 * esi, ui32 edi, word32 dwArg00, word32 dwArg03, real64 rArg0, real64 rArg6)
{
	*((word32) eax + 0x006B) = (Eq_3) (*((word32) eax + 0x006B) | al);
	__bound(ebp, ebx->dwBC27413);
	__outdw(25799, edx *s 11);
	*(edi | edx *s 11) = esi->dw0004;
	*ecx = *ecx ^ fp + 0x03;
}

// 0041397C: Register Eq_3 Win32CrtStartup()
DWORD Win32CrtStartup()
{
	ptr32 esp_265;
	Eq_57 eax_264;
	ptr32 esp_151;
	Eq_57 eax_21 = CreateFileA(&globals->t42FAA3, 0x80000000, 0x07, null, 0x03, 0x0182, null);
	if (eax_21 == (void *) ~0x00)
	{
		GetFileSize(eax_21, null);
		CloseHandle(eax_21);
		GetFileSize(eax_21, null);
		esp_151 = fp - 0xA0;
		Eq_57 eax_580 = CreateFileA(&globals->t42FA89, 0xE0000000, 0x04, null, 0x03, 0x0104, null);
		if (eax_580 != (void *) ~0x00)
			goto l00413C54;
		GetFileSize(eax_580, null);
		Eq_57 eax_627 = CreateFileA(&globals->t42FB1A, 0x60000000, 0x06, null, 0x03, 0x04, null);
		CloseHandle(eax_580);
		GetLastError();
		CloseHandle(eax_21);
		dwLoc0C = eax_627;
		if (CreateFileA(&globals->t42FAAF, 0xA0000000, 0x03, null, 0x03, 262, null) == (void *) ~0x00)
		{
			GetCommandLineA();
			GetFileSize(eax_627, null);
			dwLoc20 = CreateFileA(&globals->t42FB01, 0xE0000000, 0x04, null, 0x03, 0x0186, null);
			esp_265 = fp - 0x0110;
l00413ADA:
			struct Eq_407 * esp_338 = esp_265 - 0x04;
			esp_338->t0000 = dwLoc0C;
			GetFileSize(esp_338->t0000, esp_338->t0004);
			GetCommandLineA();
			*(esp_338 - 0x04) = 0x00;
			*(esp_338 - 0x08) = (HANDLE *) dwLoc20;
			GetFileSize(*(esp_338 - 0x08), *(esp_338 - 0x04));
			*(esp_338 - 0x0C) = 0x00;
			*(esp_338 - 0x10) = 0x0100;
			*(esp_338 - 0x14) = 0x03;
			*(esp_338 - 0x18) = 0x00;
			*(esp_338 - 0x1C) = 0x06;
			*(esp_338 - 0x20) = 0x20000000;
			*(esp_338 - 0x24) = 4389439;
			Eq_57 eax_362 = CreateFileW(*(esp_338 - 0x24), *(esp_338 - 0x20), *(esp_338 - 0x1C), *(esp_338 - 0x18), *(esp_338 - 0x14), *(esp_338 - 0x10), *(esp_338 - 0x0C));
			*(esp_338 - 0x28) = 0x0042FA99;
			GetCommandLineA();
			Eq_532 eax_367 = LoadLibraryA(*(esp_338 - 0x28));
			*(esp_338 - 44) = 0x0042FB08;
			GetLastError();
			*(esp_338 - 0x30) = (HMODULE *) eax_367;
			GetLastError();
			dwLoc48 = GetProcAddress(*(esp_338 - 0x30), *(esp_338 - 44));
			GetLastError();
			GetLastError();
			*(esp_338 - 0x34) = 0x00;
			*(esp_338 - 0x38) = 288;
			*(esp_338 - 0x3C) = 0x03;
			*(esp_338 - 0x40) = 0x00;
			*(esp_338 - 0x44) = 0x06;
			*(esp_338 - 0x48) = 0xA0000000;
			*(esp_338 - 0x4C) = 4389388;
			dwLoc4C = CreateFileA(*(esp_338 - 0x4C), *(esp_338 - 0x48), *(esp_338 - 0x44), *(esp_338 - 0x40), *(esp_338 - 0x3C), *(esp_338 - 0x38), *(esp_338 - 0x34));
			*(esp_338 - 0x50) = 0x00;
			*(esp_338 - 0x54) = 0x0185;
			*(esp_338 - 88) = 0x03;
			*(esp_338 - 0x5C) = 0x00;
			*(esp_338 - 0x60) = 0x02;
			*(esp_338 - 100) = 0xE0000000;
			*(esp_338 - 0x68) = 0x0042FACC;
			CreateFileW(*(esp_338 - 0x68), *(esp_338 - 100), *(esp_338 - 0x60), *(esp_338 - 0x5C), *(esp_338 - 88), *(esp_338 - 0x54), *(esp_338 - 0x50));
			*(esp_338 - 0x6C) = 0x00;
			*(esp_338 - 0x70) = (HANDLE *) eax_362;
			GetFileSize(*(esp_338 - 0x70), *(esp_338 - 0x6C));
			*(esp_338 - 116) = (HANDLE *) eax_21;
			CloseHandle(*(esp_338 - 116));
			*(esp_338 - 0x78) = 0x00;
			*(esp_338 - 0x7C) = 0x20;
			*(esp_338 - 0x80) = 0x03;
			*(esp_338 - 0x84) = 0x00;
			*(esp_338 - 0x88) = 0x00;
			*(esp_338 - 0x8C) = 0xE0000000;
			*(esp_338 - 0x90) = 4389609;
			CreateFileW(*(esp_338 - 0x90), *(esp_338 - 0x8C), *(esp_338 - 0x88), *(esp_338 - 0x84), *(esp_338 - 0x80), *(esp_338 - 0x7C), *(esp_338 - 0x78));
			*(esp_338 - 0x94) = 0x00;
			GetCommandLineA();
			*(esp_338 - 0x98) = 0x00;
			*(esp_338 - 0x9C) = (HANDLE *) eax_21;
			CloseHandle(*(esp_338 - 0x9C));
			*(esp_338 - 0xA0) = 0x00;
			*(esp_338 - 0xA4) = 0x01A2;
			*(esp_338 - 0xA8) = 0x03;
			*(esp_338 - 0xAC) = 0x00;
			*(esp_338 - 0xB0) = 0x03;
			*(esp_338 - 0xB4) = 0x80000000;
			*(esp_338 - 0xB8) = 4389342;
			esp_265 = esp_338 - 0xB8;
			eax_264 = CreateFileA(*(esp_338 - 0xB8), *(esp_338 - 0xB4), *(esp_338 - 0xB0), *(esp_338 - 0xAC), *(esp_338 - 0xA8), *(esp_338 - 0xA4), *(esp_338 - 0xA0));
l00413C3D:
			if (eax_264 == (void *) ~0x00)
			{
				word32 ebp_273;
				byte SCZO_274;
				word32 eax_275;
				byte Z_276;
				byte SZO_277;
				byte C_278;
				word32 ecx_279;
				word32 edx_280;
				word32 ebx_281;
				word32 esi_282;
				word32 edi_283;
				real64 rArg0_284;
				real64 rArg6_285;
				dwLoc48();
				dwLoc40 = eax_275;
l00413C54:
				LPDWORD * esp_154 = esp_151 - 0x04;
				*esp_154 = (LPDWORD *) null;
				*(esp_154 - 0x04) = (HANDLE *) eax_21;
				GetFileSize(*(esp_154 - 0x04), *esp_154);
				*(esp_154 - 0x08) = 0x00;
				*(esp_154 - 0x0C) = 0xA2;
				*(esp_154 - 0x10) = 0x03;
				*(esp_154 - 0x14) = 0x00;
				*(esp_154 - 0x18) = 0x07;
				*(esp_154 - 0x1C) = 0x60000000;
				*(esp_154 - 0x20) = 0x0042F9C0;
				CreateFileA(*(esp_154 - 0x20), *(esp_154 - 0x1C), *(esp_154 - 0x18), *(esp_154 - 0x14), *(esp_154 - 0x10), *(esp_154 - 0x0C), *(esp_154 - 0x08));
				*(esp_154 - 0x24) = (HANDLE *) eax_21;
				GetFileType(*(esp_154 - 0x24));
				*(esp_154 - 0x28) = (HANDLE *) dwLoc4C;
				Eq_3 eax_189 = GetFileType(*(esp_154 - 0x28));
				word32 esp_196;
				word32 ebp_197;
				byte SCZO_198;
				Eq_3 eax_199;
				byte Z_200;
				byte SZO_201;
				byte C_202;
				word32 ecx_203;
				word32 edx_204;
				word32 ebx_205;
				word32 esi_206;
				word32 edi_207;
				real64 rArg0_208;
				real64 rArg6_209;
				(*((word32) (dwLoc40 ^ 0x80070057) + 0x00413CC9))();
				return eax_199;
			}
			goto l00413ADA;
		}
	}
	else
	{
		CreateFileA(&globals->t42FA6D, 0x60000000, 0x05, null, 0x03, 0x0127, null);
		CreateFileW(&globals->t42FA58, 0x20000000, 0x05, null, 0x03, 288, null);
		esp_265 = fp - 0xD0;
		eax_264 = CreateFileA(&globals->t42FA26, 0x60000000, 0x04, null, 0x03, 0x01A0, null);
		if (eax_264 != (void *) ~0x00)
			goto l00413C3D;
		GetLastError();
		dwLoc14 = dwLoc40 - 2143666719;
	}
	ptr32 esp_518;
	word32 ebp_519;
	byte SCZO_520;
	word32 eax_521;
	byte Z_522;
	byte SZO_523;
	byte C_524;
	ui32 * ecx_525;
	int32 edx_526;
	struct Eq_6 * ebx_527;
	struct Eq_8 * esi_528;
	ui32 edi_529;
	real64 rArg0_530;
	real64 rArg6_531;
	dwLoc14();
	*(esp_518 - 0x04) = 0x00;
	*(esp_518 - 0x08) = dwLoc08;
	GetFileSize(*(esp_518 - 0x08), *(esp_518 - 0x04));
	*(esp_518 - 0x0C) = 0x00;
	*(esp_518 - 0x10) = dwLoc24;
	Eq_3 eax_544 = GetFileSize(*(esp_518 - 0x10), *(esp_518 - 0x0C));
	fn00401027(eax_544, ecx_525, edx_526, ebx_527, ebp_519, esi_528, edi_529, ebp, dwLoc01, rArg0_530, rArg6_531);
	return eax_544;
}

