// subject.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

// 00401027: Register Eq_2 fn00401027(Register Eq_2 eax, Register (ptr32 ui32) ecx, Register int32 edx, Register (ptr32 Eq_5) ebx, Register (ptr32 Eq_6) ebp, Register (ptr32 Eq_7) esi, Register Eq_8 edi, Stack word32 dwArg00, FpuStack real64 rArg0, FpuStack real64 rArg6, Register out ptr32 ebpOut, FpuStack out Eq_13 rArg0Out)
Eq_2 fn00401027(Eq_2 eax, ui32 * ecx, int32 edx, Eq_5 * ebx, Eq_6 * ebp, Eq_7 * esi, Eq_8 edi, word32 dwArg00, real64 rArg0, real64 rArg6, ptr32 & ebpOut, Eq_13 & rArg0Out)
{
	*((word32) eax + 0x006B) = *((word32) eax + 0x006B) | al;
	__bound(ebp, ebx->dwBC27413);
	word32 * esp_100 = fp + 0x04;
	struct Eq_34 * eax_108 = edx *s 11;
	byte al_109 = (byte) (edx *s 11);
l00401034:
	__outdw(25799, eax_108);
	word32 * edi_43 = edi | eax_108;
	*edi_43 = esi->dw0004;
	struct Eq_7 ** esp_37 = esp_100 - 0x01;
	*ecx = *ecx ^ esp_37;
	esi = (struct Eq_7 *) *esp_37;
	__syscall(~0x11);
	ebp->b0045 = ch;
	bl = bl + al_109;
	int32 eax_56 = DPB(eax_108, al_109 | 0x67, 0);
	ebx = DPB(ebx, bl, 0);
	edi = edi_43 + 0x01;
	eax_108 = (struct Eq_34 *) ((char *) esp_37 + 0x04);
	al_109 = (byte) ((char *) esp_37 + 0x04);
	esp_100 = eax_56 + 0x01;
	bool O_112 = (bool) cond(eax_56 + 0x01);
	do
	{
		if (O_112)
			goto l00401034;
		eax_108[0x0E] = (struct Eq_34) __rol(eax_108[0x0E], 0x01);
		if (!O_112)
		{
			word32 * esp_145 = esp_100 - (word32 *) 0x04;
			*esp_145 = 0x0E;
			Eq_125 eax_144 = eax_108 ^ 2880052282;
			ebp = ebp | *(eax_144 - 0x17);
			ecx = __rcl(ecx, 0x40, false);
			*(esp_145 - (word32 *) 0x04) = ~0x31;
			ebx = ebx | *((eax_144 ^ 0x6BAADC3A) - 0x17);
			eax_108 = eax_144 ^ 0x6BAADC3A;
			esp_100 = esp_145 - (word32 *) 0x04;
			bl = (byte) ebx;
		}
		ecx = ecx >> 0x43;
		eax_108 = eax_108 | ebx;
		ch = SLICE(ecx, byte, 8);
		al_109 = (byte) eax_108;
		O_112 = (bool) cond(eax_108);
	} while (OVERFLOW(eax_108));
	word32 esp_121;
	byte SCZDOP_122;
	Eq_2 eax_123;
	byte al_124;
	byte SZO_125;
	bool C_126;
	word32 ebp_127;
	word32 ebx_128;
	word32 edx_129;
	byte SCZO_130;
	byte bl_131;
	real64 rArg6_132;
	real64 rArg0_133;
	word32 edi_134;
	word16 dx_135;
	word32 esi_136;
	word32 ecx_137;
	byte ah_138;
	byte ch_139;
	bool O_140;
	byte dh_141;
	byte dl_142;
	fnD2D203DB();
	return eax_123;
}

// 0041397C: Register Eq_2 Win32CrtStartup()
Eq_2 Win32CrtStartup()
{
	struct Eq_184 * esp_180;
	Eq_2 eax_179;
	ptr32 esp_187;
	Eq_2 eax_21 = CreateFileA(4389539, 0x80000000, 0x07, null, 0x03, 0x0182, 0x00);
	if (eax_21 == ~0x00)
	{
		GetFileSize(eax_21, 0x00);
		CloseHandle(eax_21);
		GetFileSize(eax_21, 0x00);
		Eq_2 eax_453 = CreateFileA(4389513, 0xE0000000, 0x04, null, 0x03, 0x0104, 0x00);
		esp_187 = fp - 0x54;
		if (eax_453 != ~0x00)
			goto l00413C54;
		GetFileSize(eax_453, 0x00);
		Eq_2 eax_487 = CreateFileA(4389658, 0x60000000, 0x06, null, 0x03, 0x04, 0x00);
		CloseHandle(eax_453);
		GetLastError();
		CloseHandle(eax_21);
		dwLoc0C = eax_487;
		if (CreateFileA(0x0042FAAF, 0xA0000000, 0x03, null, 0x03, 262, 0x00) == ~0x00)
		{
			GetCommandLineA();
			GetFileSize(eax_487, 0x00);
			dwLoc20 = CreateFileA(4389633, 0xE0000000, 0x04, null, 0x03, 0x0186, 0x00);
			esp_180 = fp - 88;
l00413ADA:
			struct Eq_184 * esp_223 = esp_180 - 0x04;
			esp_223->t0000 = dwLoc0C;
			GetFileSize(esp_223->t0000, esp_223->t0004);
			GetCommandLineA();
			esp_223->t0004.u0 = 0x00;
			esp_223->t0000 = dwLoc20;
			GetFileSize(esp_223->t0000, esp_223->t0004);
			esp_223->t0004.u0 = 0x00;
			esp_223->t0000.u0 = 0x0100;
			*(esp_223 - 0x04) = 0x03;
			*(esp_223 - 0x08) = 0x00;
			*(esp_223 - 0x0C) = 0x06;
			*(esp_223 - 0x10) = 0x20000000;
			*(esp_223 - 0x14) = 4389439;
			Eq_2 eax_249 = CreateFileW(*(esp_223 - 0x14), *(esp_223 - 0x10), *(esp_223 - 0x0C), *(esp_223 - 0x08), *(esp_223 - 0x04), esp_223->t0000, esp_223->t0004);
			esp_223->t0004.u0 = 0x0042FA99;
			GetCommandLineA();
			Eq_2 eax_255 = LoadLibraryA(esp_223->t0004);
			esp_223->t0004.u0 = 0x0042FB08;
			GetLastError();
			esp_223->t0000 = eax_255;
			GetLastError();
			dwLoc48 = GetProcAddress(esp_223->t0000, esp_223->t0004);
			GetLastError();
			GetLastError();
			esp_223->t0004.u0 = 0x00;
			esp_223->t0000.u0 = 288;
			*(esp_223 - 0x04) = 0x03;
			*(esp_223 - 0x08) = 0x00;
			*(esp_223 - 0x0C) = 0x06;
			*(esp_223 - 0x10) = 0xA0000000;
			*(esp_223 - 0x14) = 4389388;
			dwLoc4C = CreateFileA(*(esp_223 - 0x14), *(esp_223 - 0x10), *(esp_223 - 0x0C), *(esp_223 - 0x08), *(esp_223 - 0x04), esp_223->t0000, esp_223->t0004);
			esp_223->t0004.u0 = 0x00;
			esp_223->t0000.u0 = 0x0185;
			*(esp_223 - 0x04) = 0x03;
			*(esp_223 - 0x08) = 0x00;
			*(esp_223 - 0x0C) = 0x02;
			*(esp_223 - 0x10) = 0xE0000000;
			*(esp_223 - 0x14) = 0x0042FACC;
			CreateFileW(*(esp_223 - 0x14), *(esp_223 - 0x10), *(esp_223 - 0x0C), *(esp_223 - 0x08), *(esp_223 - 0x04), esp_223->t0000, esp_223->t0004);
			esp_223->t0004.u0 = 0x00;
			esp_223->t0000 = eax_249;
			GetFileSize(esp_223->t0000, esp_223->t0004);
			esp_223->t0004 = eax_21;
			CloseHandle(esp_223->t0004);
			esp_223->t0004.u0 = 0x00;
			esp_223->t0000.u0 = 0x20;
			*(esp_223 - 0x04) = 0x03;
			*(esp_223 - 0x08) = 0x00;
			*(esp_223 - 0x0C) = 0x00;
			*(esp_223 - 0x10) = 0xE0000000;
			*(esp_223 - 0x14) = 4389609;
			CreateFileW(*(esp_223 - 0x14), *(esp_223 - 0x10), *(esp_223 - 0x0C), *(esp_223 - 0x08), *(esp_223 - 0x04), esp_223->t0000, esp_223->t0004);
			esp_223->t0004.u0 = 0x00;
			GetCommandLineA();
			esp_223->t0000.u0 = 0x00;
			*(esp_223 - 0x04) = (union Eq_2 *) eax_21;
			CloseHandle(*(esp_223 - 0x04));
			*(esp_223 - 0x04) = 0x00;
			*(esp_223 - 0x08) = 0x01A2;
			*(esp_223 - 0x0C) = 0x03;
			*(esp_223 - 0x10) = 0x00;
			*(esp_223 - 0x14) = 0x03;
			*(esp_223 - 0x18) = 0x80000000;
			*(esp_223 - 0x1C) = 4389342;
			eax_179 = CreateFileA(*(esp_223 - 0x1C), *(esp_223 - 0x18), *(esp_223 - 0x14), *(esp_223 - 0x10), *(esp_223 - 0x0C), *(esp_223 - 0x08), *(esp_223 - 0x04));
			esp_180 = esp_223;
l00413C3D:
			if (eax_179 == ~0x00)
			{
				word32 ebp_188;
				byte SCZO_189;
				word32 eax_190;
				bool Z_191;
				byte SZO_192;
				bool C_193;
				word32 ecx_194;
				word32 edx_195;
				word32 ebx_196;
				word32 esi_197;
				word32 edi_198;
				real64 rArg0_199;
				real64 rArg6_200;
				dwLoc48();
				dwLoc40 = eax_190;
l00413C54:
				union Eq_2 * esp_95 = esp_187 - 0x04;
				*esp_95 = 0x00;
				*(esp_95 - 0x04) = (union Eq_2 *) eax_21;
				GetFileSize(*(esp_95 - 0x04), *esp_95);
				*esp_95 = 0x00;
				*(esp_95 - 0x04) = 0xA2;
				*(esp_95 - 0x08) = 0x03;
				*(esp_95 - 0x0C) = 0x00;
				*(esp_95 - 0x10) = 0x07;
				*(esp_95 - 0x14) = 0x60000000;
				*(esp_95 - 0x18) = 0x0042F9C0;
				CreateFileA(*(esp_95 - 0x18), *(esp_95 - 0x14), *(esp_95 - 0x10), *(esp_95 - 0x0C), *(esp_95 - 0x08), *(esp_95 - 0x04), *esp_95);
				*esp_95 = (union Eq_2 *) eax_21;
				GetFileType(*esp_95);
				*esp_95 = (union Eq_2 *) dwLoc4C;
				Eq_2 eax_133 = GetFileType(*esp_95);
				word32 esp_141;
				word32 ebp_142;
				byte SCZO_143;
				Eq_2 eax_144;
				bool Z_145;
				byte SZO_146;
				bool C_147;
				word32 ecx_148;
				word32 edx_149;
				word32 ebx_150;
				word32 esi_151;
				word32 edi_152;
				real64 rArg0_153;
				real64 rArg6_154;
				(*((word32) (dwLoc40 ^ 0x80070057) + 0x00413CC9))();
				return eax_144;
			}
			goto l00413ADA;
		}
	}
	else
	{
		CreateFileA(4389485, 0x60000000, 0x05, null, 0x03, 0x0127, 0x00);
		CreateFileW(&globals->t42FA58, 0x20000000, 0x05, null, 0x03, 288, 0x00);
		eax_179 = CreateFileA(4389414, 0x60000000, 0x04, null, 0x03, 0x01A0, 0x00);
		esp_180 = fp - 0x60;
		if (eax_179 != ~0x00)
			goto l00413C3D;
		GetLastError();
		dwLoc14 = dwLoc40 - 2143666719;
	}
	ptr32 esp_385;
	struct Eq_6 * ebp_386;
	byte SCZO_387;
	word32 eax_388;
	bool Z_389;
	byte SZO_390;
	bool C_391;
	ui32 * ecx_392;
	int32 edx_393;
	struct Eq_5 * ebx_394;
	struct Eq_7 * esi_395;
	Eq_8 edi_396;
	real64 rArg0_397;
	real64 rArg6_398;
	dwLoc14();
	*(esp_385 - 0x04) = 0x00;
	*(esp_385 - 0x08) = dwLoc08;
	GetFileSize(*(esp_385 - 0x08), *(esp_385 - 0x04));
	*(esp_385 - 0x04) = 0x00;
	*(esp_385 - 0x08) = dwLoc24;
	word32 ebp_414;
	real64 rArg0_415;
	return fn00401027(GetFileSize(*(esp_385 - 0x08), *(esp_385 - 0x04)), ecx_392, edx_393, ebx_394, ebp_386, esi_395, edi_396, ebp, rArg0_397, rArg6_398, out ebp_414, out rArg0_415);
}

