// subject.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

// 00401000: Register Eq_2 Win32CrtStartup()
DWORD Win32CrtStartup()
{
	Eq_3 eax_26 = AddAce(null, 0x00, 0x00, null, 0x00);
	Eq_17 ebx_15 = null;
	word32 edi_278 = eax_26 + 0x1E;
	if (AreAllAccessesGranted(~0x00, ~0x00) == 0x00)
		edi_278 = eax_26 + 0x1E ^ 0x0E;
	CloseHandle((void *) 0x59);
	VirtualProtect(&globals->v401000, 0x3000, 0x40, fp - 0x08);
	struct Eq_49 * eax_57 = null;
	do
	{
		if (ebx_15 == edi_278)
			ebx_15 = null;
		eax_57[4199048] = (struct Eq_49) (eax_57[4199048] ^ ebx_15[0x00404000]);
		eax_57 = eax_57 + 0x01;
		ebx_15 = (Eq_17) (ebx_15 + 0x01);
	} while (eax_57 < (struct Eq_49 *) 0x1440);
	struct Eq_72 * ecx_121 = &globals->t402588;
	up32 esi_101 = 0x00;
	up32 dwLoc04_104 = 0x00;
	do
	{
		Eq_80 eax_105 = ecx_121->t0004;
		word32 * eax_107 = eax_105 - 0x08 >> 0x01;
		word16 * edx_111 = (char *) &ecx_121->t0004 + 0x04;
		if (eax_107 > null)
		{
			uint32 edi_252 = eax_105 - 0x08 >> 0x01;
			do
			{
				eax_107 = (word32) *edx_111;
				if ((eax_107 & 0xF000) == 0x3000)
				{
					struct Eq_101 * eax_269 = (eax_107 & 0x0FFF) + ecx_121->dw0000;
					eax_269->dw401008 = eax_269->dw401008 + 0xF0401008;
					eax_107 = (word32 *) &eax_269->dw401008;
				}
				edx_111 = edx_111 + 0x01;
				edi_252 = edi_252 - 0x01;
			} while (edi_252 != 0x00);
			esi_101 = dwLoc04_104;
		}
		esi_101 = (word32) ecx_121->t0004 + esi_101;
		dwLoc04_104 = esi_101;
		ecx_121 = ecx_121 + Mem81[ecx_121 + 0x04:word32];
	} while (esi_101 < 232);
	struct Eq_126 * esi_125 = &globals->t401D6C;
	struct Eq_126 * dwLoc04_126 = &globals->t401D6C;
	word32 eax_127 = eax_107 + ecx_121;
	if (globals->dw401D7C != 0x00)
	{
		do
		{
			eax_127 = LoadLibraryA(esi_125->dw000C + 0x00401008);
			if (eax_127 != 0x00)
			{
				word32 edi_189 = esi_125->dw0000;
				if (edi_189 == 0x00)
					edi_189 = esi_125->dw0010;
				word32 * edi_194 = edi_189 + 0x00401008;
				word32 * esi_197 = esi_125->dw0010 + 0x00401008;
				if (*edi_194 != 0x00)
				{
					do
					{
						Eq_152 dwLoc1C_233;
						int32 eax_226 = *edi_194;
						ecx_121 = ecx_121 * 0x08 + 0x00401008;
						word16 ax_227 = (word16) eax_226;
						if (eax_226 < 0x00)
							dwLoc1C_233 = (word32) ax_227;
						else
						{
							ecx_121 = eax_226 + 0x0040100A;
							dwLoc1C_233 = eax_226 + 0x0040100A;
						}
						eax_127 = GetProcAddress(eax_127, dwLoc1C_233);
						*esi_197 = (word32) eax_127;
						edi_194 = edi_194 + 0x01;
						esi_197 = esi_197 + 0x01;
					} while (*edi_194 != 0x00);
				}
				esi_125 = dwLoc04_126;
			}
			esi_125 = esi_125 + 0x01;
			dwLoc04_126 = esi_125;
		} while (esi_125->dw0010 != 0x00);
	}
	fn00401A68(eax_127, ecx_121, rArg0, rArg2);
	ExitProcess(0x00);
}

// 00401A68: FpuStack real64 fn00401A68(Register Eq_130 eax, Register (ptr32 Eq_72) ecx, FpuStack real64 rArg0, FpuStack real64 rArg2)
real64 fn00401A68(Eq_130 eax, Eq_72 * ecx, real64 rArg0, real64 rArg2)
{
	ecx->dw0000 = ecx->dw0000 & eax;
	byte al_17;
	__das(0x9A, &al_17);
}

