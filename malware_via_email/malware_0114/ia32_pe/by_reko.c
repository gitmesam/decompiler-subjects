// subject.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

// 00401000: Register Eq_2 Win32CrtStartup()
DWORD Win32CrtStartup()
{
	word32 ebx_1061 = AddAce(null, 0x00, 0x00, null, 0x00) + 0x24 + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00);
	Eq_3 ebp_1093 = null;
	if (AreAnyAccessesGranted(~0x00, ~0x00) == 0x00)
		ebx_1061 = ebx_1061 - 0x22;
	CloseHandle((void *) 0x59);
	VirtualProtect(&globals->v401000, 0x3000, 0x40, fp - 0x10);
	Eq_680 dwLoc24_1076 = fp - 0x10;
	struct Eq_682 * eax_1086 = null;
	do
	{
		if (ebp_1093 == ebx_1061)
			ebp_1093 = null;
		eax_1086[0x004014A0] = (struct Eq_682) (eax_1086[0x004014A0] ^ ebp_1093[0x00404000]);
		eax_1086 = eax_1086 + 0x01;
		ebp_1093 = (Eq_3) (ebp_1093 + 0x01);
	} while (eax_1086 < (struct Eq_682 *) 5152);
	up32 esi_1115 = 0x00;
	struct Eq_706 * edx_1118 = &globals->t402780;
	up32 dwLoc04_1121 = 0x00;
	do
	{
		Eq_712 eax_1130 = edx_1118->t0004;
		cui16 * ecx_1136 = (char *) &edx_1118->t0004 + 0x04;
		if (eax_1130 - 0x08 >> 0x01 > 0x00)
		{
			uint32 dwLoc08_1302 = eax_1130 - 0x08 >> 0x01;
			do
			{
				if ((*ecx_1136 & 0xF000) == 0x3000)
				{
					struct Eq_734 * eax_1326 = ((word32) *ecx_1136 & 0x0FFF) + edx_1118->dw0000;
					eax_1326->dw401220 = eax_1326->dw401220 + 0xF0401220;
				}
				uint32 v18_1318 = dwLoc08_1302 - 0x01;
				ecx_1136 = ecx_1136 + 0x01;
				dwLoc08_1302 = v18_1318;
			} while (v18_1318 != 0x00);
			esi_1115 = dwLoc04_1121;
		}
		esi_1115 = (word32) edx_1118->t0004 + esi_1115;
		dwLoc04_1121 = esi_1115;
		edx_1118 = edx_1118 + Mem1105[edx_1118 + 0x04:word32];
	} while (esi_1115 < 228);
	struct Eq_761 * esi_1152 = &globals->t401F7C;
	struct Eq_761 * dwLoc04_1153 = &globals->t401F7C;
	if (globals->dw401F8C != 0x00)
	{
		do
		{
			word32 ecx_1188 = esi_1152->dw000C;
			dwLoc24_1076 = ecx_1188 + 0x00401220;
			Eq_793 eax_1193 = LoadLibraryA(ecx_1188 + 0x00401220);
			if (eax_1193 != null)
			{
				struct Eq_808 * ebp_1219 = esi_1152->dw0000;
				if (ebp_1219 == null)
					ebp_1219 = esi_1152->dw0010;
				Eq_814 eax_1224 = ebp_1219->t401220;
				union Eq_818 * ebp_1226 = &ebp_1219->t401220;
				word32 * ebx_1228 = esi_1152->dw0010 + 0x00401220;
				if (eax_1224 != 0x00)
				{
					do
					{
						Eq_839 eax_1267;
						if (eax_1224 < 0x00)
						{
							Eq_680 eax_1282 = (word32) *ebp_1226;
							dwLoc24_1076 = eax_1282;
							eax_1267 = GetProcAddress(eax_1193, eax_1282);
						}
						else
						{
							Eq_680 eax_1293 = (word32) eax_1224 + 0x00401222;
							dwLoc24_1076 = eax_1293;
							eax_1267 = GetProcAddress(eax_1193, eax_1293);
						}
						*ebx_1228 = (word32) eax_1267;
						ebp_1226 = (union Eq_818 *) ((char *) ebp_1226 + 0x04);
						eax_1224 = *ebp_1226;
						ebx_1228 = ebx_1228 + 0x01;
					} while (eax_1224 != 0x00);
					esi_1152 = dwLoc04_1153;
				}
			}
			esi_1152 = esi_1152 + 0x01;
			dwLoc04_1153 = esi_1152;
		} while (esi_1152->dw0010 != 0x00);
	}
	fn00401C70(dwLoc24_1076);
	*(fp - 0x24) = 0x00;
	ExitProcess(*(fp - 0x24));
}

// 00401C70: void fn00401C70(Stack Eq_680 dwArg00)
void fn00401C70(LPCSTR dwArg00)
{
}

