// subject.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

// 00425C8E: Register byte fn00425C8E(Stack (ptr32 word32) dwArg04, Stack uint32 dwArg08, Stack word32 dwArg0C, Register out Eq_6 chOut)
byte fn00425C8E(word32 * dwArg04, uint32 dwArg08, word32 dwArg0C, Eq_6 & chOut)
{
	word32 * ecx_16 = dwArg04;
	uint32 edi_21 = dwArg08 >> 0x02;
	do
	{
		*ecx_16 = *ecx_16 ^ dwArg0C;
		*ecx_16 = *ecx_16 - 1012498734;
		*ecx_16 = *ecx_16 + dwArg0C;
		*ecx_16 = *ecx_16 ^ 3706917477;
		*ecx_16 = __rol(*ecx_16, 0x6C);
		*ecx_16 = *ecx_16 ^ dwArg0C;
		*ecx_16 = *ecx_16 ^ dwArg0C;
		*ecx_16 = __ror(*ecx_16, 0xD8);
		*ecx_16 = *ecx_16 ^ 3295872657;
		*ecx_16 = *ecx_16 ^ dwArg0C;
		ecx_16 = ecx_16 + 0x01;
		byte cl_55 = (byte) ecx_16;
		byte ch_56;
		*chOut = SLICE(ecx_16, byte, 8);
		edi_21 = edi_21 - 0x01;
	} while (edi_21 != 0x00);
	return cl_55;
}

// 00425CE8: Register Eq_105 Win32CrtStartup()
DWORD Win32CrtStartup()
{
	Eq_106 eax_12 = GetModuleHandleA(&globals->t42A000);
	GetCurrentThreadId();
	GetProcAddress(eax_12, &globals->t42A00A)();
	GetCommandLineA();
	byte ch_55;
	byte cl_56 = fn00425C8E(dwArg00, dwArg04, dwArg08, out ch_55);
	GetOEMCP();
	GetCommandLineW();
	GetOEMCP();
	GetCurrentProcessId();
	VirtualProtect(&globals->v53203B, 0x8E02, 0x40, fp - 0x18);
	Eq_158 ecx_29 = <invalid>;
	Eq_158 dx_43 = <invalid>;
	Eq_158 bh_41 = <invalid>;
	Eq_158 ebx_38 = <invalid>;
	Eq_158 dl_36 = <invalid>;
	Eq_158 edi_35 = <invalid>;
	Eq_158 dh_34 = <invalid>;
	Eq_158 bl_30 = <invalid>;
	Eq_158 esi_28 = <invalid>;
	word32 ecx_57 = DPB(ecx_29, cl_56, 0);
	Eq_170 eax_88 = CreateFileA(&globals->t42A016, 0xA0000000, 0x06, null, 0x03, 0x01A1, null);
	GetACP();
	*(ebp - 0x0C) = (HGLOBAL *) LoadResource(null, *(ebp - 0x10));
	word16 ax_114 = (word16) GetFileSize(*(ebp - 0x10), null);
	byte ch_116 = ch_55 + Mem106[(esi_28 - 0x62) + 0x00:byte] + (eax_88 <u ~0x00);
	DPB(ecx_57, ch_116, 8) + 0x828E28F5 = (word32) bl_30;
	((word32) edi_35 + 101)->u0 = __rcl(*((word32) edi_35 + 101), 0x99, false);
	int32 eax_121 = (int32) ax_114;
	int32 eax_131 = DPB(eax_121, 0x26, 8);
	byte al_135;
	byte ah_136;
	__aas((byte) (eax_131 ^ 3382193129), SLICE(eax_131 ^ 3382193129, byte, 8), &al_135, &ah_136);
	*ebx_38 = (word32) *ebx_38 + (ch_116 & dh_34);
	((word32) ebx_38 + ((eax_131 ^ 3382193129) + 45489806))->u0 = 223;
	((word32) esi_28 + 0x0039)->u0 = __rol(*((word32) esi_28 + 0x0039), cl_56);
	__wait();
	*((word32) edi_35 + 0x02) = eax_131 ^ 3382193129;
	ebp->b0038 = __rol(ebp->b0038, cl_56);
	__outb(DPB(dx_43, dl_36 ^ (byte) eax_121 + 225, 0), Mem155[DPB(ebx_38, bl_30 + bh_41, 0) + (uint32) al_135:byte] + 0x25);
	__wait();
}

