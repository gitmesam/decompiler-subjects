// subject.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

// 0040108C: Register Eq_2 Win32CrtStartup()
Eq_2 Win32CrtStartup()
{
	ptr32 esp_438;
	DWORD * esp_366;
	ptr32 esp_222;
	ptr32 esp_290;
	union Eq_2 * esp_306;
	Eq_2 eax_13 = OpenMutexA(0x001F0001, 0x00, 4420073);
	if (eax_13 == 0x00)
	{
		GetFileSize(OpenMutexA(0x001F0001, 0x01, 4420192), 0x00);
		Eq_2 eax_544 = OpenMutexA(0x001F0001, 0x00, 4420232);
		esp_438 = fp - 88;
		dwLoc0C = eax_544;
		if (eax_544 == 0x00)
		{
			CloseHandle(eax_544);
			GetFileSize(eax_544, 0x00);
			Eq_2 eax_575 = OpenMutexA(0x001F0001, 0x00, 0x00437237);
			esp_366 = fp - 88;
			dwLoc4C = eax_575;
			if (eax_575 == 0x00)
			{
				esp_222 = fp - 0x60;
l00401124:
				struct Eq_239 * esp_338 = esp_222 - 0x04;
				esp_338->t0000.u0 = 0x001F0001;
				dwLoc10 = OpenMutexA(esp_338->t0000, esp_338->t0004, esp_338->t0008);
				esp_338->t0008.u0 = 0x00;
				esp_338->t0004 = eax_13;
				GetFileSize(esp_338->t0004, esp_338->t0008);
				esp_290 = (char *) &esp_338->t0008 + 0x04;
l0040113D:
				union Eq_2 * esp_292 = esp_290 - 0x04;
				*esp_292 = (union Eq_2 *) dwLoc0C;
				GetFileType(*esp_292);
				*esp_292 = (union Eq_2 *) dwLoc10;
				GetFileType(*esp_292);
				*esp_292 = (union Eq_2 *) dwLoc0C;
				CloseHandle(*esp_292);
				*esp_292 = 0x00;
				esp_306 = esp_292;
l0040115A:
				struct Eq_275 * esp_72 = esp_306 - 0x04;
				esp_72->t0000 = dwLoc4C;
				GetFileSize(esp_72->t0000, esp_72->t0004);
				esp_72->t0004.u0 = 4420261;
				esp_72->t0000.u0 = 0x00;
				*(esp_72 - 0x04) = 0x001F0001;
				Eq_2 eax_82 = OpenMutexA(*(esp_72 - 0x04), esp_72->t0000, esp_72->t0004);
				esp_72->t0004 = dwLoc0C;
				GetFileType(esp_72->t0004);
				esp_72->t0004.u0 = 4420092;
				Eq_2 eax_92 = LoadLibraryA(esp_72->t0004);
				esp_72->t0004 = dwLoc10;
				CloseHandle(esp_72->t0004);
				esp_72->t0004.u0 = 4420209;
				esp_72->t0000 = eax_82;
				CloseHandle(esp_72->t0000);
				esp_72->t0000 = eax_92;
				*(esp_72 - 0x04) = 0x00;
				*(esp_72 - 0x08) = (union Eq_2 *) dwLoc0C;
				GetFileSize(*(esp_72 - 0x08), *(esp_72 - 0x04));
				*(esp_72 - 0x04) = 0x00;
				*(esp_72 - 0x08) = (union Eq_2 *) dwLoc0C;
				GetFileSize(*(esp_72 - 0x08), *(esp_72 - 0x04));
				Eq_555 eax_124 = GetProcAddress(esp_72->t0000, esp_72->t0004);
				esp_72->t0004 = eax_13;
				CloseHandle(esp_72->t0004);
				esp_72->t0004.u0 = 4420199;
				esp_72->t0000.u0 = 0x01;
				*(esp_72 - 0x04) = 0x001F0001;
				OpenMutexA(*(esp_72 - 0x04), esp_72->t0000, esp_72->t0004);
				esp_72->t0004 = dwLoc0C;
				GetFileType(esp_72->t0004);
				esp_72->t0004.u0 = 0x00;
				esp_72->t0000 = eax_82;
				GetFileSize(esp_72->t0000, esp_72->t0004);
				esp_72->t0004 = dwLoc10;
				GetFileType(esp_72->t0004);
				esp_72->t0004.u0 = 0x00;
				esp_72->t0000.u0 = 0x00;
				*(esp_72 - 0x04) = (union Eq_2 *) dwLoc10;
				GetFileSize(*(esp_72 - 0x04), esp_72->t0000);
				esp_72->t0000.u0 = 0x00;
				*(esp_72 - 0x04) = 0x00;
				*(esp_72 - 0x08) = (union Eq_2 *) dwLoc0C;
				GetFileSize(*(esp_72 - 0x08), *(esp_72 - 0x04));
				*(esp_72 - 0x04) = 0x00;
				*(esp_72 - 0x08) = (union Eq_2 *) eax_13;
				GetFileType(*(esp_72 - 0x08));
				Eq_353 eax_192 = eax_124();
				*(esp_72 - 0x08) = 4420171;
				*(esp_72 - 0x0C) = 0x01;
				*(esp_72 - 0x10) = 0x001F0001;
				Eq_2 eax_203 = OpenMutexA(*(esp_72 - 0x10), *(esp_72 - 0x0C), *(esp_72 - 0x08));
				*(esp_72 - 0x08) = 0x00;
				*(esp_72 - 0x0C) = (union Eq_2 *) dwLoc10;
				GetFileSize(*(esp_72 - 0x0C), *(esp_72 - 0x08));
				*(esp_72 - 0x08) = 4420249;
				*(esp_72 - 0x0C) = 0x00;
				*(esp_72 - 0x10) = 0x001F0001;
				esp_222 = esp_72 - 0x04;
				if (OpenMutexA(*(esp_72 - 0x10), *(esp_72 - 0x0C), *(esp_72 - 0x08)) == 0x00)
				{
					*(esp_72 - 0x08) = 0x00;
					*(esp_72 - 0x0C) = (union Eq_2 *) eax_203;
					GetFileSize(*(esp_72 - 0x0C), *(esp_72 - 0x08));
					*(esp_72 - 0x08) = 4420102;
					*(esp_72 - 0x0C) = 0x00;
					*(esp_72 - 0x10) = 0x001F0001;
					*(esp_72 - 0x08) = (union Eq_2 *) OpenMutexA(*(esp_72 - 0x10), *(esp_72 - 0x0C), *(esp_72 - 0x08));
					Eq_2 eax_251 = GetFileType(*(esp_72 - 0x08));
					word32 esp_253;
					word32 ebp_254;
					byte SCZO_255;
					Eq_2 eax_256;
					byte SZO_257;
					bool C_258;
					bool Z_259;
					(*((word32) eax_192 - 2143300902))();
					return eax_256;
				}
				goto l00401124;
			}
			goto l004013E9;
		}
	}
	else
	{
		GetFileType(dwLoc54);
		Eq_2 eax_603 = OpenMutexA(0x001F0001, 0x01, 4420066);
		CloseHandle(eax_603);
		GetFileType(dwLoc28);
		OpenMutexA(0x001F0001, 0x00, 4420115);
		dwLoc58 = eax_603;
		esp_438 = fp - 0x68;
	}
	struct Eq_69 * esp_439 = esp_438 - 0x04;
	esp_439->t0000.u0 = 0x00;
	*(esp_439 - 0x04) = (union Eq_2 *) dwLoc54;
	GetFileSize(*(esp_439 - 0x04), esp_439->t0000);
	VirtualProtect(esp_439->t0004, esp_439->t0008, esp_439->t000C, esp_439->t0010);
	esp_439->t0010.u0 = 4420060;
	esp_439->t000C.u0 = 0x00;
	esp_439->t0008.u0 = 0x001F0001;
	dwLoc30 = OpenMutexA(esp_439->t0008, esp_439->t000C, esp_439->t0010);
	esp_439->t0010.u0 = 0x00431000;
	esp_439->t000C.u0 = 0x00437242;
	esp_439->t0008.u0 = 0x01;
	esp_439->t0004.u0 = 0x001F0001;
	esp_306 = (union Eq_2 *) &esp_439->t0010;
	if (OpenMutexA(esp_439->t0004, esp_439->t0008, esp_439->t000C) != 0x00)
		goto l0040115A;
	esp_439->t000C.u0 = 0x00;
	esp_439->t0008 = dwLoc40;
	GetFileSize(esp_439->t0008, esp_439->t000C);
	esp_439->t000C = dwLoc3C;
	esp_439->t0008.u0 = 4420124;
	esp_439->t0004.u0 = 0x00;
	esp_439->t0000.u0 = 0x001F0001;
	Eq_2 eax_490 = OpenMutexA(esp_439->t0000, esp_439->t0004, esp_439->t0008);
	esp_439->t0008.u0 = 0x1877;
	esp_439->t0004 = eax_490;
	CloseHandle(esp_439->t0004);
	esp_439->t0004.u0 = 0x00;
	esp_439->t0000 = dwLoc0C;
	GetFileSize(esp_439->t0000, esp_439->t0004);
	esp_439->t0004 = dwLoc28;
	CloseHandle(esp_439->t0004);
	esp_439->t0004 = dwLoc1C;
	CloseHandle(esp_439->t0004);
	dwLoc50 = (word32) dwLoc3C + 1856631165;
	esp_366 = (DWORD *) &esp_439->t0008;
l004013E9:
	union Eq_2 * esp_368 = esp_366 - 0x04;
	*esp_368 = (union Eq_2 *) dwLoc58;
	Eq_2 eax_370 = CloseHandle(*esp_368);
	<anonymous> * v39_372 = dwLoc50 - 3999932777;
	ptr32 esp_381;
	word32 ebp_382;
	byte SCZO_383;
	word32 eax_384;
	byte SZO_385;
	bool C_386;
	bool Z_387;
	v39_372();
	*(esp_381 - 0x04) = 4420180;
	*(esp_381 - 0x08) = 0x00;
	*(esp_381 - 0x0C) = 0x001F0001;
	esp_290 = esp_381;
	if (OpenMutexA(*(esp_381 - 0x0C), *(esp_381 - 0x08), *(esp_381 - 0x04)) == 0x00)
	{
		*(esp_381 - 0x04) = 0x00;
		*(esp_381 - 0x08) = (union Eq_2 *) dwLoc1C;
		GetFileSize(*(esp_381 - 0x08), *(esp_381 - 0x04));
		*(esp_381 - 0x04) = (union Eq_2 *) dwLoc30;
		Eq_2 eax_415 = CloseHandle(*(esp_381 - 0x04));
		word32 esp_417;
		word32 ebp_418;
		byte SCZO_419;
		Eq_2 eax_420;
		byte SZO_421;
		bool C_422;
		bool Z_423;
		(v39_372 - ~0x0003000D)();
		return eax_420;
	}
	goto l0040113D;
}

