// subject.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

// 00401060: void fn00401060(Stack word32 dwArg04, Stack word32 dwArg08, Stack word32 dwArg0C)
void fn00401060(word32 dwArg04, word32 dwArg08, word32 dwArg0C)
{
	word32 dwLoc0C_15 = 0x00;
	while (dwLoc0C_15 < dwArg0C)
	{
		Mem29[dwArg04 + dwLoc0C_15:byte] = Mem0[dwArg08 + dwLoc0C_15:byte];
		dwLoc0C_15 = dwLoc0C_15 + 0x01;
	}
}

// 004010A0: void fn004010A0(Stack word32 dwArg04, Stack word32 dwArg08, Stack word32 dwArg0C)
void fn004010A0(word32 dwArg04, word32 dwArg08, word32 dwArg0C)
{
	if (dwArg0C >=u 0x01)
	{
		byte cl_46 = Mem0[dwArg04 + 0x00:byte];
		word32 dwLoc0C_113 = 0x01;
		word32 dwLoc1C_109 = 0x00;
		do
		{
			word32 ecx_64 = dwLoc0C_113 + 0x01;
			byte al_61 = Mem0[dwArg04 + dwLoc0C_113:byte];
			dwLoc0C_113 = ecx_64;
			if ((word32) al_61 == (word32) cl_46)
			{
				if ((word32) Mem0[dwArg04 + ecx_64:byte] == 0x00)
				{
					Mem106[dwArg08 + dwLoc1C_109:byte] = cl_46;
					dwLoc1C_109 = dwLoc1C_109 + 0x01;
					dwLoc0C_113 = ecx_64 + 0x01;
				}
				else
				{
					word32 eax_124 = fn004011B0(fp - 0x14, dwArg04 + ecx_64) + ecx_64;
					dwLoc0C_113 = fn004011B0(fp - 44, dwArg04 + eax_124) + eax_124;
					word32 dwLoc20_139 = 0x00;
					while (dwLoc20_139 <u dwLoc14)
					{
						Mem156[dwArg08 + dwLoc1C_109:byte] = Mem0[dwArg08 + (dwLoc1C_109 - dwLoc2C):byte];
						dwLoc1C_109 = dwLoc1C_109 + 0x01;
						dwLoc20_139 = dwLoc20_139 + 0x01;
					}
				}
			}
			else
			{
				Mem168[dwArg08 + dwLoc1C_109:byte] = al_61;
				dwLoc1C_109 = dwLoc1C_109 + 0x01;
			}
		} while (dwLoc0C_113 <u dwArg0C);
	}
}

// 004011B0: Register word32 fn004011B0(Stack word32 dwArg04, Stack word32 dwArg08)
word32 fn004011B0(word32 dwArg04, word32 dwArg08)
{
	word32 dwLoc0C_12 = 0x00;
	word32 dwLoc2C_13 = 0x00;
	do
	{
		word32 ecx_16 = (word32) Mem0[dwArg08 + 0x00:byte];
		word32 eax_25 = dwLoc0C_12 << 0x07 | ecx_16 & 0x7F;
		word32 edx_28 = dwLoc2C_13 + 0x01;
		dwArg08 = dwArg08 + 0x01;
		dwLoc0C_12 = eax_25;
		dwLoc2C_13 = edx_28;
	} while ((ecx_16 & 0x80) != 0x00);
	Mem38[dwArg04 + 0x00:word32] = eax_25;
	return edx_28;
}

// 00401210: Register word32 fn00401210(Stack word32 dwArg04)
word32 fn00401210(word32 dwArg04)
{
	word32 eax_27;
	word32 eax_23 = CreateFileA(dwArg04, 0x80000000, 0x01, 0x00, 0x03, 0x80, 0x00);
	if (eax_23 == ~0x00)
		eax_27 = 0x00;
	else
		eax_27 = eax_23;
	return eax_27;
}

// 00401250: void fn00401250(Stack word32 dwArg04, Stack byte bArg08, Stack word32 dwArg0C)
void fn00401250(word32 dwArg04, byte bArg08, word32 dwArg0C)
{
	word32 dwLoc0C_15 = 0x00;
	while (dwLoc0C_15 < dwArg0C)
	{
		Mem26[dwArg04 + dwLoc0C_15:byte] = bArg08;
		dwLoc0C_15 = dwLoc0C_15 + 0x01;
	}
}

// 00401290: Register DWORD Win32CrtStartup()
DWORD Win32CrtStartup()
{
	Mem24[0x00403030:word32] = dwLoc0C >> (byte) Mem0[0x00403044:word32] << ~0x23 >> 0x07;
	word32 ecx_27 = Mem24[0x00403034:word32] + dwLoc24;
	Mem32[0x00403030:word32] = Mem24[0x00403030:word32] + Mem24[0x00403014:word32];
	word32 eax_33 = Mem32[0x00403044:word32];
	word32 edx_44 = 322753 << (byte) Mem32[0x00403034:word32] << (byte) dwLoc14;
	Mem52[0x00403030:word32] = 393525 << (byte) (Mem32[0x00403034:word32] *s 739837);
	Mem60[0x00403044:word32] = eax_33 *s 967864 + 0x00057653 >> (byte) (Mem52[0x00403014:word32] + edx_44);
	GetModuleHandleA(0x00);
	Mem69[0x00403034:word32] = Mem60[0x00403044:word32] >> ~0x60;
	Mem76[0x00403034:word32] = eax_33 *s 967864 + 868682 << (byte) (ecx_27 << 0x7D);
	word32 ecx_103 = Mem76[0x00403030:word32] + Mem76[0x00403014:word32];
	word32 eax_100 = (Mem76[0x00403044:word32] << (byte) (Mem76[0x00403030:word32] - 906066)) - dwLoc14 >> (byte) (Mem76[0x00403044:word32] + eax_33 *s 967864);
	Mem112[0x00403030:word32] = ecx_103 *s 922912 + Mem76[0x00403034:word32] >> (byte) ecx_103;
	word32 eax_116 = DPB(fp - 188, RegisterClassA(fp - 188), 0);
	Mem123[0x00403034:word32] = Mem112[0x00403044:word32] *s Mem112[0x00403030:word32] + 521148 << (byte) Mem112[0x00403030:word32];
	word32 esp_114 = fp - 0xD8;
	if (dwArg08 != 0x01)
		Mem572[0x0040302C:word32] = 0x00;
	else
	{
		Mem573[0x0040302C:word32] = 0x01;
		Mem575[4206620:word32] = dwArg04;
	}
	word32 dwLoc30_137;
	Mem130[0x00403034:word32] = Mem123[0x00403014:word32] *s 0xDBF0;
	if (Mem130[0x0040302C:word32] == 0x00)
	{
		esp_114 = fp - 220;
		dwLoc30_137 = GetModuleHandleA(0x00);
	}
	else
		dwLoc30_137 = dwArg04;
	Mem144[0x00403014:word32] = eax_100 *s 124421;
	word32 ecx_147 = dwLoc30_137 + Mem144[dwLoc30_137 + 0x3C:word32];
	Mem152[0x00403014:word32] = dwLoc14 - 0x0002B014;
	word32 esp_153 = esp_114 - 0x04;
	Mem154[esp_153 + 0x00:word32] = 0x44;
	Mem156[esp_153 - 0x04 + 0x00:word32] = 0x00;
	Mem159[esp_153 - 0x08 + 0x00:word32] = fp - 0x7C;
	fn00401250(dwArg00, bArg04, dwArg08);
	Mem170[esp_153 + 0x00:word32] = fp - 0x7C;
	GetStartupInfoA(Mem170[esp_153 + 0x00:LPSTARTUPINFOA]);
	if (true)
		return 0x00;
	Mem244[0x00403044:word32] = 0x0007D6A6 >> (byte) (377075 - ecx_103 *s eax_100);
	word32 edx_268 = ((word32) Mem244[ecx_147 + 0x06:word16] - 0x01) *s 0x28 + ((ecx_147 + 0x18) + (word32) Mem244[ecx_147 + 0x14:word16]);
	word32 eax_284 = (uint32) ((uint64) (uint32) (Mem244[edx_268 + 0x10:word32] - 0x01 + Mem244[ecx_147 + 0x3C:word32]) /u Mem244[ecx_147 + 0x3C:word32]) *s Mem244[ecx_147 + 0x3C:word32] + Mem244[edx_268 + 0x14:word32];
	Mem288[esp_153 - 0x04 + 0x00:word32] = 0x0200;
	word32 eax_289 = fn00402090(dwArg00);
	if (eax_289 == 0x00)
		return 0x00;
	Mem299[esp_153 - 0x04 + 0x00:word32] = 0x0200;
	Mem302[esp_153 - 0x08 + 0x00:word32] = eax_289;
	Mem305[esp_153 - 0x0C + 0x00:word32] = dwLoc30_137;
	GetModuleFileNameA(Mem305[esp_153 - 0x0C + 0x00:HMODULE], Mem305[esp_153 - 0x08 + 0x00:LPSTR], Mem305[esp_153 - 0x04 + 0x00:DWORD]);
	Mem309[esp_153 - 0x10 + 0x00:word32] = eax_289;
	word32 eax_310 = fn00401210(dwArg00);
	if (eax_310 == 0x00)
		return 0x00;
	Mem320[esp_153 - 0x10 + 0x00:word32] = 0x00;
	Mem323[esp_153 - 0x14 + 0x00:word32] = eax_310;
	word32 eax_325 = GetFileSize(Mem323[esp_153 - 0x14 + 0x00:HANDLE], Mem323[esp_153 - 0x10 + 0x00:LPDWORD]) - eax_284;
	if (eax_325 == 0x00)
		return 0x00;
	Mem337[esp_153 - 0x18 + 0x00:word32] = eax_325 + 0x10;
	word32 eax_338 = fn00402090(dwArg00);
	if (eax_338 == 0x00)
		return 0x00;
	Mem348[esp_153 - 0x18 + 0x00:word32] = 0x00;
	Mem350[esp_153 - 0x1C + 0x00:word32] = 0x00;
	Mem353[esp_153 - 0x20 + 0x00:word32] = eax_284;
	Mem356[esp_153 - 0x24 + 0x00:word32] = eax_310;
	SetFilePointer(Mem356[esp_153 - 0x24 + 0x00:HANDLE], Mem356[esp_153 - 0x20 + 0x00:LONG], Mem356[esp_153 - 0x1C + 0x00:PLONG], Mem356[esp_153 - 0x18 + 0x00:DWORD]);
	Mem359[esp_153 - 0x28 + 0x00:word32] = 0x00;
	Mem362[esp_153 - 44 + 0x00:word32] = fp - 0x84;
	Mem365[esp_153 - 0x30 + 0x00:word32] = eax_325;
	Mem368[esp_153 - 0x34 + 0x00:word32] = eax_338;
	Mem371[esp_153 - 0x38 + 0x00:word32] = eax_310;
	if (ReadFile(Mem371[esp_153 - 0x38 + 0x00:HANDLE], Mem371[esp_153 - 0x34 + 0x00:LPVOID], Mem371[esp_153 - 0x30 + 0x00:DWORD], Mem371[esp_153 - 44 + 0x00:LPDWORD], Mem371[esp_153 - 0x28 + 0x00:LPOVERLAPPED]) == 0x00 || dwLoc84 != eax_325)
		return 0x00;
	Mem390[esp_153 - 0x3C + 0x00:word32] = eax_310;
	CloseHandle(Mem390[esp_153 - 0x3C + 0x00:HANDLE]);
	if (dwLoc84 != eax_325)
		return 0x00;
	Mem400[esp_153 - 0x40 + 0x00:word32] = 0x40;
	Mem405[esp_153 - 0x44 + 0x00:word32] = eax_338 - 0x40 + eax_325;
	Mem408[esp_153 - 0x48 + 0x00:word32] = eax_338;
	fn00401060(dwArg00, dwArg04, dwArg08);
	word32 eax_413 = Mem408[eax_338 + 0x00:word32];
	word32 edx_416 = Mem408[eax_338 + 0x04:word32];
	word32 dwLoc10_418 = 0x00;
	while (dwLoc10_418 <u eax_413)
	{
		Mem432[eax_338 + dwLoc10_418 + 0x08:word32] = Mem408[eax_338 + dwLoc10_418 + 0x08:word32] ^ 1111111;
		dwLoc10_418 = dwLoc10_418 + 0x08;
	}
	Mem439[esp_153 - 0x40 + 0x00:word32] = edx_416;
	Mem442[0x00403028:word32] = fn00402090(dwArg00);
	if (Mem442[0x00403028:word32] != 0x00)
	{
		word32 esp_476;
		Mem449[esp_153 - 0x40 + 0x00:word32] = eax_413;
		Mem452[esp_153 - 0x44 + 0x00:word32] = Mem449[0x00403028:word32];
		Mem457[esp_153 - 0x48 + 0x00:word32] = eax_338 + 0x08;
		fn004010A0(dwArg00, dwArg04, dwArg08);
		Mem461[esp_153 - 0x40 + 0x00:word32] = 4200406;
		word32 eax_462 = Mem461[esp_153 - 0x40 + 0x00:word32];
		Mem467[0x0040303C:word32] = Mem461[fs:0x18:word32];
		Mem468[0x00403018:word32] = edi;
		Mem469[0x00403010:word32] = esi;
		Mem470[0x00403024:word32] = ebx;
		Mem471[0x00403020:word32] = fp - 0x04;
		if (Mem471[0x0040302C:word32] != 0x00)
		{
			Mem552[esp_153 - 0x40 + 0x00:word32] = eax_462 - Mem471[4206620:word32];
			fn004018C0(fp - 0x04, dwArg00);
			esp_476 = esp_153 - 0x3C;
		}
		else
		{
			Mem556[esp_153 - 0x40 + 0x00:word32] = 0x00;
			Mem562[esp_153 - 0x44 + 0x00:word32] = eax_462 - GetModuleHandleA(Mem556[(esp_153 - 0x40) + 0x00:LPCSTR]);
			fn004018C0(fp - 0x04, dwArg00);
			esp_476 = esp_153 - 0x40;
		}
		word32 esp_478 = esp_476 - 0x04;
		Mem479[esp_478 + 0x00:word32] = Mem471[0x00403028:word32];
		if (fn00401A90(fp - 0x04, dwArg00) != 0x00)
		{
			Mem497[fp - 0x0C + 0x00:word32] = Mem479[0x00403044:word32] + 0x000CE543 >> (byte) Mem479[(fp - 0x14) + 0x00:word32];
			Mem505[0x00403034:word32] = 0x0009B33F >> (byte) (0xF5ED - Mem497[(fp - 0x0C) + 0x00:word32]) >> ~0x45;
			Mem513[fp - 0x24 + 0x00:word32] = 232940 << (byte) (Mem505[(fp - 0x18) + 0x00:word32] *s 0x000151B8 - 0x00070889);
			Mem521[fp - 0x0C + 0x00:word32] = 0x0007733A >> (byte) ((Mem513[0x00403014:word32] - 902709) - Mem513[0x00403014:word32]);
			word32 ecx_524 = Mem521[0x00403044:word32];
			byte cl_525 = (byte) ecx_524;
			Mem528[fp - 0x24 + 0x00:word32] = Mem521[0x00403030:word32] >> cl_525 << 0x49;
			word32 eax_531 = 640594 - Mem528[(fp - 0x24) + 0x00:word32];
			Mem533[fp - 0x0C + 0x00:word32] = eax_531;
			word32 esp_534;
			word32 ebp_535;
			byte SCZO_536;
			word32 ebx_537;
			word32 esi_538;
			word32 edi_539;
			word32 eax_540;
			word32 ecx_541;
			byte cl_542;
			word32 edx_543;
			byte Z_544;
			byte SZO_545;
			byte C_546;
			selector fs_547;
			Mem533[0x00403040:word32]();
			return eax_540;
		}
		else
		{
			Mem487[esp_478 + 0x00:word32] = Mem479[0x00403028:word32];
			fn00402060(dwArg00);
			Mem491[esp_478 + 0x00:word32] = 550036;
			ExitProcess(Mem491[esp_478 + 0x00:UINT]);
		}
	}
	else
	{
		Mem446[esp_153 - 0x40 + 0x00:word32] = 8545336;
		ExitProcess(Mem446[esp_153 - 0x40 + 0x00:UINT]);
	}
}

// 004018C0: void fn004018C0(Register word32 ebp, Stack word32 dwArg04)
void fn004018C0(word32 ebp, word32 dwArg04)
{
	word32 dwLoc38_14;
	word32 esp_16 = fp - 0x3C;
	if (Mem0[0x0040302C:word32] != 0x00)
		dwLoc38_14 = Mem0[4206620:word32];
	else
	{
		esp_16 = fp - 0x40;
		dwLoc38_14 = GetModuleHandleA(0x00);
	}
	if (dwLoc38_14 == 0x00)
		return;
	word32 edx_61 = dwLoc38_14 + Mem0[dwLoc38_14 + 0x3C:word32];
	word32 esp_63 = esp_16 - 0x04;
	Mem64[esp_63 + 0x00:word32] = 0x40;
	Mem66[esp_63 - 0x04 + 0x00:word32] = 0x3000;
	Mem70[esp_63 - 0x08 + 0x00:word32] = Mem66[edx_61 + 0x50:word32];
	Mem72[esp_63 - 0x0C + 0x00:word32] = 0x00;
	Mem74[0x00403038:word32] = VirtualAlloc(Mem72[esp_63 - 0x0C + 0x00:LPVOID], Mem72[esp_63 - 0x08 + 0x00:SIZE_T], Mem72[esp_63 - 0x04 + 0x00:DWORD], Mem72[esp_63 + 0x00:DWORD]);
	if (Mem74[0x00403038:word32] == 0x00)
		return;
	Mem83[esp_63 - 0x10 + 0x00:word32] = Mem74[edx_61 + 0x50:word32];
	Mem86[esp_63 - 0x14 + 0x00:word32] = dwLoc38_14;
	word32 edx_87 = Mem86[0x00403038:word32];
	Mem89[esp_63 - 0x18 + 0x00:word32] = edx_87;
	fn00401060(dwArg00, dwArg04, dwArg08);
	word32 eax_95 = Mem89[0x00403038:word32] - dwLoc38_14;
	if (Mem89[edx_61 + 0xA4:word32] != 0x00)
	{
		word32 dwLoc10_127 = dwLoc38_14 + Mem89[edx_61 + 0xA0:word32];
		while (Mem89[dwLoc10_127 + 0x04:word32] != 0x00)
		{
			word32 eax_142 = Mem89[dwLoc10_127 + 0x04:word32] - 0x08 >>u 0x01;
			word32 ecx_145 = dwLoc10_127 + 0x08;
			word32 dwLoc0C_148 = 0x00;
			while (dwLoc0C_148 <u eax_142)
			{
				if ((word32) ecx_145[dwLoc0C_148 * 0x02] >> 0x0C == 0x03)
					Mem189[Mem89[0x00403038:word32] + Mem89[dwLoc10_127 + 0x00:word32] + ((word32) ecx_145[dwLoc0C_148 * 0x02] & 0x0FFF):word32] = Mem89[Mem89[0x00403038:word32] + Mem89[dwLoc10_127 + 0x00:word32] + ((word32) ecx_145[dwLoc0C_148 * 0x02] & 0x0FFF):word32] + eax_95;
				dwLoc0C_148 = dwLoc0C_148 + 0x01;
			}
			dwLoc10_127 = dwLoc10_127 + Mem89[dwLoc10_127 + 0x04:word32];
		}
	}
	Mem106[esp_63 - 0x10 + 0x00:word32] = dwArg04;
	word32 eax_109 = Mem106[esp_63 - 0x10 + 0x00:word32] + Mem106[0x00403038:word32];
	word32 esp_113;
	word32 ebp_114;
	byte SCZO_115;
	word32 esi_116;
	byte Z_117;
	word32 eax_118;
	byte SZO_119;
	byte C_120;
	word32 ecx_121;
	word32 edx_122;
	eax_109();
}

// 00401A90: Register word32 fn00401A90(Register word32 ebp, Stack word32 dwArg04)
word32 fn00401A90(word32 ebp, word32 dwArg04)
{
}

// 00401FC0: void fn00401FC0(Stack word32 dwArg04, Stack word32 dwArg08)
void fn00401FC0(word32 dwArg04, word32 dwArg08)
{
}

// 00402030: void fn00402030(Stack word32 dwArg04)
void fn00402030(word32 dwArg04)
{
	Mem21[Mem0[Mem0[0x0040303C:word32] + 0x30:word32] + 0x08:word32] = dwArg04;
}

// 00402060: void fn00402060(Stack word32 dwArg04)
void fn00402060(word32 dwArg04)
{
	HeapFree(GetProcessHeap(), 0x00, dwArg04);
}

// 00402090: Register word32 fn00402090(Stack word32 dwArg04)
word32 fn00402090(word32 dwArg04)
{
	return HeapAlloc(GetProcessHeap(), 0x00, dwArg04);
}

