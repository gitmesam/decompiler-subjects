// subject.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

// 00401005: Register Eq_2 Win32CrtStartup()
DWORD Win32CrtStartup()
{
	word32 edx_39 = edx + esi + esi + (fp + 0x10) + (fp + 0x10);
	word32 ebx_104;
	word32 ebp_105;
	word32 edi_106;
	Eq_2 eax_107 = fn004010CA(edx_39 + 1663818308, ebx, ebp, edi, dwLoc2C, dwLoc16, esi, out ebx_104, out ebp_105, out edi_106);
	word32 ebx_109;
	word32 ebp_110;
	word32 edi_111;
	return fn004010CA(eax_107, ebx_104, ebp_105, edi_106, dwLoc2C, dwLoc16, esi, out ebx_109, out ebp_110, out edi_111);
}

// 004010CA: Register Eq_2 fn004010CA(Register Eq_2 eax, Register word32 ebx, Register word32 ebp, Register word32 edi, Stack word32 dwArg00, Stack word32 dwArg16, Stack word32 dwArg24, Register out ptr32 ebxOut, Register out ptr32 ebpOut, Register out ptr32 ediOut)
DWORD fn004010CA(DWORD eax, word32 ebx, word32 ebp, word32 edi, word32 dwArg00, word32 dwArg16, word32 dwArg24, ptr32 & ebxOut, ptr32 & ebpOut, ptr32 & ediOut)
{
	word32 ecx_131;
	struct Eq_50 * ebx_132;
	fn00401697(ebx, dwLoc32, fp - 0x2A, out ecx_131, out ebx_132);
	word32 esp_150;
	word32 eax_151;
	byte SZO_152;
	word32 ebp_153;
	word32 edx_154;
	bool C_155;
	word16 ax_156;
	word16 cx_157;
	word32 ecx_158;
	byte SCZO_159;
	word32 esi_160;
	struct Eq_76 * ebx_161;
	word32 edi_162;
	word16 si_163;
	struct Eq_79 * fs_164;
	byte al_165;
	bool Z_166;
	byte dh_167;
	byte dl_168;
	byte bh_169;
	word16 bx_170;
	byte CZ_171;
	byte ah_172;
	byte cl_173;
	byte bl_174;
	ebx_132->ptr0018();
	ptr32 esp_176;
	word32 eax_177;
	byte SZO_178;
	word32 ebp_179;
	word32 edx_180;
	bool C_181;
	word16 ax_182;
	word16 cx_183;
	word32 ecx_184;
	byte SCZO_185;
	word32 esi_186;
	<anonymous> ** ebx_187;
	word32 edi_188;
	word16 si_189;
	struct Eq_107 * fs_190;
	byte al_191;
	bool Z_192;
	byte dh_193;
	byte dl_194;
	byte bh_195;
	word16 bx_196;
	byte CZ_197;
	byte ah_198;
	byte cl_199;
	byte bl_200;
	ebx_161->ptr001C();
	*(esp_176 - 0x04) = eax_177 + 0x06;
	*(esp_176 - 0x08) = eax_177 + 0x06;
	struct Eq_134 * esp_219;
	word32 eax_220;
	byte SZO_221;
	word32 ebp_222;
	word32 edx_223;
	bool C_224;
	word16 ax_225;
	word16 cx_226;
	word32 ecx_227;
	byte SCZO_228;
	word32 esi_229;
	word32 ebx_230;
	word32 edi_231;
	word16 si_232;
	struct Eq_148 * fs_233;
	byte al_234;
	bool Z_235;
	byte dh_236;
	byte dl_237;
	byte bh_238;
	word16 bx_239;
	byte CZ_240;
	byte ah_241;
	byte cl_242;
	byte bl_243;
	(*ebx_187)();
	esp_219->dw0038 = ebx_230;
	esp_219->dw003C = esi_229;
	*(esp_219 - 0x04) = ebx_230;
	*(esp_219 - 0x04) = *(esp_219 - 0x04) - 0x04;
	struct Eq_183 * edi_261 = *(esp_219 - 0x04);
	*(esp_219 - 0x04) = eax_220;
	*(esp_219 - 0x08) = ecx_227;
	*(esp_219 - 0x0C) = esp_219 - 0x08;
	*(esp_219 - 0x10) = 0x40;
	*(esp_219 - 0x14) = esp_219->dw0020;
	*(esp_219 - 0x18) = esp_219->dw0014;
	esp_219->dw0018 = 0x00;
	*(esp_219 - 0x1C) = ~0x00;
	struct Eq_236 * esp_294;
	struct Eq_237 Eq_249::* eax_295;
	byte SZO_296;
	word32 edx_298;
	bool C_299;
	word16 ax_300;
	word16 cx_301;
	word32 ecx_302;
	byte SCZO_303;
	word32 esi_304;
	word32 ebx_305;
	word32 edi_306;
	word16 si_307;
	struct Eq_249 * fs_308;
	byte al_309;
	bool Z_310;
	byte dh_311;
	byte dl_312;
	byte bh_313;
	word16 bx_314;
	byte CZ_315;
	byte ah_316;
	byte cl_317;
	byte bl_318;
	ptr32 ebp_1161;
	edi_261->ptr0010();
	struct Eq_264 * eax_320 = eax_295 + (fs_308->*eax_295).dw002F / 0x0033;
	esp_294->dw0030 = esp_294->dw0030 + eax_320->dw0003;
	*(esp_294 - 0x04) = (struct Eq_264 **) eax_320;
	esp_294->dw0000 = *(esp_294 - 0x04);
	esp_294->dw0004 = esp_294->dw0000;
	word32 edi_346 = esp_294->dw0008;
	esp_294->dw0008 = esp_294->dw0004;
	word32 ebx_1169 = esp_294->dw000C;
	esp_294->dw000C = esp_294->dw0008;
	word32 eax_361 = esp_294->dw000C;
	word32 * esi_1168 = esp_294->ptr0010;
	esp_294->ptr0010 = eax_361 + 0x03;
	word32 * eax_377 = esp_294->ptr0010;
	word32 ecx_379 = *eax_377;
	esp_294->ptr0010 = eax_377;
	esp_294->dw003C = esp_294->dw003C ^ ecx_379;
	word32 * eax_389 = esp_294->ptr001C;
	word32 ecx_393 = esp_294->dw002C;
	esp_294->ptr0010 = eax_389;
	word32 * eax_399 = esp_294->ptr0010;
	*(esp_294 - 244) = eax_399;
	*(esp_294 - 0xF0) = ecx_393;
	*(esp_294 - 0xF8) = eax_399;
	*(esp_294 - 0xF8) = edi_346;
	int32 eax_415 = 0x00;
	do
	{
		*(esp_294 - 252) = eax_415;
		word32 eax_427 = *(esp_294 - 252);
		esp_294 - 0xEC + eax_415 = (byte *) (byte) eax_427;
		*(esp_294 - 252) = eax_427;
		*(esp_294 - 252) = *(esp_294 - 252) + 0x01;
		up32 eax_441 = *(esp_294 - 252);
		*(esp_294 - 252) = eax_441;
		eax_415 = *(esp_294 - 252);
	} while (eax_441 < 0x0100);
	*(esp_294 - 252) = eax_415;
	word32 edi_1170 = *(esp_294 - 0xF8);
	*(esp_294 - 0xF8) = *(esp_294 - 252);
	*(esp_294 - 0xF8) = &esp_294->dw003C + 0x02;
	byte * eax_469 = *(esp_294 - 0xF8);
	*(esp_294 - 0xF8) = (byte **) eax_469;
	ptr32 eax_1215 = *(esp_294 - 0xF8);
	ptr32 esp_1219 = esp_294 - 244;
	if (*eax_469 != 121)
	{
		struct Eq_488 * edi_962 = *(eax_1215 - 0x04);
		do
		{
			ptr32 esp_963;
			word32 eax_964;
			byte SZO_965;
			word32 ebp_966;
			word32 edx_967;
			bool C_968;
			word16 ax_969;
			word16 cx_970;
			word32 ecx_971;
			byte SCZO_972;
			word32 esi_973;
			word32 ebx_974;
			struct Eq_511 * edi_975;
			word16 si_976;
			struct Eq_513 * fs_977;
			byte al_978;
			bool Z_979;
			byte dh_980;
			byte dl_981;
			byte bh_982;
			word16 bx_983;
			byte CZ_984;
			byte ah_985;
			byte cl_986;
			byte bl_987;
			edi_962->ptr0018();
			*(esp_963 - 0x04) = eax_964;
			word32 eax_991 = *(esp_963 - 0x04);
			__syscall(0x00);
			*(esp_963 - 0x04) = eax_991;
			*(esp_963 - 0x04) = *(esp_963 - 0x04) + 0x01;
			ptr32 esp_1005;
			word32 eax_1006;
			byte SZO_1007;
			word32 ebp_1008;
			word32 edx_1009;
			bool C_1010;
			word16 ax_1011;
			word16 cx_1012;
			word32 ecx_1013;
			byte SCZO_1014;
			word32 esi_1015;
			word32 ebx_1016;
			struct Eq_570 * edi_1017;
			word16 si_1018;
			struct Eq_572 * fs_1019;
			byte al_1020;
			bool Z_1021;
			byte dh_1022;
			byte dl_1023;
			byte bh_1024;
			word16 bx_1025;
			byte CZ_1026;
			byte ah_1027;
			byte cl_1028;
			byte bl_1029;
			edi_975->ptr0018();
			*(esp_1005 - 0x04) = eax_1006;
			ptr32 esp_1035;
			word32 eax_1036;
			byte SZO_1037;
			word32 ebp_1038;
			word32 edx_1039;
			bool C_1040;
			word16 ax_1041;
			word16 cx_1042;
			word32 ecx_1043;
			byte SCZO_1044;
			word32 esi_1045;
			word32 ebx_1046;
			struct Eq_603 * edi_1047;
			word16 si_1048;
			struct Eq_605 * fs_1049;
			byte al_1050;
			bool Z_1051;
			byte dh_1052;
			byte dl_1053;
			byte bh_1054;
			word16 bx_1055;
			byte CZ_1056;
			byte ah_1057;
			byte cl_1058;
			byte bl_1059;
			edi_1017->ptr0018();
			*(esp_1035 - 0x04) = eax_1036;
			ptr32 esp_1065;
			word32 eax_1066;
			byte SZO_1067;
			word32 ebp_1068;
			word32 edx_1069;
			bool C_1070;
			word16 ax_1071;
			word16 cx_1072;
			word32 ecx_1073;
			byte SCZO_1074;
			word32 esi_1075;
			word32 ebx_1076;
			struct Eq_636 * edi_1077;
			word16 si_1078;
			struct Eq_638 * fs_1079;
			byte al_1080;
			bool Z_1081;
			byte dh_1082;
			byte dl_1083;
			byte bh_1084;
			word16 bx_1085;
			byte CZ_1086;
			byte ah_1087;
			byte cl_1088;
			byte bl_1089;
			edi_1047->ptr0018();
			*(esp_1065 - 0x04) = eax_1066;
			ptr32 esp_1095;
			word32 eax_1096;
			byte SZO_1097;
			word32 ebp_1098;
			word32 edx_1099;
			bool C_1100;
			word16 ax_1101;
			word16 cx_1102;
			word32 ecx_1103;
			byte SCZO_1104;
			word32 esi_1105;
			word32 ebx_1106;
			struct Eq_669 * edi_1107;
			word16 si_1108;
			struct Eq_671 * fs_1109;
			byte al_1110;
			bool Z_1111;
			byte dh_1112;
			byte dl_1113;
			byte bh_1114;
			word16 bx_1115;
			byte CZ_1116;
			byte ah_1117;
			byte cl_1118;
			byte bl_1119;
			edi_1077->ptr0018();
			*(esp_1095 - 0x04) = eax_1096;
			ptr32 esp_1125;
			word32 eax_1126;
			byte SZO_1127;
			word32 ebp_1128;
			word32 edx_1129;
			bool C_1130;
			word16 ax_1131;
			word16 cx_1132;
			word32 ecx_1133;
			byte SCZO_1134;
			word32 esi_1135;
			word32 ebx_1136;
			struct Eq_702 * edi_1137;
			word16 si_1138;
			struct Eq_704 * fs_1139;
			byte al_1140;
			bool Z_1141;
			byte dh_1142;
			byte dl_1143;
			byte bh_1144;
			word16 bx_1145;
			byte CZ_1146;
			byte ah_1147;
			byte cl_1148;
			byte bl_1149;
			edi_1107->ptr0018();
			*(esp_1125 - 0x04) = eax_1126;
			ptr32 esp_1158;
			word32 eax_1159;
			byte SZO_1160;
			word32 edx_1162;
			bool C_1163;
			word16 ax_1164;
			word16 cx_1165;
			word32 ecx_1166;
			byte SCZO_1167;
			word16 si_1171;
			struct Eq_733 * fs_1172;
			byte al_1173;
			bool Z_1174;
			byte dh_1175;
			byte dl_1176;
			byte bh_1177;
			word16 bx_1178;
			byte CZ_1179;
			byte ah_1180;
			byte cl_1181;
			byte bl_1182;
			edi_1137->ptr0010();
			*(esp_1158 - 0x04) = eax_1159;
			*(esp_1158 - 0x04) = *(esp_1158 - 0x04) + 0x01;
			word32 eax_1197 = *(esp_1158 - 0x04);
			cup16 ax_1200 = (word16) eax_1197 - cx_1165;
			*(esp_1158 - 0x04) = DPB(eax_1197, ax_1200, 0);
			word32 eax_1207 = *(esp_1158 - 0x04);
		} while (ax_1200 < 0x00);
		*(esp_1158 - 0x04) = eax_1207;
		eax_1215 = *(esp_1158 - 0x04);
		esp_1219 = esp_1158;
	}
	struct Eq_475 * esp_504 = esp_1219 - 0x04;
	esp_504->ptr0000 = eax_1215;
	ptr32 eax_507 = esp_504->ptr0000;
	esp_504->ptr0000 = ebp_1161;
	*(esp_504 - 0x04) = esi_1168;
	*(esp_504 - 0x08) = edi_1170;
	*(esp_504 - 0x0C) = eax_507;
	up32 edi_524 = esp_504->dw011C;
	*(esp_504 - 0x0C) = 0x00;
	int32 eax_529 = *(esp_504 - 0x0C);
	*(esp_504 - 0x0C) = eax_529;
	*(esp_504 - 0x0C) = *(esp_504 - 0x0C);
	word32 eax_544 = *(esp_504 - 0x0C);
	*(esp_504 - 0x0C) = ebx_1169;
	*(esp_504 - 0x10) = eax_544;
	int32 esi_531 = eax_529;
	int32 ebp_538 = 0x00;
	word32 eax_551 = *(esp_504 - 0x10);
	do
	{
		struct Eq_865 * esp_564 = esp_1219 - 0x10;
		word32 ebx_566 = (word32) esp_564->a0018[ebp_538];
		*(esp_564 - 0x04) = eax_551;
		ptr32 edx_574 = esp_564->ptr0014;
		*(esp_564 - 0x04) = *(esp_564 - 0x04);
		int32 eax_578 = *(esp_564 - 0x04);
		word32 edx_580 = (word32) (edx_574 + eax_578);
		*(esp_564 - 0x04) = eax_578;
		*(esp_564 - 0x04) = *(esp_564 - 0x04);
		word16 bx_567 = (word16) ebx_566;
		word32 eax_592 = *(esp_564 - 0x04);
		word32 ecx_597 = ebx_566 + esi_531;
		word32 edx_601 = edx_580 + ecx_597;
		int32 edx_605 = DPB(edx_601, 0x00, 8);
		*(esp_564 - 0x04) = eax_592 + 0x01;
		*(esp_564 - 0x04) = *(esp_564 - 0x04);
		up32 eax_619 = *(esp_564 - 0x04);
		*(esp_564 - 0x04) = eax_619;
		esi_531 = edx_605;
		ui32 eax_626 = *(esp_564 - 0x04);
		if (eax_619 >= edi_524)
		{
			*(esp_564 - 0x04) = eax_626;
			*(esp_564 - 0x04) = 0x00;
			eax_626 = *(esp_564 - 0x04);
		}
		byte dl_638 = esp_564->a0018[edx_605];
		esp_564->a0018[ebp_538] = dl_638;
		ebp_538 = ebp_538 + 0x01;
		ptr32 edx_643 = esp_564->a0018 + edx_605;
		*(esp_564 - 0x04) = eax_626;
		ptr32 edx_646 = edx_643 - eax_626;
		word32 eax_651 = *(esp_564 - 0x04);
		word16 bx_654 = DPB(bx_567, eax_651 + 0x01 + edx_646, 8);
		*(esp_564 - 0x04) = eax_651;
		int32 eax_658 = *(esp_564 - 0x04);
		eax_658 + edx_646 = (word16 *) bx_654;
		byte bh_665 = SLICE(ebp_538, byte, 8);
		byte SZO_669 = cond(bh_665 - 0x01);
		*(esp_564 - 0x04) = eax_658;
		eax_551 = *(esp_564 - 0x04);
	} while (bh_665 != 0x01);
	*(esp_564 - 0x04) = eax_551;
	*(esp_564 - 0x04) = *(esp_564 - 0x04);
	word32 esi_687 = 0x00;
	int32 ebx_700 = esp_564->dw0000;
	word32 ebp_705 = esp_564->dw012C;
	esp_564->dw0000 = 0x00;
	ptr32 edi_711 = esp_564->ptr0010;
	esp_564->dw0000 = esp_564->dw0000;
	int32 eax_715 = esp_564->dw0000;
	int32 edx_720 = ebx_700;
	Eq_1059 CZ_727 = DPB(SZO_669, false, 0);
	if (!CZ_727)
	{
		esp_564->dw0000 = eax_715;
		int32 eax_786 = esp_564->dw0000;
		do
		{
			esp_564->dw0000 = eax_786 + 0x01;
			esp_564->dw0000 = DPB(esp_564->dw0000, 0x00, 8);
			int32 eax_819 = esp_564->dw0000;
			byte cl_821 = esp_564->a0018[eax_819];
			esp_564->dw0000 = eax_819;
			int32 eax_827 = esp_564->dw0000;
			word32 ebx_836 = (word32) cl_821;
			esp_564->dw0000 = eax_827;
			esp_564->dw0000 = esp_564->dw0000;
			esp_564->dw0000 = esp_564->dw0000;
			word32 ebx_845 = DPB(ebx_836 + esi_687, 0x00, 8);
			byte dh_860 = (&esp_564->dw0000 + 0x01)[(ebx_845 + 0x14) / 0x0130];
			esp_564->dw0000 = esp_564->dw0000;
			int32 eax_865 = esp_564->dw0000;
			esp_564->a0018[eax_865] = dh_860;
			esp_564->dw0000 = eax_865;
			int32 eax_871 = esp_564->dw0000;
			esp_564->dw0000 = eax_871;
			*(esp_564 - 0x04) = eax_871;
			*(esp_564 - 0x04) = &esp_564->dw0000 + 0x01 + (ebx_845 + 0x14) / 0x0130;
			byte * eax_884 = *(esp_564 - 0x04);
			*eax_884 = cl_821;
			*(esp_564 - 0x04) = (byte **) eax_884;
			int32 eax_892 = esp_564->dw0000;
			word32 edx_897 = (word32) dh_860;
			byte dl_898 = (byte) edx_897;
			word32 edx_900 = DPB(edx_897, dl_898 + cl_821, 0);
			esp_564->dw0000 = eax_892;
			edx_720 = edx_900 + 0x14;
			int32 eax_909 = esp_564->dw0000;
			ui32 ecx_914 = (&esp_564->dw0000 + 0x01)[(edx_900 + 0x14) / 0x0130];
			word16 cx_918 = (word16) (ecx_914 << 0x08);
			esp_564->dw0000 = eax_909;
			int32 eax_925 = esp_564->dw0000;
			*(edi_711 - 0x01) = *(edi_711 - 0x01) ^ cx_918;
			esp_564->dw0000 = eax_925;
			esi_687 = ebx_845;
			eax_786 = esp_564->dw0000;
			edi_711 = edi_711 + 0x01;
			ebp_705 = ebp_705 - 0x01;
		} while (ebp_705 != 0x00);
	}
	struct Eq_1062 * esp_746 = esp_1219 - 0x0C;
	word32 edi_751;
	*ediOut = esp_746->dw0000;
	word32 ebp_755;
	*ebpOut = esp_746->dw0008;
	Eq_2 eax_759 = esp_746->t0118;
	esp_746->t0140 = eax_759;
	Eq_2 eax_769 = esp_746->t0140;
	esp_746->t0140 = eax_769;
	word32 ebx_776;
	*ebxOut = edx_720;
	return eax_769;
}

// 00401697: Register ptr32 fn00401697(Register word32 ebx, Stack word32 dwArg00, Stack ptr32 dwArg04, Register out ptr32 ecxOut, Register out ptr32 ebxOut)
ptr32 fn00401697(word32 ebx, word32 dwArg00, ptr32 dwArg04, ptr32 & ecxOut, ptr32 & ebxOut)
{
	word32 eax_24 = dwArg00;
	while (true)
	{
		word16 * eax_47 = DPB(eax_24, 0x00, 0);
		word16 ax_57 = *eax_47;
		word32 eax_60 = DPB(eax_24, ax_57 + 42421, 0);
		if (ax_57 == 42419)
			break;
		eax_24 = eax_60 - 0x00010000;
	}
	struct Eq_1278 * eax_93;
	__btc(eax_60, 0x01, out eax_93);
	int32 ecx_141 = eax_93[(&(eax_93 + eax_93->dw003C / 0x0040)->dw003C)[0x0011] / 0x0040];
	*ecxOut = ecx_141;
	ptr32 eax_147 = eax_93 + ecx_141 / 0x0040;
	word32 ebx_161;
	*ebxOut = eax_147 + 0x04;
	return eax_147 + 0x04;
}

