// subject.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

// 00401026: void fn00401026(Register Eq_2 eax, Register word32 ecx, Register cu8 dl, Register word32 ebx, Register (ptr32 Eq_6) ebp, Register (ptr32 byte) esi, Register Eq_8 edi)
void fn00401026(Eq_2 eax, word32 ecx, cu8 dl, word32 ebx, Eq_6 * ebp, byte * esi, Eq_8 edi)
{
	(union Eq_2 *) 494971428 = (union Eq_2 *) eax;
	word16 ax_40 = (word16) __indw(133);
	byte v5_9 = (byte *) 494971643 - 229 - C;
	(byte *) 494971643 = (byte *) v5_9;
	byte SCZO_11 = cond(v5_9);
	word32 * esp_1 = fp;
	Eq_30 C_12 = (bool) SCZO_11;
	byte CZ_14 = SCZO_11;
	do
	{
		esp_1 = esp_1 - 0x02;
		*esp_1 = (word32) cs;
		int32 eax_44 = (int32) ax_40 - 501320805 - C_12;
		esi = esi + 0x01;
		word16 ax_160 = (word16) (eax_44 & 621039422);
		byte al_161 = (byte) (eax_44 & 621039422);
		if (!DPB(CZ_14, false, 0))
		{
			*((word32) edi - 1800889568) = *((word32) edi - 1800889568) ^ esi;
			word32 ebx_125 = ebx - 0x01;
			do
			{
				up32 edi_135 = ebp->dw001C;
				P = (bool) *esp_1;
				esp_1 = esp_1 + 0x01;
				edi = (union Eq_8 *) 858037981;
			} while ((word32) edi - 1800889568);
			up32 eax_154 = edi_135 - 882428795 - (edi_135 < 0x809F2612);
			word32 eax_159 = eax_154 - 0x3C18C87B - (eax_154 < 0x809B260E);
			ebx = ebx_125 + 0x02;
			bh = SLICE(ebx_125 + 0x02, byte, 8);
			bl = (byte) (ebx_125 + 0x02);
			dl = 0x3D;
			ax_160 = (word16) eax_159;
			al_161 = (byte) eax_159;
		}
		ci8 al_70 = al_161 - ~0x0A - (dl < gs->*((word32) edi + 0x0132F01E));
		byte SCZO_73 = cond(al_70);
		ax_40 = DPB(ax_160, al_70, 0);
		C_12 = (bool) SCZO_73;
		CZ_14 = SCZO_73;
		dl = 0x99;
	} while (al_70 > 0x00);
	*edi = al_70 + 0x18;
	Eq_123 edi_86 = (word32) edi + 0x01;
	*edi_86 = (word32) *edi_86 + bh;
	struct Eq_16 * eax_89 = __indw(~0x34);
	word16 ax_96 = (word16) (ebp - 2919180669);
	if (P)
	{
		ci8 v32_116 = *(ebp - 2919180629) - bl;
		*(ebp - 2919180629) = v32_116;
		if (v32_116 <= 0x00)
			;
	}
	else
	{
		struct Eq_16 * eax_103 = __indw(0xB4);
		byte al_105 = *esi;
		eax_89->b24EDE9F5 = eax_89->b24EDE9F5 - 181;
		(word32 *) 3064341117 = (word32 *) DPB(eax_103, al_105, 0);
		__aad(DPB(ax_96, al_105, 0));
	}
}

// 00410473: Register Eq_2 Win32CrtStartup()
Eq_2 Win32CrtStartup()
{
	GetLastError();
	GetCommandLineA();
	GetModuleHandleA(&globals->t4357BF);
	CreateFileW(&globals->t43585B, 0x00, 0x00, null, 0x03, 0x0107, 0x00);
	CreateFileA(&globals->t4358B8, 0x00, 0x02, null, 0x03, 0x00, 0x00);
	word32 * esp_116 = fp + ~0x67;
	do
	{
		struct Eq_229 * esp_59 = esp_116 - 0x04;
		esp_59->t0000.u0 = 0x03;
		*(esp_59 - 0x04) = 0x00;
		*(esp_59 - 0x08) = 0x04;
		*(esp_59 - 0x0C) = 0x40000000;
		*(esp_59 - 0x10) = 4413406;
		CreateFileA(*(esp_59 - 0x10), *(esp_59 - 0x0C), *(esp_59 - 0x08), *(esp_59 - 0x04), esp_59->t0000, esp_59->t0004, esp_59->t0008);
		Eq_290 eax_72 = GetProcAddress(esp_59->t000C, esp_59->t0010);
		GetLastError();
		esp_59->t0010 = null;
		GetCommandLineA();
		esp_59->t000C = null;
		GetLastError();
		esp_59->t0008.u0 = 0x00;
		GetLastError();
		Eq_322 eax_88 = eax_72();
		GetLastError();
		esp_59->t0004.u0 = 0x00;
		esp_59->t0000.u0 = 0x0125;
		*(esp_59 - 0x04) = 0x03;
		*(esp_59 - 0x08) = 0x00;
		*(esp_59 - 0x0C) = 0x07;
		*(esp_59 - 0x10) = 0x60000000;
		*(esp_59 - 0x14) = 4413473;
		esp_116 = (word32 *) &esp_59->t0008;
	} while (CreateFileW(*(esp_59 - 0x14), *(esp_59 - 0x10), *(esp_59 - 0x0C), *(esp_59 - 0x08), *(esp_59 - 0x04), esp_59->t0000, esp_59->t0004) != ~0x00);
	esp_59->t0004.u0 = 0x00;
	esp_59->t0000.u0 = 0x0181;
	*(esp_59 - 0x04) = 0x03;
	*(esp_59 - 0x08) = 0x00;
	*(esp_59 - 0x0C) = 0x02;
	*(esp_59 - 0x10) = 0x20000000;
	*(esp_59 - 0x14) = 4413581;
	CreateFileW(*(esp_59 - 0x14), *(esp_59 - 0x10), *(esp_59 - 0x0C), *(esp_59 - 0x08), *(esp_59 - 0x04), esp_59->t0000, esp_59->t0004);
	esp_59->t0004.u0 = 0x00;
	esp_59->t0000.u0 = 0x05;
	*(esp_59 - 0x04) = 0x03;
	*(esp_59 - 0x08) = 0x00;
	*(esp_59 - 0x0C) = 0x01;
	*(esp_59 - 0x10) = 0x00;
	*(esp_59 - 0x14) = 4413556;
	CreateFileW(*(esp_59 - 0x14), *(esp_59 - 0x10), *(esp_59 - 0x0C), *(esp_59 - 0x08), *(esp_59 - 0x04), esp_59->t0000, esp_59->t0004);
	esp_59->t0004.u0 = 0x00;
	esp_59->t0000.u0 = 0xA4;
	*(esp_59 - 0x04) = 0x03;
	*(esp_59 - 0x08) = 0x00;
	*(esp_59 - 0x0C) = 0x07;
	*(esp_59 - 0x10) = 0x60000000;
	*(esp_59 - 0x14) = 4413604;
	CreateFileW(*(esp_59 - 0x14), *(esp_59 - 0x10), *(esp_59 - 0x0C), *(esp_59 - 0x08), *(esp_59 - 0x04), esp_59->t0000, esp_59->t0004);
	esp_59->t0004.u0 = 0x00;
	esp_59->t0000.u0 = 388;
	*(esp_59 - 0x04) = 0x03;
	*(esp_59 - 0x08) = 0x00;
	*(esp_59 - 0x0C) = 0x02;
	*(esp_59 - 0x10) = 0x80000000;
	*(esp_59 - 0x14) = 4413339;
	Eq_2 eax_191 = CreateFileA(*(esp_59 - 0x14), *(esp_59 - 0x10), *(esp_59 - 0x0C), *(esp_59 - 0x08), *(esp_59 - 0x04), esp_59->t0000, esp_59->t0004);
	ptr32 esp_194;
	word32 ebp_195;
	byte SCZO_196;
	word32 eax_197;
	bool Z_198;
	byte SZO_199;
	bool C_200;
	word32 ecx_201;
	byte dl_202;
	word32 ebx_203;
	word32 esi_204;
	word32 edi_205;
	(*((word32) (eax_88 ^ 0xC0000005) + 0x0041066D))();
	*(esp_194 - 0x04) = 0x00;
	*(esp_194 - 0x08) = 0x84;
	*(esp_194 - 0x0C) = 0x03;
	*(esp_194 - 0x10) = 0x00;
	*(esp_194 - 0x14) = 0x01;
	*(esp_194 - 0x18) = 0x60000000;
	*(esp_194 - 0x1C) = 4413517;
	CreateFileW(*(esp_194 - 0x1C), *(esp_194 - 0x18), *(esp_194 - 0x14), *(esp_194 - 0x10), *(esp_194 - 0x0C), *(esp_194 - 0x08), *(esp_194 - 0x04));
	do
	{
		GetLastError();
		*(esp_194 - 0x04) = 0x00;
		*(esp_194 - 0x08) = 0x01A7;
		*(esp_194 - 0x0C) = 0x03;
		*(esp_194 - 0x10) = 0x00;
		*(esp_194 - 0x14) = 0x00;
		*(esp_194 - 0x18) = 0x60000000;
		*(esp_194 - 0x1C) = 4413536;
	} while (CreateFileW(*(esp_194 - 0x1C), *(esp_194 - 0x18), *(esp_194 - 0x14), *(esp_194 - 0x10), *(esp_194 - 0x0C), *(esp_194 - 0x08), *(esp_194 - 0x04)) != ~0x00);
	*(esp_194 - 0x04) = fp - 0x4C;
	GetLastError();
	*(esp_194 - 0x08) = 0x00;
	*(esp_194 - 0x0C) = 0x27;
	*(esp_194 - 0x10) = 0x03;
	*(esp_194 - 0x14) = 0x00;
	*(esp_194 - 0x18) = 0x05;
	*(esp_194 - 0x1C) = 0xA0000000;
	*(esp_194 - 0x20) = 4413636;
	CreateFileA(*(esp_194 - 0x20), *(esp_194 - 0x1C), *(esp_194 - 0x18), *(esp_194 - 0x14), *(esp_194 - 0x10), *(esp_194 - 0x0C), *(esp_194 - 0x08));
	*(esp_194 - 0x08) = 0x40;
	GetLastError();
	*(esp_194 - 0x0C) = 61806;
	*(esp_194 - 0x10) = 0x00401000;
	VirtualProtect(*(esp_194 - 0x10), *(esp_194 - 0x0C), *(esp_194 - 0x08), *(esp_194 - 0x04));
	*(esp_194 - 0x04) = 0x00;
	*(esp_194 - 0x08) = 0x0127;
	*(esp_194 - 0x0C) = 0x03;
	*(esp_194 - 0x10) = 0x00;
	*(esp_194 - 0x14) = 0x03;
	*(esp_194 - 0x18) = 0x20000000;
	*(esp_194 - 0x1C) = 4413385;
	CreateFileA(*(esp_194 - 0x1C), *(esp_194 - 0x18), *(esp_194 - 0x14), *(esp_194 - 0x10), *(esp_194 - 0x0C), *(esp_194 - 0x08), *(esp_194 - 0x04));
	GetLastError();
	*(esp_194 - 0x04) = (union Eq_322 *) eax_88;
	GetCommandLineA();
	*(esp_194 - 0x08) = 61806;
	GetLastError();
	GetCommandLineA();
	*(esp_194 - 0x0C) = 0x00401000;
	*(esp_194 - 0x10) = 0x00;
	*(esp_194 - 0x14) = 0x01A7;
	*(esp_194 - 0x18) = 0x03;
	*(esp_194 - 0x1C) = 0x00;
	*(esp_194 - 0x20) = 0x03;
	*(esp_194 - 0x24) = 0xA0000000;
	*(esp_194 - 0x28) = 4413497;
	CreateFileA(*(esp_194 - 0x28), *(esp_194 - 0x24), *(esp_194 - 0x20), *(esp_194 - 0x1C), *(esp_194 - 0x18), *(esp_194 - 0x14), *(esp_194 - 0x10));
	*(esp_194 - 0x10) = 0x00;
	*(esp_194 - 0x14) = 422;
	*(esp_194 - 0x18) = 0x03;
	*(esp_194 - 0x1C) = 0x00;
	*(esp_194 - 0x20) = 0x01;
	*(esp_194 - 0x24) = 0xA0000000;
	*(esp_194 - 0x28) = 0x00435881;
	CreateFileA(*(esp_194 - 0x28), *(esp_194 - 0x24), *(esp_194 - 0x20), *(esp_194 - 0x1C), *(esp_194 - 0x18), *(esp_194 - 0x14), *(esp_194 - 0x10));
	GetLastError();
	*(esp_194 - 0x10) = 0x00;
	*(esp_194 - 0x14) = 0x0107;
	*(esp_194 - 0x18) = 0x03;
	*(esp_194 - 0x1C) = 0x00;
	*(esp_194 - 0x20) = 0x05;
	*(esp_194 - 0x24) = 0x20000000;
	*(esp_194 - 0x28) = 4413358;
	Eq_2 eax_355 = CreateFileW(*(esp_194 - 0x28), *(esp_194 - 0x24), *(esp_194 - 0x20), *(esp_194 - 0x1C), *(esp_194 - 0x18), *(esp_194 - 0x14), *(esp_194 - 0x10));
	ptr32 esp_361;
	struct Eq_6 * ebp_362;
	byte SCZO_363;
	word32 eax_364;
	bool Z_365;
	byte SZO_366;
	bool C_367;
	word32 ecx_368;
	cu8 dl_369;
	word32 ebx_370;
	byte * esi_371;
	Eq_8 edi_372;
	(eax_88 - ~0x4041042F)();
	GetCommandLineA();
	*(esp_361 - 0x04) = 0x00;
	*(esp_361 - 0x08) = 0x0187;
	*(esp_361 - 0x0C) = 0x03;
	*(esp_361 - 0x10) = 0x00;
	*(esp_361 - 0x14) = 0x00;
	*(esp_361 - 0x18) = 0x80000000;
	*(esp_361 - 0x1C) = 4413449;
	Eq_2 eax_388 = CreateFileA(*(esp_361 - 0x1C), *(esp_361 - 0x18), *(esp_361 - 0x14), *(esp_361 - 0x10), *(esp_361 - 0x0C), *(esp_361 - 0x08), *(esp_361 - 0x04));
	fn00401026(eax_388, ecx_368, dl_369, ebx_370, ebp_362, esi_371, edi_372);
	return eax_388;
}

