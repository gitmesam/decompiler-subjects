// subject.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

// 0055A4D0: Register DWORD Win32CrtStartup()
DWORD Win32CrtStartup()
{
	word32 edi_3 = 0x0055B200;
	do
	{
		word32 eax_23 = GetTapePosition(0x00, 0x00, fp - 0x04, fp - 0x04, fp - 0x04);
		Mem32[edi_3 + 0x00:word32] = Mem0[edi_3 + 0x00:word32] + (eax_23 + ~0x40DC2006);
		Mem34[edi_3 + 0x00:word32] = __ror(Mem32[edi_3 + 0x00:word32], 0x10);
		word32 edi_35 = edi_3 + 0x12;
		word32 edx_11 = fp - 0x04;
		byte dl_12 = (byte) (fp - 0x04);
		word32 ecx_25 = 0x00;
		word32 esp_27 = fp;
		word32 eax_28 = eax_23 + ~0x40DC2006;
		byte al_29 = (byte) (eax_23 + ~0x40DC2006);
		edi_3 = edi_35 - 0x0E;
	} while (edi_35 <= 0x0055B68A);
	fn0055B200();
	Mem42[734884612:byte] = __ror(Mem34[734884612:byte], 0x00);
	do
	{
		dl_12 = dl_12 & al_29;
		esp_27 = esp_27 - 0x04;
		Mem56[esp_27 + 0x00:word32] = 2253164159;
		edx_11 = DPB(edx_11, dl_12, 0);
		if (dl_12 <= 0x00)
		{
			Mem62[esp_27 + 0x00:word16] = cs;
			word32 esp_67;
			word32 esi_68;
			word32 edi_69;
			byte SCZO_70;
			word32 ebx_71;
			word32 edx_72;
			word32 eax_73;
			word32 ecx_74;
			bool C_75;
			byte SZO_76;
			byte cl_77;
			byte dl_78;
			byte al_79;
			selector ds_80;
			selector cs_81;
			word32 ebp_82;
			fnA5005CF3();
		}
		eax_28 = eax_28 ^ ~0x12B449C9;
		al_29 = (byte) eax_28;
		ecx_25 = ecx_25 - 0x01;
	} while (ecx_25 != 0x00);
	word32 v20_92 = Mem56[ebp + 1623176633:byte];
	Mem93[ebp + 1623176633:byte] = (byte) (ecx_25 + 0x01);
	Mem98[esp_27 - 0x02 + 0x00:word16] = ds;
	word32 v22_99 = Mem98[eax_28 - 0x27 + 0x00:word32];
	Mem100[eax_28 - 0x27 + 0x00:word32] = esp_27 - 0x02;
	Mem105[v22_99 - 0x04 + 0x00:word32] = eax_28;
	Mem107[v22_99 - 0x08 + 0x00:word32] = DPB(ecx_25 + 0x01, v20_92, 0);
	Mem109[v22_99 - 0x0C + 0x00:word32] = edx_11;
	Mem111[v22_99 - 0x10 + 0x00:word32] = 5617276;
	Mem113[v22_99 - 0x14 + 0x00:word32] = v22_99;
	Mem115[v22_99 - 0x18 + 0x00:word32] = ebp;
	Mem117[v22_99 - 0x1C + 0x00:word32] = 0x0055B200;
	Mem119[v22_99 - 0x20 + 0x00:word32] = edi_35 - 0x0E;
	Mem121[v22_99 - 0x22 + 0x00:word16] = cs;
	Mem123[v22_99 - 0x24 + 0x00:word16] = ds;
	return eax_28;
}

// 0055B1C4: void fn0055B1C4(Register word32 eax, Register word32 ecx, Register word32 edx, Register byte bl, Register byte bh, Register word32 ebp, Register word32 esi, Register word32 edi)
void fn0055B1C4(word32 eax, word32 ecx, word32 edx, byte bl, byte bh, word32 ebp, word32 esi, word32 edi)
{
	if (P)
		fn0055B1F5(eax, ecx, edx, bl, bh, ebp, esi, edi);
	else
		fn0055B1CF(ecx, edx, bl, bh, ebp, esi, edi);
}

// 0055B1CF: void fn0055B1CF(Register word32 ecx, Register word32 edx, Register byte bl, Register byte bh, Register word32 ebp, Register word32 esi, Register word32 edi)
void fn0055B1CF(word32 ecx, word32 edx, byte bl, byte bh, word32 ebp, word32 esi, word32 edi)
{
	byte al_7 = Mem0[esi + 0x00:byte];
	__outw(dx, DPB(ax, al_7, 0));
	word32 edi_16 = edi - edx[edi * 0x02];
	word32 edi_18 = edi_16 - edx[edi_16 * 0x02];
	word32 edi_20 = edi_18 - edx[edi_18 * 0x02];
	word32 edi_22 = edi_20 - edx[edi_20 * 0x02];
	word32 eax_11 = DPB(eax, al_7, 0);
	word32 edi_26 = edi_22 - edx[edi_22 * 0x02];
	fn0055B1F5(eax_11 - 3199365356, ecx, edx, bl, bh, ebp, esi + 0x01, edi_26);
}

// 0055B1F5: void fn0055B1F5(Register word32 eax, Register word32 ecx, Register word32 edx, Register byte bl, Register byte bh, Register word32 ebp, Register word32 esi, Register word32 edi)
void fn0055B1F5(word32 eax, word32 ecx, word32 edx, byte bl, byte bh, word32 ebp, word32 esi, word32 edi)
{
}

// 0055B200: void fn0055B200()
void fn0055B200()
{
fn0055B200_entry:
	esp = fp
	v3 = fp
	esp = fp - 0x04
	dwLoc04 = fp
	branch Test(UGT,CZ) l0055B234
l0055B200:
l0055B212_thunk_fn0055B1C4:
	fn0055B1C4(eax, ecx, edx, bl, bh, ebp, esi, edi)
	return
l0055B212_thunk_fn0055B214:
	eax = fn0055B214(ax, ecx, edx, bl, bh, ebp, esi, edi, rArg0, rArg1, out ebx, out esi, out edi, out rArg0)
	ax = (word16) eax (alias)
	return
fn0055B200_exit:
}

// 0055B202: Register word32 fn0055B202(Register word32 eax, Register word32 ecx, Register word32 edx, Register byte bl, Register byte bh, Register word32 ebp, Register word32 esi, Register word32 edi, FpuStack real64 rArg0, Register out ptr32 ebxOut, Register out ptr32 esiOut, Register out ptr32 ediOut, FpuStack out ptr32 rArg0Out)
word32 fn0055B202(word32 eax, word32 ecx, word32 edx, byte bl, byte bh, word32 ebp, word32 esi, word32 edi, real64 rArg0, ptr32 & ebxOut, ptr32 & esiOut, ptr32 & ediOut, ptr32 & rArg0Out)
{
}

// 0055B208: Register word32 fn0055B208(Register word32 eax, Register word32 ecx, Register word32 edx, Register byte bl, Register byte bh, Register word32 ebp, Register word32 esi, Register word32 edi, FpuStack real64 rArg0, FpuStack real64 rArg1, Register out ptr32 ebxOut, Register out ptr32 esiOut, Register out ptr32 ediOut, FpuStack out ptr32 rArg0Out)
word32 fn0055B208(word32 eax, word32 ecx, word32 edx, byte bl, byte bh, word32 ebp, word32 esi, word32 edi, real64 rArg0, real64 rArg1, ptr32 & ebxOut, ptr32 & esiOut, ptr32 & ediOut, ptr32 & rArg0Out)
{
fn0055B208_entry:
	esp = fp
	v3 = Mem0[eax + 0x00:byte]
	Mem0[eax + 0x00:byte] = ah
	ah = v3
	eax = DPB(eax, ah, 8) (alias)
	ax = DPB(ax, ah, 8) (alias)
	rArg0 = Mem0[eax + 0x00:real64] - rArg0
	v7 = fp
	esp = fp - 0x04
	dwLoc04 = fp
	SZO = cond(eax & 1612333276)
	S = (bool) SZO (alias)
	C = false
	branch Test(NS,S) l0055B212_thunk_fn0055B1C4
l0055B208:
l0055B208:
	v18 = esp
	esp = esp - 0x04
	Mem0[esp + 0x00:word32] = v18
	SZO = cond(eax & 1612333276)
	S = (bool) SZO (alias)
	C = false
	branch Test(NS,S) l0055B212_thunk_fn0055B1C4
l0055B212_thunk_fn0055B1C4:
	fn0055B1C4(eax, ecx, edx, bl, bh, ebp, esi, edi)
	return eax
l0055B212_thunk_fn0055B214:
	eax = fn0055B214(ax, ecx, edx, bl, bh, ebp, esi, edi, rArg0, rArg1, out ebx, out esi, out edi, out rArg0)
	ah = SLICE(eax, byte, 8) (alias)
	ax = (word16) eax (alias)
	return eax
fn0055B208_exit:
	use ebx (=> ebxOut)
	use esi (=> esiOut)
	use edi (=> ediOut)
}

// 0055B214: Register word32 fn0055B214(Register word16 ax, Register word32 ecx, Register word32 edx, Register byte bl, Register byte bh, Register word32 ebp, Register word32 esi, Register word32 edi, FpuStack real64 rArg0, FpuStack real64 rArg1, Register out ptr32 ebxOut, Register out ptr32 esiOut, Register out ptr32 ediOut, FpuStack out ptr32 rArg0Out)
word32 fn0055B214(word16 ax, word32 ecx, word32 edx, byte bl, byte bh, word32 ebp, word32 esi, word32 edi, real64 rArg0, real64 rArg1, ptr32 & ebxOut, ptr32 & esiOut, ptr32 & ediOut, ptr32 & rArg0Out)
{
	*esiOut = esi;
	*ediOut = edi;
	*ebxOut = ebx;
	word32 v9_9 = Mem0[ecx + 0x601C80F5:word32] + ebp;
	Mem10[ecx + 0x601C80F5:word32] = v9_9;
	if (v9_9 >= 0x00)
	{
		word32 ebx_45;
		word32 esi_46;
		word32 edi_47;
		return fn0055B271(al, ah, bl, bh, esi, edi, out ebx_45, out esi_46, out edi_47);
	}
	else if (v9_9 != 0x00 && ecx != 0x01)
	{
		fn0055B1CF(ecx - 0x01, edx, bl, bh, ebp, esi, edi);
		return eax;
	}
	else
		__hlt();
}

// 0055B26F: Register word32 fn0055B26F(Register word32 eax, Register byte bl, Register byte bh, Register word32 esi, Register word32 edi, Register out ptr32 ebxOut, Register out ptr32 esiOut, Register out ptr32 ediOut)
word32 fn0055B26F(word32 eax, byte bl, byte bh, word32 esi, word32 edi, ptr32 & ebxOut, ptr32 & esiOut, ptr32 & ediOut)
{
	byte al_4 = (byte) (eax + 0x01);
	byte ah_5 = SLICE(eax + 0x01, byte, 8);
	byte bh_8 = bh ^ bl;
	word32 ebx_15;
	word32 esi_16;
	word32 edi_17;
	return fn0055B272(al_4, ah_5, bl, bh_8, esi, edi, out ebx_15, out esi_16, out edi_17);
}

// 0055B271: Register word32 fn0055B271(Register byte al, Register byte ah, Register byte bl, Register byte bh, Register word32 esi, Register word32 edi, Register out ptr32 ebxOut, Register out ptr32 esiOut, Register out ptr32 ediOut)
word32 fn0055B271(byte al, byte ah, byte bl, byte bh, word32 esi, word32 edi, ptr32 & ebxOut, ptr32 & esiOut, ptr32 & ediOut)
{
	ptr32 fp;
	byte al;
	byte ah;
	byte bl;
	byte bh;
	word32 esi;
	word32 edi;
	ptr32 ebxOut;
	ptr32 esiOut;
	ptr32 ediOut;
	esp_1 = fp;
	__sti();
	eax_11 = fn0055B272(al, ah, bl, bh, esi, edi, out ebx_8, out esi_9, out edi_10);
	al_12 = (byte) eax_11;
	ah_13 = SLICE(eax_11, byte, 8);
	return eax_11;
}

// 0055B272: Register word32 fn0055B272(Register byte al, Register byte ah, Register byte bl, Register byte bh, Register word32 esi, Register word32 edi, Register out ptr32 ebxOut, Register out ptr32 esiOut, Register out ptr32 ediOut)
word32 fn0055B272(byte al, byte ah, byte bl, byte bh, word32 esi, word32 edi, ptr32 & ebxOut, ptr32 & esiOut, ptr32 & ediOut)
{
}

