// subject.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

// 080484A0: void _init()
void _init()
{
	__do_global_ctors_aux();
}

// 080484B8: void strcpy()
void strcpy()
{
}

// 080484C8: void printf()
void printf()
{
}

// 080484D8: void perror()
void perror()
{
}

// 080484E8: void _xstat()
void _xstat()
{
}

// 080484F8: void __libc_init()
void __libc_init()
{
}

// 08048508: void strcat()
void strcat()
{
}

// 08048518: void fread()
void fread()
{
}

// 08048528: void fopen()
void fopen()
{
}

// 08048538: void fclose()
void fclose()
{
}

// 08048548: void sprintf()
void sprintf()
{
}

// 08048558: void atexit()
void atexit()
{
}

// 08048568: void exit()
void exit()
{
}

// 08048578: void __setfpucw()
void __setfpucw()
{
}

// 08048588: void strlen()
void strlen()
{
}

// 080485A0: void _start(Stack int32 dwArg00)
void _start(int32 dwArg00)
{
	__align(fp + 0x04);
	__syscall(0x80);
	globals->ptr80499E8 = fp + 0x04 + dwArg00 * 0x04 + 0x04;
	word32 esp_34;
	word32 ecx_35;
	word32 ebx_36;
	word32 eax_37;
	word32 edx_38;
	byte SCZO_39;
	word32 ebp_40;
	byte SZO_41;
	bool C_42;
	__setfpucw();
	word32 esp_45;
	word32 ecx_46;
	word32 ebx_47;
	word32 eax_48;
	word32 edx_49;
	byte SCZO_50;
	word32 ebp_51;
	byte SZO_52;
	bool C_53;
	__libc_init();
	atexit(&globals->t80489C0);
	_init();
	exit(main(dwArg00, fp + 0x04));
}

// 08048620: void __do_global_dtors_aux()
void __do_global_dtors_aux()
{
	word32 * ebx_24 = globals->a80499F8;
	if (globals->a80499F8 != 0x00)
	{
		do
		{
			<anonymous> * eax_25 = *ebx_24;
			word32 esp_26;
			word32 ebp_27;
			struct Eq_78 * ebx_28;
			byte SCZO_29;
			bool Z_30;
			word32 esi_31;
			word32 eax_32;
			eax_25();
			ebx_24 = (word32 *) &ebx_28->dw0004;
		} while (ebx_28->dw0004 != 0x00);
	}
}

// 08048650: void fini_dummy()
void fini_dummy()
{
}

// 08048660: void dumpline(Stack Eq_89 dwArg04, Stack up32 dwArg08, Stack Eq_91 dwArg0C)
void dumpline(Eq_89 dwArg04, up32 dwArg08, Eq_91 dwArg0C)
{
	sprintf(fp - 0x54, "%08lX:", tLoc70);
	size_t dwLoc58_172 = 0x00;
	while (0x10 > dwLoc58_172)
	{
		sprintf(fp - 0x54 + dwLoc58_172 * 0x03 + 0x09, " %02lX", tLoc70);
		dwLoc58_172 = (Eq_105) ((word32) dwLoc58_172 + 0x01);
	}
	while (true)
	{
		dwLoc58_172 = (Eq_105) ((word32) dwLoc58_172 + 0x01);
		if (dwLoc58_172 > 0x0F)
			break;
		strcat(fp - 0x54, "   ");
	}
	Eq_91 eax_51 = strlen(fp - 0x54);
	strcpy(fp - 0x54 + eax_51, 0x080489DA);
	Eq_105 dwLoc58_110;
	for (dwLoc58_110 = 0x00; 0x10 > dwLoc58_110; ++dwLoc58_110)
	{
		byte cl_122;
		word32 eax_113 = eax_51 + dwLoc58_110;
		if (Mem0[dwArg04 + dwLoc58_110:byte] >u 0x1F && Mem0[dwArg04 + dwLoc58_110:byte] <=u 0x7E)
			cl_122 = Mem0[dwArg04 + dwLoc58_110:byte];
		else
			cl_122 = 0x2E;
		Mem126[eax_113 + (fp - 0x54):byte] = cl_122;
	}
	for (; dwLoc58_110 <= 0x0F; ++dwLoc58_110)
		Mem108[eax_51 + dwLoc58_110 + (fp - 0x54):byte] = 0x20;
	strcpy(fp - 0x54 + eax_51 + dwLoc58_110, 134515166);
	printf("%s\n", fp - 0x54);
}

// 080487F0: Register word32 hexdump(Stack (ptr32 char) dwArg04)
word32 hexdump(char * dwArg04)
{
	word32 eax_33;
	stat(dwArg04, fp - 0x5C);
	if (dwArg04 == null)
	{
		perror(dwArg04);
		eax_33 = 0x01;
	}
	else
	{
		FILE * eax_55 = fopen(dwArg04, "rb");
		if (eax_55 == null)
		{
			perror(dwArg04);
			eax_33 = 0x01;
		}
		else
		{
			up32 dwLoc18_122 = 0x00;
			while (dwLoc48 > dwLoc18_122)
			{
				Eq_91 eax_105 = fread(fp - 0x14, 0x01, 0x10, eax_55);
				if (eax_105 == 0x00)
					break;
				dumpline(fp - 0x14, dwLoc18_122, eax_105);
				dwLoc18_122 = (word32) eax_105 + dwLoc18_122;
			}
			fclose(eax_55);
			eax_33 = 0x00;
		}
	}
	return eax_33;
}

// 080488E0: Register word32 main(Stack int32 dwArg04, Stack (arr (ptr32 char)) dwArg08)
word32 main(int32 dwArg04, char * dwArg08[])
{
	word32 dwLoc0C_14 = 0x00;
	int32 dwLoc08_15;
	for (dwLoc08_15 = 0x01; dwArg04 > dwLoc08_15; ++dwLoc08_15)
		dwLoc0C_14 += hexdump(dwArg08[dwLoc08_15]);
	return dwLoc0C_14;
}

// 08048950: void stat(Stack (ptr32 char) dwArg04, Stack ptr32 dwArg08)
void stat(char * dwArg04, ptr32 dwArg08)
{
	word32 esp_22;
	word32 ebp_23;
	word32 esi_24;
	word32 ebx_25;
	byte SCZO_26;
	word32 edx_27;
	word32 eax_28;
	_xstat();
}

// 08048980: void __do_global_ctors_aux()
void __do_global_ctors_aux()
{
	word32 * ebx_24 = &globals->dw80499EC;
	if (globals->dw80499EC != ~0x00)
	{
		do
		{
			<anonymous> * eax_25 = *ebx_24;
			word32 esp_26;
			word32 ebp_27;
			struct Eq_292 * ebx_28;
			byte SCZO_29;
			bool Z_30;
			word32 esi_31;
			word32 eax_32;
			eax_25();
			ebx_24 = (word32 *) &ebx_28->dwFFFFFFFC;
		} while (ebx_28->dwFFFFFFFC != ~0x00);
	}
}

// 080489B0: void init_dummy()
void init_dummy()
{
}

// 080489C0: void _fini()
void _fini()
{
	__do_global_dtors_aux();
}

