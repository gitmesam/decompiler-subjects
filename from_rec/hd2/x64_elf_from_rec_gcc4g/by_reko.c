// subject_fini.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject_fini.h"

// 0000000000400B68: void _fini()
void _fini()
{
	__do_global_dtors_aux();
}

// subject_init.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject_init.h"

// 00000000004005D8: void _init()
// Called from:
//      __libc_csu_init
void _init()
{
	call_gmon_start();
	frame_dummy();
	__do_global_ctors_aux();
}

// subject_text.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject_text.h"

// 00000000004006B0: void _start(Register (ptr64 Eq_11) rdx, Stack Eq_12 qwArg00)
void _start(void (* rdx)(), Eq_12 qwArg00)
{
	__align((char *) fp + 8);
	__libc_start_main(&g_t400A34, qwArg00, (char *) fp + 8, &g_t400A90, &g_t400A80, rdx, fp);
	__hlt();
}

// 00000000004006DC: void call_gmon_start()
// Called from:
//      _init
void call_gmon_start()
{
	if (__gmon_start__ != 0x00)
		__gmon_start__();
}

// 0000000000400700: void __do_global_dtors_aux()
// Called from:
//      _fini
void __do_global_dtors_aux()
{
	if (g_b600F00 == 0x00)
	{
		uint64 rax_15 = g_qw600F08;
		while (rax_15 < 0x00)
		{
			uint64 rax_22 = rax_15 + 0x01;
			g_qw600F08 = rax_22;
			(*((char *) g_a600CC0 + rax_22 * 0x08))();
			rax_15 = g_qw600F08;
		}
		g_b600F00 = 0x01;
	}
}

// 0000000000400770: void frame_dummy()
// Called from:
//      _init
void frame_dummy()
{
	if (g_qw600CD0 == 0x00 || 0x00 == 0x00)
		return;
	word64 rax_23;
	null();
}

// 0000000000400794: void dumpline(Register int32 edx, Register ptr64 rdi)
// Called from:
//      hexdump
void dumpline(int32 edx, ptr64 rdi)
{
	sprintf(fp - 0x78, "%08lX:", 0x00);
	int32 dwLoc8C_191 = edx;
	if (edx > 0x10)
		dwLoc8C_191 = 0x10;
	int32 dwLoc20_193 = 0x00;
	while ((word32) (uint64) dwLoc20_193 < dwLoc8C_191)
	{
		word32 edx_45 = (word32) (uint64) dwLoc20_193;
		sprintf(fp - 0x78 + ((int64) ((word32) ((uint64) ((word32) ((uint64) ((word32) ((uint64) edx_45) * 0x02)) + edx_45))) + 0x09), " %02lX", 0x00);
		++dwLoc20_193;
	}
	while (true)
	{
		++dwLoc20_193;
		if ((int8) (dwLoc20_193 <= 0x0F) == 0x00)
			break;
		strcat(fp - 0x78, "   ");
	}
	Eq_136 eax_82 = strlen(fp - 0x78);
	memcpy(fp - 0x78 + (int64) ((word32) ((uint64) eax_82)), &g_v400B8E, 0x04);
	Eq_157 dwLoc20_202 = 0x00;
	while ((word32) (uint64) dwLoc20_202 < dwLoc8C_191)
	{
		Eq_162 al_136;
		word32 edx_133 = (word32) (uint64) ((word64) dwLoc20_202 + ((word64) eax_82 + 3));
		if ((byte) (uint64) (word32) ((int64) (word32) (uint64) dwLoc20_202 + rdi) > 0x1F && (byte) ((uint64) ((word32) ((int64) ((word32) ((uint64) dwLoc20_202)) + rdi))) <= 0x7E)
			al_136 = (byte) (uint64) (word32) ((int64) (word32) (uint64) dwLoc20_202 + rdi);
		else
			al_136 = (Eq_162) 0x2E;
		(&(&(&(&(&(&(&(&(&(&(&(&(&(&(&(&(&(&(&(fp - 0x78)[(int64) edx_133].a0000)[0].a0000)[0].a0000)[0].a0000)[0].a0000)[0].a0000)[0].a0000)[0].a0000)[0].a0000)[0].a0000)[0].a0000)[0].a0000)[0].a0000)[0].a0000)[0].a0000)[0].a0000)[0].a0000)[0].a0000)[0].a0000)[0] = al_136;
		dwLoc20_202 = (word64) dwLoc20_202 + 1;
	}
	while (dwLoc20_202 <= 0x0F)
	{
		(&(&(&(&(&(&(&(&(&(&(&(&(&(&(&(&(&(&(&(fp - 0x78)[(int64) ((word64) dwLoc20_202 + ((word64) eax_82 + 3))].a0000)[0].a0000)[0].a0000)[0].a0000)[0].a0000)[0].a0000)[0].a0000)[0].a0000)[0].a0000)[0].a0000)[0].a0000)[0].a0000)[0].a0000)[0].a0000)[0].a0000)[0].a0000)[0].a0000)[0].a0000)[0].a0000)[0] = (Eq_207) 0x20;
		dwLoc20_202 = (word64) dwLoc20_202 + 1;
	}
	memcpy((word64) (fp - (char *) 0x78) + ((word64) dwLoc20_202 + ((word64) eax_82 + 3)), &g_v400B92, 0x02);
	puts(fp - (char *) 0x78);
}

// 0000000000400942: Register word32 hexdump(Register (ptr64 char) rdi)
// Called from:
//      main
word32 hexdump(char * rdi)
{
	uint64 rax_110;
	if (stat(fp - 200, rdi) != 0x00)
	{
		perror(rdi);
		rax_110 = 0x01;
	}
	else
	{
		FILE * rax_27 = fopen(rdi, "rb");
		if (rax_27 == null)
		{
			perror(rdi);
			rax_110 = 0x01;
		}
		else
		{
			up64 qwLoc20_88;
			for (qwLoc20_88 = 0x00; qwLoc98 > qwLoc20_88; qwLoc20_88 += (int64) (word32) (uint64) eax_43)
			{
				Eq_136 eax_43 = fread(fp - 0x38, 0x01, 0x10, rax_27);
				if (eax_43 == 0x00)
					break;
				dumpline((word32) (uint64) eax_43, fp - 0x38);
			}
			fclose(rax_27);
			rax_110 = 0x00;
		}
	}
	return (word32) rax_110;
}

// 0000000000400A34: void main(Register (arr (ptr64 char)) rsi, Register int32 edi)
void main(char * rsi[], int32 edi)
{
	int32 edi = (word32) rdi;
	word32 dwLoc10_53 = 0x01;
	while ((word32) (uint64) dwLoc10_53 < edi)
	{
		hexdump(rsi[(int64) (word32) (uint64) dwLoc10_53]);
		++dwLoc10_53;
	}
}

// 0000000000400A80: void __libc_csu_fini()
void __libc_csu_fini()
{
}

// 0000000000400A90: void __libc_csu_init(Register word64 rdx, Register word64 rsi, Register word32 edi)
void __libc_csu_init(word64 rdx, word64 rsi, word32 edi)
{
	_init();
	int64 rbp_19 = 0x00600CAC - 0x00600CAC;
	word32 r13d_73 = (word32) (uint64) edi;
	if (rbp_19 >> 0x03 != 0x00)
	{
		Eq_334 rbx_37 = 0x00;
		do
		{
			((<anonymous> *[]) 0x00600CAC)[rbx_37]();
			rbx_37 = (word64) rbx_37.u1 + 1;
		} while (rbx_37 < rbp_19 >> 0x03);
	}
}

// 0000000000400B20: Register int32 stat(Register (ptr64 Eq_237) rsi, Register (ptr64 char) rdi)
// Called from:
//      hexdump
int32 stat(struct stat * rsi, char * rdi)
{
	return __xstat(0x01, rdi, rsi);
}

// 0000000000400B30: void __do_global_ctors_aux()
// Called from:
//      _init
void __do_global_ctors_aux()
{
	<anonymous> * rax_12 = g_ptr600CB0;
	if (rax_12 != (<anonymous> *) ~0x00)
	{
		word64 * rbx_15 = &g_ptr600CB0;
		do
		{
			rax_12();
			rbx_15 -= 0x08;
			rax_12 = *rbx_15;
		} while (rax_12 != (<anonymous> *) ~0x00);
	}
}

