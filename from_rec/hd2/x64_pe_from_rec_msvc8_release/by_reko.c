// subject.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

// 0000000140001000: Register word32 fn0000000140001000(Register ptr64 rcx, Register word32 edx, Register word32 r8d, Stack word64 qwArg18, Stack word64 qwArg20, Register out Eq_8 ebxOut, Register out ptr64 rbpOut, Register out Eq_10 ediOut)
word32 fn0000000140001000(ptr64 rcx, word32 edx, word32 r8d, word64 qwArg18, word64 qwArg20, Eq_8 & ebxOut, ptr64 & rbpOut, Eq_10 & ediOut)
{
}

// 0000000140001190: Register word32 fn0000000140001190(Register uint64 rbx, Register word32 r10d, Stack word64 qwArg10, Register out Eq_289 ebxOut, Register out ptr64 rbpOut, Register out ptr64 rsiOut, Register out ptr64 rdiOut)
word32 fn0000000140001190(uint64 rbx, word32 r10d, word64 qwArg10, Eq_289 & ebxOut, ptr64 & rbpOut, ptr64 & rsiOut, ptr64 & rdiOut)
{
	ui64 rax_8 = globals->qw40003000 ^ fp - 0x78;
	word64 rsp_16;
	word64 rbx_17;
	byte SCZO_18;
	word64 rax_19;
	byte SZO_20;
	byte C_21;
	word64 rdx_22;
	word64 rcx_23;
	word32 eax_24;
	byte Z_25;
	word64 rsi_26;
	word32 ebx_27;
	byte CZ_28;
	word64 rdi_29;
	word32 edx_30;
	word64 r9_31;
	word64 r10_32;
	word32 r8d_33;
	word64 r8_34;
	word32 edi_35;
	word32 r10d_36;
	word64 rbp_37;
	stat64i32();
	if (eax_24 == 0x00)
	{
		word64 rsp_85;
		word64 rbx_86;
		byte SCZO_87;
		word64 rax_88;
		byte SZO_89;
		byte C_90;
		word64 rdx_91;
		word64 rcx_92;
		word32 eax_93;
		byte Z_94;
		word64 rsi_95;
		word32 ebx_96;
		byte CZ_97;
		word64 rdi_98;
		word32 edx_99;
		word64 r9_100;
		word64 r10_101;
		word32 r8d_102;
		word64 r8_103;
		word32 edi_104;
		word32 r10d_105;
		word64 rbp_106;
		MSVCR90.dll!fopen();
		if (rax_88 != 0x00)
		{
			if (dwLoc44 <= 0x00)
			{
				word32 ebx_128;
				word64 rsi_129;
				return fn000000014000125D(rax_8, rbx, rsi_26, out ebx_128, out rsi_129);
			}
			else
			{
				word32 ebx_123;
				word64 rbp_124;
				word64 rsi_125;
				return fn000000014000120E(eax_93, 0x00, r10d_105, dwLoc44, qwArg18, out ebx_123, out rbp_124, out rsi_125);
			}
		}
		else
		{
			perror(ptrLoc78);
			word32 ebx_113;
			word64 rsi_114;
			return fn000000014000125D(rax_8, rbx, rsi_26, out ebx_113, out rsi_114);
		}
	}
	else
	{
		perror(ptrLoc78);
		word32 ebx_79;
		*ebxOut = (word32) rbx;
		return fn0000000140001300(rax_8 ^ fp - 0x78);
	}
}

// 000000014000120E: Register word32 fn000000014000120E(Register word32 eax, Register up32 ebx, Register word32 r10d, Stack up32 dwArg34, Stack word64 qwArg90, Register out Eq_381 ebxOut, Register out ptr64 rbpOut, Register out ptr64 rsiOut)
word32 fn000000014000120E(word32 eax, up32 ebx, word32 r10d, up32 dwArg34, word64 qwArg90, Eq_381 & ebxOut, ptr64 & rbpOut, ptr64 & rsiOut)
{
}

// 000000014000125D: Register word32 fn000000014000125D(Stack ui64 qwArg60, Stack uint64 qwArg70, Stack word64 qwArg88, Register out Eq_397 ebxOut, Register out ptr64 rsiOut)
word32 fn000000014000125D(ui64 qwArg60, uint64 qwArg70, word64 qwArg88, Eq_397 & ebxOut, ptr64 & rsiOut)
{
	word64 rsp_4;
	word64 rsi_5;
	word64 rcx_6;
	word32 eax_7;
	word64 rax_8;
	byte SZO_9;
	byte C_10;
	byte SCZO_11;
	word64 rbx_12;
	word32 ebx_13;
	MSVCR90.dll!fclose();
	word64 rsi_19;
	*rsiOut = qwArg88;
	word32 ebx_31;
	*ebxOut = (word32) qwArg70;
	return fn0000000140001300(qwArg60 ^ fp);
}

// 0000000140001290: Register word32 fn0000000140001290(Register word32 ecx, Register word64 rdx, Register uint64 rdi, Register word32 r10d, Stack word64 qwArg08, Stack word64 qwArg10, Stack word64 qwArg18)
word32 fn0000000140001290(word32 ecx, word64 rdx, uint64 rdi, word32 r10d, word64 qwArg08, word64 qwArg10, word64 qwArg18)
{
	uint64 rbx_16 = 0x00;
	word32 ebx_17 = 0x00;
	if (0x01 < (int64) ecx)
	{
		do
		{
			word32 ebx_42;
			word64 rbp_43;
			int64 rsi_44;
			word64 rdi_45;
			word32 eax_46 = fn0000000140001190(rbx_16, r10d, rbx, out ebx_42, out rbp_43, out rsi_44, out rdi_45);
			rbx_16 = (uint64) (ebx_42 + eax_46);
			ebx_17 = (word32) rbx_16;
		} while (rdi_45 + 0x01 < rsi_44);
	}
	return (word32) (uint64) ebx_17;
}

// 0000000140001300: Register word32 fn0000000140001300(Register ui64 rcx)
word32 fn0000000140001300(ui64 rcx)
{
	if (rcx != globals->qw40003000)
		return fn0000000140001604(rcx, qwArg00, qwArg08);
	word64 rcx_30 = __rol(rcx, 0x10);
	if (((word16) rcx_30 & ~0x00) == 0x00)
		return eax;
	rcx = __ror(rcx_30, 0x10);
	return fn0000000140001604(rcx, qwArg00, qwArg08);
}

// 0000000140001320: void fn0000000140001320(Register word64 rax)
void fn0000000140001320(word64 rax)
{
	fn0000000140001864(rax);
	uint64 r11_7 = (uint64) globals->dw400035C4;
	word32 r11d_8 = (word32) r11_7;
	globals->dw4000303C = r11d_8;
	word64 rsp_17;
	byte SCZO_18;
	word64 rcx_19;
	word32 r11d_20;
	word64 r11_21;
	word32 r9d_22;
	word64 r9_23;
	word64 rax_24;
	word64 r8_25;
	word64 rdx_26;
	int32 eax_27;
	byte SZO_28;
	byte C_29;
	byte S_30;
	word32 ecx_31;
	_getmainargs();
	globals->dw40003038 = eax_27;
	if (eax_27 < 0x00)
	{
		word64 rsp_52;
		byte SCZO_53;
		word64 rcx_54;
		word32 r11d_55;
		word64 r11_56;
		word32 r9d_57;
		word64 r9_58;
		word64 rax_59;
		word64 r8_60;
		word64 rdx_61;
		word32 eax_62;
		byte SZO_63;
		byte C_64;
		byte S_65;
		word32 ecx_66;
		amsg_exit();
	}
}

// 0000000140001388: Register word32 fn0000000140001388(Register word32 r10d, Register (ptr Eq_620) gs, Stack word64 qwArg08)
word32 fn0000000140001388(word32 r10d, Eq_620 * gs, word64 qwArg08)
{
}

// 0000000140001508: void fn0000000140001508()
void fn0000000140001508()
{
	word32 eax_10;
	if (globals->w40000000 != 23117)
	{
l000000014000151A:
		eax_10 = 0x00;
		goto l000000014000156D;
	}
	struct Eq_888 * rcx_126 = (int64) globals->dw4000003C + 0x140000000;
	if (rcx_126->dw0000 != 0x4550)
		goto l000000014000151A;
	byte Z_139;
	word32 eax_130 = (word32) rcx_126->w0018;
	if (eax_130 != 0x010B)
	{
		if (eax_130 != 0x020B)
			goto l000000014000151A;
		eax_10 = 0x00;
		if (rcx_126->dw0084 <= 0x0E)
		{
l000000014000156D:
			globals->dw40003024 = eax_10;
			word64 rsp_13;
			byte SCZO_14;
			word32 eax_15;
			word64 rax_16;
			word16 ax_17;
			byte Z_18;
			byte SZO_19;
			byte C_20;
			word64 rcx_21;
			byte CZ_22;
			word32 ecx_23;
			word64 rdx_24;
			byte al_25;
			_set_app_type();
			word64 rsp_29;
			byte SCZO_30;
			word32 eax_31;
			word64 rax_32;
			word16 ax_33;
			byte Z_34;
			byte SZO_35;
			byte C_36;
			word64 rcx_37;
			byte CZ_38;
			word32 ecx_39;
			word64 rdx_40;
			byte al_41;
			encode_pointer();
			word32 * rcx_42 = globals->ptr400020A0;
			globals->qw400035E0 = rax_32;
			globals->qw400035E8 = rax_32;
			*rcx_42 = (word32) (uint64) globals->dw400035CC;
			uint64 rax_50 = (uint64) globals->dw400035C8;
			word32 * rdx_49 = globals->ptr40002098;
			word32 eax_51 = (word32) rax_50;
			*rdx_49 = eax_51;
			fn000000014000187C(qwLoc28);
			fn00000001400019D0();
			if (globals->dw4000301C == 0x00)
			{
				word64 rsp_101;
				byte SCZO_102;
				word32 eax_103;
				word64 rax_104;
				word16 ax_105;
				byte Z_106;
				byte SZO_107;
				byte C_108;
				word64 rcx_109;
				byte CZ_110;
				word32 ecx_111;
				word64 rdx_112;
				byte al_113;
				_setusermatherr();
			}
			if (globals->dw40003018 == ~0x00)
			{
				word64 rsp_86;
				byte SCZO_87;
				word32 eax_88;
				word64 rax_89;
				word16 ax_90;
				byte Z_91;
				byte SZO_92;
				byte C_93;
				word64 rcx_94;
				byte CZ_95;
				word32 ecx_96;
				word64 rdx_97;
				byte al_98;
				configthreadlocale();
			}
			return;
		}
		Z_139 = cond(rcx_126->dw00F8);
	}
	else
	{
		eax_10 = 0x00;
		if (rcx_126->dw0074 <= 0x0E)
			goto l000000014000156D;
		Z_139 = cond(rcx_126->dw00E8);
	}
	eax_10 = (word32) Z_139;
	goto l000000014000156D;
}

// 00000001400015F0: Register Eq_878 Win32CrtStartup()
DWORD Win32CrtStartup()
{
	fn00000001400019D4(qwLoc28, qwLoc20, qwLoc18);
	return fn0000000140001388(r10d, gs, qwArg08);
}

// 0000000140001604: Register word32 fn0000000140001604(Register ui64 rcx, Stack word64 qwArg00, Stack word64 qwArg08)
word32 fn0000000140001604(ui64 rcx, word64 qwArg00, word64 qwArg08)
{
	RtlCaptureContext(tLoc88);
	Eq_1077 r11_7 = globals->t400031E8;
	if (RtlLookupFunctionEntry(r11_7, fp - 0x28, null) != null)
	{
		word64 rsp_105;
		word64 rcx_106;
		byte SCZO_107;
		word64 r11_108;
		word32 r8d_109;
		word64 r8_110;
		byte SZO_111;
		byte C_112;
		word64 rdx_113;
		word64 rax_114;
		byte Z_115;
		word64 r9_116;
		word32 ecx_117;
		word32 eax_118;
		KERNEL32.dll!RtlVirtualUnwind();
	}
	else
	{
		globals->t400031E8 = qwArg00;
		globals->ptr40003188 = fp + 0x08;
	}
	globals->qw40003060 = globals->t400031E8;
	globals->qw40003170 = rcx;
	globals->dw40003050 = 0xC0000409;
	globals->dw40003054 = 0x01;
	Eq_1131 eax_30 = IsDebuggerPresent();
	globals->t400030E8 = eax_30;
	word64 rsp_33;
	word64 rcx_34;
	byte SCZO_35;
	word64 r11_36;
	word32 r8d_37;
	word64 r8_38;
	byte SZO_39;
	byte C_40;
	word64 rdx_41;
	word64 rax_42;
	byte Z_43;
	word64 r9_44;
	word32 ecx_45;
	word32 eax_46;
	_crt_debugger_hook();
	SetUnhandledExceptionFilter(tLoc88);
	Eq_1159 eax_50 = UnhandledExceptionFilter(tLoc88);
	if (globals->t400030E8 == 0x00)
	{
		word64 rsp_72;
		word64 rcx_73;
		byte SCZO_74;
		word64 r11_75;
		word32 r8d_76;
		word64 r8_77;
		byte SZO_78;
		byte C_79;
		word64 rdx_80;
		word64 rax_81;
		byte Z_82;
		word64 r9_83;
		word32 ecx_84;
		word32 eax_85;
		_crt_debugger_hook();
	}
	GetCurrentProcess();
	return TerminateProcess(tLoc88, tLoc80);
}

// 0000000140001750: void fn0000000140001750(Register (ptr (ptr Eq_1206)) rcx)
void fn0000000140001750(Eq_1206 * * rcx)
{
	struct Eq_1206 * rax_5 = *rcx;
	if (rax_5->dw0000 == ~0x1F928C9C && rax_5->dw0018 == 0x04)
	{
		word32 eax_17 = (word32) (uint64) rax_5->dw0020;
		if (eax_17 == 0x19930520 || (eax_17 == 429065505 || (eax_17 == 0x19930522 || eax_17 == 0x01994000)))
		{
			terminate();
			int3();
		}
	}
}

// 0000000140001794: void fn0000000140001794()
void fn0000000140001794()
{
	SetUnhandledExceptionFilter(tLoc28);
}

// 00000001400017B4: void fn00000001400017B4(Register word64 rax, Stack word64 qwArg10, Stack word64 qwArg18)
void fn00000001400017B4(word64 rax, word64 qwArg10, word64 qwArg18)
{
	word64 rsp_11;
	word64 rbx_12;
	byte SCZO_13;
	word64 rcx_14;
	word64 rax_15;
	byte Z_16;
	word32 eax_17;
	word32 ecx_18;
	word64 r8_19;
	word64 rdx_20;
	decode_pointer();
	if (rax_15 == ~0x00)
		_onexit(tLoc28);
	else
	{
		word64 rsp_42;
		word64 rbx_43;
		byte SCZO_44;
		word64 rcx_45;
		word64 rax_46;
		byte Z_47;
		word32 eax_48;
		word32 ecx_49;
		word64 r8_50;
		word64 rdx_51;
		lock();
		word64 rsp_53;
		word64 rbx_54;
		byte SCZO_55;
		word64 rcx_56;
		word64 rax_57;
		byte Z_58;
		word32 eax_59;
		word32 ecx_60;
		word64 r8_61;
		word64 rdx_62;
		decode_pointer();
		word64 rsp_65;
		word64 rbx_66;
		byte SCZO_67;
		word64 rcx_68;
		word64 rax_69;
		byte Z_70;
		word32 eax_71;
		word32 ecx_72;
		word64 r8_73;
		word64 rdx_74;
		decode_pointer();
		word64 rsp_77;
		word64 rbx_78;
		byte SCZO_79;
		word64 rcx_80;
		word64 rax_81;
		byte Z_82;
		word32 eax_83;
		word32 ecx_84;
		word64 r8_85;
		word64 rdx_86;
		encode_pointer();
		word64 rsp_90;
		word64 rbx_91;
		byte SCZO_92;
		word64 rcx_93;
		word64 rax_94;
		byte Z_95;
		word32 eax_96;
		word32 ecx_97;
		word64 r8_98;
		word64 rdx_99;
		_dllonexit();
		word64 rsp_102;
		word64 rbx_103;
		byte SCZO_104;
		word64 rcx_105;
		word64 rax_106;
		byte Z_107;
		word32 eax_108;
		word32 ecx_109;
		word64 r8_110;
		word64 rdx_111;
		encode_pointer();
		globals->qw400035E8 = rax_106;
		word64 rsp_114;
		word64 rbx_115;
		byte SCZO_116;
		word64 rcx_117;
		word64 rax_118;
		byte Z_119;
		word32 eax_120;
		word32 ecx_121;
		word64 r8_122;
		word64 rdx_123;
		encode_pointer();
		globals->qw400035E0 = rax_118;
		word64 rsp_126;
		word64 rbx_127;
		byte SCZO_128;
		word64 rcx_129;
		word64 rax_130;
		byte Z_131;
		word32 eax_132;
		word32 ecx_133;
		word64 r8_134;
		word64 rdx_135;
		unlock();
	}
}

// 0000000140001864: void fn0000000140001864(Register word64 rax)
void fn0000000140001864(word64 rax)
{
	fn00000001400017B4(rax, qwLoc20, qwLoc18);
}

// 000000014000187C: void fn000000014000187C(Stack word64 qwArg08)
void fn000000014000187C(word64 qwArg08)
{
	word64 * rbx_17 = &globals->qw40002260;
	word64 * rdi_10 = &globals->qw40002260;
	while (rbx_17 < rdi_10)
	{
		<anonymous> * rax_28 = *rbx_17;
		if (rax_28 != null)
		{
			word64 rsp_41;
			byte SCZO_44;
			byte C_45;
			word64 rax_46;
			byte SZO_47;
			byte Z_48;
			rax_28();
		}
		rbx_17 = rbx_17 + 0x01;
	}
}

// 00000001400018B4: void fn00000001400018B4(Stack word64 qwArg08)
void fn00000001400018B4(word64 qwArg08)
{
	word64 * rbx_17 = &globals->qw40002270;
	word64 * rdi_10 = &globals->qw40002270;
	while (rbx_17 < rdi_10)
	{
		<anonymous> * rax_28 = *rbx_17;
		if (rax_28 != null)
		{
			word64 rsp_41;
			byte SCZO_44;
			byte C_45;
			word64 rax_46;
			byte SZO_47;
			byte Z_48;
			rax_28();
		}
		rbx_17 = rbx_17 + 0x01;
	}
}

// 0000000140001900: Register uint64 fn0000000140001900(Register (ptr Eq_1414) rcx)
uint64 fn0000000140001900(Eq_1414 * rcx)
{
	if (rcx->w0000 != 23117)
		return 0x00;
	struct Eq_1420 * rcx_32 = rcx + (int64) rcx->dw003C / 0x0040;
	uint64 rax_35 = 0x00;
	if (rcx_32->dw0000 == 0x4550)
		rax_35 = (uint64) (rcx_32->w0018 == 0x020B);
	return rax_35;
}

// 0000000140001930: Register (ptr Eq_1440) fn0000000140001930(Register (ptr Eq_1440) rax, Register ptr64 rcx, Register uint64 rdx, Register (ptr Eq_1443) r9, Register out Eq_1444 r10dOut)
Eq_1440 * fn0000000140001930(Eq_1440 * rax, ptr64 rcx, uint64 rdx, Eq_1443 * r9, Eq_1444 & r10dOut)
{
}

// 0000000140001980: Register word32 fn0000000140001980(Register Eq_731 rcx, Register out Eq_732 r10dOut)
word32 fn0000000140001980(Eq_731 rcx, Eq_732 & r10dOut)
{
	*r10dOut = r10d;
	struct Eq_1440 * rax_8 = fn0000000140001900(&globals->w40000000);
	word32 eax_21 = (word32) rax_8;
	if (eax_21 != 0x00)
	{
		word32 r10d_31;
		struct Eq_1511 * rax_32 = fn0000000140001930(rax_8, 0x140000000, rcx - 0x140000000, &globals->w40000000, out r10d_31);
		eax_21 = (word32) rax_32;
		if (rax_32 != null)
			eax_21 = (word32) (uint64) ((word32) (uint64) ~(word32) (uint64) ((word32) (uint64) rax_32->dw0024 >> 0x1F) & 0x01);
	}
	return eax_21;
}

// 00000001400019D0: void fn00000001400019D0()
void fn00000001400019D0()
{
}

// 00000001400019D4: void fn00000001400019D4(Stack ui64 qwArg08, Stack word64 qwArg10, Stack word64 qwArg18)
void fn00000001400019D4(ui64 qwArg08, word64 qwArg10, word64 qwArg18)
{
	word64 rax_9 = globals->qw40003000;
	if (rax_9 != 769630770)
		globals->qw40003008 = ~rax_9;
	else
	{
		GetSystemTimeAsFileTime(tLoc28);
		ui64 rbx_45 = qwArg08 & 0x00 ^ (uint64) GetCurrentProcessId() ^ (uint64) GetCurrentThreadId() ^ (uint64) GetTickCount();
		QueryPerformanceCounter(tLoc28);
		ui64 r11_49 = qwArg10 ^ rbx_45;
		ui64 r11_51 = r11_49 & 0xFFFFFFFF;
		if ((r11_49 & 0xFFFFFFFF) == 769630770)
			r11_51 = 769630771;
		globals->qw40003000 = r11_51;
		globals->qw40003008 = ~r11_51;
	}
}

// 0000000140001AB4: void fn0000000140001AB4(Register (ptr Eq_1596) rax, Register int64 rcx, Register (ptr Eq_1598) rdx, Register (ptr Eq_1599) r8)
void fn0000000140001AB4(Eq_1596 * rax, int64 rcx, Eq_1598 * rdx, Eq_1599 * r8)
{
	int64 r9_13 = rcx;
	word32 r11d_15 = (word32) (uint64) ((word32) (uint64) r8->dw0000 & ~0x07);
	int64 r10_20 = rcx;
	if ((rax->b0000 & 0x04) != 0x00)
		r10_20 = (int64) r8->dw0004 + rcx & (int64) ((word32) ((uint64) (-((word32) ((uint64) rax->dw0008)))));
	word64 rdx_25 = *((word64) (int64) r11d_15 + r10_20);
	struct Eq_1623 * rcx_28 = (uint64) rdx->ptr0010->dw0008 + rdx->qw0008;
	if ((rcx_28->b0003 & 0x0F) != 0x00)
	{
		uint64 rax_49 = (uint64) ((word32) rcx_28->b0003 & ~0x0F);
		r9_13 = rcx + DPB(rax_49, (int16) ((byte) rax_49), 0);
	}
	ui64 r9_40 = r9_13 ^ rdx_25;
	fn0000000140001300(r9_40);
}

// 0000000140001B18: void fn0000000140001B18(Register (ptr Eq_1596) rax, Register int64 rdx, Register (ptr Eq_1598) r9)
void fn0000000140001B18(Eq_1596 * rax, int64 rdx, Eq_1598 * r9)
{
	fn0000000140001AB4(rax, rdx, r9, r9->ptr0038);
}

// 0000000140001B40: void fn0000000140001B40(Register word64 rcx)
void fn0000000140001B40(word64 rcx)
{
	word64 rsp_14;
	word64 rbp_15;
	byte SCZO_16;
	word64 rdx_17;
	word64 rax_18;
	word64 rcx_19;
	word32 ecx_20;
	XcptFilter();
}

// 0000000140001B5C: void fn0000000140001B5C()
void fn0000000140001B5C()
{
	word64 rsp_10;
	word64 rbp_11;
	byte SCZO_12;
	word64 rdx_13;
	word32 ecx_14;
	word64 rcx_15;
	unlock();
}

// 0000000140001B80: void fn0000000140001B80(Register word64 rcx)
void fn0000000140001B80(word64 rcx)
{
}

