// subject_fini.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject_fini.h"

// 0000000000400A38: void _fini()
void _fini()
{
	__do_global_dtors_aux();
}

// subject_init.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject_init.h"

// 0000000000400528: void _init()
// Called from:
//      __libc_csu_init
void _init()
{
	call_gmon_start();
	frame_dummy();
	__do_global_ctors_aux();
}

// subject_text.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject_text.h"

// 00000000004005D0: void _start(Register (ptr64 Eq_11) rdx, Stack Eq_12 qwArg00)
void _start(void (* rdx)(), Eq_12 qwArg00)
{
	__align((char *) fp + 8);
	__libc_start_main(&g_t400912, qwArg00, (char *) fp + 8, &g_t400970, &g_t400960, rdx, fp);
	__hlt();
}

// 00000000004005FC: void call_gmon_start()
// Called from:
//      _init
void call_gmon_start()
{
	if (__gmon_start__ != 0x00)
		__gmon_start__();
}

// 0000000000400620: void __do_global_dtors_aux()
// Called from:
//      _fini
void __do_global_dtors_aux()
{
	if (g_b600DC8 == 0x00)
	{
		uint64 rax_15 = g_qw600DD0;
		while (rax_15 < 0x00)
		{
			uint64 rax_22 = rax_15 + 0x01;
			g_qw600DD0 = rax_22;
			(*((char *) g_a600BA0 + rax_22 * 0x08))();
			rax_15 = g_qw600DD0;
		}
		g_b600DC8 = 0x01;
	}
}

// 0000000000400690: void frame_dummy()
// Called from:
//      _init
void frame_dummy()
{
	if (g_qw600BB0 == 0x00 || 0x00 == 0x00)
		return;
	word64 rax_23;
	null();
}

// 00000000004006C0: void dumpline(Register word32 edx, Register (ptr64 byte) rdi)
// Called from:
//      hexdump
void dumpline(word32 edx, byte * rdi)
{
	sprintf(fp - 0x88, "%08lX:", 0x00);
	word32 r15d_193 = (word32) rdi;
	int32 ebx_33 = (word32) (uint64) edx;
	int32 r12d_37 = 0x10;
	if (ebx_33 <= 0x10)
		r12d_37 = ebx_33;
	Eq_97 ebp_254;
	Eq_98 r12d_226;
	uint64 rbp_155;
	uint64 r12_229;
	word32 ebx_148;
	word32 rax_32_32_185;
	uint64 r12_164;
	word32 edx_100 = 0x01;
	if (r12d_37 > 0x00)
	{
		word32 r14d_279 = (word32) rdi;
		byte * rbx_45 = rdi;
		word32 ebp_277 = 0x00;
		do
		{
			sprintf(fp - 0x7F + (int64) ebp_277, " %02lX", 0x00);
			++rbx_45;
			ebp_277 = (word32) (uint64) (ebp_277 + 0x03);
		} while (r12d_37 > (word32) ((uint64) ((word32) ((uint64) ((word32) rbx_45)) - r14d_279)));
		r12_164 = (uint64) r12d_37;
		if (r12d_37 > 0x0F)
		{
			byte * rdi_72 = fp - 0x88;
			word64 rcx_74 = ~0x00;
			while (rcx_74 != 0x00)
			{
				rdi_72 = rdi_446 + 1;
				--rcx_74;
				rdi_446 = rdi_72;
				if (*rdi_446 != 0x00)
					break;
			}
			ebx_148 = (word32) (~rcx_74 - 0x01);
			int64 rax_88 = (int64) ebx_148;
			(&(&(&(&(&(&(&(&(&(&(&(&(&(&(&(&(&(&(&(fp - 0x88)[rax_88 / 4].a0000)[0].a0000)[0].a0000)[0].a0000)[0].a0000)[0].a0000)[0].a0000)[0].a0000)[0].a0000)[0].a0000)[0].a0000)[0].a0000)[0].a0000)[0].a0000)[0].a0000)[0].a0000)[0].a0000)[0].a0000)[0].a0000)[0] = (Eq_296) 0x007C2020;
			rax_32_32_185 = SLICE(rax_88, word32, 32);
			rbp_155 = (uint64) ((word32) (uint64) ebx_148 + 0x03);
l00000000004007AF:
			ebp_254 = (word32) rbp_155;
			r12d_226 = (word32) r12_164;
			byte * rdi_189 = rdi + 1 + SEQ(rax_32_32_185, (word32) (r12_164 - 0x01));
			byte * rax_190 = rdi;
			uint64 rbx_196 = (uint64) ((word32) (uint64) (ebx_148 - r15d_193) + 0x03);
			do
			{
				uint64 rdx_201 = (uint64) (word32) *rax_190;
				word32 rdx_32_32_412 = SLICE(rdx_201, word32, 32);
				if ((byte) (word32) (rdx_201 - 0x20) >= 0x5F)
					rdx_201 = SEQ(SEQ(rdx_32_32_412, 0x00), 0x2E);
				(&(&(&(&(&(&(&(&(&(&(&(&(&(&(&(&(&(&(&(fp - 0x88)[(int64) (word32) (rax_190 + rbx_196)].a0000)[0].a0000)[0].a0000)[0].a0000)[0].a0000)[0].a0000)[0].a0000)[0].a0000)[0].a0000)[0].a0000)[0].a0000)[0].a0000)[0].a0000)[0].a0000)[0].a0000)[0].a0000)[0].a0000)[0].a0000)[0].a0000)[0] = (byte) rdx_201;
				++rax_190;
				r12_229 = r12_164;
			} while (rax_190 != rdi_189);
			if (r12d_226 > 0x0F)
			{
l0000000000400801:
				Mem260[fp - 0x88 + (r12d_226 + ebp_254):word16] = 0x7C;
				puts(fp - 0x88);
				return;
			}
l00000000004007A9:
			ebp_254 = (word32) rbp_155;
			r12d_226 = (word32) r12_229;
			word32 eax_239 = (word32) (r12_229 + rbp_155);
			do
			{
				(&(&(&(&(&(&(&(&(&(&(&(&(&(&(&(&(&(&(&(fp - 0x88)[(int64) eax_239].a0000)[0].a0000)[0].a0000)[0].a0000)[0].a0000)[0].a0000)[0].a0000)[0].a0000)[0].a0000)[0].a0000)[0].a0000)[0].a0000)[0].a0000)[0].a0000)[0].a0000)[0].a0000)[0].a0000)[0].a0000)[0].a0000)[0] = (Eq_230) 0x20;
				r12d_226 = (word32) (uint64) ((word64) r12d_226 + 1);
				eax_239 = (word32) (uint64) (eax_239 + 0x01);
			} while (r12d_226 <= 0x0F);
			goto l0000000000400801;
		}
		edx_100 = (word32) (r12_164 + 0x01);
	}
	do
	{
		word64 rcx_107 = ~0x00;
		byte * rdi_109 = fp - 0x88;
		while (rcx_107 != 0x00)
		{
			rdi_109 = rdi_447 + 1;
			--rcx_107;
			rdi_447 = rdi_109;
			if (*rdi_447 != 0x00)
				break;
		}
		fp - 0x89 + ~rcx_107 = (word32 *) 0x00202020;
		uint64 rdx_127 = (uint64) (edx_100 + 0x01);
		edx_100 = (word32) rdx_127;
	} while ((word32) (rdx_127 - 0x01) <= 0x0F);
	byte * rdi_134 = fp - 0x88;
	word64 rcx_136 = ~0x00;
	while (rcx_136 != 0x00)
	{
		rdi_134 = rdi_448 + 1;
		--rcx_136;
		rdi_448 = rdi_134;
		if (*rdi_448 != 0x00)
			break;
	}
	ebx_148 = (word32) (~rcx_136 - 0x01);
	int64 rax_150 = (int64) ebx_148;
	(&(&(&(&(&(&(&(&(&(&(&(&(&(&(&(&(&(&(&(fp - 0x88)[rax_150 / 4].a0000)[0].a0000)[0].a0000)[0].a0000)[0].a0000)[0].a0000)[0].a0000)[0].a0000)[0].a0000)[0].a0000)[0].a0000)[0].a0000)[0].a0000)[0].a0000)[0].a0000)[0].a0000)[0].a0000)[0].a0000)[0].a0000)[0] = (Eq_186) 0x007C2020;
	rax_32_32_185 = SLICE(rax_150, word32, 32);
	rbp_155 = (uint64) ((word32) (uint64) ebx_148 + 0x03);
	r12_164 = (uint64) r12d_37;
	if (r12d_37 <= 0x00)
	{
		r12_229 = 0x00;
		goto l00000000004007A9;
	}
	goto l00000000004007AF;
}

// 0000000000400853: Register word32 hexdump(Register (ptr64 char) rdi)
// Called from:
//      main
word32 hexdump(char * rdi)
{
	uint64 rax_111;
	if (__xstat(0x01, rdi, fp - 200) != 0x00)
	{
		perror(rdi);
		rax_111 = 0x01;
	}
	else
	{
		FILE * rax_28 = fopen(rdi, "rb");
		if (rax_28 != null)
		{
			uint64 rbp_35;
			for (rbp_35 = 0x00; rbp_35 < qwLoc98; rbp_35 += (int64) ebx_64)
			{
				Eq_356 eax_45 = fread(fp - 0x38, 0x01, 0x10, rax_28);
				word32 ebx_64 = (word32) (uint64) eax_45;
				if (eax_45 == 0x00)
					break;
				dumpline((word32) (uint64) eax_45, fp - 0x38);
			}
			fclose(rax_28);
			rax_111 = 0x00;
		}
		else
		{
			perror(rdi);
			rax_111 = 0x01;
		}
	}
	return (word32) rax_111;
}

// 0000000000400912: void main(Register word64 rsi, Register int32 edi)
void main(word64 rsi, int32 edi)
{
	int32 edi = (word32) rdi;
	int32 r13d_65 = (word32) (uint64) edi;
	if (edi > 0x01)
	{
		word64 * rbx_23 = rsi + 0x08;
		int32 ebp_40 = 0x01;
		do
		{
			hexdump(*rbx_23);
			ebp_40 = (word32) (uint64) (ebp_40 + 0x01);
			++rbx_23;
		} while (r13d_65 > ebp_40);
	}
}

// 0000000000400960: void __libc_csu_fini()
void __libc_csu_fini()
{
}

// 0000000000400970: void __libc_csu_init(Register word64 rdx, Register word64 rsi, Register word32 edi)
void __libc_csu_init(word64 rdx, word64 rsi, word32 edi)
{
	_init();
	int64 rbp_19 = 0x00600B8C - 0x00600B8C;
	word32 r13d_73 = (word32) (uint64) edi;
	if (rbp_19 >> 0x03 != 0x00)
	{
		Eq_431 rbx_37 = 0x00;
		do
		{
			((<anonymous> *[]) 0x00600B8C)[rbx_37]();
			rbx_37 = (word64) rbx_37.u1 + 1;
		} while (rbx_37 < rbp_19 >> 0x03);
	}
}

// 0000000000400A00: void __do_global_ctors_aux()
// Called from:
//      _init
void __do_global_ctors_aux()
{
	<anonymous> * rax_12 = g_ptr600B90;
	if (rax_12 != (<anonymous> *) ~0x00)
	{
		word64 * rbx_15 = &g_ptr600B90;
		do
		{
			rax_12();
			rbx_15 -= 0x08;
			rax_12 = *rbx_15;
		} while (rax_12 != (<anonymous> *) ~0x00);
	}
}

