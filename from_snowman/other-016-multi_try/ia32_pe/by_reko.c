// subject.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

// 00401005: Register word32 fn00401005(Stack word32 dwArg04, Register out ptr32 ebxOut)
word32 fn00401005(word32 dwArg04, ptr32 & ebxOut)
{
	word32 eax_12 = Mem0[fs:0x00:word32];
	Mem33[fs:0x00:word32] = fp - 0x10;
	word32 esp_111 = fp - 44;
	if (dwArg04 == ~0x08)
	{
		word32 ebp_133;
		word32 eax_134;
		word32 ecx_136;
		byte SCZO_137;
		word32 ebx_138;
		word32 esi_139;
		word32 edi_140;
		byte SZO_141;
		byte C_142;
		byte Z_143;
		word32 edx_144;
		CxxThrowException();
	}
	if (dwArg04 == 0x00)
	{
		word32 esp_106 = esp_111 - 0x04;
		Mem107[esp_106 + 0x00:word32] = 0x00405070;
		Mem110[esp_106 - 0x04 + 0x00:word32] = fp - 0x1C;
		word32 ebp_112;
		word32 eax_113;
		word32 ecx_115;
		byte SCZO_116;
		word32 ebx_117;
		word32 esi_118;
		word32 edi_119;
		byte SZO_120;
		byte C_121;
		byte Z_122;
		word32 edx_123;
		CxxThrowException();
	}
	Mem93[fs:0x00:word32] = eax_12;
	word32 ebx_100;
	*ebxOut = Mem93[esp_111 + 0x0C:word32];
	return dwArg04 + 0x0A;
}

// 004014A8: Register DWORD Win32CrtStartup()
DWORD Win32CrtStartup()
{
}

// 00401810: Register word32 fn00401810(Stack word32 dwArg04)
word32 fn00401810(word32 dwArg04)
{
	if (Mem0[dwArg04 + 0x00:word16] != 23117)
		return 0x00;
	word32 eax_39 = Mem0[dwArg04 + 0x3C:word32] + dwArg04;
	if (Mem0[eax_39 + 0x00:word32] != 0x4550)
		return 0x00;
	return (word32) (Mem0[eax_39 + 0x18:word16] == 0x010B);
}

// 00401850: Register word32 fn00401850(Stack word32 dwArg04, Stack word32 dwArg08)
word32 fn00401850(word32 dwArg04, word32 dwArg08)
{
}

// 004018A0: Register word32 fn004018A0(Stack word32 dwArg04)
word32 fn004018A0(word32 dwArg04)
{
	word32 eax_16 = Mem0[fs:0x00:word32];
	Mem38[fs:0x00:word32] = fp - 0x14;
	if (fn00401810(0x00400000) != 0x00)
	{
		word32 eax_92 = fn00401850(0x00400000, dwArg04 - 0x00400000);
		if (eax_92 != 0x00)
		{
			word32 eax_99 = ~(Mem38[eax_92 + 0x24:word32] >>u 0x1F);
			Mem105[fs:0x00:word32] = eax_16;
			return eax_99 & 0x01;
		}
	}
	Mem73[fs:0x00:word32] = eax_16;
	return 0x00;
}

// 00401970: Register word32 fn00401970(Register word32 ebx, Register word32 esi, Register word32 edi, Stack word32 dwArg00, Stack word32 dwArg04, Stack word32 dwArg08)
word32 fn00401970(word32 ebx, word32 esi, word32 edi, word32 dwArg00, word32 dwArg04, word32 dwArg08)
{
	word32 esp_14 = fp - 0x08 - dwArg08;
	Mem17[esp_14 - 0x04 + 0x00:word32] = ebx;
	Mem20[esp_14 - 0x08 + 0x00:word32] = esi;
	Mem23[esp_14 - 0x0C + 0x00:word32] = edi;
	Mem33[esp_14 - 0x10 + 0x00:word32] = Mem23[0x00406020:word32] ^ fp + 0x08;
	Mem38[esp_14 - 0x14 + 0x00:word32] = dwArg00;
	Mem43[fs:0x00:word32] = fp - 0x08;
	return fp + 0x08;
}

// 004019B5: void fn004019B5(Register word32 ebp, Stack word32 dwArg00, Stack word32 dwArg04, Stack word32 dwArg08, Stack word32 dwArg0C, Stack word32 dwArg10)
void fn004019B5(word32 ebp, word32 dwArg00, word32 dwArg04, word32 dwArg08, word32 dwArg0C, word32 dwArg10)
{
	Mem5[fs:0x00:word32] = Mem0[ebp - 0x10 + 0x00:word32];
	Mem25[ebp + 0x00:word32] = dwArg00;
}

// 00401A50: Register word32 fn00401A50()
word32 fn00401A50()
{
	word32 eax_10 = Mem0[0x00406020:word32];
	if (eax_10 != 0xBB40E64E && (eax_10 & 0xFFFF0000) != 0x00)
		Mem96[0x00406024:word32] = ~eax_10;
	else
	{
		GetSystemTimeAsFileTime(fp - 0x0C);
		word32 esi_60 = dwLoc08 & 0x00 ^ dwLoc0C & 0x00 ^ GetCurrentProcessId() ^ GetCurrentThreadId() ^ GetTickCount();
		QueryPerformanceCounter(fp - 0x14);
		word32 esi_69 = esi_60 ^ (dwLoc10 ^ dwLoc14);
		if (esi_69 == 0xBB40E64E)
			esi_69 = ~0x44BF19B0;
		else if ((esi_69 & 0xFFFF0000) == 0x00)
			esi_69 = esi_69 | (esi_69 | 0x4711) << 0x10;
		Mem77[0x00406020:word32] = esi_69;
		Mem79[0x00406024:word32] = ~esi_69;
		esi = fp - 0x14;
	}
	return esi;
}

