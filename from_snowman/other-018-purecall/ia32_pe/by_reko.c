// subject.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

// 0040100A: Register word32 fn0040100A()
word32 fn0040100A()
{
	word32 eax_23 = operator new(0x04);
	if (eax_23 != 0x00)
		Mem22[eax_23 + 0x00:word32] = 0x0040374C;
	else
		eax_23 = 0x00;
	word32 edx_11 = Mem0[eax_23 + 0x00:word32];
	word32 eax_13 = Mem0[edx_11 + 0x00:word32];
	word32 esp_14;
	word32 eax_15;
	byte SCZO_16;
	byte SZO_17;
	byte C_18;
	byte Z_19;
	word32 edx_20;
	word32 ecx_21;
	eax_13();
	return eax_15;
}

// 004013CC: Register DWORD Win32CrtStartup()
DWORD Win32CrtStartup()
{
}

// 00401630: Register word32 fn00401630(Stack word32 dwArg04)
word32 fn00401630(word32 dwArg04)
{
	if (Mem0[dwArg04 + 0x00:word16] != 23117)
		return 0x00;
	word32 eax_39 = Mem0[dwArg04 + 0x3C:word32] + dwArg04;
	if (Mem0[eax_39 + 0x00:word32] != 0x4550)
		return 0x00;
	return (word32) (Mem0[eax_39 + 0x18:word16] == 0x010B);
}

// 00401670: Register word32 fn00401670(Stack word32 dwArg04, Stack word32 dwArg08)
word32 fn00401670(word32 dwArg04, word32 dwArg08)
{
}

// 004016C0: Register word32 fn004016C0(Stack word32 dwArg04)
word32 fn004016C0(word32 dwArg04)
{
	word32 eax_16 = Mem0[fs:0x00:word32];
	Mem38[fs:0x00:word32] = fp - 0x14;
	if (fn00401630(0x00400000) != 0x00)
	{
		word32 eax_92 = fn00401670(0x00400000, dwArg04 - 0x00400000);
		if (eax_92 != 0x00)
		{
			word32 eax_99 = ~(Mem38[eax_92 + 0x24:word32] >>u 0x1F);
			Mem105[fs:0x00:word32] = eax_16;
			return eax_99 & 0x01;
		}
	}
	Mem73[fs:0x00:word32] = eax_16;
	return 0x00;
}

// 00401790: Register word32 fn00401790(Register word32 ebx, Register word32 esi, Register word32 edi, Stack word32 dwArg00, Stack word32 dwArg04, Stack word32 dwArg08)
word32 fn00401790(word32 ebx, word32 esi, word32 edi, word32 dwArg00, word32 dwArg04, word32 dwArg08)
{
	word32 esp_14 = fp - 0x08 - dwArg08;
	Mem17[esp_14 - 0x04 + 0x00:word32] = ebx;
	Mem20[esp_14 - 0x08 + 0x00:word32] = esi;
	Mem23[esp_14 - 0x0C + 0x00:word32] = edi;
	Mem33[esp_14 - 0x10 + 0x00:word32] = Mem23[0x00405058:word32] ^ fp + 0x08;
	Mem38[esp_14 - 0x14 + 0x00:word32] = dwArg00;
	Mem43[fs:0x00:word32] = fp - 0x08;
	return fp + 0x08;
}

// 004017D5: void fn004017D5(Register word32 ebp, Stack word32 dwArg00, Stack word32 dwArg04, Stack word32 dwArg08, Stack word32 dwArg0C, Stack word32 dwArg10)
void fn004017D5(word32 ebp, word32 dwArg00, word32 dwArg04, word32 dwArg08, word32 dwArg0C, word32 dwArg10)
{
	Mem5[fs:0x00:word32] = Mem0[ebp - 0x10 + 0x00:word32];
	Mem25[ebp + 0x00:word32] = dwArg00;
}

// 00401870: Register word32 fn00401870()
word32 fn00401870()
{
	word32 eax_10 = Mem0[0x00405058:word32];
	if (eax_10 != 0xBB40E64E && (eax_10 & 0xFFFF0000) != 0x00)
		Mem96[0x0040505C:word32] = ~eax_10;
	else
	{
		GetSystemTimeAsFileTime(fp - 0x0C);
		word32 esi_60 = dwLoc08 & 0x00 ^ dwLoc0C & 0x00 ^ GetCurrentProcessId() ^ GetCurrentThreadId() ^ GetTickCount();
		QueryPerformanceCounter(fp - 0x14);
		word32 esi_69 = esi_60 ^ (dwLoc10 ^ dwLoc14);
		if (esi_69 == 0xBB40E64E)
			esi_69 = ~0x44BF19B0;
		else if ((esi_69 & 0xFFFF0000) == 0x00)
			esi_69 = esi_69 | (esi_69 | 0x4711) << 0x10;
		Mem77[0x00405058:word32] = esi_69;
		Mem79[0x0040505C:word32] = ~esi_69;
		esi = fp - 0x14;
	}
	return esi;
}

