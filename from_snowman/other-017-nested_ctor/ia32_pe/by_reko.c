// subject.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

// 0040100F: Register word32 fn0040100F(Register out ptr32 ebxOut, Register out ptr32 ebpOut)
word32 fn0040100F(ptr32 & ebxOut, ptr32 & ebpOut)
{
	word32 eax_16 = operator new(0x08);
	if (eax_16 != 0x00)
		fn00401019(eax_16);
	word32 ebx_139;
	word32 eax_25 = operator new(0x08);
	if (eax_25 != 0x00)
		ebx_139 = fn00401014(eax_25);
	else
		ebx_139 = 0x00;
	word32 eax_34 = operator new(0x08);
	if (eax_34 != 0x00)
		fn00401019(eax_34);
	word32 eax_43 = operator new(0x08);
	if (eax_43 != 0x00)
		fn00401014(eax_43);
	word32 eax_49 = Mem0[ebx_139 + 0x00:word32];
	word32 edx_50 = Mem0[eax_49 + 0x00:word32];
	word32 esp_52;
	word32 ebx_53;
	word32 ebp_54;
	word32 esi_55;
	word32 edi_56;
	word32 eax_57;
	byte SCZO_58;
	byte SZO_59;
	byte C_60;
	byte Z_61;
	word32 ecx_62;
	word32 edx_63;
	edx_50();
	word32 eax_65 = Mem0[esi_55 + 0x00:word32];
	word32 edx_66 = Mem0[eax_65 + 0x00:word32];
	word32 esp_68;
	word32 ebx_69;
	word32 ebp_70;
	word32 esi_71;
	word32 edi_72;
	word32 eax_73;
	byte SCZO_74;
	byte SZO_75;
	byte C_76;
	byte Z_77;
	word32 ecx_78;
	word32 edx_79;
	edx_66();
	word32 eax_81 = Mem0[edi_72 + 0x00:word32];
	word32 edx_82 = Mem0[eax_81 + 0x00:word32];
	word32 esp_84;
	word32 ebx_85;
	word32 ebp_86;
	word32 esi_87;
	word32 edi_88;
	word32 eax_89;
	byte SCZO_90;
	byte SZO_91;
	byte C_92;
	byte Z_93;
	word32 ecx_94;
	word32 edx_95;
	edx_82();
	word32 eax_98 = Mem0[ebp_86 + 0x00:word32];
	word32 edx_99 = Mem0[eax_98 + 0x00:word32];
	word32 esp_101;
	word32 ebx_102;
	word32 ebp_103;
	word32 esi_104;
	word32 edi_105;
	word32 eax_106;
	byte SCZO_107;
	byte SZO_108;
	byte C_109;
	byte Z_110;
	word32 ecx_111;
	word32 edx_112;
	edx_99();
	word32 ebp_119;
	*ebpOut = Mem0[esp_101 + 0x08:word32];
	word32 ebx_121;
	*ebxOut = Mem0[esp_101 + 0x0C:word32];
	return eax_106 + esi_104;
}

// 00401014: Register word32 fn00401014(Register word32 ecx)
word32 fn00401014(word32 ecx)
{
	Mem4[ecx + 0x00:word32] = 0x00403740;
	Mem5[ecx + 0x04:word32] = 100;
	return ecx;
}

// 00401019: Register word32 fn00401019(Register word32 ecx)
word32 fn00401019(word32 ecx)
{
	fn00401014(ecx);
	Mem10[ecx + 0x04:word32] = Mem0[ecx + 0x04:word32] + 0x01;
	Mem12[ecx + 0x00:word32] = 0x0040374C;
	return ecx;
}

// 004014A4: Register DWORD Win32CrtStartup()
DWORD Win32CrtStartup()
{
}

// 00401700: Register word32 fn00401700(Stack word32 dwArg04)
word32 fn00401700(word32 dwArg04)
{
	if (Mem0[dwArg04 + 0x00:word16] != 23117)
		return 0x00;
	word32 eax_39 = Mem0[dwArg04 + 0x3C:word32] + dwArg04;
	if (Mem0[eax_39 + 0x00:word32] != 0x4550)
		return 0x00;
	return (word32) (Mem0[eax_39 + 0x18:word16] == 0x010B);
}

// 00401740: Register word32 fn00401740(Stack word32 dwArg04, Stack word32 dwArg08)
word32 fn00401740(word32 dwArg04, word32 dwArg08)
{
}

// 00401790: Register word32 fn00401790(Stack word32 dwArg04)
word32 fn00401790(word32 dwArg04)
{
	word32 eax_16 = Mem0[fs:0x00:word32];
	Mem38[fs:0x00:word32] = fp - 0x14;
	if (fn00401700(0x00400000) != 0x00)
	{
		word32 eax_92 = fn00401740(0x00400000, dwArg04 - 0x00400000);
		if (eax_92 != 0x00)
		{
			word32 eax_99 = ~(Mem38[eax_92 + 0x24:word32] >>u 0x1F);
			Mem105[fs:0x00:word32] = eax_16;
			return eax_99 & 0x01;
		}
	}
	Mem73[fs:0x00:word32] = eax_16;
	return 0x00;
}

// 00401860: Register word32 fn00401860(Register word32 ebx, Register word32 esi, Register word32 edi, Stack word32 dwArg00, Stack word32 dwArg04, Stack word32 dwArg08)
word32 fn00401860(word32 ebx, word32 esi, word32 edi, word32 dwArg00, word32 dwArg04, word32 dwArg08)
{
	word32 esp_14 = fp - 0x08 - dwArg08;
	Mem17[esp_14 - 0x04 + 0x00:word32] = ebx;
	Mem20[esp_14 - 0x08 + 0x00:word32] = esi;
	Mem23[esp_14 - 0x0C + 0x00:word32] = edi;
	Mem33[esp_14 - 0x10 + 0x00:word32] = Mem23[0x00405058:word32] ^ fp + 0x08;
	Mem38[esp_14 - 0x14 + 0x00:word32] = dwArg00;
	Mem43[fs:0x00:word32] = fp - 0x08;
	return fp + 0x08;
}

// 004018A5: void fn004018A5(Register word32 ebp, Stack word32 dwArg00, Stack word32 dwArg04, Stack word32 dwArg08, Stack word32 dwArg0C, Stack word32 dwArg10)
void fn004018A5(word32 ebp, word32 dwArg00, word32 dwArg04, word32 dwArg08, word32 dwArg0C, word32 dwArg10)
{
	Mem5[fs:0x00:word32] = Mem0[ebp - 0x10 + 0x00:word32];
	Mem25[ebp + 0x00:word32] = dwArg00;
}

// 00401940: Register word32 fn00401940()
word32 fn00401940()
{
	word32 eax_10 = Mem0[0x00405058:word32];
	if (eax_10 != 0xBB40E64E && (eax_10 & 0xFFFF0000) != 0x00)
		Mem96[0x0040505C:word32] = ~eax_10;
	else
	{
		GetSystemTimeAsFileTime(fp - 0x0C);
		word32 esi_60 = dwLoc08 & 0x00 ^ dwLoc0C & 0x00 ^ GetCurrentProcessId() ^ GetCurrentThreadId() ^ GetTickCount();
		QueryPerformanceCounter(fp - 0x14);
		word32 esi_69 = esi_60 ^ (dwLoc10 ^ dwLoc14);
		if (esi_69 == 0xBB40E64E)
			esi_69 = ~0x44BF19B0;
		else if ((esi_69 & 0xFFFF0000) == 0x00)
			esi_69 = esi_69 | (esi_69 | 0x4711) << 0x10;
		Mem77[0x00405058:word32] = esi_69;
		Mem79[0x0040505C:word32] = ~esi_69;
		esi = fp - 0x14;
	}
	return esi;
}

