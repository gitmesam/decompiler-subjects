union { int; char[] *; } global_0x08056f68[9999999];
int next.4089;
int VERBOSE;
int FORCE;
int UPGRADE;
int ERROR;
__size32 WARNINGS;// 4 bytes
int main(int argc, char *argv[]);
void show_help();
__size32 atexit(union { atexitfunc; __size32; } param1);
void print_error(char param1[], int param2, union { char *; __size32; } param3, int param4);
void show_version();
void restore(char param1[], char param2[], char param3, char param4, char param5[], char param6, char param7, char param8[], char param9[], char param10[], char param11, char param12, char param13[], char param14[], char param15, char param16[], char param17[], char param18[], char param19[], __size32 param20, __size32 param21, __size32 param22, __size32 param23, union { DIR *; __size32; } param24, union { FILE *; __size32; } param25, int param26, int param27, char param28, char param29[], char param30, char param31[], char param32, char param33, char param34, int param35, union { char *; __size32; } param36, __size8 param37, int param38);
void list_extensions(__size32 param1, union { __size32; void *; } param2, __size32 param3, union { unsigned char *; __size32; } param4, char param5[], char param6, union { char[] *; __size32; } param7, __size8 param8, char param9);
void wget_extension(char param1[], char param2, union { char[] *; __size32; } param3);
__size32 __stat(union { char *; __size32; } param1, union { struct stat *; __size32; } param2);
void unpack_extension(char param1, char param2[], char param3, union { char[] *; __size32; } param4);
void get_package_name(char param1[], char param2, char param3, union { char[] *; __size32; } param4, union { char *; __size32; } param5);
__size32 run_post(char param1[], char param2[], __size32 param3, unsigned int param4, union { char[] *; __size32; } param5, union { char[] *; __size32; } param6);
void check_extension(char param1[], union { char *; __size32; } param2);
void query_extension(__size32 param1, int param2, union { __size32; void *; } param3, __size32 param4, union { unsigned char *; __size32; } param5, char param6[], char param7, union { char[] *; __size32; } param8, union { char[] *; __size32; } param9, int param10, int param11, int param12, union { char[] *; __size32; } param13, union { char[] *; __size32; } param14, char param15);
void show_details(__size32 param1, union { __size32; void *; } param2, __size32 param3, union { unsigned char *; __size32; } param4, char param5[], char param6, __size32 param7, char param8);
void show_license(__size32 param1, union { __size32; void *; } param2, __size32 param3, union { unsigned char *; __size32; } param4, char param5[], char param6, __size32 param7, char param8);
void source_clean(char param1[], char param2, char param3, __size32 param4);
void source_install(char param1[], char param2[], char param3, char param4, char param5, char param6, char param7[], char param8[], char param9[], char param10[], char param11, char param12, char param13[], char param14[], char param15[], char param16, char param17, char param18[], char param19[], char param20[], char param21[], char param22[], char param23[], char param24[], int param25, int param26, char param27, char param28[], union { FILE *; __size32; } param29, int param30, char param31, char param32[], char param32, char param33, char param34, char param35[], char param36, char param37[], char param38[], char param39, char param40[], int param41, int param42, int param43, int param44, int param45, int param46, union { char *; __size32; } param47, int param48, __size32 param49, __size32 param50);
void uninstall(char param1[], char param2[], char param3[], char param4[], char param5[], __size32 param6, __size32 param7, char param8[], char param9[], char param10[], char param11[], char param12, char param13[], char param14, char param15[], char param16, unsigned int param17, unsigned int param18, union { char *; __size32; } param19, __size32 param20);
void test_install(char param1[], char param2[], char param3, char param4, char param5, char param6, char param7[], char param8[], char param9[], char param10[], char param11, char param12, char param13[], char param14[], char param15[], char param16, char param17, char param18[], char param19[], char param20[], char param21[], char param22[], char param23[], int param24, int param25, char param26, char param27[], char param28, char param29, char param30, char param31, char param32[], char param33, char param34, char param35[], int param36, int param37, int param38, int param39, int param40, int param41, union { char *; __size32; } param42, int param43, __size32 param44, __size32 param45);
void binaries_exist(__size32 param1, __size32 param2, int param3, char param4, union { char[] *; __size32; } param5, union { char *; __size32; } param6);
void bin_install(char param1[], char param2[], char param3, char param4, char param5, char param6, char param7[], char param8[], char param9[], char param10[], char param11, char param12, char param13[], char param14[], char param15[], char param16, char param17, char param18[], char param19[], char param20[], char param21[], char param22[], char param23[], char param24[], int param25, int param26, char param27, char param28[], union { FILE *; __size32; } param29, int param30, char param31, char param32[], char param32, char param33, char param34, char param35[], char param36[], char param37[], char param38, char param39[], int param40, int param41, union { char[] *; __size32; } param42, int param43, int param44, int param45, int param46, union { char *; __size32; } param47, int param48, __size32 param49, __size32 param50);
__size32 __i686.get_pc_thunk.bx();
__size32 restore_entries_gisman(char param1[], char param2[], char param3, char param4, char param5, char param6, char param7[], char param8[], char param9[], char param10, char param11[], char param12, char param13[], char param14[], char param15[], union { __size32; FILE *; } param16, int param17, int param18, char param19, char param20, char param21, union { char[] *; __size32; } param22, __size8 param23, int param24);
__size32 restore_html(char param1[], char param2, char param3, char param4[], char param5[], __size32 param6, __size32 param7, __size32 param8, __size32 param9, union { __size32; DIR *; } param10, union { __size32; FILE *; } param11, char param12, char param13[], char param14, char param14, char param15, union { char[] *; __size32; } param17, __size32 param17);
void su(char param1[], char param2, union { char[] *; __size32; } param3, union { char *; __size32; } param4);
void print_done();
__size8 dump_ascii(__size32 param1, union { void *; __size32; } param2, __size32 param3, union { __size32; unsigned char *; } param4, char param5[], union { char *; __size32; } param6, union { char[] *; __size32; } param6, __size8 param8, char param8);
void mkdir_s(char param1, union { char[] *; __size32; } param2, union { char[] *; __size32; } param3);
__size32 check_filetype(union { char *; __size32; } param1);
void print_warning(char param1[], union { char *; __size32; } param2, int param3);
__size32 basename(union { char *; __size32; } param1);
__size32 nc_fgets_nb(union { char *; __size32; } param1, int param2, union { FILE *; __size32; } param3);
__size8 chop(union { char *; __size32; } param1);
void list_binaries(int param1, char param2, union { char[] *; __size32; } param3);
__size8 dump_html(char param1[], union { __size32; FILE *; } param2, int param3, char param4[], char param4, union { char *; __size32; } param6, union { char *; __size32; } param6, __size8 param8);
__size8 check_dependencies(char param1[], char param2, char param3, char param2, union { char[] *; __size32; } param5, union { char[] *; __size32; } param6, __size32 param5, __size8 param8, __size32 param9, __size32 param10, __size32 param11);
void print_cfg(char param1);
void register_extension(char param1[], char param2, union { char[] *; __size32; } param3);
void register_entries_gisman(char param1[], char param2[], char param3, char param4, char param5, char param6, char param7[], char param8[], char param9[], char param10, char param11[], char param12, char param13[], char param14[], char param15[], int param16, int param17, char param18, char param19, char param20, int param21, int param22, int param23);
void register_entries_gisman2(char param1[], char param2, char param3, union { char[] *; __size32; } param4, union { char[] *; __size32; } param5);
void register_html(char param1[], char param2, char param3, char param4[], char param5[], char param6, char param7, __size32 param8, int param9, int param10, int param11, int param12);
void deregister_extension(char param1[], char param2, union { char[] *; __size32; } param3);
__size32 deregister_entries_gisman(char param1[], char param2[], __size32 param3, char param4[], char param5, char param6, union { char[] *; __size32; } param7, union { char[] *; __size32; } param8, __size32 param9);
void deregister_entries_gisman2(char param1[], char param2, char param3, union { char[] *; __size32; } param4, union { char[] *; __size32; } param5);
void deregister_html(char param1[], char param2[], __size32 param3, char param4[], char param5, char param6, __size32 param7, union { char[] *; __size32; } param8, __size32 param9);
void dump_plain(char param1[], char param2, union { char *; __size32; } param3, union { char *; __size32; } param4);
void check_ext_menu(char param1[], char param2, char param3, char param4[], __size32 param5, __size32 param6, __size32 param7);
__size32 new_submenu(char param1[], char param2, char param3, char param4[], char param5[], char param6, char param7[], union { char[] *; __size32; } param8, union { char *; __size32; } param9, union { void *; int; } param10, __size32 param11, __size32 param12);
__size32 new_item(char param1[], char param2, char param3, char param4[], char param5, char param6[], char param7[], union { char *; __size32; } param8, __size32 param9, int param10);
void new_ext_html(char param1[], char param2, char param3, char param4[], char param5, union { char[] *; unsigned int; } param6, unsigned int param7, int param8, int param9, int param10, __size32 param11, __size32 param12);
__size32 nc_fgets_html(__size32 param1, union { __size32; void *; } param2, __size32 param3, union { unsigned char *; __size32; } param4, union { unsigned int; char *; } param5, int param6, union { FILE *; __size32; } param7, char param8);
__size32 is_text(union { char *; __size32; } param1);
__size32 nc_fgets(union { char *; __size32; } param1, int param2, union { FILE *; __size32; } param3);
__size32 vercmp(int param1, int param2, int param3, int param4, int param5, int param6);
void depstr(char param1[], int param2, char param3, unsigned char param4, char param5);
__size32 find_pos(union { char *; __size32; } param1, __size32 param2, int param3, __size32 param4, __size32 param5);
__size32 delete_str(char param1[], __size32 param2, int param3, __size32 param4, __size32 param5, __size32 param6, __size32 param7);
void delete_ext_html(char param1[], char param2[], __size32 param3, char param4, union { char[] *; __size32; } param5, __size32 param6, __size32 param7, __size32 param8, __size32 param9);
__size32 insert_str(char param1[], char param2, char param3, char param4, union { int; char *; } param5, int param6, __size32 param7);
__size32 is_submenu(union { char *; __size32; } param1);

/** address: 0x0805331e */
int main(int argc, char *argv[])
{
    __size8 al; 		// r8
    char dl; 		// r10
    __size32 eax; 		// r24
    int eax_10; 		// r24{242}
    int eax_11; 		// r24{135}
    int eax_14; 		// r24{105}
    union { __size32; char *; } eax_17; 		// r24{180}
    int eax_2; 		// r24{212}
    char *eax_20; 		// r24{178}
    size_t eax_22; 		// r24{177}
    union { __size32; char *; } eax_23; 		// r24{188}
    char *eax_26; 		// r24{186}
    size_t eax_28; 		// r24{185}
    int eax_29; 		// r24{314}
    char *eax_3; 		// r24{294}
    DIR *eax_30; 		// r24{328}
    int eax_37; 		// r24{319}
    int eax_39; 		// r24{310}
    int eax_40; 		// r24{298}
    int eax_41; 		// r24{279}
    int eax_42; 		// r24{265}
    int eax_43; 		// r24{167}
    char *eax_44; 		// r24{291}
    struct dirent *eax_46; 		// r24{329}
    int eax_47; 		// r24{385}
    int eax_49; 		// r24{333}
    int eax_52; 		// r24{335}
    struct dirent *eax_56; 		// r24{346}
    int eax_57; 		// r24{456}
    int eax_6; 		// r24{307}
    int eax_7; 		// r24{250}
    int eax_8; 		// r24{247}
    int ebx; 		// r27
    int ecx; 		// r25
    int edx; 		// r26
    int esp; 		// r28
    __size32 esp_1; 		// r28{307}
    union { int; char **; __size32 *; } esp_10; 		// r28{354}
    int esp_13; 		// r28{303}
    union { __size32; FILE **; char **; __size32 *; } esp_20; 		// r28{393}
    unsigned int esp_22; 		// r28{1}
    union { int; char **; __size32 *; } esp_4; 		// r28{307}
    __size32 esp_5; 		// r28{366}
    union { __size32 *; char **; FILE **; __size32; } esp_7; 		// r28{366}
    __size32 esp_8; 		// r28{400}
    int local59; 		// m[esp - 0x3868]
    __size32 local60; 		// m[esp - 0x383c]
    __size32 local61; 		// m[esp - 0x381c]
    int local65; 		// m[esp - 0x3860]
    union { struct dirent *; int; } local69; 		// m[esp - 0x387c]
    int local70; 		// m[esp - 0x3880]
    int local71; 		// m[esp_22 - 0x3860]{216}
    int local72; 		// m[esp_22 - 0x3860]{0}
    int local74; 		// m[esp_22 - 0x3860]{106}
    int local77; 		// m[esp_22 - 0x3860]{213}
    int local81; 		// local71{216}
    union { __size32 *; char **; int; } local82; 		// esp_4{357}
    union { __size32; FILE **; char **; __size32 *; } local83; 		// esp_7{369}
    union { __size32; int *; FILE **; char **; } local84; 		// esp{403}

    *(__size32*)(global_0x08056f68 + 0xc338) = 0;
    *(__size32*)(global_0x08056f68 + 0x11358) = 0;
    *(__size32*)(global_0x08056f68 + 0x1135c) = 0;
    *(__size32*)(global_0x08056f68 + 0x11360) = 0;
    *(__size32*)(global_0x08056f68 + 0x11364) = 0;
    *(__size32*)(global_0x08056f68 + 0x15b78) = 0;
    *(__size32*)(global_0x08056f68 + 0x15b7c) = 0;
    *(__size32*)(global_0x08056f68 + 0x11368) = 0;
    memcpy(0x80682e0, 0x8057925, 1);
    memcpy(0x8068ae0, 0x8057925, 1);
    memcpy(0x8069ae0, 0x8057925, 1);
    memcpy(0x806a2e0, 0x8057925, 1);
    memcpy(0x80692e0, 0x8057925, 1);
    memcpy(0x80632c0, 0x8057925, 1);
    memcpy(0x8063ac0, 0x8057925, 1);
    memcpy(0x80642c0, 0x8057925, 1);
    memcpy(0x8064ac0, 0x8057925, 1);
    memcpy(0x80652c0, 0x8057925, 1);
    memcpy(0x8065ac0, 0x8057925, 1);
    memcpy(0x80662c0, 0x8057925, 1);
    memcpy(0x8066ac0, 0x8057925, 1);
    memcpy(0x8067ac0, 0x8057925, 1);
    memcpy(0x80672c0, 0x8057925, 1);
    memcpy(0x806aae0, 0x8057925, 1);
    memcpy(0x806b2e0, 0x8057926, 10);
    memcpy(0x806bae0, 0x8057930, 5);
    getcwd(0x806c2e0, 0x800);
    eax = *0x8059260;
    fwrite("\1b[0m", 1, 4, eax);
    malloc(0x800);
    eax = *argv;
    strcpy((esp_22 - 0x3018), eax);
    eax = *0x8059260;
    setvbuf(eax, 0, 2, 0);
    if (argc == 1) {
        show_help();
    }
    atexit(0x8049390);
    local59 = 0;
    local60 = 0;
    local61 = 0;
    *(__size32*)(global_0x08056f68 + 0x22fc) = 0;
    *(__size32*)(esp_22 - 0x395c) = 0x805793c;
    eax_14 = getopt_long(argc, argv, ":i:u:q:d:c:C:t:l:m:o:x:rhVg:b:fvs", 0x8059100, &0);
    local65 = eax_14;
    local81 = local74;
bb0x8053a9b:
    local71 = local81;
    if (local71 == -1) {
bb0x8053aa9:
        if (*(esp_22 - 0x3868) <= 0) {
            print_error(*(esp_22 - 0x4178), -1, 0x8057a24, *(esp_22 - 0x395c));
        }
        if (*(esp_22 - 0x3868) > 1) {
            print_error(*(esp_22 - 0x4178), -1, 0x8057a44, *(esp_22 - 0x395c));
        }
        *(int*)(esp_22 - 0x395c) = esp_22 - 0x3818;
        sprintf(0x80622a0, "GEM_C_OPTS=%s", (esp_22 - 0x3818));
        putenv(0x80622a0);
        if (*(esp_22 - 0x3864) == 1) {
            show_help();
        }
        if (*(esp_22 - 0x3864) == 2) {
            show_version();
        }
        eax_10 = *(global_0x08056f68 + 0xc338);
        if (eax_10 == 0) {
            memcpy(0x80672c0, 0x8057a74, 32);
            mkstemp(0x80672c0);
            *(int*)(esp_22 - 0x395c) = 511;
            eax_8 = open(0x80672c0, 64);
            if (eax_8 == -1) {
                eax = __errno_location();
                eax_7 = *eax;
                eax = strerror(eax_7);
                print_error(*(esp_22 - 0x4178), -30, 0x8057a94, eax);
            }
        }
        if (*(esp_22 - 0x3864) == 11) {
            if (*(esp_22 - 0x381c) == 0) {
                eax = getenv("GISBASE");
                *(union { int; char[] *; }*)(esp_22 - 0x381c) = eax;
                if (eax == 0) {
                    print_error(*(esp_22 - 0x4178), -1, 0x8057abc, *(esp_22 - 0x395c));
                }
            }
            eax_42 = *(global_0x08056f68 + 0xc338);
            if (eax_42 != 0) {
                eax = *0x8059260;
                fprintf(eax, "Path to GRASS is %s.\n", *(esp_22 - 0x381c));
            }
            restore(*(esp_22 - 0xa328), *(esp_22 - 0xa318), *(esp_22 - 0x9ae8), *(esp_22 - 0x9ad8), *(esp_22 - 0x9328), *(esp_22 - 0x92e8), *(esp_22 - 0x92d8), *(esp_22 - 0x8af8), *(esp_22 - 0x8ae8), *(esp_22 - 0x8ad8), *(esp_22 - 0x82e8), *(esp_22 - 0x82b8), *(esp_22 - 0x8288), *(esp_22 - 0x7ae8), *(esp_22 - 0x7ab8), *(esp_22 - 0x7a88), *(esp_22 - 0x72b8), *(esp_22 - 0x7288), *(esp_22 - 0x7278), *(esp_22 - 0x6a50), *(esp_22 - 0x6a34), *(esp_22 - 0x6a30), *(esp_22 - 0x6a2c), *(esp_22 - 0x6a1c), *(esp_22 - 0x6a14), *(esp_22 - 0x6a10), *(esp_22 - 0x69fc), *(esp_22 - 0x69f8), *(esp_22 - 0x61f8), *(esp_22 - 0x59f8), *(esp_22 - 0x5238), *(esp_22 - 0x51f8), *(esp_22 - 0x49f8), *(esp_22 - 0x4178), *(esp_22 - 0x381c), *(esp_22 - 0x3820), al, ebx);
            exit(0);
        }
        if (*(esp_22 - 0x3864) == 12) {
            if (*(esp_22 - 0x381c) == 0) {
                eax = getenv("GISBASE");
                *(union { int; char[] *; }*)(esp_22 - 0x381c) = eax;
                if (eax == 0) {
                    print_error(*(esp_22 - 0x4178), -1, 0x8057abc, *(esp_22 - 0x395c));
                }
            }
            eax_41 = *(global_0x08056f68 + 0xc338);
            if (eax_41 != 0) {
                eax = *0x8059260;
                fprintf(eax, "Path to GRASS is %s.\n", *(esp_22 - 0x381c));
            }
            list_extensions(*(esp_22 - 0x4a18), *(esp_22 - 0x4a08), *(esp_22 - 0x4a04), *(esp_22 - 0x4a00), *(esp_22 - 0x49b8), *(esp_22 - 0x4178), *(esp_22 - 0x381c), al, dl);
            exit(0);
        }
        eax = strstr((esp_22 - 0x1018), "http://");
        if (eax == 0) {
            eax = strstr((esp_22 - 0x1018), "ftp://");
            if (eax != 0) {
                goto bb0x8053d3e;
            }
bb0x8053dc9:
            eax_40 = *(global_0x08056f68 + 0xc338);
            if (eax_40 != 0) {
                eax = *0x8059260;
                *(int*)(esp_22 - 0x395c) = esp_22 - 0x1018;
                fprintf(eax, "Extension location is '%s'.\n", (esp_22 - 0x1018));
            }
            esp_13 = esp_22 - 0x3964;
            local82 = esp_13;
            if (*(esp_22 - 0x3864) != 10) {
                *(union { int; void *; }*)(esp_22 - 0x3960) = (esp_22 - 0x38d8);
                eax_6 = __stat(esp_22 - 0x1018, (esp_22 - 0x38d8)); /* Warning: also results in esp_1 */
                local82 = esp_1;
                if (eax_6 < 0) {
                    eax = __errno_location();
                    eax_39 = *eax;
                    strerror(eax_39);
                    print_error(*(esp_22 - 0x4178), -2, 0x8057b44, esp_22 - 0x1018);
                }
                if ((*(esp_22 - 0x38c8) & 0xf000) == 0x4000) {
                    eax_29 = *(global_0x08056f68 + 0xc338);
                    if (eax_29 != 0) {
                        eax = *0x8059260;
                        esp = fwrite("Extension files stored in a directory.\n", 1, 39, eax);
                        local82 = esp;
                    }
                    goto bb0x805402d;
                }
                eax_37 = *(global_0x08056f68 + 0xc338);
                if (eax_37 != 0) {
                    eax = *0x8059260;
                    *(int*)(esp_22 - 0x395c) = 42;
                    *(int*)(esp_22 - 0x3960) = 1;
                    fwrite("Extension files stored in a package file.\n", 1, 42, eax);
                }
                unpack_extension(*(esp_22 - 0x5550), *(esp_22 - 0x49c8), *(esp_22 - 0x4178), esp_22 - 0x1018);
                eax_30 = opendir(0x80632c0);
                eax_46 = readdir(eax_30);
                local69 = eax_46;
                local70 = 0;
                for(;;) {
                    if (*(esp_22 - 0x387c) == 0) {
bb0x8053ff5:
                        esp_10 = strcpy((esp_22 - 0x101c), *(esp_22 - 0x3834));
                        local82 = esp_10;
                        if (*(esp_22 - 0x3880) == 0) {
                            print_error(*(esp_22 - 0x417c), -7, 0x8057bcc, *(esp_22 - 0x3960));
                        }
                        goto bb0x805402d;
                    }
                    eax_49 = strcmp(*(esp_22 - 0x387c) + 11, ".");
                    if (eax_49 != 0) {
                        eax_52 = strcmp(*(esp_22 - 0x387c) + 11, "..");
                        if (eax_52 != 0) {
                            *(int*)(esp_22 - 0x395c) = *(esp_22 - 0x387c) + 11;
                            *(int*)(esp_22 - 0x3960) = 0x80632c0;
                            sprintf(*(esp_22 - 0x3834), "%s/%s", 0x80632c0, *(esp_22 - 0x395c));
                            __stat(*(esp_22 - 0x3834), (esp_22 - 0x3934));
                            if ((*(esp_22 - 0x3924) & 0xf000) == 0x4000) {
                                *(int*)(esp_22 - 0x3880) = 1;
                                goto bb0x8053ff5;
                            }
                        }
                    }
                    eax_56 = readdir(eax_30);
                    *(union { struct dirent *; int; }*)(esp_22 - 0x387c) = eax_56;
                }
            }
bb0x805402d:
            esp_4 = local82;
            if (*(esp_4 + 256) == 10) {
                *(__size32*)(esp_4 + 4) = esp_4 + 0x294c;
                *(__size32*)esp_4 = esp_4 + 0x114c;
                esp = strcpy(*esp_4, *(esp_4 + 4));
                local83 = esp;
bb0x805406d:
                esp_7 = local83;
                if (*(esp_7 + 252) > 0) {
                    if (*(esp_7 + 328) == 0) {
                        *(__size32*)esp_7 = 0x8057ab3;
                        eax = getenv(*esp_7);
                        *(union { char *; __size32; }*)(esp_7 + 328) = eax;
                    }
                    eax = *(esp_7 + 328);
                    *(__size32*)(esp_7 + 12) = eax;
                    eax = *(esp_7 + 296);
                    *(__size32*)(esp_7 + 8) = eax;
                    eax = *(esp_7 + 256);
                    *(__size32*)(esp_7 + 4) = eax;
                    *(__size32*)esp_7 = esp_7 + 0x294c;
                    run_post(*(esp_7 - 0x1014), *(esp_7 - 0x814), *esp_7, *(esp_7 + 4), *(esp_7 + 8), *(esp_7 + 12));
                }
                eax_47 = *(global_0x08056f68 + 0xc338);
                if (eax_47 != 0) {
                    eax = *(global_0x08056f68 + 0x22f8);
                    *(__size32*)(esp_7 + 8) = esp_7 + 0x294c;
                    *(__size32*)(esp_7 + 4) = 0x8057c00;
                    *(__size32*)esp_7 = eax;
                    fprintf(*esp_7, *(esp_7 + 4));
                }
                esp_20 = esp_7;
                local84 = esp_20;
                if (*(esp_7 + 256) != 10) {
                    *(__size32*)(esp_7 + 16) = esp_7 + 284;
                    *(__size32*)(esp_7 + 12) = esp_7 + 288;
                    *(__size32*)(esp_7 + 8) = esp_7 + 292;
                    *(__size32*)(esp_7 + 4) = esp_7 + 0x194c;
                    *(__size32*)esp_7 = esp_7 + 0x294c;
                    esp_8 = esp_7 - 4;
                    check_extension(*(esp_7 - 0x1074), *esp_7);
                    local84 = esp_8;
                }
                esp = local84;
                if (*(esp + 256) == 5) {
                    ecx = *(esp + 284);
                    edx = *(esp + 288);
                    eax = *(esp + 292);
                    *(__size32*)(esp + 28) = esp + 0x214c;
                    *(__size32*)(esp + 24) = esp + 0x94c;
                    *(__size32*)(esp + 20) = esp + 0x114c;
                    *(__size32*)(esp + 16) = ecx;
                    *(__size32*)(esp + 12) = edx;
                    *(__size32*)(esp + 8) = eax;
                    *(__size32*)(esp + 4) = esp + 0x194c;
                    *(__size32*)esp = esp + 0x294c;
                    query_extension(*(esp - 0x10d4), *(esp - 0x10c8), *(esp - 0x10c4), *(esp - 0x10c0), *(esp - 0x10bc), *(esp - 0x1074), *(esp - 0x814), *esp, *(esp + 4), *(esp + 8), *(esp + 12), *(esp + 16), *(esp + 24), *(esp + 28), dl);
                }
                if (*(esp + 256) == 9) {
                    *(__size32*)esp = esp + 0x294c;
                    show_details(*(esp - 0x10b4), *(esp - 0x10a4), *(esp - 0x10a0), *(esp - 0x109c), *(esp - 0x1054), *(esp - 0x814), *esp, dl);
                }
                if (*(esp + 256) == 7) {
                    *(__size32*)esp = esp + 0x294c;
                    show_license(*(esp - 0x10b4), *(esp - 0x10a4), *(esp - 0x10a0), *(esp - 0x109c), *(esp - 0x1054), *(esp - 0x814), *esp, dl);
                }
                if (*(esp + 256) == 6) {
                    *(__size32*)esp = esp + 0x294c;
                    source_clean(*(esp - 0x1854), *(esp - 0x1014), *(esp - 0x814), *esp);
                    *(__size32*)(esp - 4) = 0;
                    exit(*(esp - 4));
                }
                if (*(esp + 328) == 0) {
                    *(__size32*)esp = 0x8057ab3;
                    eax = getenv(*esp);
                    *(union { char *; __size32; }*)(esp + 328) = eax;
                    if (*(esp + 328) == 0) {
                        *(__size32*)(esp + 4) = 0x8057abc;
                        *(__size32*)esp = -1;
                        print_error(*(esp - 0x814), *esp, *(esp + 4), *(esp + 8));
                    }
                }
                eax_57 = *(global_0x08056f68 + 0xc338);
                if (eax_57 != 0) {
                    eax = *(global_0x08056f68 + 0x22f8);
                    ecx = *(esp + 328);
                    *(__size32*)(esp + 8) = ecx;
                    *(__size32*)(esp + 4) = 0x8057aff;
                    *(__size32*)esp = eax;
                    fprintf(*esp, *(esp + 4));
                }
                *(__size32*)esp = 0x8057c27;
                eax = getenv(*esp);
                *(union { char *; __size32; }*)(esp + 324) = eax;
                if (*(esp + 324) == 0) {
                    edx = *(esp + 328);
                    *(__size32*)(esp + 8) = edx;
                    *(__size32*)(esp + 4) = 0x8057c35;
                    *(__size32*)esp = esp + 0x314c;
                    sprintf(*esp, *(esp + 4));
                    *(__size32*)(esp + 4) = 0x80578de;
                    *(__size32*)esp = esp + 0x314c;
                    %eax = fopen(*esp, *(esp + 4));
                    *(union { FILE *; __size32; }*)(esp + 280) = %eax;
                    if (*(esp + 280) == 0) {
                        *(__size32*)(esp + 4) = 0x8057c4c;
                        *(__size32*)esp = -11;
                        print_error(*(esp - 0x814), *esp, *(esp + 4), *(esp + 8));
                    }
                    *(__size32*)esp = 16;
                    eax = malloc(*esp);
                    *(union { void *; __size32; }*)(esp + 324) = eax;
                    edx = *(esp + 324);
                    *(__size32*)(esp + 8) = edx;
                    *(__size32*)(esp + 4) = 0x8057c8b;
                    eax = *(esp + 280);
                    *(__size32*)esp = eax;
                    eax = __isoc99_fscanf();
                    *(__size32*)(esp + 248) = eax;
                    eax = *(esp + 280);
                    *(__size32*)esp = eax;
                    fclose(*esp);
                    if (*(esp + 248) <= 0) {
                        *(__size32*)(esp + 4) = 0x8057c4c;
                        *(__size32*)esp = -11;
                        print_error(*(esp - 0x814), *esp, *(esp + 4), *(esp + 8));
                    }
                }
                if ( ~flags) {
                    *(__size32*)%esp = %eax;
                    strdup(*(%esp + 4));
                    *(__size32*)(%esp + 308) = %eax;
                    *(__size32*)(%esp + 4) = %eax;
                    *(__size32*)%esp = %eax;
                    strtok(*(%esp + 4), *(%esp + 8));
                    *(__size32*)(%esp + 320) = %eax;
                    *(__size32*)(%esp + 4) = %eax;
                    *(__size32*)%esp = 0;
                    strtok(*(%esp + 4), *(%esp + 8));
                    *(__size32*)(%esp + 316) = %eax;
                    *(__size32*)(%esp + 4) = %eax;
                    *(__size32*)%esp = 0;
                    strtok(*(%esp + 4), *(%esp + 8));
                    *(__size32*)(%esp + 312) = %eax;
                    *(__size32*)(%esp + 8) = 10;
                    *(__size32*)(%esp + 4) = 0;
                    *(__size32*)%esp = %eax;
                    strtol(*(%esp + 4), *(%esp + 8), *(%esp + 12));
                    *(__size32*)(%esp + 272) = %eax;
                    *(__size32*)(%esp + 8) = 10;
                    *(__size32*)(%esp + 4) = 0;
                    *(__size32*)%esp = %eax;
                    strtol(*(%esp + 4), *(%esp + 8), *(%esp + 12));
                    *(__size32*)(%esp + 268) = %eax;
                    *(__size32*)(%esp + 8) = 10;
                    *(__size32*)(%esp + 4) = 0;
                    *(__size32*)%esp = %eax;
                    strtol(*(%esp + 4), *(%esp + 8), *(%esp + 12));
                    *(__size32*)(%esp + 264) = %eax;
                    *(__size32*)%esp = 0x800;
                    malloc(*(%esp + 4));
                    *(__size32*)(%esp + 324) = %eax;
                    *(__size32*)(%esp + 16) = %edx;
                    *(__size32*)(%esp + 12) = %edx;
                    *(__size32*)(%esp + 8) = %edx;
                    *(__size32*)(%esp + 4) = %eax;
                    *(__size32*)%esp = %eax;
                    sprintf(*(%esp + 4), *(%esp + 8));
                    if ( ~flags) {
                        *(__size32*)(%esp + 8) = %ecx;
                        *(__size32*)(%esp + 4) = %edx;
                        *(__size32*)%esp = %eax;
                        fprintf(*(%esp + 4), *(%esp + 8));
                    }
                    if ( ~flags) {
                        *(__size32*)(%esp + 4) = 0x8057cb0;
                        *(__size32*)%esp = -11;
                        print_error(*(%esp - 0x810), *(%esp + 4), *(%esp + 8), *(%esp + 12));
                    }
                }
                *(__size32*)(%esp + 8) = %edx;
                *(__size32*)(%esp + 4) = %eax;
                *(__size32*)%esp = %eax;
                sprintf(*(%esp + 4), *(%esp + 8));
                if ( ~flags) {
                    *(__size32*)(%esp + 24) = %ebx;
                    *(__size32*)(%esp + 20) = %ecx;
                    *(__size32*)(%esp + 16) = %edx;
                    *(__size32*)(%esp + 12) = %eax;
                    *(__size32*)(%esp + 8) = %eax;
                    *(__size32*)(%esp + 4) = %eax;
                    *(__size32*)%esp = %eax;
                    source_install(*(%esp - 0x7a14), *(%esp - 0x7a04), *(%esp - 0x71d4), *(%esp - 0x71c4), *(%esp - 0x69d4), *(%esp - 0x69c4), *(%esp - 0x61f4), *(%esp - 0x61e4), *(%esp - 0x61d4), *(%esp - 0x61c4), *(%esp - 0x59b4), *(%esp - 0x59a4), *(%esp - 0x5974), *(%esp - 0x5970), *(%esp - 0x5950), *(%esp - 0x51b4), *(%esp - 0x51a4), *(%esp - 0x5174), *(%esp - 0x49b4), *(%esp - 0x49a4), *(%esp - 0x4974), *(%esp - 0x4144), *(%esp - 0x4134), *(%esp - 0x4120), *(%esp - 0x4104), *(%esp - 0x40e8), *(%esp - 0x40e4), *(%esp - 0x3924), *(%esp - 0x3900), *(%esp - 0x38ec), *(%esp - 0x38e4), *(%esp - 0x30f4), *(%esp - 0x30f0), *(%esp - 0x30e4), *(%esp - 0x30e0), *(%esp - 0x2810), *(%esp - 0x2010), *(%esp - 0x1810), *(%esp - 0x1010), *(%esp - 0x810), *(%esp + 4), *(%esp + 8), *(%esp + 12), *(%esp + 16), *(%esp + 20), *(%esp + 24), *(%esp + 28), %ebx, %esi, %edi, *(%esp - 0x38e0));
                    *(__size32*)%esp = 0;
                    exit(*(%esp + 4));
                }
                if ( ~flags) {
                    *(__size32*)(%esp + 12) = %eax;
                    *(__size32*)(%esp + 8) = %eax;
                    *(__size32*)(%esp + 4) = %eax;
                    *(__size32*)%esp = %eax;
                    uninstall(*(%esp - 0x4170), *(%esp - 0x31e4), *(%esp - 0x31c4), *(%esp - 0x31b4), *(%esp - 0x3194), *(%esp - 0x29cc), *(%esp - 0x29ac), *(%esp - 0x2964), *(%esp - 0x2944), *(%esp - 0x2904), *(%esp - 0x2144), *(%esp - 0x2104), *(%esp - 0x1904), *(%esp - 0x1900), *(%esp - 0x1010), *(%esp - 0x810), *(%esp + 8), *(%esp + 12), *(%esp + 16), %ebx);
                    *(__size32*)%esp = 0;
                    exit(*(%esp + 4));
                }
                if ( ~flags) {
                    *(__size32*)(%esp + 24) = %ebx;
                    *(__size32*)(%esp + 20) = %ecx;
                    *(__size32*)(%esp + 16) = %edx;
                    *(__size32*)(%esp + 12) = %eax;
                    *(__size32*)(%esp + 8) = %eax;
                    *(__size32*)(%esp + 4) = %eax;
                    *(__size32*)%esp = %eax;
                    test_install(*(%esp - 0x6a04), *(%esp - 0x69f4), *(%esp - 0x61c4), *(%esp - 0x61b4), *(%esp - 0x59c4), *(%esp - 0x59b4), *(%esp - 0x51e4), *(%esp - 0x51d4), *(%esp - 0x51c4), *(%esp - 0x51b4), *(%esp - 0x49a4), *(%esp - 0x4994), *(%esp - 0x4964), *(%esp - 0x4960), *(%esp - 0x4940), *(%esp - 0x41a4), *(%esp - 0x4194), *(%esp - 0x4164), *(%esp - 0x39a4), *(%esp - 0x3994), *(%esp - 0x3964), *(%esp - 0x3134), *(%esp - 0x3124), *(%esp - 0x30f4), *(%esp - 0x30d8), *(%esp - 0x30d4), *(%esp - 0x2910), *(%esp - 0x28d4), *(%esp - 0x20e4), *(%esp - 0x20e0), *(%esp - 0x20d4), *(%esp - 0x20d0), *(%esp - 0x1810), *(%esp - 0x1010), *(%esp - 0x810), *(%esp + 4), *(%esp + 8), *(%esp + 12), *(%esp + 16), *(%esp + 20), *(%esp + 24), *(%esp + 28), %ebx, %esi, %edi);
                    *(__size32*)%esp = 0;
                    exit(*(%esp + 4));
                }
                if ( ~flags) {
                    *(__size32*)(%esp + 4) = %eax;
                    *(__size32*)%esp = %eax;
                    binaries_exist(*(%esp - 0x894), *(%esp - 0x890), *(%esp - 0x860), *(%esp - 0x810), *(%esp + 4), *(%esp + 8));
                    if ( ~flags) {
                        *(__size32*)(%esp + 28) = %ebx;
                        *(__size32*)(%esp + 24) = %ecx;
                        *(__size32*)(%esp + 20) = %edx;
                        *(__size32*)(%esp + 16) = %eax;
                        *(__size32*)(%esp + 12) = %eax;
                        *(__size32*)(%esp + 8) = %eax;
                        *(__size32*)(%esp + 4) = %eax;
                        *(__size32*)%esp = %eax;
                        bin_install(*(%esp - 0x7224), *(%esp - 0x7214), *(%esp - 0x69e4), *(%esp - 0x69d4), *(%esp - 0x61e4), *(%esp - 0x61d4), *(%esp - 0x5a04), *(%esp - 0x59f4), *(%esp - 0x59e4), *(%esp - 0x59d4), *(%esp - 0x51c4), *(%esp - 0x51b4), *(%esp - 0x5184), *(%esp - 0x5180), *(%esp - 0x5160), *(%esp - 0x49c4), *(%esp - 0x49b4), *(%esp - 0x4984), *(%esp - 0x41c4), *(%esp - 0x41b4), *(%esp - 0x4184), *(%esp - 0x3954), *(%esp - 0x3944), *(%esp - 0x3930), *(%esp - 0x3914), *(%esp - 0x38f8), *(%esp - 0x38f4), *(%esp - 0x3134), *(%esp - 0x3110), *(%esp - 0x30fc), *(%esp - 0x30f4), *(%esp - 0x2904), *(%esp - 0x2900), *(%esp - 0x28f4), *(%esp - 0x28f0), *(%esp - 0x2010), *(%esp - 0x1810), *(%esp - 0x1010), *(%esp - 0x810), *(%esp + 4), *(%esp + 8), *(%esp + 12), *(%esp + 16), *(%esp + 20), *(%esp + 24), *(%esp + 28), *(%esp + 32), %ebx, %esi, %edi, *(%esp - 0x30f0));
                        *(__size32*)%esp = 0;
                        exit(*(%esp + 4));
                    }
                    *(__size32*)(%esp + 8) = %eax;
                    *(__size32*)(%esp + 4) = 0x8057d11;
                    *(__size32*)%esp = -12;
                    print_error(*(%esp - 0x810), *(%esp + 4), *(%esp + 8), *(%esp + 12));
                }
                *(__size32*)%esp = 0;
                exit(*(%esp + 4));
            }
            *(__size32*)(esp_4 + 4) = esp_4 + 0x114c;
            *(__size32*)esp_4 = esp_4 + 0x294c;
            esp_5 = esp_4 - 4;
            get_package_name(*(esp_4 - 0x1854), *(esp_4 - 0x1014), *(esp_4 - 0x814), *esp_4, *(esp_4 + 4));
            local83 = esp_5;
            goto bb0x805406d;
        }
bb0x8053d3e:
        wget_extension(*(esp_22 - 0x49b8), *(esp_22 - 0x4178), esp_22 - 0x1018);
        eax_44 = malloc(0x800);
        *(union { char *; __size32; }*)(esp_22 - 0x3834) = eax_44;
        strcpy(eax_44, (esp_22 - 0x1018));
        eax_3 = strrchr(eax_44, 47);
        strcpy((esp_22 - 0x1018), eax_3 + 1);
        free(eax_44);
        goto bb0x8053dc9;
    }
    if (local71 == 63) {
        print_error(*(esp_22 - 0x4178), -1, 0x8057960, *(esp_22 - 0x395c));
    }
    if (local71 == 58) {
        eax = *(global_0x08056f68 + 0x22d8);
        if (eax != 105) {
            eax = *(global_0x08056f68 + 0x22d8);
            if (eax != 117) {
                eax = *(global_0x08056f68 + 0x22d8);
                if (eax != 100) {
                    eax = *(global_0x08056f68 + 0x22d8);
                    if (eax != 99) {
                        eax = *(global_0x08056f68 + 0x22d8);
                        if (eax != 116) {
                            eax = *(global_0x08056f68 + 0x22d8);
                            if (eax != 108) {
                                eax = *(global_0x08056f68 + 0x22d8);
                                if (eax == 114) {
                                    goto bb0x8053738;
                                }
                                eax = *(global_0x08056f68 + 0x22d8);
                                if (eax == 103) {
                                    print_error(*(esp_22 - 0x4178), -1, 0x80579a9, *(esp_22 - 0x395c));
                                }
                                eax = *(global_0x08056f68 + 0x22d8);
                                if (eax == 98) {
                                    print_error(*(esp_22 - 0x4178), -1, 0x80579c4, *(esp_22 - 0x395c));
                                }
                                eax = *(global_0x08056f68 + 0x22d8);
                                if (eax == 98) {
                                    print_error(*(esp_22 - 0x4178), -1, 0x80579ea, *(esp_22 - 0x395c));
                                }
                                eax_11 = *(global_0x08056f68 + 0x22d8);
                                if (eax_11 == 113) {
                                    *(int*)(esp_22 - 0x3864) = 12;
                                    *(int*)(esp_22 - 0x3868)++;
                                    goto bb0x8053aa9;
                                }
                                goto bb0x80537c8;
                            }
                        }
                    }
                }
            }
        }
bb0x8053738:
        print_error(*(esp_22 - 0x4178), -1, 0x8057988, *(esp_22 - 0x395c));
    }
bb0x80537c8:
    if ( ~(local71 == 105 || local71 == 117 || local71 == 113 || local71 == 100 || local71 == 99 || local71 == 116 || local71 == 108 || local71 == 114)) {
        if (local71 != 104 && local71 != 86) {
bb0x805391e:
            if (local71 == 103) {
                eax = *0x8059280;
                eax_22 = strlen(eax);
                eax_20 = malloc(eax_22 + 1);
                *(union { char[] *; int; }*)(esp_22 - 0x381c) = eax_20;
                eax_17 = *0x8059280;
                strcpy(eax_20, eax_17);
            }
            if (local71 == 98) {
                eax = *0x8059280;
                eax_28 = strlen(eax);
                eax_26 = malloc(eax_28 + 1);
                *(union { char *; __size32; }*)(esp_22 - 0x383c) = eax_26;
                eax_23 = *0x8059280;
                strcpy(eax_26, eax_23);
                *(int*)(esp_22 - 0x3864) = 4;
            }
            if (local71 == 120) {
                eax = *0x8059280;
                strcpy(0x806aae0, eax);
            }
            if (local71 == 102) {
                *(__size32*)(global_0x08056f68 + 0x11360) = 1;
            }
            if (local71 == 118) {
                *(__size32*)(global_0x08056f68 + 0xc338) = 1;
            }
            if (local71 == 115) {
                *(__size32*)(global_0x08056f68 + 0x11368) = 1;
            }
            if (local71 == 111) {
                eax = *0x8059280;
                strcat((esp_22 - 0x3818), eax);
            }
            if (local71 == 67) {
                eax = *0x8059280;
                strcpy(0x806b2e0, eax);
            }
            if (local71 == 109) {
                eax = *0x8059280;
                strcpy(0x806bae0, eax);
            }
            *(__size32*)(esp_22 - 0x395c) = 0x8057a06;
            eax_2 = getopt_long(argc, argv, ":i:u:q:d:c:t:l:o:x:rhVg:b:fvs", 0x8059100, &0);
            local77 = eax_2;
            local81 = local77;
            goto bb0x8053a9b;
        }
    }
    *(int*)(esp_22 - 0x3868)++;
    if ((unsigned int)(local71 - 86) > 31) {
bb0x80538e5:
        eax_43 = *(global_0x08056f68 + 0x2318);
        if (eax_43 != 0) {
            eax = *0x8059280;
            strcpy((esp_22 - 0x1018), eax);
            eax = *0x8059280;
            strcpy((esp_22 - 0x1818), eax);
            goto bb0x805391e;
        }
        goto bb0x805391e;
    }
    switch(local72) {
    case 86:
    case 87:
        goto bb0x80538e5;
    case 88:
        goto bb0x80538e5;
    case 89:
        goto bb0x80538e5;
    case 90:
        goto bb0x80538e5;
    case 91:
        goto bb0x80538e5;
    case 92:
        goto bb0x80538e5;
    case 93:
        goto bb0x80538e5;
    case 94:
        goto bb0x80538e5;
    case 95:
        goto bb0x80538e5;
    case 96:
        goto bb0x80538e5;
    case 97:
        goto bb0x80538e5;
    case 98:
        goto bb0x80538e5;
    case 99:
        *(int*)(esp_22 - 0x3864) = 6;
        goto bb0x80538e5;
    case 100:
        *(int*)(esp_22 - 0x3864) = 9;
        goto bb0x80538e5;
    case 101:
        goto bb0x80538e5;
    case 102:
        goto bb0x80538e5;
    case 103:
        goto bb0x80538e5;
    case 104:
        *(int*)(esp_22 - 0x3864) = 1;
        goto bb0x80538e5;
    case 105:
        if (*(esp_22 - 0x3864) != 4) {
            *(int*)(esp_22 - 0x3864) = 3;
            goto bb0x80538e5;
        }
        goto bb0x80538e5;
    case 106:
        goto bb0x80538e5;
    case 107:
        goto bb0x80538e5;
    case 108:
        *(int*)(esp_22 - 0x3864) = 7;
        goto bb0x80538e5;
    case 109:
        goto bb0x80538e5;
    case 110:
        goto bb0x80538e5;
    case 111:
        goto bb0x80538e5;
    case 112:
        goto bb0x80538e5;
    case 113:
        *(int*)(esp_22 - 0x3864) = 5;
        goto bb0x80538e5;
    case 114:
        *(int*)(esp_22 - 0x3864) = 11;
        goto bb0x80538e5;
    case 115:
        goto bb0x80538e5;
    case 116:
        *(int*)(esp_22 - 0x3864) = 8;
        goto bb0x80538e5;
    case 117:
        *(int*)(esp_22 - 0x3864) = 10;
        goto bb0x80538e5;
    }
    *(int*)(esp_22 - 0x3864) = 2;
    goto bb0x80538e5;
}

/** address: 0x08052a50 */
void show_help()
{
    __size32 eax; 		// r24

    eax = *0x8059260;
    fwrite("Usage: gem64 [OPTION] [ACTION] [FILE|DIR]\n", 1, 42, eax);
    eax = *0x8059260;
    fwrite("Install a GRASS extension from FILE or DIR.\n", 1, 44, eax);
    eax = *0x8059260;
    fwrite("Manage (installed) GRASS extension(s).\n", 1, 39, eax);
    eax = *0x8059260;
    fwrite("\nPossible ACTIONs are:\n", 1, 23, eax);
    eax = *0x8059260;
    fwrite("  -i, --install=EXT\tinstall a GRASS extension\n", 1, 46, eax);
    eax = *0x8059260;
    fwrite("  -u, --uninstall=EXT\tremove an extension from GRASS\n", 1, 53, eax);
    eax = *0x8059260;
    fwrite("  -q, --query=EXT\tdisplay information about extension/list installed\n", 1, 69, eax);
    eax = *0x8059260;
    fwrite("  -d, --details=EXT\tdisplay additional details about an extension\n", 1, 66, eax);
    eax = *0x8059260;
    fwrite("  -c, --clean=EXT\tclean extension's source code directories\n", 1, 60, eax);
    eax = *0x8059260;
    fwrite("  -t, --test=EXT\tconfigure and compile extension, but don't install\n", 1, 68, eax);
    eax = *0x8059260;
    fwrite("  -l, --license=EXT\tshow copyright information for an extension\n", 1, 64, eax);
    eax = *0x8059260;
    fwrite("  -r, --restore\t\trecreate HTML links and GIS Manager entries\n", 1, 61, eax);
    eax = *0x8059260;
    fwrite("  -h, --help\t\tdisplay this help and exit\n", 1, 41, eax);
    eax = *0x8059260;
    fwrite("  -V, --version\t\toutput version information and exit\n\n", 1, 54, eax);
    eax = *0x8059260;
    fwrite("\nPossible OPTIONs are:\n", 1, 23, eax);
    eax = *0x8059260;
    fwrite("  -g, --grass=PATH\tpath to GRASS installation dir\n", 1, 50, eax);
    eax = *0x8059260;
    fwrite("  -b, --binary=NAME\tno compilation: use binary files for system NAME\n", 1, 69, eax);
    eax = *0x8059260;
    fwrite("  -f, --force\t\tforce action, regardless of dependencies\n", 1, 56, eax);
    eax = *0x8059260;
    fwrite("  -v, --verbose\t\tdisplay detailed status information\n", 1, 53, eax);
    eax = *0x8059260;
    fwrite("  -s, --skip-config\tskip configure script\n", 1, 42, eax);
    eax = *0x8059260;
    fwrite("  -x, --config-opts=OPTS\tpass OPTS to configure script\n", 1, 55, eax);
    eax = *0x8059260;
    fwrite("  -o, --options=OPTS\toptions to pass to the C compiler/linker\n", 1, 62, eax);
    eax = *0x8059260;
    fwrite("  -C, --config-cmd=CMD\tDefine custom 'configure' command (default=configure)\n", 1, 77, eax);
    eax = *0x8059260;
    fwrite("  -m, --make-cmd=CMD\tDefine custom 'make' command (default=make)\n", 1, 65, eax);
    eax = *0x8059260;
    fwrite("\nWhen run from within a GRASS session, locations of libs, header files\n", 1, 71, eax);
    eax = *0x8059260;
    fwrite("and installation target dir will be assumed to match those of the active\n", 1, 73, eax);
    eax = *0x8059260;
    fwrite("GRASS version. ", 1, 15, eax);
    eax = *0x8059260;
    fwrite("Option -g can be used to override these or install extensions\nfrom outside", 1, 74, eax);
    eax = *0x8059260;
    fwrite("of a GRASS session.\n", 1, 20, eax);
    eax = *0x8059260;
    fwrite("Per default, extensions will be compiled from source and then installed.\n", 1, 73, eax);
    eax = *0x8059260;
    fwrite("If the exension package contains binaries for the user's platform, they can\n", 1, 76, eax);
    eax = *0x8059260;
    fwrite("be installed instead using the -b option. ", 1, 42, eax);
    eax = *0x8059260;
    fwrite("For installation from source code, a C compiler and make tools are needed.\n", 1, 75, eax);
    eax = *0x8059260;
    fwrite("\nExample:\n", 1, 10, eax);
    eax = *0x8059260;
    fwrite("\tgem64 -b macosx --grass=/usr/local/grass-6.4.0 -i myExtension\n", 1, 63, eax);
    eax = *0x8059260;
    fwrite("Installs the MacOS X binaries for 'myExtension' in /usr/local/grass-6.4.0.\n", 1, 75, eax);
    exit(0);
    return;
}

/** address: 0x08054750 */
__size32 atexit(union { atexitfunc; __size32; } param1)
{
    int eax; 		// r24
    int ebx; 		// r27
    int ecx; 		// r25
    int edx; 		// r26

    __i686.get_pc_thunk.bx();
    eax = *(ebx + 0x4897);
    if (eax != 0) {
        eax = *eax;
    }
    ecx = __cxa_atexit(param1, 0, eax); /* Warning: also results in edx */
    return ecx; /* WARNING: Also returning: edx := edx */
}

/** address: 0x08049420 */
void print_error(char param1[], int param2, union { char *; __size32; } param3, int param4)
{
    __size32 eax; 		// r24

    vsprintf(&param1, param3, &param4);
    eax = *0x8059244;
    fprintf(eax, "\1b[1;31m\nERROR:\1b[0m %s", &param1);
    ERROR = param2;
    exit(param2);
    return;
}

/** address: 0x08053170 */
void show_version()
{
    __size32 eax; 		// r24

    eax = *0x8059260;
    fprintf(eax, "gem64 (GRASS extensions manager) %.2f\n", 1.03);
    eax = *0x8059260;
    fwrite("Written by Benjamin Ducke\n", 1, 26, eax);
    eax = *0x8059260;
    fwrite("\nCopyright (C) 2005 Benjamin Ducke\n", 1, 35, eax);
    eax = *0x8059260;
    fwrite("This is free software; see the source for copying conditions.  There is NO\n", 1, 75, eax);
    eax = *0x8059260;
    fwrite("warranty; not even for MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.\n", 1, 76, eax);
    exit(0);
    return;
}

/** address: 0x08052334 */
void restore(char param1[], char param2[], char param3, char param4, char param5[], char param6, char param7, char param8[], char param9[], char param10[], char param11, char param12, char param13[], char param14[], char param15, char param16[], char param17[], char param18[], char param19[], __size32 param20, __size32 param21, __size32 param22, __size32 param23, union { DIR *; __size32; } param24, union { FILE *; __size32; } param25, int param26, int param27, char param28, char param29[], char param30, char param31[], char param32, char param33, char param34, int param35, union { char *; __size32; } param36, __size8 param37, int param38)
{
    __size32 eax; 		// r24
    union { FILE *; int; } eax_13; 		// r24{48}
    int eax_17; 		// r24{51}
    char *eax_2; 		// r24{40}
    union { FILE *; int; } eax_20; 		// r24{53}
    int eax_24; 		// r24{55}
    union { FILE *; int; } eax_27; 		// r24{57}
    char *eax_4; 		// r24{41}
    char *eax_5; 		// r24{42}
    int eax_6; 		// r24{44}
    int eax_9; 		// r24{45}
    int esp; 		// r28
    __size32 esp_1; 		// r28{65}
    __size32 esp_2; 		// r28{59}
    union { int *; __size32; } local49; 		// esp{67}

    eax_2 = strdup(param36);
    eax_4 = strtok(eax_2, ".");
    eax_5 = strtok(0, ".");
    eax = strtok(0, ".");
    eax_6 = strtol(eax_4, 0, 10);
    eax_9 = strtol(eax_5, 0, 10);
    strtol(eax, 0, 10);
    free(eax_2);
    eax_13 = *0x8059260;
    fwrite("Restoring...", 1, 12, eax_13);
    if ( ~(eax_6 != 6 || eax_9 > 0)) {
        eax_17 = restore_entries_gisman(param1, param2, param3, param4, param6, param7, param8, param9, param10, param12, param13, param15, param16, param17, param18, param25, param26, param27, param29, param30, param33, param35, param37, param38);
        if (VERBOSE != 0) {
            eax_20 = *0x8059260;
            fprintf(eax_20, "\nRestored entries for GIS Manager: %i\n", eax_17);
        }
    }
    eax_24 = restore_html(param5, param9, param11, param14, param19, param20, param21, param22, param23, param24, param25, param28, param29, param32, param33, param35, param38, param30);
    if (VERBOSE != 0) {
        eax_27 = *0x8059260;
        fprintf(eax_27, "\nRestored links in index.hml: %i\n", eax_24);
    }
    esp_2 = esp - 0x87c;
    local49 = esp_2;
    if (eax_24 > 0) {
        if (VERBOSE == 0) {
            sprintf(&param34, "cp -f %s %s/etc/dm/menu.tcl ; chmod a+r %s/etc/dm/menu.tcl &> %s ; \t\t\t\t\t\t\tcp -f %s %s/docs/html/index.html ; chmod a+r %s/docs/html/index.html", 0x80642c0, param35, param35, 0x80672c0, 0x8067ac0, param35, param35);
        }
        else {
            sprintf(&param34, "cp -f %s %s/etc/dm/menu.tcl ; chmod a+r %s/etc/dm/menu.tcl ; \t\t\t\t\t\t\tcp -f %s %s/docs/html/index.html ; chmod a+r %s/docs/html/index.html", 0x80642c0, param35, param35, 0x8067ac0, param35, param35);
        }
        esp_1 = (esp - 0x880);
        su(param31, param33, param35, esp - 0x810);
        local49 = esp_1;
    }
    esp = local49;
    if (eax_24 == 0) {
        *(__size32*)(esp + 4) = 0x8056df0;
        *(__size32*)esp = -26;
        print_error(*(esp - 0x814), *esp, *(esp + 4), *(esp + 8));
    }
    print_done();
    if ( ~flags) {
        __stack_chk_fail();
    }
    return;
}

/** address: 0x080525fc */
void list_extensions(__size32 param1, union { __size32; void *; } param2, __size32 param3, union { unsigned char *; __size32; } param4, char param5[], char param6, union { char[] *; __size32; } param7, __size8 param8, char param9)
{
    __size32 eax; 		// r24
    __size32 eax_10; 		// r24{18}
    union { __size32; FILE *; } eax_11; 		// r24{20}
    int eax_2; 		// r24{11}
    union { __size32; FILE *; } eax_5; 		// r24{12}
    FILE *eax_6; 		// r24{15}
    union { __size32; __size32 *; } eax_9; 		// r24{17}
    int esp; 		// r28

    eax_2 = *20;
    eax_5 = *0x8059260;
    fprintf(eax_5, "\nExtensions in '%s' (name, version, type, depends):\n", param7);
    sprintf(&param6, "%s/etc/extensions.db", param7);
    eax_6 = fopen(&param6, "r");
    if (eax_6 == 0) {
        eax_9 = __errno_location();
        eax_10 = *eax_9;
        if (eax_10 == 2) {
            eax_11 = *0x8059244;
            fwrite("NONE.\n", 1, 6, eax_11);
            fclose(eax_6);
            exit(0);
        }
        fclose(eax_6);
        eax = __errno_location();
        eax = *eax;
        strerror(eax);
        print_error(param5, -29, 0x8056e69, esp - 0x810);
    }
    fclose(eax_6);
    dump_ascii(param1, param2, param3, param4, esp - 0x810, 0x805698c, param8, param9, param5);
    eax = eax_2 ^ *20;
    if (eax != 0) {
        __stack_chk_fail();
    }
    return;
}

/** address: 0x0804ab6c */
void wget_extension(char param1[], char param2, union { char[] *; __size32; } param3)
{
    __size32 eax; 		// r24
    int eax_1; 		// r24{5}
    union { __size32; FILE *; } eax_4; 		// r24{6}
    int eax_5; 		// r24{12}
    int esp; 		// r28

    eax_1 = *20;
    eax_4 = *0x8059260;
    fwrite("Downloading...", 1, 14, eax_4);
    if (VERBOSE == 0) {
        sprintf(&param2, "wget -N -q %s", param3);
    }
    else {
        sprintf(&param2, "wget -N %s", param3);
    }
    eax_5 = system(&param2);
    if (eax_5 == -1) {
        print_error(param1, -20, 0x8054c24, param3);
    }
    if (eax_5 > 0) {
        print_error(param1, -20, 0x8054c62, esp - 0x810);
    }
    print_done();
    eax = eax_1 ^ *20;
    if (eax != 0) {
        __stack_chk_fail();
    }
    return;
}

/** address: 0x08054790 */
__size32 __stat(union { char *; __size32; } param1, union { struct stat *; __size32; } param2)
{
    int eax; 		// r24
    int ecx; 		// r25
    int edx; 		// r26

    __i686.get_pc_thunk.bx();
    eax = stat(3, param1, param2); /* Warning: also results in ecx, edx */
    return eax; /* WARNING: Also returning: ecx := ecx, edx := edx */
}

/** address: 0x0804faab */
void unpack_extension(char param1, char param2[], char param3, union { char[] *; __size32; } param4)
{
    __size32 eax; 		// r24
    union { __size32; FILE *; } eax_10; 		// r24{22}
    int eax_11; 		// r24{29}
    int eax_12; 		// r24{36}
    union { __size32; char[] *; } eax_15; 		// r24{44}
    union { __size32; char[] *; } eax_16; 		// r24{51}
    union { __size32; char[] *; } eax_17; 		// r24{47}
    union { __size32; char[] *; } eax_18; 		// r24{58}
    union { __size32; char[] *; } eax_19; 		// r24{54}
    int eax_2; 		// r24{6}
    union { __size32; char[] *; } eax_20; 		// r24{65}
    union { __size32; char[] *; } eax_21; 		// r24{61}
    int eax_22; 		// r24{70}
    union { __size32; FILE *; } eax_5; 		// r24{7}
    int eax_7; 		// r24{11}
    int local11; 		// m[esp - 0x81c]

    eax_2 = *20;
    eax_5 = *0x8059260;
    fwrite("Uncompressing files...", 1, 22, eax_5);
    memcpy(0x80632c0, 0x8055f4f, 28);
    mkstemp(0x80632c0);
    eax_7 = open(0x80632c0, 64);
    if (eax_7 == -1) {
        eax = __errno_location();
        eax = *eax;
        eax = strerror(eax);
        print_error(param2, -7, 0x8055f6c, eax);
    }
    if (VERBOSE != 0) {
        eax_10 = *0x8059260;
        fprintf(eax_10, "\nUncompressing to: %s.\n", 0x80632c0);
    }
    close(eax_7);
    remove(0x80632c0);
    mkdir_s(param1, 0x80632c0, 0x8055fad);
    atexit(0x8048e89);
    sprintf(&param3, "cp %s %s", param4, 0x80632c0);
    eax_11 = system(&param3);
    if (eax_11 < 0) {
        print_error(param2, -7, 0x8055fbc, param4);
    }
    eax_12 = check_filetype(param4);
    local11 = eax_12;
    if (eax_12 == 0) {
        print_warning(param2, 0x8055fec, 0x8055fb2);
        local11 = 1;
    }
    if (local11 == 1) {
        if (VERBOSE == 0) {
            eax_17 = basename(param4);
            sprintf(&param3, "tar -xzf %s/%s -C %s", 0x80632c0, eax_17, 0x80632c0);
        }
        else {
            eax_15 = basename(param4);
            sprintf(&param3, "tar -xzvf %s/%s -C %s", 0x80632c0, eax_15, 0x80632c0);
        }
    }
    if (local11 == 2) {
        if (VERBOSE == 0) {
            eax_19 = basename(param4);
            sprintf(&param3, "tar -xjvf %s/%s -C %s", 0x80632c0, eax_19, 0x80632c0);
        }
        else {
            eax_16 = basename(param4);
            sprintf(&param3, "tar -xjvf %s/%s -C %s", 0x80632c0, eax_16, 0x80632c0);
        }
    }
    if (local11 == 3) {
        if (VERBOSE == 0) {
            eax_21 = basename(param4);
            sprintf(&param3, "unzip -qq %s/%s -d %s", 0x80632c0, eax_21, 0x80632c0);
        }
        else {
            eax_18 = basename(param4);
            sprintf(&param3, "unzip %s/%s -d %s", 0x80632c0, eax_18, 0x80632c0);
        }
    }
    if (local11 == 4) {
        if (VERBOSE == 0) {
            eax = basename(param4);
            sprintf(&param3, "tar -xf %s/%s -C %s", 0x80632c0, eax, 0x80632c0);
        }
        else {
            eax_20 = basename(param4);
            sprintf(&param3, "tar -xvf %s/%s -C %s", 0x80632c0, eax_20, 0x80632c0);
        }
    }
    eax_22 = system(&param3);
    if (eax_22 < 0) {
        if (local11 == 1) {
            print_error(param2, -7, 0x80560d0, param4);
        }
        if (local11 == 2) {
            print_error(param2, -7, 0x8056130, param4);
        }
        if (local11 == 3) {
            print_error(param2, -7, 0x8056190, param4);
        }
        exit(-7);
    }
    print_done();
    eax = eax_2 ^ *20;
    if (eax != 0) {
        __stack_chk_fail();
    }
    return;
}

/** address: 0x08049c27 */
void get_package_name(char param1[], char param2, char param3, union { char[] *; __size32; } param4, union { char *; __size32; } param5)
{
    FILE *eax_1; 		// r24{8}
    __size32 eax_5; 		// r24{12}
    int esp; 		// r28

    sprintf(&param3, "%s/%s", param4, 0x8054a6a);
    eax_1 = fopen(&param3, "r");
    if (eax_1 == 0) {
        print_error(param1, -6, 0x8054a71, param4);
    }
    eax_5 = nc_fgets_nb(esp - 0x1010, 0x800, eax_1);
    if (eax_5 == 0) {
        fclose(eax_1);
        print_error(param1, -6, 0x8054a8c, eax_1);
    }
    chop(esp - 0x1010);
    strcpy(param5, &param2);
    *(__size32*)%esp = %eax;
    fclose(*(%esp + 4));
    if ( ~flags) {
        __stack_chk_fail();
    }
    return;
}

/** address: 0x08052748 */
__size32 run_post(char param1[], char param2[], __size32 param3, unsigned int param4, union { char[] *; __size32; } param5, union { char[] *; __size32; } param6)
{
    __size8 al; 		// r8
    int eax; 		// r24
    union { __size32; char[] *; } eax_20; 		// r24{29}
    int eax_44; 		// r24{8}
    int ecx; 		// r25
    int edx; 		// r26

    eax_44 = *20;
    if ((unsigned int)(param4 - 3) <= 6) {
        switch(param4) {
        case 3:
            memcpy(0x805f2a0, 0x8056e85, 19);
            break;
        case 4:
            memcpy(0x805f2a0, 0x8056e85, 19);
            break;
        case 5:
            memcpy(0x805f2a0, 0x8056e98, 17);
            break;
        case 6:
            memcpy(0x805f2a0, 0x8056ea9, 17);
            break;
        case 7:
            memcpy(0x805f2a0, 0x8056eba, 19);
            break;
        case 8:
        case 9:
            memcpy(0x805f2a0, 0x8056ecd, 19);
            break;
        }
    }
    putenv(0x805f2a0);
    if (param6 == 0) {
        memcpy(0x805faa0, 0x8056ef0, 23);
    }
    else {
        sprintf(0x805faa0, "INSTALL_BASE=%s", param6);
    }
    putenv(0x805faa0);
    getcwd(&param2, 0x800);
    eax_20 = basename(param3); /* Warning: also results in al */
    sprintf(&param1, "%s/%s/src", &param2, eax_20);
    sprintf(0x8062aa0, "EXT_BASE=%s", &param1);
    putenv(0x8062aa0);
    if (param5 != 0) {
        sprintf(0x80602a0, "INSTALL_TYPE=%s", param5);
    }
    else {
        memcpy(0x80602a0, 0x8056f1d, 17);
    }
    putenv(0x80602a0);
    edx = *(global_0x08056f68 + 0x11360);
    sprintf(&param2, "%i", edx);
    sprintf(0x8060aa0, "GEM_FORCE=%s", &param2);
    putenv(0x8060aa0);
    edx = *(global_0x08056f68 + 0xc338);
    sprintf(&param2, "%i", edx);
    sprintf(0x80612a0, "GEM_VERBOSE=%s", &param2);
    putenv(0x80612a0);
    memcpy(0x8061aa0, 0x8056f5d, 10);
    putenv(0x8061aa0);
    ecx = atexit(0x8048e89); /* Warning: also results in edx */
    eax = eax_44 ^ *20;
    if (eax != 0) {
        eax = __stack_chk_fail(); /* Warning: also results in ecx, edx */
    }
    return eax; /* WARNING: Also returning: al := al, ecx := ecx, edx := edx */
}

/** address: 0x0804f7e8 */
void check_extension(char param1[], union { char *; __size32; } param2)
{
    __size32 eax; 		// r24
    FILE *eax_1; 		// r24{13}
    int esp; 		// r28

    eax = *0x8059260;
    fwrite("Checking extension ...", 1, 22, eax);
    strcpy(&' ', param2);
    eax = chdir(&' ');
    if (eax < 0) {
        eax = __errno_location();
        eax = *eax;
        strerror(eax);
        print_error(param1, -2, 0x8055e48, param2);
    }
    eax_1 = fopen("id", "r");
    if (eax_1 == 0) {
        print_error(param1, -6, 0x8055e70, 22);
    }
    __isoc99_fscanf();
    eax = strcmp("<GRASS extension package>", &' ');
    if (eax != 0) {
        fclose(eax_1);
        print_error(param1, -6, 0x8055ec1, (esp - 0x810));
    }
    *(__size32*)%esp = %eax;
    fclose(*(%esp + 4));
    *(__size32*)(%esp + 4) = %eax;
    *(__size32*)%esp = 0x8055edb;
    get_package_name(*(%esp - 0x1850), *(%esp - 0x1010), *(%esp - 0x810), *(%esp + 4), *(%esp + 8));
    *(__size32*)(%esp + 4) = %edx;
    *(__size32*)%esp = %eax;
    fopen(*(%esp + 4), *(%esp + 8));
    *(__size32*)(%ebp - 0x814) = %eax;
    if ( ~flags) {
        *(__size32*)(%esp + 4) = 0x8055ee5;
        *(__size32*)%esp = -6;
        print_error(*(%esp - 0x810), *(%esp + 4), *(%esp + 8), *(%esp + 12));
    }
    *(__size32*)(%esp + 8) = %eax;
    *(__size32*)(%esp + 4) = 0x800;
    *(__size32*)%esp = %eax;
    nc_fgets_nb(*(%esp + 4), *(%esp + 8), *(%esp + 12));
    *(__size32*)%eax = 0;
    *(__size32*)%eax = 0;
    *(__size32*)(%esp + 16) = %ecx;
    *(__size32*)(%esp + 12) = %ecx;
    *(__size32*)(%esp + 8) = %ecx;
    *(__size32*)(%esp + 4) = %edx;
    *(__size32*)%esp = %eax;
    __isoc99_sscanf();
    *(__size32*)(%ebp - 0x810) = %eax;
    if ( ~flags) {
        *(__size32*)%esp = %eax;
        fclose(*(%esp + 4));
        *(__size32*)(%esp + 4) = 0x8055f0c;
        *(__size32*)%esp = -6;
        print_error(*(%esp - 0x810), *(%esp + 4), *(%esp + 8), *(%esp + 12));
    }
    print_done();
    *(__size32*)%esp = 0x8055f35;
    chdir(*(%esp + 4));
    *(__size32*)%esp = %eax;
    fclose(*(%esp + 4));
    if ( ~flags) {
        __stack_chk_fail();
    }
    return;
}

/** address: 0x0804ff43 */
void query_extension(__size32 param1, int param2, union { __size32; void *; } param3, __size32 param4, union { unsigned char *; __size32; } param5, char param6[], char param7, union { char[] *; __size32; } param8, union { char[] *; __size32; } param9, int param10, int param11, int param12, union { char[] *; __size32; } param13, union { char[] *; __size32; } param14, char param15)
{
    __size8 al; 		// r8
    char dl; 		// r10
    __size32 eax; 		// r24
    int esp; 		// r28

    eax = basename(param8); /* Warning: also results in al */
    strcpy(&param7, eax);
    %eax = chdir(&param7);
    if (%eax < 0) {
        eax = __errno_location();
        eax = *eax;
        strerror(eax);
        print_error(param6, -2, 0x8055e48, param8);
    }
    eax = *0x8059260;
    fprintf(eax, "\nExtension '%s', version %i.%i.%i\n\n", param9, param10, param11, param12);
    al = dump_ascii(param1, param3, param4, param5, 0x8056210, 0x8056204, al, param15, param6); /* Warning: also results in dl */
    al = dump_ascii(param1, param3, param4, param5, 0x805622e, 0x805621c, al, dl, param6); /* Warning: also results in dl */
    al = dump_ascii(param1, param3, param4, param5, 0x805624a, 0x8056237, al, dl, param6); /* Warning: also results in dl */
    al = dump_ascii(param1, param3, param4, param5, 0x8056265, 0x805624f, al, dl, param6); /* Warning: also results in dl */
    al = dump_ascii(param1, param3, param4, param5, 0x805627a, 0x805626d, al, dl, param6); /* Warning: also results in dl */
    al = dump_ascii(param1, param3, param4, param5, 0x8056287, 0x8056282, al, dl, param6); /* Warning: also results in dl */
    sprintf(&param7, "../%s", param8);
    list_binaries(param2, param6, esp - 0x810);
    dump_ascii(param1, param3, param4, param5, 0x805629c, 0x8056292, al, dl, param6);
    eax = *0x8059260;
    fprintf(eax, "Type '%s -d %s' to see more detailed information.\n", param13, param14);
    eax = *0x8059260;
    fprintf(eax, "Type '%s -l %s' to see copyright information.\n", param13, param14);
    system("sh post");
    exit(0);
    return;
}

/** address: 0x08053002 */
void show_details(__size32 param1, union { __size32; void *; } param2, __size32 param3, union { unsigned char *; __size32; } param4, char param5[], char param6, __size32 param7, char param8)
{
    __size8 al; 		// r8
    __size32 eax; 		// r24

    eax = basename(param7); /* Warning: also results in al */
    strcpy(&param6, eax);
    %eax = chdir(&param6);
    if (%eax < 0) {
        eax = __errno_location();
        eax = *eax;
        strerror(eax);
        print_error(param5, -2, 0x8057778, param7);
    }
    dump_ascii(param1, param2, param3, param4, 0x80577b2, 0x805779d, al, param8, param5);
    system("sh post");
    exit(0);
    return;
}

/** address: 0x080530b9 */
void show_license(__size32 param1, union { __size32; void *; } param2, __size32 param3, union { unsigned char *; __size32; } param4, char param5[], char param6, __size32 param7, char param8)
{
    __size8 al; 		// r8
    __size32 eax; 		// r24

    eax = basename(param7); /* Warning: also results in al */
    strcpy(&param6, eax);
    %eax = chdir(&param6);
    if (%eax < 0) {
        eax = __errno_location();
        eax = *eax;
        strerror(eax);
        print_error(param5, -2, 0x8057778, param7);
    }
    dump_ascii(param1, param2, param3, param4, 0x80577bf, 0x805779d, al, param8, param5);
    system("sh post");
    exit(0);
    return;
}

/** address: 0x080521a4 */
void source_clean(char param1[], char param2, char param3, __size32 param4)
{
    __size32 eax; 		// r24
    int local4; 		// m[esp - 0x1014]

    eax = basename(param4);
    sprintf(&param3, "%s/src", eax);
    eax = chdir(&param3);
    if (eax < 0) {
        print_error(param1, -2, 0x8056bc4, param4);
    }
    eax = *(global_0x08056f68 + 0xc338);
    if (eax == 0) {
        eax = *0x8059260;
        fwrite("Cleaning up...", 1, 14, eax);
        sprintf(&param2, "%s -f Makefile -s clean &> %s", 0x806bae0, 0x80672c0);
        eax = system(&param2);
        local4 = eax;
    }
    else {
        eax = *0x8059260;
        fprintf(eax, "Running '%s clean':\n", 0x806bae0);
        sprintf(&param2, "%s -f Makefile clean", 0x806bae0);
        eax = system(&param2);
        local4 = eax;
    }
    if (local4 == -1) {
        print_error(param1, -9, 0x8056c3c, 0x806bae0);
    }
    print_done();
    *(__size32*)%esp = 0x80567d4;
    system(*(%esp + 4));
    if ( ~flags) {
        __stack_chk_fail();
    }
    return;
}

/** address: 0x08050220 */
void source_install(char param1[], char param2[], char param3, char param4, char param5, char param6, char param7[], char param8[], char param9[], char param10[], char param11, char param12, char param13[], char param14[], char param15[], char param16, char param17, char param18[], char param19[], char param20[], char param21[], char param22[], char param23[], char param24[], int param25, int param26, char param27, char param28[], union { FILE *; __size32; } param29, int param30, char param31, char param32[], char param32, char param33, char param34, char param35[], char param36, char param37[], char param38[], char param39, char param40[], int param41, int param42, int param43, int param44, int param45, int param46, union { char *; __size32; } param47, int param48, __size32 param49, __size32 param50)
{
    __size8 al; 		// r8
    __size32 eax; 		// r24
    char *eax_11; 		// r24{75}
    char *eax_14; 		// r24{76}
    char *eax_17; 		// r24{77}
    int eax_20; 		// r24{78}
    int eax_21; 		// r24{79}
    union { __size32; char[] *; } eax_22; 		// r24{83}
    int eax_23; 		// r24{85}
    int eax_25; 		// r24{91}
    __size32 eax_26; 		// r24{93}
    union { __size32; FILE *; } eax_27; 		// r24{95}
    int eax_28; 		// r24{98}
    __size32 eax_29; 		// r24{135}
    int eax_3; 		// r24{57}
    union { __size32; FILE *; } eax_30; 		// r24{137}
    int eax_31; 		// r24{140}
    union { __size32; FILE *; } eax_32; 		// r24{101}
    int eax_33; 		// r24{104}
    union { __size32; FILE *; } eax_34; 		// r24{143}
    int eax_35; 		// r24{146}
    int eax_36; 		// r24{150}
    union { FILE *; int; } eax_37; 		// r24{156}
    FILE *eax_38; 		// r24{158}
    union { __size32; int *; } eax_40; 		// r24{160}
    int eax_41; 		// r24{161}
    char *eax_42; 		// r24{162}
    __size32 eax_45; 		// r24{165}
    __size32 eax_47; 		// r24{179}
    union { __size32; FILE *; } eax_48; 		// r24{181}
    int eax_6; 		// r24{58}
    char *eax_7; 		// r24{62}
    char *eax_8; 		// r24{74}
    int esp; 		// r28
    char local0; 		// m[esp - 0x50f0]
    char local1; 		// m[esp - 0x48f0]
    int local12; 		// m[esp - 0x2814]
    char local2; 		// m[esp - 0x50f4]
    char local3; 		// m[esp - 0x48f4]

    eax_3 = *20;
    eax_6 = __stat(param42, (esp - 0x288c));
    if (eax_6 < 0) {
        eax = __errno_location();
        eax = *eax;
        eax_7 = strerror(eax);
        print_error(param35, -5, 0x8056338, eax_7);
    }
    sprintf(0x80592a0, "GINSTALL_DST=%s", param42);
    putenv(0x80592a0);
    sprintf(&param40, "%s/include", param42);
    sprintf(0x8059aa0, "GINSTALL_INC=%s", &param40);
    putenv(0x8059aa0);
    sprintf(&param40, "%s/lib", param42);
    sprintf(0x805a2a0, "GINSTALL_LIB=%s", &param40);
    putenv(0x805a2a0);
    sprintf(0x805eaa0, "GEM_GRASS_DIR=%s", param42);
    putenv(0x805eaa0);
    eax_8 = strdup(param47);
    eax_11 = strtok(eax_8, ".");
    eax_14 = strtok(0, ".");
    eax_17 = strtok(0, ".");
    eax_20 = strtol(eax_11, 0, 10);
    eax_21 = strtol(eax_14, 0, 10);
    strtol(eax_17, 0, 10);
    free(eax_8);
    atexit(0x8048e89);
    eax_22 = basename(param41); /* Warning: also results in al */
    sprintf(&param39, "%s/src", eax_22);
    eax_23 = chdir(&param39);
    if (eax_23 < 0) {
        eax = __errno_location();
        eax = *eax;
        strerror(eax);
        print_error(param35, -2, 0x80563b8, param41);
    }
    eax_25 = *(global_0x08056f68 + 0x11368);
    if (eax_25 == 0) {
        eax_26 = *(global_0x08056f68 + 0xc338);
        if (eax_26 == 0) {
            eax_32 = *0x8059260;
            fwrite("Configuring...", 1, 14, eax_32);
            sprintf(&param36, "sh %s %s --quiet &> %s", 0x806b2e0, 0x806aae0, 0x80672c0);
            eax_33 = system(&param36);
            local12 = eax_33;
        }
        else {
            eax_27 = *0x8059260;
            fwrite("Running configure script:\n", 1, 26, eax_27);
            sprintf(&param36, "sh %s %s", 0x806b2e0, 0x806aae0);
            eax_28 = system(&param36);
            local12 = eax_28;
        }
        if (local12 == -1) {
            print_error(param35, -27, 0x8056430, 0x806b2e0);
        }
        if (local12 > 0) {
            print_error(param35, -3, 0x8056451, 0x806b2e0);
        }
        print_done();
        print_cfg(param35);
    }
    sprintf(0x805b2a0, "GEM_EXT_NAME=%s", param43);
    putenv(0x805b2a0);
    sprintf(&param40, "%i.%i.%i", param44, param45, param46);
    sprintf(0x805baa0, "GEM_EXT_VERSION=%s", &param40);
    putenv(0x805baa0);
    al = dump_html(param24, param29, param30, param35, 0x8056492, 0x8064ac0, al, param32);
    al = dump_html(param24, param29, param30, param35, 0x80564a1, 0x80652c0, al, param32);
    al = dump_html(param24, param29, param30, param35, 0x80564a9, 0x8065ac0, al, param32);
    al = dump_html(param24, param29, param30, param35, 0x80564b4, 0x80662c0, al, param32);
    al = dump_html(param24, param29, param30, param35, 0x80564bc, 0x8066ac0, al, param32);
    sprintf(0x805c2a0, "GEM_EXT_DESCR=%s", 0x8064ac0);
    putenv(0x805c2a0);
    sprintf(0x805caa0, "GEM_EXT_INFO=%s", 0x80652c0);
    putenv(0x805caa0);
    sprintf(0x805d2a0, "GEM_EXT_DEPS=%s", 0x8065ac0);
    putenv(0x805d2a0);
    sprintf(0x805daa0, "GEM_EXT_BUGS=%s", 0x80662c0);
    putenv(0x805daa0);
    sprintf(0x805e2a0, "GEM_EXT_AUTHORS=%s", 0x8066ac0);
    putenv(0x805e2a0);
    atexit(0x8048e89);
    al = check_dependencies(param14, param33, param41, param42, param47, al, param48, param49, param50, local0, local1);
    eax_29 = *(global_0x08056f68 + 0xc338);
    if (eax_29 == 0) {
        eax_34 = *0x8059260;
        fwrite("Compiling...", 1, 12, eax_34);
        sprintf(&param36, "%s -f Makefile &> %s", 0x806bae0, 0x80672c0);
        eax_35 = system(&param36);
        local12 = eax_35;
    }
    else {
        eax_30 = *0x8059260;
        fprintf(eax_30, "Running '%s':\n", 0x806bae0);
        sprintf(&param36, "%s -f Makefile", 0x806bae0);
        eax_31 = system(&param36);
        local12 = eax_31;
    }
    if (local12 == -1) {
        eax_36 = *(global_0x08056f68 + 0xc338);
        if (eax_36 == 0) {
            print_error(param35, -9, 0x805655c, 0x806bae0);
        }
    }
    if (local12 > 0) {
        print_error(param35, -4, 0x8056594, 0x806bae0);
    }
    print_done();
    eax_37 = *0x8059260;
    fwrite("Installing...", 1, 13, eax_37);
    eax_38 = fopen("../uninstall", "r");
    if (eax_38 != 0) {
        eax_45 = *(global_0x08056f68 + 0xc338);
        if (eax_45 == 0) {
            sprintf(&param40, "cp -f ../uninstall %s/etc/uninstall.%s &> %s ;", param42, param43, 0x80672c0);
            strcpy(0x806a2e0, &param40);
        }
        else {
            sprintf(&param40, "cp -vf ../uninstall %s/etc/uninstall.%s ;", param42, param43);
            strcpy(0x806a2e0, &param40);
        }
        fclose(eax_38);
    }
    else {
        eax_40 = __errno_location();
        eax_41 = *eax_40;
        eax_42 = strerror(eax_41);
        print_warning(param35, 0x8056610, eax_42);
    }
    register_extension(param15, param35, param42);
    check_dependencies(param13, param32, param41, param42, param47, al, param48, param49, param50, local2, local3);
    if ( ~(eax_20 != 6 || eax_21 > 0)) {
        register_entries_gisman(param1, param2, param3, param4, param5, param6, param8, param9, param10, param12, param13, param17, param18, param20, param21, param25, param26, param27, param31, param34, param43, param42, param48);
    }
    register_entries_gisman2(param23, param31, param34, param43, param42);
    register_html(param7, param11, param16, param19, param22, param31, param34, param43, param42, param44, param45, param46);
    eax_47 = *(global_0x08056f68 + 0xc338);
    if (eax_47 == 0) {
        sprintf(&param38, "%s -f Makefile -s install &> %s ; \t\t\t\t\tcp -f %s %s/etc/extensions.db &> %s ; chmod a+r %s/etc/extensions.db &> %s ;", 0x806bae0, 0x80672c0, 0x8063ac0, param42, 0x80672c0, param42, 0x80672c0);
    }
    else {
        eax_48 = *0x8059260;
        fprintf(eax_48, "Running '%s install':\n", 0x806bae0);
        sprintf(&param38, "%s -f Makefile install ; \t\t\t\t\tcp -vf %s %s/etc/extensions.db ; chmod -v a+r %s/etc/extensions.db ;", 0x806bae0, 0x8063ac0, param42, param42);
    }
    eax = *(global_0x08056f68 + 0xc338);
    if (eax == 0) {
        sprintf(&param37, "sh ../post &> %s", 0x80672c0);
    }
    else {
        memcpy(&param37, 0x80567d4, 11);
    }
    sprintf(&param40, "%s %s %s %s %s %s", &param38, 0x806a2e0, 0x80682e0, 0x8068ae0, 0x80692e0, &param37);
    su(param28, param34, param42, esp - 0x810);
    print_done();
    eax = eax_3 ^ *20;
    if (eax != 0) {
        __stack_chk_fail();
    }
    return;
}

/** address: 0x08051cf4 */
void uninstall(char param1[], char param2[], char param3[], char param4[], char param5[], __size32 param6, __size32 param7, char param8[], char param9[], char param10[], char param11[], char param12, char param13[], char param14, char param15[], char param16, unsigned int param17, unsigned int param18, union { char *; __size32; } param19, __size32 param20)
{
    __size32 eax; 		// r24
    char *eax_12; 		// r24{29}
    char *eax_15; 		// r24{30}
    int eax_18; 		// r24{31}
    int eax_19; 		// r24{32}
    int eax_2; 		// r24{22}
    int eax_20; 		// r24{39}
    int eax_25; 		// r24{52}
    union { __size32; int *; } eax_26; 		// r24{58}
    int eax_27; 		// r24{59}
    char *eax_28; 		// r24{60}
    union { FILE *; unsigned int; } eax_5; 		// r24{23}
    char *eax_6; 		// r24{27}
    char *eax_9; 		// r24{28}
    int esp; 		// r28
    __size32 local21; 		// m[esp - 0x1018]
    unsigned int local8; 		// m[esp - 0x10ec]

    eax_2 = *20;
    eax_5 = *0x8059260;
    fwrite("Un-installing...", 1, 16, eax_5);
    sprintf(0x805aaa0, "UNINSTALL_BASE=%s", param18);
    putenv(0x805aaa0);
    eax_6 = strdup(param19);
    eax_9 = strtok(eax_6, ".");
    eax_12 = strtok(0, ".");
    eax_15 = strtok(0, ".");
    eax_18 = strtol(eax_9, 0, 10);
    eax_19 = strtol(eax_12, 0, 10);
    strtol(eax_15, 0, 10);
    free(eax_6);
    atexit(0x8048e89);
    deregister_extension(param1, param14, param18);
    if ( ~(eax_18 != 6 || eax_19 > 0)) {
        local8 = param18;
        eax_20 = deregister_entries_gisman(param3, param5, param7, param10, param12, param13, param17, param18, param20);
        if (eax_20 == -1) {
            print_warning(param13, 0x805695c, param18);
            local8 = 0x805698c;
            memcpy(0x80682e0, 0x805698c, 1);
        }
        if (eax_20 == 0) {
            print_warning(param13, 0x8056990, local8);
            memcpy(0x80682e0, 0x805698c, 1);
        }
    }
    deregister_entries_gisman2(param9, param12, param13, param17, param18);
    deregister_html(param2, param4, param6, param8, param12, param13, param17, param18, param20);
    sprintf(&param15, "%s/etc/uninstall.%s", param18, param17);
    local21 = 0;
    eax_25 = __stat(esp - 0x1010, (esp - 0x108c));
    if (eax_25 < 0) {
        print_warning(param13, 0x80569d4, esp - 0x108c);
        local21 = 1;
    }
    if (local21 == 0) {
        eax = *(global_0x08056f68 + 0xc338);
        if (eax == 0) {
            sprintf(&param16, "sh %s &> %s ; rm -vf %s &> %s ; \t\t\t\t\t \t\trm -vrf %s/docs/extensions/%s &> %s ; rm -vf %s/etc/dm/gem-entries/%s &> %s ; \t\t\t\t\t\t\tcp -vf %s %s/etc/extensions.db &> %s ; chmod -v a+r %s/etc/extensions.db &> %s ;", &param15, 0x80672c0, &param15, 0x80672c0, param18, param17, 0x80672c0, param18, param17, 0x80672c0, 0x8063ac0, param18, 0x80672c0, param18, 0x80672c0);
            strcpy(0x806a2e0, &param16);
        }
        else {
            sprintf(&param16, "sh %s ; rm -vf %s ; \t\t\t\t\t \t\trm -vrf %s/docs/extensions/%s ; rm -vf %s/etc/dm/gem-entries/%s ; \t\t\t\t\t\t\tcp -vf %s %s/etc/extensions.db ; chmod -v a+r %s/etc/extensions.db ;", &param15, &param15, param18, param17, param18, param17, 0x8063ac0, param18, param18);
            strcpy(0x806a2e0, &param16);
        }
    }
    else {
        eax_26 = __errno_location();
        eax_27 = *eax_26;
        eax_28 = strerror(eax_27);
        print_warning(param13, 0x8056610, eax_28);
    }
    sprintf(&param16, "%s %s %s", 0x806a2e0, 0x80682e0, 0x80692e0);
    su(param11, param13, param18, esp - 0x810);
    print_done();
    eax = eax_2 ^ *20;
    if (eax != 0) {
        __stack_chk_fail();
    }
    return;
}

/** address: 0x0805148a */
void test_install(char param1[], char param2[], char param3, char param4, char param5, char param6, char param7[], char param8[], char param9[], char param10[], char param11, char param12, char param13[], char param14[], char param15[], char param16, char param17, char param18[], char param19[], char param20[], char param21[], char param22[], char param23[], int param24, int param25, char param26, char param27[], char param28, char param29, char param30, char param31, char param32[], char param33, char param34, char param35[], int param36, int param37, int param38, int param39, int param40, int param41, union { char *; __size32; } param42, int param43, __size32 param44, __size32 param45)
{
    __size8 al; 		// r8
    __size32 eax; 		// r24
    char *eax_11; 		// r24{69}
    char *eax_14; 		// r24{70}
    char *eax_17; 		// r24{71}
    int eax_20; 		// r24{72}
    int eax_21; 		// r24{73}
    union { __size32; char[] *; } eax_22; 		// r24{77}
    int eax_23; 		// r24{79}
    int eax_25; 		// r24{85}
    __size32 eax_26; 		// r24{87}
    union { __size32; FILE *; } eax_27; 		// r24{89}
    int eax_28; 		// r24{92}
    __size32 eax_29; 		// r24{129}
    int eax_3; 		// r24{51}
    union { __size32; FILE *; } eax_30; 		// r24{131}
    int eax_31; 		// r24{134}
    union { __size32; FILE *; } eax_32; 		// r24{95}
    int eax_33; 		// r24{98}
    union { __size32; FILE *; } eax_34; 		// r24{137}
    int eax_35; 		// r24{140}
    int eax_36; 		// r24{144}
    union { __size32; FILE *; } eax_37; 		// r24{150}
    FILE *eax_38; 		// r24{152}
    union { __size32; int *; } eax_40; 		// r24{154}
    int eax_41; 		// r24{155}
    char *eax_42; 		// r24{156}
    int eax_6; 		// r24{52}
    char *eax_7; 		// r24{56}
    char *eax_8; 		// r24{68}
    int esp; 		// r28
    char local0; 		// m[esp - 0x40e0]
    char local1; 		// m[esp - 0x38e0]
    int local12; 		// m[esp - 0x1814]
    char local2; 		// m[esp - 0x40e4]
    char local3; 		// m[esp - 0x38e4]

    eax_3 = *20;
    eax_6 = __stat(param37, (esp - 0x188c));
    if (eax_6 < 0) {
        eax = __errno_location();
        eax = *eax;
        eax_7 = strerror(eax);
        print_error(param32, -5, 0x8056338, eax_7);
    }
    sprintf(0x80592a0, "GINSTALL_DST=%s", param37);
    putenv(0x80592a0);
    sprintf(&param35, "%s/include", param37);
    sprintf(0x8059aa0, "GINSTALL_INC=%s", &param35);
    putenv(0x8059aa0);
    sprintf(&param35, "%s/lib", param37);
    sprintf(0x805a2a0, "GINSTALL_LIB=%s", &param35);
    putenv(0x805a2a0);
    sprintf(0x805eaa0, "GEM_GRASS_DIR=%s", param37);
    putenv(0x805eaa0);
    eax_8 = strdup(param42);
    eax_11 = strtok(eax_8, ".");
    eax_14 = strtok(0, ".");
    eax_17 = strtok(0, ".");
    eax_20 = strtol(eax_11, 0, 10);
    eax_21 = strtol(eax_14, 0, 10);
    strtol(eax_17, 0, 10);
    free(eax_8);
    atexit(0x8048e89);
    eax_22 = basename(param36); /* Warning: also results in al */
    sprintf(&param34, "%s/src", eax_22);
    eax_23 = chdir(&param34);
    if (eax_23 < 0) {
        eax = __errno_location();
        eax = *eax;
        strerror(eax);
        print_error(param32, -2, 0x80563b8, param36);
    }
    eax_25 = *(global_0x08056f68 + 0x11368);
    if (eax_25 == 0) {
        eax_26 = *(global_0x08056f68 + 0xc338);
        if (eax_26 == 0) {
            eax_32 = *0x8059260;
            fwrite("Configuring...", 1, 14, eax_32);
            sprintf(&param33, "sh %s %s --quiet &> %s", 0x806b2e0, 0x806aae0, 0x80672c0);
            eax_33 = system(&param33);
            local12 = eax_33;
        }
        else {
            eax_27 = *0x8059260;
            fwrite("Running configure script:\n", 1, 26, eax_27);
            sprintf(&param33, "sh %s %s", 0x806b2e0, 0x806aae0);
            eax_28 = system(&param33);
            local12 = eax_28;
        }
        if (local12 == -1) {
            print_error(param32, -27, 0x8056430, 0x806b2e0);
        }
        if (local12 > 0) {
            print_error(param32, -3, 0x8056451, 0x806b2e0);
        }
        print_done();
        print_cfg(param32);
    }
    sprintf(0x805b2a0, "GEM_EXT_NAME=%s", param38);
    putenv(0x805b2a0);
    sprintf(&param35, "%i.%i.%i", param39, param40, param41);
    sprintf(0x805baa0, "GEM_EXT_VERSION=%s", &param35);
    putenv(0x805baa0);
    dump_plain(param27, param32, 0x8056492, 0x8064ac0);
    dump_plain(param27, param32, 0x80564a1, 0x80652c0);
    dump_plain(param27, param32, 0x80564a9, 0x8065ac0);
    dump_plain(param27, param32, 0x80564b4, 0x80662c0);
    dump_plain(param27, param32, 0x80564bc, 0x8066ac0);
    sprintf(0x805c2a0, "GEM_EXT_DESCR=%s", 0x8064ac0);
    putenv(0x805c2a0);
    sprintf(0x805caa0, "GEM_EXT_INFO=%s", 0x80652c0);
    putenv(0x805caa0);
    sprintf(0x805d2a0, "GEM_EXT_DEPS=%s", 0x8065ac0);
    putenv(0x805d2a0);
    sprintf(0x805daa0, "GEM_EXT_BUGS=%s", 0x80662c0);
    putenv(0x805daa0);
    sprintf(0x805e2a0, "GEM_EXT_AUTHORS=%s", 0x8066ac0);
    putenv(0x805e2a0);
    atexit(0x8048e89);
    al = check_dependencies(param14, param30, param36, param37, param42, al, param43, param44, param45, local0, local1);
    eax_29 = *(global_0x08056f68 + 0xc338);
    if (eax_29 == 0) {
        eax_34 = *0x8059260;
        fwrite("Compiling...", 1, 12, eax_34);
        sprintf(&param33, "%s -f Makefile &> %s", 0x806bae0, 0x80672c0);
        eax_35 = system(&param33);
        local12 = eax_35;
    }
    else {
        eax_30 = *0x8059260;
        fprintf(eax_30, "Running '%s':\n", 0x806bae0);
        sprintf(&param33, "%s -f Makefile", 0x806bae0);
        eax_31 = system(&param33);
        local12 = eax_31;
    }
    if (local12 == -1) {
        eax_36 = *(global_0x08056f68 + 0xc338);
        if (eax_36 == 0) {
            print_error(param32, -9, 0x805655c, 0x806bae0);
        }
    }
    if (local12 > 0) {
        print_error(param32, -4, 0x8056594, 0x806bae0);
    }
    print_done();
    eax_37 = *0x8059260;
    fwrite("Installing...", 1, 13, eax_37);
    eax_38 = fopen("../uninstall", "r");
    if (eax_38 != 0) {
        fclose(eax_38);
    }
    else {
        eax_40 = __errno_location();
        eax_41 = *eax_40;
        eax_42 = strerror(eax_41);
        print_warning(param32, 0x8056610, eax_42);
    }
    register_extension(param15, param32, param37);
    check_dependencies(param13, param29, param36, param37, param42, al, param43, param44, param45, local2, local3);
    if ( ~(eax_20 != 6 || eax_21 > 0)) {
        register_entries_gisman(param1, param2, param3, param4, param5, param6, param8, param9, param10, param12, param13, param17, param18, param20, param21, param24, param25, param26, param28, param31, param38, param37, param43);
    }
    register_entries_gisman2(param23, param28, param31, param38, param37);
    register_html(param7, param11, param16, param19, param22, param28, param31, param38, param37, param39, param40, param41);
    eax = *0x8059260;
    fprintf(eax, "(skipping '%s install')...", 0x806bae0);
    print_done();
    eax = eax_3 ^ *20;
    if (eax != 0) {
        __stack_chk_fail();
    }
    return;
}

/** address: 0x0804a92c */
void binaries_exist(__size32 param1, __size32 param2, int param3, char param4, union { char[] *; __size32; } param5, union { char *; __size32; } param6)
{
    int eax_10; 		// r24{15}
    int eax_13; 		// r24{17}
    int eax_16; 		// r24{19}
    int eax_19; 		// r24{26}
    struct dirent *eax_21; 		// r24{31}
    struct dirent *eax_3; 		// r24{12}
    int eax_6; 		// r24{8}
    DIR *eax_8; 		// r24{9}
    int edx; 		// r26
    int esp; 		// r28
    __size32 local10; 		// local5{30}
    __size32 local11; 		// param2{34}
    __size32 local12; 		// param1{35}
    union { struct dirent *; __size32; } local2; 		// m[esp - 0x818]
    union { __size32; char[] *; } local4; 		// m[esp - 0x890]
    __size32 local5; 		// m[esp - 0x894]
    __size32 local9; 		// local4{29}

    eax_6 = *20;
    eax_8 = opendir(param5);
    local11 = param2;
    local12 = param1;
    if (eax_8 != 0) {
        eax_3 = readdir(eax_8);
        local2 = eax_3;
        param2 = local11;
        param1 = local12;
        local9 = param2;
        local9 = param2;
        local9 = param2;
        local10 = param1;
        local10 = param1;
        local10 = param1;
        while (local2 != 0) {
            eax_10 = strcmp(local2 + 11, ".");
            if (eax_10 == 0) {
bb0x804aa6f:
                local4 = local9;
                local5 = local10;
                eax_21 = readdir(eax_8);
                local11 = local4;
                local12 = local5;
                local2 = eax_21;
            }
            else {
                eax_13 = strcmp(local2 + 11, "..");
                if (eax_13 == 0) {
                    goto bb0x804aa6f;
                }
                else {
                    eax_16 = strcmp(local2 + 11, "src");
                    if (eax_16 == 0) {
                        goto bb0x804aa6f;
                    }
                    else {
                        local4 = local2 + 11;
                        local5 = param5;
                        sprintf(&param4, "%s/%s", param5, local4);
                        local9 = local4;
                        local9 = local4;
                        local10 = local5;
                        local10 = local5;
                        __stat(esp - 0x810, (esp - 0x870));
                        if ((param3 & 0xf000) != 0x4000) {
                            goto bb0x804aa6f;
                        }
                        else {
                            eax_19 = strcmp(local2 + 11, param6);
                            if (eax_19 != 0) {
                                goto bb0x804aa6f;
                            }
                            else {
                                goto bb0x804aa95;
                            }
                        }
                    }
                }
            }
            param2 = local11;
            param1 = local12;
            local9 = param2;
            local9 = param2;
            local9 = param2;
            local10 = param1;
            local10 = param1;
            local10 = param1;
        }
    }
    else {
    }
bb0x804aa95:
    edx = eax_6 ^ *20;
    if (edx != 0) {
        __stack_chk_fail();
    }
    return;
}

/** address: 0x08050c67 */
void bin_install(char param1[], char param2[], char param3, char param4, char param5, char param6, char param7[], char param8[], char param9[], char param10[], char param11, char param12, char param13[], char param14[], char param15[], char param16, char param17, char param18[], char param19[], char param20[], char param21[], char param22[], char param23[], char param24[], int param25, int param26, char param27, char param28[], union { FILE *; __size32; } param29, int param30, char param31, char param32[], char param32, char param33, char param34, char param35[], char param36[], char param37[], char param38, char param39[], int param40, int param41, union { char[] *; __size32; } param42, int param43, int param44, int param45, int param46, union { char *; __size32; } param47, int param48, __size32 param49, __size32 param50)
{
    __size8 al; 		// r8
    __size32 eax; 		// r24
    char *eax_11; 		// r24{75}
    char *eax_14; 		// r24{76}
    char *eax_17; 		// r24{77}
    int eax_20; 		// r24{78}
    int eax_21; 		// r24{79}
    union { __size32; char[] *; } eax_22; 		// r24{83}
    int eax_23; 		// r24{85}
    union { FILE *; int; } eax_25; 		// r24{113}
    FILE *eax_26; 		// r24{115}
    union { __size32; int *; } eax_28; 		// r24{117}
    int eax_29; 		// r24{118}
    int eax_3; 		// r24{57}
    char *eax_30; 		// r24{119}
    __size32 eax_33; 		// r24{122}
    __size32 eax_35; 		// r24{136}
    union { __size32; FILE *; } eax_36; 		// r24{138}
    int eax_6; 		// r24{58}
    char *eax_7; 		// r24{62}
    char *eax_8; 		// r24{74}
    int esp; 		// r28
    char local0; 		// m[esp - 0x4900]
    char local1; 		// m[esp - 0x4100]
    char local2; 		// m[esp - 0x4904]
    char local3; 		// m[esp - 0x4104]

    eax_3 = *20;
    eax_6 = __stat(param41, (esp - 0x208c));
    if (eax_6 < 0) {
        eax = __errno_location();
        eax = *eax;
        eax_7 = strerror(eax);
        print_error(param35, -5, 0x8056338, eax_7);
    }
    sprintf(0x80592a0, "GINSTALL_DST=%s", param41);
    putenv(0x80592a0);
    sprintf(&param39, "%s/include", param41);
    sprintf(0x8059aa0, "GINSTALL_INC=%s", &param39);
    putenv(0x8059aa0);
    sprintf(&param39, "%s/lib", param41);
    sprintf(0x805a2a0, "GINSTALL_LIB=%s", &param39);
    putenv(0x805a2a0);
    sprintf(0x805eaa0, "GEM_GRASS_DIR=%s", param41);
    putenv(0x805eaa0);
    eax_8 = strdup(param47);
    eax_11 = strtok(eax_8, ".");
    eax_14 = strtok(0, ".");
    eax_17 = strtok(0, ".");
    eax_20 = strtol(eax_11, 0, 10);
    eax_21 = strtol(eax_14, 0, 10);
    strtol(eax_17, 0, 10);
    free(eax_8);
    atexit(0x8048e89);
    eax_22 = basename(param40); /* Warning: also results in al */
    sprintf(&param38, "%s/%s", eax_22, param42);
    eax_23 = chdir(&param38);
    if (eax_23 < 0) {
        eax = __errno_location();
        eax = *eax;
        strerror(eax);
        print_error(param35, -2, 0x8056808, param40);
    }
    sprintf(0x805b2a0, "GEM_EXT_NAME=%s", param43);
    putenv(0x805b2a0);
    sprintf(&param39, "%i.%i.%i", param44, param45, param46);
    sprintf(0x805baa0, "GEM_EXT_VERSION=%s", &param39);
    putenv(0x805baa0);
    al = dump_html(param24, param29, param30, param35, 0x8056492, 0x8064ac0, al, param32);
    al = dump_html(param24, param29, param30, param35, 0x80564a1, 0x80652c0, al, param32);
    al = dump_html(param24, param29, param30, param35, 0x80564a9, 0x8065ac0, al, param32);
    al = dump_html(param24, param29, param30, param35, 0x80564b4, 0x80662c0, al, param32);
    al = dump_html(param24, param29, param30, param35, 0x80564bc, 0x8066ac0, al, param32);
    sprintf(0x805c2a0, "GEM_EXT_DESCR=%s", 0x8064ac0);
    putenv(0x805c2a0);
    sprintf(0x805caa0, "GEM_EXT_INFO=%s", 0x80652c0);
    putenv(0x805caa0);
    sprintf(0x805d2a0, "GEM_EXT_DEPS=%s", 0x8065ac0);
    putenv(0x805d2a0);
    sprintf(0x805daa0, "GEM_EXT_BUGS=%s", 0x80662c0);
    putenv(0x805daa0);
    sprintf(0x805e2a0, "GEM_EXT_AUTHORS=%s", 0x8066ac0);
    putenv(0x805e2a0);
    atexit(0x8048e89);
    al = check_dependencies(param14, param33, param40, param41, param47, al, param48, param49, param50, local0, local1);
    eax_25 = *0x8059260;
    fwrite("Installing...", 1, 13, eax_25);
    eax_26 = fopen("../uninstall", "r");
    if (eax_26 != 0) {
        eax_33 = *(global_0x08056f68 + 0xc338);
        if (eax_33 == 0) {
            sprintf(&param39, "cp -f ../uninstall %s/etc/uninstall.%s &> %s ;", param41, param43, 0x80672c0);
            strcpy(0x806a2e0, &param39);
        }
        else {
            sprintf(&param39, "cp -vf ../uninstall %s/etc/uninstall.%s ;", param41, param43);
            strcpy(0x806a2e0, &param39);
        }
        fclose(eax_26);
    }
    else {
        eax_28 = __errno_location();
        eax_29 = *eax_28;
        eax_30 = strerror(eax_29);
        print_warning(param35, 0x8056610, eax_30);
    }
    register_extension(param15, param35, param41);
    check_dependencies(param13, param32, param40, param41, param47, al, param48, param49, param50, local2, local3);
    if ( ~(eax_20 != 6 || eax_21 > 0)) {
        register_entries_gisman(param1, param2, param3, param4, param5, param6, param8, param9, param10, param12, param13, param17, param18, param20, param21, param25, param26, param27, param31, param34, param43, param41, param48);
    }
    register_entries_gisman2(param23, param31, param34, param43, param41);
    register_html(param7, param11, param16, param19, param22, param31, param34, param43, param41, param44, param45, param46);
    eax_35 = *(global_0x08056f68 + 0xc338);
    if (eax_35 == 0) {
        sprintf(&param37, "bin/%s -f Makefile -s install &> %s ; \t\t\t\t\tcp -f %s %s/etc/extensions.db &> %s ; chmod a+r %s/etc/extensions.db &> %s ;", 0x806bae0, 0x80672c0, 0x8063ac0, param41, 0x80672c0, param41, 0x80672c0);
    }
    else {
        eax_36 = *0x8059260;
        fprintf(eax_36, "Running '%s install':\n", 0x806bae0);
        sprintf(&param37, "bin/%s -f Makefile install ; \t\t\t\t\tcp -vf %s %s/etc/extensions.db ; chmod -v a+r %s/etc/extensions.db ;", 0x806bae0, 0x8063ac0, param41, param41);
    }
    eax = *(global_0x08056f68 + 0xc338);
    if (eax == 0) {
        sprintf(&param36, "sh ../post &> %s", 0x80672c0);
    }
    else {
        memcpy(&param36, 0x80567d4, 11);
    }
    sprintf(&param39, "%s %s %s %s %s %s", &param37, 0x806a2e0, 0x80682e0, 0x8068ae0, 0x80692e0, &param36);
    su(param28, param34, param41, esp - 0x810);
    print_done();
    eax = eax_3 ^ *20;
    if (eax != 0) {
        __stack_chk_fail();
    }
    return;
}

/** address: 0x0805474a */
__size32 __i686.get_pc_thunk.bx()
{
    __size32 local0; 		// m[esp]

    return local0;
}

/** address: 0x0804d896 */
__size32 restore_entries_gisman(char param1[], char param2[], char param3, char param4, char param5, char param6, char param7[], char param8[], char param9[], char param10, char param11[], char param12, char param13[], char param14[], char param15[], union { __size32; FILE *; } param16, int param17, int param18, char param19, char param20, char param21, union { char[] *; __size32; } param22, __size8 param23, int param24)
{
    __size8 al; 		// r8
    __size32 eax; 		// r24
    union { __size32; __size32 *; } eax_12; 		// r24{30}
    __size32 eax_13; 		// r24{31}
    __size32 eax_14; 		// r24{33}
    FILE *eax_16; 		// r24{42}
    DIR *eax_22; 		// r24{55}
    __size32 eax_25; 		// r24{57}
    struct dirent *eax_26; 		// r24{84}
    FILE *eax_29; 		// r24{63}
    int eax_32; 		// r24{65}
    int eax_35; 		// r24{67}
    char *eax_38; 		// r24{91}
    __size32 eax_41; 		// r24{94}
    void *eax_42; 		// r24{97}
    char *eax_45; 		// r24{77}
    char *eax_48; 		// r24{115}
    __size32 eax_5; 		// r24{201}
    DIR *eax_51; 		// r24{119}
    size_t eax_53; 		// r24{107}
    void *eax_56; 		// r24{108}
    union { __size32; char *; } eax_59; 		// r24{110}
    int eax_6; 		// r24{26}
    struct dirent *eax_63; 		// r24{178}
    int eax_65; 		// r24{124}
    int eax_68; 		// r24{126}
    FILE *eax_71; 		// r24{128}
    unsigned int eax_73; 		// r24{187}
    int eax_76; 		// r24{159}
    union { __size32; char *; } eax_79; 		// r24{183}
    __size32 eax_80; 		// r24{200}
    char *eax_81; 		// r24{134}
    char *eax_84; 		// r24{135}
    char *eax_87; 		// r24{138}
    FILE *eax_9; 		// r24{28}
    int eax_90; 		// r24{141}
    union { __size32; void *; } eax_93; 		// r24{194}
    int eax_94; 		// r24{148}
    union { union { void *; __size32; } *; int; } ebx; 		// r27
    int ecx; 		// r25
    int edx; 		// r26
    int esp; 		// r28
    __size32 local14; 		// m[esp - 0x281c]
    unsigned int local15; 		// m[esp - 0x2844]
    union { FILE *; __size32; } local16; 		// m[esp - 0x282c]
    __size32 local20; 		// m[esp - 0x2820]
    unsigned int local21; 		// m[esp - 0x2824]
    __size32 local26; 		// m[esp - 0x2840]
    int local27; 		// m[esp - 0x2814]
    int local34; 		// m[esp - 0x2828]
    int local35; 		// m[esp - 0x2880]
    union { __size32; FILE *; } local45; 		// param16{82}
    int local46; 		// param24{113}
    int local47; 		// local27{154}
    int local48; 		// local34{156}
    union { int; void *; } local49; 		// local7{158}
    __size8 local50; 		// param23{171}
    int local51; 		// ebx{172}
    int local52; 		// param18{173}
    int local53; 		// param17{175}
    union { FILE *; __size32; } local54; 		// local16{176}
    __size32 local55; 		// eax_5{201}
    __size32 local56; 		// eax{205}
    char *local7; 		// m[esp - 0x2880]

    eax_6 = *20;
    sprintf(&param20, "%s/etc/dm/menu.tcl", param22);
    local45 = param16;
    local46 = param24;
    local50 = param23;
    local52 = param18;
    local53 = param17;
    eax_9 = fopen(&param20, "r");
    if (eax_9 != 0) {
        memcpy(0x80642c0, 0x8055424, 32);
        mkstemp(0x80642c0);
        eax_16 = fopen(0x80642c0, "w+");
        if (eax_16 == 0) {
            eax = __errno_location();
            eax = *eax;
            strerror(eax);
            print_error(param15, -21, 0x8055448, 0x80642c0);
        }
        atexit(0x8048fc2);
        if (VERBOSE == 0) {
            sprintf(&param21, "cp -f %s/etc/dm/menu.tcl %s/etc/dm/menu.tcl.gem.bak &> %s ; \t\t\t\t\t\tcp -f %s %s/etc/dm/menu.tcl &> %s ; chmod a+r %s/etc/dm/menu.tcl &> %s ;", param22, param22, 0x80672c0, 0x80642c0, param22, 0x80672c0, param22, 0x80672c0);
        }
        else {
            sprintf(&param21, "cp -vf %s/etc/dm/menu.tcl %s/etc/dm/menu.tcl.gem.bak ; \t\t\t\t\t\tcp -vf %s %s/etc/dm/menu.tcl ; chmod -v a+r %s/etc/dm/menu.tcl ;", param22, param22, 0x80642c0, param22, param22);
        }
        strcpy(0x80682e0, &param21);
        sprintf(&param19, "%s/etc/dm/gem-entries", param22);
        eax_22 = opendir(&param19);
        if (eax_22 != 0) {
            local14 = 0;
            local15 = 0;
            for(;;) {
bb0x804dbf2:
                param16 = local45;
                eax_26 = readdir(eax_22);
                local54 = param16;
                if (eax_26 != 0) {
                    sprintf(esp - 0x1810, "%s/%s", param22, param22);
                    eax_29 = fopen(esp - 0x1810, "r");
                    local16 = eax_29;
                    eax_32 = strcmp(eax_26 + 11, ".");
                    local45 = local16;
                    local45 = local16;
                    local45 = local16;
                    if (eax_32 != 0) {
                        eax_35 = strcmp(eax_26 + 11, "..");
                        if (eax_35 != 0) {
                            if (eax_29 != 0) {
                                for(;;) {
                                    eax_45 = fgets(esp - 0x810, 0x800, eax_29);
                                    if (eax_45 == 0) {
                                        break;
                                    }
                                    local14++;
                                }
                                local15++;
                                fclose(eax_29);
                                goto bb0x804dbf2;
                            }
                            else {
                                fclose(eax_29);
                                goto bb0x804dbf2;
                            }
                            goto bb0x804dbf2;
                        }
bb0x804db86:
                        fclose(eax_29);
                    }
                    goto bb0x804db86;
                }
            }
            closedir(eax_22);
            local20 = 0;
            for(;;) {
                eax_38 = fgets(esp - 0x810, 0x800, eax_9);
                if (eax_38 == 0) {
                    break;
                }
                local20++;
            }
            if (local20 != 0) {
                rewind(eax_9);
                eax_42 = calloc(local14 + local14 + local15 * 5 + local20 + 1, 4);
                local21 = 0;
                while (local14 + local14 + local15 * 5 + local20 + 1 > (int)local21) {
                    *(__size32*)(local21 * 4 + eax_42) = 0;
                    local21++;
                }
                local21 = 0;
                for(;;) {
                    param24 = local46;
                    eax_48 = fgets(esp - 0x810, 0x800, eax_9); /* Warning: also results in ecx, edx */
                    local51 = param24;
                    if (eax_48 != 0) {
                        ebx = local21 * 4 + eax_42;
                        eax_53 = strlen(esp - 0x810);
                        local46 = ebx;
                        eax_56 = malloc(eax_53 + 1);
                        *(union { void *; __size32; }*)ebx = eax_56;
                        eax_59 = *(local21 * 4 + eax_42);
                        strcpy(eax_59, esp - 0x810);
                        local21++;
                    }
                }
                *(__size32*)(local21 * 4 + eax_42) = 0;
                check_ext_menu(param7, param10, param12, param14, eax_42, ecx, edx);
                eax_51 = opendir(esp - 0x2010);
                local26 = 0;
                for(;;) {
bb0x804dfd8:
                    param23 = local50;
                    ebx = local51;
                    param18 = local52;
                    param17 = local53;
                    local16 = local54;
                    eax_63 = readdir(eax_51);
                    local47 = param18;
                    local48 = param17;
                    local50 = param23;
                    local50 = param23;
                    local50 = param23;
                    local51 = ebx;
                    local51 = ebx;
                    local51 = ebx;
                    local52 = param18;
                    local52 = param18;
                    local52 = param18;
                    local53 = param17;
                    local53 = param17;
                    local53 = param17;
                    local54 = local16;
                    local54 = local16;
bb0x804dfe6:
                    if (eax_63 != 0) {
                        local7 = eax_63 + 11;
                        sprintf(esp - 0x1810, "%s/%s", param22, param22);
                        local49 = local7;
                        eax_65 = strcmp(eax_63 + 11, ".");
                        if (eax_65 == 0) {
                        }
                        else {
                            eax_68 = strcmp(eax_63 + 11, "..");
                            if (eax_68 != 0) {
                                eax_71 = fopen(esp - 0x1810, "r");
                                local16 = eax_71;
                                local54 = local16;
                                local54 = local16;
                                if (eax_71 == 0) {
                                    goto bb0x804dfd8;
                                }
                                local21 = 1;
                                for(;;) {
bb0x804df93:
                                    local27 = local47;
                                    local34 = local48;
                                    local7 = local49;
                                    eax_76 = nc_fgets_nb(esp - 0x810, 0x800, eax_71); /* Warning: also results in al */
                                    local47 = local27;
                                    local49 = local7;
                                    if (eax_76 != 0) {
                                        if (local21 != 1) {
                                            local35 = local34;
                                            eax_94 = new_item(param2, param4, param6, param9, param11, param13, param15, esp - 0x810, eax_42, local34); /* Warning: also results in al */
                                            local49 = local35;
                                            local34 = eax_94;
                                            local48 = local34;
                                            if (eax_94 < 0) {
                                                goto bb0x804dfc1;
                                            }
                                            local21++;
                                            local26++;
                                        }
                                        else {
                                            goto bb0x804de85;
                                        }
                                    }
bb0x804dfc1:
                                    fclose(eax_71);
                                    local50 = al;
                                    local51 = ebx;
                                    local52 = local27;
                                    local53 = local34;
                                    goto bb0x804dfd8;
                                }
bb0x804de85:
                                eax_81 = strrchr(esp - 0x810, 93);
                                eax_84 = strchr(esp - 0x810, 91);
                                local27 = eax_81 - eax_84;
                                ebx = eax_81 - eax_84;
                                eax_87 = strchr(esp - 0x810, 91);
                                local47 = local27;
                                ecx = strncpy((esp - 0x1010), eax_87 + 1, eax_81 - eax_84); /* Warning: also results in edx */
                                *(__size8*)(esp + eax_81 - eax_84 - 0x1011) = 0;
                                eax_90 = new_submenu(param1, param3, param5, param8, param11, param13, param15, (esp - 0x2810), esp - 0x810, eax_42, ecx, edx);
                                local34 = eax_90;
                                local48 = local34;
                                if (eax_90 < 0) {
                                    goto bb0x804dfc1;
                                }
                                else {
                                    local21++;
                                    local26++;
                                    goto bb0x804df93;
                                }
                                goto bb0x804dfc1;
                            }
                            goto bb0x804dfd8;
                        }
                        goto bb0x804dfe6;
                    }
                }
                closedir(eax_51);
                local21 = 0;
                eax_73 = *(local21 * 4 + eax_42);
                while (eax_73 != 0) {
                    eax_79 = *(local21 * 4 + eax_42);
                    fprintf(eax_16, eax_79);
                    local21++;
                    eax_73 = *(local21 * 4 + eax_42);
                }
                fflush(eax_16);
                fclose(eax_9);
                fclose(eax_16);
                local21 = 0;
                while (local14 + local14 + local15 * 5 + local20 + 1 > (int)local21) {
                    eax_93 = *(local21 * 4 + eax_42);
                    free(eax_93);
                    local21++;
                }
                free(eax_42);
                eax_80 = local26;
                local55 = eax_80;
            }
            else {
                eax_41 = 0;
                local55 = eax_41;
            }
        }
        else {
            eax_25 = 0;
            local55 = eax_25;
        }
    }
    else {
        eax_12 = __errno_location();
        eax_13 = *eax_12;
        if (eax_13 != 2) {
            fclose(eax_9);
            eax = __errno_location();
            eax = *eax;
            strerror(eax);
            print_error(param15, -21, 0x80553f3, esp - 0x1810);
        }
        eax_14 = 0;
        local55 = eax_14;
    }
    eax_5 = local55;
    edx = eax_6 ^ *20;
    local56 = eax_5;
    if (edx != 0) {
        eax = __stack_chk_fail();
        local56 = eax;
    }
    eax = local56;
    return eax;
}

/** address: 0x0804f026 */
__size32 restore_html(char param1[], char param2, char param3, char param4[], char param5[], __size32 param6, __size32 param7, __size32 param8, __size32 param9, union { __size32; DIR *; } param10, union { __size32; FILE *; } param11, char param12, char param13[], char param14, char param14, char param15, union { char[] *; __size32; } param17, __size32 param17)
{
    __size32 eax; 		// r24
    __size32 eax_10; 		// r24{25}
    __size32 eax_11; 		// r24{187}
    int eax_12; 		// r24{20}
    union { FILE *; char[] *; } eax_15; 		// r24{22}
    DIR *eax_21; 		// r24{55}
    __size32 eax_24; 		// r24{57}
    struct dirent *eax_25; 		// r24{78}
    int eax_28; 		// r24{63}
    int eax_31; 		// r24{65}
    DIR *eax_34; 		// r24{67}
    char *eax_37; 		// r24{85}
    __size32 eax_4; 		// r24{27}
    __size32 eax_40; 		// r24{88}
    void *eax_41; 		// r24{91}
    char *eax_44; 		// r24{109}
    DIR *eax_47; 		// r24{112}
    size_t eax_50; 		// r24{101}
    void *eax_53; 		// r24{102}
    union { char *; int; } eax_56; 		// r24{104}
    FILE *eax_6; 		// r24{36}
    struct dirent *eax_60; 		// r24{164}
    int eax_62; 		// r24{116}
    int eax_65; 		// r24{118}
    DIR *eax_68; 		// r24{120}
    FILE *eax_70; 		// r24{125}
    unsigned int eax_73; 		// r24{173}
    char *eax_76; 		// r24{137}
    union { __size32; char *; } eax_80; 		// r24{169}
    __size32 eax_81; 		// r24{186}
    char *eax_82; 		// r24{133}
    union { __size32; __size32 *; } eax_9; 		// r24{24}
    union { __size32; union { void *; __size32; } *; } ebx; 		// r27
    int edx; 		// r26
    int esp; 		// r28
    __size32 local11; 		// m[esp - 0x2840]
    union { DIR *; __size32; } local12; 		// m[esp - 0x2834]
    __size32 local14; 		// m[esp - 0x281c]
    unsigned int local17; 		// m[esp - 0x2820]
    __size32 local18; 		// m[esp - 0x283c]
    union { FILE *; __size32; } local19; 		// m[esp - 0x282c]
    __size32 local20; 		// m[esp - 0x2844]
    __size32 local21; 		// m[esp - 0x2848]
    __size32 local22; 		// m[esp - 0x284c]
    __size32 local33; 		// param6{49}
    union { __size32; DIR *; } local34; 		// param10{75}
    __size32 local35; 		// param17{107}
    __size32 local36; 		// ebx{154}
    union { __size32; FILE *; } local37; 		// param11{156}
    union { DIR *; __size32; } local38; 		// local12{157}
    __size32 local39; 		// param9{159}
    __size32 local40; 		// param8{160}
    __size32 local41; 		// param7{161}
    __size32 local42; 		// local9{162}
    __size32 local43; 		// eax_11{187}
    __size32 local44; 		// eax{191}
    __size32 local7; 		// m[esp - 0x286c]
    char *local8; 		// m[esp - 0x2870]
    __size32 local9; 		// m[esp - 0x2868]

    eax_12 = *20;
    sprintf(&param14, "%s/docs/html/index.html", param17);
    local33 = param6;
    local34 = param10;
    local35 = param17;
    local37 = param11;
    local39 = param9;
    local40 = param8;
    local41 = param7;
    eax_15 = fopen(&param14, "r");
    if (eax_15 != 0) {
        memcpy(0x8067ac0, 0x8055cb4, 32);
        mkstemp(0x8067ac0);
        eax_6 = fopen(0x8067ac0, "w+");
        if (eax_6 == 0) {
            eax = __errno_location();
            eax = *eax;
            strerror(eax);
            print_error(param5, -24, 0x8055cd8, 0x8067ac0);
        }
        if (VERBOSE == 0) {
            local9 = param17;
            local7 = 0x80672c0;
            sprintf(&param15, "cp -f %s %s/docs/html/index.html &>%s ; chmod a+r %s/docs/html/index.html &>%s ;", 0x8067ac0, param17, 0x80672c0, param17, 0x80672c0);
            local33 = local9;
        }
        else {
            local7 = param17;
            sprintf(&param15, "cp -vf %s %s/docs/html/index.html ; chmod -v a+r %s/docs/html/index.html ;", 0x8067ac0, param17, param17);
        }
        param6 = local33;
        local8 = param17;
        strcpy(0x80692e0, &param15);
        local42 = param6;
        atexit(0x8048fc2);
        sprintf(&param13, "%s/docs/extensions", param17);
        eax_21 = opendir(&param13);
        if (eax_21 != 0) {
            local11 = 0;
            for(;;) {
bb0x804f304:
                param10 = local34;
                eax_25 = readdir(eax_21);
                local34 = param10;
                local34 = param10;
                local38 = param10;
bb0x804f312:
                if (eax_25 != 0) {
                    local8 = eax_25 + 11;
                    sprintf(&param12, "%s/%s", &param13, eax_25 + 11);
                    eax_28 = strcmp(eax_25 + 11, ".");
                    if (eax_28 == 0) {
                    }
                    else {
                        eax_31 = strcmp(eax_25 + 11, "..");
                        if (eax_31 != 0) {
                            eax_34 = opendir(&param12);
                            local12 = eax_34;
                            local34 = local12;
                            local34 = local12;
                            if (eax_34 == 0) {
                                goto bb0x804f304;
                            }
                            local11++;
                            closedir(eax_34);
                            goto bb0x804f304;
                        }
                        goto bb0x804f304;
                    }
                    goto bb0x804f312;
                }
            }
            closedir(eax_21);
            local14 = 0;
            for(;;) {
                eax_37 = fgets(&param15, 0x800, eax_15);
                if (eax_37 == 0) {
                    break;
                }
                local14++;
            }
            if (local14 != 0) {
                rewind(eax_15);
                eax_41 = calloc(local14 + local11 + 10, 4);
                local17 = 0;
                while (local14 + local11 + 10 > (int)local17) {
                    *(__size32*)(local17 * 4 + eax_41) = 0;
                    local17++;
                }
                local17 = 0;
                for(;;) {
                    param17 = local35;
                    eax_44 = fgets(&param15, 0x800, eax_15);
                    local36 = param17;
                    if (eax_44 != 0) {
                        ebx = local17 * 4 + eax_41;
                        eax_50 = strlen(&param15);
                        local35 = ebx;
                        eax_53 = malloc(eax_50 + 1);
                        *(union { void *; __size32; }*)ebx = eax_53;
                        eax_56 = *(local17 * 4 + eax_41);
                        strcpy(eax_56, &param15);
                        local17++;
                    }
                }
                *(__size32*)(local17 * 4 + eax_41) = 0;
                eax_47 = opendir(&param13);
                local18 = 0;
                for(;;) {
bb0x804f6cd:
                    ebx = local36;
                    param11 = local37;
                    local12 = local38;
                    param9 = local39;
                    param8 = local40;
                    param7 = local41;
                    local9 = local42;
                    eax_60 = readdir(eax_47);
                    local36 = ebx;
                    local36 = ebx;
                    local36 = ebx;
                    local36 = ebx;
                    local36 = ebx;
                    local37 = param11;
                    local37 = param11;
                    local37 = param11;
                    local38 = local12;
                    local38 = local12;
                    local39 = param9;
                    local39 = param9;
                    local39 = param9;
                    local39 = param9;
                    local40 = param8;
                    local40 = param8;
                    local40 = param8;
                    local40 = param8;
                    local41 = param7;
                    local41 = param7;
                    local41 = param7;
                    local41 = param7;
                    local42 = local9;
                    local42 = local9;
                    local42 = local9;
                    local42 = local9;
                    local42 = local9;
bb0x804f6db:
                    if (eax_60 != 0) {
                        sprintf(&param12, "%s/%s", eax_15, local8);
                        eax_62 = strcmp(eax_60 + 11, ".");
                        if (eax_62 == 0) {
                        }
                        else {
                            eax_65 = strcmp(eax_60 + 11, "..");
                            if (eax_65 != 0) {
                                eax_68 = opendir(&param12);
                                local12 = eax_68;
                                local38 = local12;
                                local38 = local12;
                                local38 = local12;
                                local38 = local12;
                                if (eax_68 != 0) {
                                    closedir(eax_68);
                                    sprintf(&param14, "%s/index.html", eax_15);
                                    eax_70 = fopen(&param14, "r");
                                    local19 = eax_70;
                                    local37 = local19;
                                    local37 = local19;
                                    local37 = local19;
                                    if (eax_70 != 0) {
                                        local20 = 0;
                                        local21 = 0;
                                        local22 = 0;
                                        local17 = 0;
                                        local39 = local20;
                                        local39 = local20;
                                        local40 = local21;
                                        local40 = local21;
                                        local41 = local22;
                                        local41 = local22;
                                        do {
                                            eax_76 = fgets(&param15, 0x800, eax_70);
                                            if (eax_76 != 0) {
                                                eax_82 = strstr(&param15, "<title>");
                                            }
bb0x804f611:
                                            if (local17 == 0) {
                                                goto bb0x804f6cd;
                                            }
                                            strchr(&param15, 40);
                                            __isoc99_sscanf();
                                            ebx = eax_60 + 11;
                                            local9 = 0;
                                            local7 = 0;
                                            new_ext_html(param1, param2, param3, param4, param5, eax_60 + 11, eax_41, 0, 0, 0, 0, 0);
                                            local36 = ebx;
                                            local42 = local9;
                                            local18++;
                                            fclose(eax_70);
                                            goto bb0x804f6cd;
                                        } while (eax_82 == 0);
                                        local17 = 1;
                                        goto bb0x804f611;
                                    }
                                    goto bb0x804f6cd;
                                }
                                goto bb0x804f6cd;
                            }
                            goto bb0x804f6cd;
                        }
                        goto bb0x804f6db;
                    }
                }
                closedir(eax_47);
                local17 = 0;
                eax_73 = *(local17 * 4 + eax_41);
                while (eax_73 != 0) {
                    eax_80 = *(local17 * 4 + eax_41);
                    fprintf(eax_6, eax_80);
                    local17++;
                    eax_73 = *(local17 * 4 + eax_41);
                }
                fflush(eax_6);
                fclose(eax_15);
                fclose(eax_6);
                local17 = 0;
                while (local14 + local11 + 10 > (int)local17) {
                    eax = *(local17 * 4 + eax_41);
                    free(eax);
                    local17++;
                }
                free(eax_41);
                eax_81 = local18;
                local43 = eax_81;
            }
            else {
                eax_40 = 0;
                local43 = eax_40;
            }
        }
        else {
            eax_24 = 0;
            local43 = eax_24;
        }
    }
    else {
        eax_9 = __errno_location();
        eax_10 = *eax_9;
        if (eax_10 != 2) {
            fclose(eax_15);
            eax = __errno_location();
            eax = *eax;
            strerror(eax);
            print_error(param5, -24, 0x8055c95, esp - 0x1010);
        }
        eax_4 = 0;
        local43 = eax_4;
    }
    eax_11 = local43;
    edx = eax_12 ^ *20;
    local44 = eax_11;
    if (edx != 0) {
        eax = __stack_chk_fail();
        local44 = eax;
    }
    eax = local44;
    return eax;
}

/** address: 0x0804ac6e */
void su(char param1[], char param2, union { char[] *; __size32; } param3, union { char *; __size32; } param4)
{
    __size32 eax; 		// r24
    FILE *eax_1; 		// r24
    union { __size32; __size32 *; } eax_2; 		// r24{12}

    next.4089 = next.4089 * 0x41c64e6d + 0xd431;
    next.4089 = next.4089 >> 16 & 0x7fff;
    srand(next.4089);
    eax = rand();
    sprintf(&param2, "%s/gem.test.%i", param3, eax);
    eax_1 = fopen(&param2, "w+");
    eax_2 = __errno_location();
    eax = *eax_2;
    if (eax == 13) {
        print_error(param1, -5, 0x8054c88, param3);
    }
    remove(&param2);
    fclose(eax_1);
    eax = system(param4);
    if (eax != 0) {
        print_error(param1, -9, 0x8054cf1, param4);
    }
    if ( ~flags) {
        __stack_chk_fail();
    }
    return;
}

/** address: 0x08049523 */
void print_done()
{
    size_t eax; 		// r24

    eax = *0x8059260;
    fwrite("\1b[0;32mDONE.\n\1b[0m", 1, 17, eax);
    return;
}

/** address: 0x0804a2c8 */
__size8 dump_ascii(__size32 param1, union { void *; __size32; } param2, __size32 param3, union { __size32; unsigned char *; } param4, char param5[], union { char *; __size32; } param6, union { char[] *; __size32; } param6, __size8 param8, char param8)
{
    __size8 al; 		// r8
    char dl; 		// r10
    __size32 eax; 		// r24
    __size32 eax_10; 		// r24{23}
    union { __size32; FILE *; } eax_13; 		// r24{25}
    union { __size32; FILE *; } eax_14; 		// r24{19}
    int eax_2; 		// r24{11}
    union { __size32; FILE *; } eax_4; 		// r24{12}
    FILE *eax_7; 		// r24{14}
    union { __size32; FILE *; } eax_9; 		// r24{16}
    int esp; 		// r28
    char local14; 		// param8{22}
    __size8 local15; 		// param8{28}
    char local16; 		// param8{29}

    eax_2 = *20;
    eax_4 = *0x8059260;
    fprintf(eax_4, "%s\n", param6);
    local14 = param8;
    local15 = param8;
    local16 = param8;
    eax_7 = fopen(param6, "r");
    if (eax_7 != 0) {
        for(;;) {
            param8 = local14;
            eax_10 = nc_fgets_html(param1, param2, param3, param4, esp - 0x810, 0x800, eax_7, param8); /* Warning: also results in al, dl */
            local14 = dl;
            local15 = al;
            local16 = dl;
            if (eax_10 == 0) {
                break;
            }
            eax_14 = *0x8059260;
            fprintf(eax_14, "  %s", &param5);
        }
        eax_13 = *0x8059260;
        fputc(10, eax_13);
        fclose(eax_7);
    }
    else {
        eax_9 = *0x8059260;
        fwrite("  No information available.\n", 1, 28, eax_9);
    }
    param8 = local15;
    param8 = local16;
    eax = eax_2 ^ *20;
    if (eax != 0) {
        __stack_chk_fail();
    }
    return param8; /* WARNING: Also returning: dl := param8 */
}

/** address: 0x0804961d */
void mkdir_s(char param1, union { char[] *; __size32; } param2, union { char[] *; __size32; } param3)
{
    __size32 eax; 		// r24

    eax = *20;
    sprintf(&param1, "mkdir %s --mode=%s -p", param2, param3);
    system(&param1);
    eax = eax ^ *20;
    if (eax != 0) {
        __stack_chk_fail();
    }
    return;
}

/** address: 0x0804aaa8 */
__size32 check_filetype(union { char *; __size32; } param1)
{
    char *eax; 		// r24

    eax = strstr(param1, ".tar.gz");
    if (eax == 0) {
        eax = strstr(param1, ".tgz");
        if (eax == 0) {
            eax = strstr(param1, ".tar.bz2");
            if (eax == 0) {
                eax = strstr(param1, ".tbz");
                if (eax == 0) {
                    eax = strstr(param1, ".zip");
                    if (eax == 0) {
                        eax = strstr(param1, ".tar");
                        if (eax == 0) {
                            eax = 0;
                        }
                        else {
                            eax = 4;
                        }
                    }
                    else {
                        eax = 3;
                    }
                }
                else {
                    eax = 2;
                }
            }
            else {
                eax = 2;
            }
        }
        else {
            eax = 1;
        }
    }
    else {
        eax = 1;
    }
    return eax;
}

/** address: 0x0804949b */
void print_warning(char param1[], union { char *; __size32; } param2, int param3)
{
    __size32 eax; 		// r24
    int eax_1; 		// r24{5}

    eax_1 = *20;
    vsprintf(&param1, param2, &param3);
    eax = *0x8059244;
    fprintf(eax, "\1b[0;33m\nWARNING:\1b[0m %s", &param1);
    WARNINGS++;
    eax = eax_1 ^ *20;
    if (eax != 0) {
        __stack_chk_fail();
    }
    return;
}

/** address: 0x08049554 */
__size32 basename(union { char *; __size32; } param1)
{
    char al; 		// r8
    __size32 eax; 		// r24
    unsigned int eax_12; 		// r24{21}
    char *eax_2; 		// r24{4}
    char *eax_5; 		// r24{5}
    char *eax_8; 		// r24{13}
    union { unsigned char; char; } *eax_9; 		// r24{16}
    union { char *; __size32; } local2; 		// m[esp - 20]
    union { char *; __size32; } local3; 		// m[esp - 24]

    eax_2 = strdup(param1);
    eax_5 = strtok(eax_2, "/");
    local2 = eax_5;
    if (eax_5 != 0) {
        eax_8 = strdup(eax_5);
        local3 = eax_8;
        while (local2 != 0) {
            eax_9 = strtok(0, "/");
            local2 = eax_9;
            if ( ~(local3 == 0 || eax_9 == 0)) {
                free(local3);
            }
            if (eax_9 == 0) {
                continue;
            }
            eax_12 = *(unsigned char*)eax_9;
            tmpb = (unsigned char) eax_12;
            if ((unsigned char) eax_12 == 0) {
                continue;
            }
            eax = strdup(eax_9);
            local3 = eax;
        }
        if (eax_2 != 0) {
            free(eax_2);
        }
        eax = local3;
        al = (unsigned char) local3;
    }
    else {
        if (eax_2 != 0) {
            free(eax_2);
        }
        eax = 0;
        al = 0;
    }
    return eax; /* WARNING: Also returning: al := al */
}

/** address: 0x0804a1c8 */
__size32 nc_fgets_nb(union { char *; __size32; } param1, int param2, union { FILE *; __size32; } param3)
{
    __size8 al; 		// r8
    __size32 eax; 		// r24
    char *eax_1; 		// r24{6}
    __size32 ecx; 		// r25
    __size32 edx; 		// r26

    eax_1 = fgets(param1, param2, param3); /* Warning: also results in ecx, edx */
    if (eax_1 != 0) {
        eax = is_text(param1); /* Warning: also results in al */
        if (eax != 0) {
            eax = strchr(param1, 35); /* Warning: also results in ecx, edx */
            if (eax == 0) {
bb0x804a2c3:
                eax = param1;
            }
            else {
                if (param1 != eax) {
                    eax = malloc(0x800);
                    strcpy(eax, param1);
                    eax = strtok(eax, "#");
                    sprintf(param1, "%s\n", eax);
                    ecx = free(eax); /* Warning: also results in edx */
                    goto bb0x804a2c3;
                }
                else {
                    eax = nc_fgets_nb(param1, param2, param3, al); /* Warning: also results in al, ecx, edx */
                }
            }
        }
        else {
            eax = nc_fgets_nb(param1, param2, param3, al); /* Warning: also results in al, ecx, edx */
        }
    }
    else {
        eax = 0;
    }
    return eax; /* WARNING: Also returning: al := al, ecx := ecx, edx := edx */
}

/** address: 0x0804968f */
__size8 chop(union { char *; __size32; } param1)
{
    size_t eax; 		// r24
    int local0; 		// m[esp - 20]
    int local2; 		// m[esp - 16]
    int local3; 		// m[esp - 24]

    local0 = 0;
    eax = strlen(param1);
    local2 = eax - 1;
    while (local2 >= 0) {
        local3 = 1;
        eax = *(unsigned char*)(local2 + param1);
        if ((unsigned char) eax == 10) {
bb0x80496fe:
            local0++;
            local3 = 0;
        }
        else {
            eax = *(unsigned char*)(local2 + param1);
            if ((unsigned char) eax == 9) {
                goto bb0x80496fe;
            }
            else {
                eax = *(unsigned char*)(local2 + param1);
                if ((unsigned char) eax == 32) {
                    goto bb0x80496fe;
                }
                else {
                    eax = *(unsigned char*)(local2 + param1);
                    if ((unsigned char) eax == 12) {
                        goto bb0x80496fe;
                    }
                    else {
                        eax = *(unsigned char*)(local2 + param1);
                        if ((unsigned char) eax == 13) {
                            goto bb0x80496fe;
                        }
                    }
                }
            }
        }
        if (local3 == 1) {
            break;
        }
        local2--;
    }
    eax = strlen(param1);
    *(__size8*)(eax + param1 - local0) = 0;
    return (unsigned char) local0;
}

/** address: 0x0804a6da */
void list_binaries(int param1, char param2, union { char[] *; __size32; } param3)
{
    __size32 eax; 		// r24
    union { __size32; FILE *; } eax_11; 		// r24{13}
    struct dirent *eax_12; 		// r24{16}
    union { __size32; FILE *; } eax_15; 		// r24{49}
    union { __size32; FILE *; } eax_16; 		// r24{51}
    int eax_17; 		// r24{19}
    int eax_20; 		// r24{21}
    int eax_23; 		// r24{23}
    union { __size32; FILE *; } eax_26; 		// r24{31}
    struct dirent *eax_29; 		// r24{41}
    int eax_3; 		// r24{5}
    union { __size32; FILE *; } eax_31; 		// r24{34}
    union { __size32; FILE *; } eax_6; 		// r24{7}
    DIR *eax_9; 		// r24{11}
    int esp; 		// r28
    int local0; 		// m[esp - 0x81c]
    __size32 local1; 		// m[esp - 0x890]
    __size32 local2; 		// m[esp - 0x894]
    union { struct dirent *; __size32; } local6; 		// m[esp - 0x818]

    eax_3 = *20;
    local0 = 0;
    eax_6 = *0x8059260;
    local1 = eax_6;
    local2 = 26;
    fwrite("Binary installation files\n", 1, 26, eax_6);
    eax_9 = opendir(param3);
    if (eax_9 != 0) {
        eax_12 = readdir(eax_9);
        local6 = eax_12;
        while (local6 != 0) {
            eax_17 = strcmp(local6 + 11, ".");
            if (eax_17 != 0) {
                eax_20 = strcmp(local6 + 11, "..");
                if (eax_20 != 0) {
                    eax_23 = strcmp(local6 + 11, "src");
                    if (eax_23 != 0) {
                        local1 = local6 + 11;
                        local2 = param3;
                        sprintf(&param2, "%s/%s", param3, local1);
                        __stat(esp - 0x810, (esp - 0x874));
                        if ((param1 & 0xf000) == 0x4000) {
                            if (local0 != 0) {
                                eax_31 = *0x8059260;
                                fprintf(eax_31, ", %s", local6 + 11);
                                goto bb0x804a898;
                            }
                            else {
                                eax_26 = *0x8059260;
                                fprintf(eax_26, "  %s", local6 + 11);
                            }
bb0x804a898:
                            local2 = local6 + 11;
                            local0++;
                        }
                    }
                }
            }
            eax_29 = readdir(eax_9);
            local6 = eax_29;
        }
        if (local0 == 0) {
            eax_15 = *0x8059260;
            fwrite("  None.", 1, 7, eax_15);
        }
        eax_16 = *0x8059260;
        fwrite("\n\n", 1, 2, eax_16);
    }
    else {
        eax_11 = *0x8059260;
        fwrite("  None.\n\n", 1, 9, eax_11);
    }
    eax = eax_3 ^ *20;
    if (eax != 0) {
        __stack_chk_fail();
    }
    return;
}

/** address: 0x0804a51b */
__size8 dump_html(char param1[], union { __size32; FILE *; } param2, int param3, char param4[], char param4, union { char *; __size32; } param6, union { char *; __size32; } param6, __size8 param8)
{
    __size8 al; 		// r8
    __size32 eax; 		// r24
    FILE *eax_11; 		// r24{20}
    __size32 eax_13; 		// r24{32}
    __size32 eax_16; 		// r24{23}
    int eax_2; 		// r24{10}
    FILE *eax_7; 		// r24{13}
    int esp; 		// r28
    __size8 local11; 		// param8{30}
    union { __size32; FILE *; } local12; 		// param2{31}
    union { FILE *; __size32; } local5; 		// m[esp - 0x1030]

    eax_2 = *20;
    memcpy(param6, 0x8054aec, 32);
    local11 = param8;
    local12 = param2;
    mkstemp(param6);
    eax_7 = fopen(param6, "w+");
    if (eax_7 == 0) {
        eax = __errno_location();
        eax = *eax;
        strerror(eax);
        print_error(param1, -23, 0x8054b10, param6);
    }
    atexit(0x8048fc2);
    eax_11 = fopen(param6, "r");
    for(;;) {
bb0x804a675:
        param8 = local11;
        param2 = local12;
        eax_13 = nc_fgets(esp - 0x1010, 0x800, eax_11);
        local12 = param2;
        if (eax_13 != 0) {
            chop(esp - 0x1010);
            eax_16 = is_text(esp - 0x1010); /* Warning: also results in al */
            local11 = al;
            local11 = al;
            if (eax_16 != 0) {
                sprintf(&param4, "%s <br>\n", &param4);
                fprintf(eax_7, &param4);
            }
            else {
                local5 = eax_7;
                fwrite("<p>\n", 1, 4, eax_7);
                local12 = local5;
                goto bb0x804a675;
            }
            continue;
        }
    }
    fclose(eax_11);
    fclose(eax_7);
    close(param3);
    eax = eax_2 ^ *20;
    if (eax != 0) {
        __stack_chk_fail();
    }
    return param8;
}

/** address: 0x0804b961 */
__size8 check_dependencies(char param1[], char param2, char param3, char param2, union { char[] *; __size32; } param5, union { char[] *; __size32; } param6, __size32 param5, __size8 param8, __size32 param9, __size32 param10, __size32 param11)
{
    __size8 al; 		// r8
    __size32 eax; 		// r24
    FILE *eax_10; 		// r24{16}
    union { __size32; int *; } eax_14; 		// r24{18}
    int eax_16; 		// r24{19}
    union { __size32; FILE *; } eax_18; 		// r24{21}
    int eax_2; 		// r24{13}
    FILE *eax_20; 		// r24{31}
    union { __size32; __size32 *; } eax_24; 		// r24{33}
    __size32 eax_28; 		// r24{34}
    int eax_35; 		// r24{86}
    int eax_38; 		// r24{46}
    int eax_41; 		// r24{48}
    int eax_44; 		// r24{54}
    __size32 eax_47; 		// r24{78}
    int eax_50; 		// r24{63}
    int eax_53; 		// r24{65}
    int eax_56; 		// r24{70}
    int eax_6; 		// r24{14}
    __size32 ebx; 		// r27
    __size32 edi; 		// r31
    __size32 esi; 		// r30
    int esp; 		// r28
    __size32 local18; 		// ebx{74}
    __size32 local19; 		// esi{75}
    __size32 local20; 		// edi{76}
    __size32 local21; 		// param9{82}
    __size32 local22; 		// param10{83}
    __size32 local23; 		// param11{84}
    __size8 local24; 		// param8{92}
    int local6; 		// m[esp - 0x2828]
    __size32 local7; 		// m[esp - 0x282c]

    eax_2 = *20;
    eax_6 = *(global_0x08056f68 + 0x11360);
    local21 = param9;
    local22 = param10;
    local23 = param11;
    local24 = param8;
    local24 = param8;
    if (eax_6 == 0) {
        eax_10 = fopen("../depends", "r");
        if (eax_10 != 0) {
            local6 = 1;
            sprintf(&param2, "%s/etc/extensions.db", param6);
            eax_20 = fopen(&param2, "r");
            if (eax_20 == 0) {
                eax_24 = __errno_location();
                eax_28 = *eax_24;
                if (eax_28 != 2) {
                    fclose(eax_20);
                    eax = __errno_location();
                    eax = *eax;
                    strerror(eax);
                    print_error(param1, -17, 0x8054d16, esp - 0x820);
                }
                local6 = 0;
            }
            local7 = 0;
            do {
bb0x804be17:
                param9 = local21;
                param10 = local22;
                param11 = local23;
                eax_35 = nc_fgets_nb((esp - 0x1020), 0x800, eax_10); /* Warning: also results in al */
                local18 = param9;
                local19 = param10;
                local20 = param11;
                local21 = param9;
                local21 = param9;
                local22 = param10;
                local22 = param10;
                local23 = param11;
                local23 = param11;
                local24 = al;
bb0x804be37:
                if (eax_35 != 0) {
                    eax_38 = __isoc99_sscanf();
                    if (eax_38 <= 0) {
                        continue;
                    }
                    eax_41 = strcmp(&param2, "GRASS");
                    if (eax_41 != 0) {
                        if (local6 == 0) {
                            continue;
                        }
                        local7 = 0;
                        rewind(eax_20);
bb0x804bdbe:
                        ebx = local18;
                        esi = local19;
                        edi = local20;
                        eax_47 = nc_fgets_nb((esp - 0x1820), 0x800, eax_20);
                        local18 = ebx;
                        local18 = ebx;
                        local19 = esi;
                        local19 = esi;
                        local20 = edi;
                        local20 = edi;
                        local21 = ebx;
                        local22 = esi;
                        local23 = edi;
                        if (eax_47 != 0) {
                            eax_50 = __isoc99_sscanf();
                            if (eax_50 <= 0) {
                                goto bb0x804bdbe;
                            }
                            eax_53 = strcmp(&param3, &param2);
                            if (eax_53 != 0) {
                                goto bb0x804bdbe;
                            }
                            edi = 0;
                            esi = 0;
                            ebx = 0;
                            eax_56 = vercmp(0, 0, 0, 0, 0, 0);
                            local18 = ebx;
                            local19 = esi;
                            local20 = edi;
                            if (eax_56 < 0) {
                                print_error(param1, -18, 0x805514c, 0);
                            }
                            local7 = 1;
                            goto bb0x804bdbe;
                        }
                    }
                    else {
                        __isoc99_sscanf();
                        edi = 0;
                        esi = 0;
                        ebx = 0;
                        eax_44 = vercmp(0, 0, 0, 0, 0, 0);
                        local21 = ebx;
                        local22 = esi;
                        local23 = edi;
                        if (eax_44 < 0) {
                            print_error(param1, -18, 0x8055100, param5);
                        }
                        local7 = 1;
                        goto bb0x804be17;
                    }
                    goto bb0x804be37;
                }
                if (local6 != 0) {
                    fclose(eax_20);
                }
                fclose(eax_10);
                goto bb0x804be67;
            } while (local7 != 0);
            print_error(param1, -18, 0x80551bc, esp - 0x2820);
        }
        else {
            eax_14 = __errno_location();
            eax_16 = *eax_14;
            if (eax_16 != 2) {
                fclose(eax_10);
                eax = __errno_location();
                eax = *eax;
                strerror(eax);
                print_error(param1, -17, 0x8054d16, esp - 0x820);
            }
            eax_18 = *0x8059244;
            fprintf(eax_18, "\n%s/depends ENOENT\n", param5);
        }
    }
bb0x804be67:
    param8 = local24;
    eax = eax_2 ^ *20;
    if (eax != 0) {
        __stack_chk_fail();
    }
    return param8;
}

/** address: 0x0805014e */
void print_cfg(char param1)
{
    __size32 eax; 		// r24
    union { __size32; FILE *; } eax_11; 		// r24{12}
    int eax_3; 		// r24{2}
    FILE *eax_6; 		// r24{3}
    union { __size32; FILE *; } eax_8; 		// r24{5}
    char *eax_9; 		// r24{10}

    eax_3 = *20;
    eax_6 = fopen("config.msg", "r");
    if (eax_6 != 0) {
        eax_8 = *0x8059260;
        fwrite("\nResult of configuration: \n", 1, 27, eax_8);
        for(;;) {
            eax_9 = fgets(&param1, 0x800, eax_6);
            if (eax_9 == 0) {
                break;
            }
            eax = *0x8059260;
            fputs(&param1, eax);
        }
        eax_11 = *0x8059260;
        fputc(10, eax_11);
    }
    remove("config.msg");
    eax = eax_3 ^ *20;
    if (eax != 0) {
        __stack_chk_fail();
    }
    return;
}

/** address: 0x0804b014 */
void register_extension(char param1[], char param2, union { char[] *; __size32; } param3)
{
    __size32 eax; 		// r24
    union { __size32; __size32 *; } eax_14; 		// r24{9}
    __size32 eax_20; 		// r24{10}
    FILE *eax_32; 		// r24{23}
    FILE *eax_8; 		// r24{7}
    int esp; 		// r28
    __size32 local0; 		// m[esp - 0x281c]

    local0 = 1;
    sprintf(&param2, "%s/etc/extensions.db", param3);
    eax_8 = fopen(&param2, "r");
    if (eax_8 == 0) {
        eax_14 = __errno_location();
        eax_20 = *eax_14;
        if (eax_20 != 2) {
            fclose(eax_8);
            eax = __errno_location();
            eax = *eax;
            strerror(eax);
            print_error(param1, -15, 0x8054d16, esp - 0x810);
        }
        local0 = 0;
    }
    if (local0 != 0) {
        memcpy(0x8063ac0, 0x8054d54, 32);
        mkstemp(0x8063ac0);
        eax_32 = fopen(0x8063ac0, "w+");
        if (eax_32 == 0) {
            eax = __errno_location();
            eax = *eax;
            strerror(eax);
            print_error(param1, -15, 0x8054d78, 0x8063ac0);
        }
        atexit(0x8048fc2);
        for(;;) {
            *(__size32*)(%esp + 8) = %eax;
            *(__size32*)(%esp + 4) = 0x800;
            *(__size32*)%esp = %eax;
            nc_fgets_nb(*(%esp + 4), *(%esp + 8), *(%esp + 12));
            if (flags) {
                *(__size32*)(%ebp - 0x2810)++;
                *(__size32*)(%ebp - 0x2820) = 1;
                *(__size32*)(%esp + 28) = %ecx;
                *(__size32*)(%esp + 24) = %ecx;
                *(__size32*)(%esp + 20) = %ecx;
                *(__size32*)(%esp + 16) = %ecx;
                *(__size32*)(%esp + 12) = %ecx;
                *(__size32*)(%esp + 8) = %ecx;
                *(__size32*)(%esp + 4) = %edx;
                *(__size32*)%esp = %eax;
                __isoc99_sscanf();
                *(__size32*)(%esp + 4) = %eax;
                *(__size32*)%esp = %eax;
                strcmp(*(%esp + 4), *(%esp + 8));
                if ( ~flags) {
                    *(__size32*)(%ebp - 0x2824) = 1;
                    *(__size32*)(%esp + 20) = %ebx;
                    *(__size32*)(%esp + 16) = %ebx;
                    *(__size32*)(%esp + 12) = %ebx;
                    *(__size32*)(%esp + 8) = %ecx;
                    *(__size32*)(%esp + 4) = %edx;
                    *(__size32*)%esp = %eax;
                    vercmp(*(%esp + 4), *(%esp + 8), *(%esp + 12), *(%esp + 16), *(%esp + 20), *(%esp + 24));
                    *(__size32*)(%ebp - 0x2814) = %eax;
                    if ( ~flags) {
                        if ( ~flags) {
                            *(__size32*)(%esp + 20) = %ecx;
                            *(__size32*)(%esp + 16) = %edx;
                            *(__size32*)(%esp + 12) = %eax;
                            *(__size32*)(%esp + 8) = %eax;
                            *(__size32*)(%esp + 4) = 0x8054e0c;
                            *(__size32*)%esp = -16;
                            print_error(*(%esp - 0x810), *(%esp + 4), *(%esp + 8), *(%esp + 12));
                        }
                        *(__size32*)(%esp + 20) = %ecx;
                        *(__size32*)(%esp + 16) = %edx;
                        *(__size32*)(%esp + 12) = %eax;
                        *(__size32*)(%esp + 8) = %eax;
                        *(__size32*)(%esp + 4) = 0x8054e98;
                        *(__size32*)%esp = -16;
                        print_error(*(%esp - 0x810), *(%esp + 4), *(%esp + 8), *(%esp + 12));
                    }
                    if ( ~flags) {
                        if (flags) {
                            *(__size32*)(%ebp - 0x281c) = 1;
                            *(__size32*)(%ebp - 0x2820) = 0;
                            goto bb0x804b332;
                        }
                        else {
                            *(__size32*)(%ebp - 0x281c) = 0;
                        }
                    }
                }
bb0x804b332:
                if (flags) {
                    continue;
                }
                *(__size32*)(%esp + 4) = %eax;
                *(__size32*)%esp = %eax;
                fprintf(*(%esp + 4), *(%esp + 8));
                *(__size32*)%esp = %eax;
                fflush(*(%esp + 4));
            }
        }
        if ( ~flags) {
            if (flags) {
                *(__size32*)(%esp + 4) = %eax;
                *(__size32*)%esp = %eax;
                depstr(*(%esp - 0x2060), *(%esp - 0x181c), *(%esp - 0x1810), *(%esp - 0x1010), *(%esp - 0x810));
                *(__size32*)(%esp + 4) = %eax;
                *(__size32*)%esp = %eax;
                strcpy(*(%esp + 4), *(%esp + 8));
                *(__size32*)(%esp + 28) = %edx;
                *(__size32*)(%esp + 24) = %edx;
                *(__size32*)(%esp + 20) = %edx;
                *(__size32*)(%esp + 16) = %edx;
                *(__size32*)(%esp + 12) = %edx;
                *(__size32*)(%esp + 8) = %edx;
                *(__size32*)(%esp + 4) = %eax;
                *(__size32*)%esp = %eax;
                fprintf(*(%esp + 4), *(%esp + 8));
            }
            else {
                *(__size32*)(%esp + 4) = %eax;
                *(__size32*)%esp = %eax;
                depstr(*(%esp - 0x2060), *(%esp - 0x181c), *(%esp - 0x1810), *(%esp - 0x1010), *(%esp - 0x810));
                *(__size32*)(%esp + 4) = %eax;
                *(__size32*)%esp = %eax;
                strcpy(*(%esp + 4), *(%esp + 8));
                *(__size32*)(%esp + 28) = %edx;
                *(__size32*)(%esp + 24) = %edx;
                *(__size32*)(%esp + 20) = %edx;
                *(__size32*)(%esp + 16) = %edx;
                *(__size32*)(%esp + 12) = %edx;
                *(__size32*)(%esp + 8) = %edx;
                *(__size32*)(%esp + 4) = %eax;
                *(__size32*)%esp = %eax;
                fprintf(*(%esp + 4), *(%esp + 8));
            }
        }
        *(__size32*)%esp = %eax;
        fclose(*(%esp + 4));
        *(__size32*)%esp = %eax;
        fclose(*(%esp + 4));
    }
    if ( ~( ~flags && flags)) {
        *(__size32*)(%esp + 8) = 32;
        *(__size32*)(%esp + 4) = %eax;
        *(__size32*)%esp = 0x8063ac0;
        memcpy(*(%esp + 4), *(%esp + 8), *(%esp + 12));
        *(__size32*)%esp = 0x8063ac0;
        mkstemp(*(%esp + 4));
        *(__size32*)(%esp + 4) = %edx;
        *(__size32*)%esp = %eax;
        fopen(*(%esp + 4), *(%esp + 8));
        *(__size32*)(%ebp - 0x282c) = %eax;
        if ( ~flags) {
            __errno_location();
            *(__size32*)%esp = %eax;
            strerror(*(%esp + 4));
            *(__size32*)(%esp + 12) = %eax;
            *(__size32*)(%esp + 8) = %eax;
            *(__size32*)(%esp + 4) = 0x8054f40;
            *(__size32*)%esp = -15;
            print_error(*(%esp - 0x810), *(%esp + 4), *(%esp + 8), *(%esp + 12));
        }
        *(__size32*)%esp = 0x8048fc2;
        atexit(*(%esp + 4));
        *(__size32*)(%esp + 4) = %eax;
        *(__size32*)%esp = %eax;
        depstr(*(%esp - 0x2060), *(%esp - 0x181c), *(%esp - 0x1810), *(%esp - 0x1010), *(%esp - 0x810));
        *(__size32*)(%esp + 4) = %eax;
        *(__size32*)%esp = %eax;
        strcpy(*(%esp + 4), *(%esp + 8));
        *(__size32*)(%esp + 28) = %edx;
        *(__size32*)(%esp + 24) = %edx;
        *(__size32*)(%esp + 20) = %edx;
        *(__size32*)(%esp + 16) = %edx;
        *(__size32*)(%esp + 12) = %edx;
        *(__size32*)(%esp + 8) = %edx;
        *(__size32*)(%esp + 4) = %eax;
        *(__size32*)%esp = %eax;
        fprintf(*(%esp + 4), *(%esp + 8));
        *(__size32*)%esp = %eax;
        fclose(*(%esp + 4));
    }
    if ( ~flags) {
        __stack_chk_fail();
    }
    return;
}

/** address: 0x0804c5f0 */
void register_entries_gisman(char param1[], char param2[], char param3, char param4, char param5, char param6, char param7[], char param8[], char param9[], char param10, char param11[], char param12, char param13[], char param14[], char param15[], int param16, int param17, char param18, char param19, char param20, int param21, int param22, int param23)
{
    __size32 eax; 		// r24
    FILE *eax_12; 		// r24{38}
    union { __size32; int *; } eax_15; 		// r24{40}
    int eax_16; 		// r24{41}
    FILE *eax_19; 		// r24{50}
    int eax_23; 		// r24{57}
    char *eax_27; 		// r24{70}
    union { __size32; int *; } eax_3; 		// r24{29}
    char *eax_30; 		// r24{78}
    void *eax_33; 		// r24{82}
    char *eax_36; 		// r24{100}
    size_t eax_39; 		// r24{92}
    int eax_4; 		// r24{30}
    void *eax_42; 		// r24{93}
    union { __size32; char *; } eax_45; 		// r24{95}
    int eax_49; 		// r24{132}
    int eax_5; 		// r24{25}
    char *eax_52; 		// r24{106}
    char *eax_55; 		// r24{107}
    char *eax_58; 		// r24{110}
    int eax_62; 		// r24{113}
    int eax_65; 		// r24{140}
    int eax_68; 		// r24{121}
    union { char *; int; } eax_71; 		// r24{136}
    char *eax_72; 		// r24{148}
    FILE *eax_8; 		// r24{27}
    union { union { void *; __size32; } *; int; } ebx; 		// r27
    int ecx; 		// r25
    int edx; 		// r26
    int esp; 		// r28
    int local19; 		// m[esp - 0x181c]
    int local22; 		// m[esp - 0x1820]
    unsigned int local23; 		// m[esp - 0x1824]
    int local28; 		// m[esp - 0x1814]
    int local35; 		// m[esp - 0x1830]
    int local40; 		// m[esp - 0x182c]
    int local44; 		// param23{98}
    int local45; 		// ebx{127}
    int local46; 		// param17{128}
    int local47; 		// param16{130}
    int local6; 		// m[esp - 0x1880]

    eax_5 = *20;
    memcpy(&param20, 0x80553df, 18);
    local44 = param23;
    local46 = param17;
    local47 = param16;
    eax_8 = fopen(&param20, "r");
    if (eax_8 != 0) {
        sprintf(&param20, "%s/etc/dm/menu.tcl", param22);
        eax_12 = fopen(&param20, "r");
        if (eax_12 != 0) {
            memcpy(0x80642c0, 0x8055424, 32);
            mkstemp(0x80642c0);
            eax_19 = fopen(0x80642c0, "w+");
            if (eax_19 == 0) {
                eax = __errno_location();
                eax = *eax;
                strerror(eax);
                print_error(param15, -21, 0x8055448, 0x80642c0);
            }
            atexit(0x8048fc2);
            eax_23 = *(global_0x08056f68 + 0xc338);
            if (eax_23 == 0) {
                local6 = 0x80672c0;
                sprintf(&param19, "mkdir %s/etc/dm/gem-entries &> %s ; cp -f ../entries-gisman %s/etc/dm/gem-entries/%s &> %s ; \t\t\t\t\tcp -f %s/etc/dm/menu.tcl %s/etc/dm/menu.tcl.gem.bak &> %s ; \t\t\t\t\tcp -f %s %s/etc/dm/menu.tcl &> %s ; chmod a+r %s/etc/dm/menu.tcl &> %s ;", param22, 0x80672c0, param22, param21, 0x80672c0, param22, param22, 0x80672c0, 0x80642c0, param22, 0x80672c0, param22, 0x80672c0);
            }
            else {
                local6 = param22;
                sprintf(&param19, "mkdir --verbose %s/etc/dm/gem-entries ; cp -vf ../entries-gisman %s/etc/dm/gem-entries/%s ; \t\t\t\t\tcp -vf %s/etc/dm/menu.tcl %s/etc/dm/menu.tcl.gem.bak ; \t\t\t\t\tcp -vf %s %s/etc/dm/menu.tcl ; chmod -v a+r %s/etc/dm/menu.tcl ;", param22, param22, param21, param22, param22, 0x80642c0, param22, param22);
            }
            strcpy(0x80682e0, &param19);
            local19 = 0;
            for(;;) {
                eax_27 = fgets(&param19, 0x800, eax_8);
                if (eax_27 == 0) {
                    break;
                }
                local19++;
            }
            if (local19 == 0) {
            }
            else {
                rewind(eax_8);
                local22 = 0;
                for(;;) {
                    eax_30 = fgets(&param19, 0x800, eax_12);
                    if (eax_30 == 0) {
                        break;
                    }
                    local22++;
                }
                if (local22 != 0) {
                    rewind(eax_12);
                    eax_33 = calloc(local19 + local19 + local22 + 6, 4);
                    local23 = 0;
                    while (local19 + local19 + local22 + 6 > (int)local23) {
                        *(__size32*)(local23 * 4 + eax_33) = 0;
                        local23++;
                    }
                    local23 = 0;
                    for(;;) {
                        param23 = local44;
                        eax_36 = fgets(&param19, 0x800, eax_12); /* Warning: also results in ecx, edx */
                        local45 = param23;
                        if (eax_36 != 0) {
                            ebx = local23 * 4 + eax_33;
                            eax_39 = strlen(&param19);
                            local44 = ebx;
                            eax_42 = malloc(eax_39 + 1);
                            *(union { void *; __size32; }*)ebx = eax_42;
                            eax_45 = *(local23 * 4 + eax_33);
                            strcpy(eax_45, &param19);
                            local23++;
                        }
                    }
                    check_ext_menu(param7, param10, param12, param14, eax_33, ecx, edx);
                    local23 = 1;
                    for(;;) {
bb0x804cbc3:
                        ebx = local45;
                        param17 = local46;
                        param16 = local47;
                        eax_49 = nc_fgets_nb(esp - 0x1010, 0x800, eax_8);
                        local45 = ebx;
                        local46 = param17;
                        if (eax_49 != 0) {
                            if (local23 != 1) {
                                local6 = param16;
                                eax_68 = new_item(param2, param4, param6, param9, param11, param13, param15, esp - 0x1010, eax_33, param16);
                                local35 = eax_68;
                                local47 = local35;
                                if (eax_68 < 0) {
                                    print_warning(param15, 0x80556b8, esp - 0x1810);
                                    goto bb0x804cbeb;
                                }
                                local23++;
                            }
                            else {
                                goto bb0x804caa8;
                            }
                        }
bb0x804cbeb:
                        local23 = 0;
                        eax_65 = *(local23 * 4 + eax_33);
                        while (eax_65 != 0) {
                            eax_71 = *(local23 * 4 + eax_33);
                            fprintf(eax_19, eax_71);
                            local23++;
                            eax_65 = *(local23 * 4 + eax_33);
                        }
                        fflush(eax_19);
                        rewind(eax_19);
                        local40 = 0;
                        for(;;) {
                            eax_72 = fgets(&param19, 0x800, eax_19);
                            if (eax_72 == 0) {
                                break;
                            }
                            local40++;
                        }
                        if ( ~(local40 != 0 && local40 >= local22)) {
                            print_warning(param15, 0x80556e4, 0x800);
                            memcpy(0x80682e0, 0x8055722, 1);
                        }
                        fclose(eax_12);
                        fclose(eax_8);
                        fclose(eax_19);
                        local23 = 0;
                        while (local19 + local19 + local22 + 6 > (int)local23) {
                            eax = *(local23 * 4 + eax_33);
                            free(eax);
                            local23++;
                        }
                        free(eax_33);
                        goto bb0x804cd52;
                    }
bb0x804caa8:
                    eax_52 = strrchr(&param19, 93);
                    eax_55 = strchr(&param19, 91);
                    local28 = eax_52 - eax_55;
                    ebx = eax_52 - eax_55;
                    eax_58 = strchr(&param19, 91);
                    local45 = ebx;
                    local46 = local28;
                    ecx = strncpy(&param18, eax_58 + 1, eax_52 - eax_55); /* Warning: also results in edx */
                    *(__size8*)(esp + eax_52 - eax_55 - 0x1811) = 0;
                    eax_62 = new_submenu(param1, param3, param5, param8, param11, param13, param15, param21, esp - 0x1010, eax_33, ecx, edx);
                    local35 = eax_62;
                    local47 = local35;
                    if (eax_62 >= 0) {
                        local23++;
                        goto bb0x804cbc3;
                    }
                    else {
                        print_warning(param15, 0x8055690, esp - 0x1010);
                        goto bb0x804cbeb;
                    }
                    goto bb0x804cbeb;
                }
            }
        }
        else {
            eax_15 = __errno_location();
            eax_16 = *eax_15;
            if (eax_16 != 2) {
                fclose(eax_12);
                eax = __errno_location();
                eax = *eax;
                strerror(eax);
                print_error(param15, -21, 0x80553f3, esp - 0x810);
            }
        }
    }
    else {
        eax_3 = __errno_location();
        eax_4 = *eax_3;
        if (eax_4 != 2) {
            fclose(eax_8);
            eax = __errno_location();
            eax = *eax;
            strerror(eax);
            print_error(param15, -21, 0x80553f3, esp - 0x810);
        }
    }
bb0x804cd52:
    eax = eax_5 ^ *20;
    if (eax != 0) {
        __stack_chk_fail();
    }
    return;
}

/** address: 0x0804cd6c */
void register_entries_gisman2(char param1[], char param2, char param3, union { char[] *; __size32; } param4, union { char[] *; __size32; } param5)
{
    __size32 eax; 		// r24
    FILE *eax_12; 		// r24{9}
    union { __size32; union { char *; __size32; } *; } eax_16; 		// r24{11}
    union { __size32; char *; } eax_18; 		// r24{12}
    __size32 eax_2; 		// r24{19}
    int eax_5; 		// r24{7}
    int esp; 		// r28

    eax_5 = *20;
    memcpy(&param3, 0x8055723, 19);
    eax_12 = fopen(&param3, "r");
    if (eax_12 != 0) {
        eax_2 = *(global_0x08056f68 + 0xc338);
        if (eax_2 == 0) {
            sprintf(&param2, "mkdir -p %s/etc/gm/Xtns ; cp -f ../entries-gisman2 %s/etc/gm/Xtns/%s.gem ; ", param5, param5, param4);
        }
        else {
            sprintf(&param2, "mkdir --verbose -p %s/etc/gm/Xtns ; cp -fv ../entries-gisman2 %s/etc/gm/Xtns/%s.gem ; ", param5, param5, param4);
        }
        strcpy(0x8068ae0, &param2);
    }
    else {
        eax_16 = __errno_location();
        eax_18 = *eax_16;
        if (eax_18 != 2) {
            fclose(eax_12);
            eax = __errno_location();
            eax = *eax;
            strerror(eax);
            print_error(param1, -32, 0x80553f3, esp - 0x810);
        }
    }
    eax = eax_5 ^ *20;
    if (eax != 0) {
        __stack_chk_fail();
    }
    return;
}

/** address: 0x0804e7f3 */
void register_html(char param1[], char param2, char param3, char param4[], char param5[], char param6, char param7, __size32 param8, int param9, int param10, int param11, int param12)
{
    __size32 eax; 		// r24
    FILE *eax_12; 		// r24{28}
    unsigned int eax_16; 		// r24{35}
    char *eax_18; 		// r24{45}
    void *eax_21; 		// r24{49}
    char *eax_24; 		// r24{65}
    size_t eax_27; 		// r24{58}
    void *eax_28; 		// r24{59}
    int eax_3; 		// r24{14}
    union { char *; int; } eax_30; 		// r24{61}
    unsigned int eax_31; 		// r24{74}
    union { char *; int; } eax_34; 		// r24{70}
    FILE *eax_5; 		// r24{16}
    union { __size32; unsigned int *; } eax_8; 		// r24{18}
    unsigned int eax_9; 		// r24{19}
    int ecx; 		// r25
    int edx; 		// r26
    int esp; 		// r28
    unsigned int local10; 		// m[esp - 0x1018]
    unsigned int local13; 		// m[esp - 0x101c]

    eax_3 = *20;
    sprintf(&param7, "%s/docs/html/index.html", param9);
    eax_5 = fopen(&param7, "r");
    if (eax_5 != 0) {
        memcpy(0x8067ac0, 0x8055cb4, 32);
        mkstemp(0x8067ac0);
        eax_12 = fopen(0x8067ac0, "w+");
        if (eax_12 == 0) {
            eax = __errno_location();
            eax = *eax;
            strerror(eax);
            print_error(param5, -24, 0x8055cd8, 0x8067ac0);
        }
        atexit(0x8048fc2);
        eax_16 = *(global_0x08056f68 + 0xc338);
        if (eax_16 == 0) {
            sprintf(&param6, "cp -f %s %s/docs/html/index.html &>%s ; chmod a+r %s/docs/html/index.html &>%s ;", 0x8067ac0, param9, 0x80672c0, param9, 0x80672c0);
        }
        else {
            sprintf(&param6, "cp -vf %s %s/docs/html/index.html ; chmod -v a+r %s/docs/html/index.html ;", 0x8067ac0, param9, param9);
        }
        strcpy(0x80692e0, &param6);
        local10 = 0;
        for(;;) {
            eax_18 = fgets(&param6, 0x800, eax_5);
            if (eax_18 == 0) {
                break;
            }
            local10++;
        }
        if (local10 != 0) {
            rewind(eax_5);
            eax_21 = calloc(local10 + 10, 4);
            local13 = 0;
            while (local10 + 10 > (int)local13) {
                *(__size32*)(local13 * 4 + eax_21) = 0;
                local13++;
            }
            local13 = 0;
            for(;;) {
                eax_24 = fgets(&param6, 0x800, eax_5); /* Warning: also results in ecx, edx */
                if (eax_24 != 0) {
                    eax_27 = strlen(&param6);
                    eax_28 = malloc(eax_27 + 1);
                    *(union { void *; __size32; }*)(local13 * 4 + eax_21) = eax_28;
                    eax_30 = *(local13 * 4 + eax_21);
                    strcpy(eax_30, &param6);
                    local13++;
                }
            }
            new_ext_html(param1, param2, param3, param4, param5, param8, eax_21, param10, param11, param12, ecx, edx);
            local13 = 0;
            eax_31 = *(local13 * 4 + eax_21);
            while (eax_31 != 0) {
                eax_34 = *(local13 * 4 + eax_21);
                fprintf(eax_12, eax_34);
                local13++;
                eax_31 = *(local13 * 4 + eax_21);
            }
            fflush(eax_12);
            fclose(eax_5);
            fclose(eax_12);
            local13 = 0;
            while (local10 + 10 > (int)local13) {
                eax = *(local13 * 4 + eax_21);
                free(eax);
                local13++;
            }
            free(eax_21);
        }
    }
    else {
        eax_8 = __errno_location();
        eax_9 = *eax_8;
        if (eax_9 != 2) {
            fclose(eax_5);
            eax = __errno_location();
            eax = *eax;
            strerror(eax);
            print_error(param5, -24, 0x8055c95, esp - 0x810);
        }
    }
    eax = eax_3 ^ *20;
    if (eax != 0) {
        __stack_chk_fail();
    }
    return;
}

/** address: 0x0804b5e3 */
void deregister_extension(char param1[], char param2, union { char[] *; __size32; } param3)
{
    __size32 eax; 		// r24
    __size32 eax_11; 		// r24{9}
    __size32 eax_14; 		// r24{11}
    __size32 eax_17; 		// r24{16}
    FILE *eax_5; 		// r24{6}
    union { __size32; __size32 *; } eax_8; 		// r24{8}
    int esp; 		// r28

    sprintf(&param2, "%s/etc/extensions.db", param3);
    eax_5 = fopen(&param2, "r");
    if (eax_5 != 0) {
    }
    else {
        eax_8 = __errno_location();
        eax_11 = *eax_8;
        if (eax_11 == 2) {
            eax_14 = *(global_0x08056f68 + 0x11360);
            if (eax_14 == 0) {
                fclose(eax_5);
                print_error(param1, -19, 0x8054fbc, param3);
            }
        }
        eax_17 = *(global_0x08056f68 + 0x11360);
        if (eax_17 == 0) {
            fclose(eax_5);
            eax = __errno_location();
            eax = *eax;
            strerror(eax);
            print_error(param1, -19, 0x8054d16, esp - 0x810);
        }
    }
    if ( ~flags) {
        *(__size32*)(%ebp - 0x2814) = 0;
        *(__size32*)(%esp + 8) = 32;
        *(__size32*)(%esp + 4) = %eax;
        *(__size32*)%esp = 0x8063ac0;
        memcpy(*(%esp + 4), *(%esp + 8), *(%esp + 12));
        *(__size32*)%esp = 0x8063ac0;
        mkstemp(*(%esp + 4));
        *(__size32*)(%esp + 4) = %edx;
        *(__size32*)%esp = %eax;
        fopen(*(%esp + 4), *(%esp + 8));
        *(__size32*)(%ebp - 0x2820) = %eax;
        if ( ~flags) {
            __errno_location();
            *(__size32*)%esp = %eax;
            strerror(*(%esp + 4));
            *(__size32*)(%esp + 12) = %eax;
            *(__size32*)(%esp + 8) = %eax;
            *(__size32*)(%esp + 4) = 0x8054fec;
            *(__size32*)%esp = -19;
            print_error(*(%esp - 0x810), *(%esp + 4), *(%esp + 8), *(%esp + 12));
        }
        *(__size32*)(%ebp - 0x2814) = 1;
        *(__size32*)%esp = 0x8048fc2;
        atexit(*(%esp + 4));
    }
    if ( ~flags) {
        *(__size32*)(%ebp - 0x2824) = 0;
        for(;;) {
            *(__size32*)(%esp + 8) = %eax;
            *(__size32*)(%esp + 4) = 0x800;
            *(__size32*)%esp = %eax;
            nc_fgets_nb(*(%esp + 4), *(%esp + 8), *(%esp + 12));
            if (flags) {
                *(__size32*)(%esp + 28) = %ecx;
                *(__size32*)(%esp + 24) = %ecx;
                *(__size32*)(%esp + 20) = %ecx;
                *(__size32*)(%esp + 16) = %ecx;
                *(__size32*)(%esp + 12) = %ecx;
                *(__size32*)(%esp + 8) = %ecx;
                *(__size32*)(%esp + 4) = %edx;
                *(__size32*)%esp = %eax;
                __isoc99_sscanf();
                *(__size32*)(%ebp - 0x2810) = %eax;
                if (flags) {
                    continue;
                }
                *(__size32*)(%ebp - 0x2818) = 1;
                *(__size32*)(%esp + 4) = %eax;
                *(__size32*)%esp = %eax;
                strcmp(*(%esp + 4), *(%esp + 8));
                if ( ~flags) {
                    *(__size32*)(%ebp - 0x2818) = 0;
                    *(__size32*)(%ebp - 0x2824) = 1;
                }
                if (flags) {
                    continue;
                }
                *(__size32*)(%esp + 4) = %eax;
                *(__size32*)%esp = %eax;
                strstr(*(%esp + 4), *(%esp + 8));
                if ( ~flags) {
                    *(__size32*)(%esp + 12) = %eax;
                    *(__size32*)(%esp + 8) = %eax;
                    *(__size32*)(%esp + 4) = 0x805506c;
                    *(__size32*)%esp = -19;
                    print_error(*(%esp - 0x810), *(%esp + 4), *(%esp + 8), *(%esp + 12));
                }
                *(__size32*)(%esp + 4) = %eax;
                *(__size32*)%esp = %eax;
                fprintf(*(%esp + 4), *(%esp + 8));
            }
        }
        if ( ~flags) {
            *(__size32*)(%esp + 12) = %eax;
            *(__size32*)(%esp + 8) = %eax;
            *(__size32*)(%esp + 4) = 0x80550a4;
            *(__size32*)%esp = -19;
            print_error(*(%esp - 0x810), *(%esp + 4), *(%esp + 8), *(%esp + 12));
        }
        *(__size32*)%esp = %eax;
        fclose(*(%esp + 4));
        *(__size32*)%esp = %eax;
        fclose(*(%esp + 4));
    }
    if ( ~flags) {
        __stack_chk_fail();
    }
    return;
}

/** address: 0x0804cec7 */
__size32 deregister_entries_gisman(char param1[], char param2[], __size32 param3, char param4[], char param5, char param6, union { char[] *; __size32; } param7, union { char[] *; __size32; } param8, __size32 param9)
{
    __size32 eax; 		// r24
    union { __size32; int *; } eax_11; 		// r24{15}
    int eax_12; 		// r24{16}
    FILE *eax_14; 		// r24{27}
    unsigned int eax_18; 		// r24{34}
    char *eax_21; 		// r24{44}
    __size32 eax_24; 		// r24{47}
    void *eax_25; 		// r24{50}
    char *eax_28; 		// r24{68}
    __size32 eax_3; 		// r24{18}
    unsigned int eax_31; 		// r24{71}
    __size32 eax_34; 		// r24{74}
    size_t eax_35; 		// r24{60}
    void *eax_36; 		// r24{61}
    union { char *; int; } eax_39; 		// r24{63}
    __size32 eax_4; 		// r24{158}
    union { __size32; char *; } eax_41; 		// r24{76}
    char *eax_42; 		// r24{77}
    char *eax_45; 		// r24{78}
    int eax_49; 		// r24{81}
    int eax_5; 		// r24{11}
    int eax_52; 		// r24{82}
    int eax_55; 		// r24{85}
    __size32 eax_56; 		// r24{90}
    int eax_57; 		// r24{93}
    __size32 eax_60; 		// r24{96}
    int eax_61; 		// r24{98}
    __size32 eax_64; 		// r24{101}
    int eax_65; 		// r24{113}
    int eax_68; 		// r24{116}
    int eax_71; 		// r24{117}
    unsigned int eax_74; 		// r24{134}
    union { __size32; char *; } eax_77; 		// r24{130}
    char *eax_78; 		// r24{142}
    FILE *eax_8; 		// r24{13}
    __size32 eax_80; 		// r24{157}
    union { __size32; union { void *; __size32; } *; } ebx; 		// r27
    int ecx; 		// r25
    int edx; 		// r26
    int esp; 		// r28
    unsigned int local14; 		// m[esp - 0x1818]
    unsigned int local17; 		// m[esp - 0x181c]
    int local18; 		// m[esp - 0x1838]
    __size32 local19; 		// m[esp - 0x184c]
    unsigned int local22; 		// m[esp - 0x1824]
    __size32 local26; 		// param9{66}
    __size32 local27; 		// eax_4{158}
    __size32 local28; 		// eax{162}

    eax_5 = *20;
    sprintf(&param6, "%s/etc/dm/menu.tcl", param8);
    local26 = param9;
    eax_8 = fopen(&param6, "r");
    if (eax_8 != 0) {
        memcpy(0x80642c0, 0x8055424, 32);
        mkstemp(0x80642c0);
        eax_14 = fopen(0x80642c0, "w+");
        if (eax_14 == 0) {
            eax = __errno_location();
            eax = *eax;
            strerror(eax);
            print_error(param2, -21, 0x8055448, 0x80642c0);
        }
        atexit(0x8048fc2);
        eax_18 = *(global_0x08056f68 + 0xc338);
        if (eax_18 == 0) {
            sprintf(&param5, "cp -f %s/etc/dm/menu.tcl %s/etc/dm/menu.tcl.gem.bak &> %s ; \t\t\t\t\t\tcp -f %s %s/etc/dm/menu.tcl &> %s ; chmod a+r %s/etc/dm/menu.tcl &> %s ;", param8, param8, 0x80672c0, 0x80642c0, param8, 0x80672c0, param8, 0x80672c0);
        }
        else {
            sprintf(&param5, "cp -vf %s/etc/dm/menu.tcl %s/etc/dm/menu.tcl.gem.bak ; \t\t\t\t\t\tcp -vf %s %s/etc/dm/menu.tcl ; chmod -v a+r %s/etc/dm/menu.tcl ;", param8, param8, 0x80642c0, param8, param8);
        }
        strcpy(0x80682e0, &param5);
        local14 = 0;
        for(;;) {
            eax_21 = fgets(&param5, 0x800, eax_8);
            if (eax_21 == 0) {
                break;
            }
            local14++;
        }
        if (local14 != 0) {
            rewind(eax_8);
            eax_25 = calloc(local14 + 1, 4);
            local17 = 0;
            while (local14 + 1 > (int)local17) {
                *(__size32*)(local17 * 4 + eax_25) = 0;
                local17++;
            }
            local17 = 0;
            for(;;) {
                param9 = local26;
                eax_28 = fgets(&param5, 0x800, eax_8);
                if (eax_28 != 0) {
                    ebx = local17 * 4 + eax_25;
                    eax_35 = strlen(&param5);
                    local26 = ebx;
                    eax_36 = malloc(eax_35 + 1);
                    *(union { void *; __size32; }*)ebx = eax_36;
                    eax_39 = *(local17 * 4 + eax_25);
                    strcpy(eax_39, &param5);
                    local17++;
                }
            }
            ecx = sprintf(&param5, "#(DO_NOT_REMOVE_THIS_COMMENT) <%s> {cascad", param7); /* Warning: also results in edx */
            eax_31 = find_pos(esp - 0x1010, eax_25, 0, ecx, edx);
            if (eax_31 != -1) {
                eax_41 = *(eax_31 * 4 + eax_25);
                eax_42 = strchr(eax_41, 34);
                eax_45 = strchr(eax_42 + 1, 34);
                strcpy(&param4, eax_42 + 1);
                *(__size8*)(esp + eax_45 - eax_42 - 0x1811) = 0;
                eax_49 = find_pos(0x80551e8, eax_25, 0, eax_45 - eax_42 - 1, eax_45); /* Warning: also results in ecx, edx */
                eax_52 = find_pos(0x8055264, eax_25, eax_49 + 1, ecx, edx); /* Warning: also results in ecx, edx */
                local18 = eax_52 - 1;
                if (eax_52 - 1 == -1) {
                    eax_55 = find_pos(0x8055212, eax_25, 0, ecx, edx);
                    local18 = eax_55;
                }
                if (eax_49 != -1) {
                    ecx = sprintf(&param5, "{cascad \"%s\"", &param4); /* Warning: also results in edx */
                    eax_57 = find_pos(esp - 0x1010, eax_25, eax_49, ecx, edx); /* Warning: also results in ecx, edx */
                    if (eax_57 != -1 && eax_57 <= local18) {
                        eax_61 = find_pos(0x805599a, eax_25, eax_57, ecx, edx);
                        if (eax_61 != -1 && eax_61 <= local18) {
                            local19 = 0;
                            local17 = 0;
                            while (eax_61 - eax_57 + 1 > local17) {
                                delete_str(param1, param3, eax_57, eax_25, eax_61 - eax_57, eax_61, param9);
                                local19++;
                                local17++;
                            }
                            ecx = sprintf(&param5, "#(DO_NOT_REMOVE_THIS_COMMENT) <%s> {cascad", param7); /* Warning: also results in edx */
                            eax_65 = find_pos(esp - 0x1010, eax_25, 0, ecx, edx); /* Warning: also results in ecx, edx */
                            ecx = delete_str(param1, param3, eax_65, eax_25, ecx, edx, param9); /* Warning: also results in edx */
                            local19++;
                            eax_68 = find_pos(0x80551e8, eax_25, 0, ecx, edx); /* Warning: also results in ecx, edx */
                            eax_71 = find_pos(0x8055264, eax_25, eax_68 + 1, ecx, edx);
                            if (eax_71 - eax_68 - 1 <= 2) {
                                local17 = 0;
                                while (eax_71 - eax_68 > local17) {
                                    delete_str(param1, param3, eax_68, eax_25, eax_71 - eax_68 - 1, eax_71 - 1, param9);
                                    local19++;
                                    local17++;
                                }
                            }
                            local17 = 0;
                            eax_74 = *(local17 * 4 + eax_25);
                            while (eax_74 != 0) {
                                eax_77 = *(local17 * 4 + eax_25);
                                fprintf(eax_14, eax_77);
                                local17++;
                                eax_74 = *(local17 * 4 + eax_25);
                            }
                            fflush(eax_14);
                            rewind(eax_14);
                            local22 = 0;
                            for(;;) {
                                eax_78 = fgets(&param5, 0x800, eax_14);
                                if (eax_78 == 0) {
                                    break;
                                }
                                local22++;
                            }
                            if (local22 == 0) {
                                print_warning(param2, 0x80556e4, 0x800);
                                memcpy(0x80682e0, 0x8055722, 1);
                            }
                            fclose(eax_8);
                            fclose(eax_14);
                            local17 = 0;
                            while (local14 + 1 > (int)local17) {
                                eax = *(local17 * 4 + eax_25);
                                free(eax);
                                local17++;
                            }
                            free(eax_25);
                            eax_80 = local19;
                            local27 = eax_80;
                        }
                        else {
                            print_warning(param2, 0x80559a4, esp - 0x1810);
                            eax_64 = -1;
                            local27 = eax_64;
                        }
                    }
                    else {
                        print_warning(param2, 0x8055968, esp - 0x1810);
                        eax_60 = -1;
                        local27 = eax_60;
                    }
                }
                else {
                    print_warning(param2, 0x8055949, eax_25);
                    eax_56 = -1;
                    local27 = eax_56;
                }
            }
            else {
                print_warning(param2, 0x8055914, eax_25);
                eax_34 = -1;
                local27 = eax_34;
            }
        }
        else {
            eax_24 = -1;
            local27 = eax_24;
        }
    }
    else {
        eax_11 = __errno_location();
        eax_12 = *eax_11;
        if (eax_12 != 2) {
            fclose(eax_8);
            eax = __errno_location();
            eax = *eax;
            strerror(eax);
            print_error(param2, -22, 0x80553f3, esp - 0x810);
        }
        eax_3 = 0;
        local27 = eax_3;
    }
    eax_4 = local27;
    edx = eax_5 ^ *20;
    local28 = eax_4;
    if (edx != 0) {
        eax = __stack_chk_fail();
        local28 = eax;
    }
    eax = local28;
    return eax;
}

/** address: 0x0804d743 */
void deregister_entries_gisman2(char param1[], char param2, char param3, union { char[] *; __size32; } param4, union { char[] *; __size32; } param5)
{
    __size32 eax; 		// r24
    FILE *eax_11; 		// r24{9}
    __size32 eax_14; 		// r24{19}
    __size32 eax_4; 		// r24{12}
    union { __size32; __size32 *; } eax_6; 		// r24{11}
    int eax_8; 		// r24{7}
    int esp; 		// r28

    eax_8 = *20;
    sprintf(&param3, "%s/etc/gm/Xtns/%s.gem", param5, param4);
    eax_11 = fopen(&param3, "r");
    if (eax_11 != 0) {
        eax_14 = *(global_0x08056f68 + 0xc338);
        if (eax_14 == 0) {
            sprintf(&param2, "rm -f %s/etc/gm/Xtns/%s.gem ; ", param5, param4);
        }
        else {
            sprintf(&param2, "rm -vf %s/etc/gm/Xtns/%s.gem ; ", param5, param4);
        }
        strcpy(0x80682e0, &param2);
    }
    else {
        eax_6 = __errno_location();
        eax_4 = *eax_6;
        if (eax_4 != 2) {
            fclose(eax_11);
            eax = __errno_location();
            eax = *eax;
            strerror(eax);
            print_error(param1, -33, 0x80553f3, esp - 0x810);
        }
    }
    eax = eax_8 ^ *20;
    if (eax != 0) {
        __stack_chk_fail();
    }
    return;
}

/** address: 0x0804ec17 */
void deregister_html(char param1[], char param2[], __size32 param3, char param4[], char param5, char param6, __size32 param7, union { char[] *; __size32; } param8, __size32 param9)
{
    __size32 eax; 		// r24
    FILE *eax_12; 		// r24{25}
    unsigned int eax_16; 		// r24{32}
    char *eax_18; 		// r24{42}
    void *eax_21; 		// r24{46}
    char *eax_24; 		// r24{64}
    size_t eax_27; 		// r24{56}
    void *eax_28; 		// r24{57}
    int eax_3; 		// r24{11}
    union { char *; int; } eax_30; 		// r24{59}
    unsigned int eax_31; 		// r24{73}
    union { __size32; char *; } eax_34; 		// r24{69}
    FILE *eax_5; 		// r24{13}
    union { __size32; unsigned int *; } eax_8; 		// r24{15}
    unsigned int eax_9; 		// r24{16}
    union { __size32; union { void *; __size32; } *; } ebx; 		// r27
    int ecx; 		// r25
    int edx; 		// r26
    int esp; 		// r28
    unsigned int local11; 		// m[esp - 0x1018]
    unsigned int local14; 		// m[esp - 0x101c]
    __size32 local20; 		// param9{62}

    eax_3 = *20;
    sprintf(&param6, "%s/docs/html/index.html", param8);
    local20 = param9;
    eax_5 = fopen(&param6, "r");
    if (eax_5 != 0) {
        memcpy(0x8067ac0, 0x8055cb4, 32);
        mkstemp(0x8067ac0);
        eax_12 = fopen(0x8067ac0, "w+");
        if (eax_12 == 0) {
            eax = __errno_location();
            eax = *eax;
            strerror(eax);
            print_error(param4, -24, 0x8055cd8, 0x8067ac0);
        }
        atexit(0x8048fc2);
        eax_16 = *(global_0x08056f68 + 0xc338);
        if (eax_16 == 0) {
            sprintf(&param5, "cp -f %s %s/docs/html/index.html &>%s ; chmod a+r %s/docs/html/index.html &>%s ;", 0x8067ac0, param8, 0x80672c0, param8, 0x80672c0);
        }
        else {
            sprintf(&param5, "cp -vf %s %s/docs/html/index.html ; chmod -v a+r %s/docs/html/index.html ;", 0x8067ac0, param8, param8);
        }
        strcpy(0x80692e0, &param5);
        local11 = 0;
        for(;;) {
            eax_18 = fgets(&param5, 0x800, eax_5);
            if (eax_18 == 0) {
                break;
            }
            local11++;
        }
        if (local11 != 0) {
            rewind(eax_5);
            eax_21 = calloc(local11 + 1, 4);
            local14 = 0;
            while (local11 + 1 > (int)local14) {
                *(__size32*)(local14 * 4 + eax_21) = 0;
                local14++;
            }
            local14 = 0;
            for(;;) {
                param9 = local20;
                eax_24 = fgets(&param5, 0x800, eax_5); /* Warning: also results in ecx, edx */
                if (eax_24 != 0) {
                    ebx = local14 * 4 + eax_21;
                    eax_27 = strlen(&param5);
                    local20 = ebx;
                    eax_28 = malloc(eax_27 + 1);
                    *(union { void *; __size32; }*)ebx = eax_28;
                    eax_30 = *(local14 * 4 + eax_21);
                    strcpy(eax_30, &param5);
                    local14++;
                }
            }
            delete_ext_html(param1, param2, param3, param4, param7, eax_21, ecx, edx, param9);
            local14 = 0;
            eax_31 = *(local14 * 4 + eax_21);
            while (eax_31 != 0) {
                eax_34 = *(local14 * 4 + eax_21);
                fprintf(eax_12, eax_34);
                local14++;
                eax_31 = *(local14 * 4 + eax_21);
            }
            fflush(eax_12);
            fclose(eax_5);
            fclose(eax_12);
            local14 = 0;
            while (local11 + 1 > (int)local14) {
                eax = *(local14 * 4 + eax_21);
                free(eax);
                local14++;
            }
            free(eax_21);
        }
    }
    else {
        eax_8 = __errno_location();
        eax_9 = *eax_8;
        if (eax_9 != 2) {
            fclose(eax_5);
            eax = __errno_location();
            eax = *eax;
            strerror(eax);
            print_error(param4, -24, 0x8055c95, esp - 0x810);
        }
    }
    eax = eax_3 ^ *20;
    if (eax != 0) {
        __stack_chk_fail();
    }
    return;
}

/** address: 0x0804a3db */
void dump_plain(char param1[], char param2, union { char *; __size32; } param3, union { char *; __size32; } param4)
{
    __size32 eax; 		// r24
    __size32 eax_11; 		// r24{19}
    int eax_3; 		// r24{6}
    FILE *eax_6; 		// r24{9}
    FILE *eax_9; 		// r24{16}
    int esp; 		// r28

    eax_3 = *20;
    memcpy(param4, 0x8054aec, 32);
    mkstemp(param4);
    eax_6 = fopen(param4, "w+");
    if (eax_6 == 0) {
        eax = __errno_location();
        eax = *eax;
        strerror(eax);
        print_error(param1, -23, 0x8054b10, param4);
    }
    atexit(0x8048fc2);
    eax_9 = fopen(param3, "r");
    for(;;) {
        eax_11 = nc_fgets(esp - 0x810, 0x800, eax_9);
        if (eax_11 == 0) {
            break;
        }
        fprintf(eax_6, &param2);
    }
    fclose(eax_9);
    fclose(eax_6);
    eax = eax_3 ^ *20;
    if (eax != 0) {
        __stack_chk_fail();
    }
    return;
}

/** address: 0x0804bf05 */
void check_ext_menu(char param1[], char param2, char param3, char param4[], __size32 param5, __size32 param6, __size32 param7)
{
    __size32 eax; 		// r24
    __size32 ecx; 		// r25
    __size32 edx; 		// r26

    eax = find_pos(0x80551e8, param5, 0, param6, param7); /* Warning: also results in ecx, edx */
    if (eax == -1) {
        eax = find_pos(0x80551fe, param5, 0, ecx, edx); /* Warning: also results in ecx, edx */
        if (eax != -1) {
            insert_str(param1, param2, param3, param4, 0x8055232, eax, param5);
            insert_str(param1, param2, param3, param4, 0x805524c, eax + 1, param5);
        }
        else {
            eax = find_pos(0x8055212, param5, 0, ecx, edx);
            if (eax == -1) {
                print_error(param4, -21, 0x8055215, 0);
            }
            insert_str(param1, param2, param3, param4, 0x8055232, eax, param5);
            insert_str(param1, param2, param3, param4, 0x805524c, eax + 1, param5);
        }
    }
    return;
}

/** address: 0x0804c009 */
__size32 new_submenu(char param1[], char param2, char param3, char param4[], char param5[], char param6, char param7[], union { char[] *; __size32; } param8, union { char *; __size32; } param9, union { void *; int; } param10, __size32 param11, __size32 param12)
{
    __size32 eax; 		// r24
    int eax_12; 		// r24{20}
    unsigned int eax_15; 		// r24{23}
    __size32 eax_18; 		// r24{26}
    char *eax_19; 		// r24{28}
    __size32 eax_2; 		// r24{66}
    char *eax_22; 		// r24{29}
    char *eax_25; 		// r24{30}
    int eax_29; 		// r24{34}
    int eax_3; 		// r24{14}
    __size32 eax_32; 		// r24{37}
    unsigned int eax_33; 		// r24{40}
    __size32 eax_36; 		// r24{62}
    __size32 eax_37; 		// r24{65}
    union { __size32; char *; } eax_38; 		// r24{43}
    char *eax_39; 		// r24{44}
    char *eax_42; 		// r24{45}
    int eax_45; 		// r24{48}
    unsigned int eax_48; 		// r24{53}
    int eax_6; 		// r24{15}
    int eax_9; 		// r24{17}
    int ecx; 		// r25
    int edx; 		// r26
    int esp; 		// r28
    __size32 local17; 		// eax_2{66}
    __size32 local18; 		// eax{70}
    int local3; 		// m[esp - 0x1814]
    int local4; 		// m[esp - 0x1820]
    unsigned int local8; 		// m[esp - 0x181c]
    unsigned int local9; 		// m[esp - 0x1818]

    eax_3 = *20;
    eax_6 = find_pos(0x8055250, param10, 0, param11, param12); /* Warning: also results in ecx, edx */
    local3 = eax_6;
    eax_9 = find_pos(0x8055264, param10, eax_6 + 1, ecx, edx); /* Warning: also results in ecx, edx */
    local4 = eax_9 - 1;
    if (eax_9 - 1 == -1) {
        eax_12 = find_pos(0x8055212, param10, 0, ecx, edx);
        local4 = eax_12;
    }
    eax_15 = is_submenu(param9);
    if (eax_15 != 0) {
        eax_19 = strrchr(param9, 93);
        eax_22 = strchr(param9, 91);
        eax_25 = strchr(param9, 91);
        strncpy(&param7, eax_25 + 1, eax_19 - eax_22);
        *(__size8*)(esp + eax_19 - eax_22 - 0x811) = 0;
        ecx = sprintf(&param5, "{cascad \"%s\"", &param7); /* Warning: also results in edx */
        eax_29 = find_pos(esp - 0x1810, param10, eax_6, ecx, edx); /* Warning: also results in ecx, edx */
        if (eax_29 == -1 || eax_29 >= local4) {
            local8 = eax_6 + 1;
            eax_33 = find_pos(0x80552ed, param10, eax_6, ecx, edx);
            local9 = eax_33;
            while (local9 != -1 && (int)local9 < local4) {
                eax_38 = *(local9 * 4 + param10);
                eax_39 = strchr(eax_38, 34);
                eax_42 = strchr(eax_39 + 1, 34);
                strncpy(&param6, eax_39 + 1, eax_42 - eax_39);
                *(__size8*)(esp + eax_42 - eax_39 - 0x1011) = 0;
                eax_45 = strcmp(&param7, &param6); /* Warning: also results in ecx, edx */
                if (eax_45 >= 0) {
                    local3++;
                    eax_48 = find_pos(0x80552ed, param10, local3, ecx, edx);
                    local9 = eax_48;
                }
                else {
                    local8 = local9;
                    goto bb0x804c31e;
                }
            }
bb0x804c31e:
            sprintf(&param7, " \t\t\t%s {} \"\" 1 {\n", &param5);
            insert_str(param1, param2, param3, param4, esp - 0x810, local8, param10);
            ecx = insert_str(param1, param2, param3, param4, 0x8055308, local8 + 1, param10); /* Warning: also results in edx */
            eax_36 = find_pos(0x8055212, param10, 0, ecx, edx);
            sprintf(&param7, "#(DO_NOT_REMOVE_THIS_COMMENT) <%s> %s {} \"\" 1 {\n", param8, &param5);
            insert_str(param1, param2, param3, param4, esp - 0x810, eax_36 + 1, param10);
            eax_37 = local8 + 1;
            local17 = eax_37;
        }
        else {
            print_warning(param4, 0x80552bc, esp - 0x810);
            eax_32 = -1;
            local17 = eax_32;
        }
    }
    else {
        print_warning(param4, 0x8055274, param10);
        eax_18 = -1;
        local17 = eax_18;
    }
    eax_2 = local17;
    edx = eax_3 ^ *20;
    local18 = eax_2;
    if (edx != 0) {
        eax = __stack_chk_fail();
        local18 = eax;
    }
    eax = local18;
    return eax;
}

/** address: 0x0804c41b */
__size32 new_item(char param1[], char param2, char param3, char param4[], char param5, char param6[], char param7[], union { char *; __size32; } param8, __size32 param9, int param10)
{
    __size8 al; 		// r8
    int eax; 		// r24
    int eax_11; 		// r24{33}
    char *eax_12; 		// r24{23}
    int eax_16; 		// r24{35}
    int eax_17; 		// r24{37}
    int eax_2; 		// r24{44}
    int eax_3; 		// r24{12}
    char *eax_6; 		// r24{14}
    int eax_9; 		// r24{18}
    int edx; 		// r26
    int esp; 		// r28
    int local16; 		// eax_2{44}
    int local17; 		// eax{48}
    union { char *; __size32; } local2; 		// m[esp - 0x1814]
    int local4; 		// m[esp - 0x1818]

    eax_3 = *20;
    al = chop(param8);
    eax_6 = strtok(param8, ";");
    local2 = eax_6;
    if (eax_6 != 0) {
        strcpy(&param7, eax_6);
        local4 = 0;
        while (local2 != 0) {
            eax_12 = strtok(0, ";");
            local2 = eax_12;
            if (eax_12 != 0) {
                strcpy(&param6, eax_12);
            }
            local4++;
        }
        if (local4 <= 2) {
            eax_16 = strcmp(&param7, "-");
            if (eax_16 != 0) {
bb0x804c582:
                sprintf(&param5, " \t\t\t {command \"%s\" {} \"%s\" {} -command {%s }}\n", &param7, &param6, &param6);
            }
            else {
                eax_17 = strcmp(&param7, "-");
                if (eax_17 != 0) {
                    goto bb0x804c582;
                }
                else {
                    memcpy(&param5, 0x805539e, 18);
                }
            }
            insert_str(param1, param2, param3, param4, esp - 0x1810, param10, param9);
            eax = param10 + 1;
            local16 = eax;
        }
        else {
            print_warning(param4, 0x8055368, local4);
            eax_11 = -1;
            local16 = eax_11;
        }
    }
    else {
        print_warning(param4, 0x8055344, 0x8055341);
        eax_9 = -1;
        local16 = eax_9;
    }
    eax_2 = local16;
    edx = eax_3 ^ *20;
    local17 = eax_2;
    if (edx != 0) {
        eax = __stack_chk_fail();
        local17 = eax;
    }
    eax = local17;
    return eax; /* WARNING: Also returning: al := al */
}

/** address: 0x0804e100 */
void new_ext_html(char param1[], char param2, char param3, char param4[], char param5, union { char[] *; unsigned int; } param6, unsigned int param7, int param8, int param9, int param10, __size32 param11, __size32 param12)
{
    __size32 eax; 		// r24
    int eax_11; 		// r24{26}
    __size32 eax_14; 		// r24{27}
    int eax_15; 		// r24{35}
    unsigned int eax_18; 		// r24{37}
    int eax_2; 		// r24{14}
    unsigned int eax_21; 		// r24{40}
    union { char *; int; } eax_24; 		// r24{46}
    unsigned int eax_26; 		// r24{49}
    union { __size32; char *; } eax_27; 		// r24{52}
    char *eax_28; 		// r24{53}
    union { __size32; char *; } eax_31; 		// r24{54}
    char *eax_32; 		// r24{55}
    int eax_35; 		// r24{58}
    int eax_5; 		// r24{15}
    int eax_8; 		// r24{18}
    int ecx; 		// r25
    int edx; 		// r26
    int esp; 		// r28
    unsigned int local16; 		// m[esp - 0x81c]
    int local3; 		// m[esp - 0x814]
    int local8; 		// m[esp - 0x820]
    unsigned int local9; 		// m[esp - 0x828]

    eax_2 = *20;
    eax_5 = find_pos(0x8055a54, param7, 0, param11, param12); /* Warning: also results in ecx, edx */
    local3 = eax_5;
    if (eax_5 >= 0) {
bb0x804e19a:
        eax_11 = find_pos(0x8055afe, param7, local3, ecx, edx); /* Warning: also results in ecx, edx */
        eax_14 = find_pos(0x8055b04, param7, local3, ecx, edx); /* Warning: also results in ecx, edx */
        if (eax_14 == -1) {
            insert_str(param1, param2, param3, param4, 0x8055b24, eax_11, param7);
            insert_str(param1, param2, param3, param4, 0x8055b44, eax_11 + 1, param7);
            insert_str(param1, param2, param3, param4, 0x8055b4a, eax_11 + 2, param7);
            ecx = insert_str(param1, param2, param3, param4, 0x8055b51, eax_11 + 3, param7); /* Warning: also results in edx */
        }
        eax_15 = find_pos(0x8055b04, param7, local3, ecx, edx); /* Warning: also results in ecx, edx */
        local8 = eax_15;
        eax_18 = find_pos(0x8055b56, param7, eax_15, ecx, edx);
        local9 = eax_15 + 2;
        ecx = sprintf(&param5, "\">%s", param6); /* Warning: also results in edx */
        eax_21 = find_pos(esp - 0x810, param7, eax_15 + 2, ecx, edx); /* Warning: also results in ecx, edx */
        if (eax_21 == -1) {
            eax_26 = find_pos(0x8055bc9, param7, eax_15, ecx, edx);
            local16 = eax_26;
            while (local16 != -1 && (int)local16 < (int)eax_18) {
                eax_27 = *(local16 * 4 + param7);
                eax_28 = strrchr(eax_27, 34);
                eax_31 = *(local16 * 4 + param7);
                eax_32 = strrchr(eax_31, 60);
                strncpy(&param5, eax_28 + 2, eax_32 - eax_28);
                *(__size8*)(esp + eax_32 - eax_28 - 0x811) = 0;
                eax_35 = strcmp(param6, &param5); /* Warning: also results in ecx, edx */
                if (eax_35 >= 0) {
                    local8++;
                    eax = find_pos(0x8055bc9, param7, local8, ecx, edx);
                    local16 = eax;
                }
                else {
                    local9 = local16;
                    goto bb0x804e4f4;
                }
            }
bb0x804e4f4:
            sprintf(&param5, "<li><a href=\"../extensions/%s/index.html\">%s (%i.%i.%i)</a>\n", param6, param6, param8, param9, param10);
            insert_str(param1, param2, param3, param4, esp - 0x810, local9, param7);
        }
        else {
            print_warning(param4, 0x8055b64, param6);
            if (FORCE == 0) {
            }
            else {
                if (UPGRADE != 0) {
                    sprintf(&param5, "<li><a href=\"../extensions/%s/index.html\">%s (%i.%i.%i)</a>\n", param6, param6, param8, param9, param10);
                    eax_24 = *(eax_21 * 4 + param7);
                    strcpy(eax_24, &param5);
                }
            }
        }
    }
    else {
        eax_8 = find_pos(0x8055a70, param7, 0, ecx, edx); /* Warning: also results in ecx, edx */
        local3 = eax_8;
        if (eax_8 >= 0) {
            goto bb0x804e19a;
        }
        else {
            print_warning(param4, 0x8055abc, param7);
        }
    }
    eax = eax_2 ^ *20;
    if (eax != 0) {
        __stack_chk_fail();
    }
    return;
}

/** address: 0x08049e14 */
__size32 nc_fgets_html(__size32 param1, union { __size32; void *; } param2, __size32 param3, union { unsigned char *; __size32; } param4, union { unsigned int; char *; } param5, int param6, union { FILE *; __size32; } param7, char param8)
{
    char al; 		// r8
    char dl; 		// r10
    __size32 eax; 		// r24
    union { unsigned char; char; } *eax_10; 		// r24{25}
    unsigned int eax_12; 		// r24{151}
    unsigned int eax_15; 		// r24{29}
    unsigned int eax_18; 		// r24{35}
    char *eax_2; 		// r24{15}
    unsigned int eax_22; 		// r24{128}
    unsigned int eax_25; 		// r24{112}
    unsigned int eax_28; 		// r24{43}
    size_t eax_3; 		// r24{20}
    unsigned int eax_31; 		// r24{47}
    unsigned int eax_34; 		// r24{51}
    char *eax_37; 		// r24{53}
    unsigned int eax_38; 		// r24{56}
    union { union { char; unsigned char; } *; unsigned int; } eax_4; 		// r24{21}
    char *eax_41; 		// r24{60}
    unsigned int eax_42; 		// r24{63}
    char *eax_45; 		// r24{67}
    unsigned int eax_46; 		// r24{71}
    unsigned int eax_49; 		// r24{74}
    unsigned int eax_52; 		// r24{85}
    unsigned int eax_55; 		// r24{88}
    unsigned int eax_58; 		// r24{100}
    size_t eax_7; 		// r24{22}
    __size32 ecx; 		// r25
    __size32 edx; 		// r26
    int esp_1; 		// r28{25}
    int esp_10; 		// r28{98}
    int esp_11; 		// r28{150}
    int esp_4; 		// r28{81}
    int esp_7; 		// r28{127}
    __size32 esp_8; 		// r28{1}
    union { __size32; unsigned char *; } local22; 		// m[esp_8 - 40]{144}
    __size32 local23; 		// m[esp_8 - 40]{33}
    int local27; 		// esp_10{98}
    char local28; 		// dl{108}
    __size32 local29; 		// m[esp_8 - 48]{111}
    char local30; 		// dl{116}
    union { unsigned char *; __size32; } local31; 		// m[esp_8 - 24]{119}
    __size32 local32; 		// m[esp_8 - 28]{120}
    union { __size32; void *; } local33; 		// m[esp_8 - 32]{121}
    union { __size32; unsigned char *; } local34; 		// m[esp_8 - 40]{122}
    __size32 local35; 		// m[esp_8 - 48]{123}
    int local36; 		// esp_7{127}
    char local37; 		// param8{138}
    union { unsigned char *; __size32; } local38; 		// param4{141}
    __size32 local39; 		// param3{142}
    union { __size32; void *; } local40; 		// param2{143}
    __size32 local41; 		// param1{146}
    int local42; 		// esp_11{150}
    char local43; 		// dl{168}
    char local44; 		// param8{174}

    *(int*)(esp_8 - 72) = param6;
    eax_2 = fgets(param5, param6, param7); /* Warning: also results in ecx, edx */
    local37 = param8;
    local38 = param4;
    local39 = param3;
    local40 = param2;
    local41 = param1;
    local44 = param8;
    if (eax_2 != 0) {
        eax_3 = strlen(param5);
        eax_4 = malloc(eax_3 + 1);
        eax_7 = strlen(param5);
        *(__size32*)(esp_8 - 76) = eax_7 + 1;
        eax_10 = malloc(eax_7 + 1); /* Warning: also results in ecx, edx, esp_1 */
        local42 = esp_1;
        *(union { unsigned int; unsigned char *; }*)(esp_8 - 44) = eax_4;
        *(__size32*)(esp_8 - 40) = param5;
        param8 = local37;
        param4 = local38;
        param3 = local39;
        param2 = local40;
        local22 = *(esp_8 - 40);
        param1 = local41;
        esp_11 = local42;
        eax_12 = *(unsigned char*)local22;
        local27 = esp_11;
        local28 = param8;
        local28 = param8;
        local28 = param8;
        local29 = param1;
        local30 = param8;
        local31 = param4;
        local32 = param3;
        local32 = param3;
        local33 = param2;
        local34 = local22;
        local35 = param1;
        local36 = esp_11;
        local36 = esp_11;
        local43 = param8;
        while ((unsigned char) eax_12 != 0) {
            eax_15 = *(unsigned char*)local22;
            if ((unsigned char) eax_15 == 60) {
                *(__size32*)(esp_8 - 24) = local22;
                *(union { union { unsigned char; char; } *; __size32; }*)(esp_8 - 32) = eax_10;
                local23 = local22 - 1;
                local33 = *(esp_8 - 32);
                local33 = *(esp_8 - 32);
                local33 = *(esp_8 - 32);
                local33 = *(esp_8 - 32);
                local34 = local23;
                if (local22 - 1 >= param5) {
                    eax_18 = *(unsigned char*)(local22 - 1);
                    if ((unsigned char) eax_18 != 32) {
                        *(__size32*)(esp_8 - 48) = 0;
                        local29 = *(esp_8 - 48);
                        goto bb0x804a033;
                    }
                    else {
                        *(__size32*)(esp_8 - 48) = 1;
                        local29 = *(esp_8 - 48);
                    }
                }
bb0x804a033:
                dl = local28;
                *(__size32*)(esp_8 - 48) = local29;
                eax_25 = *(unsigned char*)*(esp_8 - 24);
                local29 = *(esp_8 - 48);
                local30 = dl;
                local31 = *(esp_8 - 24);
                local31 = *(esp_8 - 24);
                local31 = *(esp_8 - 24);
                local31 = *(esp_8 - 24);
                local35 = *(esp_8 - 48);
                local35 = *(esp_8 - 48);
                local35 = *(esp_8 - 48);
                if ((unsigned char) eax_25 != 0) {
                    edx = *(unsigned char*)*(esp_8 - 24);
                    *(__size8*)eax_10 = (unsigned char) edx;
                    eax_28 = *(unsigned char*)eax_10;
                    edx = eax_28 + 1;
                    dl = (unsigned char) eax_28 + 1;
                    *(unsigned char*)eax_10 = (unsigned char) eax_28 + 1;
                    eax_31 = *(unsigned char*)*(esp_8 - 24);
                    local28 = dl;
                    if ((unsigned char) eax_31 == 62) {
                        *(unsigned char*)eax_10 = 0;
                        *(__size32*)(esp_8 - 28) = *(esp_8 - 24) + 1;
                        eax_34 = *(unsigned char*)(*(esp_8 - 24) + 1);
                        local32 = *(esp_8 - 28);
                        local32 = *(esp_8 - 28);
                        local32 = *(esp_8 - 28);
                        if ((unsigned char) eax_34 != 10) {
                            eax_37 = strstr(eax_10, "<br>");
                            if ( ~(eax_37 == 0 || *(esp_8 - 44) <= eax_4)) {
                                *(__size8*)*(esp_8 - 44) = 10;
                                eax_38 = *(unsigned char*)*(esp_8 - 44);
                                dl = (unsigned char) eax_38 + 1;
                                *(__size8*)*(esp_8 - 44) = (unsigned char) eax_38 + 1;
                            }
                            eax_41 = strstr(eax_10, "<BR>");
                            if ( ~(eax_41 == 0 || *(esp_8 - 44) <= eax_4)) {
                                *(__size8*)*(esp_8 - 44) = 10;
                                eax_42 = *(unsigned char*)*(esp_8 - 44);
                                dl = (unsigned char) eax_42 + 1;
                                *(__size8*)*(esp_8 - 44) = (unsigned char) eax_42 + 1;
                            }
                            eax_45 = strstr(eax_10, "<p>");
                            if (eax_45 != 0) {
                                if (*(esp_8 - 44) > eax_4) {
                                    *(__size8*)*(esp_8 - 44) = 10;
                                    eax_46 = *(unsigned char*)*(esp_8 - 44);
                                    *(__size8*)*(esp_8 - 44) = (unsigned char) eax_46 + 1;
                                }
                                *(__size8*)*(esp_8 - 44) = 10;
                                eax_49 = *(unsigned char*)*(esp_8 - 44);
                                dl = (unsigned char) eax_49 + 1;
                                *(__size8*)*(esp_8 - 44) = (unsigned char) eax_49 + 1;
                            }
                            *(int*)(esp_8 - 72) = 0x8054ac4;
                            *(union { union { char; unsigned char; } *; __size32; }*)(esp_8 - 76) = eax_10;
                            eax = strstr(eax_10, "<P>"); /* Warning: also results in ecx, edx, esp_4 */
                            local27 = esp_4;
                            local27 = esp_4;
                            if (eax != 0) {
                                if (*(esp_8 - 44) > eax_4) {
                                    *(__size8*)*(esp_8 - 44) = 10;
                                    eax_52 = *(unsigned char*)*(esp_8 - 44);
                                    *(__size8*)*(esp_8 - 44) = (unsigned char) eax_52 + 1;
                                }
                                *(__size8*)*(esp_8 - 44) = 10;
                                eax_55 = *(unsigned char*)*(esp_8 - 44);
                                edx = eax_55 + 1;
                                dl = (unsigned char) eax_55 + 1;
                                *(__size8*)*(esp_8 - 44) = (unsigned char) eax_55 + 1;
                            }
                        }
                        esp_10 = local27;
                        *(__size32*)(esp_8 - 40) = *(esp_8 - 24);
                        eax_58 = *(unsigned char*)*(esp_8 - 24);
                        local30 = dl;
                        local30 = dl;
                        local30 = dl;
                        local34 = *(esp_8 - 40);
                        local34 = *(esp_8 - 40);
                        local36 = esp_10;
                        local36 = esp_10;
                        local36 = esp_10;
                        if ((unsigned char) eax_58 == 32) {
                            if (*(esp_8 - 48) == 1) {
                                *(__size32*)(esp_8 - 40) = *(esp_8 - 24) + 1;
                                *(__size32*)(esp_8 - 48) = 0;
                                local34 = *(esp_8 - 40);
                                local35 = *(esp_8 - 48);
                                goto bb0x804a047;
                            }
                            goto bb0x804a047;
                        }
                        goto bb0x804a047;
                    }
                    *(__size32*)(esp_8 - 24)++;
                    goto bb0x804a033;
                }
            }
bb0x804a047:
            dl = local30;
            *(union { __size32; unsigned char *; }*)(esp_8 - 24) = local31;
            *(__size32*)(esp_8 - 28) = local32;
            *(union { void *; __size32; }*)(esp_8 - 32) = local33;
            *(union { unsigned char *; __size32; }*)(esp_8 - 40) = local34;
            *(__size32*)(esp_8 - 48) = local35;
            esp_7 = local36;
            eax_22 = *(unsigned char*)*(esp_8 - 40);
            local38 = *(esp_8 - 24);
            local39 = *(esp_8 - 28);
            local40 = *(esp_8 - 32);
            local41 = *(esp_8 - 48);
            local42 = esp_7;
            if ((unsigned char) eax_22 != 62) {
                edx = *(unsigned char*)*(esp_8 - 40);
                dl = (unsigned char) edx;
                *(__size8*)*(esp_8 - 44) = (unsigned char) edx;
                *(__size32*)(esp_8 - 44)++;
            }
            *(__size32*)(esp_8 - 40)++;
            local37 = dl;
            param8 = local37;
            param4 = local38;
            param3 = local39;
            param2 = local40;
            local22 = *(esp_8 - 40);
            param1 = local41;
            esp_11 = local42;
            eax_12 = *(unsigned char*)local22;
            local27 = esp_11;
            local28 = param8;
            local28 = param8;
            local28 = param8;
            local29 = param1;
            local30 = param8;
            local31 = param4;
            local32 = param3;
            local32 = param3;
            local33 = param2;
            local34 = local22;
            local35 = param1;
            local36 = esp_11;
            local36 = esp_11;
            local43 = param8;
        }
        *(__size8*)*(esp_8 - 44) = 0;
        strcpy(param5, eax_4);
        free(eax_4);
        free(eax_10);
        eax = strchr(param5, 35); /* Warning: also results in ecx, edx */
        if (eax == 0) {
bb0x804a141:
            dl = local43;
            eax = param5;
            al = (unsigned char) param5;
            local44 = dl;
        }
        else {
            if (param5 != eax) {
                eax = malloc(0x800);
                strcpy(eax, param5);
                eax = strtok(eax, "#");
                dl = (unsigned char) eax;
                sprintf(param5, "%s\n", eax);
                local43 = dl;
                ecx = free(eax); /* Warning: also results in edx */
                goto bb0x804a141;
            }
            else {
                eax = nc_fgets_html(*(esp_8 - 128), *(esp_8 - 112), *(esp_8 - 108), *(esp_8 - 104), param5, param6, param7, param8); /* Warning: also results in al, dl, ecx, edx */
                local44 = dl;
            }
        }
    }
    else {
        eax = 0;
        al = 0;
    }
    param8 = local44;
    return eax; /* WARNING: Also returning: al := al, dl := param8, ecx := ecx, edx := edx */
}

/** address: 0x0804a146 */
__size32 is_text(union { char *; __size32; } param1)
{
    int eax; 		// r24
    int local1; 		// m[esp - 16]
    __size32 local2; 		// m[esp - 20]

    eax = strlen(param1);
    local1 = eax - 1;
    local2 = 0;
    while (local1 >= 0) {
        eax = *(unsigned char*)(local1 + param1);
        if ((unsigned char) eax != 32) {
            eax = *(unsigned char*)(local1 + param1);
            if ((unsigned char) eax != 9) {
                eax = *(unsigned char*)(local1 + param1);
                if ((unsigned char) eax != 10) {
                    eax = *(unsigned char*)(local1 + param1);
                    if ((unsigned char) eax != 12) {
                        eax = *(unsigned char*)(local1 + param1);
                        if ((unsigned char) eax != 13) {
                            local2 = 1;
                            return local2; /* WARNING: Also returning: al := (unsigned char) local2 */
                        }
bb0x804a1a7:
                        local1--;
                    }
                    goto bb0x804a1a7;
                }
                goto bb0x804a1a7;
            }
            goto bb0x804a1a7;
        }
        goto bb0x804a1a7;
        local2 = 0;
    }
    return local2; /* WARNING: Also returning: al := (unsigned char) local2 */
}

/** address: 0x08049d41 */
__size32 nc_fgets(union { char *; __size32; } param1, int param2, union { FILE *; __size32; } param3)
{
    __size32 eax; 		// r24
    char *eax_1; 		// r24{5}
    __size32 ecx; 		// r25
    __size32 edx; 		// r26

    eax_1 = fgets(param1, param2, param3); /* Warning: also results in ecx, edx */
    if (eax_1 != 0) {
        eax = strchr(param1, 35); /* Warning: also results in ecx, edx */
        if (eax == 0) {
bb0x8049e0f:
            eax = param1;
        }
        else {
            if (param1 != eax) {
                eax = malloc(0x800);
                strcpy(eax, param1);
                eax = strtok(eax, "#");
                sprintf(param1, "%s\n", eax);
                ecx = free(eax); /* Warning: also results in edx */
                goto bb0x8049e0f;
            }
            else {
                eax = nc_fgets(param1, param2, param3); /* Warning: also results in ecx, edx */
            }
        }
    }
    else {
        eax = 0;
    }
    return eax; /* WARNING: Also returning: ecx := ecx, edx := edx */
}

/** address: 0x0804ad9b */
__size32 vercmp(int param1, int param2, int param3, int param4, int param5, int param6)
{
    __size32 eax; 		// r24

    if (param1 != param4 || param2 != param5 || param3 != param6) {
        if (param4 <= param1) {
            if (param4 >= param1) {
                if (param5 <= param2) {
                    if (param5 >= param2) {
                        if (param6 <= param3) {
                            if (param6 >= param3) {
                                eax = 0;
                            }
                            else {
                                eax = 1;
                            }
                        }
                        else {
                            eax = -1;
                        }
                    }
                    else {
                        eax = 1;
                    }
                }
                else {
                    eax = -1;
                }
            }
            else {
                eax = 1;
            }
        }
        else {
            eax = -1;
        }
    }
    else {
        eax = 0;
    }
    return eax;
}

/** address: 0x0804ae20 */
void depstr(char param1[], int param2, char param3, unsigned char param4, char param5)
{
    __size32 eax; 		// r24
    char *eax_10; 		// r24{20}
    __size32 eax_14; 		// r24{37}
    int eax_17; 		// r24{23}
    int eax_20; 		// r24{26}
    int eax_3; 		// r24{7}
    FILE *eax_6; 		// r24{9}
    union { __size32; __size32 *; } eax_8; 		// r24{11}
    __size32 eax_9; 		// r24{12}
    int edx; 		// r26
    int esp; 		// r28
    int local12; 		// param2{36}
    __size32 local5; 		// m[esp - 0x1818]
    int local6; 		// m[esp - 0x181c]

    eax_3 = *20;
    memcpy(&param5, 0x8054d08, 11);
    local12 = param2;
    eax_6 = fopen(&param5, "r");
    if (eax_6 != 0) {
        local5 = 1;
        eax_10 = malloc(0x800);
        for(;;) {
bb0x804afc5:
            param2 = local12;
            eax_14 = nc_fgets_nb(esp - 0x1010, 0x800, eax_6);
            local12 = param2;
            if (eax_14 != 0) {
                if ((unsigned char) (param4) == 0) {
                    continue;
                }
                eax_17 = __isoc99_sscanf();
                local6 = eax_17;
                local12 = local6;
                local12 = local6;
                local12 = local6;
                local12 = local6;
                if (eax_17 <= 0) {
                    continue;
                }
                eax_20 = strcmp("GRASS", &param3);
                if (eax_20 == 0) {
                    continue;
                }
                if (local5 == 0) {
                    strcat(eax_10, ",");
                    strcat(eax_10, &param3);
                }
                else {
                    strcat(eax_10, "\t");
                    strcat(eax_10, &param3);
                    local5 = 0;
                    goto bb0x804afc5;
                }
                continue;
            }
        }
        fclose(eax_6);
    }
    else {
        eax_8 = __errno_location();
        eax_9 = *eax_8;
        if (eax_9 != 2) {
            eax = __errno_location();
            eax = *eax;
            strerror(eax);
            print_error(param1, -17, 0x8054d16, esp - 0x810);
        }
    }
    edx = eax_3 ^ *20;
    if (edx != 0) {
        __stack_chk_fail();
    }
    return;
}

/** address: 0x08049b5f */
__size32 find_pos(union { char *; __size32; } param1, __size32 param2, int param3, __size32 param4, __size32 param5)
{
    char *eax; 		// r24
    __size32 ecx; 		// r25
    __size32 edx; 		// r26
    unsigned int local0; 		// m[esp - 16]
    int local2; 		// m[esp - 20]
    __size32 local5; 		// param4{26}
    __size32 local6; 		// param5{27}
    __size32 local7; 		// ecx{32}
    __size32 local8; 		// edx{33}

    local0 = 0;
    local5 = param4;
    local6 = param5;
    eax = local0 * 4 + param2;
    eax = *(local0 * 4 + param2);
    while (eax != 0) {
        local0++;
        eax = local0 * 4 + param2;
        eax = *(local0 * 4 + param2);
    }
    if ( ~(param3 >= 0 && param3 <= (int)local0)) {
        exit(-21);
    }
    local2 = param3;
    param4 = local5;
    param5 = local6;
    local7 = param4;
    local8 = param5;
    while (local2 < (int)local0) {
        eax = local2 * 4 + param2;
        eax = *(local2 * 4 + param2);
        eax = strstr(eax, param1); /* Warning: also results in ecx, edx */
        local5 = ecx;
        local6 = edx;
        local7 = ecx;
        local8 = edx;
        if (eax != 0) {
            %eax = local2;
            goto bb0x8049bd7;
        }
        local2++;
        param4 = local5;
        param5 = local6;
        local7 = param4;
        local8 = param5;
    }
    %eax = (unsigned int)-1;
bb0x8049bd7:
    ecx = local7;
    edx = local8;
    return eax; /* WARNING: Also returning: ecx := ecx, edx := edx */
}

/** address: 0x08049a5e */
__size32 delete_str(char param1[], __size32 param2, int param3, __size32 param4, __size32 param5, __size32 param6, __size32 param7)
{
    size_t eax; 		// r24
    void *eax_2; 		// r24{26}
    union { __size32; char *; } eax_3; 		// r24{28}
    union { __size32; char *; } eax_6; 		// r24{29}
    union { __size32; union { __size32; void *; } *; } ebx; 		// r27
    __size32 ecx; 		// r25
    __size32 edx; 		// r26
    unsigned int local0; 		// m[esp - 16]
    __size32 local10; 		// param7{39}
    __size32 local11; 		// param2{41}
    union { char *; __size32; } local3; 		// m[esp - 40]
    __size32 local6; 		// ebx{34}
    __size32 local7; 		// local3{35}
    __size32 local8; 		// param5{37}
    __size32 local9; 		// param6{38}

    local0 = 0;
    local8 = param5;
    local9 = param6;
    local10 = param7;
    local11 = param2;
    eax = *(local0 * 4 + param4);
    while (eax != 0) {
        local0++;
        eax = *(local0 * 4 + param4);
    }
    if ( ~(param3 >= 0 && param3 <= (int)local0)) {
        print_error(param1, -21, 0x8054a3c, param3);
    }
    local0 = param3;
    param5 = local8;
    param6 = local9;
    param7 = local10;
    param2 = local11;
    eax = *(local0 * 4 + param4);
    local6 = param7;
    local7 = param2;
    while (eax != 0) {
        eax = *(local0 * 4 + param4);
        ecx = free(eax); /* Warning: also results in edx */
        eax = *((local0 + 1) * 4 + param4);
        if (eax != 0) {
            ebx = local0 * 4 + param4;
            eax = *((local0 + 1) * 4 + param4);
            eax = strlen(eax);
            local6 = ebx;
            eax_2 = malloc(eax + 1);
            *(union { void *; __size32; }*)ebx = eax_2;
            eax_3 = *((local0 + 1) * 4 + param4);
            eax_6 = *(local0 * 4 + param4);
            local3 = eax_3;
            ecx = strcpy(eax_6, eax_3); /* Warning: also results in edx */
            local7 = local3;
        }
        ebx = local6;
        local3 = local7;
        local0++;
        local8 = ecx;
        local9 = edx;
        local10 = ebx;
        local11 = local3;
        param5 = local8;
        param6 = local9;
        param7 = local10;
        param2 = local11;
        eax = *(local0 * 4 + param4);
        local6 = param7;
        local7 = param2;
    }
    *(__size32*)((local0 - 1) * 4 + param4) = 0;
    return param5; /* WARNING: Also returning: edx := param6 */
}

/** address: 0x0804e56f */
void delete_ext_html(char param1[], char param2[], __size32 param3, char param4, union { char[] *; __size32; } param5, __size32 param6, __size32 param7, __size32 param8, __size32 param9)
{
    __size32 eax; 		// r24
    int eax_1; 		// r24{11}
    __size32 eax_10; 		// r24{24}
    int eax_11; 		// r24{28}
    int eax_14; 		// r24{29}
    int eax_17; 		// r24{31}
    int eax_20; 		// r24{39}
    int eax_4; 		// r24{12}
    int eax_7; 		// r24{15}
    int ecx; 		// r25
    int edx; 		// r26
    int esp; 		// r28
    int local3; 		// m[esp - 0x814]
    int local8; 		// m[esp - 0x82c]

    eax_1 = *20;
    eax_4 = find_pos(0x8055a54, param6, 0, param7, param8); /* Warning: also results in ecx, edx */
    local3 = eax_4;
    if (eax_4 >= 0) {
bb0x804e609:
        ecx = find_pos(0x8055afe, param6, local3, ecx, edx); /* Warning: also results in edx */
        eax_10 = find_pos(0x8055b04, param6, local3, ecx, edx); /* Warning: also results in ecx, edx */
        if (eax_10 != -1) {
            eax_11 = find_pos(0x8055b04, param6, local3, ecx, edx); /* Warning: also results in ecx, edx */
            eax_14 = find_pos(0x8055b56, param6, eax_11, ecx, edx);
            ecx = sprintf(&param4, "\">%s", param5); /* Warning: also results in edx */
            eax_17 = find_pos(esp - 0x810, param6, eax_11, ecx, edx); /* Warning: also results in ecx, edx */
            if (eax_17 != -1) {
                if (eax_17 < eax_14) {
                    ecx = delete_str(param1, param3, eax_17, param6, ecx, edx, param9); /* Warning: also results in edx */
                }
                eax_20 = find_pos(0x8055c76, param6, eax_11, ecx, edx);
                if ( ~(eax_20 == -1 || eax_14 - 1 <= eax_20)) {
                    ecx = eax_14 - eax_20 - 1;
                    if (eax_14 - eax_20 - 1 <= 1) {
                        local8 = 0;
                        while (local8 <= 3) {
                            ecx = delete_str(param1, param3, eax_20 - 1, param6, ecx, eax_20 - 1, param9);
                            local8++;
                        }
                    }
                }
            }
            else {
                print_warning(param2, 0x8055c4c, param5);
            }
        }
        else {
            print_warning(param2, 0x8055c20, param6);
        }
    }
    else {
        eax_7 = find_pos(0x8055a70, param6, 0, ecx, edx); /* Warning: also results in ecx, edx */
        local3 = eax_7;
        if (eax_7 >= 0) {
            goto bb0x804e609;
        }
        else {
            print_warning(param2, 0x8055bd8, param6);
        }
    }
    eax = eax_1 ^ *20;
    if (eax != 0) {
        __stack_chk_fail();
    }
    return;
}

/** address: 0x08049737 */
__size32 insert_str(char param1[], char param2, char param3, char param4, union { int; char *; } param5, int param6, __size32 param7)
{
    __size32 eax; 		// r24
    union { __size32; char *; } eax_12; 		// r24{22}
    union { __size32; char *; } eax_14; 		// r24{26}
    union { __size32; char *; } eax_18; 		// r24{28}
    int eax_2; 		// r24{14}
    union { __size32; void *; } eax_22; 		// r24{30}
    size_t eax_25; 		// r24{32}
    void *eax_28; 		// r24{33}
    union { char *; int; } eax_31; 		// r24{35}
    size_t eax_35; 		// r24{52}
    void *eax_36; 		// r24{53}
    union { __size32; char *; } eax_39; 		// r24{55}
    union { __size32; char *; } eax_41; 		// r24{39}
    union { __size32; void *; } eax_43; 		// r24{41}
    size_t eax_44; 		// r24{43}
    void *eax_45; 		// r24{44}
    int eax_5; 		// r24{9}
    size_t eax_8; 		// r24{19}
    void *eax_9; 		// r24{20}
    int ecx; 		// r25
    int edx; 		// r26
    unsigned int local0; 		// m[esp - 0x1814]
    int local6; 		// m[esp - 0x1818]

    eax_5 = *20;
    local0 = 0;
    eax_2 = *(local0 * 4 + param7);
    while (eax_2 != 0) {
        local0++;
        eax_2 = *(local0 * 4 + param7);
    }
    if ( ~(param6 >= 0 && param6 <= (int)local0)) {
        print_error(param1, -21, 0x8054a18, param6);
    }
    if (param6 != local0) {
        eax_14 = *((local0 - 1) * 4 + param7);
        strcpy(&param2, eax_14);
        eax_18 = *(param6 * 4 + param7);
        strcpy(&param3, eax_18);
        eax_22 = *(param6 * 4 + param7);
        free(eax_22);
        eax_25 = strlen(param5);
        eax_28 = malloc(eax_25 + 1);
        *(union { void *; __size32; }*)(param6 * 4 + param7) = eax_28;
        eax_31 = *(param6 * 4 + param7);
        strcpy(eax_31, param5);
        local6 = param6;
        while (local0 - 1 > local6) {
            eax_41 = *((local6 + 1) * 4 + param7);
            strcpy(&param4, eax_41);
            eax_43 = *((local6 + 1) * 4 + param7);
            free(eax_43);
            eax_44 = strlen(&param3);
            eax_45 = malloc(eax_44 + 1);
            *(union { void *; __size32; }*)((local6 + 1) * 4 + param7) = eax_45;
            eax = *((local6 + 1) * 4 + param7);
            strcpy(eax, &param3);
            strcpy(&param3, &param4);
            local6++;
        }
        eax_35 = strlen(&param2);
        eax_36 = malloc(eax_35 + 1);
        *(union { void *; __size32; }*)(local0 * 4 + param7) = eax_36;
        eax_39 = *(local0 * 4 + param7);
        ecx = strcpy(eax_39, &param2);
        *(__size32*)((local0 + 1) * 4 + param7) = 0;
    }
    else {
        eax_8 = strlen(param5);
        eax_9 = malloc(eax_8 + 1);
        *(union { void *; __size32; }*)(local0 * 4 + param7) = eax_9;
        eax_12 = *(local0 * 4 + param7);
        ecx = strcpy(eax_12, param5);
        *(__size32*)((local0 + 1) * 4 + param7) = 0;
    }
    edx = eax_5 ^ *20;
    if (edx != 0) {
        ecx = __stack_chk_fail(); /* Warning: also results in edx */
    }
    return ecx; /* WARNING: Also returning: edx := edx */
}

/** address: 0x0804be84 */
__size32 is_submenu(union { char *; __size32; } param1)
{
    char *eax; 		// r24
    char *eax_1; 		// r24{11}

    eax = strchr(param1, 91);
    if (eax != 0) {
        eax = strrchr(param1, 93);
        if (eax != 0) {
            eax_1 = strchr(param1, 91);
            eax = strrchr(param1, 93);
            if (eax_1 <= eax) {
                eax = 1;
            }
            else {
                eax = 0;
            }
        }
        else {
            eax = 0;
        }
    }
    else {
        eax = 0;
    }
    return eax;
}

