// subject.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

// 080482B4: void _init()
void _init()
{
	word32 edx_13 = globals->dw8049A58;
	if (edx_13 != 0x00)
	{
		word32 esp_31;
		word32 ebp_32;
		word32 ebx_33;
		byte SCZO_34;
		word32 edx_35;
		byte SZO_36;
		byte C_37;
		byte Z_38;
		word32 eax_39;
		!__gmon_start__();
	}
	frame_dummy();
	__do_global_ctors_aux();
}

// 08048340: void _start(Register (ptr Eq_25) edx, Stack int32 dwArg00)
void _start( * edx, int32 dwArg00)
{
	__align((char *) fp + 0x04);
	__libc_start_main(&globals->t8048704, dwArg00, (char *) fp + 0x04, &globals->t80487E0, &globals->t80487D0, edx, fp);
	__hlt();
}

// 08048370: void __do_global_dtors_aux(Register word32 esi)
void __do_global_dtors_aux(word32 esi)
{
	if (globals->b8049A74 != 0x00)
		return;
	up32 eax_23 = globals->dw8049A78;
	if (eax_23 >= 0x00)
		globals->b8049A74 = 0x01;
	else
		globals->dw8049A78 = eax_23 + 0x01;
}

// 080483D0: void frame_dummy()
void frame_dummy()
{
	if (globals->dw8049984 != 0x00 && 0x00 != 0x00)
	{
		word32 esp_28;
		word32 ebp_29;
		byte SCZO_30;
		word32 eax_31;
		byte SZO_32;
		byte C_33;
		byte Z_34;
		null();
	}
}

// 080483F4: void copy1_four_times(Stack (ptr word16) dwArg04, Stack (ptr word16) dwArg08, Stack int32 dwArg0C)
void copy1_four_times(word16 * dwArg04, word16 * dwArg08, int32 dwArg0C)
{
	int32 eax_118 = dwArg0C + 0x03;
	if (dwArg0C < 0x03)
		eax_118 = dwArg0C + 0x06;
	uint32 edx_21 = dwArg0C >> 0x1F >> 0x1E;
	int32 dwLoc08_17 = eax_118 >> 0x02;
	int32 eax_24 = (dwArg0C + edx_21 & 0x03) - edx_21;
	if (eax_24 == 0x01)
	{
l08048478:
		*dwArg04 = (word16) (word32) *dwArg08;
		int32 v14_57 = dwLoc08_17 - 0x01;
		dwArg04 = dwArg04 + 0x01;
		dwArg08 = dwArg08 + 0x01;
		dwLoc08_17 = v14_57;
		if (v14_57 <= 0x00)
			return;
		goto l0804843C;
	}
	if (eax_24 <= 0x01)
	{
		if (eax_24 != 0x00)
			return;
l0804843C:
		*dwArg04 = (word16) (word32) *dwArg08;
		dwArg04 = dwArg04 + 0x01;
		dwArg08 = dwArg08 + 0x01;
	}
	else
	{
		if (eax_24 == 0x02)
			goto l08048464;
		if (eax_24 != 0x03)
			return;
	}
	*dwArg04 = (word16) (word32) *dwArg08;
	dwArg04 = dwArg04 + 0x01;
	dwArg08 = dwArg08 + 0x01;
l08048464:
	*dwArg04 = (word16) (word32) *dwArg08;
	dwArg04 = dwArg04 + 0x01;
	dwArg08 = dwArg08 + 0x01;
	goto l08048478;
}

// 08048498: Register ptr32 copy1_eight_times(Stack int32 dwArg0C)
ptr32 copy1_eight_times(int32 dwArg0C)
{
	uint32 edx_20 = dwArg0C >> 0x1F >> 0x1D;
	uint32 eax_23 = (dwArg0C + edx_20 & 0x07) - edx_20;
	if (eax_23 > 0x07)
		return fp;
	<anonymous> * eax_36 = *((char *) globals->a8048894 + eax_23 * 0x04);
	ptr32 esp_37;
	word32 ebp_38;
	byte SCZO_39;
	word32 eax_40;
	word32 edx_41;
	byte SZO_42;
	byte C_43;
	byte S_44;
	byte CZ_45;
	eax_36();
	return esp_37;
}

// 08048586: void copy2_four_times(Stack (ptr word16) dwArg04, Stack (ptr word16) dwArg08, Stack int32 dwArg0C)
void copy2_four_times(word16 * dwArg04, word16 * dwArg08, int32 dwArg0C)
{
}

// 08048612: Register ptr32 copy2_eight_times(Stack (ptr word16) dwArg04, Stack (ptr word16) dwArg08, Stack int32 dwArg0C, Register out ptr32 ebpOut)
ptr32 copy2_eight_times(word16 * dwArg04, word16 * dwArg08, int32 dwArg0C, ptr32 & ebpOut)
{
}

// 08048704: void main(Register word32 ebp)
void main(word32 ebp)
{
	__align(fp - 0x04);
	copy1_four_times(malloc(200), malloc(200), 100);
	struct Eq_392 * esp_27 = copy1_eight_times(100);
	esp_27->dw0008 = 100;
	esp_27->dw0004 = esp_27->dw0018;
	esp_27->dw0000 = esp_27->dw001C;
	copy2_four_times(dwArg00, dwArg04, dwArg08);
	esp_27->dw0008 = 100;
	esp_27->dw0004 = esp_27->dw0018;
	esp_27->dw0000 = esp_27->dw001C;
	word32 ebp_41;
	struct Eq_436 * esp_42 = copy2_eight_times(dwArg00, dwArg04, dwArg08, out ebp_41);
	esp_42->t0008 = esp_42->t0014;
	esp_42->ptr0004 = esp_42->ptr001C;
	esp_42->ptr0000 = esp_42->ptr0018;
	memcmp(esp_42->ptr0000, esp_42->ptr0004, esp_42->t0008);
}

// 080487D0: void __libc_csu_fini()
void __libc_csu_fini()
{
}

// 080487E0: void __libc_csu_init(Stack word32 dwArg04, Stack word32 dwArg08, Stack word32 dwArg0C)
void __libc_csu_init(word32 dwArg04, word32 dwArg08, word32 dwArg0C)
{
	struct Eq_477 * ebx_16 = __i686.get_pc_thunk.bx(dwLoc14);
	_init();
	if (&ebx_16->ptr1189 - &ebx_16->ptr1189 >> 0x02 != 0x00)
	{
		do
		{
			word32 esp_60;
			word32 ebp_61;
			up32 edi_62;
			up32 esi_63;
			word32 ebx_64;
			byte SCZO_65;
			word32 eax_66;
			byte SZO_67;
			byte C_68;
			byte Z_69;
			ebx_16->ptr1189();
		} while (esi_63 + 0x01 < edi_62);
	}
}

// 0804883A: Register word32 __i686.get_pc_thunk.bx(Stack word32 dwArg00)
word32 __i686.get_pc_thunk.bx(word32 dwArg00)
{
	return dwArg00;
}

// 08048840: void __do_global_ctors_aux()
void __do_global_ctors_aux()
{
	<anonymous> * eax_11 = globals->ptr8049974;
	if (eax_11 != (<anonymous> *) ~0x00)
	{
		do
		{
			word32 esp_26;
			word32 ebp_27;
			word32 * ebx_28;
			byte SCZO_29;
			word32 eax_30;
			byte Z_31;
			eax_11();
		} while (*ebx_28 != ~0x00);
	}
}

// 0804886C: void _fini(Register word32 esi)
void _fini(word32 esi)
{
	__do_global_dtors_aux(esi);
}

