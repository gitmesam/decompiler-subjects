//
// This file was generated by the Retargetable Decompiler
// Website: https://retdec.com
//

#include <stdbool.h>
#include <stdint.h>
#include <stdlib.h>

// ------------------- Function Prototypes --------------------

void copy1_eight_times(int16_t * to, int16_t * from, int32_t count);
void copy1_four_times(int16_t * to, int16_t * from, int32_t count);
void copy2_eight_times(int16_t * to, int16_t * from, int32_t n);
void copy2_four_times(int16_t * to, int16_t * from, int32_t n);

// --------------------- Global Variables ---------------------

int32_t g1;
int32_t g2;

// ------------------------ Functions -------------------------

// From module:   /tmp/a/decompiler-subjects/from_holdec/duffs_device/source.c
// Address range: 0x80483d0 - 0x8048466
// Line range:    4 - 7
void copy1_four_times(int16_t * to, int16_t * from, int32_t count) {
    int32_t v1 = (int32_t)from;
    int32_t v2 = (int32_t)to;
    int32_t v3 = count % 4; // 0x80483f6
    int32_t v4 = count / 64; // 0x80483f8
    int32_t v5 = v2; // 0x80483fe
    int32_t v6 = v1; // 0x80483fe
    int32_t v7 = v4; // 0x80483fe
    int32_t v8; // 0x80483d0
    int32_t v9; // 0x80483d0
    int32_t v10; // 0x80483d0
    int32_t v11; // 0x80483d0
    int32_t v12; // 0x80483d0
    if (v3 == 1) {
        goto lab_0x8048430;
    } else {
        if (v3 > 1) {
            // 0x8048402
            v9 = v2;
            v11 = v1;
            v7 = v4;
            switch (v3) {
                case 2: {
                    goto lab_0x8048424;
                }
                case 3: {
                    // 0x8048418
                    *to = *from;
                    v9 = v2 + 2;
                    v11 = v1 + 2;
                    v7 = v4;
                    goto lab_0x8048424;
                }
                default: {
                    return;
                }
            }
        } else {
            // 0x8048460
            v10 = v2;
            v12 = v1;
            v8 = v4;
            if (v3 != 0) {
                // 0x804840c
                return;
            }
            goto lab_0x8048443;
        }
    }
  lab_0x8048430:;
    int32_t v13 = v7 - 1; // 0x8048433
    *(int16_t *)v5 = *(int16_t *)v6;
    if (v13 < 1) {
        // 0x804840c
        return;
    }
    // 0x804843d
    v10 = v5 + 2;
    v12 = v6 + 2;
    v8 = v13;
    goto lab_0x8048443;
  lab_0x8048443:
    // 0x8048443
    *(int16_t *)v10 = *(int16_t *)v12;
    *(int16_t *)(v10 + 2) = *(int16_t *)(v12 + 2);
    v9 = v10 + 4;
    v11 = v12 + 4;
    v7 = v8;
    goto lab_0x8048424;
  lab_0x8048424:
    // 0x8048424
    *(int16_t *)v9 = *(int16_t *)v11;
    v5 = v9 + 2;
    v6 = v11 + 2;
    goto lab_0x8048430;
}

// From module:   /tmp/a/decompiler-subjects/from_holdec/duffs_device/source.c
// Address range: 0x8048470 - 0x8048519
// Line range:    21 - 27
void copy1_eight_times(int16_t * to, int16_t * from, int32_t count) {
    int32_t v1 = count % 8; // 0x8048496
    g1 = v1;
    switch (v1) {
        default: {
            // 0x80484a0
            return;
        }
    }
}

// From module:   /tmp/a/decompiler-subjects/from_holdec/duffs_device/source.c
// Address range: 0x8048520 - 0x804859a
// Line range:    46 - 76
void copy2_four_times(int16_t * to, int16_t * from, int32_t n) {
    if (n < 1) {
        // 0x8048596
        return;
    }
    int32_t v1 = (int32_t)to; // 0x8048548
    int32_t v2 = 4 - n; // 0x8048548
    int32_t v3 = (int32_t)from; // 0x8048548
    while (true) {
        int32_t v4 = v3;
        int32_t v5 = v1;
        int32_t v6 = v5; // 0x8048520
        int32_t v7 = v4; // 0x8048520
        int32_t v8 = v5; // 0x8048520
        int32_t v9 = v4; // 0x8048520
        int32_t v10 = v5; // 0x8048520
        int32_t v11 = v4; // 0x8048520
        switch (v2) {
            default: {
                // 0x8048565
                *(int16_t *)v5 = *(int16_t *)v4;
                v6 = v5 + 2;
                v7 = v4 + 2;
            }
            case 1: {
                // 0x8048571
                *(int16_t *)v6 = *(int16_t *)v7;
                v8 = v6 + 2;
                v9 = v7 + 2;
            }
            case 2: {
                // 0x804857d
                *(int16_t *)v8 = *(int16_t *)v9;
                v10 = v8 + 2;
                v11 = v9 + 2;
            }
            case 3: {
                // 0x8048589
                v2 += 4;
                *(int16_t *)v10 = *(int16_t *)v11;
                if (v2 == 8 - n + (n - 4 & -4)) {
                    // break -> 0x8048596
                    break;
                }
                // break -> 0x8048550
                break;
            }
        }
        // 0x8048550
        v1 = v10 + 2;
        v3 = v11 + 2;
    }
}

// From module:   /tmp/a/decompiler-subjects/from_holdec/duffs_device/source.c
// Address range: 0x80485a0 - 0x804864c
// Line range:    79 - 113
void copy2_eight_times(int16_t * to, int16_t * from, int32_t n) {
    if (n < 1) {
        // 0x8048648
        return;
    }
    int32_t v1 = (int32_t)to; // 0x80485cc
    int32_t v2 = 8 - n; // 0x80485cc
    int32_t v3 = (int32_t)from; // 0x80485cc
    while (true) {
        int32_t v4 = v3;
        int32_t v5 = v1;
        g2 = v2;
        int32_t v6 = v5; // 0x804863c
        int32_t v7 = v4; // 0x804863c
        int32_t v8 = v5; // 0x804863c
        int32_t v9 = v4; // 0x804863c
        int32_t v10 = v5; // 0x804863c
        int32_t v11 = v4; // 0x804863c
        int32_t v12 = v5; // 0x804863c
        int32_t v13 = v4; // 0x804863c
        int32_t v14 = v5; // 0x804863c
        int32_t v15 = v4; // 0x804863c
        int32_t v16 = v5; // 0x804863c
        int32_t v17 = v4; // 0x804863c
        int32_t v18 = v5; // 0x804863c
        int32_t v19 = v4; // 0x804863c
        switch (v2) {
            default: {
                // 0x80485d0
                *(int16_t *)v5 = *(int16_t *)v4;
                v6 = v5 + 2;
                v7 = v4 + 2;
            }
            case 1: {
                // 0x80485dc
                *(int16_t *)v6 = *(int16_t *)v7;
                v8 = v6 + 2;
                v9 = v7 + 2;
            }
            case 2: {
                // 0x80485e8
                *(int16_t *)v8 = *(int16_t *)v9;
                v10 = v8 + 2;
                v11 = v9 + 2;
            }
            case 3: {
                // 0x80485f4
                *(int16_t *)v10 = *(int16_t *)v11;
                v12 = v10 + 2;
                v13 = v11 + 2;
            }
            case 4: {
                // 0x8048600
                *(int16_t *)v12 = *(int16_t *)v13;
                v14 = v12 + 2;
                v15 = v13 + 2;
            }
            case 5: {
                // 0x804860c
                *(int16_t *)v14 = *(int16_t *)v15;
                v16 = v14 + 2;
                v17 = v15 + 2;
            }
            case 6: {
                // 0x8048618
                *(int16_t *)v16 = *(int16_t *)v17;
                v18 = v16 + 2;
                v19 = v17 + 2;
            }
            case 7: {
                // 0x8048624
                v2 += 8;
                *(int16_t *)v18 = *(int16_t *)v19;
                if (v2 == 16 - n + (n - 8 & -8)) {
                    // break -> 0x8048648
                    break;
                }
                // break -> 0x8048631
                break;
            }
        }
        // 0x8048631
        v1 = v18 + 2;
        v3 = v19 + 2;
    }
}

// From module:   /tmp/a/decompiler-subjects/from_holdec/duffs_device/source.c
// Address range: 0x8048650 - 0x80486e2
// Line range:    115 - 124
int main(int argc, char ** argv) {
    int32_t * mem = malloc(200); // 0x8048662
    int32_t * mem2 = malloc(200); // 0x8048670
    copy1_four_times((int16_t *)mem2, (int16_t *)mem, 100);
    copy1_eight_times((int16_t *)mem2, (int16_t *)mem, 100);
    copy2_four_times((int16_t *)mem2, (int16_t *)mem, 100);
    copy2_eight_times((int16_t *)mem2, (int16_t *)mem, 100);
    bool v1; // 0x8048650
    int32_t v2 = v1 ? -1 : 1; // 0x80486cc
    int32_t v3 = (int32_t)mem2; // 0x8048650
    int32_t v4 = (int32_t)mem; // 0x8048650
    int32_t v5 = 200; // 0x80486cc
    unsigned char v6 = *(char *)v4; // 0x80486cc
    char v7 = *(char *)v3; // 0x80486cc
    char v8 = v7; // 0x80486cc
    bool v9 = false; // 0x80486cc
    while (v6 == v7) {
        v5--;
        v3 += v2;
        v4 += v2;
        v8 = v6;
        v9 = true;
        if (v5 == 0) {
            // break -> 
            break;
        }
        v6 = *(char *)v4;
        v7 = *(char *)v3;
        v8 = v7;
        v9 = false;
    }
    unsigned char v10 = v8;
    return (int32_t)!((v6 < v10 | v9)) - (int32_t)(v6 < v10);
}

// --------------- Dynamically Linked Functions ---------------

// void * malloc(size_t size);

// --------------------- Meta-Information ---------------------

// Detected compiler/packer: gcc (4.6.3)
// Detected functions: 5

