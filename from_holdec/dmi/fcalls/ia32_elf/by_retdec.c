//
// This file was generated by the Retargetable Decompiler
// Website: https://retdec.com
// Copyright (c) 2018 Retargetable Decompiler <info@retdec.com>
//

#include <stdbool.h>
#include <stdint.h>
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <time.h>

// ------------------------ Structures ------------------------

struct struct1 {
    int32_t e0;
    int32_t e1;
    int32_t e2;
    int32_t e3;
};

struct _IO_FILE {
    int32_t e0;
};

// ------------------- Function Prototypes --------------------

int32_t a_vararg(int32_t a1);
int32_t advanced_1_pass_in_flags_reg(int32_t a1);
int32_t advanced_1_pass_in_flags_reg_helper(void);
int32_t advanced_2_return_in_flags_reg(int32_t a1);
int32_t advanced_2_return_in_flags_reg_helper(void);
int32_t advanced_3_uneven_stack(int32_t a1);
int32_t basic_1_multiple_calling_conventions_3_ints(int32_t a1);
int32_t basic_2_calling_varargs(int32_t a1);
int32_t basic_3_accessing_all_registers(void);
int32_t basic_4_tail_call(int32_t a1);
int32_t crude_printf(char * a1, int32_t a2, int32_t a3);
int32_t even_more_crude(char * a1, int32_t str, int32_t a3);
int32_t intermediate_1_accessing_varargs(void);
int32_t intermediate_2_use_uncommon_registers_for_parameters(int32_t a1);
int32_t intermediate_3_calling_noreturn(void);
int32_t intermediate_4_asm_instr_with_multiple_results(int32_t a1, int32_t a2);
int32_t intermediate_5_pushs_in_different_blocks(int32_t a1);
int32_t sum3_cdecl(int32_t a1, int32_t a2, int32_t a3);
int32_t sum3_fastcall(int32_t a1);
int32_t sum3_ms_abi(int32_t a1, int32_t a2, int32_t a3);
int32_t sum3_stdcall(int32_t a1, int32_t a2, int32_t a3);
int32_t sum3_sysv_abi(int32_t a1, int32_t a2, int32_t a3);
int32_t sum3_thiscall(int32_t a1, int32_t a2);
int32_t sum3_uncommon(void);

// --------------------- Global Variables ---------------------

int32_t g1 = 0; // ebp
int32_t g2 = 0; // ebx
int32_t g3 = 0; // ecx
int32_t g4 = 0; // edi
int32_t g5 = 0; // edx
int32_t g6 = 0; // esi
int32_t g7 = 0; // esp
struct _IO_FILE * g8 = NULL;
bool g9 = false; // of
bool g10 = false; // sf
bool g11 = false; // zf

// ------------------------ Functions -------------------------

// Address range: 0x8048420 - 0x80484bf
int main(int argc, char ** argv) {
    int32_t v1 = basic_1_multiple_calling_conventions_3_ints((int32_t)argv); // 0x804843a
    int32_t v2 = basic_2_calling_varargs(g6); // 0x8048444
    int32_t v3 = basic_3_accessing_all_registers(); // 0x804844b
    g2 = v1 + v2 + v3 + basic_4_tail_call(g6);
    intermediate_1_accessing_varargs();
    intermediate_2_use_uncommon_registers_for_parameters(g6);
    intermediate_3_calling_noreturn();
    // UNREACHABLE
}

// Address range: 0x80485c0 - 0x80485d7
int32_t sum3_cdecl(int32_t a1, int32_t a2, int32_t a3) {
    // 0x80485c0
    return a1 + 1 + 2 * a2 + 3 * a3;
}

// Address range: 0x80485e0 - 0x80485f1
int32_t sum3_fastcall(int32_t a1) {
    // 0x80485e0
    return 3 * a1 + 2 + 2 * g5 + g3;
}

// Address range: 0x8048600 - 0x8048615
int32_t sum3_thiscall(int32_t a1, int32_t a2) {
    // 0x8048600
    return 3 * a2 + 3 + g3 + 2 * a1;
}

// Address range: 0x8048620 - 0x8048637
int32_t sum3_ms_abi(int32_t a1, int32_t a2, int32_t a3) {
    // 0x8048620
    return a1 + 4 + 2 * a2 + 3 * a3;
}

// Address range: 0x8048640 - 0x8048657
int32_t sum3_sysv_abi(int32_t a1, int32_t a2, int32_t a3) {
    // 0x8048640
    return a1 + 5 + 2 * a2 + 3 * a3;
}

// Address range: 0x8048660 - 0x8048679
int32_t sum3_stdcall(int32_t a1, int32_t a2, int32_t a3) {
    // 0x8048660
    g3 = a1;
    return a1 + 6 + 2 * a2 + 3 * a3;
}

// Address range: 0x8048680 - 0x80487a5
int32_t basic_1_multiple_calling_conventions_3_ints(int32_t a1) {
    int32_t time_val = time(NULL); // 0x804868b
    if (sum3_cdecl(a1, time_val, 42) > 123) {
        // 0x8048790
        puts("cdecl");
        // branch -> 0x80486aa
    }
    // 0x80486aa
    g5 = time_val;
    g3 = a1;
    if (sum3_fastcall(42) > 123) {
        // 0x8048778
        puts("fastcall");
        // branch -> 0x80486c4
    }
    // 0x80486c4
    g3 = a1;
    if (sum3_thiscall(time_val, 42) > 123) {
        // 0x8048760
        puts("thiscall");
        // branch -> 0x80486dc
    }
    // 0x80486dc
    if (sum3_ms_abi(a1, time_val, 42) > 123) {
        // 0x8048748
        puts("ms_abi");
        // branch -> 0x80486f0
    }
    // 0x80486f0
    if (sum3_sysv_abi(a1, time_val, 42) > 123) {
        // 0x8048730
        puts("sysv_abi");
        // branch -> 0x8048704
    }
    // 0x8048704
    if (sum3_stdcall(a1, time_val, 42) > 123) {
        // 0x8048716
        puts("stdcall");
        // branch -> 0x8048726
    }
    // 0x8048726
    g6 = (int32_t)(char *)42;
    return 0;
}

// Address range: 0x80487b0 - 0x80487c3
int32_t a_vararg(int32_t a1) {
    // 0x80487b0
    puts("a_vararg called");
    return 0;
}

// Address range: 0x80487d0 - 0x804880e
int32_t basic_2_calling_varargs(int32_t a1) {
    // 0x80487d0
    int32_t * v1;
    a_vararg((int32_t)&v1);
    a_vararg(1);
    a_vararg(1);
    a_vararg(1);
    a_vararg(1);
    return 0;
}

// Address range: 0x8048810 - 0x804881d
int32_t basic_4_tail_call(int32_t a1) {
    // 0x8048810
    return time(NULL);
}

// Address range: 0x8048820 - 0x8048900
int32_t crude_printf(char * a1, int32_t a2, int32_t a3) {
    struct _IO_FILE * stream = (struct _IO_FILE *)g6; // 0x8048822
    char * c = (char *)g2; // bp-16
    int32_t v1; // bp-28
    int32_t v2 = &v1; // 0x8048824
    char v3 = *a1; // 0x804882b
    int32_t result2; // 0x8048895
    if (v3 == 0) {
        // 0x80488fc
        result2 = 0;
        // branch -> 0x8048892
    } else {
        // 0x8048837
        int32_t v4;
        int32_t v5 = &v4; // esi
        int32_t result = 0; // ebx
        int32_t v6 = (int32_t)a1; // 0x8048840
        // branch -> 0x8048872
        int32_t v7; // 0x80488769
        while (true) {
            // 0x8048872
            int32_t v8; // 0x804888b
            if (v3 == 37) {
                int32_t v9 = v6 + 1; // 0x8048840
                char v10 = *(char *)v9; // 0x8048840
                int32_t v11; // 0x8048867
                char v12; // 0x8048867
                if (v10 == 37) {
                    // 0x80488c8
                    result++;
                    *(int32_t *)(v2 - 16) = 37;
                    putchar((int32_t)c);
                    // branch -> 0x8048867
                } else {
                    // 0x804884b
                    if (v10 == 99) {
                        int32_t v13 = v5; // 0x80488e0
                        v5 = v13 + 4;
                        result++;
                        *(int32_t *)(v2 - 16) = (int32_t)*(char *)v13;
                        putchar((int32_t)c);
                        // branch -> 0x8048867
                    } else {
                        // 0x8048853
                        if (v10 == 115) {
                            int32_t v14 = v5; // 0x80488a0
                            v5 = v14 + 4;
                            int32_t v15 = *(int32_t *)v14; // ebp
                            *(int32_t *)(v2 - 12) = (int32_t)g8;
                            *(int32_t *)(v2 - 16) = v15;
                            fputs(c, stream);
                            *(int32_t *)g7 = v15;
                            result += strlen(c);
                            // branch -> 0x8048867
                        } else {
                            // 0x8048857
                            *(int32_t *)(v2 - 16) = (int32_t)"Not implemented";
                            puts(c);
                            // branch -> 0x8048867
                        }
                        // 0x8048867
                        v7 = g7 + 16;
                        v11 = v9 + 1;
                        v12 = *(char *)v11;
                        if (v12 == 0) {
                            // break -> 0x8048892
                            break;
                        }
                        v6 = v11;
                        v2 = v7;
                        v3 = v12;
                        // continue -> 0x8048872
                        continue;
                    }
                    // 0x8048867
                    v7 = g7 + 16;
                    v11 = v9 + 1;
                    v12 = *(char *)v11;
                    if (v12 == 0) {
                        // break -> 0x8048892
                        break;
                    }
                    v6 = v11;
                    v2 = v7;
                    v3 = v12;
                    // continue -> 0x8048872
                    continue;
                }
                // 0x8048867
                v7 = g7 + 16;
                v11 = v9 + 1;
                v12 = *(char *)v11;
                if (v12 == 0) {
                    // break -> 0x8048892
                    break;
                }
                v6 = v11;
                v2 = v7;
                v3 = v12;
                // continue -> 0x8048872
                continue;
            } else {
                // 0x8048876
                result++;
                *(int32_t *)(v2 - 16) = (int32_t)v3;
                int32_t v16 = v6; // 0x804887f
                putchar((int32_t)c);
                char v17 = *(char *)(v16 + 1); // 0x8048887
                v8 = g7 + 16;
                if (v17 != 0) {
                    // 0x8048876
                    v6 = v16 + 1;
                    v2 = v8;
                    v3 = v17;
                    // branch -> 0x8048872
                    continue;
                }
            }
            // 0x8048892
            v2 = v8;
            // branch -> 0x8048892
            // 0x8048892
            g2 = *(int32_t *)(v2 + 12);
            g6 = *(int32_t *)(v2 + 16);
            return result;
        }
        // 0x8048892
        result2 = result;
        v2 = v7;
        // branch -> 0x8048892
    }
    // 0x8048892
    g2 = *(int32_t *)(v2 + 12);
    g6 = *(int32_t *)(v2 + 16);
    return result2;
}

// Address range: 0x8048900 - 0x8048931
int32_t even_more_crude(char * a1, int32_t str, int32_t a3) {
    // 0x8048900
    putchar(0x1000000 * (int32_t)a1 / 0x1000000);
    fputs((char *)str, (struct _IO_FILE *)*(int32_t *)&g8);
    return strlen((char *)str) + 1;
}

// Address range: 0x8048940 - 0x804896f
int32_t intermediate_1_accessing_varargs(void) {
    // 0x8048940
    even_more_crude("low: a %c b %s c\n", 48, (int32_t)"hello");
    return crude_printf("higher: a %c b %s c\n", 48, (int32_t)"hello") + 42;
}

// Address range: 0x8048970 - 0x8048988
int32_t intermediate_4_asm_instr_with_multiple_results(int32_t a1, int32_t a2) {
    struct struct1 v1; // 0x8048979
    // 0x8048970
    v1 = __asm_cpuid(a1);
    return 2 * v1.e1 + 3 * v1.e2 + v1.e0 + 4 * v1.e3;
}

// Address range: 0x8048990 - 0x80489b1
int32_t basic_3_accessing_all_registers(void) {
    // 0x8048990
    return 8 * g1 + g3;
}

// Address range: 0x80489b1 - 0x80489c1
int32_t sum3_uncommon(void) {
    // 0x80489b1
    return 2 * g4 + g6 + 3 * g1 + 10;
}

// Address range: 0x80489d0 - 0x80489fb
int32_t intermediate_2_use_uncommon_registers_for_parameters(int32_t a1) {
    // 0x80489d0
    g6 = a1;
    g2 = 0;
    g4 = time(NULL);
    g1 = 42;
    if (sum3_uncommon() > 123) {
        // 0x80489ed
        puts("un common");
        g2 = (int32_t)"un common";
        // branch -> 0x80489f8
    }
    // 0x80489f8
    return 0;
}

// Address range: 0x8048a00 - 0x8048a21
int32_t intermediate_3_calling_noreturn(void) {
    // 0x8048a00
    puts("before");
    exit(1);
    // UNREACHABLE
}

// Address range: 0x8048a30 - 0x8048a4e
int32_t intermediate_5_pushs_in_different_blocks(int32_t a1) {
    // 0x8048a30
    puts(a1 == 42 ? "is 42" : "it not 42");
    return 0;
}

// Address range: 0x8048a50 - 0x8048a62
int32_t advanced_1_pass_in_flags_reg_helper(void) {
    // 0x8048a50
    if (!g11 && g10 == g9) {
        // 0x8048a52
        puts("is above 2");
        // branch -> 0x8048a5f
    }
    // 0x8048a5f
    return 0;
}

// Address range: 0x8048a62 - 0x8048a75
int32_t advanced_1_pass_in_flags_reg(int32_t a1) {
    int32_t v1 = a1 - 2; // 0x8048a65
    g9 = (1 - a1 & a1) < 0;
    g11 = v1 == 0;
    g10 = v1 < 0;
    advanced_1_pass_in_flags_reg_helper();
    return 0;
}

// Address range: 0x8048a75 - 0x8048a83
int32_t advanced_2_return_in_flags_reg_helper(void) {
    // 0x8048a75
    int32_t v1; // bp-12
    int32_t v2 = &v1; // 0x8048a75
    int32_t v3 = v2 + 12; // 0x8048a7f
    g9 = (v3 & (v2 ^ -0x80000000)) < 0;
    g11 = v3 == 0;
    g10 = v3 < 0;
    return 0;
}

// Address range: 0x8048a83 - 0x8048a9a
int32_t advanced_2_return_in_flags_reg(int32_t a1) {
    // 0x8048a83
    advanced_2_return_in_flags_reg_helper();
    if (!g11 && g10 == g9) {
        // 0x8048a8a
        puts("is above 2");
        // branch -> 0x8048a97
    }
    // 0x8048a97
    return 0;
}

// Address range: 0x8048a9a - 0x8048ac8
int32_t advanced_3_uneven_stack(int32_t a1) {
    // 0x8048a9a
    char * str; // 0x8048ab5
    if (a1 == 42) {
        // 0x8048aab
        str = "is 42";
        // branch -> 0x8048ab5
    } else {
        // 0x8048aa4
        char * v1;
        str = v1;
        // branch -> 0x8048ab5
    }
    // 0x8048ab5
    puts(str);
    if (a1 == 42) {
        // 0x8048ac2
        // branch -> 0x8048ac4
    }
    // 0x8048ac4
    return 0;
}

// --------------- Dynamically Linked Functions ---------------

// void exit(int status);
// int fputs(const char * restrict s, FILE * restrict stream);
// int putchar(int c);
// int puts(const char * s);
// size_t strlen(const char * s);
// time_t time(time_t * timer);

// --------------------- Meta-Information ---------------------

// Detected compiler/packer: gcc (6.4.1)
// Detected functions: 25
// Decompilation date: 2018-09-10 17:11:50
