// subject_fini.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject_fini.h"

// 0000000000400C34: void _fini()
void _fini()
{
}

// subject_init.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject_init.h"

// 00000000004005A0: Register word64 _init(Register out ptr64 x30Out)
// Called from:
//      __libc_csu_init
word64 _init(ptr64 & x30Out)
{
	call_weak_fn();
	x30Out = qwArg00;
	return x30;
}

// subject_plt.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject_plt.h"

// 00000000004005E0: void fn00000000004005E0()
// Called from:
//      _start
void fn00000000004005E0()
{
	g_ptr411000();
}

// 00000000004005F0: void fn00000000004005F0()
// Called from:
//      new_tower
//      main
void fn00000000004005F0()
{
	g_ptr411008();
}

// 0000000000400610: void fn0000000000400610()
// Called from:
//      _start
void fn0000000000400610()
{
	g_ptr411018();
}

// 0000000000400620: void fn0000000000400620()
// Called from:
//      main
void fn0000000000400620()
{
	g_ptr411020();
}

// 0000000000400630: void fn0000000000400630()
// Called from:
//      main
void fn0000000000400630()
{
	g_ptr411028();
}

// 0000000000400650: void fn0000000000400650()
// Called from:
//      add_disk
void fn0000000000400650()
{
	g_ptr411038();
}

// 0000000000400660: void fn0000000000400660()
// Called from:
//      text
//      add_disk
//      remove_disk
//      move
//      main
void fn0000000000400660()
{
	g_ptr411040();
}

// subject_text.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject_text.h"

// 0000000000400670: void _start()
void _start()
{
	fn00000000004005E0();
	fn0000000000400610();
}

// 00000000004006B8: void call_weak_fn()
// Called from:
//      _init
void call_weak_fn()
{
	if (g_qw410FE0 == 0x00)
		return;
	word64 x17_12;
	g_ptr411010();
}

// 00000000004006D0: void deregister_tm_clones()
// Called from:
//      __do_global_dtors_aux
void deregister_tm_clones()
{
	if (0x0041105F - 4264024 <= 0x0E)
		return;
	<anonymous> * x1_12 = g_ptr400708;
	if (x1_12 == null)
		return;
	x1_12();
}

// 0000000000400710: void register_tm_clones()
// Called from:
//      frame_dummy
void register_tm_clones()
{
	int64 x1_7 = 4264024 - 4264024;
	if ((x1_7 >> 3) + ((x1_7 >> 3) >>u 63) >> 1 == 0x00)
		return;
	<anonymous> * x2_12 = g_ptr400748;
	if (x2_12 == null)
		return;
	word64 x2_16;
	x2_12();
}

// 0000000000400750: void __do_global_dtors_aux()
void __do_global_dtors_aux()
{
	if ((word32) g_b411060 == 0x00)
	{
		deregister_tm_clones();
		g_b411060 = 0x01;
	}
}

// 0000000000400780: void frame_dummy(Register word64 x29, Register word64 x30)
void frame_dummy(word64 x29, word64 x30)
{
	if (g_qw410DF0 != 0x00)
	{
		<anonymous> * x1_7 = g_ptr4007B8;
		if (x1_7 != null)
		{
			x1_7();
			register_tm_clones();
			return;
		}
	}
	register_tm_clones();
}

// 00000000004007C0: void new_tower(Register word64 x0)
void new_tower(word64 x0)
{
	word32 x0_32_32_16 = SLICE(x0, word32, 32);
	__sbfiz(x0, 2);
	fn00000000004005F0();
	word64 * x0_17 = SEQ(x0_32_32_16, 0x01);
	*x0_17 = x0_17 + 2;
}

// 00000000004007E8: void text(Register word32 w1, Register word32 w2)
void text(word32 w1, word32 w2)
{
	__bfm(w1, 31, 30);
	fn0000000000400660();
	word32 w20_26 = w2;
	if (w2 != 0x00)
	{
		do
		{
			fn0000000000400660();
			--w20_26;
		} while (w20_26 != 0x00);
	}
}

// 0000000000400860: Register word64 add_disk(Register word32 w0, Register word32 w1, Register word64 x19, Register word64 x20, Register (ptr64 Eq_140) x21, Register ptr64 x29, Register word64 x30, Register out ptr64 x19Out, Register out ptr64 x20Out, Register out ptr64 x21Out, Register out ptr64 x29Out, Register out ptr64 x30Out)
// Called from:
//      move
//      main
word64 add_disk(word32 w0, word32 w1, word64 x19, word64 x20, struct Eq_140 * x21, ptr64 x29, word64 x30, ptr64 & x19Out, ptr64 & x20Out, ptr64 & x21Out, ptr64 & x29Out, ptr64 & x30Out)
{
	struct Eq_148 * x8_25 = (&g_t411068)[(int64) (int32) w0 / 8];
	ui64 x9_29 = (word64) x8_25->dw0004;
	word32 x10_30[] = x8_25->ptr0000;
	x8_25->dw0008 = (word32) x9_29 + 0x01;
	x10_30[x9_29] = w1;
	word32 w9_37 = g_dw411080;
	word32 w8_39 = 0x01 - x8_25->dw0008;
	__bfm(w0, 31, 30);
	fn0000000000400660();
	word32 w19_27 = w1;
	word32 w1_42 = w8_39 + w9_37;
	if (w1 != 0x00)
	{
		do
		{
			fn0000000000400660();
			w1_42 = (word32) 0x00400C54;
			--w19_27;
		} while (w19_27 != 0x00);
	}
	fn0000000000400650();
	word32 w0_86 = g_dw411058;
	ptr64 x21_91;
	ptr64 x20_92;
	ptr64 x19_93;
	ptr64 x29_94;
	ptr64 x30_95;
	word64 x0_97;
	g_ptr411030();
	x19Out = x19_93;
	x20Out = x20_92;
	x21Out = x21_91;
	x29Out = x29_94;
	x30Out = x30_95;
	return x0_97;
}

// 0000000000400914: void remove_disk(Register word32 w0)
void remove_disk(word32 w0)
{
	struct Eq_215 * x8_25 = (&g_t411068)[(int64) (int32) w0 / 8];
	ui64 x9_28 = (word64) x8_25->dw0004;
	word32 x11_29[] = x8_25->ptr0000;
	x8_25->dw0008 = (word32) (x9_28 - 0x01);
	word32 w19_34 = x11_29[x9_28 - 0x01];
	__bfm(w0, 31, 30);
	fn0000000000400660();
	if (w19_34 != 0x00)
	{
		word32 w22_48;
		do
		{
			fn0000000000400660();
			--w22_48;
		} while (w22_48 != 0x00);
	}
}

// 00000000004009B0: Register ptr64 move(Register word64 x0, Register out ptr64 x20Out, Register out ptr64 x21Out, Register out ptr64 x28Out, Register out ptr64 x29Out, Register out ptr64 x30Out)
// Called from:
//      move
//      main
ptr64 move(word64 x0, ptr64 & x20Out, ptr64 & x21Out, ptr64 & x28Out, ptr64 & x29Out, ptr64 & x30Out)
{
	word32 w0 = (word32) x0;
	if (w0 != 0x00)
	{
		do
		{
			word64 x28_81;
			struct Eq_140 * x21_88;
			word64 x20_89;
			ptr64 x29_91;
			word64 x30_92;
			word64 x19_90 = move(x0, out x20_89, out x21_88, out x28_81, out x29_91, out x30_92);
			word32 w20_103 = (word32) x20_89;
			struct Eq_313 * x8_105 = (&g_t411068)[(int64) (int32) w20_103 / 8];
			__bfm(w20_103, 31, 30);
			ui64 x9_109 = (word64) x8_105->dw0004;
			word32 x10_110[] = x8_105->ptr0000;
			x8_105->dw0008 = (word32) (x9_109 - 0x01);
			word32 w27_115 = x10_110[x9_109 - 0x01];
			fn0000000000400660();
			word32 w19_133 = (word32) x19_90;
			word32 w26_122 = w27_115;
			if (w27_115 != 0x00)
			{
				do
				{
					fn0000000000400660();
					--w26_122;
				} while (w26_122 != 0x00);
			}
			word64 x19_157;
			word64 x20_158;
			word64 x21_159;
			word64 x29_161;
			word64 x30_162;
			add_disk(w19_133, w27_115, x19_90, x20_89, x21_88, x29_91, x30_92, out x19_157, out x20_158, out x21_159, out x29_161, out x30_162);
		} while ((word32) x21_159 != 0x00);
	}
	x20Out = x21;
	x21Out = x22;
	x28Out = <invalid>;
	x29Out = x19;
	x30Out = x29;
	return x20;
}

// 0000000000400AA8: void main(Register int32 w0, Register (ptr64 Eq_348) x1, Register word64 x30)
void main(int32 w0, struct Eq_348 * x1, word64 x30)
{
	word64 x19_217;
	fn0000000000400620();
	ptr64 x29_102 = fp + ~0x07;
	word32 x0_32_32_57 = SLICE(0x00400C5A, word32, 32);
	word32 x19_32_32_43 = SLICE(x1, word32, 32);
	if (w0 >= 0x02)
	{
		word64 x0_32 = x1->qw0008;
		fn0000000000400630();
		x0_32_32_57 = SLICE(x0_32, word32, 32);
		x19_217 = x0_32;
		x19_32_32_43 = SLICE(x0_32, word32, 32);
		if ((word32) x0_32 > 0x00)
		{
l0000000000400AF4:
			word64 x20_48 = __sbfiz(x19_217, 2) + 0x10;
			g_dw411080 = (word32) x19_217;
			fn00000000004005F0();
			Eq_390 x0_61 = SEQ(x0_32_32_57, 0x01);
			*x0_61.t0000 = (Eq_390) ((word64) x0_61.t0000 + 16);
			g_t411068.t0000 = x0_61;
			fn00000000004005F0();
			word64 * x0_70 = SEQ(x0_32_32_57, 0x01);
			*x0_70 = x0_70 + 2;
			g_ptr411070 = x0_70;
			fn00000000004005F0();
			word64 * x0_78 = SEQ(x0_32_32_57, 0x01);
			*x0_78 = x0_78 + 2;
			g_ptr411078 = x0_78;
			struct Eq_140 * x21_100 = &g_ptr411000;
			do
			{
				word32 w19_106 = (word32) x19_98;
				word64 x19_98;
				word32 x0_32_32_113 = SLICE(add_disk(0x00, (word32) x19_217, x19_217, x20_48, x21_100, x29_102, x30, out x19_98, out x20_48, out x21_100, out x29_102, out x30), word32, 32);
				x19_217 = SEQ(SLICE(x19_98, word32, 32), w19_106 - 0x01);
			} while (w19_106 != 0x01);
			word64 x21_119;
			word64 x20_219;
			word64 x28_220;
			word64 x29_221;
			word64 x30_222;
			move(SEQ(x0_32_32_113, x21_100->dw0080), out x20_219, out x21_119, out x28_220, out x29_221, out x30_222);
			fn0000000000400660();
			fn0000000000400660();
			return;
		}
	}
	x19_217 = SEQ(x19_32_32_43, 0x08);
	goto l0000000000400AF4;
}

// 0000000000400BB8: void __libc_csu_init(Register word32 w0, Register word64 x1, Register word64 x2, Register word64 x24)
void __libc_csu_init(word32 w0, word64 x1, word64 x2, word64 x24)
{
	word32 x24_32_32_104 = SLICE(x24, word32, 32);
	int64 x20_26 = 4263400 - 0x00410DE0;
	<anonymous> * x21_24[] = g_a410DE0;
	word64 x22_34 = x2;
	word64 x23_38 = x1;
	word64 x30_44;
	word64 x29_43 = _init(out x30_44);
	int64 x20_45 = x20_26 >> 3;
	if (x20_26 >> 3 != 0x00)
	{
		int64 x19_46 = 0x00;
		word64 x24_151 = SEQ(x24_32_32_104, w0);
		do
		{
			word64 x3_76;
			x21_24[x19_46]();
			int64 x31_81 = x20_45 - x19_46;
		} while (x31_81 != 0x00);
	}
}

// 0000000000400C30: void __libc_csu_fini()
void __libc_csu_fini()
{
}

