//
// This file was generated by the Retargetable Decompiler
// Website: https://retdec.com
//

#include <math.h>
#include <stdint.h>
#include <stdio.h>

// ------------------- Function Prototypes --------------------

int32_t rc_crc32(int32_t crc, char * buf, int64_t len);

// --------------------- Global Variables ---------------------

char * g1 = "0\x04@"; // 0x411000
int64_t g2 = 0; // 0x411034
int64_t g3; // 0x411434

// ------------------------ Functions -------------------------

// From module:   /mnt/from_holdec/./movfuscator/crc32/source.c
// Address range: 0x4005e0 - 0x400674
// Line range:    8 - 40
int32_t rc_crc32(int32_t crc, char * buf, int64_t len) {
    int64_t v1 = 0; // 0x4005e8
    if (*(char *)((int64_t)&g1 + 1076) % 2 == 0) {
        uint64_t v2 = v1;
        int64_t v3 = (v2 % 2 == 0 ? 0 : 0xedb88320) ^ v2 / 2 % 0x80000000; // 0x400614
        int64_t v4 = 0x100000007; // 0x400618
        int64_t v5 = v4 & 0xffffffff; // 0x40061c
        while ((int32_t)v4 != 0) {
            // 0x400608
            v2 = v3;
            v3 = (v2 % 2 == 0 ? 0 : 0xedb88320) ^ v2 / 2 % 0x80000000;
            v4 = v5 + 0xffffffff;
            v5 = v4 & 0xffffffff;
        }
        // 0x400620
        *(int32_t *)(4 * v1 + (int64_t)&g2) = (int32_t)v3;
        v1++;
        while (v1 != 256) {
            // 0x400600
            v2 = v1;
            v3 = (v2 % 2 == 0 ? 0 : 0xedb88320) ^ v2 / 2 % 0x80000000;
            v4 = 0x100000007;
            v5 = v4 & 0xffffffff;
            while ((int32_t)v4 != 0) {
                // 0x400608
                v2 = v3;
                v3 = (v2 % 2 == 0 ? 0 : 0xedb88320) ^ v2 / 2 % 0x80000000;
                v4 = v5 + 0xffffffff;
                v5 = v4 & 0xffffffff;
            }
            // 0x400620
            *(int32_t *)(4 * v1 + (int64_t)&g2) = (int32_t)v3;
            v1++;
        }
        // 0x400630
        *(char *)&g3 = 1;
    }
    int32_t v6 = -1 - crc;
    if (len < 1) {
        // 0x40066c
        return -1 - v6;
    }
    int64_t v7 = (int64_t)buf;
    int64_t v8 = v7; // 0x40064c
    int32_t v9 = v6; // 0x40064c
    unsigned char v10 = *(char *)v8; // 0x400650
    v8++;
    int32_t v11 = *(int32_t *)(4 * ((int64_t)(v9 % 256) ^ (int64_t)v10) + (int64_t)&g2); // 0x40065c
    v9 = v11 ^ v9 / 256;
    while (v8 < v7 + len) {
        // 0x400650
        v10 = *(char *)v8;
        v8++;
        v11 = *(int32_t *)(4 * ((int64_t)(v9 % 256) ^ (int64_t)v10) + (int64_t)&g2);
        v9 = v11 ^ v9 / 256;
    }
    // 0x40066c
    return -1 - v9;
}

// From module:   /mnt/from_holdec/./movfuscator/crc32/source.c
// Address range: 0x400674 - 0x4006ac
// Line range:    44 - 49
int main() {
    // 0x400674
    printf("%X\n", rc_crc32(0, "The quick brown fox jumps over the lazy dog", 43));
    return 0;
}

// --------------- Dynamically Linked Functions ---------------

// int printf(const char * restrict format, ...);

// --------------------- Meta-Information ---------------------

// Detected compiler/packer: llvm (3.8.1)
// Detected functions: 2

