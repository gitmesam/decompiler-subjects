//
// This file was generated by the Retargetable Decompiler
// Website: https://retdec.com
// Copyright (c) Retargetable Decompiler <info@retdec.com>
//

#include <stdint.h>
#include <stdio.h>
#include <stdlib.h>
#include <string.h>

// ------------------- Function Prototypes --------------------

int32_t rc_crc32(int32_t crc, char * buf, int64_t len);

// --------------------- Global Variables ---------------------

int32_t * g1 = NULL; // 0x41103c
int32_t * g2; // 0x41143c

// ------------------------ Functions -------------------------

// From module:   /mnt/from_holdec/./movfuscator/crc32/source.c
// Address range: 0x400640 - 0x4007bc
// Line range:    8 - 40
int32_t rc_crc32(int32_t crc, char * buf, int64_t len) {
    int64_t v1 = 0; // 0x40065c
    if (*(int32_t *)&g2 == 0) {
        int32_t v2 = 0; // 0x4006c8
        int32_t v3 = v1; // 0x400640
        uint32_t v4 = v3 / 2;
        int32_t v5 = v3 % 2 == 0 ? v4 : v4 ^ -0x12477ce0;
        v2++;
        v3 = v5;
        while (v2 != 8) {
            // 0x400688
            v4 = v3 / 2;
            v5 = v3 % 2 == 0 ? v4 : v4 ^ -0x12477ce0;
            v2++;
            v3 = v5;
        }
        // 0x4006d4
        *(int32_t *)(4 * v1 + (int64_t)&g1) = v5;
        v1++;
        while (v1 != 256) {
            // 0x40067c
            v2 = 0;
            v3 = v1;
            v4 = v3 / 2;
            v5 = v3 % 2 == 0 ? v4 : v4 ^ -0x12477ce0;
            v2++;
            v3 = v5;
            while (v2 != 8) {
                // 0x400688
                v4 = v3 / 2;
                v5 = v3 % 2 == 0 ? v4 : v4 ^ -0x12477ce0;
                v2++;
                v3 = v5;
            }
            // 0x4006d4
            *(int32_t *)(4 * v1 + (int64_t)&g1) = v5;
            v1++;
        }
        // 0x400704
        *(int32_t *)&g2 = 1;
    }
    int32_t v6 = -1 - crc;
    char * v7 = (char *)((int64_t)buf + len); // 0x400730
    char * v8 = buf; // 0x400748
    if (v7 <= buf) {
        // 0x4007a8
        return -1 - v6;
    }
    int32_t v9 = v6; // 0x400748
    int64_t v10 = v9 % 256 ^ (int32_t)*v8; // 0x400778
    int32_t v11 = *(int32_t *)(4 * __asm_ubfx(v10, v10, 0, 32) + (int64_t)&g1); // 0x40078c
    v9 = v11 ^ v9 / 256;
    v8 = (char *)((int64_t)v8 + 1);
    while (v8 < v7) {
        // 0x40074c
        v10 = v9 % 256 ^ (int32_t)*v8;
        v11 = *(int32_t *)(4 * __asm_ubfx(v10, v10, 0, 32) + (int64_t)&g1);
        v9 = v11 ^ v9 / 256;
        v8 = (char *)((int64_t)v8 + 1);
    }
    // 0x4007a8
    return -1 - v9;
}

// From module:   /mnt/from_holdec/./movfuscator/crc32/source.c
// Address range: 0x4007bc - 0x400838
// Line range:    44 - 49
int main() {
    int32_t len = strlen("The quick brown fox jumps over the lazy dog"); // 0x4007ec
    printf("%X\n", rc_crc32(0, "The quick brown fox jumps over the lazy dog", (int64_t)len));
    return 0;
}

// --------------- Dynamically Linked Functions ---------------

// int printf(const char * restrict format, ...);
// size_t strlen(const char * s);

// --------------------- Meta-Information ---------------------

// Detected compiler/packer: llvm (3.8.1)
// Detected functions: 2

