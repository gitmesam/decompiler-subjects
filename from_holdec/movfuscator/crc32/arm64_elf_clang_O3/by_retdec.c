//
// This file was generated by the Retargetable Decompiler
// Website: https://retdec.com
// Copyright (c) Retargetable Decompiler <info@retdec.com>
//

#include <stdint.h>
#include <stdio.h>
#include <stdlib.h>

// ---------------- Integer Types Definitions -----------------

typedef int64_t int128_t;

// ----------------- Float Types Definitions ------------------

typedef long double float128_t;

// ------------------- Function Prototypes --------------------

int32_t rc_crc32(int32_t crc, char * buf, int64_t len);

// --------------------- Global Variables ---------------------

int32_t g1 = 0; // 0x411040
float128_t * g2 = NULL; // 0x411044

// ------------------------ Functions -------------------------

// From module:   /mnt/from_holdec/./movfuscator/crc32/source.c
// Address range: 0x4005e0 - 0x40070c
// Line range:    8 - 40
int32_t rc_crc32(int32_t crc, char * buf, int64_t len) {
    // 0x4005e0
    if (*(char *)&g1 % 2 == 0) {
        // 0x4005f0
        int128_t v1; // 0x4005e0
        int128_t v2 = __asm_movi(v1, 1); // 0x400608
        int128_t v3 = __asm_dup(-0x12477ce0); // 0x40060c
        int64_t v4 = 0; // 0x40060c
        int64_t v5 = (int64_t)&g2; // 0x40060c
        int128_t v6 = __asm_dup((int32_t)v4) + v1; // 0x400614
        int128_t v7 = __asm_ushr(v6, v6, 1); // 0x40061c
        int128_t v8 = __asm_bsl(__asm_cmeq(v6 & v2, 0), v7, v7 ^ v3); // 0x400628
        int128_t v9 = __asm_ushr(v8, v8, 1); // 0x400630
        int128_t v10 = __asm_bsl(__asm_cmeq(v8 & v2, 0), v9, v9 ^ v3); // 0x40063c
        int128_t v11 = __asm_ushr(v10, v10, 1); // 0x400644
        int128_t v12 = __asm_bsl(__asm_cmeq(v10 & v2, 0), v11, v11 ^ v3); // 0x400650
        int128_t v13 = __asm_ushr(v12, v12, 1); // 0x400658
        int128_t v14 = __asm_bsl(__asm_cmeq(v12 & v2, 0), v13, v13 ^ v3); // 0x400664
        int128_t v15 = __asm_ushr(v14, v14, 1); // 0x40066c
        int128_t v16 = __asm_bsl(__asm_cmeq(v14 & v2, 0), v15, v15 ^ v3); // 0x400678
        int128_t v17 = __asm_ushr(v16, v16, 1); // 0x400680
        int128_t v18 = __asm_bsl(__asm_cmeq(v16 & v2, 0), v17, v17 ^ v3); // 0x40068c
        int128_t v19 = __asm_ushr(v18, v18, 1); // 0x400694
        int128_t v20 = __asm_bsl(__asm_cmeq(v18 & v2, 0), v19, v19 ^ v3); // 0x4006a0
        int128_t v21 = __asm_ushr(v20, v20, 1); // 0x4006a8
        __asm_bsl(__asm_cmeq(v20 & v2, 0), v21, v21 ^ v3);
        v4 += 4;
        while (v4 != 256) {
            // 0x400610
            v5 += 16;
            v6 = __asm_dup((int32_t)v4) + v1;
            v7 = __asm_ushr(v6, v6, 1);
            v8 = __asm_bsl(__asm_cmeq(v6 & v2, 0), v7, v7 ^ v3);
            v9 = __asm_ushr(v8, v8, 1);
            v10 = __asm_bsl(__asm_cmeq(v8 & v2, 0), v9, v9 ^ v3);
            v11 = __asm_ushr(v10, v10, 1);
            v12 = __asm_bsl(__asm_cmeq(v10 & v2, 0), v11, v11 ^ v3);
            v13 = __asm_ushr(v12, v12, 1);
            v14 = __asm_bsl(__asm_cmeq(v12 & v2, 0), v13, v13 ^ v3);
            v15 = __asm_ushr(v14, v14, 1);
            v16 = __asm_bsl(__asm_cmeq(v14 & v2, 0), v15, v15 ^ v3);
            v17 = __asm_ushr(v16, v16, 1);
            v18 = __asm_bsl(__asm_cmeq(v16 & v2, 0), v17, v17 ^ v3);
            v19 = __asm_ushr(v18, v18, 1);
            v20 = __asm_bsl(__asm_cmeq(v18 & v2, 0), v19, v19 ^ v3);
            v21 = __asm_ushr(v20, v20, 1);
            __asm_bsl(__asm_cmeq(v20 & v2, 0), v21, v21 ^ v3);
            v4 += 4;
        }
        // 0x4006c8
        *(char *)&g1 = 1;
    }
    int32_t v22 = -1 - crc;
    if (len < 1) {
        // 0x400704
        return -1 - v22;
    }
    int64_t v23 = (int64_t)buf;
    int64_t v24 = v23; // 0x4006e0
    int32_t v25 = v22; // 0x4006e0
    unsigned char v26 = *(char *)v24; // 0x4006e4
    v24++;
    int32_t v27 = *(int32_t *)(4 * ((int64_t)(v25 % 256) ^ (int64_t)v26) + (int64_t)&g1 + 4); // 0x4006f4
    v25 = v27 ^ v25 / 256;
    while (v24 < v23 + len) {
        // 0x4006e4
        v26 = *(char *)v24;
        v24++;
        v27 = *(int32_t *)(4 * ((int64_t)(v25 % 256) ^ (int64_t)v26) + (int64_t)&g1 + 4);
        v25 = v27 ^ v25 / 256;
    }
    // 0x400704
    return -1 - v25;
}

// From module:   /mnt/from_holdec/./movfuscator/crc32/source.c
// Address range: 0x40070c - 0x400744
// Line range:    44 - 49
int main() {
    // 0x40070c
    printf("%X\n", rc_crc32(0, "The quick brown fox jumps over the lazy dog", 43));
    return 0;
}

// --------------- Dynamically Linked Functions ---------------

// int printf(const char * restrict format, ...);

// --------------------- Meta-Information ---------------------

// Detected compiler/packer: llvm (3.8.1)
// Detected functions: 2

