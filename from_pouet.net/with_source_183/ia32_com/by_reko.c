// subject_code.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject_code.h"

// 0C00:0100: void fn0C00_0100(Register byte dl, Register byte bl, Register word16 si, Register (ptr16 Eq_5) ds, FpuStack real64 rLoc2)
void fn0C00_0100(byte dl, byte bl, word16 si, struct Eq_5 * ds, real64 rLoc2)
{
	bios_video_set_mode(0x13);
	Eq_12 bx_8 = SEQ(0x70, bl);
	Eq_12 bx_11 = SEQ(0x80, bl);
	bx_29 = bx_11;
	do
	{
		Eq_12 bx_29;
		rLoc2 = sin(rLoc2) * (real64) ds->w014B;
		bx_11->*bx_29 = (int16) rLoc2;
		bx_8->*bx_29 = si;
		struct Eq_34 Eq_12::* bx_36 = (word16) bx_29 + 1;
		bx_29 = bx_36 + 1;
	} while (!OVERFLOW(bx_36 + 1));
	struct Eq_45 Eq_5::* di_42 = &Eq_5::t000A;
	struct Eq_47 Eq_12::* bx_330 = bx_36 + 1;
	do
	{
		int16 si_46 = (ds->*di_42).w0000;
		struct Eq_47 Eq_12::* bx_327 = bx_330;
		do
		{
			bi8 bl_47 = (byte) bx_334;
			bi8 bh_54 = SLICE(bx_334, byte, 8);
			if (bh_54 *s bh_54 + bl_47 *s bl_47 <=u 2499)
				bx_334[si_46] = dl;
			bx_327 = bx_334 + 1;
			bx_334 = bx_327;
		} while (!OVERFLOW(bx_334 + 1));
		word16 di_71 = di_42 - 0x01;
		di_42 = di_71 - 0x01;
		bx_330 = bx_334 + 1;
	} while (di_71 != 0x01);
	do
	{
		word16 bx_179 = 0x0100;
		word16 si_78 = *((word16) bx_11 + 0x0100);
		word16 bp_79 = *((word16) bx_11 + 8448);
		word16 dx_180 = 0x00;
		byte Eq_98::* di_109 = &Eq_98::b0000;
		word16 cx_182 = 200;
		do
		{
			word16 cx_112;
			bx_114 = bx_179;
			dx_117 = dx_180;
			di_152 = di_109;
			for (cx_112 = 0x0140; cx_112 != 0x00; --cx_112)
			{
				byte Eq_98::* di_152;
				word16 dx_117;
				word16 bx_114;
				word16 bx_116 = bx_114 + bp_79;
				dx_117 += si_78;
				cu8 al_127 = 0x0F;
				Eq_112 bx_130 = SEQ(SLICE(bx_116, byte, 8), SLICE(dx_117, byte, 8));
				while (bx_8->*bx_130 <= al_127)
				{
					bx_130 *= 0x02;
					al_127 -= 0x03;
					if (al_127 == 0x00)
						break;
				}
				0xA000->*di_152 = al_127 + 0x10;
				++di_152;
				bx_114 = bx_116;
			}
			di_109 += 320;
			bx_179 -= si_78;
			dx_180 += bp_79;
			cx_182 = cx_333 - 0x01;
			cx_333 = cx_182;
		} while (cx_333 != 0x01);
		++ds->b014C;
		ds->b016D += 0x04;
		byte al_194;
		byte ah_195;
	} while (bios_kbd_check_keystroke(out al_194, out ah_195));
	bios_video_set_mode(0x03);
}

