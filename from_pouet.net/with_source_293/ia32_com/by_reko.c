// subject_code.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject_code.h"

// 0C00:0100: void fn0C00_0100(Register (ptr16 Eq_2) ds)
void fn0C00_0100(struct Eq_2 * ds)
{
	Eq_3 si_13 = 13000;
	do
	{
		--si_13;
		ds->*((word16) si_13 + 516) = 0x00;
	} while (si_13 != 0x00);
	word16 cx_11;
	for (cx_11 = 0x55; cx_11 != 0x00; --cx_11)
	{
		ss->a0205[si_13] = ds->a01C4[(word16) (ds->*((word16) si_13 + 516))];
		si_13 = (word16) si_13 + 1;
	}
	word16 ax_35;
	msdos_create_truncate_file(0x00, ds, 442, out ax_35);
	ds->w0202 = ax_35;
	uint16 bx_43 = (uint16) (uint8) fn0C00_01B1(&ds->b01D4, 44);
	byte Eq_2::* di_244 = Eq_2::a0259;
	word16 cx_246 = 0x0100;
	do
	{
		byte bh_254 = SLICE(bx_43, byte, 8);
		if ((ds->*di_244 & 0x01) != 0x00)
		{
			ds->r05F0 = 1.0F;
			ds->r2534 = 1.0F;
			ds->r1598 = 1.0F;
		}
		word16 cx_116 = 6300;
		do
		{
			word16 bx_100 = SEQ(bh_254, ds->*di_244);
			word16 bx_106 = SEQ(SLICE(bx_100 + 0x01, byte, 8), (byte) (bx_100 + 0x01) << 0x06);
			word16 bx_107 = bx_106 - 0x01;
			real64 rLoc1_277 = 0.0;
			struct Eq_82 Eq_24::* bp_136 = Eq_24::a05EC;
			word16 cx_137 = 0x03;
			do
			{
				bx_258 = SEQ(bh_257, bl_198 >> 0x01);
				ui16 si_164 = (ss->*bp_136).w0000;
				real64 rLoc2_286 = (real64) *((char *) &&(ss->*(ss->*(&bp_136->w0000 + 2)).w0000) + si_164 * 0x04);
				ui16 si_175 = (word16) (uint8) ((si_164 + 0x01) % (byte) bx_107);
				(ss->*bp_136).w0000 = si_175;
				real64 rLoc2_288 = (rLoc2_286 - *((char *) (&(&(ss->*(ss->*(&bp_136->w0000 + 2)).w0000))) + si_175 * 0x04)) / (real64) ds->w01C2;
				*((char *) &&(ss->*(ss->*(&bp_136->w0000 + 2)).w0000) + si_175 * 0x04) = (word16 **) (real32) rLoc2_288;
				bcu8 bl_198 = (byte) bx_107;
				byte bh_257 = SLICE(bx_107, byte, 8);
				++bp_136;
				rLoc1_277 += rLoc2_288;
				cx_137 = cx_318 - 0x01;
				cx_318 = cx_137;
				bx_107 = bx_258;
			} while (cx_318 != 0x01);
			ds->w0200 = (int16) (rLoc1_277 * (real64) ds->w01C0);
			fn0C00_01B1(&ds->w0200, 0x02);
			bh_254 = SLICE(bx_106 - 0x01, byte, 8);
			cx_116 = cx_317 - 0x01;
			cx_317 = cx_116;
		} while (cx_317 != 0x01);
		++di_244;
		cx_246 = cx_316 - 0x01;
		cx_316 = cx_246;
	} while (cx_316 != 0x01);
}

// 0C00:01B1: Register byte fn0C00_01B1(Sequence (ptr32 char) ds_dx, Register word16 cx)
// Called from:
//      fn0C00_0100
byte fn0C00_01B1(char * ds_dx, word16 cx)
{
	struct Eq_191 * ds = SLICE(ds_dx, selector, 16);
	word16 bx_7 = ds->w0202;
	word16 ax_11;
	msdos_write_file(bx_7, cx, ds_dx, out ax_11);
	return SLICE(bx_7, byte, 8);
}

