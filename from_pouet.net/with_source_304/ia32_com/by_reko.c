// subject_code.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject_code.h"

// 0C00:0100: void fn0C00_0100(Register (ptr16 Eq_2) ds)
void fn0C00_0100(struct Eq_2 * ds)
{
	bios_video_set_mode(0x13);
	byte al_16 = 0x13;
	Eq_10 wLoc02_219 = 100;
	do
	{
		ds->w01C0 = 0x00;
		__syscall(22);
		if ((al_16 & 0x04) != 0x00)
			++ds->w01C0;
		if ((al_16 & 0x08) != 0x00)
			--ds->w01C0;
		do
			;
		while ((__inb(0x03DA) & 0x08) != 0x00);
		do
			;
		while ((__inb(0x03DA) & 0x08) == 0x00);
		Eq_42 bx_56 = ds->t01C2;
		fn0C00_01CA(wLoc02_219, 0x0300, bx_56, 0xA000, ds);
		Eq_10 bx_71 = ds->t01BE;
		byte al_73 = (byte) wLoc02_219;
		byte ah_75 = SLICE(wLoc02_219, byte, 8);
		byte bl_87 = (byte) bx_71;
		bl_87 = (byte) bx_71;
		byte bh_100 = SLICE(bx_71, byte, 8);
		bh_100 = SLICE(bx_71, byte, 8);
		if (bx_56 >= 0xE6)
		{
			Eq_10 ax_76 = SEQ(ah_75, al_73 - 0x05);
			if (ax_76 != bx_71)
			{
				if (ax_76 <= bx_71)
				{
					bl_87 = (byte) (bx_71 - 0x01);
					bh_100 = SLICE(bx_71 - 0x01, byte, 8);
				}
				else
				{
					bl_87 = (byte) ((word16) bx_71.u0 + 1);
					bh_100 = SLICE((word16) bx_71.u0 + 1, byte, 8);
				}
			}
		}
		Eq_10 bx_104 = SEQ(bh_100, fn0C00_01EE(bl_87));
		ds->t01BE = bx_104;
		Eq_10 ax_111 = (word16) wLoc02_219 + ds->w01C6;
		byte al_112 = (byte) ax_111;
		if (al_112 == 0x01)
			ds->w01C6 = -ds->w01C6;
		if (al_112 == 0xC6)
			ds->w01C6 = -ds->w01C6;
		Eq_42 cx_131 = (word16) ds->t01C2 + ds->w01C4;
		ds->t01C2 = cx_131;
		Eq_10 ax_141 = fn0C00_01FD(ax_111, cx_131, 0x013F, bx_104, ds);
		word16 bx_148 = (word16) ds->t01BC + ds->w01C0;
		Eq_10 bx_157 = SEQ(SLICE(bx_148, byte, 8), fn0C00_01EE((byte) bx_148));
		ds->t01BC = bx_157;
		Eq_10 ax_162 = fn0C00_01FD(ax_141, cx_131, 0x00, bx_157, ds);
		fn0C00_01CA(ax_162, 0x0F, ds->t01C2, 0xA000, ds);
		fn0C00_01DA(ds->t01BE, SEQ(SLICE((uint16) (uint8) fn0C00_01DA(ds->t01BC, 0x0F, 0x00, 0xA000, ds), byte, 8), 0x0F), 0x013F, 0xA000, ds);
		wLoc02_219 = ax_162;
		byte ah_215;
	} while (bios_kbd_check_keystroke(out al_16, out ah_215));
	msdos_terminate_program20();
}

// 0C00:01CA: void fn0C00_01CA(Register Eq_10 ax, Register Eq_48 dl, Register Eq_42 bx, Register (ptr16 Eq_50) es, Register (ptr16 Eq_2) ds)
// Called from:
//      fn0C00_0100
//      fn0C00_01DA
void fn0C00_01CA(Eq_10 ax, Eq_48 dl, Eq_42 bx, struct Eq_50 * es, struct Eq_2 * ds)
{
	es->*((word16) bx + (word16) (ds->w01C8 * ax)) = (byte) dx;
}

// 0C00:01DA: Register byte fn0C00_01DA(Register Eq_10 ax, Register Eq_48 dx, Register Eq_42 bx, Register (ptr16 Eq_50) es, Register (ptr16 Eq_2) ds)
// Called from:
//      fn0C00_0100
byte fn0C00_01DA(Eq_10 ax, Eq_48 dx, Eq_42 bx, struct Eq_50 * es, struct Eq_2 * ds)
{
	word16 cx_16;
	for (cx_16 = 0x0A; cx_16 != 0x00; --cx_16)
	{
		fn0C00_01CA(ax, dx, bx, es, ds);
		ax = (word16) ax + 1;
		byte dh_21 = SLICE(dx, byte, 8);
		byte al_27 = (byte) ax;
		byte ah_30 = SLICE(ax, byte, 8);
	}
	Eq_48 dx_22 = SEQ(dh_21, 0x00);
	fn0C00_01CA(ax, dx_22, bx, es, ds);
	fn0C00_01CA(SEQ(ah_30, al_27 - 11), dx_22, bx, es, ds);
	return dh_21;
}

// 0C00:01EE: Register byte fn0C00_01EE(Register byte bl)
// Called from:
//      fn0C00_0100
byte fn0C00_01EE(byte bl)
{
	if (bl == 0x00)
		bl = 0x01;
	if (bl == ~0x41)
		bl = ~0x42;
	return bl;
}

// 0C00:01FD: Register Eq_10 fn0C00_01FD(Register Eq_10 ax, Register Eq_42 cx, Register Eq_42 dx, Register Eq_10 bx, Register (ptr16 Eq_2) ds)
// Called from:
//      fn0C00_0100
Eq_10 fn0C00_01FD(Eq_10 ax, Eq_42 cx, Eq_42 dx, Eq_10 bx, struct Eq_2 * ds)
{
	byte al_18 = (byte) ax;
	al_18 = (byte) ax;
	byte ah_22 = SLICE(ax, byte, 8);
	ah_22 = SLICE(ax, byte, 8);
	byte bl_12 = (byte) bx;
	byte bh_14 = SLICE(bx, byte, 8);
	if (cx != dx)
		return ax;
	if (ax < bx || ax >= SEQ(bh_14, bl_12 + 0x0A))
	{
		ds->t01C2.u0 = 0xA0;
		ax = (SEQ(ah_22, al_18 + 0x61) & 0x7F) + 0x24;
		return ax;
	}
	else
	{
		ds->w01C4 = -ds->w01C4;
		return ax;
	}
}

