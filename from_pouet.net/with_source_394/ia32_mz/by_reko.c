// subject.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

// 1676:0061: void fn1676_0061(Register byte al)
void fn1676_0061(byte al)
{
	bios_video_set_mode(0x13);
}

// 1676:0068: Register byte fn1676_0068(Register byte al)
byte fn1676_0068(byte al)
{
	bios_video_set_mode(0x03);
	return 0x03;
}

// 1676:006F: void fn1676_006F()
void fn1676_006F()
{
	bios_video_set_block_of_DAC_registers(0x00, 0xFF, seg0800, 0xD5C0);
}

// 1676:0084: Register (ptr16 Eq_2) fn1676_0084()
Eq_2 * fn1676_0084()
{
	byte Eq_2::* si_10 = Eq_2::a08C0;
	byte Eq_36::* di_11 = Eq_36::a3200;
	word16 cx_12 = 0x9100;
	while (cx_12 != 0x00)
	{
		0xA000->*di_11 = seg0800->*si_10;
		si_10 = si_10 + 0x01;
		di_11 = di_11 + 0x01;
		cx_12 = cx_12 - 0x01;
	}
	return seg0800;
}

// 1676:009B: Register (ptr16 Eq_2) fn1676_009B()
Eq_2 * fn1676_009B()
{
	byte Eq_2::* bx_12 = seg0800->wDB62 + 0x08C0 + (word16) ((seg0800->wDB64 - 0x28) * 0x0140);
	byte Eq_36::* bx_21 = seg0800->wDB62 + (word16) (seg0800->wDB64 * 0x0140);
	seg0800->ptrDB6C = bx_12;
	seg0800->ptrDB6E = bx_21;
	seg0800->wDB5E = 0x00;
	byte Eq_2::* si_13 = bx_12;
	byte Eq_36::* di_23 = bx_21;
	do
	{
		word16 cx_35 = 0x39;
		while (cx_35 != 0x00)
		{
			0xA000->*di_23 = seg0800->*si_13;
			si_13 = si_13 + 0x01;
			di_23 = di_23 + 0x01;
			cx_35 = cx_35 - 0x01;
		}
		seg0800->wDB5E = seg0800->wDB5E + 0x01;
		word16 ax_49 = (word16) (seg0800->wDB5E * 0x0140);
		si_13 = seg0800->ptrDB6C + ax_49;
		di_23 = seg0800->ptrDB6E + ax_49;
	} while (seg0800->wDB5E != 0x06);
	seg0800->wDB5E = 0x00;
	return seg0800;
}

// 1676:0104: void fn1676_0104()
void fn1676_0104()
{
	byte Eq_36::* bx_13 = seg0800->wDB62 + (word16) (seg0800->wDB64 * 0x0140);
	seg0800->ptrDB6C = &Eq_2::b0000;
	seg0800->ptrDB6E = bx_13;
	seg0800->wDB5E = 0x00;
	byte Eq_2::* si_27 = &Eq_2::b0000;
	byte Eq_36::* di_15 = bx_13;
	do
	{
		word16 cx_31 = 0x39;
		do
		{
			byte al_38 = seg0800->*si_27;
			if (al_38 != 0x00)
				0xA000->*di_15 = al_38;
			si_27 = si_27 + 0x01;
			di_15 = di_15 + 0x01;
			cx_31 = cx_31 - 0x01;
		} while (cx_31 != 0x00);
		seg0800->wDB5E = seg0800->wDB5E + 0x01;
		word16 ax_52 = (word16) (seg0800->wDB5E * 0x0140);
		si_27 = seg0800->ptrDB6C + ax_52;
		di_15 = seg0800->ptrDB6E + ax_52;
	} while (seg0800->wDB5E != 0x06);
	seg0800->wDB5E = 0x00;
}

// 1676:0165: Register (ptr16 Eq_2) fn1676_0165()
Eq_2 * fn1676_0165()
{
	byte Eq_36::* di_21 = &Eq_36::bFFFFD840;
	byte Eq_36::* si_20 = &Eq_36::bFFFFD842;
	byte ah_11 = 0x08;
	do
	{
		word16 cx_22 = 0x013E;
		while (cx_22 != 0x00)
		{
			0xA000->*di_21 = 0xA000->*si_20;
			si_20 = si_20 + 0x01;
			di_21 = di_21 + 0x01;
			cx_22 = cx_22 - 0x01;
		}
		di_21 = di_21 + 0x02;
		si_20 = si_20 + 0x02;
		ah_11 = ah_11 - 0x01;
	} while (ah_11 != 0x00);
	return fn1676_0186();
}

// 1676:0186: Register (ptr16 Eq_2) fn1676_0186()
Eq_2 * fn1676_0186()
{
	word16 ax_7 = (seg0800->*seg0800->ptrDB6A).wE055;
	byte al_10 = (byte) ax_7;
	if (al_10 == 0x00)
		return fn1676_0198(seg0800);
	word16 bx_100;
	if (al_10 == 0x20)
		bx_100 = 0x0A00;
	else if (al_10 == 0x30)
		bx_100 = 0xD0;
	else if (al_10 == 0x31)
		bx_100 = 0xD8;
	else if (al_10 == 0x32)
		bx_100 = 0xE0;
	else if (al_10 == 0x33)
		bx_100 = 232;
	else if (al_10 == 0x34)
		bx_100 = 0xF0;
	else if (al_10 == 0x35)
		bx_100 = 0xF8;
	else if (al_10 == 0x36)
		bx_100 = 0x0100;
	else if (al_10 == 55)
		bx_100 = 0x0108;
	else if (al_10 == 0x38)
		bx_100 = 0x0110;
	else if (al_10 == 0x39)
		bx_100 = 0x0118;
	else if (al_10 == 0x3F)
		bx_100 = 288;
	else if (al_10 == 33)
		bx_100 = 0x0128;
	else if (al_10 == 0x2E)
		bx_100 = 0x0130;
	else if (al_10 == 44)
		bx_100 = 0x0138;
	else
		bx_100 = (word16) (DPB(ax_7 - 0x41, 0x00, 8) * 0x08);
	struct Eq_232 Eq_2::* si_43 = seg0800->wDB60 + 0x99C0 + bx_100;
	struct Eq_238 Eq_36::* di_47 = &Eq_36::tFFFFD97E;
	byte al_48 = 0x00;
	si_56 = si_43;
	while (true)
	{
		struct Eq_232 Eq_2::* si_56;
		byte ah_61 = 0x08;
		do
		{
			(0xA000->*di_47).b0000 = (seg0800->*si_56).b0000;
			si_56 = si_56 + 0x01;
			di_47 = di_47 + 0x01;
			ah_61 = ah_61 - 0x01;
		} while (ah_61 != 0x00);
		di_47 = &Eq_36::tFFFFD97F;
		if (al_48 == 0x01)
			break;
		fn1676_0287();
		si_56 = &si_43->b0000 + 0x01;
		al_48 = al_48 + 0x01;
	}
	fn1676_0287();
	return seg0800;
}

// 1676:0198: Register (ptr16 Eq_2) fn1676_0198(Register (ptr16 Eq_2) ds)
Eq_2 * fn1676_0198(Eq_2 * ds)
{
	sp = fp;
	ds->wDB60 = 0x00;
	ds->ptrDB6A = &Eq_2::b0000;
	ds = fn1676_0186();
	return ds;
}

// 1676:0287: void fn1676_0287()
void fn1676_0287()
{
}

// 1676:029E: void fn1676_029E(Register (ptr16 Eq_334) ds)
void fn1676_029E(Eq_334 * ds)
{
	while (true)
	{
		while (ds->bDB5D != 0x01)
		{
			__outb(0x03C8, ~0x01);
			byte al_18 = ds->bDB5C;
			__outb(969, al_18);
			__outb(969, al_18);
			__outb(969, al_18);
			if (ds->bDB5C != 0x3F)
			{
				ds->bDB5C = ds->bDB5C + 0x01;
				return;
			}
			ds->bDB5D = 0x01;
		}
		__outb(0x03C8, ~0x01);
		byte al_28 = ds->bDB5C;
		__outb(969, al_28);
		__outb(969, al_28);
		__outb(969, al_28);
		if (ds->bDB5C != 0x0F)
			break;
		ds->bDB5D = 0x00;
	}
	ds->bDB5C = ds->bDB5C - 0x01;
}

// 1676:02E7: void fn1676_02E7()
void fn1676_02E7()
{
	seg0800->wDB64 = (seg0800->*seg0800->ptrDB68).wD8C0 + 100;
	seg0800->wDB62 = (seg0800->*seg0800->ptrDB66).wD920 + 0x44;
	if (seg0800->ptrDB68 == &Eq_2::t005E)
		seg0800->ptrDB68 = &Eq_2::b0000;
	else
	{
		seg0800->ptrDB68 = (struct Eq_399 Eq_2::*) ((char *) seg0800->ptrDB68 + 0x01);
		seg0800->ptrDB68 = (struct Eq_399 Eq_2::*) ((char *) seg0800->ptrDB68 + 0x01);
	}
	if (seg0800->ptrDB66 != &Eq_2::t00FE)
	{
		seg0800->ptrDB66 = (struct Eq_408 Eq_2::*) ((char *) seg0800->ptrDB66 + 0x01);
		seg0800->ptrDB66 = (struct Eq_408 Eq_2::*) ((char *) seg0800->ptrDB66 + 0x01);
		seg0800->wDB72 = 0x00;
	}
	else
		seg0800->ptrDB66 = &Eq_2::b0000;
}

// 1676:0340: void fn1676_0340(Register byte al)
void fn1676_0340(byte al)
{
	fn1676_0061(al);
	fn1676_006F();
	fn1676_0198(fn1676_0084());
	seg0800->ptrDB66 = &Eq_2::b0000;
	seg0800->ptrDB68 = &Eq_2::b0000;
	__outb(0x03C8, ~0x01);
	__outb(969, 0x00);
	__outb(969, 0x00);
	__outb(969, 0x00);
}

// 1676:0365: Register byte fn1676_0365()
byte fn1676_0365()
{
	do
	{
		byte al_3 = __inb(0x03DA);
	} while ((al_3 & 0x08) == 0x00);
	return al_3;
}

// 1676:036E: void fn1676_036E(Register (ptr16 Eq_498) ds)
void fn1676_036E(Eq_498 * ds)
{
	__outb(0x03C8, ~0x02);
	byte al_8 = ds->bDB7C;
	__outb(969, al_8);
	__outb(969, al_8);
	__outb(969, al_8);
}

// 1676:037C: Register (ptr16 Eq_498) fn1676_037C(Register (ptr16 Eq_498) ds)
Eq_498 * fn1676_037C(Eq_498 * ds)
{
	if (ds->bDB77 == 0x01)
	{
		if (ds->bDB7C == 0x00)
			return fn1676_03BF();
		fn1676_036E(ds);
		ds->bDB7C = ds->bDB7C - 0x01;
		return ds;
	}
	else if (ds->bDB7C == 0x3F)
	{
		if (ds->bDB76 == ~0x00)
		{
			ds->bDB77 = 0x01;
			ds->bDB76 = 0x00;
			return ds;
		}
		else
		{
			ds->bDB76 = ds->bDB76 + 0x01;
			return ds;
		}
	}
	else
	{
		ds->bDB7C = ds->bDB7C + 0x01;
		fn1676_036E(ds);
		return ds;
	}
}

// 1676:03BF: Register (ptr16 Eq_2) fn1676_03BF()
Eq_2 * fn1676_03BF()
{
	word16 bx_15;
	word16 ax_7 = seg0800->*((word16) seg0800->tDB78 + 0x0000DB7D);
	if ((byte) ax_7 == 0x20)
		bx_15 = 0x1400;
	else
		bx_15 = DPB(ax_7 - 0x01, 0x00, 8);
	byte Eq_2::* si_20 = bx_15 + 44480;
	byte Eq_36::* di_30 = (word16) (DPB(0xA000, seg0800->bDB7B, 0) * 0x08) + 0x0F00;
	word16 dx_32 = 0x10;
	do
	{
		word16 cx_41 = 0x08;
		while (cx_41 != 0x00)
		{
			0xA000->*di_30 = seg0800->*si_20;
			si_20 = si_20 + 0x01;
			di_30 = di_30 + 0x01;
			cx_41 = cx_41 - 0x01;
		}
		si_20 = si_20 + 0x0138;
		di_30 = di_30 + 0x0138;
		dx_32 = dx_32 - 0x01;
	} while (dx_32 != 0x00);
	if (seg0800->bDB7B == 0x27)
	{
		seg0800->bDB7B = 0x00;
		seg0800->bDB77 = 0x00;
		if (seg0800->tDB78 > 0x04B0)
		{
			seg0800->tDB78.u0 = 0x00;
			return seg0800;
		}
		else
		{
			seg0800->tDB78 = (word16) seg0800->tDB78 + 0x01;
			return seg0800;
		}
	}
	else
	{
		seg0800->bDB7B = seg0800->bDB7B + 0x01;
		seg0800->tDB78 = (word16) seg0800->tDB78 + 0x01;
		return seg0800;
	}
}

// 1676:0442: void fn1676_0442(Register byte al, Register (ptr16 Eq_649) es)
void fn1676_0442(byte al, Eq_649 * es)
{
	word16 bx_5;
	msdos_resize_memory_block(es, 0x186A, out bx_5);
	fn1676_0068(0x00);
	word16 cx_11 = 100;
	do
	{
		byte al_14 = fn1676_0365();
		cx_11 = cx_11 - 0x01;
	} while (cx_11 != 0x00);
	fn1676_0340(fn1676_0068(al_14));
	__outb(33, 0x5E);
	do
	{
		fn1676_02E7();
		fn1676_0104();
		fn1676_0365();
		fn1676_029E(fn1676_037C(fn1676_0165()));
		struct Eq_702 * ds_32 = fn1676_009B();
	} while (__inb(0x60) != 0x01);
	__outb(33, 0x00);
	fn1676_0068(0x00);
	msdos_display_string((char *) ds_32 - 6476);
	msdos_terminate(0x00);
}

