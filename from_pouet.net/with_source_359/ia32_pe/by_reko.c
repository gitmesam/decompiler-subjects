// subject.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

// 00401000: void fn00401000()
void fn00401000()
{
	Eq_2 edx_16 = globals->t4020DA;
	bcu8 bl_17 = 0x00;
	do
	{
		*edx_16 = bl_17 >> 0x01;
		struct Eq_12 * edx_11 = (word32) edx_16 + 0x01;
		edx_11->b0000 = bl_17;
		edx_11->b0001 = bl_17;
		edx_16 = &edx_11->b0001 + 0x02;
		bl_17 = bl_17 + 0x01;
	} while (bl_17 != 0x00);
}

// 0040101B: FpuStack real64 fn0040101B(FpuStack out Eq_28 rLoc1Out)
real64 fn0040101B(Eq_28 & rLoc1Out)
{
}

// 0040114A: FpuStack real64 fn0040114A(FpuStack real64 rArg0, FpuStack real64 rArg1, FpuStack real64 rArg2, FpuStack real64 rArg3)
real64 fn0040114A(real64 rArg0, real64 rArg1, real64 rArg2, real64 rArg3)
{
	return rArg1 * rArg2 - rArg0 * rArg3;
}

// 0040115F: FlagGroup bool fn0040115F(Register byte ah, Register cui16 cx, Register word16 bp, Register word16 di, Register out Eq_131 dlOut, Register out Eq_132 dhOut)
bool fn0040115F(byte ah, cui16 cx, word16 bp, word16 di, Eq_131 & dlOut, Eq_132 & dhOut)
{
	cui16 dx_15 = DPB(di, SLICE(di, byte, 8) + ah, 8) & DPB(bp, SLICE(bp, byte, 8) + ah, 8) & cx;
	byte dl_17;
	*dlOut = (byte) dx_15;
	byte dh_18;
	*dhOut = SLICE(dx_15, byte, 8) & ah;
	return false;
}

// 00401172: Register Eq_238 Win32CrtStartup()
DWORD Win32CrtStartup()
{
	ptr32 esp_182;
	ptr32 esp_128 = fp - 0x08;
	Eq_2 eax_6 = GlobalAlloc(0x00, 500000);
	if (eax_6 != 0x00)
	{
		globals->t4020E2 = eax_6;
		globals->t4020DA = eax_6;
		Mem111[0x004020D6:word32] = eax_6 + 2000;
		globals->t40208A = GetModuleHandleW(null);
		globals->t40208E = LoadIconW(0x00, (WCHAR *) 0x7F00);
		Eq_368 eax_126 = LoadCursorW(0x00, (WCHAR *) 0x7F00);
		globals->t402092 = eax_126;
		esp_128 = fp - 0x20;
		if (DPB(eax_126, RegisterClassW(&globals->t40207A), 0) != null)
		{
			esp_128 = fp - 0x50;
			Eq_218 eax_159 = CreateWindowExW(0x00, &globals->t402000, &globals->t402012, 0x10CF0000, 0x8000, 0x8000, 0x0280, 500, null, null, globals->t40208A, null);
			if (eax_159 != null)
			{
				globals->t4020A2 = eax_159;
				globals->t4020A6 = GetDC(eax_159);
				fn00401000();
				real64 rLoc1_168;
				fn0040101B(out rLoc1_168);
				ptr32 esp_164 = fp - 0x54;
				while (true)
				{
					UINT * esp_174 = esp_164 - 0x04;
					*esp_174 = (uint32) 0x01;
					*(esp_174 - 0x04) = 0x00;
					*(esp_174 - 0x08) = 0x00;
					*(esp_174 - 0x0C) = 0x00;
					*(esp_174 - 0x10) = 0x004020AA;
					PeekMessageW(*(esp_174 - 0x10), *(esp_174 - 0x0C), *(esp_174 - 0x08), *(esp_174 - 0x04), *esp_174);
					esp_182 = esp_174 - 0x10;
					if (globals->dw4020AE == 0x12)
						break;
					*(esp_174 - 0x14) = 0x004020AA;
					TranslateMessage(*(esp_174 - 0x14));
					*(esp_174 - 0x18) = 0x004020AA;
					DispatchMessageW(*(esp_174 - 0x18));
					real64 rLoc3_193;
					fn0040101B(out rLoc3_193);
					globals->dw4020DE = globals->dw4020DE + 0x01;
					esp_164 = esp_174 - 0x18;
				}
l00401285:
				HDC * esp_58 = esp_182 - 0x04;
				*esp_58 = (HDC *) globals->t4020A6;
				*(esp_58 - 0x04) = (HWND *) globals->t4020A2;
				ReleaseDC(*(esp_58 - 0x04), *esp_58);
				*(esp_58 - 0x08) = (union Eq_2 *) globals->t4020E2;
				GlobalFree(*(esp_58 - 0x08));
				*(esp_58 - 0x0C) = globals->dw4020B2;
				ExitProcess(*(esp_58 - 0x0C));
			}
		}
	}
	UINT * esp_93 = esp_128 - 0x04;
	*esp_93 = (uint32) 0x10;
	*(esp_93 - 0x04) = 0x00;
	*(esp_93 - 0x08) = 0x00402022;
	*(esp_93 - 0x0C) = 0x00;
	MessageBoxW(*(esp_93 - 0x0C), *(esp_93 - 0x08), *(esp_93 - 0x04), *esp_93);
	esp_182 = esp_93 - 0x0C;
	goto l00401285;
}

