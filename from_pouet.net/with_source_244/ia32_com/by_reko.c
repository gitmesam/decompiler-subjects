// subject_code.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject_code.h"

// 0C00:0100: void fn0C00_0100(Register word16 cx, Register byte bl, Register (ptr16 Eq_4) ds)
void fn0C00_0100(word16 cx, byte bl, struct Eq_4 * ds)
{
	bios_video_set_mode(0x13);
	do
		--cx;
	while (cx != 0x00);
	do
	{
		uint8 cl_10 = (byte) cx_367;
		__outb(0x03C8, cl_10);
		__outb(969, cl_10 >> 0x01);
		uint16 ax_14 = (cl_10 >> 0x01) * (cl_10 >> 0x01);
		uint8 al_17 = (byte) (ax_14 >> 0x07);
		__outb(969, al_17);
		__outb(969, al_17 * 0x02 + (ax_14 >> 0x07 < 0x00));
		int8 ah_215 = SLICE(ax_14 >> 0x07, byte, 8);
		byte ch_250 = SLICE(cx_367 - 0x01, byte, 8);
		cx = cx_367 - 0x01;
		cx_367 = cx;
	} while (cx_367 != 0x01);
	do
	{
		word16 Eq_4::* si_162 = &Eq_4::w01FE;
		byte Eq_4::* bx_262;
		do
		{
			ds->*bx_262 = ch_250;
			++bx_262;
		} while (bx_262 != &Eq_4::b0000);
		do
		{
			int32 dx_ax_48 = (int32) SEQ(ah_215, ds->b013F);
			ci8 bl_158 = 226;
			uint16 dx_151 = SLICE(dx_ax_48, word16, 16);
			uint8 ch_268 = 0x0C;
			int16 di_142 = (byte) dx_ax_48 *s 226;
			do
			{
				int16 bx_55 = (int16) bl_158;
				uint16 dx_60 = dx_151 - bx_55 - bx_55;
				bcu8 ch_66 = __xadd(ch_268, (uint8) (dx_60 /u ch_268));
				Eq_86 bh_100 = -(ch_66 >> 0x01);
				int16 di_59 = di_142 + ~0x09;
				uint8 cl_109 = 0x0C;
				byte bl_299 = (byte) bx_55;
				uint16 si_102 = 0x00;
				int16 di_104 = di_59 + bh_100 *s ds->b0160;
				do
				{
					int16 dx_101 = (int16) bh_365;
					si_102 = si_102 - dx_101 - dx_101;
					bcu8 cl_112 = __xadd(cl_109, (uint8) (si_102 /u cl_109));
					di_104 += 0x19;
					int16 ax_118 = (cl_112 >> 0x01) *s ds->b018E + di_104;
					cl_109 = cl_112 >> 0x01;
					byte ah_122 = SLICE(ax_118 << 0x03, byte, 8);
					struct Eq_82 Eq_4::* bx_130 = SEQ(bh_365, bl_299);
					if (ax_118 << 0x03 < 0x00)
						ah_122 &= cl_112 >> 0x01;
					(ds->*bx_130).b9660 = ah_122;
					bh_100 = (byte) bh_365 + 1;
					bh_365 = bh_100;
				} while ((byte) bh_365 + 1 < ch_66 >> 0x01);
				di_142 = di_59;
				dx_151 = dx_60;
				ch_268 = ch_66 >> 0x01;
				bl_158 = (byte) (bx_55 + 0x01);
			} while (bl_158 < 0x1E);
			word16 ax_161 = ds->*si_366;
			ds->w017C = ax_161 + -25;
			si_162 = si_366 + 1;
			ah_215 = SLICE(ax_161 + -25, byte, 8);
			si_366 = si_162;
		} while (si_366 != &Eq_4::w01EA);
		do
			;
		while ((__inb(0x03DA) & 0x08) == 0x00);
		Eq_182 di_180;
		word16 Eq_4::* si_181 = &Eq_4::wFFFFF9E0;
		do
		{
			word16 cx_182 = 0x80;
			while (true)
			{
				ch_250 = SLICE(cx_182, byte, 8);
				if (cx_182 == 0x00)
					break;
				0xA000->*di_180 = ds->*si_181;
				++si_181;
				di_180 = (word16) di_180 + 2;
				--cx_182;
			}
			di_180 -= 0x40;
		} while (di_180 >= 0x00);
		bci8 ah_193 = ds->b013F;
		ds->b013F = (byte) (SEQ(0x03, ah_193) - SEQ(ah_193 >> 0x02, fn0C00_01E7(&ds->b018E, ah_193 >> 0x02, 0x05)));
		bi8 ah_214 = ds->b0160;
		ds->b0160 -= fn0C00_01E7((char *) &ds->w017C + 0x0011, ah_214 >> 0x05, 0x05);
		bl = 141;
		ah_215 = ah_214 >> 0x05;
	} while (__inb(0x60) != 0x01);
	bios_video_set_mode(0x03);
	fn0C00_01E7((char *) &ds->w017C + 0x0011, 0x00, 0x05);
}

// 0C00:01E7: Register int8 fn0C00_01E7(Sequence (ptr32 bci8) ds_bx, Register int8 ah, Register byte cl)
// Called from:
//      fn0C00_0100
int8 fn0C00_01E7(bci8 * ds_bx, int8 ah, byte cl)
{
	*ds_bx += ah;
	return *ds_bx >> cl;
}

