// subject.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

// 00401000: void fn00401000()
void fn00401000()
{
	Eq_2 edx_20 = globals->t402104;
	Eq_5 bl_21 = 0x00;
	do
	{
		if (bl_21 >= 0x80)
			*edx_20 = bl_21 << 0x01;
		struct Eq_7 * edx_15 = (word32) edx_20 + 0x01;
		edx_15->t0000 = bl_21 << 0x01;
		edx_15->t0001 = bl_21 << 0x01;
		edx_20 = (char *) &edx_15->t0001 + 0x02;
		bl_21 = (word32) bl_21 + 0x01;
	} while (bl_21 != 0x00);
}

// 00401020: void fn00401020()
void fn00401020()
{
	Eq_31 edi_32 = globals->t402124;
	byte ch_33 = 0x02;
	word16 cx_36 = DPB(cx, 0x02, 8);
	do
	{
		*edi_32 = ((word32) (((word16) ch_33 << 0x06) + cx_36))->b402146;
		cx_36 = cx_36 + 0x01;
		edi_32 = (word32) edi_32 + 0x01;
		ch_33 = SLICE(cx_36, byte, 8);
	} while (cx_36 != 0x0B00);
}

// 00401052: void fn00401052(FpuStack real64 rArg0)
void fn00401052(real64 rArg0)
{
}

// 00401230: Register Eq_310 Win32CrtStartup()
DWORD Win32CrtStartup()
{
	ptr32 esp_106;
	ptr32 esp_147 = fp - 0x08;
	Eq_2 eax_6 = GlobalAlloc(0x00, 1000000);
	if (eax_6 != 0x00)
	{
		globals->t40210C = eax_6;
		globals->t402104 = eax_6;
		Mem113[0x00402100:word32] = eax_6 + 2000;
		Mem115[0x0040211C:word32] = eax_6 + 402000;
		Mem117[0x00402120:word32] = eax_6 + 602000;
		Mem120[0x00402124:word32] = eax_6 + 702000;
		word32 ebx_121 = 499999;
		do
		{
			*globals->t40210C = 0x00;
			ebx_121 = ebx_121 - 0x01;
		} while (ebx_121 != 0x00);
		globals->t4020B4 = GetModuleHandleW(null);
		globals->t4020B8 = LoadIconW(0x00, (WCHAR *) 0x7F00);
		Eq_464 eax_145 = LoadCursorW(0x00, (WCHAR *) 0x7F00);
		globals->t4020BC = eax_145;
		esp_147 = fp - 0x20;
		if (DPB(eax_145, RegisterClassW(&globals->t4020A4), 0) != null)
		{
			esp_147 = fp - 0x50;
			Eq_290 eax_178 = CreateWindowExW(0x00, &globals->t402000, &globals->t402012, 0x10CF0000, 0x8000, 0x8000, 0x021C, 400, null, null, globals->t4020B4, null);
			if (eax_178 != null)
			{
				globals->t4020CC = eax_178;
				globals->t4020D0 = GetDC(eax_178);
				fn00401000();
				fn00401020();
				fn00401052(rArg0);
				*(fp - 88) = 0x04;
				*(fp - 0x5C) = (HDC *) globals->t4020D0;
				SetStretchBltMode(*(fp - 0x5C), *(fp - 88));
				ptr32 esp_192 = fp - 0x5C;
				while (true)
				{
					UINT * esp_197 = esp_192 - 0x04;
					*esp_197 = (uint32) 0x01;
					*(esp_197 - 0x04) = 0x00;
					*(esp_197 - 0x08) = 0x00;
					*(esp_197 - 0x0C) = 0x00;
					*(esp_197 - 0x10) = 0x004020D4;
					PeekMessageW(*(esp_197 - 0x10), *(esp_197 - 0x0C), *(esp_197 - 0x08), *(esp_197 - 0x04), *esp_197);
					esp_106 = esp_197 - 0x10;
					if (globals->dw4020D8 == 0x12)
						break;
					*(esp_197 - 0x14) = 0x004020D4;
					TranslateMessage(*(esp_197 - 0x14));
					*(esp_197 - 0x18) = 0x004020D4;
					DispatchMessageW(*(esp_197 - 0x18));
					fn00401052(rArg1);
					globals->dw402108 = globals->dw402108 + 0x01;
					esp_192 = esp_197 - 0x18;
				}
l0040138C:
				HDC * esp_61 = esp_106 - 0x04;
				*esp_61 = (HDC *) globals->t4020D0;
				*(esp_61 - 0x04) = (HWND *) globals->t4020CC;
				ReleaseDC(*(esp_61 - 0x04), *esp_61);
				*(esp_61 - 0x08) = (union Eq_2 *) globals->t40210C;
				GlobalFree(*(esp_61 - 0x08));
				*(esp_61 - 0x0C) = globals->dw4020DC;
				ExitProcess(*(esp_61 - 0x0C));
			}
		}
	}
	UINT * esp_100 = esp_147 - 0x04;
	*esp_100 = (uint32) 0x10;
	*(esp_100 - 0x04) = 0x00;
	*(esp_100 - 0x08) = 0x0040204C;
	*(esp_100 - 0x0C) = 0x00;
	MessageBoxW(*(esp_100 - 0x0C), *(esp_100 - 0x08), *(esp_100 - 0x04), *esp_100);
	esp_106 = esp_100 - 0x0C;
	goto l0040138C;
}

