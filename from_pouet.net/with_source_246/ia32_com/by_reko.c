// subject_code.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject_code.h"

// 0C00:0100: void fn0C00_0100(Register byte bl, Register byte bh, Register (ptr16 Eq_4) ds)
void fn0C00_0100(byte bl, byte bh, struct Eq_4 * ds)
{
	word16 cx_139 = SEQ(SLICE((uint16) fn0C00_0196(&Eq_99::t01B0, ds), byte, 8), 0x06);
	do
	{
		msdos_display_string(&ds->b01EF);
		--cx_139;
	} while (cx_139 != 0x00);
	byte Eq_28::* di_21 = Eq_28::aFFFFA000;
	do
	{
		0xA000->*di_21 <<= 0x01;
		++di_21;
	} while (di_21 != &Eq_28::b0000);
	byte al_50 = bl + 0x01 & ~0x10;
	byte al_59 = al_50 & 0x0F & 0x03;
	byte ah_55 = bh;
	byte cl_58 = ds->*((word16) (SEQ(bh, bl + 0x01) >> 0x05) + 479) + (ds->*SEQ(bh, al_50 & 0x0F)).b01DF;
	word16 ax_62 = SEQ(bh, al_59);
	if (al_59 == 0x03)
	{
		al_59 = (byte) (ax_62 - 0x01);
		ah_55 = SLICE(ax_62 - 0x01, byte, 8);
	}
	uint16 ax_80 = (uint16) cl_58;
	uint8 ah_82 = (uint8) (ax_80 % 0x0C);
	byte al_67 = al_59 + 0xA0;
	word16 bx_95 = SEQ(bh, ah_82);
	0C00:01B0();
	0C00:01B0();
	0C00:01B0();
	__hlt();
}

// 0C00:0196: Register byte fn0C00_0196(Register (memptr (ptr16 Eq_99) code) bp, Register (ptr16 Eq_4) ds)
// Called from:
//      fn0C00_0100
byte fn0C00_0196(<anonymous> Eq_99::* bp, struct Eq_4 * ds)
{
	__syscall(0x10);
	do
	{
		word16 ax_9;
		(0x0C00->*bp)();
	} while (ax_9 != 0x01);
	word16 si_16 = 0x01D1;
	do
	{
		word16 ax_27;
		(0x0C00->*bp)();
		word16 ax_34;
		(0x0C00->*bp)();
		word16 cx_42;
		(0x0C00->*bp)();
		si_16 += 2;
	} while (cx_42 != 0x01);
	return SLICE(cx_42 - 0x01, byte, 8);
}

// 0C00:01B0: void fn0C00_01B0(Register word16 ax)
// Called from:
//      fn0C00_0100
void fn0C00_01B0(word16 ax)
{
	byte al_30 = (byte) ax;
	byte ah_50 = SLICE(ax, byte, 8);
	__outb(0x0388, al_30);
	__outb(0x0389, ah_50);
	word16 cx_55;
	for (cx_55 = 0x0388; cx_55 != 0x00; --cx_55)
		__inb(0x0388);
}

