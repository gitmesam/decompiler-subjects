// subject_code.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject_code.h"

// 0C00:0100: void fn0C00_0100(Register Eq_2 si, Register (ptr16 Eq_3) ds)
void fn0C00_0100(Eq_2 si, struct Eq_3 * ds)
{
	__syscall(0x10);
	__outw(0x03D4, 8211);
	struct Eq_16 Eq_3::* bx_10 = &Eq_3::t0000;
	do
	{
		bx_228 = SEQ(bh_227, bl_20 + 0x01);
		int8 al_14 = (byte) bx_10 >> 0x03 << 0x05;
		(ds->*bx_10).b0400 = SLICE(al_14 *s al_14, byte, 8);
		byte bl_20 = (byte) bx_10;
		byte bh_227 = SLICE(bx_10, byte, 8);
		bx_10 = bx_228;
	} while (bl_20 != 0x01);
	struct Eq_39 Eq_119::* bx_298 = SEQ(bh_227, bl_20 + 0x01);
	do
	{
		int16 ax_36 = fn0C00_01EA(si);
		int16 ax_48 = fn0C00_01EA((word16) si + 64);
		struct Eq_39 Eq_119::* bx_295 = bx_298;
		do
		{
			int16 ax_59 = (int16) (byte) bx_301;
			ds->w01A2 = ((word16) (ax_48 *s ax_59) >> 0x07) + ax_36 << 0x01;
			int16 ax_84 = (int16) (SLICE(bx_301, byte, 8) - 100);
			int16 ax_79 = -((word16) (ax_36 *s ax_59) >> 0x07) + ax_48;
			ds->w019E = ((word16) (ax_36 *s ax_79) >> 0x07) + ((word16) (ax_48 *s ax_84) >> 0x07) << 0x01;
			Eq_43 dx_290 = ax_48 *s ax_79;
			ds->w01A6 = ((word16) dx_290 >> 0x07) + -((word16) (ax_36 *s ax_84) >> 0x07) << 0x01;
			cu16 bp_128 = 0x00;
			cu16 di_131;
			ui16 cx_292 = si << 0x09;
			for (di_131 = 0x0200; di_131 != 0x00; --di_131)
			{
				Eq_43 dx_284 = dx_290;
				ui16 cx_287 = cx_292;
				if (ds->*(bp_128 >> 0x08) + ds->*SEQ(0x04, SLICE(cx_292, byte, 8)) + ds->*SEQ(0x04, SLICE(dx_290, byte, 8)) > 101)
					break;
				bp_128 += ~0x00;
				dx_284.u1 = (word16) dx_290 + 0x0000FFFF;
				cx_287 = cx_292 + ~0x00;
				dx_290.u1 = (word16) dx_290 + 0x0000FFFF;
				cx_292 += ~0x00;
			}
			byte dh_161 = SLICE(dx_284, byte, 8);
			byte ch_172 = SLICE(cx_287, byte, 8);
			Eq_48 ax_177 = (ch_172 << 0x03) *s (ch_172 << 0x03) + (dh_161 << 0x03) *s (dh_161 << 0x03);
			ci16 ax_186 = SEQ(SLICE(ax_177 >> 0x07, byte, 8), ~(byte) (ax_177 >> 0x07)) - 0xFF + (di_131 >> 0x01);
			bcu8 al_192 = (byte) ax_186;
			if (ax_186 < 0x00)
				al_192 = 0x00;
			uint8 al_195 = al_192 >> 0x04;
			(0xA000->*bx_301).wFFFFFFA0 = SEQ(al_195 + 0x10, al_195 + 0x10);
			bx_295 = &bx_301->wFFFFFFA0 + 49;
			bx_301 = bx_295;
		} while (bx_301 != &Eq_119::t0002);
		si = (word16) si + 1;
		bx_298 = &bx_301->wFFFFFFA0 + 49;
	} while (__inb(0x60) != 0x01);
}

// 0C00:01EA: Register int16 fn0C00_01EA(Register Eq_2 sil)
// Called from:
//      fn0C00_0100
int16 fn0C00_01EA(Eq_2 sil)
{
	bi8 al_12 = (byte) (si << 0x01);
	return (al_12 *s al_12 ^ SLICE((int32) ((int16) ((byte) (si + 0x40))), word16, 16)) >> 0x07;
}

