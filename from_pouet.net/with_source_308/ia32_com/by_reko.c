// subject_code.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject_code.h"

// 0C00:0100: void fn0C00_0100(Sequence (ptr32 Eq_2) ds_bx, Register word16 cx, Register byte dh, Register byte dl)
void fn0C00_0100(struct Eq_2 * ds_bx, word16 cx, byte dh, byte dl)
{
	struct Eq_6 * ds = SLICE(ds_bx, selector, 16);
	struct Eq_8 Eq_20::* sp_2 = fp + 4;
	Eq_12 Top_107 = 0;
	do
	{
		dh += 0x10;
		sp_2 = sp_460 - 2;
		(ss->*sp_2).ptr0000 = SEQ(dh, dl);
		sp_460 = sp_2;
	} while (P);
	struct Eq_25 * fs_17 = (ss->*sp_2).ptr0000;
	struct Eq_25 * gs_19 = sp_2[1];
	Eq_33 es_21 = sp_2[2];
	__syscall(0x10);
	msdos_display_string(&ds->b023A);
	word16 cx_449 = cx;
	do
	{
		uint8 cl_30 = (byte) cx_461;
		__outb(0x03C8, cl_30);
		int16 ax_33 = (int16) cl_30;
		bcu8 al_34 = (byte) ax_33;
		__outb(969, al_34 >> 0x01);
		__outb(969, al_34 >> 0x01);
		__outb(969, al_34 >> 0x01 & SLICE(ax_33, byte, 8));
		cx_449 = cx_461 - 0x01;
		cx_461 = cx_449;
	} while (cx_461 != 0x01);
	sp_2[2] = ds;
	struct Eq_84 * ds_340 = ds_bx->ptr0002;
	word16 di_52 = 0x088E;
	struct Eq_410 Eq_84::* cx_453 = cx_461 - 0x01;
	do
	{
		es_21->*di_52 = (byte) *((char *) &&(ds_340->*(ds_340->*cx_462).b0000) + (word16) SLICE(cx_462, byte, 8) * 0x40);
		++di_52;
		cx_453 = cx_462 - 0x01;
		cx_462 = cx_453;
	} while (cx_462 != Eq_84::a0001);
	struct Eq_108 * ds_71 = sp_2[2];
	do
	{
		--ds_71->w0238;
		struct Eq_258 Eq_20::* sp_398 = &sp_460->ptr0000;
		Eq_208 bx_456 = 0x00;
		do
		{
			byte bh_364 = SLICE(bx_463, byte, 8);
			struct Eq_116 Eq_108::* di_100 = Eq_108::a0402;
			byte al_82 = (byte) bx_463;
			int16 dx_83 = 0xF200;
			do
			{
				int16 ax_86 = (int16) (al_82 - 0x80);
				(ds_71->*di_100).w0000 = ax_86;
				bi8 al_90 = (byte) ax_86;
				--Top_107;
				*Top_107 = (real64) (ds_71->*di_100).w0000;
				dx_83 -= al_90 *s al_90;
				cu8 dh_114 = SLICE(dx_83, byte, 8);
				al_82 = bh_364;
				++di_100;
			} while (P);
			*((word32) Top_107 + 1) = atan(*((word32) Top_107 + 2), *((word32) Top_107 + 1));
			*((word32) Top_107 + 1) *= (real64) ds_71->w0236;
			(ds_71->*di_100).w0000 = (int16) *((word32) Top_107 + 1);
			int16 ax_108 = (ds_71->*di_100).w0000;
			(ds_71->*di_100).w0000 = dx_83;
			bcu8 ah_111 = SLICE(ax_108 + ds_71->w0237, byte, 8);
			cui16 ax_116 = SEQ(ah_111, dh_114);
			Top_107 = (word32) Top_107 + 2;
			uint8 cl_113 = 0x00;
			byte dh_124 = (byte) (ax_116 & 0x0707) + SLICE(ax_116 & 0x0707, byte, 8) + dh_114;
			if (dh_114 <= ~0x13 && dh_114 >= ~0x14)
			{
				cl_113 = ah_111 >> 0x01;
				dh_124 = SLICE((ds_71->*di_100).w0000 << 0x05, byte, 8) + 0x60;
			}
			if (dh_114 <= ~0x19)
			{
				word16 cx_151 = SEQ(ah_111 & 0x1F, cl_113);
				if ((ah_111 & 0x1F) <= 0x03)
				{
					if (dh_114 >= 229)
					{
						dh_124 = __ror(dh_114, 0x03) + 0x1E;
						--cx_151;
					}
					dh_124 -= 0x14;
				}
				cl_113 = (byte) cx_151;
				if (dh_114 <= 0xB2)
					cl_113 = (byte) (cx_151 - 0x01);
			}
			gs_19->*bx_463 = cl_113;
			fs_17->*bx_463 = dh_124 + 0x80;
			bx_456 = (word16) bx_463 + 1;
			bx_463 = bx_456;
		} while (bx_463 != 0x01);
		Eq_33 di_196 = 900;
		word16 si_197;
		for (si_197 = 100; si_197 != ~0x63; --si_197)
		{
			word16 bp_198;
			for (bp_198 = ~0x9F; bp_198 != 0xA0; ++bp_198)
			{
				(ss->*sp_398).tFFFFFFFE = di_196;
				int32 dx_ax_210 = (int32) (int16) (byte) (ds_71->w0238 << 0x01);
				bi8 al_215 = ((byte) dx_ax_210 & 0x7F) - 0x40;
				int16 ax_216 = al_215 *s al_215;
				ui16 ax_221 = SEQ(SLICE(ax_216, byte, 8) - 0x10, (byte) ax_216);
				ui16 dx_222 = SLICE(dx_ax_210, word16, 16) ^ ax_221;
				word16 cx_204 = 0x7F40;
				word16 di_231 = SEQ(SLICE(ax_221 * 0x02, byte, 8) - 0x01, (byte) (ax_221 * 0x02));
				word16 dx_235 = SEQ(SLICE(dx_222, byte, 8) + 0x20, (byte) dx_222);
				do
				{
					cx_204 += bp_198;
					di_231 -= 0x96;
					word16 dx_237 = dx_235 + si_197;
					ci8 Eq_25::* bx_245 = SEQ(SLICE(di_231, byte, 8), SLICE(cx_204, byte, 8));
					byte cl_435 = (byte) cx_204;
					cu8 dh_255 = SLICE(dx_237, byte, 8);
					ci8 ah_247 = gs_19->*bx_245;
					ci8 al_249 = fs_17->*bx_245;
					if (ah_247 < 0x00)
						break;
					if (ah_247 != 0x00 && es_21->*SEQ(dh_255 >> 0x01, ah_247) != 0x00)
					{
						al_249 += 0x80;
						break;
					}
					dx_235 = dx_237;
				} while (dh_255 <= 0x46);
				Eq_33 di_276 = (ss->*sp_398).tFFFFFFFE;
				ds_71->*di_276 = al_249;
				di_196 = (word16) di_276 + 1;
			}
		}
		(ss->*sp_398).tFFFFFFFE = es_21;
		(ss->*sp_398).ptrFFFFFFFC = 0xA000;
		struct Eq_362 * es_301 = (ss->*sp_398).ptrFFFFFFFC;
		word16 Eq_362::* di_303 = Eq_362::a0000;
		word16 Eq_108::* si_304 = Eq_108::a0384;
		word16 cx_306;
		for (cx_306 = SEQ(0x7D, cl_435); cx_306 != 0x00; --cx_306)
		{
			es_301->*di_303 = ds_71->*si_304;
			++si_304;
			++di_303;
		}
		es_21 = (ss->*sp_398).tFFFFFFFE;
	} while (SEQ(ah_247, __inb(0x60)) != 0x01);
}

