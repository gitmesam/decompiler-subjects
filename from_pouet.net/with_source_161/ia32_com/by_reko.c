// subject_code.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject_code.h"

// 0C00:0100: void fn0C00_0100(Register int16 cx, Register int16 bx, Register word16 si, Register (ptr16 Eq_5) ds, Register (ptr16 Eq_6) fs)
void fn0C00_0100(int16 cx, int16 bx, word16 si, struct Eq_5 * ds, struct Eq_6 * fs)
{
	__syscall(0x10);
	msdos_display_string(&ds->b0172);
	__outb(0x0331, 0x3F);
	int16 ax_16 = 0x00;
	do
	{
		__outb(0x0330, 0x99);
		++si;
		__outb(0x0330, ((byte) si & 0x07) + 0x27);
		__outb(0x0330, 0x7F);
		int16 ax_33 = ax_16;
		ci16 bp_36 = fs->w046C;
		do
		{
			int16 bx_40 = bx *s 0x660D;
			bx = bx_40 + ~0x0CA0;
			if ((SLICE(bx_40 + ~0x0CA0, byte, 8) & 0x80) != 0x00)
			{
				int16 cx_53 = cx - ax_33;
				cx = cx_53 >> 0x01;
				ax_33 += cx_53 >> 0x01;
			}
			else
			{
				word16 ax_47 = ax_33 + 0x80;
				ci16 cx_49 = cx + ax_47;
				cx = cx_49 >> 0x01;
				ax_33 = ax_47 - (cx_49 >> 0x01);
			}
			Eq_43 di_61 = ax_33 *s ~0x013F + cx;
			++0xA000->*((word16) di_61 + 0x0000BBE4);
			0xA000->*((word16) di_61 + 0x0000BBE4) &= 0x0F;
			0xA000->*((word16) di_61 + 0x0000BBE4) += 0x10;
		} while (bp_36 + 0x03 > fs->w046C);
		ax_16 = ax_33;
	} while (__inb(0x60) != 0x01);
}

