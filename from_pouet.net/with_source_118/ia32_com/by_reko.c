// subject_code.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject_code.h"

// 0C00:0100: void fn0C00_0100(Sequence (ptr32 Eq_14) ds_bx, Register byte ah, Register word16 si)
void fn0C00_0100(union Eq_14 * ds_bx, byte ah, word16 si)
{
	Eq_5 bx = (word16) ds_bx;
	struct Eq_7 Eq_29::* sp_107 = fp;
	__syscall(0x10);
	Eq_14 ds_cx_8 = *ds_bx;
	int16 ax_105 = SEQ(ah, 0x13);
	byte ch_116 = SLICE(ds_cx_8, byte, 8);
	struct Eq_23 * ds_122 = SLICE(ds_cx_8, selector, 16);
	do
	{
		do
		{
			int32 dx_ax_15 = SEQ(SLICE((int32) ax_105, word16, 16), bx);
			int16 ax_18 = (int16) (dx_ax_15 / 0x0140);
			int16 dx_17 = (int16) (dx_ax_15 % 0x0140);
			int16 bp_20 = ax_18;
			Eq_57 di_22 = &sp_107->w0000 + 0x00A0;
			word16 cx_119 = SEQ(ch_116, 0x22);
			do
			{
				struct Eq_7 Eq_29::* sp_32 = sp_107 - 2;
				(ss->*sp_32).w0000 = ax_18;
				(ss->*sp_32).wFFFFFFFE = cx_119;
				(ss->*sp_32).wFFFFFFFC = dx_17;
				(ss->*sp_32).tFFFFFFFA = bx_129;
				(ss->*sp_32).ptrFFFFFFF8 = sp_107;
				int16 bp_29 = bp_20 + ax_18;
				(ss->*sp_32).wFFFFFFF6 = bp_29;
				(ss->*sp_32).wFFFFFFF4 = si;
				Eq_57 di_26 = (word16) di_22 + dx_17;
				(ss->*sp_32).tFFFFFFF2 = di_26;
				int32 dx_ax_54 = bp_29 *s (di_26 *s 0x02);
				(ss->*sp_32).wFFFFFFF7 = SLICE(dx_ax_54, word16, 16);
				(ss->*sp_32).wFFFFFFF5 = (word16) dx_ax_54;
				int32 dx_ax_63 = (di_26 - bp_29) *s ((word16) di_26.u0 + bp_29);
				(ss->*sp_32).wFFFFFFF3 = SLICE(dx_ax_63, word16, 16);
				(ss->*sp_32).wFFFFFFF1 = (word16) dx_ax_63;
				ax_18 = (ss->*sp_32).w0000;
				word16 cx_89 = (ss->*sp_32).wFFFFFFFE;
				di_22 = (ss->*sp_32).tFFFFFFF2;
				si = (ss->*sp_32).wFFFFFFF4;
				bp_20 = (ss->*sp_32).wFFFFFFF6;
				bx = (ss->*sp_32).tFFFFFFFA;
				dx_17 = (ss->*sp_32).wFFFFFFFC;
				byte ah_103 = SLICE(ax_18, byte, 8);
				sp_107 = &sp_32->w0000 + 1;
				cx_119 = cx_89 - 0x01;
				byte cl_95 = (byte) (cx_89 - 0x01);
				ch_116 = SLICE(cx_89 - 0x01, byte, 8);
				bx_129 = bx;
			} while ((SLICE(bp_29 *s bp_29, byte, 24) & (byte) bx_129) == 0x00 && cx_89 != 0x01);
			ds_122->*bx = cl_95;
			--bx;
			ax_105 = ax_18;
		} while (bx != 0x01);
		word16 ax_104 = SEQ(ah_103, __inb(0x60));
		(ss->*sp_32).w0000 = ax_104 - 0x01;
		ax_105 = ax_104 - 0x01;
		sp_107 = sp_32;
	} while (ax_104 != 0x01);
}

