// subject_code.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject_code.h"

// 0C00:0100: void fn0C00_0100(Register word16 cx, Register (memptr (ptr16 Eq_4) Eq_3) si, Register (ptr16 Eq_4) ds)
void fn0C00_0100(word16 cx, struct Eq_3 Eq_4::* si, struct Eq_4 * ds)
{
	int8 Top_172 = 0;
	__syscall(0x10);
	struct Eq_4 * ax_11 = SEQ(SLICE(ds, byte, 8) + 0x01, (byte) ds);
	word16 cx_236 = cx;
	do
	{
		uint8 cl_14 = (byte) cx_242;
		__outb(0x03C8, cl_14);
		__outb(969, cl_14);
		__outb(969, cl_14 >> 0x02);
		__outb(969, cl_14 >> 0x02);
		uint8 al_100 = cl_14 >> 0x02;
		byte ch_191 = SLICE(cx_242 - 0x01, byte, 8);
		cx_236 = cx_242 - 0x01;
		cx_242 = cx_236;
	} while (cx_242 != 0x01);
	do
	{
		byte Eq_4::* di_113 = &Eq_4::b0000;
		ci16 bx_125;
		for (bx_125 = ~0x63; bx_125 < 100; ++bx_125)
		{
			ci16 dx_119;
			for (dx_119 = ~0x9F; dx_119 < 0xA0; ++dx_119)
			{
				__fninit();
				int8 Top_28 = Top_172 - 1;
				Top_28->t0000.u0 = 0.0;
				si[2] = dx_119;
				Top_28->tFFFFFFFF.u0 = (real64) si[2];
				Top_28->tFFFFFFFE.u0 = (real64) ds->r010D;
				Top_28->tFFFFFFFE = sqrt(Top_28->tFFFFFFFE);
				Top_28->tFFFFFFFE = sin(Top_28->tFFFFFFFE);
				Top_28->tFFFFFFFE *= (real64) ds->w017E;
				Top_28->tFFFFFFFF += Top_28->tFFFFFFFE;
				Top_28->tFFFFFFFE = Top_28->tFFFFFFFF;
				Top_28->tFFFFFFFE *= Top_28->tFFFFFFFE;
				si[1] = bx_125;
				Top_28->tFFFFFFFD.u0 = (real64) si[1];
				Top_28->tFFFFFFFD *= Top_28->tFFFFFFFD;
				Top_28->tFFFFFFFE += Top_28->tFFFFFFFD;
				Top_28->tFFFFFFFE += Top_28->tFFFFFFFE;
				Eq_73 v19_55 = Top_28->tFFFFFFFE;
				Top_28->tFFFFFFFE = Top_28->tFFFFFFFF;
				Top_28->tFFFFFFFF = v19_55;
				Top_28->tFFFFFFFE += Top_28->tFFFFFFFE;
				Top_28->tFFFFFFFE = -Top_28->tFFFFFFFE;
				Top_28->tFFFFFFFD = Top_28->tFFFFFFFF;
				Top_28->tFFFFFFFD += Top_28->tFFFFFFFD;
				Top_28->tFFFFFFFC = Top_28->tFFFFFFFE;
				Top_28->tFFFFFFFC *= Top_28->tFFFFFFFC;
				Top_28->tFFFFFFFD = Top_28->tFFFFFFFC - Top_28->tFFFFFFFD;
				Eq_53 cx_215 = SEQ(ch_191, 0x04);
				do
				{
					byte cl_225;
					Eq_53 cx_91;
					Top_28->tFFFFFFFC.u0 = 1.44269504088896;
					Top_28->tFFFFFFFC *= Top_28->tFFFFFFFF;
					Top_28->tFFFFFFFD += Top_28->tFFFFFFFC;
					Top_172 = Top_28 - 3;
					if (Top_28->tFFFFFFFD >= Top_28->t0000)
					{
						Eq_61 ax_85 = <invalid>;
						al_100 = (byte) ax_85;
						ch_191 = SLICE(cx_84, byte, 8);
						cl_225 = (byte) cx_84;
						Eq_53 cx_84;
						byte al_240;
						if (fn0C00_01AF(cx_215, si, ds, Top_28->tFFFFFFFD, Top_28->tFFFFFFFE, Top_28->tFFFFFFFF, Top_28->t0000, out al_240, out cx_84))
							break;
						Eq_61 ax_92 = <invalid>;
						al_100 = (byte) ax_92;
						ch_191 = SLICE(cx_91, byte, 8);
						cl_225 = (byte) cx_91;
						cx_215 = cx_91;
						byte al_241;
						if (fn0C00_01AF(cx_84, si, ds, Top_28->tFFFFFFFD, Top_28->tFFFFFFFE, Top_28->tFFFFFFFF, Top_28->t0000, out al_241, out cx_91))
							break;
					}
					--cx_215;
					ch_191 = SLICE(cx_215, byte, 8);
					cl_225 = (byte) cx_215;
				} while (cx_215 != 0x00);
				ax_11->*di_113 = al_100;
				++di_113;
			}
		}
		word16 Eq_399::* di_155 = Eq_399::a0000;
		si = &Eq_4::b0000;
		word16 cx_159 = SEQ(0x7D, cl_225);
		while (true)
		{
			ch_191 = SLICE(cx_159, byte, 8);
			if (cx_159 == 0x00)
				break;
			0xA000->*di_155 = (ax_11->*si).w0000;
			++si;
			++di_155;
			--cx_159;
		}
		Top_28->tFFFFFFFC.u0 = 0.301029995663981;
		Top_28->tFFFFFFFC += (real64) ds->r010D;
		ds->r010D = (real32) Top_28->tFFFFFFFC;
		Top_172 = Top_28 - 3;
		byte ah_175;
	} while (bios_kbd_check_keystroke(out al_100, out ah_175));
	bios_video_set_mode(0x03);
	msdos_terminate_program20();
}

// 0C00:01AF: FlagGroup bool fn0C00_01AF(Register Eq_53 cx, Register (memptr (ptr16 Eq_4) Eq_3) si, Register (ptr16 Eq_4) ds, FpuStack Eq_73 rArg0, FpuStack Eq_73 rArg1, FpuStack Eq_73 rArg2, FpuStack Eq_73 rArg3, Register out Eq_61 alOut, Register out Eq_53 cxOut)
// Called from:
//      fn0C00_0100
bool fn0C00_01AF(Eq_53 cx, struct Eq_3 Eq_4::* si, struct Eq_4 * ds, Eq_73 rArg0, Eq_73 rArg1, Eq_73 rArg2, Eq_73 rArg3, union Eq_61 & alOut, union Eq_53 & cxOut)
{
	Eq_73 rLoc1_79 = sqrt(rArg0);
	if (!C)
		rLoc1_79 = -rLoc1_79;
	Eq_73 rLoc1_88 = (rLoc1_79 + rArg1) / rArg2;
	bool C_114 = SLICE(cond(rLoc1_88 - rArg3), bool, 1);
	if (rLoc1_88 >= rArg3)
	{
		real64 rLoc2_97 = atan(rLoc1_88, (real64) si[1] * rLoc1_88);
		real64 rLoc3_100 = (real64) ds->w0175 * rLoc1_88 + (real64) ds->r010D;
		(ds->*si).w0000 = cx;
		Eq_73 rLoc3_101 = rLoc3_100 - (real64) (ds->*si).w0000;
		(ds->*si).w0000.u0 = (int16) (fabs(sin(rLoc3_101)) * (real64) ds->w017E);
		C_114 = SLICE(cond(sin(rLoc2_97 + rLoc3_101) - rArg3), bool, 1);
	}
	alOut.u0 = <invalid>;
	cxOut = cx;
	return C_114;
}

