// subject_code.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject_code.h"

// 0C00:0100: void fn0C00_0100(Register word16 cx, Register (memptr (ptr16 Eq_122) byte) di, Register (ptr16 Eq_4) ds)
void fn0C00_0100(word16 cx, byte Eq_122::* di, struct Eq_4 * ds)
{
	__fninit();
	__syscall(0x10);
	do
	{
		byte al_19 = (byte) cx;
		__outb(0x03C8, al_19);
		byte al_21 = -al_19;
		__outb(969, al_21);
		__outb(969, al_21);
		__outb(969, al_21);
		--cx;
	} while (cx != 0x00);
	real64 rLoc1_230 = 0.0;
	do
	{
		ds->dw0408 = ds->dw0408 *s 0x000343FD + 2531011;
		cui16 bp_117;
		for (bp_117 = 0x0C; bp_117 != 0x40; bp_117 += 0x04)
		{
			int16 Eq_4::* si_101 = Eq_4::a0200;
			real64 rLoc2_231 = 0.0;
			do
			{
				Eq_71 dx_ax_51 = (uint32) (uint16) di;
				int16 cx_46 = bp_117 | ds->w040A & 0x03;
				ds->w0300 = (((int16) (dx_ax_51 / 0x0140) - 100) *s cx_46 >> 0x03) - 200;
				int16 dx_57 = ((int16) (dx_ax_51 % 0x0140) - 0xA0) *s cx_46;
				real64 rLoc2_233 = rLoc2_231 + (real64) ds->w0300;
				word16 cx_102 = 0x03;
				real64 rLoc3_234 = (real64) ds->r01F4;
				real64 rLoc4_235 = 0.0;
				do
				{
					ds->w0300 = (dx_57 >> 0x02) - ds->*si_101;
					real64 rLoc5_236 = (real64) ds->w0300;
					--cx_102;
					rLoc4_235 += rLoc5_236 * rLoc5_236;
					++si_101;
					byte ch_227 = SLICE(cx_102, byte, 8);
				} while (cx_102 != 0x00);
				rLoc2_231 = rLoc2_233 + rLoc3_234 / rLoc4_235;
			} while (si_101 != &Eq_4::w0218);
			ds->w0300 = (int16) rLoc2_231;
			int16 v25_112 = ds->w0300 - 0x01;
			ds->w0300 = v25_112;
			if (v25_112 >= 0x00)
				break;
		}
		cs->*di = (byte) (SEQ(SLICE(bp_117, byte, 8), (byte) bp_117 + cs->*di) >> 0x01);
		++di;
		bool Z_140 = SLICE(cond(di), bool, 2);
		if (di == &Eq_122::b0000)
		{
			do
			{
				0xA000->*di = cs->*di;
				++di;
			} while (di != &Eq_122::b0000);
			rLoc1_230 += ds->r01F8;
			int16 Eq_4::* si_158 = Eq_4::a0200;
			int16 cx_159;
			do
			{
				ds->*si_158 = cx_159;
				ds->*si_158 = (int16) (sin(((real64) (ds->*si_158) / (real64) ds->w01FE + rLoc1_230) * (real64) (ds->*si_158)) * (real64) ds->w01FC);
				++si_158;
				--cx_159;
			} while (cx_159 != 0x00);
			Z_140 = SLICE(cond((int16) __inb(0x60) - 0x01), bool, 2);
		}
	} while (Z_140);
}

