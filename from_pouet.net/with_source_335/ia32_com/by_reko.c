// subject_code.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject_code.h"

// 0C00:0100: void fn0C00_0100(Register (ptr16 Eq_2) ds)
void fn0C00_0100(struct Eq_2 * ds)
{
	word16 Eq_10::* di_138 = Eq_10::a0000;
	word16 cx_12;
	for (cx_12 = 0x7FFF; cx_12 != 0x00; --cx_12)
	{
		Mem137[cs + 0x2000:di_138 + 0x00:word16] = 0x00;
		++di_138;
	}
	Mem17[cs + 0x2000:di_138 + 0x00:word16] = 0x00;
	Mem23[ds:0x04B4:word16] = cs + 0x1000;
	bios_video_set_mode(0x13);
	__outb(0x03C8, 0x00);
	bcu8 ah_141;
	do
	{
		uint8 al_38 = ah_141 >> 0x02;
		__outb(969, al_38);
		__outb(969, al_38);
		__outb(969, al_38);
		++ah_141;
	} while (ah_141 != 0x00);
	__wait();
	__fninit();
	ds->r04A8 = (real32) (ds->r043C / (real64) ds->w0444);
	ds->r04AC = (real32) (ds->r043C / (real64) ds->w0446);
	ds->r04B0 = (real32) ((real64) ds->dw0448 / (3.14159265358979 + 3.14159265358979));
	fn0C00_03D1(cs + 0x2000);
	Eq_99 Top_102 = 0;
	do
	{
		fn0C00_0192(cs + 0x1000);
		word64 rRet1_97;
		word64 rRet0_98 = fn0C00_01DB(cs + 0x1000, ds, cs + 0x2000, out rRet1_97);
		*((word32) Top_102 - 1) = rRet1_97;
		*((word32) Top_102 - 2) = rRet0_98;
		fn0C00_019E(ds);
		fn0C00_01B6();
		ds->w044C += 0x0100;
		ds->w044E += 0x0100;
		Top_102 -= 2;
		byte al_125;
		byte ah_126;
	} while (bios_kbd_check_keystroke(out al_125, out ah_126));
	byte al_131;
	bios_kbd_get_keystroke(out al_131);
	bios_video_set_mode(0x03);
	msdos_terminate(0x00);
}

// 0C00:0192: void fn0C00_0192(Register (ptr16 Eq_103) es)
// Called from:
//      fn0C00_0100
void fn0C00_0192(struct Eq_10 * es)
{
	word16 cx_15;
	word32 Eq_10::* di_12 = Eq_10::a0000;
	for (cx_15 = 16000; cx_15 != 0x00; --cx_15)
	{
		es->*di_12 = 0x00;
		++di_12;
	}
}

// 0C00:019E: void fn0C00_019E(Register (ptr16 Eq_2) ds)
// Called from:
//      fn0C00_0100
void fn0C00_019E(struct Eq_2 * ds)
{
	struct Eq_15 * ds_11 = ds->ptr04B4;
	word16 cx_14;
	word32 Eq_15::* si_15 = Eq_15::a0000;
	word32 Eq_194::* di_16 = Eq_194::a0000;
	for (cx_14 = 16000; cx_14 != 0x00; --cx_14)
	{
		0xA000->*di_16 = ds_11->*si_15;
		++si_15;
		++di_16;
	}
}

// 0C00:01B6: void fn0C00_01B6()
// Called from:
//      fn0C00_0100
void fn0C00_01B6()
{
	do
		;
	while ((__inb(0x03DA) & 0x08) == 0x00);
	do
		;
	while ((__inb(0x03DA) & 0x08) != 0x00);
}

// 0C00:01DB: FpuStack real64 fn0C00_01DB(Register (ptr16 Eq_110) es, Register (ptr16 Eq_2) ds, Register (ptr16 Eq_112) gs, FpuStack out Eq_113 rLoc1Out)
// Called from:
//      fn0C00_0100
real64 fn0C00_01DB(struct Eq_10 * es, struct Eq_2 * ds, struct Eq_10 * gs, union Eq_113 & rLoc1Out)
{
	Eq_113 rRet1_14;
	real64 rLoc2_32 = fn0C00_01E2(ds, out rRet1_14);
	fn0C00_0309(es, ds, gs);
	rLoc1Out = rRet1_14;
	return rLoc2_32;
}

// 0C00:01E2: FpuStack Eq_228 fn0C00_01E2(Register (ptr16 Eq_2) ds, FpuStack out Eq_228 rLoc1Out)
// Called from:
//      fn0C00_01DB
Eq_228 fn0C00_01E2(struct Eq_2 * ds, union Eq_228 & rLoc1Out)
{
	fn0C00_0271(&Eq_2::t0478, &Eq_2::t045C, &Eq_2::t0450, ds);
	Eq_228 rLoc1_68 = (real64) ds->r04A8;
	fn0C00_028A(&Eq_2::t0478, &Eq_2::t0478, ds, rLoc1_68);
	__ffree(rLoc1_68);
	fn0C00_0271(&Eq_2::t0484, &Eq_2::t0468, &Eq_2::t0450, ds);
	Eq_228 rLoc2_69 = (real64) ds->r04AC;
	fn0C00_028A(&Eq_2::t0484, &Eq_2::t0484, ds, rLoc2_69);
	__ffree(rLoc2_69);
	fn0C00_02A1(&Eq_2::t0450, &Eq_2::t0490, ds);
	ds->ptr04BA = &Eq_2::t04BC;
	word16 cx_26 = 0x33;
	do
	{
		fn0C00_02A1(&Eq_2::t0490, &Eq_2::r049C, ds);
		word16 cx_38 = 0x51;
		do
		{
			fn0C00_02B8(ds, rLoc2_69);
			fn0C00_0258(&Eq_2::r049C, &Eq_2::r049C, &Eq_2::t0478, ds);
			cx_38 = cx_84 - 0x01;
			cx_84 = cx_38;
		} while (cx_84 != 0x01);
		fn0C00_0258(&Eq_2::t0490, &Eq_2::t0490, &Eq_2::t0484, ds);
		cx_26 = cx_83 - 0x01;
		cx_83 = cx_26;
	} while (cx_83 != 0x01);
	rLoc1Out = rLoc1_68;
	return rLoc2_69;
}

// 0C00:0258: void fn0C00_0258(Register (memptr (ptr16 Eq_2) Eq_300) bx, Register (memptr (ptr16 Eq_2) Eq_301) si, Register (memptr (ptr16 Eq_2) Eq_302) di, Register (ptr16 Eq_2) ds)
// Called from:
//      fn0C00_01E2
void fn0C00_0258(struct Eq_300 Eq_2::* bx, struct Eq_301 Eq_2::* si, struct Eq_302 Eq_2::* di, struct Eq_2 * ds)
{
	(ds->*bx).r0000 = (real32) ((real64) (ds->*si).r0000 + (ds->*di).r0000);
	(ds->*bx).r0004 = (real32) ((real64) (ds->*si).r0004 + (ds->*di).r0004);
	(ds->*bx).r0008 = (real32) ((real64) (ds->*si).r0008 + (ds->*di).r0008);
}

// 0C00:0271: void fn0C00_0271(Register (memptr (ptr16 Eq_2) Eq_240) bx, Register (memptr (ptr16 Eq_2) Eq_241) si, Register (memptr (ptr16 Eq_2) Eq_242) di, Register (ptr16 Eq_2) ds)
// Called from:
//      fn0C00_01E2
void fn0C00_0271(struct Eq_240 Eq_2::* bx, struct Eq_241 Eq_2::* si, struct Eq_242 Eq_2::* di, struct Eq_2 * ds)
{
	(ds->*bx).r0000 = (real32) ((real64) (ds->*si).r0000 - (ds->*di).r0000);
	(ds->*bx).r0004 = (real32) ((real64) (ds->*si).r0004 - (ds->*di).r0004);
	(ds->*bx).r0008 = (real32) ((real64) (ds->*si).r0008 - (ds->*di).r0008);
}

// 0C00:028A: void fn0C00_028A(Register (memptr (ptr16 Eq_2) Eq_254) si, Register (memptr (ptr16 Eq_2) Eq_255) di, Register (ptr16 Eq_2) ds, FpuStack Eq_228 rArg0)
// Called from:
//      fn0C00_01E2
void fn0C00_028A(struct Eq_254 Eq_2::* si, struct Eq_255 Eq_2::* di, struct Eq_2 * ds, Eq_228 rArg0)
{
	(ds->*di).r0000 = (real32) ((real64) (ds->*si).r0000 * rArg0);
	(ds->*di).r0004 = (real32) ((real64) (ds->*si).r0004 * rArg0);
	(ds->*di).r0008 = (real32) ((real64) (ds->*si).r0008 * rArg0);
}

// 0C00:02A1: void fn0C00_02A1(Register (memptr (ptr16 Eq_2) Eq_282) si, Register (memptr (ptr16 Eq_2) Eq_283) di, Register (ptr16 Eq_2) ds)
// Called from:
//      fn0C00_01E2
void fn0C00_02A1(struct Eq_282 Eq_2::* si, struct Eq_283 Eq_2::* di, struct Eq_2 * ds)
{
	word32 ebx_8 = (ds->*si).dw0004;
	word32 ecx_9 = (ds->*si).dw0008;
	(ds->*di).dw0000 = (ds->*si).dw0000;
	(ds->*di).dw0004 = ebx_8;
	(ds->*di).dw0008 = ecx_9;
}

// 0C00:02B8: void fn0C00_02B8(Register (ptr16 Eq_2) ds, FpuStack Eq_228 rArg0)
// Called from:
//      fn0C00_01E2
void fn0C00_02B8(struct Eq_2 * ds, Eq_228 rArg0)
{
	real64 rLoc1_41 = (real64) ds->r049C;
	real64 rLoc2_43 = (real64) ds->r04A0;
	ds->t04B6.u0 = (int32) (ds->r0474 / sqrt(rLoc1_41 * rLoc1_41 + rLoc2_43 * rLoc2_43) * ds->r04A4 * ds->r0440);
	struct Eq_288 Eq_2::* di_20 = ds->ptr04BA;
	(ds->*di_20).w0000 = (word16) ds->t04B6.u1 + ds->w044E;
	ds->t04B6.u0 = (int32) (atan(rArg0, (real64) ds->r049C) * ds->r04B0);
	(ds->*di_20).w0002 = (word16) ds->t04B6.u1 + ds->w044C;
	ds->ptr04BA = &ds->ptr04BA->w0002 + 1;
}

// 0C00:0309: void fn0C00_0309(Register (ptr16 Eq_110) es, Register (ptr16 Eq_2) ds, Register (ptr16 Eq_112) gs)
// Called from:
//      fn0C00_01DB
void fn0C00_0309(struct Eq_10 * es, struct Eq_2 * ds, struct Eq_10 * gs)
{
	struct Eq_513 Eq_2::* si_126 = &Eq_2::t04BC;
	struct Eq_515 Eq_10::* di_112 = Eq_10::a0000;
	word16 cx_11 = 0x32;
	do
	{
		word16 cx_130 = 0x50;
		do
		{
			word32 ebx_116 = si_126[1];
			word32 eax_115 = (ds->*si_126).dw0000;
			word32 edx_27 = si_126[82] - ebx_116;
			word32 ebp_29 = __rol(si_126[81] - eax_115, 0x10);
			word32 edx_31 = __rol(edx_27, 0x10);
			word32 ebp_39 = __rol(SEQ(SLICE(ebp_29, word16, 16), (word16) ebp_29 >> 0x02), 0x10);
			word32 edx_43 = __rol(SEQ(SLICE(edx_31, word16, 16), (word16) edx_31 >> 0x02), 0x10);
			ds->dw04BE = SEQ(SLICE(ebp_39, word16, 16), (word16) ebp_39 >> 0x02);
			ds->dw04C2 = SEQ(SLICE(edx_43, word16, 16), (word16) edx_43 >> 0x02);
			byte ch_119;
			for (ch_119 = 0x04; ch_119 != 0x00; --ch_119)
			{
				word32 ebx_66 = __rol(ebx_116 - eax_115, 0x10);
				word32 ebx_72 = __rol(SEQ(SLICE(ebx_66, word16, 16), (word16) ebx_66 >> 0x02), 0x10);
				word32 ebx_77 = SEQ(SLICE(ebx_72, word16, 16), (word16) ebx_72 >> 0x02);
				byte cl_102;
				eax_100 = eax_115;
				for (cl_102 = 0x04; cl_102 != 0x00; --cl_102)
				{
					word32 eax_100;
					word32 eax_86 = __rol(eax_100, 0x10);
					word32 eax_90 = __rol(eax_86, 0x10);
					(es->*di_112).b0000 = gs->*SEQ(SLICE(eax_86, byte, 8), SLICE(eax_100, byte, 8));
					di_112 = &di_112->b0000 + 1;
					eax_100 = eax_90 + ebx_77;
				}
				di_112 = &di_112->b0000 + 316;
				eax_115 += ds->dw04BE;
				ebx_116 += ds->dw04C2;
			}
			di_112 -= 0x03C0;
			++si_126;
			cx_130 = cx_184 - 0x01;
			cx_184 = cx_130;
		} while (cx_184 != 0x01);
		++si_126;
		cx_11 = cx_183 - 0x01;
		cx_183 = cx_11;
	} while (cx_183 != 0x01);
}

// 0C00:03BA: Register byte fn0C00_03BA(Register Eq_657 cl, Register uint16 dx)
// Called from:
//      fn0C00_0417
byte fn0C00_03BA(Eq_657 cl, uint16 dx)
{
	int16 ax_6 = (int16) __inb(0x40);
	ci16 dx_14 = dx + (SEQ(SLICE(ax_6, byte, 8), (byte) ax_6 << cl) >> 0x04);
	if (dx_14 < 0x00)
		dx_14 = 0x00;
	byte dh_20 = SLICE(dx_14, byte, 8);
	ci16 dx_30 = dx_14;
	if (dh_20 != 0x00)
		dx_30 = SEQ(dh_20, ~0x00);
	return (byte) dx_30;
}

// 0C00:03D1: void fn0C00_03D1(Register (ptr16 Eq_95) gs)
// Called from:
//      fn0C00_0100
void fn0C00_03D1(struct Eq_10 * gs)
{
	gs->a0000[0].u0 = 0x80;
	gs->b0080 = 0x80;
	gs->b8000 = 0x80;
	gs->b8080 = 0x80;
	byte Eq_10::* bx_19 = Eq_10::a0000;
	Eq_657 cx_12 = 0x80;
	do
	{
		do
		{
			do
			{
				bx_81 = SEQ(bh_80, bl_65);
				byte Eq_10::* bx_34 = fn0C00_0417(cx_89, (byte) (cx_89 << 0x08), fn0C00_0417(SLICE(cx_89, byte, 8), cx_89, bx_19, gs), gs);
				fn0C00_0417(cx_89, -cx_89, SEQ(SLICE(bx_34, byte, 8), (word16) cx_89 + ((word16) cx_89 + (byte) bx_34)), gs);
				byte bh_68 = SLICE(bx_34, byte, 8);
				byte bh_80 = SLICE(bx_34, byte, 8);
				cx_12 = cx_89;
				byte ch_76 = SLICE(cx_89, byte, 8);
				cu8 bl_65 = (word16) cx_89 + ((word16) cx_89 + (byte) bx_34);
				cx_89 = cx_12;
				bx_19 = bx_81;
			} while (bl_65 >= 0x00);
			cu8 bh_70 = (word16) cx_89 + ((word16) cx_89 + bh_68);
			cx_12 = cx_89;
			bx_19 = SEQ(bh_70, bl_65);
			cx_90 = cx_12;
		} while (bh_70 >= 0x00);
		cx_12 = SEQ(ch_76, cx_89 >> 0x01);
		cx_91 = cx_12;
	} while (cx_89 >> 0x01 != 0x00);
}

// 0C00:0417: Register (memptr (ptr16 Eq_95) byte) fn0C00_0417(Register Eq_657 ch, Register Eq_657 cl, Register (memptr (ptr16 Eq_95) byte) bx, Register (ptr16 Eq_95) gs)
// Called from:
//      fn0C00_03D1
byte Eq_10::* fn0C00_0417(Eq_657 ch, Eq_657 cl, byte Eq_10::* bx, struct Eq_10 * gs)
{
	byte bh_9 = SLICE(bx, byte, 8);
	byte bl_13 = (byte) bx;
	byte bh_12 = (byte) ch.u1 + ((byte) ch.u1 + bh_9);
	byte bl_16 = (byte) cl.u1 + ((byte) cl.u1 + bl_13);
	byte bh_33 = bh_12 - ch;
	byte bl_34 = bl_16 - cl;
	gs->*SEQ(bh_33, bl_34) = (byte) (uint16) (uint8) fn0C00_03BA(cl, (uint16) (uint8) (gs->*SEQ(bh_12, bl_16) + gs->*bx) >> 0x01);
	return SEQ(bh_33 - ch, bl_34 - cl);
}

