// subject.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

// 00401000: void fn00401000()
void fn00401000()
{
	Eq_2 edx_13 = globals->t402104;
	byte bl_14 = 0x00;
	do
	{
		*edx_13 = bl_14;
		struct Eq_10 * edx_8 = (word32) edx_13 + 0x01;
		edx_8->b0000 = bl_14;
		edx_8->b0001 = bl_14;
		edx_13 = &edx_8->b0001 + 0x02;
		bl_14 = bl_14 + 0x01;
	} while (bl_14 != 0x00);
}

// 00401017: void fn00401017()
void fn00401017()
{
	word32 ecx_17 = 0x0F00;
	byte * esi_10 = globals->a402136;
	Eq_29 edi_14 = globals->t402118;
	do
	{
		*edi_14 = *esi_10;
		esi_10 = esi_10 + 0x01;
		edi_14 = (word32) edi_14 + 0x01;
		ecx_17 = ecx_17 - 0x01;
	} while (ecx_17 != 0x00);
	int32 ebx_20 = 0x00;
	cu8 bl_21 = 0x00;
	cui16 bx_22 = 0x00;
	do
	{
		byte dl_101 = ~0x04;
		if (bl_21 <= ~0x04 && bl_21 >= 0x04)
		{
			ebx_20 = DPB(ebx_20, bx_22, 0);
			if (true)
			{
				cui16 dx_94 = bx_22 & 0x0F0F;
				dl_101 = (byte) (DPB(dx_94, (byte) dx_94 + SLICE(dx_94, byte, 8), 0) << 0x02);
			}
		}
		*((char *) globals->t40211C + ebx_20) = (Eq_54) dl_101;
		bx_22 = bx_22 - 0x01;
		bl_21 = (byte) bx_22;
		ebx_20 = DPB(ebx_20, bx_22, 0);
	} while (bx_22 != 0x00);
}

// 00401088: void fn00401088(FpuStack real64 rArg0, FpuStack real64 rArg1)
void fn00401088(real64 rArg0, real64 rArg1)
{
}

// 004011F5: Register Eq_341 Win32CrtStartup()
DWORD Win32CrtStartup()
{
	ptr32 esp_182;
	ptr32 esp_124 = fp - 0x08;
	Eq_2 eax_6 = GlobalAlloc(0x00, 1000000);
	if (eax_6 != 0x00)
	{
		globals->t40210C = eax_6;
		globals->t402104 = eax_6;
		Mem103[0x00402100:word32] = eax_6 + 2000;
		Mem105[0x0040211C:word32] = eax_6 + 402000;
		Mem107[0x00402118:word32] = eax_6 + 602000;
		globals->t4020B4 = GetModuleHandleW(null);
		globals->t4020B8 = LoadIconW(0x00, (WCHAR *) 0x7F00);
		Eq_458 eax_122 = LoadCursorW(0x00, (WCHAR *) 0x7F00);
		globals->t4020BC = eax_122;
		esp_124 = fp - 0x20;
		if (DPB(eax_122, RegisterClassW(&globals->t4020A4), 0) != null)
		{
			esp_124 = fp - 0x50;
			Eq_321 eax_155 = CreateWindowExW(0x00, &globals->t402000, &globals->t402012, 0x10CF0000, 0x8000, 0x8000, 0x021C, 400, null, null, globals->t4020B4, null);
			if (eax_155 != null)
			{
				globals->t4020CC = eax_155;
				globals->t4020D0 = GetDC(eax_155);
				fn00401000();
				fn00401017();
				fn00401088(rArg0, rArg1);
				*(fp - 88) = 0x04;
				*(fp - 0x5C) = (HDC *) globals->t4020D0;
				SetStretchBltMode(*(fp - 0x5C), *(fp - 88));
				ptr32 esp_169 = fp - 0x5C;
				while (true)
				{
					UINT * esp_174 = esp_169 - 0x04;
					*esp_174 = (uint32) 0x01;
					*(esp_174 - 0x04) = 0x00;
					*(esp_174 - 0x08) = 0x00;
					*(esp_174 - 0x0C) = 0x00;
					*(esp_174 - 0x10) = 0x004020D4;
					PeekMessageW(*(esp_174 - 0x10), *(esp_174 - 0x0C), *(esp_174 - 0x08), *(esp_174 - 0x04), *esp_174);
					esp_182 = esp_174 - 0x10;
					if (globals->dw4020D8 == 0x12)
						break;
					*(esp_174 - 0x14) = 0x004020D4;
					TranslateMessage(*(esp_174 - 0x14));
					*(esp_174 - 0x18) = 0x004020D4;
					DispatchMessageW(*(esp_174 - 0x18));
					fn00401088(rArg2, rArg3);
					globals->dw402108 = globals->dw402108 + 0x01;
					esp_169 = esp_174 - 0x18;
				}
l0040132F:
				HDC * esp_54 = esp_182 - 0x04;
				*esp_54 = (HDC *) globals->t4020D0;
				*(esp_54 - 0x04) = (HWND *) globals->t4020CC;
				ReleaseDC(*(esp_54 - 0x04), *esp_54);
				*(esp_54 - 0x08) = (union Eq_2 *) globals->t40210C;
				GlobalFree(*(esp_54 - 0x08));
				*(esp_54 - 0x0C) = globals->dw4020DC;
				ExitProcess(*(esp_54 - 0x0C));
			}
		}
	}
	UINT * esp_89 = esp_124 - 0x04;
	*esp_89 = (uint32) 0x10;
	*(esp_89 - 0x04) = 0x00;
	*(esp_89 - 0x08) = 0x0040204C;
	*(esp_89 - 0x0C) = 0x00;
	MessageBoxW(*(esp_89 - 0x0C), *(esp_89 - 0x08), *(esp_89 - 0x04), *esp_89);
	esp_182 = esp_89 - 0x0C;
	goto l0040132F;
}

