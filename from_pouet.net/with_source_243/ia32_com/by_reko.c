// subject_code.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject_code.h"

// 0C00:0100: void fn0C00_0100(Register byte ch, Register cui16 bx, Register (memptr Eq_54 word16) di)
void fn0C00_0100(byte ch, cui16 bx, word16 Eq_54::* di)
{
	__syscall(0x10);
	__outb(0x03C8, 0x01);
	byte ah_13 = 0x00;
	word16 cx_169;
	do
	{
		__outb(969, ah_13 + 0x00);
		__outb(969, 0x00);
		__outb(969, 0x00);
		++ah_13;
		if (ah_13 == 0xC1)
			0C00:0119 = (byte *) 0xCC;
		--cx_169;
	} while (cx_169 != 0x00);
	byte dh_146 = 0x06;
	word16 cx_38 = 0x0200;
	do
	{
		bx += 1663;
		cs->*di = bx & 1663;
		--cx_38;
		++di;
		byte ch_176 = SLICE(cx_38, byte, 8);
		byte cl_187 = (byte) cx_38;
	} while (cx_38 != 0x00);
	do
	{
		__syscall(0x10);
		word16 si_53 = 0x00;
		word16 di_124 = 0x00;
		word16 cx_190 = SEQ(ch_176 + 0x01, cl_187);
		do
		{
			word16 ax_62 = cs->*si_53;
			byte ah_65 = SLICE(ax_62, byte, 8);
			cu8 al_66 = (byte) ax_62 + ah_65;
			++si_53;
			word16 ax_72 = SEQ(SLICE(ax_62, byte, 8), al_66);
			if (al_66 >= 200)
			{
				byte ah_69 = -ah_65;
				ax_72 = SEQ(ah_69, al_66 + ah_69);
			}
			(cs->*di_124).t0000 = ax_72;
			--cx_190;
			di_124 += 2;
			byte ch_211 = SLICE(cx_190, byte, 8);
		} while (cx_190 != 0x00);
		Eq_110 si_192 = 0x00;
		do
		{
			word16 cx_101 = SEQ(ch_211, 0x06);
			do
			{
				--cx_101;
				Eq_54 ax_92 = cs->*si_192;
				si_192 = (word16) si_192 + 2;
				ch_211 = SLICE(cx_101, byte, 8);
				byte cl_221 = (byte) cx_101;
			} while (cx_101 != 0x00);
			fn0C00_01A4(cs, 0x05, ax_92, wLoc0A, wLoc08, wLoc06, wLoc04, wLoc02);
		} while (si_192 < 0x01F8);
		wLoc02 = cs;
		wLoc04.u0->a0000 = 0xA000;
		word16 cx_130;
		do
		{
			(0xA000->*di_124).t0000 = (cs->*di_124).t0000;
			di_124 += 2;
			--cx_130;
		} while (cx_130 != 0x00);
		int16 bx_136 = 0x0140;
		word16 cx_137 = cx_130 - 0x01;
		do
		{
			bx_136 = -bx_136;
			cu16 dx_147 = SEQ(dh_146, di_124[bx_136] + (cs->*di_124).t0000);
			byte dl_150 = (byte) (dx_147 >> 0x01);
			(cs->*di_124).bFFFFFEC1 = dl_150;
			di_124[319] = dl_150;
			--cx_137;
			dh_146 = SLICE(dx_147 >> 0x01, byte, 8);
			++di_124;
			ch_176 = SLICE(cx_137, byte, 8);
			cl_187 = (byte) cx_137;
		} while (cx_137 != 0x00);
	} while (__inb(SEQ(dh_146, 0x60)) != 0x01);
	bios_video_set_mode(0x03);
}

// 0C00:01A4: void fn0C00_01A4(Register Eq_54 fs, Stack Eq_54 wArg02, Stack Eq_54 wArg04, Stack Eq_54 wArg06, Stack Eq_54 wArg08, Stack Eq_54 wArg0A, Stack Eq_54 wArg0C, Stack Eq_54 wArg0E)
// Called from:
//      fn0C00_0100
//      fn0C00_01A4
void fn0C00_01A4(Eq_54 fs, Eq_54 wArg02, Eq_54 wArg04, Eq_54 wArg06, Eq_54 wArg08, Eq_54 wArg0A, Eq_54 wArg0C, Eq_54 wArg0E)
{
	if (wArg02 == 0x00)
		Mem102[fs:wArg04 *s 0x0140 + wArg06 + 0x40:byte] = 0x80;
	else
	{
		word16 ax_44 = wArg0E + wArg0A;
		word16 dx_46 = wArg0C + wArg08;
		fn0C00_01A4(fs, wArg02 - 0x01, (dx_46 >>u 0x01) + (wArg08 + wArg04 >>u 0x01) >>u 0x01, (ax_44 >>u 0x01) + (wArg0A + wArg06 >>u 0x01) >>u 0x01, dx_46 >>u 0x01, ax_44 >>u 0x01, wArg0C, wArg0E);
		fn0C00_01A4(fs, wArg02 - 0x01, wArg02, wArg04, wArg06, wArg08, wArg0A, wArg0C);
	}
}

