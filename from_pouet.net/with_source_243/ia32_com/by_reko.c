// subject_code.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject_code.h"

// 0C00:0100: void fn0C00_0100(Register byte ch, Register cui16 bx, Register (memptr Eq_51 word16) di)
void fn0C00_0100(byte ch, cui16 bx, word16 Eq_51::* di)
{
	__syscall(0x10);
	__outb(0x03C8, 0x01);
	byte ah_13 = 0x00;
	word16 cx_173 = SEQ(ch, 0x80);
	do
	{
		__outb(969, ah_13 + 0x00);
		__outb(969, 0x00);
		__outb(969, 0x00);
		++ah_13;
		if (ah_13 == 0xC1)
			0C00:0119 = (byte *) 0xCC;
		--cx_173;
	} while (cx_173 != 0x00);
	byte ch_29 = SLICE(cs, byte, 8);
	byte cl_32 = (byte) cs;
	Eq_51 cx_33 = SEQ(ch_29 + 0x30, cl_32);
	Eq_51 cx_38 = SEQ(ch_29 + 0x31, cl_32);
	byte dh_150 = 0x06;
	word16 cx_41 = 0x0200;
	do
	{
		bx += 1663;
		cx_33->*di = bx & 1663;
		--cx_41;
		++di;
		byte ch_180 = SLICE(cx_41, byte, 8);
		byte cl_191 = (byte) cx_41;
	} while (cx_41 != 0x00);
	do
	{
		__syscall(0x10);
		word16 si_56 = 0x00;
		word16 di_128 = 0x00;
		word16 cx_194 = SEQ(ch_180 + 0x01, cl_191);
		do
		{
			word16 ax_65 = cx_33->*si_56;
			byte ah_68 = SLICE(ax_65, byte, 8);
			cu8 al_69 = (byte) ax_65 + ah_68;
			++si_56;
			word16 ax_75 = SEQ(ah_68, al_69);
			if (al_69 >= 200)
			{
				byte ah_72 = -ah_68;
				ax_75 = SEQ(ah_72, al_69 + ah_72);
			}
			(cx_33->*di_128).t0000 = ax_75;
			--cx_194;
			di_128 += 2;
			byte ch_215 = SLICE(cx_194, byte, 8);
		} while (cx_194 != 0x00);
		Eq_121 si_196 = 0x00;
		do
		{
			word16 cx_105 = SEQ(ch_215, 0x06);
			do
			{
				--cx_105;
				si_196 = (word16) si_196 + 2;
				Eq_51 ax_102 = (uint16) (cx_33->*si_196);
				ch_215 = SLICE(cx_105, byte, 8);
				byte cl_225 = (byte) cx_105;
			} while (cx_105 != 0x00);
			fn0C00_01A4(cx_38, 0x05, ax_102, wLoc0A, wLoc08, wLoc06, wLoc04, wLoc02);
		} while (si_196 < 0x01F8);
		wLoc02 = cx_33;
		wLoc04.u0->a0000 = 0xA000;
		word16 cx_134 = SEQ(~0x00, cl_225);
		do
		{
			(0xA000->*di_128).t0000 = (cx_38->*di_128).t0000;
			di_128 += 2;
			--cx_134;
		} while (cx_134 != 0x00);
		int16 bx_140 = 0x0140;
		word16 cx_141 = cx_134 - 0x01;
		do
		{
			bx_140 = -bx_140;
			cu16 dx_151 = SEQ(dh_150, di_128[bx_140] + (cx_38->*di_128).t0000);
			byte dl_154 = (byte) (dx_151 >> 0x01);
			(cx_38->*di_128).bFFFFFEC1 = dl_154;
			di_128[319] = dl_154;
			--cx_141;
			dh_150 = SLICE(dx_151 >> 0x01, byte, 8);
			++di_128;
			ch_180 = SLICE(cx_141, byte, 8);
			cl_191 = (byte) cx_141;
		} while (cx_141 != 0x00);
	} while (__inb(SEQ(dh_150, 0x60)) != 0x01);
	bios_video_set_mode(0x03);
}

// 0C00:01A4: void fn0C00_01A4(Register Eq_51 fs, Stack Eq_51 wArg02, Stack Eq_51 wArg04, Stack Eq_51 wArg06, Stack Eq_51 wArg08, Stack Eq_51 wArg0A, Stack Eq_51 wArg0C, Stack Eq_51 wArg0E)
// Called from:
//      fn0C00_0100
//      fn0C00_01A4
void fn0C00_01A4(Eq_51 fs, Eq_51 wArg02, Eq_51 wArg04, Eq_51 wArg06, Eq_51 wArg08, Eq_51 wArg0A, Eq_51 wArg0C, Eq_51 wArg0E)
{
	if (wArg02 == 0x00)
		Mem102[fs:wArg04 *s 0x0140 + wArg06 + 0x40:byte] = 0x80;
	else
	{
		word16 ax_44 = wArg0E + wArg0A;
		word16 dx_46 = wArg0C + wArg08;
		fn0C00_01A4(fs, wArg02 - 0x01, (dx_46 >>u 0x01) + (wArg08 + wArg04 >>u 0x01) >>u 0x01, (ax_44 >>u 0x01) + (wArg0A + wArg06 >>u 0x01) >>u 0x01, dx_46 >>u 0x01, ax_44 >>u 0x01, wArg0C, wArg0E);
		fn0C00_01A4(fs, wArg02 - 0x01, wArg02, wArg04, wArg06, wArg08, wArg0A, wArg0C);
	}
}

