// subject_code.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject_code.h"

// 0C00:0100: void fn0C00_0100(Register (ptr16 Eq_2) ds)
void fn0C00_0100(struct Eq_2 * ds)
{
	bios_video_set_mode(0x13);
	struct Eq_8 * es_12;
	byte al_18 = (byte) (uint16) (uint8) fn0C00_014E(ds, out es_12);
	do
	{
		fn0C00_01A7(al_18, ds);
		fn0C00_01C2(es_12, ds);
		do
			;
		while ((__inb(0x03DA) & 0x08) != 0x00);
		do
			;
		while ((__inb(0x03DA) & 0x08) == 0x00);
		fn0C00_02A7(es_12, ds);
		byte ah_57;
	} while (bios_kbd_check_keystroke(out al_18, out ah_57));
	msdos_terminate_program20();
}

// 0C00:0140: Register word16 fn0C00_0140(Register (ptr16 Eq_2) ds)
// Called from:
//      fn0C00_0167
//      fn0C00_01C2
word16 fn0C00_0140(struct Eq_2 * ds)
{
	word16 ax_8 = (word16) (ds->w013E * 0x41A7);
	ds->w013E = ax_8 + 0xE80B;
	return ax_8 + 0xE80B;
}

// 0C00:014E: Register byte fn0C00_014E(Register (ptr16 Eq_2) ds, Register out (ptr16 Eq_8) esOut)
// Called from:
//      fn0C00_0100
byte fn0C00_014E(struct Eq_2 * ds, struct Eq_8 & esOut)
{
	byte Eq_8::* di_26 = &Eq_8::b0000;
	word16 cx_10;
	for (cx_10 = 0x0140; cx_10 != 0x00; --cx_10)
	{
		0xA000->*di_26 = 0x00;
		++di_26;
	}
	word16 cx_13;
	for (cx_13 = 63800; cx_13 != 0x00; --cx_13)
	{
		0xA000->*di_26 = 0x12;
		++di_26;
	}
	uint16 ax_18 = (uint16) (uint8) fn0C00_0167(0xA000, ds);
	esOut = 0xA000;
	return (byte) ax_18;
}

// 0C00:0167: Register byte fn0C00_0167(Register (ptr16 Eq_8) es, Register (ptr16 Eq_2) ds)
// Called from:
//      fn0C00_014E
//      fn0C00_01C2
byte fn0C00_0167(struct Eq_8 * es, struct Eq_2 * ds)
{
	ds->t012E = (fn0C00_0140(ds) & 0x7F) + 0x24;
	ds->w012C = 0xA0;
	ds->w0138 = 0x1E;
	Eq_127 bx_17 = ds->t013A;
	if (bx_17 >= 0xA0)
	{
		ds->t013A.u0 = 0xA0;
		bx_17.u0 = 0x00;
	}
	es->*bx_17 = 0x0F;
	Eq_136 bx_27 = ds->t013C;
	if (bx_27 <= 0xA0)
	{
		ds->t013C.u0 = 0xA0;
		bx_27.u0 = 0x013F;
	}
	es->*bx_27 = 0x0F;
	return 0xA0;
}

// 0C00:01A7: void fn0C00_01A7(Register byte al, Register (ptr16 Eq_2) ds)
// Called from:
//      fn0C00_0100
void fn0C00_01A7(byte al, struct Eq_2 * ds)
{
	ds->w012A = 0x00;
	__syscall(22);
	if ((al & 0x04) != 0x00)
		++ds->w012A;
	if ((al & 0x08) != 0x00)
		--ds->w012A;
}

// 0C00:01C2: void fn0C00_01C2(Register (ptr16 Eq_8) es, Register (ptr16 Eq_2) ds)
// Called from:
//      fn0C00_0100
void fn0C00_01C2(struct Eq_8 * es, struct Eq_2 * ds)
{
	Eq_118 bx_13 = ds->t0128;
	if (ds->w012C >= 0xE6)
	{
		Eq_118 ax_10 = ds->t012E;
		bx_13 = ds->t0128;
		if (ax_10 >= (word16) bx_13.u0 + 5)
		{
			if (ax_10 > (word16) bx_13.u0 + 5)
			{
				bx_13 = (word16) bx_13.u0 + 1;
				if (bx_13 >= 188)
					bx_13.u0 = 0xBD;
			}
		}
		else
		{
			--bx_13;
			if (bx_13 <= 0x03)
				bx_13.u0 = 0x02;
		}
	}
	ds->t0128 = bx_13;
	word16 bx_27 = ds->w012A;
	if (bx_27 == 0x00)
		fn0C00_0140(ds);
	Eq_118 bx_39 = (word16) ds->t0126 + bx_27;
	if (bx_39 < 0x02)
		bx_39.u0 = 0x02;
	if (bx_39 > 0xBD)
		bx_39.u0 = 0xBD;
	ds->t0126 = bx_39;
	if (ds->w0138 == 0x00)
	{
		Eq_118 ax_54 = (word16) ds->t012E + ds->w0132;
		ds->t012E = ax_54;
		if (ax_54 == 0x02)
			ds->w0132 = 0x01;
		if (ax_54 == 0xC6)
			ds->w0132 = ~0x00;
		int16 cx_68 = ds->w012C + ds->w0130;
		ds->w012C = cx_68;
		if (cx_68 == 0x02 && (ax_54 >= bx_39 && ax_54 < (word16) bx_39.u0 + 0x0A))
			ds->w0130 = 0x01;
		Eq_118 bx_83 = ds->t0128;
		if (cx_68 == 0x013D && (ax_54 >= bx_83 && ax_54 < (word16) bx_83.u0 + 0x0A))
			ds->w0130 = ~0x00;
		if (cx_68 != 0x00)
		{
			if (cx_68 == 0x013F)
			{
				ds->t013A = (word16) ds->t013A + 2;
				fn0C00_0167(es, ds);
			}
		}
		else
		{
			ds->t013C = (word16) ds->t013C + 0x0000FFFE;
			fn0C00_0167(es, ds);
		}
	}
	else
		--ds->w0138;
}

// 0C00:02A7: void fn0C00_02A7(Register (ptr16 Eq_8) es, Register (ptr16 Eq_2) ds)
// Called from:
//      fn0C00_0100
void fn0C00_02A7(struct Eq_8 * es, struct Eq_2 * ds)
{
	es->*((char *) ((word16) (ds->t0136 * 0x0140)) + ds->w0134) = 0x12;
	Eq_118 ax_14 = ds->t012E;
	ds->t0136 = ax_14;
	es->*((char *) ((word16) (ax_14 * 0x0140)) + ds->w012C) = 0x0E;
	ds->w0134 = ds->w012C;
	struct Eq_329 Eq_8::* ax_28 = (word16) ((ds->t0126 - 0x01) * 0x0140);
	(es->*ax_28).b0001 = 0x12;
	struct Eq_341 Eq_8::* bx_31 = &ax_28->b0001;
	word16 cx_33;
	for (cx_33 = 0x0A; cx_33 != 0x00; --cx_33)
	{
		++bx_31;
		(es->*bx_31).b0000 = 0x0A;
	}
	bx_31[1] = 0x12;
	struct Eq_359 Eq_8::* ax_48 = (word16) ((ds->t0128 - 0x01) * 0x0140);
	(es->*ax_48).b013E = 0x12;
	struct Eq_371 Eq_8::* bx_51 = &ax_48->b013E;
	word16 cx_53;
	for (cx_53 = 0x0A; cx_53 != 0x00; --cx_53)
	{
		++bx_51;
		(es->*bx_51).b0000 = 0x0C;
	}
	bx_51[1] = 0x12;
}

