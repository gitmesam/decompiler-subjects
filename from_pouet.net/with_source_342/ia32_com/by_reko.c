// subject_code.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject_code.h"

// 0C00:0100: void fn0C00_0100(Register (ptr16 Eq_2) es, Register (ptr16 Eq_3) ds)
void fn0C00_0100(struct Eq_2 * es, struct Eq_3 * ds)
{
	struct Eq_4 * fs_8 = fn0C00_012B(es);
	fn0C00_0344(es, ds);
	struct Eq_14 * es_28 = fn0C00_0138(ds);
	fn0C00_01CE();
	do
	{
		fn0C00_01AF(es_28, ds);
		fn0C00_01FE(ds);
		fn0C00_0251(es_28, ds);
		es_28 = fn0C00_02D9(ds, fs_8);
		fn0C00_02A6(es_28, ds);
		fn0C00_01A4(ds);
	} while (__inb(0x60) != 0x01);
	bios_video_set_mode(0x03);
	msdos_terminate_program20();
}

// 0C00:012B: Register (ptr16 Eq_65) fn0C00_012B(Register (ptr16 Eq_2) es)
// Called from:
//      fn0C00_0100
struct Eq_65 * fn0C00_012B(struct Eq_2 * es)
{
	byte Eq_2::* di_14 = Eq_2::a04E8;
	word16 cx_17;
	for (cx_17 = 12233; cx_17 != 0x00; --cx_17)
	{
		es->*di_14 = 0x00;
		++di_14;
	}
	return 0x00;
}

// 0C00:0138: Register (ptr16 Eq_81) fn0C00_0138(Register (ptr16 Eq_3) ds)
// Called from:
//      fn0C00_0100
struct Eq_81 * fn0C00_0138(struct Eq_3 * ds)
{
	__syscall(0x10);
	__outb(0x03C8, 0x00);
	word16 cx_10;
	for (cx_10 = 0x0300; cx_10 != 0x00; --cx_10)
		__outb(969, 0x00);
	__outw(0x03C4, 0x0604);
	__outw(0x03D4, 0x14);
	__outw(0x03D4, 58135);
	__outw(0x03D4, 0x4013);
	__outw(0x03C4, 0x0F02);
	word32 Eq_81::* di_34 = Eq_81::a0000;
	word16 cx_35;
	for (cx_35 = 0x4000; cx_35 != 0x00; --cx_35)
	{
		0xA000->*di_34 = 0x00;
		++di_34;
	}
	fn0C00_017F(0x00, ds);
	ds->t04E8.u0 = 0x8000;
	return 0xA000;
}

// 0C00:017F: Register Eq_133 fn0C00_017F(Register Eq_133 ax, Register (ptr16 Eq_3) ds)
// Called from:
//      fn0C00_0138
//      fn0C00_01A4
Eq_133 fn0C00_017F(Eq_133 ax, struct Eq_3 * ds)
{
	byte ah_24 = SLICE(ax, byte, 8);
	ds->t04EA = ax;
	do
		;
	while ((__inb(0x03DA) & 0x08) == 0x00);
	do
		;
	while ((__inb(0x03DA) & 0x08) != 0x00);
	__cli();
	ui16 ax_25 = SEQ(ah_24, 0x0C);
	__outw(0x03D4, ax_25);
	Eq_133 ah_32 = ds->t04EA;
	__outw(0x03D4, ax_25 + 0x01);
	__sti();
	do
	{
		byte al_35 = __inb(0x03DA);
		Eq_133 ax_41 = SEQ(ah_32, al_35);
	} while ((al_35 & 0x08) == 0x00);
	return ax_41;
}

// 0C00:01A4: void fn0C00_01A4(Register (ptr16 Eq_3) ds)
// Called from:
//      fn0C00_0100
void fn0C00_01A4(struct Eq_3 * ds)
{
	Eq_133 v5_7 = ds->t04E8;
	ds->t04E8 = ds->t04EA;
	fn0C00_017F(v5_7, ds);
}

// 0C00:01AF: void fn0C00_01AF(Register (ptr16 Eq_14) es, Register (ptr16 Eq_3) ds)
// Called from:
//      fn0C00_0100
void fn0C00_01AF(struct Eq_14 * es, struct Eq_3 * ds)
{
	__outw(0x03C4, 0x0F02);
	byte ch_30 = 0x00;
	Eq_133 di_11 = ds->t04E8;
	byte dl_12;
	for (dl_12 = 200; dl_12 != 0x00; --dl_12)
	{
		word16 cx_17 = SEQ(ch_30, 0x14);
		while (true)
		{
			ch_30 = SLICE(cx_17, byte, 8);
			if (cx_17 == 0x00)
				break;
			es->*di_11 = 0x00;
			di_11 = (word16) di_11 + 4;
			--cx_17;
		}
		di_11 = (word16) di_11 + 48;
	}
}

// 0C00:01CE: void fn0C00_01CE()
// Called from:
//      fn0C00_0100
void fn0C00_01CE()
{
	__outb(0x03C8, 0x00);
	byte ah_12 = 0x00;
	word16 cx_11;
	cui16 bx_55 = 0x00;
	for (cx_11 = 0x40; cx_11 != 0x00; --cx_11)
	{
		fn0C00_01F4(ah_12, 969, SLICE(bx_55, byte, 8), (byte) bx_55);
		++ah_12;
		bx_55 += 0x0101;
	}
	byte bl_32 = 0x00;
	word16 cx_28;
	for (cx_28 = 0x40; cx_28 != 0x00; --cx_28)
	{
		fn0C00_01F4(0x00, 969, 0x00, bl_32);
		++bl_32;
	}
}

// 0C00:01F4: Register byte fn0C00_01F4(Register byte ah, Register word16 dx, Register byte bh, Register byte bl)
// Called from:
//      fn0C00_01CE
byte fn0C00_01F4(byte ah, word16 dx, byte bh, byte bl)
{
	__outb(dx, ah);
	__outb(dx, bh);
	__outb(dx, bl);
	return bl;
}

// 0C00:01FE: void fn0C00_01FE(Register (ptr16 Eq_3) ds)
// Called from:
//      fn0C00_0100
void fn0C00_01FE(struct Eq_3 * ds)
{
	ds->t04EC = (word16) ds->t04EC + 6;
	ds->t04EC &= 0x7F;
	Eq_291 bx_12 = ds->t04EC;
	word16 Eq_3::* di_13 = Eq_3::a04F0;
	word16 cx_14 = 0x80;
	do
	{
		ds->*di_13 = (int16) (byte) ((int16) (ds->*((word16) bx_12 + 1121)) *s 0x08 >> 0x07) << 0x07;
		--cx_14;
		++di_13;
		bx_12 = (word16) bx_12 + 1 & 0x7F;
		byte ch_58 = SLICE(cx_14, byte, 8);
	} while (cx_14 != 0x00);
	Eq_334 bx_35 = (word16) ds->t04EC.u0 + 32 & 0x7F;
	byte Eq_3::* di_38 = Eq_3::a05F0;
	word16 cx_56;
	do
	{
		ds->*di_38 = (byte) (int16) (byte) ((int16) (ds->*((word16) bx_35 + 1121)) *s 22 >> 0x07);
		++di_38;
		bx_35 = (word16) bx_35 + 1 & 0x7F;
		--cx_56;
	} while (cx_56 != 0x00);
}

// 0C00:0251: void fn0C00_0251(Register (ptr16 Eq_14) es, Register (ptr16 Eq_3) ds)
// Called from:
//      fn0C00_0100
void fn0C00_0251(struct Eq_14 * es, struct Eq_3 * ds)
{
	Eq_133 di_6 = ds->t04E8;
	ui8 ah_26 = 0x01;
	word16 bp_10;
	Eq_377 bx_12 = 0x00;
	for (bp_10 = 0x04; bp_10 != 0x00; --bp_10)
	{
		__outw(0x03C4, SEQ(ah_26, 0x02));
		word16 di_22 = (word16) di_6 + 0x0A18;
		byte Eq_3::* si_19 = &Eq_3::b0670;
		word16 cx_28 = 0x20;
		bx_41 = bx_12;
		do
		{
			Eq_377 bx_41;
			struct Eq_385 Eq_14::* di_44 = di_22 + ds->*((word16) bx_41 + 0x04F0);
			byte dl_46 = ds->*((word16) (bx_41 >> 0x01) + 0x05F0);
			word16 cx_49;
			si_51 = si_19;
			for (cx_49 = 0x48; cx_49 != 0x00; --cx_49)
			{
				byte Eq_3::* si_51;
				(es->*di_44).b0000 = ds->*si_51 + dl_46;
				++si_51;
				++di_44;
			}
			si_19 += 288;
			bx_41 = (word16) bx_41 + 8;
			++di_22;
			cx_28 = cx_131 - 0x01;
			cx_131 = cx_28;
		} while (cx_131 != 0x01);
		bx_12 = (word16) bx_12 + 2;
		ah_26 <<= 0x01;
	}
}

// 0C00:02A6: void fn0C00_02A6(Register (ptr16 Eq_14) es, Register (ptr16 Eq_3) ds)
// Called from:
//      fn0C00_0100
void fn0C00_02A6(struct Eq_14 * es, struct Eq_3 * ds)
{
	__outw(0x03C4, 0x0102);
	struct Eq_444 Eq_3::* si_19 = &Eq_3::t2A70;
	ui8 ah_54 = 0x01;
	struct Eq_448 Eq_14::* di_10 = (word16) ds->t04E8 + 0x00005500;
	word16 bp_12;
	for (bp_12 = 0x04; bp_12 != 0x00; --bp_12)
	{
		struct Eq_448 Eq_14::* di_15 = di_10;
		word16 cx_21 = 0x08;
		si_29 = si_19;
		do
		{
			struct Eq_444 Eq_3::* si_29;
			word16 cx_27;
			for (cx_27 = 0x52; cx_27 != 0x00; --cx_27)
			{
				(es->*di_15).b0000 = (ds->*si_29).b0000;
				di_15 = &di_15->b0000 + 1;
				++si_29;
			}
			++di_15;
			cx_21 = cx_95 - 0x01;
			cx_95 = cx_21;
		} while (cx_95 != 0x01);
		ah_54 <<= 0x01;
		__outw(0x03C4, SEQ(ah_54, 0x02));
		si_19 = &si_19->b0000 + 1;
	}
}

// 0C00:02D9: Register (ptr16 Eq_495) fn0C00_02D9(Register (ptr16 Eq_3) ds, Register (ptr16 Eq_4) fs)
// Called from:
//      fn0C00_0100
struct Eq_495 * fn0C00_02D9(struct Eq_3 * ds, struct Eq_4 * fs)
{
	byte Eq_513::* di_10 = Eq_513::a2A70;
	byte Eq_3::* si_11 = Eq_3::a2A72;
	word16 cx_12;
	for (cx_12 = 0x0A40; cx_12 != 0x00; --cx_12)
	{
		cs->*di_10 = ds->*si_11;
		++si_11;
		++di_10;
	}
	word16 v11_16 = ds->w045F - 0x01;
	ds->w045F = v11_16;
	if (v11_16 != 0x00)
		return;
	ds->w045F = 0x04;
	Eq_528 gs_ax_25 = fs->t010C;
	struct Eq_531 * gs_88 = SLICE(gs_ax_25, selector, 16);
	Eq_533 bx_27 = ((word16) (ds->*((word16) ds->t04EE + 955)) << 0x03) + (word16) gs_ax_25;
	struct Eq_544 Eq_513::* di_29 = &Eq_513::t2BB0;
	word16 cx_30;
	for (cx_30 = 0x08; cx_30 != 0x00; --cx_30)
	{
		ci16 dx_31;
		for (dx_31 = 0x07; dx_31 >= 0x00; --dx_31)
		{
			(cs->*di_29).b0000 = __bt(gs_88->*bx_27, dx_31) << 0x05;
			di_29 = &di_29->b0000 + 1;
		}
		++di_29;
		bx_27 = (word16) bx_27 + 1;
	}
	ds->t04EE = (word16) ds->t04EE + 1;
	if (ds->t04EE > 0xA3)
		ds->t04EE.u0 = 0x00;
	return;
}

// 0C00:0344: void fn0C00_0344(Register (ptr16 Eq_2) es, Register (ptr16 Eq_3) ds)
// Called from:
//      fn0C00_0100
void fn0C00_0344(struct Eq_2 * es, struct Eq_3 * ds)
{
	byte Eq_2::* di_36 = &Eq_2::b0670;
	cu16 bp_42;
	for (bp_42 = 0x80; bp_42 != 0x00; --bp_42)
	{
		cu16 cx_41 = 0x48;
		do
		{
			es->*di_36 = (((ds->a0387[0x08 - (cx_60 - 0x01 >> 0x03)] & 0x80000000 >> (byte) (0x1F - (bp_42 - 0x01 >> 0x02))) == 0x00 ^ 0x01) << 0x06) + 0x29;
			++di_36;
			cx_41 = cx_60 - 0x01;
			cx_60 = cx_41;
		} while (cx_60 != 0x01);
	}
}

