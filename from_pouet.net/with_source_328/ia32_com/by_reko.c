// subject_code.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject_code.h"

// 0C00:0100: void fn0C00_0100(Register byte cl, Register (ptr16 Eq_3) es, Register (ptr16 Eq_4) ds)
void fn0C00_0100(byte cl, struct Eq_3 * es, struct Eq_4 * ds)
{
	Eq_5 Top_148 = 0;
	__syscall(0x10);
	byte Eq_3::* di_279 = Eq_3::a0300;
	struct Eq_14 * gs_15 = 0xA000;
	word16 cx_16;
	for (cx_16 = SEQ(0xA0, cl); cx_16 != 0x00; --cx_16)
	{
		es->*di_279 = 0x00;
		++di_279;
	}
	__outb(0x03C8, 0x00);
	do
	{
		bcu8 al_23 = -(byte) cx_372;
		__outb(969, al_23 >> 0x02);
		__outb(969, al_23 >> 0x03);
		__outb(969, al_23 >> 0x04);
		Eq_55 ch_288 = SLICE(cx_372 - 0x01, byte, 8);
		cx_16 = cx_372 - 0x01;
		cx_372 = cx_16;
	} while (cx_372 != 0x01);
	do
	{
		ss->t0302.u0 = 33;
		struct Eq_141 Eq_4::* di_149 = &Eq_4::t0337;
		do
		{
			ss->t0304.u0 = 0x41;
			--ss->t0302;
			do
			{
				__fninit();
				struct Eq_65 * Top_61 = Top_148 - 1;
				Top_61->r0000 = (real64) ss->w02FE;
				Top_61->rFFFFFFFF = 3.14159265358979;
				Top_61->rFFFFFFFF *= (real64) ss->t0302;
				Top_61->rFFFFFFFF /= Top_61->r0000;
				real64 v21_70 = Top_61->rFFFFFFFF;
				Top_61->rFFFFFFFF = cos(v21_70);
				Top_61->rFFFFFFFE = sin(v21_70);
				Top_61->rFFFFFFFE *= Top_61->r0000;
				Top_61->rFFFFFFFE += (real64) ss->w02F8;
				(ds->*di_149).w0002 = (int16) Top_61->rFFFFFFFE;
				Top_61->rFFFFFFFE += (real64) ss->t0306;
				Top_61->rFFFFFFFD = 3.14159265358979;
				Top_61->rFFFFFFFC = (real64) ss->t0306;
				Top_61->rFFFFFFFC /= Top_61->r0000;
				Top_61->rFFFFFFFC += (real64) ss->t0304;
				Top_61->rFFFFFFFD *= Top_61->rFFFFFFFC;
				Top_61->rFFFFFFFD /= Top_61->r0000;
				real64 v23_89 = Top_61->rFFFFFFFD;
				Top_61->rFFFFFFFD = cos(v23_89);
				Top_61->rFFFFFFFC = sin(v23_89);
				Top_61->rFFFFFFFC *= (real64) ss->w02F6;
				Top_61->rFFFFFFFC *= Top_61->rFFFFFFFF;
				ss->w0308 = (int16) Top_61->rFFFFFFFC;
				Top_61->rFFFFFFFD *= Top_61->r0000;
				Top_61->rFFFFFFFD *= Top_61->rFFFFFFFF;
				Top_61->rFFFFFFFC = (real64) ss->t0306;
				Top_61->rFFFFFFFC += (real64) ss->w0308;
				Top_61->rFFFFFFFB = 3.14159265358979;
				Top_61->rFFFFFFFC *= Top_61->rFFFFFFFB;
				Top_61->rFFFFFFFC /= (real64) ss->w02FC;
				real64 v24_107 = Top_61->rFFFFFFFC;
				Top_61->rFFFFFFFC = cos(v24_107);
				Top_61->rFFFFFFFB = sin(v24_107);
				Top_61->rFFFFFFFB *= Top_61->r0000;
				Top_61->rFFFFFFFB += (real64) (ds->*di_149).w0002;
				(ds->*di_149).w0002 = (int16) Top_61->rFFFFFFFB;
				Top_61->rFFFFFFFC *= Top_61->r0000;
				Top_61->rFFFFFFFD += Top_61->rFFFFFFFC;
				(ds->*di_149).w0004 = (int16) Top_61->rFFFFFFFD;
				Top_61->rFFFFFFFD = 3.14159265358979;
				Top_61->rFFFFFFFD *= (real64) ss->t030A;
				Top_61->rFFFFFFFD /= (real64) ss->w02FC;
				real64 v25_124 = Top_61->rFFFFFFFD;
				Top_61->rFFFFFFFD = cos(v25_124);
				Top_61->rFFFFFFFC = sin(v25_124);
				Top_61->rFFFFFFFB = (real64) ss->w0308;
				Top_61->rFFFFFFFB *= Top_61->rFFFFFFFC;
				Top_61->rFFFFFFFA = (real64) (ds->*di_149).w0004;
				Top_61->rFFFFFFFA *= Top_61->rFFFFFFFD;
				Top_61->rFFFFFFFB += Top_61->rFFFFFFFA;
				Top_61->rFFFFFFFB += (real64) ss->w02FA;
				(ds->*di_149).w0000 = (int16) Top_61->rFFFFFFFB;
				Top_61->rFFFFFFFB = (real64) (ds->*di_149).w0004;
				Top_61->rFFFFFFFB *= Top_61->rFFFFFFFC;
				Top_61->rFFFFFFFA = (real64) ss->w0308;
				Top_61->rFFFFFFFA *= Top_61->rFFFFFFFD;
				Top_61->rFFFFFFFB -= Top_61->rFFFFFFFA;
				(ds->*di_149).w0004 = (int16) Top_61->rFFFFFFFB;
				Eq_179 v26_151 = ss->t0304 - 0x01;
				ss->t0304 = v26_151;
				Top_148 = Top_61 - 4;
				++di_149;
			} while (v26_151 != 0x00);
		} while (ss->t0302 != ch_288);
		struct Eq_547 Eq_4::* di_161 = &Eq_4::t0337;
		byte ch_164 = 0x20;
		do
		{
			word16 cx_186 = SEQ(ch_164, 0x40);
			do
			{
				cx_316 = SEQ(ch_315, cl_242 - 0x01);
				Eq_557 eax_169 = (ds->*di_371).t0000.dw0000;
				ds->a030F[0].dw0000 = eax_169;
				ds->t031F.dw0000 = eax_169;
				ds->dw0313 = (ds->*di_371).dw0006;
				ds->dw0317 = (ds->*di_371).dw018C;
				word32 eax_177 = (ds->*di_371).dw0186;
				ds->dw031B = eax_177;
				fn0C00_0241(((ds->*di_371).w0004 + 0x8A >> 0x01) + SEQ(SLICE(eax_177, byte, 8), (SLICE(cx_186, byte, 8) & 0x04) << 0x03), Eq_4::a030F, cs, ds);
				byte cl_242 = (byte) cx_186;
				byte ch_248 = SLICE(cx_186, byte, 8);
				byte ch_315 = SLICE(cx_186, byte, 8);
				di_161 = (struct Eq_547 Eq_4::*) &di_371->dw0006;
				di_371 = di_161;
				cx_186 = cx_316;
			} while (cl_242 != 0x01);
			di_161 = (struct Eq_547 Eq_4::*) ((char *) &di_371->dw0006 + 6);
			ch_164 = ch_248 - 0x01;
		} while (ch_248 != 0x01);
		ss->t0306.u1 = (byte) ss->t0306.u1 + 3;
		ss->t030A.u0 = (byte) ss->t030A.u0 + 1;
		byte Eq_14::* di_256 = Eq_14::a0000;
		word16 cx_270 = SEQ(~0x05, cl_242 - 0x01);
		do
		{
			gs_15->*di_256 = cs->*di_256;
			cs->*di_256 = 0x00;
			--cx_270;
			++di_256;
			ch_288.u0 = SLICE(cx_270, byte, 8);
		} while (cx_270 != 0x00);
	} while (__inb(0x60) != 0x01);
	bios_video_set_mode(0x03);
}

// 0C00:0241: void fn0C00_0241(Register Eq_584 bpl, Register (memptr (ptr16 Eq_4) Eq_585) si, Register (ptr16 Eq_14) es, Register (ptr16 Eq_4) ds)
// Called from:
//      fn0C00_0100
void fn0C00_0241(Eq_584 bpl, struct Eq_585 Eq_4::* si, struct Eq_14 * es, struct Eq_4 * ds)
{
	Eq_672 ax_15 = si[1];
	Eq_672 bx_14 = si[3];
	Eq_672 cx_21 = si[5];
	Eq_672 dx_10 = si[7];
	if (ax_15 < bx_14)
	{
		bx_14 = ax_15;
		ax_15 = bx_14;
	}
	if (ax_15 < cx_21)
	{
		cx_21 = ax_15;
		ax_15 = cx_21;
	}
	if (ax_15 < dx_10)
	{
		dx_10 = ax_15;
		ax_15 = dx_10;
	}
	if (bx_14 < cx_21)
	{
		cx_21 = bx_14;
		bx_14 = cx_21;
	}
	if (bx_14 < dx_10)
		dx_10 = bx_14;
	if (cx_21 < dx_10)
		dx_10 = cx_21;
	cup16 ax_62 = ax_15 - dx_10;
	if (ax_62 != 0x00)
	{
		ui16 di_150 = (dx_10 << 0x06) * 0x05;
		word16 Eq_4::* bx_87 = Eq_4::a0323;
		word16 cx_100 = 0x08;
		do
		{
			++si;
			ds->*bx_87 = (ds->*si).w0000 - si[1];
			--cx_100;
			++bx_87;
			ui8 cl_101 = (byte) cx_100;
		} while (cx_100 != 0x00);
		ds->b030C = cl_101;
		byte cl_231 = (byte) ax_62;
		Eq_672 si_107 = dx_10;
		do
		{
			struct Eq_732 Eq_4::* bx_109 = &Eq_4::t0311;
			word16 cx_158 = SEQ(0x04, cl_231);
			do
			{
				byte ch_213 = SLICE(cx_158, byte, 8);
				ch_213 = SLICE(cx_158, byte, 8);
				ch_213 = SLICE(cx_158, byte, 8);
				byte cl_226 = (byte) cx_158;
				cl_226 = (byte) cx_158;
				cl_226 = (byte) cx_158;
				if (si_107 >= (ds->*bx_109).t0000 && si_107 < bx_109[1] || si_107 >= bx_109[1] && si_107 < (ds->*bx_109).t0000)
				{
					Eq_741 ax_139 = (int16) ((ds->*bx_109).w0012 *s (si_107 - (ds->*bx_109).t0000) / bx_109[5]) + (ds->*bx_109).wFFFFFFFE;
					ds->b030C = ds->b030C ^ 0x01;
					if (ds->b030C != 0x00)
						ds->t02D5 = ax_139;
					else
					{
						Eq_741 cx_161 = 0x5555;
						if (ax_139 >= 0x5555)
						{
							cx_161 = ax_139;
							ax_139.u0 = 0x5555;
						}
						Eq_808 di_169 = (word16) ax_139 + di_150;
						word16 cx_173;
						cu8 al_277 = (byte) bp;
						do
						{
							if (al_277 >= es->*di_169)
								es->*di_169 = al_277;
							di_169 = (word16) di_169 + 1;
							--cx_173;
						} while (cx_173 != 0x00);
						ch_213 = SLICE(cx_158, byte, 8);
						cl_226 = (byte) cx_158;
						di_150 += 0x0140;
					}
				}
				byte ch_218 = ch_213 - 0x01;
				++bx_109;
				cx_158 = SEQ(ch_218, cl_226);
			} while (ch_218 != 0x00);
			si_107 = (word16) si_107 + 1;
			cl_231 = cl_226 - 0x01;
		} while (cl_231 != 0x00);
	}
}

