// subject_code.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject_code.h"

// 0C00:0100: void fn0C00_0100(Register byte bh, Register byte bl)
void fn0C00_0100(byte bh, byte bl)
{
	__syscall(0x10);
	__syscall(0x10);
	Eq_12 sp_16 = fp;
	Eq_14 di_17 = 0x0FB2;
	Eq_14 si_18 = 0x0FB2;
	word16 cx_19 = 0x1C;
	do
	{
		di_17 -= 0x50;
		do
		{
			0xB800->*di_17 = 2234;
			struct Eq_57 Eq_12::* di_31 = (word16) di_17 + 2;
			(0xB800->*di_31).wFFFFFFE8 = 2234;
			bl += 0x40;
			si_18 -= 100;
			byte al_44 = ~0x45;
			di_17 = di_31 - 22;
			word16 dx_36;
			for (dx_36 = 0x0A; dx_36 != 0x00; --dx_36)
			{
				0xB800->*((word16) di_17 + 2241) |= 0x08;
				al_44 &= 0xB800->*((word16) si_18 + 1);
				0xB800->*di_17 = 0xB800->*si_18;
				si_18 = (word16) si_18 + 2;
				di_17 = (word16) di_17 + 2;
			}
		} while ((al_44 & 0x08) != 0x00);
		--cx_19;
		byte ch_153 = SLICE(cx_19, byte, 8);
	} while (cx_19 != 0x00);
	if (si_18 != di_17)
	{
		bl -= 0x20;
		sp_16 = fp - 0x01;
	}
	uint32 dx_ax_79 = di_17 * SEQ(0x5A, __inb(0x40));
	Eq_12 dx_80 = SLICE(dx_ax_79, word16, 16);
	byte ah_121 = SLICE(dx_ax_79, byte, 8);
	Eq_12 bp_273 = dx_80;
	Eq_12 di_130 = 0x0785;
	Eq_12 si_250 = 0xB800;
	word16 bx_105 = SEQ(bh, bl);
	Eq_100 cx_154 = SEQ(ch_153, ss->*((word16) dx_80 - 0x0078));
	if (bl != 0x00)
	{
		union Eq_12 Eq_101::* sp_97 = sp_16 - 2;
		(ss->*sp_97).u0 = 0x0785;
		word16 di_108 = 0x0FB2;
		bh = SLICE(bx_105 - 0x01, byte, 8);
		do
		{
			struct Eq_133 Eq_12::* di_109 = di_108 - 0x01;
			byte v24_114 = (0xB800->*di_109).bFFFFFFFF;
			(0xB800->*di_109).bFFFFFFFF = 0x30;
			di_108 = di_109 - 0x01;
			word16 ax_122 = SEQ(ah_121, v24_114 | 0x10);
		} while ((v24_114 | 0x10) == 0x39);
		(0xB800->*di_109).bFFFFFFFF = (byte) (ax_122 + 0x01);
		ah_121 = SLICE(ax_122 + 0x01, byte, 8);
		di_130 = ss->*sp_97;
	}
	do
		;
	while ((__inb(0x03DA) & 0x08) == 0x00);
	do
	{
		byte al_139 = __inb(0x03DA);
	} while ((al_139 & 0x08) != 0x00);
	word16 cx_612;
	fn0C00_01D9(di_130, al_139 & 0x08, cx_154, out cx_612);
	Eq_183 C_158 = <invalid>;
	word16 ax_181;
	word16 bx_183;
	Eq_100 ax_602;
	fn0C00_0000();
	byte bh_188 = SLICE(bx_183, byte, 8);
	byte al_189 = (byte) ax_181;
	byte bl_204 = (byte) bx_183;
}

// 0C00:01D9: FlagGroup Eq_183 fn0C00_01D9(Sequence Eq_175 ds_di, Register byte al, Register Eq_100 cx, Register out Eq_100 cxOut)
// Called from:
//      fn0C00_0100
Eq_183 fn0C00_01D9(Eq_175 ds_di, byte al, Eq_100 cx, union Eq_100 & cxOut)
{
	byte * bx_16 = null;
	do
	{
		cx = __ror(cx, 0x01);
		if (Test(ULT,(cx & 0x02) != 0x00))
		{
			if ((Mem18[bx_16 + ds_di:byte] & 0x08) != 0x00)
				break;
			Mem23[bx_16 + ds_di:byte] = al;
			Mem24[bx_16 - 0x01 + ds_di:byte] = ~0x24;
		}
		word16 bx_26 = bx_16 + 1;
		bx_16 = bx_26 + 0x01;
		cu8 bl_28 = (byte) (bx_26 + 0x01);
		byte bh_49 = SLICE(bx_26 + 0x01, byte, 8);
		if ((bl_28 & 0x08) == 0x00)
			continue;
		bx_16 = SEQ(bh_49, bl_28 + 0x48);
	} while (bl_28 >= 0x48);
	cxOut = cx;
	return <invalid>;
}

