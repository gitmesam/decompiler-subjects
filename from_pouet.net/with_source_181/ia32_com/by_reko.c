// subject_code.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject_code.h"

// 0C00:0100: void fn0C00_0100(Register word16 bx, Register word16 esp_16_16, Register (memptr (ptr16 Eq_153) byte) di, Register (ptr16 Eq_5) ds)
void fn0C00_0100(word16 bx, word16 esp_16_16, byte Eq_153::* di, struct Eq_5 * ds)
{
	__syscall(0x10);
	int16 Eq_5::* si_10 = &Eq_5::w0195;
	int16 Eq_5::* bp_11 = &Eq_5::w0199;
	word16 cx_12 = 0x00;
	do
	{
		do
		{
			real64 rLoc1_159 = (real64) (ss->*SEQ(esp_16_16, fp - 2));
			real64 rLoc3_163 = (real64) (ss->*SEQ(esp_16_16, fp - 4));
			int16 Eq_18::* esp_63 = SEQ(esp_16_16, fp - 6);
			uint16 dx_22 = (uint16) ((uint32) di % ds->t0197);
			real64 rLoc3_175 = ((real64) ds->t0197 / (rLoc3_163 * rLoc3_163 + rLoc1_159 * rLoc1_159) + (real64) (ss->*esp_63)) / (real64) ds->t0197;
			real64 rLoc3_182 = sin(rLoc3_175) * (real64) (ds->*si_10) + cos(rLoc3_175) * (real64) (ds->*si_10);
			real64 rLoc3_183 = rLoc3_182 * rLoc3_182;
			real64 rLoc2_189 = atan(rLoc3_183, rLoc1_159) * (real64) (ds->*si_10);
			real64 rLoc3_191 = (real64) (ss->*esp_63) / (real64) ds->w011D;
			real64 rLoc2_197 = pow(2.0, sin(rLoc2_189 + (rLoc3_191 + sin(rLoc3_191)))) - 1.0;
			ss->*SEQ(esp_16_16, fp - 2) = (int16) (sqrt(rLoc3_183 + rLoc2_197 * rLoc2_197) * (real64) ds->w011D);
			byte al_115 = (byte) (dx_22 - 0x80);
			byte ah_116 = SLICE(dx_22 - 0x80, byte, 8);
			__aas(al_115, ah_116, &al_115, &ah_116);
			0xA000->*di = al_115 + 0x0C;
			++di;
			--cx_12;
		} while (cx_12 != 0x00);
		word16 bx_125 = bx + 0x01;
		bx = bx_125;
		if ((byte) bx_125 == 0x00)
		{
			si_10 = bp_11;
			bp_11 = si_10;
		}
	} while (__inb(0x60) != 0x01);
}

