// subject_code.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject_code.h"

// 0C00:0100: void fn0C00_0100(Register word16 cx, Register byte dh, Register byte dl, Register (ptr16 Eq_5) ds)
void fn0C00_0100(word16 cx, byte dh, byte dl, struct Eq_5 * ds)
{
	Eq_6 Top_271 = 0;
	__syscall(0x10);
	struct Eq_13 * dx_7 = SEQ(dh + 0x10, dl);
	struct Eq_13 * dx_11 = SEQ(dh + 0x20, dl);
	word16 cx_382 = cx;
	do
	{
		uint8 cl_15 = (byte) cx_390;
		__outb(0x03C8, cl_15);
		int16 ax_18 = (int16) cl_15;
		bcu8 al_19 = (byte) ax_18;
		__outb(969, al_19 >> 0x01);
		__outb(969, al_19 >> 0x01);
		__outb(969, al_19 >> 0x01 & SLICE(ax_18, byte, 8));
		cx_382 = cx_390 - 0x01;
		cx_390 = cx_382;
	} while (cx_390 != 0x01);
	do
	{
		--ds->w01FD;
		struct Eq_59 * es_365 = ds->ptr0002;
		Eq_62 bx_385 = 0x00;
		do
		{
			byte bh_284 = SLICE(bx_389, byte, 8);
			struct Eq_69 Eq_5::* di_148 = &Eq_5::t0402;
			byte al_38 = (byte) bx_389;
			word16 dx_39 = 0xF400;
			do
			{
				int16 ax_42 = (int16) (al_38 - 0x80);
				(ds->*di_148).t0000 = ax_42;
				bi8 al_46 = (byte) ax_42;
				--Top_271;
				*Top_271 = (real64) (ds->*di_148).t0000;
				dx_39 -= al_46 *s al_46;
				cu8 dh_69 = SLICE(dx_39, byte, 8);
				al_38 = bh_284;
				++di_148;
			} while (P);
			*((word32) Top_271 + 1) = atan(*((word32) Top_271 + 2), *((word32) Top_271 + 1));
			*((word32) Top_271 + 1) *= (real64) ds->w01FB;
			(ds->*di_148).t0000 = (int16) *((word32) Top_271 + 1);
			word16 ax_65 = (ds->*di_148).t0000 + ds->w01FC;
			cui16 ax_72 = SEQ(SLICE(ax_65, byte, 8), dh_69);
			Top_271 = (word32) Top_271 + 2;
			byte ah_66 = SLICE(ax_65, byte, 8);
			byte cl_114 = 0x00;
			byte dh_102 = (byte) (ax_72 & 0x0707) + SLICE(ax_72 & 0x0707, byte, 8) + dh_69;
			if (dh_69 >= ~0x10)
				cl_114 = 0x50;
			if (dh_69 <= ~0x15)
			{
				word16 cx_100 = SEQ(ah_66 & 0x1F, cl_114);
				if ((ah_66 & 0x1F) <= 0x03)
				{
					if (dh_69 >= 233)
					{
						dh_102 = __ror(dh_69, 0x03) + 155;
						--cx_100;
					}
					dh_102 -= 0x14;
				}
				cl_114 = (byte) cx_100;
				if (dh_69 <= 0xB4)
					cl_114 = (byte) (cx_100 - 0x01);
			}
			dx_11->*bx_389 = cl_114;
			dx_7->*bx_389 = dh_102 + 0x80;
			bx_385 = (word16) bx_389 + 1;
			bx_389 = bx_385;
		} while (bx_389 != 0x01);
		word16 si_144;
		for (si_144 = ~0x63; si_144 != 100; ++si_144)
		{
			word16 bp_145;
			for (bp_145 = ~0x9F; bp_145 != 0xA0; ++bp_145)
			{
				int32 dx_ax_157 = (int32) (int16) (byte) (ds->w01FD << 0x01);
				bi8 al_162 = ((byte) dx_ax_157 & 0x7F) - 0x40;
				int16 ax_163 = al_162 *s al_162;
				word16 cx_151 = 0x7F40;
				ui16 dx_167 = SLICE(dx_ax_157, word16, 16) ^ ax_163;
				ui16 di_175 = ax_163 * 0x02;
				do
				{
					cx_151 += bp_145;
					di_175 -= 0x96;
					ui16 dx_181 = dx_167 + si_144;
					char Eq_13::* bx_189 = SEQ(SLICE(di_175, byte, 8), SLICE(cx_151, byte, 8));
					byte cl_351 = (byte) cx_151;
					cl_351 = (byte) cx_151;
					char dh_198 = SLICE(dx_181, byte, 8);
					char ah_191 = dx_11->*bx_189;
					char al_193 = dx_7->*bx_189;
					if (ah_191 < 0x00)
						break;
					if (ah_191 != 0x00)
					{
						dx_167 = dx_181;
						if (dh_198 < ah_191)
							continue;
						if (dh_198 >= ah_191)
							al_193 += ah_191;
					}
					dx_167 = dx_181;
				} while (dh_198 <= 0x46);
				(ds->*di_148).t0000 = al_193;
				++di_148;
			}
		}
		word16 Eq_59::* di_234 = Eq_59::a0000;
		word16 Eq_5::* si_237 = Eq_5::a0404;
		word16 cx_239;
		for (cx_239 = SEQ(0x7D, cl_351); cx_239 != 0x00; --cx_239)
		{
			es_365->*di_234 = ds->*si_237;
			++si_237;
			++di_234;
		}
	} while (SEQ(ah_191, __inb(0x60)) != 0x01);
}

