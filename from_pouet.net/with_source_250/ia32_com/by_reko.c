// subject_code.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject_code.h"

// 0C00:0100: void fn0C00_0100(Register Eq_2 si, Register (ptr16 Eq_3) ds)
void fn0C00_0100(Eq_2 si, struct Eq_3 * ds)
{
	__syscall(0x10);
	do
	{
		Eq_10 di_17 = 0x00;
		do
		{
			byte al_23 = (byte) di_17;
			byte bh_30 = SLICE(di_17, byte, 8);
			Mem37[cs + 0x1000:di_17 + 0x00:byte] = SLICE((bh_30 << 0x02) *s (bh_30 << 0x02) + (al_23 << 0x02) *s (al_23 << 0x02), byte, 8);
			Eq_30 bx_38 = di_17 & ~0x0707;
			byte al_41 = Mem37[cs + 0x1000:bx_38 + 0x00:byte] + Mem37[cs + 0x1000:bx_38 + si:byte];
			Mem46[cs + 0x2000:di_17 + 0x00:byte] = SLICE(al_41 *s al_41, byte, 8);
			di_17 = (word16) di_17 + 1;
		} while (di_17 != 0x00);
		Eq_2 si_50 = (word16) si + 1;
		uint8 Eq_101::* bp_192 = Eq_101::a0140;
		do
		{
			int16 ax_58 = fn0C00_01E8(si_50);
			int16 ax_70 = fn0C00_01E8((word16) si_50 + 64);
			Eq_148 ax_81 = bp_192 - 0xA0;
			ds->w01C2 = ((word16) (ax_70 *s ax_81) >> 0x07) + ax_58;
			Eq_68 dx_295 = ax_58 *s ax_81;
			ds->w01C6 = -((word16) dx_295 >> 0x07) + ax_70;
			bcu8 bl_132 = (byte) ax_70;
			ui16 si_105 = (word16) si_50 + 64 << 0x09;
			int16 cx_103 = 0x00;
			cu8 bh_102 = 199;
			do
			{
				byte dh_107 = SLICE(dx_295, byte, 8);
				bcu8 Eq_92::* ax_110 = SEQ(SLICE(si_105, byte, 8), dh_107);
				int16 cx_104 = cx_103 + 0x01;
				byte ah_121 = Mem119[cs + 0x2000:ax_110 + 0x00:byte];
				Eq_79 ax_129 = (int16) ((uint32) (SEQ(ah_121, dh_107) + 0x1900) / cx_104);
				cu8 ch_184 = SLICE(cx_104, byte, 8);
				byte cl_240 = (byte) cx_104;
				cu8 al_139 = (byte) ax_129;
				byte ah_146 = SLICE(ax_129, byte, 8);
				word16 bx_243 = SEQ(bh_102, ah_121);
				if (ax_129 <= 199)
				{
					bx_243 = SEQ(bh_102, ah_121);
					if (al_139 < bh_102)
					{
						int16 si_153 = (ax_129 << 0x06) + SEQ(al_139, ah_146) + 1000;
						cu8 dl_154 = bh_102 - al_139;
						bx_243 = SEQ(al_139, ah_121);
						if (bl_132 == ah_121)
						{
							byte al_160 = (Mem124[cs + 0x1000:ax_110 + 0x00:byte] >>u 0x04) + 0x13;
							do
							{
								bp_192[si_153] = al_160;
								si_153 += 0x0140;
								--dl_154;
							} while (dl_154 != 0x00);
						}
					}
				}
				bl_132 = (byte) bx_243;
				bh_102 = SLICE(bx_243, byte, 8);
				si_105 += ~0x00;
				cx_103 = cx_104;
				dx_295.u1 = (word16) dx_295 + 0x0000FFFF;
			} while (ch_184 < 0x02);
			si = si_50;
			--bp_192;
		} while (bp_192 != Eq_101::a0000);
		struct Eq_172 Eq_3::* di_195 = Eq_3::a0000;
		word16 cx_212 = SEQ(~0x05, cl_240);
		do
		{
			byte v35_205 = di_195[1000];
			di_195[1000] = 0x00;
			(0xA000->*di_195).b0000 = v35_205;
			++di_195;
			--cx_212;
		} while (cx_212 != 0x00);
	} while ((uint16) __inb(0x60) != 0x01);
}

// 0C00:01E8: Register int16 fn0C00_01E8(Register Eq_2 sil)
// Called from:
//      fn0C00_0100
int16 fn0C00_01E8(Eq_2 sil)
{
	bi8 al_12 = (byte) (si << 0x01);
	int16 ax_13 = al_12 *s al_12;
	return (SEQ(SLICE(ax_13, byte, 8) - 0x40, (byte) ax_13) ^ SLICE((int32) ((int16) ((byte) (si + 0x40))), word16, 16)) >> 0x07;
}

