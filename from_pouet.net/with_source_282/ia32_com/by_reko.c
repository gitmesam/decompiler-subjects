// subject_code.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject_code.h"

// 0C00:0100: void fn0C00_0100(Register word16 cx, Register byte bl, Register (ptr16 Eq_4) ds, FpuStack real64 rLoc2)
void fn0C00_0100(word16 cx, byte bl, struct Eq_4 * ds, real64 rLoc2)
{
	__syscall(0x10);
	int16 Eq_4::* bx_24 = SEQ(0x03, bl);
	do
	{
		bx_260 = SEQ(bh_259, bl_28 + 0x01);
		rLoc2 = sin(rLoc2) * (real64) ds->w01D0 + (real64) ds->w01D0;
		ds->*bx_24 = (int16) rLoc2;
		byte bl_28 = (byte) bx_24;
		byte bh_259 = SLICE(bx_24, byte, 8);
		bx_24 = bx_260;
	} while (bl_28 != 0x01);
	do
	{
		__outb(0x03C8, 0x00);
		uint8 ah_157;
		do
		{
			uint8 al_40 = ah_157 * 0x02;
			if (al_40 > 0x3F)
				al_40 = 0x3F;
			__outb(969, al_40);
			__outb(969, ah_157);
			__outb(969, 0x00);
			++ah_157;
		} while (ah_157 != 0x00);
		do
			;
		while ((__inb(0x03DA) & 0x08) == 0x00);
		Eq_78 bp_233;
		byte Eq_149::* di_192 = &Eq_149::b0000;
		for (bp_233 = 200; bp_233 != 0x00; --bp_233)
		{
			ds->t0200 = bp_233;
			real64 rLoc2_342 = rLoc2 - ds->r01F6;
			real64 rLoc2_343 = cos(rLoc2_342);
			real64 rLoc3_344 = sin(rLoc2_342);
			real64 rLoc4_346 = rLoc2_343 + ds->r01F6;
			real64 rLoc4_347 = cos(rLoc4_346);
			real64 rLoc5_348 = sin(rLoc4_346);
			real64 rLoc6_349 = (real64) ds->w0121;
			if (bp_233 >= 100)
				rLoc6_349 = -rLoc6_349;
			real64 rLoc6_358 = (rLoc6_349 - rLoc5_348 * (real64) ds->w01FA) / ((real64) ds->t0200 - (real64) ds->w01FC);
			ds->w01B6 = (int16) rLoc6_358;
			rLoc2 = rLoc2_343 * ((((rLoc6_358 * (real64) ds->w01FE) * rLoc5_348) * rLoc4_347) * rLoc3_344);
			ds->w01D4 = (int16) ((rLoc5_348 - rLoc3_344) / (real64) ds->w019C);
			ds->w01D0 = (int16) ((rLoc4_347 - rLoc2) / (real64) ds->w019C);
			ds->t0200.u1 = (int32) rLoc3_344;
			Eq_78 dx_122 = ds->t0200;
			ds->t0200.u1 = (int32) rLoc2;
			word16 cx_133 = (word32) ds->t0200 + cx;
			cup16 si_135;
			for (si_135 = 0x0140; si_135 != 0x00; --si_135)
			{
				byte dh_136 = SLICE(dx_122, byte, 8);
				byte ch_143 = SLICE(cx_133, byte, 8);
				byte bl_150 = ch_143 - ds->*SEQ(bh_259, ch_143) + dh_136;
				ci16 ax_158 = SEQ(ah_157, ds->*SEQ(bh_259, (bl_150 + ds->*SEQ(bh_259, bl_150)) + ds->*SEQ(bh_259, (dh_136 - ds->*SEQ(bh_259, dh_136)) - ch_143)) >> 0x02);
				uint8 al_176 = (byte) (ax_158 + 4660);
				ah_157 = SLICE(ax_158 + 4660, byte, 8);
				if (ax_158 < 4660)
				{
					al_176 = 0x00;
					ah_157 = 0x00;
				}
				if (si_135 <= 0x50)
				{
					if (si_135 == 0x50 || (bp_233 & 0x88) == 0x00)
						al_176 >>= 0x01;
					al_176 >>= 0x01;
				}
				0xA000->*di_192 = al_176;
				++di_192;
				cx_133 += 0x7F;
				dx_122 = (word32) dx_122 + 4660;
			}
			byte ch_251 = SLICE(cx, byte, 8);
			byte cl_287 = (byte) cx;
		}
		cx = SEQ(ch_251 + 0x01, cl_287);
	} while (__inb(0x60) != 0x01);
}

