// subject_code.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject_code.h"

// 0C00:0100: void fn0C00_0100(Register byte ch, Register (ptr16 Eq_3) ds)
void fn0C00_0100(byte ch, struct Eq_3 * ds)
{
	__syscall(0x10);
	do
	{
		do
			;
		while ((__inb(0x03DA) & 0x08) == 0x00);
		++ds->b0206;
		ds->b0206 &= 0x0F;
		int16 bx_174 = 0x0206;
		if (ds->b0206 == 0x00)
		{
			++ds->ptr01FC;
			if (ds->ptr01FC == &Eq_3::ptr01FC)
				ds->ptr01FC -= 0x1C;
			struct Eq_58 Eq_94::* di_266 = &Eq_94::t0140;
			Eq_60 si_254 = ((word16) (ds->*ds->ptr01FC) << 0x03) + 64110;
			ds = 0xF000;
			word16 dx_52;
			for (dx_52 = 0x08; dx_52 != 0x00; --dx_52)
			{
				word16 cx_263 = SEQ(ch, 0x08);
				do
				{
					Eq_80 al_59 = (int8) __bt(0xF000->*si_254, cx_263);
					int16 ax_61 = SEQ(al_59, al_59);
					(0x5000->*di_266).w0150 = ax_61;
					(0x5000->*di_266).w0000 = ax_61;
					--cx_263;
					di_266 = &di_266->w0000 + 1;
					ch = SLICE(cx_263, byte, 8);
				} while (cx_263 != 0x00);
				si_254 = (word16) si_254 + 1;
				++di_266;
			}
		}
		--ds->dw0202;
		byte Eq_94::* si_242 = Eq_94::a0000;
		byte Eq_94::* di_246 = Eq_94::aFFFFFFFF;
		word16 cx_100;
		for (cx_100 = 0x1500; cx_100 != 0x00; --cx_100)
		{
			0x5000->*di_246 = 0x5000->*si_242;
			++si_242;
			++di_246;
		}
		byte Eq_143::* di_107 = Eq_143::a0000;
		word16 cx_111;
		for (cx_111 = 0xFA00; cx_111 != 0x00; --cx_111)
		{
			0x6000->*di_107 = 0x00;
			++di_107;
		}
		union Eq_136 Eq_94::* si_113 = Eq_94::a0000;
		byte Eq_143::* di_116 = &Eq_143::b7440;
		cui16 dx_117;
		for (dx_117 = 0x10; dx_117 != 0x00; --dx_117)
		{
			word16 cx_118 = 0x0140;
			real64 rLoc1_304 = (real64) 0C00:0202;
			do
			{
				0C00:0200 = (int16 *) (int16) (cos(rLoc1_304 / (real64) 0C00:01FE) * (real64) 0C00:01FE);
				int16 ax_136 = 0C00:0200 *s 0x0140;
				byte Eq_143::* di_138 = di_116 + ax_136;
				0x6000->*di_138 = 0x5000->*si_113;
				--cx_118;
				si_113 = (union Eq_136 Eq_94::*) ((char *) si_113 + 1);
				rLoc1_304 += 1.0;
				di_116 = di_138 + 1 - ax_136;
				byte ch_285 = SLICE(cx_118, byte, 8);
			} while (cx_118 != 0x00);
			si_113 = (union Eq_136 Eq_94::*) ((char *) si_113 + 16);
		}
		word16 cx_190 = SEQ(ch_285, 200);
		do
		{
			cui16 dx_165 = dx_117 & 0x03;
			0x5000->*si_113 += dx_165 + 0x01;
			0x6000->*((char *) (0x5000->*si_113) + bx_174) = ((byte) (dx_165 + 0x01) + 0x0A) * 0x02;
			dx_117 = dx_165 + 0x01;
			si_113 = (union Eq_136 Eq_94::*) ((char *) si_113 + 2);
			bx_174 = __rol(bx_174 + 0x02, 0x02);
			--cx_190;
		} while (cx_190 != 0x00);
		word16 Eq_143::* si_208 = Eq_143::a0000;
		word16 Eq_264::* di_209 = Eq_264::a0000;
		word16 cx_212 = 0x7D00;
		while (true)
		{
			ch = SLICE(cx_212, byte, 8);
			if (cx_212 == 0x00)
				break;
			0xA000->*di_209 = 0x6000->*si_208;
			++si_208;
			++di_209;
			--cx_212;
		}
		ds = cs;
	} while (__inb(0x60) != 0x01);
}

