// subject_code.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject_code.h"

// 0C00:0100: void fn0C00_0100(Register byte ah, Register int16 dx, Register Eq_4 bx, Register (ptr16 Eq_5) ds)
void fn0C00_0100(byte ah, int16 dx, Eq_4 bx, struct Eq_5 * ds)
{
	__syscall(0x10);
	int16 ax_133 = SEQ(ah, 0x13);
	struct Eq_5 * es_99 = ds->*((word16) bx + 2);
	do
	{
		byte al_118 = (byte) ax_133;
		Eq_18 di_14 = 0x00;
		word16 cx_12;
		for (cx_12 = 0x03; cx_12 != 0x00; --cx_12)
		{
			++ds->*((word16) di_14 + 357);
			real64 rLoc1_120 = (real64) (ds->*((word16) di_14 + 357)) / (real64) ds->w016B;
			real64 rLoc1_121 = cos(rLoc1_120);
			ds->*((word16) di_14 + 367) = (int16) (sin(rLoc1_120) * (real64) ds->w016D);
			ds->*((word16) di_14 + 0x0177) = (int16) (rLoc1_121 * (real64) ds->w016B);
			es_99->*di_14 = ax_133;
			di_14 = (word16) di_14 + 2;
		}
		word16 cx_39;
		for (cx_39 = cx_12 - 0x01; cx_39 != 0x00; --cx_39)
		{
			es_99->*di_14 = al_118;
			di_14 = (word16) di_14 + 1;
		}
		do
		{
			Mem54[es_99:dx *s 0x0140 + bx + 0xBC30:byte] = SLICE(ax_133, byte, 0);
			ax_133 = __rol((word16) di_14 + ax_133, 0x02);
			Eq_88 di_62 = (word16) di_14 + ax_133;
			byte ah_96 = SLICE(ax_133, byte, 8);
			di_14 = di_62 & 0x06;
			bx += Mem54[ds:(di_62 & 0x06) + 0x016F:word16] - bx >> 0x01;
			dx += ds->*((word16) (di_62 & 0x06) + 0x0177) - dx >> 0x01;
			--cx_39;
		} while (cx_39 != 0x00);
		byte al_78 = __inb(0x60);
		ax_133 = SEQ(ah_96, al_78 - 0x01);
	} while (al_78 != 0x01);
}

